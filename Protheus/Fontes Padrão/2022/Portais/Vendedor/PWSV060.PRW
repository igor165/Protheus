#INCLUDE "PROTHEUS.CH"
#INCLUDE "PWSV060.CH"
#INCLUDE "APWEBEX.CH"

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³PWSV06*   ºAutor  ³Luiz Felipe Couto    º Data ³  11/10/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Este fonte possui as funcionalidades relacionado as         º±±
±±º          ³ estatisticas de venda.                                      º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºParametros³                                                             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³Portal Protheus                                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºAnalista  ³ Data/Bops/Ver ³Manutencao Efetuada                      	   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³PWSV060   ºAutor  ³Luiz Felipe Couto    º Data ³  11/10/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Mostra os vendedores disponiveis para o usuario logado.     º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºParametros³                                                             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³Portal Protheus                                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºAnalista  ³ Data/Bops/Ver ³Manutencao Efetuada                      	   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Web Function PWSV060()

Local cHtml := ""					//Pagina WEB
Local aVend	:= {}					//Array de vendedores cadastrados para o usuario logado

WEB EXTENDED INIT cHtml START "InSite"

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Vendedores cadastrados para o usuario logado³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
aVend := GetUserVen()

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Informacoes a serem utilizadas pelo APH³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
HttpSession->PWSV020APH	:= { 	STR0001			,;			//Estatisticas de Venda
								"W_PWSV061.APW"	,;			//Pagina para onde sera enviado o POST
								"" }						//Mensagem a ser mostrada na tela
	
Do Case
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Nao ha vendedores cadastrados para o usuario logado³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Case Empty( aVend )
		HttpSession->PWSV020APH[3] := STR0002	//Nao ha vendedores a consultar
		
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Apenas 1 vendedor cadastrado³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Case Len( aVend ) == 2
		HttpSession->CODVENERP := aVend[2][2]

		Return W_PWSV061()

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Mais de 1 vendedor³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Otherwise
		cHtml += ExecInPage( "PWSV020" )

EndCase

cHtml += ExecInPage( "PWSV020" )

WEB EXTENDED END

Return cHtml

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³PWSV061   ºAutor  ³Luiz Felipe Couto    º Data ³  11/10/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Tela de busca dos produtos para o vendedor selecionado.     º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºParametros³                                                             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³Portal Protheus                                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºAnalista  ³ Data/Bops/Ver ³Manutencao Efetuada                      	   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºCleber M. ³04/07/07³128597³-Alteracao do nome do metodo GetHeader para  º±±
±±º          ³        ³      ³GetHeadSum para evitar a leitura de um resul-º±±
±±º          ³        ³      ³tado antigo na memoria. 	                   º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Web Function PWSV061()

Local cHtml 	:= ""					//Pagina WEB
Local aWebCols 	:= {}					//Array contendo os campos que serao mostrados na tela
Local oObjProd							//Objeto WS - WSMTPRODUCT
Local oObjIndex							//Objeto WS - WSCFGDICTIONARY
Local oObjSum							//Objeto WS - WSFTSELLERSALESSUMMARY

WEB EXTENDED INIT cHtml START "InSite"

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Informacoes a serem utilizadas pelo APH³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
HttpSession->PWSV061APH := { STR0001		,;	//Estatisticas de Venda
							 "W_PWSV062.APW" }

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Inicializa o objeto WS - WSMTPRODUCT³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObjProd := IIf( FindFunction( 'GetAuthWs' ), GetAuthWs( 'WSMTPRODUCT' ), WSMTPRODUCT():New() )
WsChgUrl( @oObjProd, "MTPRODUCT.APW" )

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Inicializa o objeto WS - WSCFGDICTIONARY³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObjIndex := IIf( FindFunction( 'GetAuthWs' ), GetAuthWs( 'WSCFGDICTIONARY' ), WSCFGDICTIONARY():New() )
WsChgUrl( @oObjIndex, "CFGDICTIONARY.APW" )

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Inicializa o objeto WS - WSFTSELLERSALESSUMMARY³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObjSum := IIf( FindFunction( 'GetAuthWs' ), GetAuthWs( 'WSFTSELLERSALESSUMMARY' ), WSFTSELLERSALESSUMMARY():New() )
WsChgUrl( @oObjSum, "FTSELLERSALESSUMMARY.APW" )

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Array contendo os headers dos WS utilizados nesta pagina³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If Empty( HttpSession->PWSV061HEADER )
	HttpSession->PWSV061HEADER := { NIL, NIL, NIL, NIL }

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Header da estrutura PRODUCTVIEW - Produto                              ³
	//|- PRODUCTCODE                  : Codigo                                |
	//|- DESCRIPTION                  : Descricao                             |
	//|- SCIENCEDESCRIPTION           : Descricao Cientifica                  |
	//|- MEASUREUNIT                  : Unidade de Medida                     |
	//|- DESCRIPTIONMEASUREUNIT       : Descricao da Unidade de Medida        |
	//|- SECONDMEASUREUNIT            : Segunda Unidade de Medida             |
	//|- DESCRIPTIONSECONDMEASUREUNIT : Descricao da Segunda Unidade de Medida|
	//|- TYPEOFPRODUCT                : Tipo                                  |
	//|- DESCRIPTIONTYPEOFPRODUCT     : Descricao do Tipo                     |
	//|- GROUPOFPRODUCT               : Grupo                                 |
	//|- DESCRIPTIONGROUPOFPRODUCT    : Descricao do Grupo                    |
	//|- NCM                          : Nomenclatura Ext. Mercosul            |
	//|- QUANTITYPERPACKAGE           : Quntidade por Embalagem               |
	//|- ORDERPOINT                   : Ponto de Pedido                       |
	//|- NETWEIGHT                    : Peso Liquido                          |
	//|- GROSSWEIGHT                  : Peso Bruto                            |
	//|- LEADTIME                     : Prazo de Entrega                      |
	//|- TYPEOFLEADTIME               : Tipo de Prazo de Entrega              |
	//|- ECONOMICLOT                  : Lote Economico                        |
	//|- MINIMUMLOT                   : Lote Minimo                           |
	//|- MINIMUMGRADE                 : Nota Minima                           |
	//|- TERMOFVALIDATY               : Termo de Validade                     |
	//|- BARCODE                      : Codigo de Barra                       |
	//|- STORAGELENGHT                : Comprimento da Armazenagem            |
	//|- STORAGEWIDTH                 : Largura da Armazenagem                |
	//|- STORAGEHEIGHT                : Altura da Armazenagem                 |
	//|- STORAGEMAXIMUMPILING         : Fator de Armazenamento                |
	//|- STANDARDWAREHOUSE            : Armazem                               |
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If Empty( HttpSession->PWSV061HEADER[1] )
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Parametros do metodo GETHEADER³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		oObjProd:cHEADERTYPE := "PRODUCTVIEW"
	
		//cHEADERTYPE
		If oObjProd:GETHEADER()
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³Retorno do Metodo GETHEADER³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			HttpSession->PWSV061HEADER[1] := { oObjProd:oWSGETHEADERRESULT:oWSBRWHEADER }
		Else
			Return PWSHtmlAlert( "", STR0003		,;	//Atencao
								 "", "W_PWSV060.APW" )
		EndIf
	EndIf

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Header da estrutura do WS CFGDICTIONARY³
	//|- CODE        : Ordem                  |
	//|- DESCRIPTION : Chave                  |
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If Empty( HttpSession->PWSV061HEADER[2] )
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Parametros do metodo GETHEADER³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		If oObjIndex:GETHEADER()
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³Retorno do Metodo GETHEADER³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			HttpSession->PWSV061HEADER[2] := { oObjIndex:oWSGETHEADERRESULT:oWSBRWHEADER }
		Else
			Return PWSHtmlAlert( "", STR0003		,; //Atencao
								 "", "W_PWSV060.APW" )
		EndIf
	EndIf

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Header da estrutura do WS GENERICSTRUCT³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If Empty( HttpSession->PWSV061HEADER[3] )
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Parametros do metodo GETHEADSUM ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		oObjSum:cHEADERTYPE := "GENERICSTRUCT"
	
		//cHEADERTYPE
		If oObjSum:GETHEADSUM()
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³Retorno do Metodo GetHeadSum³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			HttpSession->PWSV061HEADER[3] := { oObjSum:oWSGETHEADSUMRESULT:oWSBRWHEADER }
		Else
			Return PWSHtmlAlert( "", STR0003		,;	//Atencao
								 "", "W_PWSV060.APW" )
		EndIf
	EndIf
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Header da estrutura do WS PRODUCTSUMMARY³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If Empty( HttpSession->PWSV061HEADER[4] )
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Parametros do metodo GETHEADSUM³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		oObjSum:cHEADERTYPE := "PRODUCTSUMMARY"
		
		//cHEADERTYPE
		If oObjSum:GETHEADSUM()
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³Retorno do Metodo GETHEADSUM³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			HttpSession->PWSV061HEADER[4] := { oObjSum:oWSGETHEADSUMRESULT:oWSBRWHEADER }
		Else
			Return PWSHtmlAlert( "", STR0003		,;	//Atencao
								 "", "W_PWSV060.APW" )
		EndIf
	EndIf
EndIf

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Indices da Tabela SB1³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If Empty( HttpSession->PWSV061INDEX )
	HttpSession->PWSV061INDEX := {}
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Parametros do metodo GETINDEX³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	oObjIndex:cUSERCODE 	:= GetUsrCode()
	oObjIndex:cTABLE 		:= "SB1"
	
	//cUSERCODE,cTABLE
	If oObjIndex:GETINDEX()
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Resultado do Metodo GETINDEX³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		HttpSession->PWSV061INDEX := { oObjIndex:oWSGETINDEXRESULT:oWSGENERICSTRUCT }
	Else
		Return PWSHtmlAlert( "", STR0003		,;	//Atencao
							 "", "W_PWSV060.APW" )
	EndIf
EndIf

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Dados para montagem do campo de Ordem³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If Empty( HttpSession->PWSV061INFO )
	HttpSession->PWSV061INFO := {}

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Ponto de Entrada - Campos do WS WSCFGDICTIONARY³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If ExistBlock( "PEV061" )
		aWebCols := ExecBlock( "PEV061", .F., .F., {} )
	Else
		aAdd( aWebCols, "CODE" )
		aAdd( aWebCols, "DESCRIPTION" )
	EndIf
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Funcao de montagem da descricao dos campos da tela³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
   	GridHeader( HttpSession->PWSV061INFO, HttpSession->PWSV061HEADER[2][1], aWebCols )
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Funcao de montagem dos campos da tela³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	GridLinesEx( { 	HttpSession->PWSV061INFO		, HttpSession->PWSV061HEADER[2][1]	,;
					HttpSession->PWSV061INDEX[1]	, aWebCols							,;
					.F., "A",, 0 } )
EndIf

cHtml += ExecInPage( "PWSV061" )

WEB EXTENDED END

Return cHtml

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³PWSV062   ºAutor  ³Luiz Felipe Couto    º Data ³  11/10/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Tela com a busca dos produtos.                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºParametros³                                                             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³Portal Protheus                                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºAnalista  ³ Data/Bops/Ver ³Manutencao Efetuada                      	   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºCleber M. ³06/04/06³95815 ³Verificacao se o cliente escolhido pertence  º±±
±±º          ³        ³      ³a carteira do vendedor.                      º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Web Function PWSV062()

Local cHtml 	:= ""					//Pagina WEB
Local aWebCols 	:= {}					//Array contendo os campos a serem mostrados na tela
Local oObj								//Objeto WS - WSMTPRODUCT
Local oObjCliente						//Objeto WS - WSMTCUSTOMER

WEB EXTENDED INIT cHtml START "InSite"

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Informacoes a serem mostradas na tela³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
HttpSession->PWSV062APH := { 	STR0004		,;				//Estatisticas de Venda - Resultado da Busca PRODUTOS
								"W_PWSV063.APW"	,;				//Pagina para onde sera enviado o POST
								"W_PWSV061.APW" }				//Pagina de Volta

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Array para montagem da tela³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
HttpSession->PWSV062INFO := {}

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Inicializa o objeto WS - WSMTPRODUCT³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj := IIf( FindFunction( 'GetAuthWs' ), GetAuthWs( 'WSMTPRODUCT' ), WSMTPRODUCT():New() )
WsChgUrl( @oObj, "MTPRODUCT.APW" )

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Inicializa o objeto WS - WSMTPRODUCT³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObjCliente := IIf( FindFunction( 'GetAuthWs' ), GetAuthWs( 'WSMTCUSTOMER' ), WSMTCUSTOMER():New() )
WsChgUrl( @oObjCliente, "MTCUSTOMER.APW" )

oObjCliente:cUSERCODE	:= GetUsrCode()
oObjCliente:cCUSTOMERID	:= HttpPost->cCUSTOMERCODE + HttpPost->cCUSTOMERUNIT

//cUSERCODE,cCUSTOMERID
If oObjCliente:GETCUSTOMER()
	HttpSession->cCUSTOMERID := oObjCliente:oWSGETCUSTOMERRESULT:cCUSTOMERCODE + oObjCliente:oWSGETCUSTOMERRESULT:cUNITCUSTOMERCODE
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Valida se o vendedor do cliente eh o mesmo do Portal ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If (oObjCliente:oWSGETCUSTOMERRESULT:cSELLERCODE <> HttpSession->CODVENERP)
		Return PWSHtmlAlert( "", STR0003	,;	//Atencao
							 STR0005		,;	//Este cliente pertence a carteira de outro vendedor
							 "W_PWSV061.APW" )
	EndIf
Else
	Return PWSHtmlAlert( "", STR0003		,;	//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Parametros do metodo GETCATALOG³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cPRODUCTCODELIKE	:= HttpPost->cPRODUCTCODELIKE
oObj:cDESCRIPTIONLIKE	:= HttpPost->cDESCRIPTIONLIKE
oObj:cINDEXKEY			:= HttpPost->cINDEX

//cUSERCODE,cTYPEOFPRODUCTIN,cGROUPOFPRODUCTIN,cPRODUCTCODELIKE,cDESCRIPTIONLIKE,nPAGELEN,nPAGEFIRST,cQUERYADDWHERE,cINDEXKEY
If oObj:GETCATALOG()
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Retorno do metodo GETCATALOG³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	HttpSession->PWSV062RESULT := { oObj:oWSGETCATALOGRESULT:oWSPRODUCTVIEW }
Else
	Return PWSHtmlAlert( "", 	STR0003		,;	//Atencao
						 "", "W_PWSV060.APW" )
EndIf

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Verifica Resultado da Busca³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If !Empty( HttpSession->PWSV062RESULT ) .AND. Len( HttpSession->PWSV062RESULT[1] ) > 0
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Ponto de Entrada - Produto³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If ExistBlock( "PEV062" )
		aWebCols := ExecBlock( "PEV062", .F., .F., {} )
	Else
		AAdd( aWebCols, "PRODUCTCODE" )
		AAdd( aWebCols, "DESCRIPTION" )
		AAdd( aWebCols, "MEASUREUNIT" )
		AAdd( aWebCols, "TYPEOFPRODUCT" )
		AAdd( aWebCols, "GROUPOFPRODUCT" )
	Endif

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Funcao de montagem da descricao dos campos da tela³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	GridHeader(	HttpSession->PWSV062INFO, HttpSession->PWSV061HEADER[1][1], aWebCols )
             
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Funcao de montagem dos campos da tela³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	GridLinesEx( { 	HttpSession->PWSV062INFO		, HttpSession->PWSV061HEADER[1][1]	,;
					HttpSession->PWSV062RESULT[1]	, aWebCols							,;
					.F., "A",, 0 } )
Else
	Return PWSHtmlAlert( "", STR0003	,;  //Atencao
						 STR0006		,;	//A busca nao retornou nenhum produto cadastrado.
						 "W_PWSV061.APW" )
EndIf

cHtml += ExecInPage( "PWSV062" )

WEB EXTENDED END

Return cHtml

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³PWSV063   ºAutor  ³Luiz Felipe Couto    º Data ³  11/10/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Tela com a busca por data.                                  º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºParametros³                                                             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³Portal Protheus                                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºAnalista  ³ Data/Bops/Ver ³Manutencao Efetuada                      	   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Web Function PWSV063()

Local cHtml 	:= ""					//Pagina WEB

WEB EXTENDED INIT cHtml START "InSite"

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Informacoes a serem mostradas na tela³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
HttpSession->PWSV063APH := { 	STR0007			, ;			//Estatisticas de Venda - Busca por periodo
								"W_PWSV064.APW"	, ;			//Pagina para onde sera enviado o POST
								"W_PWSV061.APW" }			//Pagina de Volta

cHtml += ExecInPage( "PWSV063" )

WEB EXTENDED END

Return cHtml

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³PWSV064   ºAutor  ³Luiz Felipe Couto    º Data ³  11/10/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Tela com as estatisticas de venda para o produto no periodo º±±
±±º          ³ selecionado.                                                º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºParametros³                                                             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³Portal Protheus                                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºAnalista  ³ Data/Bops/Ver ³Manutencao Efetuada                      	   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Web Function PWSV064()

Local cHtml 		:= ""					//Pagina WEB
Local nTam			:= 0					//Tamanho do array
Local aWebCols		:= {}					//Array com os campos a serem mostrados na pagina
Local oObj									//Objeto WS - WSFTSELLERSALESSUMMARY

WEB EXTENDED INIT cHtml START "InSite"

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Informacoes a serem mostradas na tela³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
HttpSession->PWSV064APH := { 	STR0001	,;		//Estatisticas de Venda							
								STR0008	,;		//Faturamento bonificado no periodo					
								STR0009	,;		//Vendas bonificadas no periodo						
								STR0016	,;		//Faturamento bonificado por produtos no periodo
								STR0017	,;		//Vendas bonificadas por produto no periodo
								STR0010	,;		//Devolucoes por produtos no periodo
								STR0011	,;		//Faturamento por produtos no periodo
								STR0012	,;		//Vendas por produtos no periodo
								STR0013	,;		//Devolucoes no periodo
								STR0014	,;		//Faturamento no periodo
								STR0015	,;      //Vendas no periodo
								"W_PWSV063.APW" }	//Pagina de Volta

HttpSession->PWSV064INFO := { {}, {}, {}, {}, {}, {}, {}, {}, {}, {} }

oObj := IIf( FindFunction( 'GetAuthWs' ), GetAuthWs( 'WSFTSELLERSALESSUMMARY' ), WSFTSELLERSALESSUMMARY():New() )
WsChgURL( @oObj, "FTSELLERSALESSUMMARY.APW" )

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Faturamento bonificado no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY
If oObj:GETBONUSINVOICE()
	aWebCols := {}

	If ExistBlock( "PEV064" )
		aWebCols := ExecBlock( "PEV064", .F., .F., { 1 } )
	Else
		AAdd( aWebCols, "DESCRIPTION" )
		AAdd( aWebCols, "VALUE" )
	Endif

	GridHeader( HttpSession->PWSV064INFO[1]			,;
				HttpSession->PWSV061HEADER[3][1]	,;
				aWebCols )
	
	GridLinesEx( { 	HttpSession->PWSV064INFO[1]						,;
					HttpSession->PWSV061HEADER[3][1]				,;
					oObj:oWSGETBONUSINVOICERESULT:oWSGENERICSTRUCT	,;
					aWebCols										,;
					.F.												,;
					"A"												,;
					NIL												,;
					0 } )
Else
	Return PWSHtmlAlert( "", STR0003		,;	//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Vendas bonificadas no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY
If oObj:GETBONUSSALESORDER()
	aWebCols := {}

	If ExistBlock( "PEV064" )
		aWebCols := ExecBlock( "PEV064", .F., .F., { 2 } )
	Else
		AAdd( aWebCols, "DESCRIPTION" )
		AAdd( aWebCols, "VALUE" )
	Endif

	GridHeader( HttpSession->PWSV064INFO[2]			,;
				HttpSession->PWSV061HEADER[3][1]	,;
				aWebCols )
	
	GridLinesEx( { 	HttpSession->PWSV064INFO[2]							,;
					HttpSession->PWSV061HEADER[3][1]					,;
					oObj:oWSGETBONUSSALESORDERRESULT:oWSGENERICSTRUCT	,;
					aWebCols											,;
					.F.													,;
					"A"													,;
					NIL													,;
					0 } )
Else
	Return PWSHtmlAlert( "", STR0003		,;	//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Faturamento bonificado por produtos no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY
If oObj:GETPRODUCTBONUSINVOICE()
	aWebCols := {}

	If Len( oObj:oWSGETPRODUCTBONUSINVOICERESULT:oWSPRODUCTSUMMARY ) > 0
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 3 } )
		Else
			AAdd( aWebCols, "DESCRIPTION" )
			AAdd( aWebCols, "VALUE" )
		Endif

		nTam := Len( oObj:oWSGETPRODUCTBONUSINVOICERESULT:oWSPRODUCTSUMMARY )

		GridHeader( HttpSession->PWSV064INFO[3]			,;
					HttpSession->PWSV061HEADER[3][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[3]			,;
						HttpSession->PWSV061HEADER[3][1]	,;
						oObj:oWSGETPRODUCTBONUSINVOICERESULT:oWSPRODUCTSUMMARY[nTam]:oWSVALUESUMMARY:oWSGENERICSTRUCT,;
						aWebCols							,;
						.F.									,;
						"A"									,;
						NIL									,;
						0 } )
	Else
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 3 } )
		Endif

		GridHeader( HttpSession->PWSV064INFO[3]			,;
					HttpSession->PWSV061HEADER[4][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[3]								,;
						HttpSession->PWSV061HEADER[4][1]						,;
						oObj:oWSGETPRODUCTBONUSINVOICERESULT:oWSPRODUCTSUMMARY	,;
						aWebCols												,;
						.F.														,;
						"A"														,;
						NIL														,;
						0 } )
	Endif
Else
	Return PWSHtmlAlert( "", STR0003		,;	//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Vendas bonificadas por produto no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY
If oObj:GETPRODUCTBONUSSALESORDER()
	aWebCols := {}

	If Len( oObj:oWSGETPRODUCTBONUSSALESORDERRESULT:oWSPRODUCTSUMMARY ) > 0
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 4 } )
		Else
			AAdd( aWebCols, "DESCRIPTION" )
			AAdd( aWebCols, "VALUE" )
		Endif

		nTam := Len( oObj:oWSGETPRODUCTBONUSSALESORDERRESULT:oWSPRODUCTSUMMARY )

		GridHeader( HttpSession->PWSV064INFO[4]			,;
					HttpSession->PWSV061HEADER[3][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[4]			,;
						HttpSession->PWSV061HEADER[3][1]	,;
						oObj:oWSGETPRODUCTBONUSSALESORDERRESULT:oWSPRODUCTSUMMARY[nTam]:oWSVALUESUMMARY:oWSGENERICSTRUCT,;
						aWebCols							,;
						.F.									,;
						"A"									,;
						NIL									,;
						0 } )
	Else
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 4 } )
		Endif

		GridHeader( HttpSession->PWSV064INFO[4]			,;
					HttpSession->PWSV061HEADER[4][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[4]							,;
						HttpSession->PWSV061HEADER[4][1]					,;
						oObj:oWSGETPRODUCTBONUSSALESORDERRESULT:oWSPRODUCTSUMMARY	,;
						aWebCols											,;
						.F.													,;
						"A"													,;
						NIL													,;
						0 } )
	Endif
Else
	Return PWSHtmlAlert( "", STR0003		,;	//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Devolucoes por produtos no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY
If oObj:GETPRODUCTRETURNINVOICE()
	aWebCols := {}

	If Len( oObj:oWSGETPRODUCTRETURNINVOICERESULT:oWSPRODUCTSUMMARY ) > 0
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 5 } )
		Else
			AAdd( aWebCols, "DESCRIPTION" )
			AAdd( aWebCols, "VALUE" )
		Endif

		nTam := Len( oObj:oWSGETPRODUCTRETURNINVOICERESULT:oWSPRODUCTSUMMARY )

		GridHeader( HttpSession->PWSV064INFO[5]			,;
					HttpSession->PWSV061HEADER[3][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[5]			,;
						HttpSession->PWSV061HEADER[3][1]	,;
						oObj:oWSGETPRODUCTRETURNINVOICERESULT:oWSPRODUCTSUMMARY[nTam]:oWSVALUESUMMARY:oWSGENERICSTRUCT,;
						aWebCols							,;
						.F.									,;
						"A"									,;
						NIL									,;
						0 } )
	Else
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 5 } )
		Endif

		GridHeader( HttpSession->PWSV064INFO[5]			,;
					HttpSession->PWSV061HEADER[4][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[5]						,;
						HttpSession->PWSV061HEADER[4][1]				,;
						oObj:oWSGETPRODUCTRETURNINVOICERESULT:oWSPRODUCTSUMMARY	,;
						aWebCols										,;
						.F.												,;
						"A"												,;
						NIL												,;
						0 } )
	Endif
Else
	Return PWSHtmlAlert( "", STR0003		,;		//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Faturamento por produtos no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY
oObj:cQUERYADDWHERE		:= ""

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY,cQUERYADDWHERE
If oObj:GETPRODUCTSALESINVOICE()
	aWebCols := {}

	If Len( oObj:oWSGETPRODUCTSALESINVOICERESULT:oWSPRODUCTSUMMARY ) > 0
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 6 } )
		Else
			AAdd( aWebCols, "DESCRIPTION" )
			AAdd( aWebCols, "VALUE" )
		Endif

		nTam := Len( oObj:oWSGETPRODUCTSALESINVOICERESULT:oWSPRODUCTSUMMARY )

		GridHeader( HttpSession->PWSV064INFO[6]			,;
					HttpSession->PWSV061HEADER[3][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[6]			,;
						HttpSession->PWSV061HEADER[3][1]	,;
						oObj:oWSGETPRODUCTSALESINVOICERESULT:oWSPRODUCTSUMMARY[nTam]:oWSVALUESUMMARY:oWSGENERICSTRUCT,;
						aWebCols							,;
						.F.									,;
						"A"									,;
						NIL									,;
						0 } )
	Else
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 6 } )
		Endif

		GridHeader( HttpSession->PWSV064INFO[6]			,;
					HttpSession->PWSV061HEADER[4][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[6]						,;
						HttpSession->PWSV061HEADER[4][1]				,;
						oObj:oWSGETPRODUCTSALESINVOICERESULT:oWSPRODUCTSUMMARY	,;
						aWebCols										,;
						.F.												,;
						"A"												,;
						NIL												,;
						0 } )
	Endif
Else
	Return PWSHtmlAlert( "", STR0003		,;		//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Vendas por produtos no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY
oObj:cQUERYADDWHERE		:= ""

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY,cQUERYADDWHERE
If oObj:GETPRODUCTSALESORDER()
	aWebCols := {}

	If Len( oObj:oWSGETPRODUCTSALESORDERRESULT:oWSPRODUCTSUMMARY ) > 0
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 7 } )
		Else
			AAdd( aWebCols, "DESCRIPTION" )
			AAdd( aWebCols, "VALUE" )
		Endif

		nTam := Len( oObj:oWSGETPRODUCTSALESORDERRESULT:oWSPRODUCTSUMMARY )

		GridHeader( HttpSession->PWSV064INFO[7]			,;
					HttpSession->PWSV061HEADER[3][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[7]			,;
						HttpSession->PWSV061HEADER[3][1]	,;
						oObj:oWSGETPRODUCTSALESORDERRESULT:oWSPRODUCTSUMMARY[nTam]:oWSVALUESUMMARY:oWSGENERICSTRUCT,;
						aWebCols							,;
						.F.									,;
						"A"									,;
						NIL									,;
						0 } )
	Else
		If ExistBlock( "PEV064" )
			aWebCols := ExecBlock( "PEV064", .F., .F., { 7 } )
		Endif

		GridHeader( HttpSession->PWSV064INFO[7]			,;
					HttpSession->PWSV061HEADER[4][1]	,;
					aWebCols )
		
		GridLinesEx( { 	HttpSession->PWSV064INFO[7]						,;
						HttpSession->PWSV061HEADER[4][1]				,;
						oObj:oWSGETPRODUCTSALESORDERRESULT:oWSPRODUCTSUMMARY,;
						aWebCols										,;
						.F.												,;
						"A"												,;
						NIL												,;
						0 } )
	Endif
Else
	Return PWSHtmlAlert( "", STR0003		,;		//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Devolucoes no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY
If oObj:GETRETURNINVOICE()
	aWebCols := {}

	If ExistBlock( "PEV064" )
		aWebCols := ExecBlock( "PEV064", .F., .F., { 8 } )
	Else
		AAdd( aWebCols, "DESCRIPTION" )
		AAdd( aWebCols, "VALUE" )
	Endif

	GridHeader( HttpSession->PWSV064INFO[8]			,;
				HttpSession->PWSV061HEADER[3][1]	,;
				aWebCols )
	
	GridLinesEx( { 	HttpSession->PWSV064INFO[8]						,;
					HttpSession->PWSV061HEADER[3][1]				,;
					oObj:oWSGETRETURNINVOICERESULT:oWSGENERICSTRUCT	,;
					aWebCols										,;
					.F.												,;
					"A"												,;
					NIL												,;
					0 } )
Else
	Return PWSHtmlAlert( "", STR0003		,;	//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Faturamento no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY
oObj:cQUERYADDWHERE		:= ""

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY,cQUERYADDWHERE
If oObj:GETSALESINVOICE()
	aWebCols := {}

	If ExistBlock( "PEV064" )
		aWebCols := ExecBlock( "PEV064", .F., .F., { 9 } )
	Else
		AAdd( aWebCols, "DESCRIPTION" )
		AAdd( aWebCols, "VALUE" )
	Endif

	GridHeader( HttpSession->PWSV064INFO[9]			,;
				HttpSession->PWSV061HEADER[3][1]	,;
				aWebCols )
	
	GridLinesEx( { 	HttpSession->PWSV064INFO[9]						,;
					HttpSession->PWSV061HEADER[3][1]				,;
					oObj:oWSGETSALESINVOICERESULT:oWSGENERICSTRUCT	,;
					aWebCols										,;
					.F.												,;
					"A"												,;
					NIL												,;
					0 } )
Else
	Return PWSHtmlAlert( "", STR0003		,;	//Atencao
						 "", "W_PWSV061.APW" )
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Vendas no periodo³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
oObj:cUSERCODE			:= GetUsrCode()
oObj:cSELLERCODE		:= HttpSession->CODVENERP
oObj:cCUSTOMERID		:= HttpSession->cCUSTOMERID
oObj:dDATEFROM			:= CToD( HttpPost->dDATEFROM )
oObj:dDATETO			:= CToD( HttpPost->dDATETO )
oObj:cTYPEOFPRODUCT		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cTYPEOFPRODUCT
oObj:cGROUPOFPRODUCT	:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cGROUPOFPRODUCT
oObj:cPRODUCTCODE		:= HttpSession->PWSV062RESULT[1][Val( HttpPost->cProduto )]:cPRODUCTCODE
oObj:nCURRENCY			:= HttpPost->nCURRENCY
oObj:cQUERYADDWHERE		:= ""

//cUSERCODE,cSELLERCODE,cCUSTOMERID,dDATEFROM,dDATETO,cTYPEOFPRODUCT,cGROUPOFPRODUCT,cPRODUCTCODE,nCURRENCY,cQUERYADDWHERE
If oObj:GETSALESORDER()
	aWebCols := {}

	If ExistBlock( "PEV064" )
		aWebCols := ExecBlock( "PEV064", .F., .F., { 10 } )
	Else
		AAdd( aWebCols, "DESCRIPTION" )
		AAdd( aWebCols, "VALUE" )
	Endif

	GridHeader( HttpSession->PWSV064INFO[10]		,;
				HttpSession->PWSV061HEADER[3][1]	,;
				aWebCols )
	
	GridLinesEx( { 	HttpSession->PWSV064INFO[10]					,;
					HttpSession->PWSV061HEADER[3][1]				,;
					oObj:oWSGETSALESORDERRESULT:oWSGENERICSTRUCT	,;
					aWebCols										,;
					.F.												,;
					"A"												,;
					NIL												,;
					0 } )
Else
	Return PWSHtmlAlert( "", STR0003		,;		//Atencao
						 "", "W_PWSV061.APW" )
Endif

cHtml += ExecInPage( "PWSV064" )

WEB EXTENDED END

Return cHtml

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³PWSV064A  ºAutor  ³Luiz Felipe Couto    º Data ³  11/10/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Tela com a as estatisticas de venda.                        º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºParametros³                                                             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³Portal Protheus                                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºAnalista  ³ Data/Bops/Ver ³Manutencao Efetuada                      	   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Web Function PWSV064A()

Local cHtml 	:= ""					//Pagina WEB

WEB EXTENDED INIT cHtml START "InSite"

cHtml += ExecInPage( "PWSV064A" )

WEB EXTENDED END

Return cHtml
