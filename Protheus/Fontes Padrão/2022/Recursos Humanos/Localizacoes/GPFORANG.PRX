#INCLUDE "PROTHEUS.CH"

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³GpForANG      ³Autor³ Gerado pelo sistema ³ Data ³24/02/2013³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Formulas padroes                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function GpForANG()

Local aRC2Header  := {}
Local aRC3Header  := {}
Local aSYPHeader  := {}

Local bForm	    := NIL

Local cFormNum
Local cForm

Local lRet        := .T.
Local nItem       := 0
Local cFil        := Alltrim(Str(FWGETTAMFILIAL))

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Cabecalho de RC2 e RC3 gerado pela formula padrao            ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
aAdd(aRC2Header, { 'Filial','RC2_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Origem','RC2_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','€€€€€€€€€€€€€€°','C','      ','R','S_=Sistema;U_=Utilizador                                                                                                        ','"U_"','','V','','','.F.' })
aAdd(aRC2Header, { 'Cód. Fórmula','RC2_CODIGO','@!','15','0','RC2CodigoVld()','€€€€€€€€€€€€€€°','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Desc.Fórmula','RC2_DESC','@!','40','0','NaoVAzio()','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Retorno','RC2_RETURN','@!','10','0','Vazio() .or. ExistCpo("RCA")','€€€€€€€€€€€€€€°','C','RCA01 ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Cód. Obs.','RC2_CODOBS','@!','6','0','NaoVazio()','€€€€€€€€€€€€€€€','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Versão Fórm.','RC2_VERSAO','','3','0','','€€€€€€€€€€€€€€ˆ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Recompilar','RC2_RECOMP','9','1','0','Pertence("12")','€€€€€€€€€€€€€€€','C','      ','R','1=sim;2=não                                                                                                                     ','"1"','','V','','','.F.' })
aAdd(aRC2Header, { 'Modelo Folha','RC2_MODELO','@!','1','0','Pertence("12")','€€€€€€€€€€€€€€€','C','      ','R','1=Folha modelo 1;2=Folha modelo 2                                                                                               ','fGetModFol()','','V','','','.F.' })

aAdd(aRC3Header, { 'Filial','RC3_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Origem','RC3_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','€€€€€€€€€€€€€€°','C','      ','R','S_=Sistema;U_=Utilizador                                                                                                        ','"U_"','','V','','','.F.' })
aAdd(aRC3Header, { 'Cód. Fórmula','RC3_CODIGO','@!','15','0','','€€€€€€€€€€€€€€°','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC3Header, { 'Descrição','RC3_DESCR','@!S31','60','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Seq.','RC3_SEQFOR','999999','6','0','NaoVazio() .and. Gpea290SeqFor( .T. )','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','Gpea290SeqFor()','SeqWhen()',' ','','','.F.' })
aAdd(aRC3Header, { 'Cód Seq. Pai','RC3_SEQPAI','999999','6','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Expr.','RC3_TIPO','@!','5','0','NaoVazio()','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp1','RC3_TPRESU','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"2"','','V','','','.F.' })
aAdd(aRC3Header, { 'Resultado','RC3_RESULT','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.1','RC3_OPERA1','@!','16','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp2','RC3_TPFM01','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '1a.Expressão','RC3_FORM01','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.2','RC3_OPERA2','@!','5','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp3','RC3_TPFM02','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '2a.Expressão','RC3_FORM02','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.3','RC3_OPERA3','@!','5','0','Gpea290Return()','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','".END."','',' ','','','.F.' })
aAdd(aRC3Header, { 'Imagem 1','RC3_RESOU1','@!','20','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Imagem 2','RC3_RESOU2','@!','20','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })

aAdd(aSYPHeader, { 'Filial','YP_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Chave','YP_CHAVE','','6','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Seqüência','YP_SEQ','','3','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Linha','YP_TEXTO','','80','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Campo','YP_CAMPO','','10','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Só carrega se estiver utilizando modelo padrão do pais.       ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
If !(MV_MODFOL == "1")
	Return
EndIf

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Validar a Estrutura das Tabela RC2 e RC3 com a do Cliente     ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
lRet := fNewOldSx3(aRC2Header, aRC3Header, "RC2", "RC3")
lRet := fNewOldSx3(aSYPHeader, NIL, "SYP")

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Executar gravacao da formula.                                 ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
IF ( lRet )

	/*/
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Chamada da funcao de gravacao                                ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
	cFormNum := "0000"
	For nItem := 1 To 83
		cFormNum	:= __Soma1( cFormNum )
		cForm		:= ( "Add" + cPaisLoc + cFormNum )
		IF IsFunction( cForm )
			bForm := __ExecMacro( '{ ||' +  cForm + '( aRc2Header , aRc3Header, aSYPHeader ) }' )
			CheckExecForm( bForm , .T. , 'ERRADDFRM' , cForm )
		EndIF
	Next nItem

EndIF

Return( NIL )


/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0001    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0001( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEFER','OBTEM DATA BASE DE FERIAS','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEFER','DFIM := DDATAATE     .CNT.','000001','000000','.EXE.','5','DFIM := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GOTOP(@OSRF)     .CNT.','000002','000000','.EXE.','5','FO_GOTOP(@OSRF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','!FO_EOF(@OSRF)   .END.','000003','000000','.ENQ.','5','','','5','!FO_EOF(@OSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEFER','( FO_GETVAL(@OSRF,"RF_PD") == FGETCODFOL("0072") ) .AND. (','000004','000003','.CON.','5','','','5','( FO_GETVAL(@OSRF,"RF_PD") == FGETCODFOL("0072") ) .AND. ( FO_GETVAL(@OSRF,"RF_DATABAS") <= DFIM )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"   .END.','000005','000004','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEFER','DDTBASFER := FO_GETVAL(@OSRF,"RF_DATABAS")     .CNT.','000006','000005','.EXE.','5','DDTBASFER := FO_GETVAL(@OSRF,"RF_DATABAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GOBOTTOM(@OSRF)     .END.','000007','000005','.EXE.','5','FO_GOBOTTOM(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_SKIP(@OSRF)     .END.','000008','000003','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0002    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0002( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BENEFIC','CALCULA E GRAVA BENEFICIOS','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','BENEFIC','Ajuda de Custo Nacional / Estrangeiro     .CNT.','000001','000000','.MSG.','5','Ajuda de Custo Nacional / Estrangeiro','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCAJC()     .CNT.','000002','000000','.EXE.','5','S_CALCAJC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVAJC()     .CNT.','000003','000000','.EXE.','5','S_GRAVAJC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','Ajuda de Custo Formaçao     .CNT.','000004','000000','.MSG.','5','Ajuda de Custo Formaçao','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCAJCF()     .CNT.','000005','000000','.EXE.','5','S_CALCAJCF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVAJCF()     .CNT.','000006','000000','.EXE.','5','S_GRAVAJCF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','Abono Familiar     .CNT.','000007','000000','.MSG.','5','Abono Familiar','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCABFA()     .CNT.','000008','000000','.EXE.','5','S_CALCABFA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVABFA()     .CNT.','000009','000000','.EXE.','5','S_GRAVABFA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','Subsidio Alimentaçao     .CNT.','000010','000000','.MSG.','5','Subsidio Alimentaçao','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCSBAL()     .CNT.','000011','000000','.EXE.','5','S_CALCSBAL()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVSBAL()     .CNT.','000012','000000','.EXE.','5','S_GRAVSBAL()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','Subsidio Transporte     .CNT.','000013','000000','.MSG.','5','Subsidio Transporte','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCSBTR()     .CNT.','000014','000000','.EXE.','5','S_CALCSBTR()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVSBTR()     .END.','000015','000000','.EXE.','5','S_GRAVSBTR()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0003    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0003( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPROFER','REALIZA BAIXA PROVISAO FERIAS','','','022','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPROFER','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CVERBXG := FGETCODFOL("0233")     .CNT.','000002','000001','.EXE.','5','CVERBXG := FGETCODFOL("0233")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CVERBXF := FGETCODFOL("0258")     .CNT.','000003','000001','.EXE.','5','CVERBXF := FGETCODFOL("0258")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR','000004','000001','.EXE.','5','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR+DTOS(RC_DATA)")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXF := 0     .CNT.','000005','000001','.EXE.','5','NHORBXF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXG := 0     .CNT.','000006','000001','.EXE.','5','NHORBXG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXF := 0     .CNT.','000007','000001','.EXE.','5','NVALBXF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXG := 0     .CNT.','000008','000001','.EXE.','5','NVALBXG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRH", RETORDER("SRH","RH_FILIAL+RH_MAT+RH_ROTEIR+','000009','000001','.CON.','5','','','5','FPOSREG("SRH", RETORDER("SRH","RH_FILIAL+RH_MAT+RH_ROTEIR+DTOS(RH_DTRECIB)") , SRA->RA_FILIAL+SRA->RA_MAT+"FER"+ANOMES(DDATAATE) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000010','000009','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0072")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXF += SRC->RC_HORAS     .CNT.','000011','000010','.EXE.','5','NHORBXF += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXF += SRC->RC_VALOR     .END.','000012','000010','.EXE.','5','NVALBXF += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXF > 0 .AND. ( LOK := !EMPTY(CVERBXF) )   .END.','000013','000009','.CON.','5','','','5','NVALBXF > 0 .AND. ( LOK := !EMPTY(CVERBXF) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBXF, NHORBX','000014','000013','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBXF, NHORBXF, NVALBXF})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})   .END.','000015','000013','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBXF','000016','000015','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBXF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXF > 0 .AND. !LOK   .END.','000017','000009','.CON.','5','','','5','NVALBXF > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CMSGLOG := FMSGFORM({19}) + "0258 - " + FDESC("RCN", "0258",','000018','000017','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0258 - " + FDESC("RCN", "0258", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000019','000017','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SR8", RETORDER("SR8","R8_FILIAL+R8_MAT+DTOS(R8_DA','000020','000001','.CON.','5','','','5','FPOSREG("SR8", RETORDER("SR8","R8_FILIAL+R8_MAT+DTOS(R8_DATAINI)+R8_TIPO") , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATAATE) ) .OR. FPOSREG("SR8", RETORDER("SR8","R8_FILIAL+R8_MAT+DTOS(R8_DATAFIM)+R8_TIPO") , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATAATE) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','SR8->R8_PD == FGETCODFOL("0786")   .END.','000021','000020','.CON.','5','','','5','SR8->R8_PD == FGETCODFOL("0786")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000022','000021','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0786")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXG += SRC->RC_HORAS     .CNT.','000023','000022','.EXE.','5','NHORBXG += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXG += SRC->RC_VALOR     .END.','000024','000022','.EXE.','5','NVALBXG += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXG > 0 .AND.  ( LOK := !EMPTY(CVERBXG) )   .END.','000025','000021','.CON.','5','','','5','NVALBXG > 0 .AND.  ( LOK := !EMPTY(CVERBXG) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBXG, NHORBX','000026','000025','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBXG, NHORBXG, NVALBXG})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0825")})   .END.','000027','000025','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0825")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBXG','000028','000027','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBXG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXG > 0 .AND. !LOK   .END.','000029','000021','.CON.','5','','','5','NVALBXG > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CMSGLOG := FMSGFORM({19}) + "0233 - " + FDESC("RCN", "0233",','000030','000029','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0233 - " + FDESC("RCN", "0233", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000031','000029','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CVRBXG := FGETCODFOL("0262")     .CNT.','000032','000001','.EXE.','5','CVRBXG := FGETCODFOL("0262")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CVRBXF := FGETCODFOL("0263")     .CNT.','000033','000001','.EXE.','5','CVRBXF := FGETCODFOL("0263")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXF := 0     .CNT.','000034','000001','.EXE.','5','NHORBXF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXG := 0     .CNT.','000035','000001','.EXE.','5','NHORBXG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX := 0     .CNT.','000036','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXG := 0     .CNT.','000037','000001','.EXE.','5','NVALBXG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRG", 1 , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATA','000038','000001','.CON.','5','','','5','FPOSREG("SRG", 1 , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATAATE))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000039','000038','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0086")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXF += SRC->RC_HORAS     .CNT.','000040','000039','.EXE.','5','NHORBXF += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXF += SRC->RC_VALOR     .END.','000041','000039','.EXE.','5','NVALBXF += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000042','000038','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0087")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXF += SRC->RC_HORAS     .CNT.','000043','000042','.EXE.','5','NHORBXF += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXF += SRC->RC_VALOR     .END.','000044','000042','.EXE.','5','NVALBXF += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000045','000038','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("1100")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBXG += SRC->RC_HORAS     .CNT.','000046','000045','.EXE.','5','NHORBXG += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXG += SRC->RC_VALOR     .END.','000047','000045','.EXE.','5','NVALBXG += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXF > 0 .AND. ( LOK := !EMPTY(CVRBXF) )   .END.','000048','000038','.CON.','5','','','5','NVALBXF > 0 .AND. ( LOK := !EMPTY(CVRBXF) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBXF, NHORBXF','000049','000048','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBXF, NHORBXF, NVALBXF})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})   .END.','000050','000048','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBXF','000051','000050','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBXF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXF > 0 .AND. !LOK   .END.','000052','000038','.CON.','5','','','5','NVALBXF > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CMSGLOG := FMSGFORM({19}) + "0263 - " + FDESC("RCN", "0263",','000053','000052','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0263 - " + FDESC("RCN", "0263", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000054','000052','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXG > 0 .AND. ( LOK := !EMPTY(CVRBXG) )   .END.','000055','000038','.CON.','5','','','5','NVALBXG > 0 .AND. ( LOK := !EMPTY(CVRBXG) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBXG, NHORBXG','000056','000055','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBXG, NHORBXG, NVALBXG})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0825")})   .END.','000057','000055','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0825")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBXG','000058','000057','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBXG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBXG > 0 .AND. !LOK   .END.','000059','000038','.CON.','5','','','5','NVALBXG > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CMSGLOG := FMSGFORM({19}) + "0262 - " + FDESC("RCN", "0262",','000060','000059','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0262 - " + FDESC("RCN", "0262", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000061','000059','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0004    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0004( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPROV13','REALIZA BAIXA PROVISAO 13 SALARIO','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPROV13','NTIPOPRV > 1   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CVERBX1 := FGETCODFOL("0332")     .CNT.','000002','000001','.EXE.','5','CVERBX1 := FGETCODFOL("0332")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR','000003','000001','.EXE.','5','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR+DTOS(RC_DATA)")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX := 0     .CNT.','000004','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX := 0     .CNT.','000005','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000006','000001','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0024")+"NAT")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += SRC->RC_HORAS     .CNT.','000007','000006','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRC->RC_VALOR     .END.','000008','000006','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX > 0 .AND. ( LOK := !EMPTY(CVERBX1) )   .END.','000009','000001','.CON.','5','','','5','NVALBX > 0 .AND. ( LOK := !EMPTY(CVERBX1) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX','000010','000009','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX, NVALBX})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRC->RC_VALOR     .END.','000011','000010','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})   .END.','000012','000009','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','000013','000012','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX > 0 .AND. !LOK   .END.','000014','000001','.CON.','5','','','5','NVALBX > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CMSGLOG := FMSGFORM({19}) + "0332 - " + FDESC("RCN", "0332",','000015','000014','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0332 - " + FDESC("RCN", "0332", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','S_MSGLOG()     .END.','000016','000014','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CVERBX2 := FGETCODFOL("0274")     .CNT.','000017','000001','.EXE.','5','CVERBX2 := FGETCODFOL("0274")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX := 0     .CNT.','000018','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX := 0     .CNT.','000019','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRG", 1 , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATA','000020','000001','.CON.','5','','','5','FPOSREG("SRG", 1 , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATAATE))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000021','000020','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0025")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += SRC->RC_HORAS     .CNT.','000022','000021','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRC->RC_VALOR     .END.','000023','000021','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX > 0 .AND. ( LOK :=  !EMPTY(CVERBX2) )   .END.','000024','000020','.CON.','5','','','5','NVALBX > 0 .AND. ( LOK :=  !EMPTY(CVERBX2) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX2, NHORBX','000025','000024','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX2, NHORBX, NVALBX})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})   .END.','000026','000024','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','000027','000026','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX > 0 .AND. !LOK   .END.','000028','000020','.CON.','5','','','5','NVALBX > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CMSGLOG := FMSGFORM({19}) + "0274 - " + FDESC("RCN", "0274",','000029','000028','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0274 - " + FDESC("RCN", "0274", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','S_MSGLOG()     .END.','000030','000028','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0005    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0005( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALANTFE','CALCULO DE ANTECIPACAO DE FERIAS','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','CALANTFE','CVERBA := FGETCODFOL("1099")     .CNT.','000001','000000','.EXE.','5','CVERBA := FGETCODFOL("1099")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','LOK := !EMPTY(CVERBA)   .END.','000002','000000','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NDIASANT := GETMEMVAR("RH_DFERIAS")     .CNT.','000003','000002','.EXE.','5','NDIASANT := GETMEMVAR("RH_DFERIAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','TYPE("LDUTILFER") # "U" .AND. LDUTILFER   .END.','000004','000002','.CON.','5','','','5','TYPE("LDUTILFER") # "U" .AND. LDUTILFER','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NDIASANT := ( GETMEMVAR('+"'"+'RH_DATAFIM'+"'"+') + 1 ) - GETMEMVAR('+"'"+'RH_','000005','000004','.EXE.','5','NDIASANT := ( GETMEMVAR('+"'"+'RH_DATAFIM'+"'"+') + 1 ) - GETMEMVAR('+"'"+'RH_DATAINI'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NDIASANT := IF( NDIASANT > 30, 30, NDIASANT )','000006','000004','.EXE.','5','NDIASANT := IF( NDIASANT > 30, 30, NDIASANT )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NDIASANT > 0   .END.','000007','000002','.CON.','5','','','5','NDIASANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NDIASCALC := IIF( P_DIASMES == '+"'"+'S'+"'"+' , F_ULTDIA( GETMEMVAR('+"'"+'RH','000008','000007','.EXE.','5','NDIASCALC := IIF( P_DIASMES == '+"'"+'S'+"'"+' , F_ULTDIA( GETMEMVAR('+"'"+'RH_DATABAS'+"'"+') ) , 30 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NVALANTECIP := ( SALMES / NDIASCALC ) * NDIASANT     .CNT.','000009','000007','.EXE.','5','NVALANTECIP := ( SALMES / NDIASCALC ) * NDIASANT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NVALFERANT  := NVALANTECIP     .CNT.','000010','000007','.EXE.','5','NVALFERANT  := NVALANTECIP','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NVALFERANT > 0   .END.','000011','000007','.CON.','5','','','5','NVALFERANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR },{ CVERBA, N','000012','000011','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR },{ CVERBA, NDIASANT , NVALFERANT })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','!LOK   .END.','000013','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','CMSGLOG := FMSGFORM({19}) + "1099 - " + FDESC("RCN", "1099",','000014','000013','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "1099 - " + FDESC("RCN", "1099", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','S_MSGLOG()     .END.','000015','000013','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0006    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0006( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALANTIG','CALCULA ANTIGUIDADE DO FUNCIONARIO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CALANTIG','aMAT := fRetMat(SRA->RA_FILIAL+SRA->RA_MAT)     .CNT.','000001','000000','.EXE.','5','aMAT := fRetMat(SRA->RA_FILIAL+SRA->RA_MAT)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTIG','ANTIGUIDADE := fCalAntig(aMat,3,dDataDem)     .END.','000002','000000','.EXE.','5','ANTIGUIDADE := fCalAntig(aMat,3,dDataDem)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0007    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0007( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCABFA','CALCULA ABONO FAMILIAR','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCABFA','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','VAL(SRA->RA_DEPSF) > 0   .END.','000002','000000','.CON.','5','','','5','VAL(SRA->RA_DEPSF) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','( FTABELA("S008", 01, 04) = NIL )   .END.','000003','000002','.CON.','5','','','5','( FTABELA("S008", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000004','000003','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','CMSGLOG := FMSGFORM({40}) + "S005 - " + FDESC("RCB", "S005",','000005','000003','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S005 - " + FDESC("RCB", "S005", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','S_MSGLOG()     .CNT.','000006','000003','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','FINALFUN()     .END.','000007','000003','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','nValor := fTabela( "S005", 01, 04, )     .CNT.','000008','000002','.EXE.','5','nValor := fTabela( "S005", 01, 04, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','nValor *= VAL(SRA->RA_DEPSF)     .END.','000009','000002','.EXE.','5','nValor *= VAL(SRA->RA_DEPSF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','ABONOFAM := nValor     .END.','000010','000000','.EXE.','5','ABONOFAM := nValor','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0008    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0008( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCADI','CALCULO DO ADIANTAMENTO DE SALARIO','','','020','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCADI','INFORMADO := .F.     .CNT.','000001','000000','.EXE.','5','INFORMADO := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','LOK := FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0006")})','000002','000000','.EXE.','5','LOK := FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0006")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','LOK .AND. FO_GETVAL(@&COBJETO,CCPOTIPO2)=="I"   .END.','000003','000000','.CON.','5','','','5','LOK .AND. FO_GETVAL(@&COBJETO,CCPOTIPO2)=="I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := ROUND(FO_GETVAL(@&COBJETO,CCPOVALOR),2)     .CNT','000004','000003','.EXE.','5','VAL_ADTO := ROUND(FO_GETVAL(@&COBJETO,CCPOVALOR),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','INFORMADO := .T.     .END.','000005','000003','.EXE.','5','INFORMADO := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','!LOK   .END.','000006','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := SALMES * ( SRA->RA_PERCADT / 100 )     .CNT.','000007','000006','.EXE.','5','VAL_ADTO := SALMES * ( SRA->RA_PERCADT / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','LIF := ( MESANO(SRA->RA_ADMISSA) == MESANO(DDATA_PGTO) )','000008','000006','.CON.','5','','','5','LIF := ( MESANO(SRA->RA_ADMISSA) == MESANO(DDATA_PGTO) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','P_ADTOPRO == "S"   .END.','000009','000008','.CON.','5','','','5','P_ADTOPRO == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := ( VAL_ADTO * ( NULT_DIA  -  DAY(SRA->RA_ADMISSA)','000010','000009','.EXE.','5','VAL_ADTO := ( VAL_ADTO * ( NULT_DIA  -  DAY(SRA->RA_ADMISSA) + 1)) / NULT_DIA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','!LIF   .END.','000011','000006','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','LIF2 := (DIASTRAB < P_DIASTBAD)   .END.','000012','000011','.CON.','5','','','5','LIF2 := (DIASTRAB < P_DIASTBAD)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := 0.00     .END.','000013','000012','.EXE.','5','VAL_ADTO := 0.00','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','!LIF2   .END.','000014','000011','.CON.','5','','','5','!LIF2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := ( VAL_ADTO * DIASTRAB ) / IIF(SRA->RA_CATFUNC ==','000015','000014','.EXE.','5','VAL_ADTO := ( VAL_ADTO * DIASTRAB ) / IIF(SRA->RA_CATFUNC == "H",NULT_DIA,30)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := NOROUND( VAL_ADTO,2 )     .END.','000016','000006','.EXE.','5','VAL_ADTO := NOROUND( VAL_ADTO,2 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0009    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0009( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCAJC','CALCULA AJUDA DE CUSTO (NAC / ESTRANG)','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCAJC','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','!EMPTY(SRA->RA_AJUCUS)   .END.','000002','000000','.CON.','5','','','5','!EMPTY(SRA->RA_AJUCUS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','LOK := ( SRA->RA_NACIONA == "204" )   .END.','000003','000002','.CON.','5','','','5','LOK := ( SRA->RA_NACIONA == "204" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','( FTABELA("S008", 01, 04) = NIL )   .END.','000004','000003','.CON.','5','','','5','( FTABELA("S008", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000005','000004','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','CMSGLOG := FMSGFORM({40}) + "S008 - " + FDESC("RCB", "S008",','000006','000004','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S008 - " + FDESC("RCB", "S008", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','S_MSGLOG()     .CNT.','000007','000004','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','FINALFUN()     .END.','000008','000004','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','nValor := fPosTab( "S008", SRA->RA_AJUCUS, "=", 04, , , , 05','000009','000003','.EXE.','5','nValor := fPosTab( "S008", SRA->RA_AJUCUS, "=", 04, , , , 05, )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','!LOK   .END.','000010','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','( FTABELA("S009", 01, 04) = NIL )   .END.','000011','000010','.CON.','5','','','5','( FTABELA("S009", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000012','000011','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','CMSGLOG := FMSGFORM({40}) + "S009 - " + FDESC("RCB", "S009",','000013','000011','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S009 - " + FDESC("RCB", "S009", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','S_MSGLOG()     .CNT.','000014','000011','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','FINALFUN()     .END.','000015','000011','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','nValor := fPosTab( "S009", SRA->RA_AJUCUS, "=", 04, , , , 05','000016','000010','.EXE.','5','nValor := fPosTab( "S009", SRA->RA_AJUCUS, "=", 04, , , , 05, )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','AJCUSTO := nValor     .END.','000017','000000','.EXE.','5','AJCUSTO := nValor','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0010    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0010( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCAJCF','CALCULA AJUDA DE CUSTO FORMACAO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCAJCF','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','!EMPTY(SRA->RA_AJUFOR)   .END.','000002','000000','.CON.','5','','','5','!EMPTY(SRA->RA_AJUFOR)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','( FTABELA("S010", 01, 04) = NIL )   .END.','000003','000002','.CON.','5','','','5','( FTABELA("S010", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000004','000003','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','CMSGLOG := FMSGFORM({40}) + "S010 - " + FDESC("RCB", "S010",','000005','000003','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S010 - " + FDESC("RCB", "S010", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','S_MSGLOG()     .CNT.','000006','000003','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','FINALFUN()     .END.','000007','000003','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','nValor := fPosTab( "S010", SRA->RA_AJUFOR, "=", 04, , , , 05','000008','000002','.EXE.','5','nValor := fPosTab( "S010", SRA->RA_AJUFOR, "=", 04, , , , 05, )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','AJCUSTOFORM := nValor     .END.','000009','000000','.EXE.','5','AJCUSTOFORM := nValor','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0011    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0011( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCAVPR','CALCULA AVISO PREVIO','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCAVPR','nDiasAvPag := 0     .CNT.','000001','000000','.EXE.','5','nDiasAvPag := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nDiasAvDes := 0     .CNT.','000002','000000','.EXE.','5','nDiasAvDes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nVPgAvPrev := 0     .CNT.','000003','000000','.EXE.','5','nVPgAvPrev := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nVDsAvPrev := 0     .CNT.','000004','000000','.EXE.','5','nVDsAvPrev := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','cVrbAvInd := FGETCODFOL("0111")     .CNT.','000005','000000','.EXE.','5','cVrbAvInd := FGETCODFOL("0111")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','cVrbAvTrb := FGETCODFOL("0112")     .CNT.','000006','000000','.EXE.','5','cVrbAvTrb := FGETCODFOL("0112")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','cVrbAvDes := FGETCODFOL("0113")     .CNT.','000007','000000','.EXE.','5','cVrbAvDes := FGETCODFOL("0113")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','EMPTY(cVrbAvTrb) .And. !EMPTY(DDATAAV) .And. (DDATAAV < DD','000008','000000','.CON.','5','','','5','EMPTY(cVrbAvTrb) .And. !EMPTY(DDATAAV) .And. (DDATAAV < DDATADEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','CMSGLOG := FMSGFORM({19}) + "0112 - " + FDESC("RCN", "0112",','000009','000008','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0112 - " + FDESC("RCN", "0112", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','S_MSGLOG()     .CNT.','000010','000008','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','FINALFUN()     .END.','000011','000008','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','FTABELA("S018",01,04) = NIL   .END.','000012','000000','.CON.','5','','','5','FTABELA("S018",01,04) = NIL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','CMSGLOG := FMSGFORM({40}) + "S018 - " + FDESC("RCB", "S018",','000013','000012','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S018 - " + FDESC("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','S_MSGLOG()     .CNT.','000014','000012','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','FINALFUN()     .END.','000015','000012','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000016','000000','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','NPOS > 0   .END.','000017','000000','.CON.','5','','','5','NPOS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','S_CALANTIG()     .CNT.','000018','000017','.EXE.','5','S_CALANTIG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','LOK := ( FTABELA("S015",NPOS,10) == "P" )   .END.','000019','000017','.CON.','5','','','5','LOK := ( FTABELA("S015",NPOS,10) == "P" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nDiasAvPag := FPOSTAB( "S018", "P", "=", 04, ANTIGUIDADE, "<','000020','000019','.EXE.','5','nDiasAvPag := FPOSTAB( "S018", "P", "=", 04, ANTIGUIDADE, "<=", 05, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','!EMPTY(nDiasAvPag)   .END.','000021','000019','.CON.','5','','','5','!EMPTY(nDiasAvPag)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nVPgAvPrev := ROUND( (SALMES / 30) * nDiasAvPag, MSDECIMAIS(','000022','000021','.EXE.','5','nVPgAvPrev := ROUND( (SALMES / 30) * nDiasAvPag, MSDECIMAIS(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','!LOK .And. ( FTABELA("S015",NPOS,10) == "D" )   .END.','000023','000017','.CON.','5','','','5','!LOK .And. ( FTABELA("S015",NPOS,10) == "D" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nDiasAvDes := FPOSTAB( "S018", "D", "=", 04, ANTIGUIDADE, "<','000024','000023','.EXE.','5','nDiasAvDes := FPOSTAB( "S018", "D", "=", 04, ANTIGUIDADE, "<=", 05, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','!EMPTY(nDiasAvDes)   .END.','000025','000023','.CON.','5','','','5','!EMPTY(nDiasAvDes)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nVDsAvPrev := ROUND( (SALMES / 30) * nDiasAvDes, MSDECIMAIS(','000026','000025','.EXE.','5','nVDsAvPrev := ROUND( (SALMES / 30) * nDiasAvDes, MSDECIMAIS(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0012    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0012( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCCOMP','CALCULA COMPENSACAO NA RESCISAO','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCCOMP','nVLRCOMPEN := 0     .CNT.','000001','000000','.EXE.','5','nVLRCOMPEN := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NDIFANTIG := 0     .CNT.','000002','000000','.EXE.','5','NDIFANTIG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NAUXILIAR := 0     .CNT.','000003','000000','.EXE.','5','NAUXILIAR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nBkpAnos := 0     .CNT.','000004','000000','.EXE.','5','nBkpAnos := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000005','000000','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NPOS > 0 .And.  ( FTABELA("S015",NPOS,12) == "S" )   .END.','000006','000000','.CON.','5','','','5','NPOS > 0 .And.  ( FTABELA("S015",NPOS,12) == "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','S_CALANTIG()     .CNT.','000007','000006','.EXE.','5','S_CALANTIG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','ANTIGUIDADE > 0   .END.','000008','000006','.CON.','5','','','5','ANTIGUIDADE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','FTABELA("S019", 01, 04) = NIL   .END.','000009','000008','.CON.','5','','','5','FTABELA("S019", 01, 04) = NIL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000010','000009','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','CMSGLOG := FMSGFORM({40}) + "S019 - " + FDESC("RCB", "S019",','000011','000009','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S019 - " + FDESC("RCB", "S019", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','S_MSGLOG()     .CNT.','000012','000009','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','FINALFUN()     .END.','000013','000009','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','ATAB := {}     .CNT.','000014','000008','.EXE.','5','ATAB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','fRetTab( @aTab, "S019", , , dDataRef, , .T.)     .CNT.','000015','000008','.EXE.','5','fRetTab( @aTab, "S019", , , dDataRef, , .T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nCont := 1     .CNT.','000016','000008','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','LEN(ATAB) > 0   .END.','000017','000008','.CON.','5','','','5','LEN(ATAB) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nCont <= LEN(ATAB)   .END.','000018','000017','.ENQ.','5','','','5','nCont <= LEN(ATAB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nPerc := ATAB[nCont, 06]     .CNT.','000019','000018','.EXE.','5','nPerc := ATAB[nCont, 06]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nAnos := ATAB[nCont, 05]     .CNT.','000020','000018','.EXE.','5','nAnos := ATAB[nCont, 05]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','LOK1 := ( nCont > 1 )   .END.','000021','000018','.CON.','5','','','5','LOK1 := ( nCont > 1 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nBkpAnos := ATAB[(nCont-1), 05]     .END.','000022','000021','.EXE.','5','nBkpAnos := ATAB[(nCont-1), 05]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','LOK := ( ANTIGUIDADE > nAnos )   .END.','000023','000018','.CON.','5','','','5','LOK := ( ANTIGUIDADE > nAnos )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NDIFANTIG := ( nAnos - nBkpAnos )     .END.','000024','000023','.EXE.','5','NDIFANTIG := ( nAnos - nBkpAnos )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','!LOK   .END.','000025','000018','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NDIFANTIG := ( ANTIGUIDADE - nBkpAnos )     .CNT.','000026','000025','.EXE.','5','NDIFANTIG := ( ANTIGUIDADE - nBkpAnos )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nCont += 99     .END.','000027','000025','.EXE.','5','nCont += 99','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NAUXILIAR := ( SALMES * NDIFANTIG * nPerc / 100 )     .CNT.','000028','000018','.EXE.','5','NAUXILIAR := ( SALMES * NDIFANTIG * nPerc / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nVLRCOMPEN += NAUXILIAR     .CNT.','000029','000018','.EXE.','5','nVLRCOMPEN += NAUXILIAR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nCont += 1     .END.','000030','000018','.EXE.','5','nCont += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nVLRCOMPEN := ROUND( nVLRCOMPEN, MSDECIMAIS(1))     .END.','000031','000017','.EXE.','5','nVLRCOMPEN := ROUND( nVLRCOMPEN, MSDECIMAIS(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0013    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0013( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCDSR','Calculo DSR','','000261','051','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh := SRA->RA_SITFOLH     .CNT.','000001','000000','.EXE.','5','cSitFolh := SRA->RA_SITFOLH','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh = " " .END.','000002','000000','.CON.','5','','','5','cSitFolh','=','5','" "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT = "M" .END.','000003','000002','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "M*C*A*P*E*1*2*3*4" .END.','000004','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*A*P*E*1*2*3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Salmes     .CNT.','000005','000004','.EXE.','5','nSalPg     := Salmes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','MESANO(sra->ra_admissa) = cAnoMes .Or. DiasTrab < 30   .EN','000006','000004','.CON.','5','','','5','MESANO(sra->ra_admissa) = cAnoMes .Or. DiasTrab < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg := Round(SalMes / 30 * DiasTrab,2)     .END.','000007','000006','.EXE.','5','nSalPg := Round(SalMes / 30 * DiasTrab,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "H*G" .END.','000008','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))     .','000009','000008','.EXE.','5','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))     .END.','000010','000008','.EXE.','5','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "D" .END.','000011','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := SalDia * Diastrab     .END.','000012','000011','.EXE.','5','nSalPg     := SalDia * Diastrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT = "S" .END.','000013','000002','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','Type("NTOTDIAS") = "U" .END.','000014','000013','.CON.','5','','','5','Type("NTOTDIAS")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nTotDias := 7     .END.','000015','000014','.EXE.','5','nTotDias := 7','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','000016','000013','.EXE.','5','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','DiasDsr > 0 .END.','000017','000013','.CON.','5','','','5','DiasDsr','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nTotdias  := DiasTrab + DiasDsr     .CNT.','000018','000017','.EXE.','5','nTotdias  := DiasTrab + DiasDsr','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotD','000019','000017','.EXE.','5','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotDias-DiasTrab) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nHorasDsr  := nTotDias - DiasTrab     .END.','000020','000017','.EXE.','5','nHorasDsr  := nTotDias - DiasTrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh <> " " .AND. cSitFolh # "D"   .AND.','000021','000000','.CON.','5','','','5','cSitFolh <> " " .AND. cSitFolh # "D"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*1*2*3*4" .END.','000022','000000','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*D*S*A*P*E*1*2*3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))     .EN','000023','000022','.EXE.','5','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','(cSitFolh <> " ") .AND. (cSitFolh # "D") .AND. ! (SRA->RA_','000024','000000','.CON.','5','','','5','(cSitFolh <> " ") .AND. (cSitFolh # "D") .AND. ! (SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*1*2*3*4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','000025','000024','.EXE.','5','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))     .','000026','000024','.EXE.','5','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh = "A" .AND.','000027','000000','.CON.','5','','','5','cSitFolh','=','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT == "S" .END.','000028','000000','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))     .CNT','000029','000028','.EXE.','5','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nHorasDsr  := DiasDsr     .END.','000030','000028','.EXE.','5','nHorasDsr  := DiasDsr','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0014    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0014( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIND','CALCULA INDENIZACAO NA RESCISAO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIND','nVLRINDEN := 0     .CNT.','000001','000000','.EXE.','5','nVLRINDEN := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIND','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000002','000000','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIND','NPOS > 0 .And.  ( FTABELA("S015",NPOS,11) == "S" )   .END.','000003','000000','.CON.','5','','','5','NPOS > 0 .And.  ( FTABELA("S015",NPOS,11) == "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIND','S_CALANTIG()     .CNT.','000004','000003','.EXE.','5','S_CALANTIG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIND','ANTIGUIDADE > 0   .END.','000005','000003','.CON.','5','','','5','ANTIGUIDADE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIND','nVLRINDEN := ROUND( SALMES * ANTIGUIDADE, MSDECIMAIS(1))','000006','000005','.EXE.','5','nVLRINDEN := ROUND( SALMES * ANTIGUIDADE, MSDECIMAIS(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0015    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0015( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCINSS','CALCULO DO INSS','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCINSS','SRA->RA_INSS <> "1"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_INSS <> "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','FIMFORMULA()     .END.','000002','000001','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nPINSSFun := 0     .CNT.','000003','000000','.EXE.','5','nPINSSFun := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nPINSSEmp := 0     .CNT.','000004','000000','.EXE.','5','nPINSSEmp := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSS := 0     .CNT.','000005','000000','.EXE.','5','nBINSS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSSFer := 0     .CNT.','000006','000000','.EXE.','5','nBINSSFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSS13 := 0     .CNT.','000007','000000','.EXE.','5','nBINSS13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVFINSS := 0     .CNT.','000008','000000','.EXE.','5','nVFINSS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVFINSS13 := 0     .CNT.','000009','000000','.EXE.','5','nVFINSS13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVEINSS := 0     .CNT.','000010','000000','.EXE.','5','nVEINSS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVEINSSFer := 0     .CNT.','000011','000000','.EXE.','5','nVEINSSFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVEINSS13 := 0     .CNT.','000012','000000','.EXE.','5','nVEINSS13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','LOK := ( fTabela("S012", 01, 04) = NIL )   .END.','000013','000000','.CON.','5','','','5','LOK := ( fTabela("S012", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000014','000013','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','CMSGLOG := FMSGFORM({40}) + "S012 - " + FDESC("RCB", "S012",','000015','000013','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S012 - " + FDESC("RCB", "S012", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','S_MSGLOG()     .CNT.','000016','000013','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','FINALCALC()     .END.','000017','000013','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','!LOK   .END.','000018','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nPINSSFun := fTabela("S012", 01, 05, )     .CNT.','000019','000018','.EXE.','5','nPINSSFun := fTabela("S012", 01, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nPINSSEmp := fTabela("S012", 01, 04, )     .CNT.','000020','000018','.EXE.','5','nPINSSEmp := fTabela("S012", 01, 04, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSS := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS", "R','000021','000018','.EXE.','5','nBINSS := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS", "RV_REFFER", "RV_REF13"}, {"S", "N* ", "N* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSS > 0   .END.','000022','000018','.CON.','5','','','5','nBINSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVFINSS := (nBINSS * nPINSSFun ) / 100     .CNT.','000023','000022','.EXE.','5','nVFINSS := (nBINSS * nPINSSFun ) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVEINSS := (nBINSS * nPINSSEmp) / 100     .END.','000024','000022','.EXE.','5','nVEINSS := (nBINSS * nPINSSEmp) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSSFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS",','000025','000018','.EXE.','5','nBINSSFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS", "RV_REFFER", "RV_REF13"}, {"S", "S", "N* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSSFer > 0   .END.','000026','000018','.CON.','5','','','5','nBINSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVFINSSFer := (nBINSSFer * nPINSSFun ) / 100     .CNT.','000027','000026','.EXE.','5','nVFINSSFer := (nBINSSFer * nPINSSFun ) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVEINSSFer := (nBINSSFer * nPINSSEmp ) / 100     .END.','000028','000026','.EXE.','5','nVEINSSFer := (nBINSSFer * nPINSSEmp ) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSS13 := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS",','000029','000018','.EXE.','5','nBINSS13 := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS", "RV_REFFER", "RV_REF13"}, {"S", "N* ", "S"} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nBINSS13 > 0   .END.','000030','000018','.CON.','5','','','5','nBINSS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVFINSS13 := (nBINSS13 * nPINSSFun ) / 100     .CNT.','000031','000030','.EXE.','5','nVFINSS13 := (nBINSS13 * nPINSSFun ) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCINSS','nVEINSS13 := (nBINSS13 * nPINSSEmp) / 100     .END.','000032','000030','.EXE.','5','nVEINSS13 := (nBINSS13 * nPINSSEmp) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0016    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0016( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIRT','CALCULO IMPOSTO DE RENDA','','','011','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIRT','SRA->RA_IRT <> "1"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_IRT <> "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','FIMFORMULA()     .END.','000002','000001','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := 0     .CNT.','000003','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nResult := 0     .CNT.','000004','000000','.EXE.','5','nResult := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','cTabela := "S013"     .CNT.','000005','000000','.EXE.','5','cTabela := "S013"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRT := 0     .CNT.','000006','000000','.EXE.','5','nBIRT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRTFer := 0     .CNT.','000007','000000','.EXE.','5','nBIRTFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRT13 := 0     .CNT.','000008','000000','.EXE.','5','nBIRT13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT := 0     .CNT.','000009','000000','.EXE.','5','nPerIRT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRTFer := 0     .CNT.','000010','000000','.EXE.','5','nPerIRTFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT13 := 0     .CNT.','000011','000000','.EXE.','5','nPerIRT13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRT := 0     .CNT.','000012','000000','.EXE.','5','nVLRIRT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRTFer := 0     .CNT.','000013','000000','.EXE.','5','nVLRIRTFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRT13 := 0     .CNT.','000014','000000','.EXE.','5','nVLRIRT13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','LOK := ( FTABELA("S013", 01, 04) = NIL )   .END.','000015','000000','.CON.','5','','','5','LOK := ( FTABELA("S013", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','Gera LOG dizendo que Tabela nao foi encontrada     .CNT.','000016','000015','.MSG.','5','Gera LOG dizendo que Tabela nao foi encontrada','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','CMSGLOG := FMSGFORM({40}) + "S013 - " + FDESC("RCB", "S013",','000017','000015','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S013 - " + FDESC("RCB", "S013", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','S_MSGLOG()     .CNT.','000018','000015','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','FINALCALC()     .END.','000019','000015','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := 0     .CNT.','000020','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRT := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_R','000021','000000','.EXE.','5','nBIRT := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_REFFER", "RV_REF13"}, {"S", "N* ", "N* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRt > 0   .END.','000022','000000','.CON.','5','','','5','nBIRt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := FPOSTAB(cTabela, nBIRT, "<=" , 04 )     .CNT.','000023','000022','.EXE.','5','nAux := FPOSTAB(cTabela, nBIRT, "<=" , 04 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux > 0   .END.','000024','000022','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT := FTABELA(cTabela, nAux, 07, )     .CNT.','000025','000024','.EXE.','5','nPerIRT := FTABELA(cTabela, nAux, 07, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT > 0   .END.','000026','000024','.CON.','5','','','5','nPerIRT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nExcesso := FTABELA(cTabela, nAux, 05, )     .CNT.','000027','000026','.EXE.','5','nExcesso := FTABELA(cTabela, nAux, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nParcFixa := FTABELA(cTabela, nAux, 06, )     .CNT.','000028','000026','.EXE.','5','nParcFixa := FTABELA(cTabela, nAux, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nResult := (nBIRT - nExcesso) * nPerIRT / 100     .CNT.','000029','000026','.EXE.','5','nResult := (nBIRT - nExcesso) * nPerIRT / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRT := (nResult + nParcFixa)     .END.','000030','000026','.EXE.','5','nVLRIRT := (nResult + nParcFixa)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := 0     .CNT.','000031','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRTFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "R','000032','000000','.EXE.','5','nBIRTFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_REFFER", "RV_REF13"}, {"S", "S", "N* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRTFer > 0   .END.','000033','000000','.CON.','5','','','5','nBIRTFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := FPOSTAB(cTabela, nBIRTFer, "<=" , 04 )     .CNT.','000034','000033','.EXE.','5','nAux := FPOSTAB(cTabela, nBIRTFer, "<=" , 04 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux > 0   .END.','000035','000033','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRTFer := FTABELA(cTabela, nAux, 07, )     .CNT.','000036','000035','.EXE.','5','nPerIRTFer := FTABELA(cTabela, nAux, 07, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRTFer > 0   .END.','000037','000035','.CON.','5','','','5','nPerIRTFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nExcesso := FTABELA(cTabela, nAux, 05, )     .CNT.','000038','000037','.EXE.','5','nExcesso := FTABELA(cTabela, nAux, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nParcFixa := FTABELA(cTabela, nAux, 06, )     .CNT.','000039','000037','.EXE.','5','nParcFixa := FTABELA(cTabela, nAux, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nResult := (nBIRTFer - nExcesso) * nPerIRTFer / 100     .CNT','000040','000037','.EXE.','5','nResult := (nBIRTFer - nExcesso) * nPerIRTFer / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRTFer := (nResult + nParcFixa)     .END.','000041','000037','.EXE.','5','nVLRIRTFer := (nResult + nParcFixa)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := 0     .CNT.','000042','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRT13 := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV','000043','000000','.EXE.','5','nBIRT13 := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_REFFER", "RV_REF13"}, {"S", "N* ", "S"} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRT13 > 0   .END.','000044','000000','.CON.','5','','','5','nBIRT13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := FPOSTAB(cTabela, nBIRT13, "<=" , 04 )     .CNT.','000045','000044','.EXE.','5','nAux := FPOSTAB(cTabela, nBIRT13, "<=" , 04 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux > 0   .END.','000046','000044','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT13 := FTABELA(cTabela, nAux, 07 )     .CNT.','000047','000046','.EXE.','5','nPerIRT13 := FTABELA(cTabela, nAux, 07 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT13 > 0   .END.','000048','000046','.CON.','5','','','5','nPerIRT13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nExcesso := FTABELA(cTabela, nAux, 05, )     .CNT.','000049','000048','.EXE.','5','nExcesso := FTABELA(cTabela, nAux, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nParcFixa := FTABELA(cTabela, nAux, 06, )     .CNT.','000050','000048','.EXE.','5','nParcFixa := FTABELA(cTabela, nAux, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nResult := (nBIRT13 - nExcesso) * nPerIRT13 / 100     .CNT.','000051','000048','.EXE.','5','nResult := (nBIRT13 - nExcesso) * nPerIRT13 / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRT13 := (nResult + nParcFixa)     .END.','000052','000048','.EXE.','5','nVLRIRT13 := (nResult + nParcFixa)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0017    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0017( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCNAT','CALCULO DO SUBISIDIO DE NATAL','','','029','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCNAT','lCalc := .T.     .CNT.','000001','000000','.EXE.','5','lCalc := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','cTipoRot == "4"   .END.','000002','000000','.CON.','5','','','5','cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000003','000002','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NPOS > 0 .And.  ( FTABELA("S015",NPOS,9) == "S" )   .END.','000004','000002','.CON.','5','','','5','NPOS > 0 .And.  ( FTABELA("S015",NPOS,9) == "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','lCalc := .T.     .END.','000005','000004','.EXE.','5','lCalc := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NPOS > 0 .And.  ( FTABELA("S015",NPOS,9) == "N" )   .END.','000006','000002','.CON.','5','','','5','NPOS > 0 .And.  ( FTABELA("S015",NPOS,9) == "N" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','lCalc := .F.     .END.','000007','000006','.EXE.','5','lCalc := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','lCalc   .END.','000008','000000','.CON.','5','','','5','lCalc','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','obtem dados da tabela auxiliar     .CNT.','000009','000008','.MSG.','5','obtem dados da tabela auxiliar','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','EMPTY(NPERCNAT) .AND. EMPTY(NMINDIASNAT)   .END.','000010','000008','.CON.','5','','','5','EMPTY(NPERCNAT) .AND. EMPTY(NMINDIASNAT)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','ATAB := {}     .CNT.','000011','000010','.EXE.','5','ATAB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','FRETTAB(@ATAB,"S014",,,DDATAREF)     .CNT.','000012','000010','.EXE.','5','FRETTAB(@ATAB,"S014",,,DDATAREF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','LTAB := !EMPTY(ATAB)   .END.','000013','000010','.CON.','5','','','5','LTAB := !EMPTY(ATAB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NPERCNAT := ATAB[5]     .CNT.','000014','000013','.EXE.','5','NPERCNAT := ATAB[5]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NMINDIASNAT := ATAB[6]     .END.','000015','000013','.EXE.','5','NMINDIASNAT := ATAB[6]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','!LTAB   .END.','000016','000010','.CON.','5','','','5','!LTAB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014"','000017','000016','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','S_MSGLOG()     .CNT.','000018','000016','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','FINALCALC()     .END.','000019','000016','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','obtem meses completos de trabalho     .CNT.','000020','000008','.MSG.','5','obtem meses completos de trabalho','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','AAFAST := {}     .CNT.','000021','000008','.EXE.','5','AAFAST := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRINAT := MAX(FIRSTYDATE(VAL(LEFT(CANOMES,4))), SRA->RA_ADM','000022','000008','.EXE.','5','DPRINAT := MAX(FIRSTYDATE(VAL(LEFT(CANOMES,4))), SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRINAUX := MAX(FIRSTYDATE(VAL(LEFT(CANOMES,4))), SRA->RA_AD','000023','000008','.EXE.','5','DPRINAUX := MAX(FIRSTYDATE(VAL(LEFT(CANOMES,4))), SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DULTNAT := MIN(LASTYDATE(VAL(LEFT(CANOMES,4))), DDATAATE)','000024','000008','.EXE.','5','DULTNAT := MIN(LASTYDATE(VAL(LEFT(CANOMES,4))), DDATAATE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','CTIPOROT == "4"   .END.','000025','000008','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DULTNAT := MIN(DULTNAT, DDATADEM)     .END.','000026','000025','.EXE.','5','DULTNAT := MIN(DULTNAT, DDATADEM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASAFA := 0     .CNT.','000027','000008','.EXE.','5','NDIASAFA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASMES := 30     .CNT.','000028','000008','.EXE.','5','NDIASMES := 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NAVOS := 0     .CNT.','000029','000008','.EXE.','5','NAVOS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRINAUX <= DULTNAT   .END.','000030','000008','.ENQ.','5','','','5','DPRINAUX <= DULTNAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRI1 := DPRINAUX + F_ULTDIA(DPRINAUX) - 1     .CNT.','000031','000030','.EXE.','5','DPRI1 := DPRINAUX + F_ULTDIA(DPRINAUX) - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','fBuscaAfast(DPRINAUX,DPRI1,@aAfast)     .CNT.','000032','000030','.EXE.','5','fBuscaAfast(DPRINAUX,DPRI1,@aAfast)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','Len(aAfast) > 0   .END.','000033','000030','.CON.','5','','','5','Len(aAfast) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','Aeval( aAfast, { |x| iif( x[06]=="1" , nDiasAfa += x[11] , 0','000034','000033','.EXE.','5','Aeval( aAfast, { |x| iif( x[06]=="1" , nDiasAfa += x[11] , 0 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','P_DIASMES = "S"   .END.','000035','000030','.CON.','5','','','5','P_DIASMES = "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASMES := F_ULTDIA(DPRINAUX)     .END.','000036','000035','.EXE.','5','NDIASMES := F_ULTDIA(DPRINAUX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','CTIPOROT == "4" .AND. MESANO(DPRINAUX) == MESANO(DULTNAT)','000037','000030','.CON.','5','','','5','CTIPOROT == "4" .AND. MESANO(DPRINAUX) == MESANO(DULTNAT)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASMES := DAY(DDATADEM)     .END.','000038','000037','.EXE.','5','NDIASMES := DAY(DDATADEM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','(NDIASMES - NDIASAFA) >= NMINDIASNAT   .END.','000039','000030','.CON.','5','','','5','(NDIASMES - NDIASAFA) >= NMINDIASNAT','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NAVOS++     .END.','000040','000039','.EXE.','5','NAVOS++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRINAUX := DPRI1 + 1     .END.','000041','000030','.EXE.','5','DPRINAUX := DPRI1 + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','calcula o valor a pagar     .CNT.','000042','000008','.MSG.','5','calcula o valor a pagar','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NVALNATAL := SALMES * NPERCNAT / 100     .CNT.','000043','000008','.EXE.','5','NVALNATAL := SALMES * NPERCNAT / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NVALNATAL := ROUND(NVALNATAL / 12 * NAVOS,2)     .END.','000044','000008','.EXE.','5','NVALNATAL := ROUND(NVALNATAL / 12 * NAVOS,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0018    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0018( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCSBAL','CALCULA SUBSIDIO ALIMENTACAO','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCSBAL','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nDias := 0     .CNT.','000002','000000','.EXE.','5','nDias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','!EMPTY(SRA->RA_SUBALIM)   .END.','000003','000000','.CON.','5','','','5','!EMPTY(SRA->RA_SUBALIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','( FTABELA("S006", 01, 04) = NIL )   .END.','000004','000003','.CON.','5','','','5','( FTABELA("S006", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000005','000004','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','CMSGLOG := FMSGFORM({40}) + "S006 - " + FDESC("RCB", "S006",','000006','000004','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S006 - " + FDESC("RCB", "S006", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','S_MSGLOG()     .CNT.','000007','000004','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','FINALFUN()     .END.','000008','000004','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nPos := fPosTab( "S006", SRA->RA_SUBALIM, "=", 04, , , , , )','000009','000003','.EXE.','5','nPos := fPosTab( "S006", SRA->RA_SUBALIM, "=", 04, , , , , )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nVlrDia := fTabela( "S006", nPos, 05, )     .CNT.','000010','000003','.EXE.','5','nVlrDia := fTabela( "S006", nPos, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nVlrMes := fTabela( "S006", nPos, 06, )     .CNT.','000011','000003','.EXE.','5','nVlrMes := fTabela( "S006", nPos, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','cProp := fTabela( "S006", nPos, 07, )     .CNT.','000012','000003','.EXE.','5','cProp := fTabela( "S006", nPos, 07, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','FPOSREG("RCF", 2, XFILIAL("RCF")+CPROCESSO+CPERIODO)   .EN','000013','000003','.CON.','5','','','5','FPOSREG("RCF", 2, XFILIAL("RCF")+CPROCESSO+CPERIODO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','NDIAS := RCF->RCF_DIATRA     .END.','000014','000013','.EXE.','5','NDIAS := RCF->RCF_DIATRA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','LOK := (NDIAS > 0 .AND. CPROP == "S")   .END.','000015','000003','.CON.','5','','','5','LOK := (NDIAS > 0 .AND. CPROP == "S")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nDescRGB := FO_SOMAALLREGS(@oRGB,"RGB_HORAS",{ "RGB_PD" },{','000016','000015','.EXE.','5','nDescRGB := FO_SOMAALLREGS(@oRGB,"RGB_HORAS",{ "RGB_PD" },{ FGETCODFOL("0054") })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','NDIAS -= nDescRGB     .CNT.','000017','000015','.EXE.','5','NDIAS -= nDescRGB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','NDIAS -= NDIASAFAS     .CNT.','000018','000015','.EXE.','5','NDIAS -= NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nDias := MAX( nDias , 0 )     .END.','000019','000015','.EXE.','5','nDias := MAX( nDias , 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nVlrDia > 0   .END.','000020','000003','.CON.','5','','','5','nVlrDia > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nValor := NDIAS * nVlrDia     .END.','000021','000020','.EXE.','5','nValor := NDIAS * nVlrDia','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nVlrMes > 0   .END.','000022','000003','.CON.','5','','','5','nVlrMes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nValor := (NVLRMES / RCF->RCF_DIATRA * NDIAS)     .END.','000023','000022','.EXE.','5','nValor := (NVLRMES / RCF->RCF_DIATRA * NDIAS)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','DIASUBALIM := nDias     .CNT.','000024','000000','.EXE.','5','DIASUBALIM := nDias','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','SUBALIMENT := nValor     .END.','000025','000000','.EXE.','5','SUBALIMENT := nValor','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0019    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0019( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCSBTR','CALCULA SUBSIDIO TRANSPORTE','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCSBTR','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nDias := 0     .CNT.','000002','000000','.EXE.','5','nDias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','!EMPTY(SRA->RA_SUBTRAN)   .END.','000003','000000','.CON.','5','','','5','!EMPTY(SRA->RA_SUBTRAN)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','( FTABELA("S007", 01, 04) = NIL )   .END.','000004','000003','.CON.','5','','','5','( FTABELA("S007", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000005','000004','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','CMSGLOG := FMSGFORM({40}) + "S007 - " + FDESC("RCB", "S007",','000006','000004','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S007 - " + FDESC("RCB", "S007", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','S_MSGLOG()     .CNT.','000007','000004','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','FINALFUN()     .END.','000008','000004','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nPos := fPosTab( "S007", SRA->RA_SUBTRAN, "=", 04, , , , , )','000009','000003','.EXE.','5','nPos := fPosTab( "S007", SRA->RA_SUBTRAN, "=", 04, , , , , )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nVlrDia := FTABELA( "S007", NPOS, 05, )     .CNT.','000010','000003','.EXE.','5','nVlrDia := FTABELA( "S007", NPOS, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nVlrMes := FTABELA( "S007", NPOS, 06, )     .CNT.','000011','000003','.EXE.','5','nVlrMes := FTABELA( "S007", NPOS, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','cProp := FTABELA( "S007", NPOS, 07, )     .CNT.','000012','000003','.EXE.','5','cProp := FTABELA( "S007", NPOS, 07, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','FPOSREG("RCF", 2, XFILIAL("RCF")+CPROCESSO+CPERIODO)   .EN','000013','000003','.CON.','5','','','5','FPOSREG("RCF", 2, XFILIAL("RCF")+CPROCESSO+CPERIODO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nDias := RCF->RCF_DIATRA     .END.','000014','000013','.EXE.','5','nDias := RCF->RCF_DIATRA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','LOK := (nDias > 0 .And. CPROP == "S")   .END.','000015','000003','.CON.','5','','','5','LOK := (nDias > 0 .And. CPROP == "S")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','NDESCRGB := FO_SOMAALLREGS(@ORGB,"RGB_HORAS",{"RGB_PD"},{ FG','000016','000015','.EXE.','5','NDESCRGB := FO_SOMAALLREGS(@ORGB,"RGB_HORAS",{"RGB_PD"},{ FGETCODFOL("0054") })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','NDIAS -= NDESCRGB     .CNT.','000017','000015','.EXE.','5','NDIAS -= NDESCRGB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nDias -= NDIASAFAS     .CNT.','000018','000015','.EXE.','5','nDias -= NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nDias := MAX( nDias , 0 )     .END.','000019','000015','.EXE.','5','nDias := MAX( nDias , 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nVlrDia > 0   .END.','000020','000003','.CON.','5','','','5','nVlrDia > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nValor := nDias * nVlrDia     .END.','000021','000020','.EXE.','5','nValor := nDias * nVlrDia','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nVlrMes > 0   .END.','000022','000003','.CON.','5','','','5','nVlrMes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nValor := (nVlrMes / RCF->RCF_DIATRA * nDias)     .END.','000023','000022','.EXE.','5','nValor := (nVlrMes / RCF->RCF_DIATRA * nDias)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','DIASUBTRANS := nDias     .CNT.','000024','000000','.EXE.','5','DIASUBTRANS := nDias','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','SUBTRANSP := nValor     .END.','000025','000000','.EXE.','5','SUBTRANSP := nValor','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0020    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0020( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCSFER','CALCULO DO SUBSIDIO DE FERIAS','','','011','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCSFER','ATAB := {}     .CNT.','000001','000000','.EXE.','5','ATAB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','FRETTAB(@ATAB,"S004",,,DDATABASE)     .CNT.','000002','000000','.EXE.','5','FRETTAB(@ATAB,"S004",,,DDATABASE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','LEN(ATAB) > 0   .END.','000003','000000','.CON.','5','','','5','LEN(ATAB) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NPERC := ATAB[10]     .CNT.','000004','000003','.EXE.','5','NPERC := ATAB[10]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NDIASFER := GETMEMVAR("RH_DFERIAS")     .CNT.','000005','000003','.EXE.','5','NDIASFER := GETMEMVAR("RH_DFERIAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','TYPE("LDUTILFER") # "U" .AND. LDUTILFER   .END.','000006','000003','.CON.','5','','','5','TYPE("LDUTILFER") # "U" .AND. LDUTILFER','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NDIASFER := ( GETMEMVAR('+"'"+'RH_DATAFIM'+"'"+') + 1 ) - GETMEMVAR('+"'"+'RH_','000007','000006','.EXE.','5','NDIASFER := ( GETMEMVAR('+"'"+'RH_DATAFIM'+"'"+') + 1 ) - GETMEMVAR('+"'"+'RH_DATAINI'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NDIASFER := IF( NDIASFER > 30, 30, NDIASFER )     .END.','000008','000006','.EXE.','5','NDIASFER := IF( NDIASFER > 30, 30, NDIASFER )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NDIASMES := IF(P_DIASMES="S",DAY(DDATAATE),30)     .CNT.','000009','000003','.EXE.','5','NDIASMES := IF(P_DIASMES="S",DAY(DDATAATE),30)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NVALFERIAS := SALMES * ( NPERC / 100 )     .CNT.','000010','000003','.EXE.','5','NVALFERIAS := SALMES * ( NPERC / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NVALFERIAS := NVALFERIAS / NDIASMES * NDIASFER     .CNT.','000011','000003','.EXE.','5','NVALFERIAS := NVALFERIAS / NDIASMES * NDIASFER','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NVALFERIAS > 0   .END.','000012','000003','.CON.','5','','','5','NVALFERIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL','000013','000012','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL("0072"), NDIASFER , NVALFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0021    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0021( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALFERES','CALCULO DE FERIAS NA RESCISAO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALFERES','ATAB := {}     .CNT.','000001','000000','.EXE.','5','ATAB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','FRETTAB(@ATAB,"S004",,,DDATABASE)     .CNT.','000002','000000','.EXE.','5','FRETTAB(@ATAB,"S004",,,DDATABASE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','LEN(ATAB) > 0   .END.','000003','000000','.CON.','5','','','5','LEN(ATAB) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NPERC := ATAB[10]     .CNT.','000004','000003','.EXE.','5','NPERC := ATAB[10]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDIASMES := IF(P_DIASMES="S",DAY(DDATAATE),30)     .CNT.','000005','000003','.EXE.','5','NDIASMES := IF(P_DIASMES="S",DAY(DDATAATE),30)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NSALFERIAS := SALMES     .CNT.','000006','000003','.EXE.','5','NSALFERIAS := SALMES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NSUBFERIAS := NSALFERIAS * ( NPERC / 100 )     .CNT.','000007','000003','.EXE.','5','NSUBFERIAS := NSALFERIAS * ( NPERC / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','CALCULO DE SUBSIDIO PROPORCIONAL     .CNT.','000008','000003','.MSG.','5','CALCULO DE SUBSIDIO PROPORCIONAL','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDSUBPRO  := GETMEMVAR('+"'"+'RG_DSUBAVE'+"'"+')     .CNT.','000009','000003','.EXE.','5','NDSUBPRO  := GETMEMVAR('+"'"+'RG_DSUBAVE'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS := NSUBFERIAS / NDIASMES * NDSUBPRO     .CNT.','000010','000003','.EXE.','5','NVALFERIAS := NSUBFERIAS / NDIASMES * NDSUBPRO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS > 0   .END.','000011','000003','.CON.','5','','','5','NVALFERIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFERES','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL','000012','000011','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL("0087"), NDSUBPRO , NVALFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','CALCULO DE SUBSIDIO VENCIDAS     .CNT.','000013','000003','.MSG.','5','CALCULO DE SUBSIDIO VENCIDAS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDSUBVEN := GETMEMVAR('+"'"+'RG_DSUBVEN'+"'"+')     .CNT.','000014','000003','.EXE.','5','NDSUBVEN := GETMEMVAR('+"'"+'RG_DSUBVEN'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS := NSUBFERIAS / NDIASMES * NDSUBVEN     .CNT.','000015','000003','.EXE.','5','NVALFERIAS := NSUBFERIAS / NDIASMES * NDSUBVEN','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS > 0   .END.','000016','000003','.CON.','5','','','5','NVALFERIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFERES','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL','000017','000016','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL("0086"), NDSUBVEN , NVALFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','CALCULO DE DIAS DE FERIAS NAO GOZADAS     .CNT.','000018','000003','.MSG.','5','CALCULO DE DIAS DE FERIAS NAO GOZADAS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDIASPRO := GETMEMVAR("RG_DFERPRO")     .CNT.','000019','000003','.EXE.','5','NDIASPRO := GETMEMVAR("RG_DFERPRO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDIASVEN := GETMEMVAR("RG_DFERVEN")     .CNT.','000020','000003','.EXE.','5','NDIASVEN := GETMEMVAR("RG_DFERVEN")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDIASFER := NDIASPRO + NDIASVEN     .CNT.','000021','000003','.EXE.','5','NDIASFER := NDIASPRO + NDIASVEN','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS := NSALFERIAS / NDIASMES * NDIASFER     .CNT.','000022','000003','.EXE.','5','NVALFERIAS := NSALFERIAS / NDIASMES * NDIASFER','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS > 0   .END.','000023','000003','.CON.','5','','','5','NVALFERIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFERES','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL','000024','000023','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL("1100"), NDIASFER , NVALFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0022    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0022( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCF','Carrega Periodos','','001046','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCF','lRotBlank := .F.     .CNT.','000001','000000','.EXE.','5','lRotBlank := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cKey :=  xFilial( "RCH" ) + cProcesso + cPeriodo + cNumPag +','000002','000000','.EXE.','5','cKey :=  xFilial( "RCH" ) + cProcesso + cPeriodo + cNumPag + c__roteiro','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','nIndice := RETORDER("RCF", "RCF_FILIAL+RCF_PROCES+RCF_PER+RC','000003','000000','.EXE.','5','nIndice := RETORDER("RCF", "RCF_FILIAL+RCF_PROCES+RCF_PER+RCF_SEMANA+RCF_ROTEIR+RCF_TNOTRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','fPosPeriodo( xFilial( "RCH" ), cProcesso, cPeriodo, cNumPa','000004','000000','.CON.','5','','','5','fPosPeriodo( xFilial( "RCH" ), cProcesso, cPeriodo, cNumPag, c__roteiro, , @lRotBlank, 1 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cKey := xFilial("RCF") + cProcesso + cPeriodo + cNumPag + If','000005','000004','.EXE.','5','cKey := xFilial("RCF") + cProcesso + cPeriodo + cNumPag + If( lRotBlank, Space(3),  c__Roteiro )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','fo_New( @oRCF , "RCF" , nIndice , cKey )     .END.','000006','000000','.EXE.','5','fo_New( @oRCF , "RCF" , nIndice , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0023    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0023( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCH','Carrega Periodos de Calculo','','001047','034','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCH','cPeriodo := GetPeriodCalc()   .CNT.','000001','000000','.EXE.','5','cPeriodo',':=','5','GetPeriodCalc()','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cNumPag := GetNumPgCalc()   .CNT.','000002','000000','.EXE.','5','cNumPag',':=','5','GetNumPgCalc()','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cProcesso := SRA->RA_PROCES   .CNT.','000003','000000','.EXE.','5','cProcesso',':=','5','SRA->RA_PROCES','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','nRchOrd := RetOrder( "RCH" , "RCH_FILIAL+RCH_PROCES+RCH_PER+','000004','000000','.EXE.','5','nRchOrd := RetOrder( "RCH" , "RCH_FILIAL+RCH_PROCES+RCH_PER+RCH_NUMPAG+RCH_ROTEIR" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000005','000000','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo + cNumPag + c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_Eof(@oRCH)   .END.','000006','000000','.CON.','5','','','5','fo_Eof(@oRCH)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000007','000006','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo + cNumPag + "   ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_Eof(@oRCH) .And. cTipoRot == "9"   .END.','000008','000000','.CON.','5','','','5','fo_Eof(@oRCH) .And. cTipoRot == "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000009','000008','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo +  "  " + "   ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataDe := fo_GetVal(@oRCH, "RCH_DTINI", 1)   .CNT.','000010','000000','.EXE.','5','dDataDe',':=','5','fo_GetVal(@oRCH, "RCH_DTINI", 1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataAte := fo_GetVal(@oRCH, "RCH_DTFIM", 1)   .CNT.','000011','000000','.EXE.','5','dDataAte',':=','5','fo_GetVal(@oRCH, "RCH_DTFIM", 1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cAnoMes  := fo_GetVal(@oRCH, "RCH_ANO", 1) + fo_GetVal(@oRCH','000012','000000','.EXE.','5','cAnoMes  := fo_GetVal(@oRCH, "RCH_ANO", 1) + fo_GetVal(@oRCH, "RCH_MES",1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPAGO", 1)     .CNT.','000013','000000','.EXE.','5','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPAGO", 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataref := CTOD("01/" + fo_getVal(@oRCH, "RCH_MES", 1) + "/','000014','000000','.EXE.','5','dDataref',':=','5','CTOD("01/" + fo_getVal(@oRCH, "RCH_MES", 1) + "/" + fo_getVal(@oRCH, "RCH_ANO", 1))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fPosReg("SRY", 1, xFIlial("SRY") + c__Roteiro)     .CNT.','000015','000000','.EXE.','5','fPosReg("SRY", 1, xFIlial("SRY") + c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cTipoRot := SRY->RY_TIPO   .END.','000016','000000','.EXE.','5','cTipoRot',':=','5','SRY->RY_TIPO','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','EMPTY(DDATAREF) .OR. EMPTY(CANOMES) .OR. EMPTY(DDATADE) .O','000017','000000','.CON.','5','','','5','EMPTY(DDATAREF) .OR. EMPTY(CANOMES) .OR. EMPTY(DDATADE) .OR. EMPTY(DDATAATE) .OR. EMPTY(DDATA_PGTO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CMSGLOG := FMSGFORM({}) + "A configuração dos periodos está','000018','000017','.EXE.','5','CMSGLOG := FMSGFORM({}) + "A configuração dos periodos está incorreta ou não existem dados válidos no período que está sendo calculado. Verifique o cadastro de períodos."','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','S_MSGLOG()     .CNT.','000019','000017','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','FINALCALC()','000020','000017','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0024    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0024( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCM','Carrega Tipo de Ausencia','','001048','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCM','fo_New(@oRCM, "RCM", 1, xFIlial("RCM"))     .END.','000001','000000','.EXE.','5','fo_New(@oRCM, "RCM", 1, xFIlial("RCM"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0025    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0025( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARG1','CARGA RG1','','','032','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARG1','cRetOrder := "RG1_FILIAL+RG1_MAT+RG1_ORDEM+RG1_PD+DTOS(RG1_D','000001','000000','.EXE.','5','cRetOrder := "RG1_FILIAL+RG1_MAT+RG1_ORDEM+RG1_PD+DTOS(RG1_DINIPG)"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','nRG1Order := RetOrder( "RG1" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nRG1Order := RetOrder( "RG1" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','LSQLWHERE := .T.     .CNT.','000004','000000','.EXE.','5','LSQLWHERE := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','LTOPFILTER := .T.     .CNT.','000005','000000','.EXE.','5','LTOPFILTER := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cTipoRot = "3"   .END.','000006','000000','.CON.','5','','','5','cTipoRot = "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cAnoMes := MesAno(GetMemVar("RH_DATAINI") )     .END.','000007','000006','.EXE.','5','cAnoMes := MesAno(GetMemVar("RH_DATAINI") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','( LTOP := IFDEFTOP() )   .END.','000008','000000','.CON.','5','','','5','( LTOP := IFDEFTOP() )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere := "RG1_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " +','000009','000008','.EXE.','5','cQueryWhere := "RG1_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "RG1_MAT='+"'"+'" + SRA->RA_MAT + "'+"'"+' AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "  RG1_DINIPG<= '+"'"+'" + CANOMES +  StrZero(f_Ult','000010','000008','.EXE.','5','cQueryWhere += "  RG1_DINIPG<= '+"'"+'" + CANOMES +  StrZero(f_Ultdia(dDataRef),2) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " AND "     .CNT.','000011','000008','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "( RG1_DFIMPG =  '+"'"+'        '+"'"+' "+ " or " + "RG1_','000012','000008','.EXE.','5','cQueryWhere','+=','5','"( RG1_DFIMPG =  '+"'"+'        '+"'"+' "+ " or " + "RG1_DFIMPG >= '+"'"+'" + CANOMES + '+"'"+'01'+"'"+' + "'+"'"+'  ) "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " AND "     .CNT.','000013','000008','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "D_E_L_E_T_<> '+"'"+'*'+"'"+' "     .END.','000014','000008','.EXE.','5','cQueryWhere += "D_E_L_E_T_<> '+"'"+'*'+"'"+' "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','!LTOP   .END.','000015','000000','.CON.','5','','','5','!LTOP','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere := "  DTOS(RG1_DINIPG) <= '+"'"+'" + CANOMES +  StrZer','000016','000015','.EXE.','5','cQueryWhere := "  DTOS(RG1_DINIPG) <= '+"'"+'" + CANOMES +  StrZero(f_Ultdia(dDataRef),2) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " .AND. "     .CNT.','000017','000015','.EXE.','5','cQueryWhere += " .AND. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " (DTOS(RG1_DFIMPG) == '+"'"+'        '+"'"+'  .OR. DTOS(','000018','000015','.EXE.','5','cQueryWhere += " (DTOS(RG1_DFIMPG) == '+"'"+'        '+"'"+'  .OR. DTOS(RG1_DFIMPG)  >='+"'"+'" + CANOMES +'+"'"+'01'+"'"+'+"'+"'"+' ) "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','FO_NEW(@oRG1 , "RG1",nRG1Order , cKey , cQueryWhere, @lSqlWh','000019','000000','.EXE.','5','FO_NEW(@oRG1 , "RG1",nRG1Order , cKey , cQueryWhere, @lSqlWhere , @lTopFilter)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0026    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0026( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARGB','CARGA TABELA RGB','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARGB','GetRgb()     .END.','000001','000000','.EXE.','5','GetRgb()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0027    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0027( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASR8','Carrega Ausencias','','001049','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASR8','GetSr8()     .END.','000001','000000','.EXE.','5','GetSr8()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0028    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0028( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRB','CARGA SRB','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRB','cRetOrder := "RB_FILIAL+RB_MAT"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RB_FILIAL+RB_MAT"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','nSrbOrder := RetOrder( "SRB" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSrbOrder := RetOrder( "SRB" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','FO_NEW(@oSRB , "SRB",nSrbOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oSRB , "SRB",nSrbOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0029    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0029( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRC','CARREGA LANCAMENTOS','','001050','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRC','GetSrc()     .END.','000001','000000','.EXE.','5','GetSrc()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0030    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0030( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRF','CARREGA SRF','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRF','cRetOrder := "RF_FILIAL+RF_MAT+DTOS(RF_DATABAS)"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RF_FILIAL+RF_MAT+DTOS(RF_DATABAS)"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','nSRFOrder := RetOrder( "SRF" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSRFOrder := RetOrder( "SRF" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','FO_NEW(@oSRF , "SRF",nSRFOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oSRF , "SRF",nSRFOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0031    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0031( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRK','CARREGA VALORES FUTUROS','','001051','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRK','GetSrk()     .END.','000001','000000','.EXE.','5','GetSrk()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0032    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0032( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGATAB','CARREGA INFORMACOES DA TABELA','','000320','008','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGATAB','cTipoRot $ "3*4" .END.','000001','000000','.CON.','5','','','5','cTipoRot','$','5','"3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cObjeto := "oSRR"   .CNT.','000002','000001','.EXE.','5','cObjeto',':=','5','"oSRR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoCC := "RR_CC"   .CNT.','000003','000001','.EXE.','5','cCpoCC',':=','5','"RR_CC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoData := "RR_DATA"   .CNT.','000004','000001','.EXE.','5','cCpoData',':=','5','"RR_DATA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHoras := "RR_HORAS"   .CNT.','000005','000001','.EXE.','5','cCpoHoras',':=','5','"RR_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHorInf := "RR_HORINFO"   .CNT.','000006','000001','.EXE.','5','cCpoHorInf',':=','5','"RR_HORINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNPagto := "RR_SEMANA"   .CNT.','000007','000001','.EXE.','5','cCpoNPagto',':=','5','"RR_SEMANA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNumID := "RR_NUMID"   .CNT.','000008','000001','.EXE.','5','cCpoNumID',':=','5','"RR_NUMID"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPD := "RR_PD"   .CNT.','000009','000001','.EXE.','5','cCpoPD',':=','5','"RR_PD"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoSeq := "RR_SEQ"   .CNT.','000010','000001','.EXE.','5','cCpoSeq',':=','5','"RR_SEQ"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo1 := "RR_TIPO1"   .CNT.','000011','000001','.EXE.','5','cCpoTipo1',':=','5','"RR_TIPO1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo2 := "RR_TIPO2"   .CNT.','000012','000001','.EXE.','5','cCpoTipo2',':=','5','"RR_TIPO2"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValor := "RR_VALOR"   .CNT.','000013','000001','.EXE.','5','cCpoValor',':=','5','"RR_VALOR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValInf := "RR_VALINFO"   .CNT.','000014','000001','.EXE.','5','cCpoValInf',':=','5','"RR_VALINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMat := "RR_MAT"   .CNT.','000015','000001','.EXE.','5','cCpoMat',':=','5','"RR_MAT"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoRot := "RR_ROTEIR"   .CNT.','000016','000001','.EXE.','5','cCpoRot',':=','5','"RR_ROTEIR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPer := "RR_PERIODO"   .CNT.','000017','000001','.EXE.','5','cCpoPer',':=','5','"RR_PERIODO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoFilial := "RR_FILIAL"     .CNT.','000018','000001','.EXE.','5','cCpoFilial := "RR_FILIAL"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoProc := "RR_PROCES"     .CNT.','000019','000001','.EXE.','5','cCpoProc := "RR_PROCES"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDepto := "RR_DEPTO"     .END.','000020','000001','.EXE.','5','cCpoDepto := "RR_DEPTO"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','!(cTipoRot $ "3*4")   .END.','000021','000000','.CON.','5','','','5','!(cTipoRot $ "3*4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cObjeto := "oSRC"   .CNT.','000022','000021','.EXE.','5','cObjeto',':=','5','"oSRC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoCC := "RC_CC"   .CNT.','000023','000021','.EXE.','5','cCpoCC',':=','5','"RC_CC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoData := "RC_DATA"   .CNT.','000024','000021','.EXE.','5','cCpoData',':=','5','"RC_DATA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHoras := "RC_HORAS"   .CNT.','000025','000021','.EXE.','5','cCpoHoras',':=','5','"RC_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHorInf := "RC_HORINFO"   .CNT.','000026','000021','.EXE.','5','cCpoHorInf',':=','5','"RC_HORINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNPagto := "RC_SEMANA"   .CNT.','000027','000021','.EXE.','5','cCpoNPagto',':=','5','"RC_SEMANA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNumID := "RC_NUMID"   .CNT.','000028','000021','.EXE.','5','cCpoNumID',':=','5','"RC_NUMID"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPD := "RC_PD"   .CNT.','000029','000021','.EXE.','5','cCpoPD',':=','5','"RC_PD"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoQtdSem := "RC_QTDSEM"   .CNT.','000030','000021','.EXE.','5','cCpoQtdSem',':=','5','"RC_QTDSEM"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoSeq := "RC_SEQ"   .CNT.','000031','000021','.EXE.','5','cCpoSeq',':=','5','"RC_SEQ"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo1 := "RC_TIPO1"   .CNT.','000032','000021','.EXE.','5','cCpoTipo1',':=','5','"RC_TIPO1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo2 := "RC_TIPO2"   .CNT.','000033','000021','.EXE.','5','cCpoTipo2',':=','5','"RC_TIPO2"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValInf := "RC_VALINFO"   .CNT.','000034','000021','.EXE.','5','cCpoValInf',':=','5','"RC_VALINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValor := "RC_VALOR"   .CNT.','000035','000021','.EXE.','5','cCpoValor',':=','5','"RC_VALOR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMat := "RC_MAT"   .CNT.','000036','000021','.EXE.','5','cCpoMat',':=','5','"RC_MAT"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoParcel := "RC_PARCELA"   .CNT.','000037','000021','.EXE.','5','cCpoParcel',':=','5','"RC_PARCELA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoRot := "RC_ROTEIR"   .CNT.','000038','000021','.EXE.','5','cCpoRot',':=','5','"RC_ROTEIR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPer := "RC_PERIODO"   .CNT.','000039','000021','.EXE.','5','cCpoPer',':=','5','"RC_PERIODO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDtRef := "RC_DTREF"   .CNT.','000040','000021','.EXE.','5','cCpoDtRef',':=','5','"RC_DTREF"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoFilial := "RC_FILIAL"     .CNT.','000041','000021','.EXE.','5','cCpoFilial := "RC_FILIAL"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPosto := "RC_POSTO"     .CNT.','000042','000021','.EXE.','5','cCpoPosto := "RC_POSTO"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoProc := "RC_PROCES"     .CNT.','000043','000021','.EXE.','5','cCpoProc := "RC_PROCES"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDepto := "RC_DEPTO"     .END.','000044','000021','.EXE.','5','cCpoDepto := "RC_DEPTO"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0033    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0033( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CHKFUNC','FAZ VERIFICACOES INICIAIS DO FUNCIONARIO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','CHKFUNC','nOpc := 0     .CNT.','000001','000000','.EXE.','5','nOpc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','Roteiro de Folha de Pagto.     .CNT.','000002','000000','.MSG.','5','Roteiro de Folha de Pagto.','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','CTIPOROT $ "1"   .END.','000003','000000','.CON.','5','','','5','CTIPOROT $ "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','SRA->RA_ADMISSA > DDATAATE   .END.','000004','000003','.CON.','5','','','5','SRA->RA_ADMISSA > DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','FinalFun()     .END.','000005','000004','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','!EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDATADE','000006','000003','.CON.','5','','','5','!EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDATADE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','FinalFun()     .END.','000007','000006','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','Roteiro de Adiantamento     .CNT.','000008','000000','.MSG.','5','Roteiro de Adiantamento','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','CTIPOROT $ "2"   .END.','000009','000000','.CON.','5','','','5','CTIPOROT $ "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','!EMPTY(SRA->RA_DEMISSA) .OR. SRA->RA_PERCADT <= 0   .END.','000010','000009','.CON.','5','','','5','!EMPTY(SRA->RA_DEMISSA) .OR. SRA->RA_PERCADT <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','FinalFun()     .END.','000011','000010','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','SRA->RA_TIPOPGT = "S" .OR. SRA->RA_ADMISSA > DDATAREF   .E','000012','000009','.CON.','5','','','5','SRA->RA_TIPOPGT = "S" .OR. SRA->RA_ADMISSA > DDATAREF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','FinalFun()     .END.','000013','000012','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','Roteiro de 13o.Salario     .CNT.','000014','000000','.MSG.','5','Roteiro de 13o.Salario','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','CTIPOROT $ "5/6"   .END.','000015','000000','.CON.','5','','','5','CTIPOROT $ "5/6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','!EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDATAATE','000016','000015','.CON.','5','','','5','!EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','FinalFun()     .END.','000017','000016','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','ANOMES(SRA->RA_ADMISSA) > ANOMES(DDATAATE)   .END.','000018','000015','.CON.','5','','','5','ANOMES(SRA->RA_ADMISSA) > ANOMES(DDATAATE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','FinalFun()     .END.','000019','000018','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0034    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0034( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DELVERBA','DELETA VERBAS DO OBJETO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','DELVERBA','FO_GOTOP(@&COBJETO)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DELVERBA','!FO_EOF(@&COBJETO)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','DELVERBA','FO_DELETE(@&COBJETO)     .CNT.','000003','000002','.EXE.','5','FO_DELETE(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DELVERBA','FO_SKIP(@&COBJETO)     .END.','000004','000002','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0035    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0035( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DESCNAT','DESCONTO SUBSIDIO DE NATAL ANTECIPADO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','DESCNAT','obtem valor antecipado para desconto     .CNT.','000001','000000','.MSG.','5','obtem valor antecipado para desconto','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','NVALOR := 0     .CNT.','000002','000000','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','AVERBAS := FBUSCAACM(,'+"'"+'SRV->RV_REF13 = "S"'+"'"+', DPRINAT, DULTNA','000003','000000','.EXE.','5','AVERBAS := FBUSCAACM(,'+"'"+'SRV->RV_REF13 = "S"'+"'"+', DPRINAT, DULTNAT, "V", , , '+"'"+'FOL'+"'"+', .T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','LEN(AVERBAS) > 0   .END.','000004','000000','.CON.','5','','','5','LEN(AVERBAS) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','AEVAL(AVERBAS, {|X| NVALOR += X[3]})     .CNT.','000005','000004','.EXE.','5','AEVAL(AVERBAS, {|X| NVALOR += X[3]})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','NVALOR > 0   .END.','000006','000004','.CON.','5','','','5','NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {FGETCODFOL("0023"),','000007','000006','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {FGETCODFOL("0023"), NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0036    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0036( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DIASANTF','DIAS ANTECIPADOS EM FERIAS','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','DIASANTF','cVerbPagF := fGetCodFol("1099")     .CNT.','000001','000000','.EXE.','5','cVerbPagF := fGetCodFol("1099")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','cVerbAntF := fGetCodFol("1105")     .CNT.','000002','000000','.EXE.','5','cVerbAntF := fGetCodFol("1105")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nValAntF := 0     .CNT.','000003','000000','.EXE.','5','nValAntF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nDiasAnt := 0     .END.','000004','000000','.EXE.','5','nDiasAnt := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','FPOSREG("SRH", 4, SRA->RA_FILIAL+SRA->RA_MAT+CPERIODO)   .','000005','000000','.CON.','5','','','5','FPOSREG("SRH", 4, SRA->RA_FILIAL+SRA->RA_MAT+CPERIODO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','FPOSREG("SRR", 5, SRA->RA_FILIAL+SRA->RA_MAT+DTOS(SRH->RH_','000006','000005','.CON.','5','','','5','FPOSREG("SRR", 5, SRA->RA_FILIAL+SRA->RA_MAT+DTOS(SRH->RH_DTRECIB)+CVERBPAGF)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nValAntF := SRR->RR_VALOR     .CNT.','000007','000006','.EXE.','5','nValAntF := SRR->RR_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nDiasAnt := SRR->RR_HORAS     .END.','000008','000006','.EXE.','5','nDiasAnt := SRR->RR_HORAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nValAntF > 0   .END.','000009','000005','.CON.','5','','','5','nValAntF > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { cVerbAn','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { cVerbAntF , nDiasAnt , nValAntF } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0037    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0037( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DIASTRAB','DIAS/HOR TRAB E DIAS/HOR DSR','','000830','073','2','1',} )

aAdd(aRc3Cols, { '','S_','DIASTRAB','!fo_Seek(@oRCF, "RCF_TNOTRA", SRA->RA_TNOTRAB)   .END.','000001','000000','.CON.','5','','','5','!fo_Seek(@oRCF, "RCF_TNOTRA", SRA->RA_TNOTRAB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fo_Seek(@oRCF, "RCF_TNOTRA",  "@@@")     .END.','000002','000001','.EXE.','5','fo_Seek(@oRCF, "RCF_TNOTRA",  "@@@")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','NORMAL :=  fo_GetVal(@oRCF , "RCF_HRSTRA")     .CNT.','000003','000000','.EXE.','5','NORMAL :=  fo_GetVal(@oRCF , "RCF_HRSTRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DESCANSO := fo_GetVal(@oRCF , "RCF_HRSDSR")     .CNT.','000004','000000','.EXE.','5','DESCANSO := fo_GetVal(@oRCF , "RCF_HRSDSR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*P*A*E*I*1*2*3*4*5*6"','000005','000000','.EXE.','5','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*P*A*E*I*1*2*3*4*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_SITFOLH == " "  .and. MesAno(sra->ra_admissa) < cA','000006','000000','.CON.','5','','','5','SRA->RA_SITFOLH == " "  .and. MesAno(sra->ra_admissa) < cAnoMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasDSR := fo_GetVal(@oRCF, "RCF_DIADSR")     .CNT.','000007','000006','.EXE.','5','DiasDSR := fo_GetVal(@oRCF, "RCF_DIADSR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasDSR := DESCANSO     .CNT.','000008','000006','.EXE.','5','nHorasDSR := DESCANSO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasTrab := NORMAL     .CNT.','000009','000006','.EXE.','5','nHorasTrab := NORMAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "M" .END.','000010','000006','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .T.   .END.','000011','000010','.CON.','5','','','5','lCatMensal == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM")     .END.','000012','000011','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .F.   .END.','000013','000010','.CON.','5','','','5','lCatMensal == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA") + fo_GetVal(@oRCF','000014','000013','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA") + fo_GetVal(@oRCF, "RCF_DIADSR") + fo_GetVal(@oRCF, "RCF_DNTRAB")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "S" .END.','000015','000006','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA")     .END.','000016','000015','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_SITFOLH <> " " .or. MesAno(SRA->RA_ADMISSA) == cAn','000017','000000','.CON.','5','','','5','SRA->RA_SITFOLH <> " " .or. MesAno(SRA->RA_ADMISSA) == cAnoMes .Or. (cPaisLoc == "ANG" .And. nDiasAfas > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHoras','000018','000017','.EXE.','5','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHorasDSR , @nHorasTrab , , , , cNumPag, .T., , , c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .T.   .AND.','000019','000017','.CON.','5','','','5','lCatMensal == .T.','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "M" .END.','000020','000017','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM") - nDiasAfas     .','000021','000020','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM") - nDiasAfas','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','MesAno(SRA->RA_ADMISSA) = cAnoMes .and. Day(SRA->RA_ADMISS','000022','000020','.CON.','5','','','5','MesAno(SRA->RA_ADMISSA) = cAnoMes .and. Day(SRA->RA_ADMISSA) > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas     .','000023','000022','.EXE.','5','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes := fo_getVal(@ORCH, "RCH_MES",  1)   .CNT.','000024','000020','.EXE.','5','cMes',':=','5','fo_getVal(@ORCH, "RCH_MES",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cAno := fo_getVal(@ORCH, "RCH_ANO",  1)   .CNT.','000025','000020','.EXE.','5','cAno',':=','5','fo_getVal(@ORCH, "RCH_ANO",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR.','000026','000020','.CON.','5','','','5','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR. (cMes $ "04*06*09*11" .AND. nDiasAfas == 30)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000027','000026','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas ==','000028','000020','.CON.','5','','','5','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas == 28) .OR.  (VAL(cAno) % 4 == 0 .AND. nDiasAfas == 29) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000029','000028','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0038    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0038( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DTRABRES','DIAS TRABALHADOS NA RESCISAO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB := DATEDIFFDAY(MAX(DDATADE,SRA->RA_ADMISSA), MIN(DD','000001','000000','.EXE.','5','DIASTRAB := DATEDIFFDAY(MAX(DDATADE,SRA->RA_ADMISSA), MIN(DDATAATE,DDATADEM)) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB -= NDIASAFAS     .CNT.','000002','000000','.EXE.','5','DIASTRAB -= NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB := MAX(DIASTRAB,0)     .CNT.','000003','000000','.EXE.','5','DIASTRAB := MAX(DIASTRAB,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','( SRA->RA_CATFUNC $ "M*C*P*A*E*I" ) .AND. ( DAY(DDATADEM)','000004','000000','.CON.','5','','','5','( SRA->RA_CATFUNC $ "M*C*P*A*E*I" ) .AND. ( DAY(DDATADEM) > 30 .OR. ( MONTH(DDATADEM) == 2 .AND. DAY(DDATADEM) == F_ULTDIA(DDATADEM) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB := 30     .END.','000005','000004','.EXE.','5','DIASTRAB := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0039    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0039( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FCALARRE','CALCULA ARREDONDAMENTO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','FCALARRE','nResto := Mod(nVlrTot , nArred)   .CNT.','000001','000000','.EXE.','5','nResto',':=','5','Mod(nVlrTot , nArred)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','Round(nResto,2) > 0 .END.','000002','000000','.CON.','5','','','5','Round(nResto,2)','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrArre := (nArred - nResto )   .CNT.','000003','000002','.EXE.','5','nVlrArre',':=','5','(nArred - nResto )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrTot := (nVlrTot + nVlrArre )   .END.','000004','000002','.EXE.','5','nVlrTot',':=','5','(nVlrTot + nVlrArre )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','Round(nResto,2) <= 0 .END.','000005','000000','.CON.','5','','','5','Round(nResto,2)','<=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrArre := 0   .END.','000006','000005','.EXE.','5','nVlrArre',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0040    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0040( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FLIQFERI','LIQUIDOS DE FERIAS','','','022','2','1',} )

aAdd(aRc3Cols, { '','S_','FLIQFERI','nVAL_ARRE := VLR_INS := 0.00     .CNT.','000001','000000','.EXE.','5','nVAL_ARRE := VLR_INS := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NARRED := P_ARREDFE     .CNT.','000002','000000','.EXE.','5','NARRED := P_ARREDFE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq +=  FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000003','000000','.EXE.','5','nValLiq +=  FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "1" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq +=  FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000004','000000','.EXE.','5','nValLiq +=  FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "2" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','DDTRECIB := If(Empty(dDtRecibo), GetMemVar("RH_RECIB"), dDtR','000005','000000','.EXE.','5','DDTRECIB := If(Empty(dDtRecibo), GetMemVar("RH_RECIB"), dDtRecibo )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NARRED > 0   .END.','000006','000000','.CON.','5','','','5','NARRED > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NVLRTOT := nValLiq     .CNT.','000007','000006','.EXE.','5','NVLRTOT := nValLiq','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nSALV_ARR := NARRED     .CNT.','000008','000006','.EXE.','5','nSALV_ARR := NARRED','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','S_FCALARRE()     .CNT.','000009','000006','.EXE.','5','S_FCALARRE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValArrFe := nSalv_Arr     .CNT.','000010','000006','.EXE.','5','nValArrFe := nSalv_Arr','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nVLRARRE > 0   .END.','000011','000006','.CON.','5','','','5','nVLRARRE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoData},{FGETCODFOL("01','000012','000011','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoData},{FGETCODFOL("0104"),nVLRARRE, dDtRecibo}, cCpoPD, fGetCodFol("0104"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq += nVLRARRE     .END.','000013','000006','.EXE.','5','nValLiq += nVLRARRE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq > 0   .END.','000014','000000','.CON.','5','','','5','nValLiq > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor, cCpoData},{FGETCODFOL("0','000015','000014','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor, cCpoData},{FGETCODFOL("0102"),nValLiq, dDtRecibo}, cCpoPD, fGetCodfol("0102") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0041    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0041( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FLIQUIDO','GERA VALOR LIQUIDO','','','038','2','1',} )

aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot $ "1|9" .END.','000001','000000','.CON.','5','','','5','cTipoRot','$','5','"1|9"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0047")   .CNT.','000002','000001','.EXE.','5','cCodliq',':=','5','fGetCodFol("0047")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := P_ARREDFO   .CNT.','000003','000001','.EXE.','5','nArred',':=','5','P_ARREDFO','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := fGetCodFol("0043")   .CNT.','000004','000001','.EXE.','5','cCodArred',':=','5','fGetCodFol("0043")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Empty(cCodArred)   .END.','000005','000001','.CON.','5','','','5','Empty(cCodArred)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000006','000005','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CMSGLOG := FMSGFORM({19}) + "0043 - " + FDESC("RCN", "0043",','000007','000005','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0043 - " + FDESC("RCN", "0043", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','S_MSGLOG()     .END.','000008','000005','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .T.   .CNT.','000009','000001','.EXE.','5','lIns',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := If(cPaisLoc <> "URU", fGetCodFol("0045"), Space(3','000010','000001','.EXE.','5','cCodIns',':=','5','If(cPaisLoc <> "URU", fGetCodFol("0045"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := If(cPaisLoc <> "PAR", .T. , .F. )   .CNT.','000011','000001','.EXE.','5','lObrigat',':=','5','If(cPaisLoc <> "PAR", .T. , .F. )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000012','000001','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "6" .END.','000013','000000','.CON.','5','','','5','cTipoRot','==','5','"6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0021")   .CNT.','000014','000013','.EXE.','5','cCodliq',':=','5','fGetCodFol("0021")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := If(cPaisLoc  $ "ARG|CHI|DOM" , 0, P_ARRED13)   .CN','000015','000013','.EXE.','5','nArred',':=','5','If(cPaisLoc  $ "ARG|CHI|DOM" , 0, P_ARRED13)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := Iif(cPaisLoc $ "BRA|ARG|ANG", fGetCodFol("0026"','000016','000013','.EXE.','5','cCodArred := Iif(cPaisLoc $ "BRA|ARG|ANG", fGetCodFol("0026") , Space(3) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cPaisLoc $ "BRA|ARG|ANG" .And. Empty(cCodArred)   .END.','000017','000013','.CON.','5','','','5','cPaisLoc $ "BRA|ARG|ANG" .And. Empty(cCodArred)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000018','000017','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CMSGLOG := FMSGFORM({19}) + "0026 - " + FDESC("RCN", "0026",','000019','000017','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0026 - " + FDESC("RCN", "0026", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','S_MSGLOG()     .END.','000020','000017','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := If(cPaisLoc == "BRA", .T. , .F. )   .CNT.','000021','000013','.EXE.','5','lIns',':=','5','If(cPaisLoc == "BRA", .T. , .F. )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := fGetCodFol("0030")   .CNT.','000022','000013','.EXE.','5','cCodIns',':=','5','fGetCodFol("0030")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .F.   .CNT.','000023','000013','.EXE.','5','lObrigat',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000024','000013','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "5" .END.','000025','000000','.CON.','5','','','5','cTipoRot','==','5','"5"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodLiq := If(cPaisLoc $ "ARG|URU|DOM" , fGetCodFol("0021"),','000026','000025','.EXE.','5','cCodLiq',':=','5','If(cPaisLoc $ "ARG|URU|DOM" , fGetCodFol("0021"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := If(cPaisLoc $ "ARG|DOM", 0, If(lArredonda,P_ARRED1','000027','000025','.EXE.','5','nArred',':=','5','If(cPaisLoc $ "ARG|DOM", 0, If(lArredonda,P_ARRED13,0) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := If(cPaisLoc == "URU", fGetCodFol("0026"), Space','000028','000025','.EXE.','5','cCodArred',':=','5','If(cPaisLoc == "URU", fGetCodFol("0026"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .F.   .CNT.','000029','000025','.EXE.','5','lIns',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lCodIns := Space(4)   .CNT.','000030','000025','.EXE.','5','lCodIns',':=','5','Space(4)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .CNT.','000031','000025','.EXE.','5','lDemiss',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .F.   .END.','000032','000025','.EXE.','5','lObrigat',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "4" .END.','000033','000000','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0126")   .CNT.','000034','000033','.EXE.','5','cCodliq',':=','5','fGetCodFol("0126")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := 0   .CNT.','000035','000033','.EXE.','5','nArred',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := Space(3)   .CNT.','000036','000033','.EXE.','5','cCodArred',':=','5','Space(3)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .T.   .CNT.','000037','000033','.EXE.','5','lIns',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := fGetCodFol("0045")   .CNT.','000038','000033','.EXE.','5','cCodIns',':=','5','fGetCodFol("0045")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .T.   .CNT.','000039','000033','.EXE.','5','lObrigat',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000040','000033','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat := 0   .CNT.','000041','000000','.EXE.','5','nObrigat',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cProxNum := "  "   .CNT.','000042','000000','.EXE.','5','cProxNum',':=','5','"  "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000043','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := 0   .CNT.','000044','000000','.EXE.','5','nLiquido',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000045','000000','.EXE.','5','nLiquido',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "1" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido += FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000046','000000','.EXE.','5','nLiquido','+=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "2" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat == .T. .END.','000047','000000','.CON.','5','','','5','lObrigat','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_GOTOP(@&cObjeto)     .CNT.','000048','000047','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_EOF(@&cObjeto)   .END.','000049','000047','.ENQ.','5','','','5','!FO_EOF(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_GETVAL(@&cObjeto, cCpoNPagto) == cNumPag .AND.','000050','000049','.CON.','5','','','5','FO_GETVAL(@&cObjeto, cCpoNPagto)','==','5','cNumPag','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_DELETED(@&cObjeto)   .AND.','000051','000049','.CON.','5','','','5','!FO_DELETED(@&cObjeto)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','POSSRV(FO_GETVAL(@&cObjeto, cCpoPd) , SRA->RA_FILIAL, "RV_','000052','000049','.CON.','5','','','5','POSSRV(FO_GETVAL(@&cObjeto, cCpoPd) , SRA->RA_FILIAL, "RV_OBRIGAT" )','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat += FO_GETVAL(@&cObjeto, cCpoValor )   .END.','000053','000052','.EXE.','5','nObrigat','+=','5','FO_GETVAL(@&cObjeto, cCpoValor )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_SKIP(@&cObjeto)     .END.','000054','000049','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Type("P_CALCINF") != "U" .and. P_CALCINF == "S"   .END.','000055','000000','.CON.','5','','','5','Type("P_CALCINF") != "U" .and. P_CALCINF == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat := 0   .END.','000056','000055','.EXE.','5','nObrigat',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVAL_ARRE := NVLR_INS := 0.00     .CNT.','000057','000000','.EXE.','5','nVAL_ARRE := NVLR_INS := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( nLiquido < 0  .Or.  ( lObrigat .and. nliquido < nObrigat','000058','000000','.CON.','5','','','5','( nLiquido < 0  .Or.  ( lObrigat .and. nliquido < nObrigat) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns == .T. .END.','000059','000000','.CON.','5','','','5','lIns','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := 0   .CNT.','000060','000059','.EXE.','5','nVlr_ins',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!( cSitFolh $ "D*E" )   .OR.','000061','000059','.CON.','5','','','5','!( cSitFolh $ "D*E" )','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( cSitFolh == "D" .and. lDemiss== .T. )   .END.','000062','000059','.CON.','5','','','5','( cSitFolh == "D" .and. lDemiss== .T. )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) < 0 .OR.','000063','000062','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','<','5','0','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( lObrigat == .T.  .And. Round(nLiquido, MsDecimais(1) ) <','000064','000062','.CON.','5','','','5','( lObrigat == .T.  .And. Round(nLiquido, MsDecimais(1) ) < nObrigat )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) < 0 .END.','000065','000064','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := (nLiquido * -1) + nObrigat   .CNT.','000066','000065','.EXE.','5','nVlr_ins',':=','5','(nLiquido * -1) + nObrigat','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := nObrigat   .END.','000067','000065','.EXE.','5','nLiquido',':=','5','nObrigat','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) > 0 .AND.','000068','000064','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat == .T. .END.','000069','000064','.CON.','5','','','5','lObrigat','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := nObrigat - nLiquido   .CNT.','000070','000069','.EXE.','5','nVlr_ins',':=','5','nObrigat - nLiquido','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := nObrigat   .END.','000071','000069','.EXE.','5','nLiquido',':=','5','nObrigat','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','! ( !( cSitFolh $ "D*E" ) .or. ( cSitFolh == "D" .and. lDe','000072','000059','.CON.','5','','','5','! ( !( cSitFolh $ "D*E" ) .or. ( cSitFolh == "D" .and. lDemiss )  )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round( nLiquido , MsDecimais(1) ) < 0 .END.','000073','000059','.CON.','5','','','5','Round( nLiquido , MsDecimais(1) )','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := ( nLiquido * -1 )   .END.','000074','000073','.EXE.','5','nVlr_ins',':=','5','( nLiquido * -1 )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred > 0 .AND.','000075','000000','.CON.','5','','','5','nArred','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido > 0 .END.','000076','000000','.CON.','5','','','5','nLiquido','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := Round( nLiquido, MsDecimais(1) )   .CNT.','000077','000076','.EXE.','5','nLiquido',':=','5','Round( nLiquido, MsDecimais(1) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CCODARRED <> SPACE(4) .AND.','000078','000076','.CON.','5','','','2','CCODARRED','<>','5','SPACE(4)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_SEEK(@&cObjeto, {cCpoPd, cCpoNPagto } , { cCodArred, c','000079','000076','.CON.','5','','','5','!FO_SEEK(@&cObjeto, {cCpoPd, cCpoNPagto } , { cCodArred, cNumPag }  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nSALV_ARR := nArred   .CNT.','000080','000079','.EXE.','5','nSALV_ARR',':=','5','nArred','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlrTot := nLiquido   .CNT.','000081','000079','.EXE.','5','nVlrTot',':=','5','nLiquido','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','S_FCALARRE()     .CNT.','000082','000079','.EXE.','4','S_FCALARRE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := nSALV_ARR   .CNT.','000083','000079','.EXE.','5','nArred',':=','5','nSALV_ARR','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLIQUIDO := nVlrTot   .CNT.','000084','000079','.EXE.','5','nLIQUIDO',':=','5','nVlrTot','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVal_Arre := nVlrArre   .END.','000085','000079','.EXE.','5','nVal_Arre',':=','5','nVlrArre','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0042    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0042( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAADI','GERACAO DE ADIANTAMENTO','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAADI','CTIPOROT <> "4"   .END.','000001','000000','.CON.','5','','','5','CTIPOROT <> "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cRot := Fo_GetVal(@&cObjeto,cCpoRot)     .CNT.','000002','000001','.EXE.','5','cRot := Fo_GetVal(@&cObjeto,cCpoRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','oSrcBkp := Fo_Clone(@&cObjeto)     .CNT.','000003','000001','.EXE.','5','oSrcBkp := Fo_Clone(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','&cObjeto := NIL     .CNT.','000004','000001','.EXE.','5','&cObjeto := NIL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','GetSrcAdi()     .CNT.','000005','000001','.EXE.','5','GetSrcAdi()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','oSrcAdi := Fo_Clone(@&cObjeto)     .CNT.','000006','000001','.EXE.','5','oSrcAdi := Fo_Clone(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','&cObjeto := Fo_Clone(@oSrcBkp)     .CNT.','000007','000001','.EXE.','5','&cObjeto := Fo_Clone(@oSrcBkp)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Len(oSrcAdi:aCols) > 0   .END.','000008','000001','.CON.','5','','','5','Len(oSrcAdi:aCols) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0006")})   .END.','000009','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0006")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0007"))     .CNT.','000010','000009','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000011','000009','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000012','000009','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0713")})   .END.','000013','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0713")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0008"))     .CNT.','000014','000013','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0008"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000015','000013','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000016','000013','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0010")})   .END.','000017','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0010")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0012"))     .CNT.','000018','000017','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0012"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000019','000017','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000020','000017','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','CTIPOROT == "4"   .END.','000021','000000','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GoTop(@&cObjeto)     .CNT.','000022','000021','.EXE.','5','Fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!Fo_Eof(@&cObjeto)   .END.','000023','000021','.ENQ.','5','','','5','!Fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GetVal(@&cObjeto,cCpoTipo2) == "A"   .END.','000024','000023','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo2) == "A"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)     .CNT.','000025','000024','.EXE.','5','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','LIF := ( cVerba == FGETCODFOL("0006") )   .END.','000026','000024','.CON.','5','','','5','LIF := ( cVerba == FGETCODFOL("0006") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))     .END.','000027','000026','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0713") ) )   .','000028','000024','.CON.','5','','','5','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0713") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0008"))     .END.','000029','000028','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0008"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0010") ) )   .','000030','000024','.CON.','5','','','5','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0010") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0012"))     .END.','000031','000030','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0012"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF   .END.','000032','000024','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Delete(@&cObjeto)     .END.','000033','000032','.EXE.','5','Fo_Delete(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Skip(@&cObjeto)     .END.','000034','000023','.EXE.','5','Fo_Skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0043    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0043( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAFER','GERACAO DE FERIAS NA FOLHA','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAFER','cVerbFer := fGetCodFol("0072")     .CNT.','000001','000000','.EXE.','5','cVerbFer := fGetCodFol("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cVerbAntF := fGetCodFol("1099")     .CNT.','000002','000000','.EXE.','5','cVerbAntF := fGetCodFol("1099")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cVerbLiqF := fGetCodFol("0102")     .CNT.','000003','000000','.EXE.','5','cVerbLiqF := fGetCodFol("0102")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cVerbArr := fGetCodFol("0104")     .CNT.','000004','000000','.EXE.','5','cVerbArr := fGetCodFol("0104")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFer := 0     .CNT.','000005','000000','.EXE.','5','nValFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAntF := 0     .CNT.','000006','000000','.EXE.','5','nValAntF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValArr := 0     .CNT.','000007','000000','.EXE.','5','nValArr := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValLiq := 0     .CNT.','000008','000000','.EXE.','5','nValLiq := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasFer := 0     .CNT.','000009','000000','.EXE.','5','nDiasFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasAnt := 0     .END.','000010','000000','.EXE.','5','nDiasAnt := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FPOSREG("SRR",4,SRA->RA_FILIAL+SRA->RA_MAT+CPERIODO)     .CN','000011','000000','.EXE.','5','FPOSREG("SRR",4,SRA->RA_FILIAL+SRA->RA_MAT+CPERIODO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRR->(!EOF()) .AND. ( SRA->RA_FILIAL+SRA->RA_MAT == SRR->R','000012','000000','.ENQ.','5','','','5','SRR->(!EOF()) .AND. ( SRA->RA_FILIAL+SRA->RA_MAT == SRR->RR_FILIAL+SRR->RR_MAT ) .AND. ( SRR->RR_PERIODO == CPERIODO  )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRR->RR_PD == cVerbFer   .END.','000013','000012','.CON.','5','','','5','SRR->RR_PD == cVerbFer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFer := SRR->RR_VALOR     .CNT.','000014','000013','.EXE.','5','nValFer := SRR->RR_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasFer := SRR->RR_HORAS     .END.','000015','000013','.EXE.','5','nDiasFer := SRR->RR_HORAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRR->RR_PD == cVerbAntF   .END.','000016','000012','.CON.','5','','','5','SRR->RR_PD == cVerbAntF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAntF := SRR->RR_VALOR     .CNT.','000017','000016','.EXE.','5','nValAntF := SRR->RR_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasAnt := SRR->RR_HORAS     .END.','000018','000016','.EXE.','5','nDiasAnt := SRR->RR_HORAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRR->RR_PD == cVerbLiqF   .END.','000019','000012','.CON.','5','','','5','SRR->RR_PD == cVerbLiqF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValLiq := SRR->RR_VALOR     .END.','000020','000019','.EXE.','5','nValLiq := SRR->RR_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRR->RR_PD == cVerbArr   .END.','000021','000012','.CON.','5','','','5','SRR->RR_PD == cVerbArr','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValArr := SRR->RR_VALOR     .END.','000022','000021','.EXE.','5','nValArr := SRR->RR_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRR->(DBSKIP())     .END.','000023','000012','.EXE.','5','SRR->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValfer > 0   .END.','000024','000000','.CON.','5','','','5','nValfer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_SEEK(@&COBJETO, CCPOPD, CVERBFER)   .END.','000025','000024','.CON.','5','','','5','FO_SEEK(@&COBJETO, CCPOPD, CVERBFER)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_SETVAL(@&COBJETO, CCPOHORAS, NDIASFER).CNT.','000026','000025','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOHORAS, NDIASFER)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_SETVAL(@&COBJETO, CCPOVALOR, NVALFER) .END.','000027','000025','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, NVALFER)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!FO_SEEK(@&COBJETO, CCPOPD, CVERBFER)   .END.','000028','000024','.CON.','5','','','5','!FO_SEEK(@&COBJETO, CCPOPD, CVERBFER)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { CVERBFE','000029','000028','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { CVERBFER , NDIASFER , NVALFER } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAntF > 0   .END.','000030','000000','.CON.','5','','','5','nValAntF > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { cVerbAn','000031','000030','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { cVerbAntF , nDiasAnt , nValAntF } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValArr > 0   .END.','000032','000000','.CON.','5','','','5','nValArr > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { cVerbAr','000033','000032','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { cVerbArr , 0 , nValArr } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValLiq > 0   .END.','000034','000000','.CON.','5','','','5','nValLiq > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { fGetCod','000035','000034','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { fGetCodFol("1003") , 0 , nValLiq } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0044    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0044( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAPERI','GERA PERIODOS A PROVISIONAR','','','041','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAPERI','NTIPOPRV <> 2   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV <> 2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','dDtBasFer := SRA->RA_ADMISSA     .CNT.','000002','000001','.EXE.','5','dDtBasFer := SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','cVerba := FGETCODFOL("0072")     .CNT.','000003','000001','.EXE.','5','cVerba := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','S_BASEFER()     .CNT.','000004','000001','.EXE.','5','S_BASEFER()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','Calc_Fer(@aPerFerias,Ctod("31/12/"+StrZero(Year(dDataBase),4','000005','000001','.EXE.','5','Calc_Fer(@aPerFerias,Ctod("31/12/"+StrZero(Year(dDataBase),4)),,,,,,.f.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','Len(aPerFerias) == 0 .And. NTIPOPRV == 1   .END.','000006','000001','.CON.','5','','','5','Len(aPerFerias) == 0 .And. NTIPOPRV == 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FinalFun()     .END.','000007','000006','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont := 1     .CNT.','000008','000001','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont <= Len(aPerFerias)   .END.','000009','000001','.ENQ.','5','','','5','nCont <= Len(aPerFerias)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','LIF := FO_SEEK(@OSRF,{"RF_DATABAS","RF_PD"},{aPerFerias[nC','000010','000009','.CON.','5','','','5','LIF := FO_SEEK(@OSRF,{"RF_DATABAS","RF_PD"},{aPerFerias[nCont,1],cVerba})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_SETVAL(@OSRF,"RF_DFERVAT",aPerFerias[nCont,3])     .CNT.','000011','000010','.EXE.','5','FO_SETVAL(@OSRF,"RF_DFERVAT",aPerFerias[nCont,3])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_SETVAL(@OSRF,"RF_DFERAAT",aPerFerias[nCont,4])     .END.','000012','000010','.EXE.','5','FO_SETVAL(@OSRF,"RF_DFERAAT",aPerFerias[nCont,4])','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nVenc := 0     .CNT.','000013','000012','.EXE.','5','nVenc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','dFim := CTOD("31/12/"+StrZero(Year(dDataAte),4))     .END.','000014','000012','.EXE.','5','dFim := CTOD("31/12/"+StrZero(Year(dDataAte),4))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','!LIF   .END.','000015','000009','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_ADD(@OSRF, {"RF_PD", "RF_DATABAS", "RF_DATAFIM", "RF_DFER','000016','000015','.EXE.','5','FO_ADD(@OSRF, {"RF_PD", "RF_DATABAS", "RF_DATAFIM", "RF_DFERVAT", "RF_DFERAAT", "RF_DIASDIR"}, {cVerba, aPerFerias[nCont,1], aPerFerias[nCont,2], aPerFerias[nCont,3],  aPerFerias[nCont,4], 22 })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont++     .END.','000017','000009','.EXE.','5','nCont++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0045    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0045( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERARES','GERA RESCISAO NA FOLHA','','','030','2','1',} )

aAdd(aRc3Cols, { '','S_','GERARES','SRA->RA_SITFOLH = "D" .and. cTipoRot = "1"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH = "D" .and. cTipoRot = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aRecnos := {}     .CNT.','000002','000001','.EXE.','5','aRecnos := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCCusFun := SRA->RA_CC     .CNT.','000003','000001','.EXE.','5','cCCusFun := SRA->RA_CC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lDeleta := .F.     .CNT.','000004','000001','.EXE.','5','lDeleta := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nPosPdCc := 0.00     .CNT.','000005','000001','.EXE.','5','nPosPdCc := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nRecno := 0.00     .CNT.','000006','000001','.EXE.','5','nRecno := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nRecnos := 0.00     .CNT.','000007','000001','.EXE.','5','nRecnos := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLenSeq := Len( SRC->RC_SEQ )     .CNT.','000008','000001','.EXE.','5','nLenSeq := Len( SRC->RC_SEQ )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := .F.     .CNT.','000009','000001','.EXE.','5','lGerRes := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','fPosReg("SRG",1,SRA->( RA_FILIAL + RA_MAT ))     .CNT.','000010','000001','.EXE.','5','fPosReg("SRG",1,SRA->( RA_FILIAL + RA_MAT ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) == RG_FILI','000011','000001','.ENQ.','5','','','5','SRG->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) == RG_FILIAL + RG_MAT )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( ( MesAno( RG_DTGERAR ) == cAnoMes ) .and. RG_EFETIV','000012','000011','.CON.','5','','','5','SRG->( ( MesAno( RG_DTGERAR ) == cAnoMes ) .and. RG_EFETIVA $ " S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := .T.     .CNT.','000013','000012','.EXE.','5','lGerRes := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','LIF := ( SRG->( MesAno( RG_DATADEM ) == MesAno( RG_DTGERAR','000014','000012','.CON.','5','','','5','LIF := ( SRG->( MesAno( RG_DATADEM ) == MesAno( RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','LIF2 := ( Empty( aRecnos ) )   .END.','000015','000014','.CON.','5','','','5','LIF2 := ( Empty( aRecnos ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aAdd( aRecnos , SRG->( Recno() ) )     .END.','000016','000015','.EXE.','5','aAdd( aRecnos , SRG->( Recno() ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!LIF2   .END.','000017','000014','.CON.','5','','','5','!LIF2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aRecnos[ Len( aRecnos ) ] := SRG->( Recno() )     .END.','000018','000017','.EXE.','5','aRecnos[ Len( aRecnos ) ] := SRG->( Recno() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!LIF   .END.','000019','000012','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aAdd( aRecnos , SRG->( Recno() ) )     .END.','000020','000019','.EXE.','5','aAdd( aRecnos , SRG->( Recno() ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( dbSkip() )     .END.','000021','000011','.EXE.','5','SRG->( dbSkip() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha := 1     .CNT.','000022','000001','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','( nRecnos := Len( aRecnos ) ) > 0.00   .END.','000023','000001','.CON.','5','','','5','( nRecnos := Len( aRecnos ) ) > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha <= nRecnos   .END.','000024','000023','.ENQ.','5','','','5','nLinha <= nRecnos','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( dbGoto( aRecnos[ nLinha ] ) )     .CNT.','000025','000024','.EXE.','5','SRG->( dbGoto( aRecnos[ nLinha ] ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( dbSetOrder(1) )     .CNT.','000026','000024','.EXE.','5','SRR->( dbSetOrder(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SR','000027','000024','.CON.','5','','','5','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SRG->RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','FO_DEL(@&cObjeto,{"RC_FILIAL","RC_MAT"},{SRR->RR_FILIAL,SRR-','000028','000027','.EXE.','5','FO_DEL(@&cObjeto,{"RC_FILIAL","RC_MAT"},{SRR->RR_FILIAL,SRR->RR_MAT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == R','000029','000027','.ENQ.','5','','','5','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == RR_FILIAL + RR_MAT + RR_TIPO3 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGER','000030','000029','.CON.','5','','','5','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGERAR .and. !Empty( RR_VALOR ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','000031','000030','.EXE.','5','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR-','000032','000030','.EXE.','5','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR->RR_DATAPAG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','aCampos:={cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpoCc,cCpoT','000033','000030','.EXE.','5','aCampos:={cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpoCc,cCpoTipo1,cCpoTipo2,cCpoData,cCpoSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','aConteudos:={SRR->RR_PD,SRR->RR_VALOR,SRR->RR_HORAS,SRR->RR_','000034','000030','.EXE.','5','aConteudos:={SRR->RR_PD,SRR->RR_VALOR,SRR->RR_HORAS,SRR->RR_SEMANA,cCCAux,SRR->RR_TIPO1,SRR->RR_TIPO2,dDataPgt,SRR->RR_SEQ}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','FO_ADD(@&cObjeto,aCampos,aConteudos)     .END.','000035','000030','.EXE.','5','FO_ADD(@&cObjeto,aCampos,aConteudos)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->(DBSKIP())     .END.','000036','000029','.EXE.','5','SRR->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha ++     .END.','000037','000024','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes   .END.','000038','000001','.CON.','5','','','5','lGerRes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','S_GRAVASRC()     .END.','000039','000038','.EXE.','5','S_GRAVASRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := NIL     .END.','000040','000001','.EXE.','5','lGerRes := NIL','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0046    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0046( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GETPRACU','OBTEM PROVISAO ACUMULADA','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','GETPRACU','AAREA := GETAREA()     .CNT.','000001','000000','.EXE.','5','AAREA := GETAREA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000002','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NVALANTG := 0     .CNT.','000003','000002','.EXE.','5','NVALANTG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','CVERBAG := FGETCODFOL("0776")     .CNT.','000004','000002','.EXE.','5','CVERBAG := FGETCODFOL("0776")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','FBUSCAACM(CVERBAG, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATA','000005','000002','.EXE.','5','FBUSCAACM(CVERBAG, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATADE), "V", @NVALANTG, , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NPRACUMGZ  := NVALANTG     .CNT.','000006','000002','.EXE.','5','NPRACUMGZ  := NVALANTG','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NVALANTF := 0     .CNT.','000007','000002','.EXE.','5','NVALANTF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','CVERBAF := FGETCODFOL("0825")     .CNT.','000008','000002','.EXE.','5','CVERBAF := FGETCODFOL("0825")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','FBUSCAACM(CVERBAF, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATA','000009','000002','.EXE.','5','FBUSCAACM(CVERBAF, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATADE), "V", @NVALANTF, , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NPRACUFER  := NVALANTF     .END.','000010','000002','.EXE.','5','NPRACUFER  := NVALANTF','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NTIPOPRV > 1   .END.','000011','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NVALANT := 0     .CNT.','000012','000011','.EXE.','5','NVALANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','CVERBAS := FGETCODFOL("0777")     .CNT.','000013','000011','.EXE.','5','CVERBAS := FGETCODFOL("0777")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','FBUSCAACM(CVERBAS, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATA','000014','000011','.EXE.','5','FBUSCAACM(CVERBAS, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATADE), "V", @NVALANT, , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NPRACU13 := NVALANT     .END.','000015','000011','.EXE.','5','NPRACU13 := NVALANT','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','RESTAREA(AAREA)     .END.','000016','000000','.EXE.','5','RESTAREA(AAREA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0047    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0047( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAADI','GERA ADIANTAMENTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAADI','VAL_ADTO <> 0   .END.','000001','000000','.CON.','5','','','5','VAL_ADTO <> 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAADI','!( FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("0006")}) )   .E','000002','000001','.CON.','5','','','5','!( FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("0006")}) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAADI','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras},{fGetCodFol("0','000003','000002','.EXE.','5','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras},{fGetCodFol("0006"),Val_adto,SRA->RA_PERCADT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0048    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0048( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVABFA','GRAVA ABONO FAMILIAR','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVABFA','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','ABONOFAM > 0   .END.','000002','000000','.CON.','5','','','5','ABONOFAM > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','CVERBA := FGETCODFOL("0617")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("0617")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, ABONOFAM})','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, ABONOFAM})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','CMSGLOG := FMSGFORM({19}) + "0617 - " + FDESC("RCN", "0617",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0617 - " + FDESC("RCN", "0617", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0049    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0049( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAJC','GRAVA AJUDA DE CUSTO (NAC / ESTRANG)','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAJC','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','AJCUSTO > 0   .END.','000002','000000','.CON.','5','','','5','AJCUSTO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','CVERBA := FGETCODFOL("1092")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("1092")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, AJCUSTO})','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, AJCUSTO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','CMSGLOG := FMSGFORM({19}) + "1092 - " + FDESC("RCN", "1092",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "1092 - " + FDESC("RCN", "1092", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0050    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0050( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAJCF','GRAVA AJUDA DE CUSTO FORMACAO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAJCF','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','AJCUSTOFORM > 0   .END.','000002','000000','.CON.','5','','','5','AJCUSTOFORM > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','CVERBA := FGETCODFOL("1093")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("1093")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, AJCUSTOFORM})','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, AJCUSTOFORM})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','CMSGLOG := FMSGFORM({19}) + "1093 - " + FDESC("RCN", "1093",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "1093 - " + FDESC("RCN", "1093", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0051    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0051( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVANAT','GRAVA SUBSIDIO DE NATAL','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVANAT','NVALNATAL > 0   .END.','000001','000000','.CON.','5','','','5','NVALNATAL > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVANAT','cTipoRot == "4"   .END.','000002','000001','.CON.','5','','','5','cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVANAT','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {FGETCODFOL(','000003','000002','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {FGETCODFOL("0025"),NPERCNAT,NVALNATAL})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVANAT','cTipoRot # "4"   .END.','000004','000001','.CON.','5','','','5','cTipoRot # "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVANAT','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {FGETCODFOL(','000005','000004','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {FGETCODFOL("0024"),NPERCNAT,NVALNATAL})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0052    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0052( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASAL','Grava Salario','','000262','054','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASAL','C__ROTEIRO == "PRV"   .END.','000001','000000','.CON.','5','','','5','C__ROTEIRO == "PRV"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','FIMFORMULA()     .END.','000002','000001','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','lDiaHora :=GetNewPar('+"'"+'MV_DIAHOR'+"'"+',.T.)     .CNT.','000003','000000','.EXE.','5','lDiaHora :=GetNewPar('+"'"+'MV_DIAHOR'+"'"+',.T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000004','000000','.EXE.','5','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','Salario > 0 .AND.','000005','000000','.CON.','5','','','5','Salario','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','cSitFolh # "D" .END.','000006','000000','.CON.','5','','','5','cSitFolh','#','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','P_CALCINF # "S" .END.','000007','000006','.CON.','5','','','5','P_CALCINF','#','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "M*C*D" .AND.','000008','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*D"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000009','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000010','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0031") , cNumpag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000011','000010','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0031"), "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "P" .AND.','000012','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"P"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000013','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0217") # Space(3) .AND.','000014','000007','.CON.','5','','','5','fGetCodFol("0217")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000015','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0217") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000016','000015','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0217") , "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "A" .AND.','000017','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000018','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0218") # Space(3) .AND.','000019','000007','.CON.','5','','','5','fGetCodFol("0218")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000020','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0218") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000021','000020','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0218") , "V" , nSalPg, Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "E" .AND.','000022','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"E"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000023','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0219") # Space(3) .AND.','000024','000007','.CON.','5','','','5','fGetCodFol("0219")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000025','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0219") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000026','000025','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0219") , "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "H" .AND.','000027','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000028','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0032") # SPACE(3) .AND.','000029','000007','.CON.','5','','','5','fGetCodFol("0032")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0033") = SPACE(3) .AND.','000030','000007','.CON.','5','','','5','fGetCodFol("0033")','=','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032")}, .T.)','000031','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000032','000031','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg+nDsr , nHorastrab+nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "G" .AND.','000033','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"G"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000034','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0220") # SPACE(3) .AND.','000035','000007','.CON.','5','','','5','fGetCodFol("0220")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0220")}, .T.)','000036','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0220")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000037','000036','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0220") , "V" , nSalPg+nDsr , nHorastrab+nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "H" .AND.','000038','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000039','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0032") # SPACE(3) .AND.','000040','000007','.CON.','5','','','5','fGetCodFol("0032")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0033") # SPACE(3) .END.','000041','000007','.CON.','5','','','5','fGetCodFol("0033")','#','5','SPACE(3)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032") }, .T.)','000042','000041','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032") }, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000043','000042','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg, nHorastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0033")}, .T.)','000044','000041','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0033")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000045','000044','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0033") , "V" , nDsr, nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "S" .AND.','000046','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000047','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0032") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000048','000047','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg, Diastrab })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000049','000047','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0033") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000050','000049','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0033") , "V" , nDsr, nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0053    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0053( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASRC','GRAVA ASIENTOS','','000014','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASRC','!lDissidio   .END.','000001','000000','.CON.','5','','','5','!lDissidio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASRC','PUTSRC()     .END.','000002','000001','.EXE.','5','PUTSRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0054    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0054( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASRF','GRAVA OBJETO SRF','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASRF','FO_PUT(@oSRF)     .END.','000001','000000','.EXE.','5','FO_PUT(@oSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0055    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0055( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAVPR','GRAVA AVISO PREVIO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAVPR','CVRBAVIND := FGETCODFOL("0111")     .CNT.','000001','000000','.EXE.','5','CVRBAVIND := FGETCODFOL("0111")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','CVRBAVTRB := FGETCODFOL("0112")     .CNT.','000002','000000','.EXE.','5','CVRBAVTRB := FGETCODFOL("0112")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','CVRBAVDES := FGETCODFOL("0113")     .CNT.','000003','000000','.EXE.','5','CVRBAVDES := FGETCODFOL("0113")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','NVPGAVPREV > 0   .END.','000004','000000','.CON.','5','','','5','NVPGAVPREV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','LOK := !EMPTY(DDATAAV) .And. (DDATAAV < DDATADEM)   .END.','000005','000004','.CON.','5','','','5','LOK := !EMPTY(DDATAAV) .And. (DDATAAV < DDATADEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','LIF := EMPTY(CVRBAVTRB)   .END.','000006','000005','.CON.','5','','','5','LIF := EMPTY(CVRBAVTRB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','CMSGLOG := FMSGFORM({19}) + "0112 - " + FDESC("RCN", "112",','000007','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0112 - " + FDESC("RCN", "112", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','S_MSGLOG()     .END.','000008','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','!LIF   .END.','000009','000005','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVTRB','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVTRB, NDIASAVPAG, NVPGAVPREV })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','!LOK   .END.','000011','000004','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVIND','000012','000011','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVIND, NDIASAVPAG, NVPGAVPREV })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','NVDSAVPREV > 0   .END.','000013','000000','.CON.','5','','','5','NVDSAVPREV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVDES','000014','000013','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVDES, NDIASAVDES, NVDSAVPREV })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0056    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0056( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVCOMP','GRAVA COMPENSACAO NA RESCISAO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVCOMP','CVERBA := FGETCODFOL("1091")     .CNT.','000001','000000','.EXE.','5','CVERBA := FGETCODFOL("1091")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVCOMP','NVLRCOMPEN > 0   .END.','000002','000000','.CON.','5','','','5','NVLRCOMPEN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVCOMP','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {CVERBA, NVLRCOMPEN }','000003','000002','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {CVERBA, NVLRCOMPEN })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0057    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0057( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVIND','GRAVA INDENIZACAO NA RESCISAO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVIND','CVERBA := FGETCODFOL("0110")     .CNT.','000001','000000','.EXE.','5','CVERBA := FGETCODFOL("0110")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIND','NVLRINDEN > 0   .END.','000002','000000','.CON.','5','','','5','NVLRINDEN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIND','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {CVERBA, NVLRINDEN })','000003','000002','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {CVERBA, NVLRINDEN })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0058    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0058( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVINSS','GRAVA CALCULO DO INSS','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVINSS','nVFINSS > 0   .END.','000001','000000','.CON.','5','','','5','nVFINSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0064") , nVFINSS, NPINSSFun } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','nVEINSS > 0   .END.','000003','000000','.CON.','5','','','5','nVEINSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0783") , nVEINSS, nPINSSEmp } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','nBINSS > 0   .END.','000005','000000','.CON.','5','','','5','nBINSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0013")','000006','000005','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0013") , nBINSS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','nVFINSSFer > 0   .END.','000007','000000','.CON.','5','','','5','nVFINSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0065") , nVFINSSFer, NPINSSFun } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','nVEINSSFer > 0   .END.','000009','000000','.CON.','5','','','5','nVEINSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0783") , nVEINSSFer, NPINSSEmp } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','nBINSSFer > 0   .END.','000011','000000','.CON.','5','','','5','nBINSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0787")','000012','000011','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0787") , nBINSSFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','nVFINSS13 > 0   .END.','000013','000000','.CON.','5','','','5','nVFINSS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000014','000013','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0070") , nVFINSS13, NPINSSFun } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','nVEINSS13 > 0   .END.','000015','000000','.CON.','5','','','5','nVEINSS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000016','000015','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0788") , nVEINSS13, nPINSSEmp } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','nBINSS13 > 0   .END.','000017','000000','.CON.','5','','','5','nBINSS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVINSS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0019")','000018','000017','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0019") , nBINSS13 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0059    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0059( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVIRT','GRAVACAO CALCULO IRT','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVIRT','NBIRT > 0   .END.','000001','000000','.CON.','5','','','5','NBIRT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0015")','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0015") , NBIRT } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVLRIRT > 0   .END.','000003','000000','.CON.','5','','','5','NVLRIRT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0066") , NVLRIRT, NPERIRT } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBIRTFer > 0   .END.','000005','000000','.CON.','5','','','5','NBIRTFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0016")','000006','000005','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0016") , NBIRTFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVLRIRTFer > 0   .END.','000007','000000','.CON.','5','','','5','NVLRIRTFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0067") , NVLRIRTFer, NPERIRTFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBIRT13 > 0   .END.','000009','000000','.CON.','5','','','5','NBIRT13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0027")','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0027") , NBIRT13 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVLRIRT13 > 0   .END.','000011','000000','.CON.','5','','','5','NVLRIRT13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000012','000011','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0071") , NVLRIRT13, NPERIRT13 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0060    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0060( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVLIQU','GRAVACAO DO LIQUIDO','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVLIQU','nVlr_ins > 0 .END.','000001','000000','.CON.','5','','','5','nVlr_ins','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor } , { cCodIns , nVlr_in','000002','000001','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor } , { cCodIns , nVlr_ins } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','nVal_Arre > 0 .END.','000003','000000','.CON.','5','','','5','nVal_Arre','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {cCodArred , nVal_Arr','000004','000003','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {cCodArred , nVal_Arre} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','! FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto } , { cCodLiq, cN','000005','000000','.CON.','5','','','5','! FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto } , { cCodLiq, cNumpag } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT == "9"   .END.','000006','000006','.CON.','5','','','5','CTIPOROT == "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor,cCpoData, cCpoDtRef} ,','000007','000006','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor,cCpoData, cCpoDtRef} , {cCodLiq , nLiquido, dData_Pgto, dData_Pgto} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor, cCpoData } , { cCodLiq','000008','000005','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor, cCpoData } , { cCodLiq, nLiquido, dData_Pgto } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0061    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0061( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVSBAL','GRAVA SUBSIDIO ALIMENTACAO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVSBAL','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','SUBALIMENT > 0   .END.','000002','000000','.CON.','5','','','5','SUBALIMENT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','CVERBA := FGETCODFOL("0050")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("0050")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS , CCPOVALOR}, {CVERBA, D','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS , CCPOVALOR}, {CVERBA, DIASUBALIM , SUBALIMENT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','CMSGLOG := FMSGFORM({19}) + "0050 - " + FDESC("RCN", "0050",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0050 - " + FDESC("RCN", "0050", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0062    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0062( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVSBTR','GRAVA SUBSIDIO TRANSPORTE','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVSBTR','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','SUBTRANSP > 0   .END.','000002','000000','.CON.','5','','','5','SUBTRANSP > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','CVERBA := FGETCODFOL("0052")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("0052")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','FO_ADD(@&COBJETO,{CCPOPD , CCPOHORAS , CCPOVALOR}, {CVERBA,','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD , CCPOHORAS , CCPOVALOR}, {CVERBA, DIASUBTRANS , SUBTRANSP})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','CMSGLOG := FMSGFORM({19}) + "0052 - " + FDESC("RCN", "0052",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0052 - " + FDESC("RCN", "0052", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0063    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0063( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVLIQAD','GERA LIQUIDO ADIANTAMENTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVLIQAD','NVLRTOT > 0   .END.','000001','000000','.CON.','5','','','5','NVLRTOT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVLIQAD','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS, CCPONPAGTO,','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS, CCPONPAGTO, CCPOTIPO1, CCPOTIPO2, CCPODATA},{FGETCODFOL("0546"),NVLRTOT,0,CNUMPAG,"V","A",RCH->RCH_DTPAGO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0064    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0064( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LIQDOLAR','CALCULA VALOR LIQUIDO EM DOLAR','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','LIQDOLAR','NVALOR := 0     .CNT.','000001','000000','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NDOLARRH := 1     .CNT.','000002','000000','.EXE.','5','NDOLARRH := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','!Empty(P_MDOLARRH)   .END.','000003','000000','.CON.','5','','','5','!Empty(P_MDOLARRH)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NDOLARRH := P_MDOLARRH     .END.','000004','000003','.EXE.','5','NDOLARRH := P_MDOLARRH','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','LIF := (CTIPOROT == "2")   .END.','000005','000000','.CON.','5','','','5','LIF := (CTIPOROT == "2")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NVALOR := &("NVLRTOT")     .END.','000006','000005','.EXE.','5','NVALOR := &("NVLRTOT")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','!LIF .AND. (LIF := (CTIPOROT == "3"))   .END.','000007','000000','.CON.','5','','','5','!LIF .AND. (LIF := (CTIPOROT == "3"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NVALOR := &("NVALLIQ")     .END.','000008','000007','.EXE.','5','NVALOR := &("NVALLIQ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','!LIF   .END.','000009','000000','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NVALOR := NLIQUIDO     .END.','000010','000009','.EXE.','5','NVALOR := NLIQUIDO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NLIQDOLAR := XMOEDA(NVALOR,1,NDOLARRH,DDATA_PGTO)     .CNT.','000011','000000','.EXE.','5','NLIQDOLAR := XMOEDA(NVALOR,1,NDOLARRH,DDATA_PGTO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','LMSG := (NVALOR > 0) .AND. (NLIQDOLAR = 0)   .END.','000012','000000','.CON.','5','','','5','LMSG := (NVALOR > 0) .AND. (NLIQDOLAR = 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','CMSGLOG := FMSGFORM({43})     .CNT.','000013','000012','.EXE.','5','CMSGLOG := FMSGFORM({43})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','S_MSGLOG()     .END.','000014','000012','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','!LMSG   .END.','000015','000000','.CON.','5','','','5','!LMSG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NLIQDOLAR := ROUND(NLIQDOLAR,2)     .CNT.','000016','000015','.EXE.','5','NLIQDOLAR := ROUND(NLIQDOLAR,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NLIQDOLAR > 0   .END.','000017','000015','.CON.','5','','','5','NLIQDOLAR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPODATA} , {FGETCODFO','000018','000017','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPODATA} , {FGETCODFOL("1101"), NLIQDOLAR, DDATA_PGTO} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0065    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0065( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LIQUIADI','LIQUIDO DO ADIANTAMENTO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI := 0     .CNT.','000001','000000','.EXE.','5','NLIQADI := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NPROVADI:=0     .CNT.','000002','000000','.EXE.','5','NPROVADI:=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NDESCADI:=0     .CNT.','000003','000000','.EXE.','5','NDESCADI:=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NVLRTOT := 0     .CNT.','000004','000000','.EXE.','5','NVLRTOT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_GOTOP(@&COBJETO)     .CNT.','000005','000000','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','!FO_EOF(@&COBJETO)   .END.','000006','000000','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_GETVAL(@&COBJETO,CCPOPD) <> FGETCODFOL("0006")   .AND.','000007','000006','.CON.','5','','','5','FO_GETVAL(@&COBJETO,CCPOPD) <> FGETCODFOL("0006")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','!FO_DELETED(@&COBJETO)   .AND.','000008','000006','.CON.','5','','','5','!FO_DELETED(@&COBJETO)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD), SRA->RA_FILIAL, "RV_AD','000009','000006','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD), SRA->RA_FILIAL, "RV_ADIANTA")  == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPO','000010','000009','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPOCOD")=="1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NPROVADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT.','000011','000010','.EXE.','5','NPROVADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI+=NPROVADI     .END.','000012','000010','.EXE.','5','NLIQADI+=NPROVADI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPO','000013','000009','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPOCOD")=="2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NDESCADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT.','000014','000013','.EXE.','5','NDESCADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI-=NDESCADI     .END.','000015','000013','.EXE.','5','NLIQADI-=NDESCADI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_SKIP(@&COBJETO)     .END.','000016','000006','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NVLRTOT := NLIQADI + VAL_ADTO     .END.','000017','000000','.EXE.','5','NVLRTOT := NLIQADI + VAL_ADTO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0066    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0066( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','MSGLOG','MENSAGEM P/ APRESENTACAO NO LOG DE CALC','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','MSGLOG','!EMPTY(CMSGLOG)   .END.','000001','000000','.CON.','5','','','5','!EMPTY(CMSGLOG)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','NPOS := ASCAN(AMSGLOG,{|X| X == CMSGLOG})     .CNT.','000002','000001','.EXE.','5','NPOS := ASCAN(AMSGLOG,{|X| X == CMSGLOG})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','LOK := EMPTY(NPOS)   .END.','000003','000001','.CON.','5','','','5','LOK := EMPTY(NPOS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','AADD(AMSGLOG,CMSGLOG)     .CNT.','000004','000003','.EXE.','5','AADD(AMSGLOG,CMSGLOG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','ADDLOGEXECROT(CMSGLOG)     .END.','000005','000003','.EXE.','5','ADDLOGEXECROT(CMSGLOG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0067    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0067( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PARAMPRV','PARAMETROS PROVISAO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','PARAMPRV','NTIPOPRV := APERGUNTE[1,3]     .END.','000001','000000','.EXE.','5','NTIPOPRV := APERGUNTE[1,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0068    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0068( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCRG1','PROCESSAR RG1','','','068','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCRG1','CPDACFIXOS := ""     .CNT.','000001','000000','.EXE.','5','CPDACFIXOS := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','CVERBADIC := FGETCODFOL("001")+"*"+FGETCODFOL("002")+"*"+FGE','000002','000000','.EXE.','5','CVERBADIC := FGETCODFOL("001")+"*"+FGETCODFOL("002")+"*"+FGETCODFOL("003")+"*"+FGETCODFOL("004")+"*"+FGETCODFOL("005")+"*"+FGETCODFOL("036")+"*"+FGETCODFOL("037")+"*"+FGETCODFOL("038")+"*"+FGETCODFOL("039")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPg:= CToD("")     .CNT.','000003','000000','.EXE.','5','dDtFimPg:= CToD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaIniRG1 := 0     .CNT.','000004','000000','.EXE.','5','nDiaIniRG1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := 0     .CNT.','000005','000000','.EXE.','5','nDiaFimRG1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','fo_GoTop( @ORG1)     .CNT.','000006','000000','.EXE.','5','fo_GoTop( @ORG1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!fo_Eof( @ORG1 )   .END.','000007','000000','.ENQ.','5','','','5','!fo_Eof( @ORG1 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_GETVAL(@oRG1,"RG1_AUTOM") = "1"   .END.','000008','000007','.CON.','5','','','5','FO_GETVAL(@oRG1,"RG1_AUTOM") = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtLib := FO_GETVAL(@ORG1,"RG1_LIBPAG")     .CNT.','000009','000008','.EXE.','5','dDtLib := FO_GETVAL(@ORG1,"RG1_LIBPAG")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPg:= fo_GetVal(@oRG1, "RG1_DFIMPG")     .CNT.','000010','000008','.EXE.','5','dDtFimPg:= fo_GetVal(@oRG1, "RG1_DFIMPG")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!EMPTY(dDtLIb) .And. cAnoMes >= MesAno(dDtLib)   .END.','000011','000008','.CON.','5','','','5','!EMPTY(dDtLIb) .And. cAnoMes >= MesAno(dDtLib)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cVerba := fo_GetVal( @ORG1 , "RG1_PD")     .CNT.','000012','000011','.EXE.','5','cVerba := fo_GetVal( @ORG1 , "RG1_PD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc := fo_GetVal( @ORG1 , "RG1_TPCALC")     .CNT.','000013','000011','.EXE.','5','cTpcalc := fo_GetVal( @ORG1 , "RG1_TPCALC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nRef := fo_GetVal( @ORG1 , "RG1_REFER")     .CNT.','000014','000011','.EXE.','5','nRef := fo_GetVal( @ORG1 , "RG1_REFER")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','PosSrv(cVerba,SRA->RA_FILIAL)     .CNT.','000015','000011','.EXE.','5','PosSrv(cVerba,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nPercVrb := If (SRV->RV_PERC=0,100,SRV->RV_PERC)     .CNT.','000016','000011','.EXE.','5','nPercVrb := If (SRV->RV_PERC=0,100,SRV->RV_PERC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cCodCor := SRV->RV_CODCORR     .CNT.','000017','000011','.EXE.','5','cCodCor := SRV->RV_CODCORR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','Lincorp := IF ( SRV->RV_INCORP ="S",.T.,.F.)     .CNT.','000018','000011','.EXE.','5','Lincorp := IF ( SRV->RV_INCORP ="S",.T.,.F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp := FO_GETVAL(@ORG1,"RG1_PROP")     .CNT.','000019','000011','.EXE.','5','cProp := FO_GETVAL(@ORG1,"RG1_PROP")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp := IF( ( cProp == "1" .And. ( !lIncorp .Or. DiasTrab >','000020','000011','.EXE.','5','cProp := IF( ( cProp == "1" .And. ( !lIncorp .Or. DiasTrab >= 30 ) .And. !( cVerba $ cVerbAdic ) ) .OR. ( cProp == "2" .And. cAfaPagto == "S" ) ,"S","N")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .f.     .CNT.','000021','000011','.EXE.','5','lGravaRg1 := .f.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cCc := FO_GETVAL(@oRG1,"RG1_CC")     .CNT.','000022','000011','.EXE.','5','cCc := FO_GETVAL(@oRG1,"RG1_CC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValTab := 0     .CNT.','000023','000011','.EXE.','5','nValTab := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "1"   .END.','000024','000011','.CON.','5','','','5','cTpcalc == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := FO_GETVAL(@ORG1,"RG1_VALOR")     .CNT.','000025','000024','.EXE.','5','nValor := FO_GETVAL(@ORG1,"RG1_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000026','000024','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "2"   .END.','000027','000011','.CON.','5','','','5','cTpcalc == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * Saldia / 100 * nPercVrb     .CNT.','000028','000027','.EXE.','5','nValor := nRef * Saldia / 100 * nPercVrb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000029','000027','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "3"   .END.','000030','000011','.CON.','5','','','5','cTpcalc == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * SalHora / 100 * nPercVrb     .CNT.','000031','000030','.EXE.','5','nValor := nRef * SalHora / 100 * nPercVrb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000032','000030','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "4"   .END.','000033','000011','.CON.','5','','','5','cTpcalc == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTab := FO_GETVAL(@ORG1,"RG1_CODTAB")     .CNT.','000034','000033','.EXE.','5','cTab := FO_GETVAL(@ORG1,"RG1_CODTAB")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nLin :=FO_GETVAL(@ORG1,"RG1_LINHA")     .CNT.','000035','000033','.EXE.','5','nLin :=FO_GETVAL(@ORG1,"RG1_LINHA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nCol :=FO_GETVAL(@ORG1,"RG1_COLUNA")     .CNT.','000036','000033','.EXE.','5','nCol :=FO_GETVAL(@ORG1,"RG1_COLUNA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValTab := fTabela(cTab,nLin,nCol)     .CNT.','000037','000033','.EXE.','5','nValTab := fTabela(cTab,nLin,nCol)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nRef := If ( nRef = 0,nPercVrb,nRef)     .CNT.','000038','000033','.EXE.','5','nRef := If ( nRef = 0,nPercVrb,nRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','ValType(nValTab) <> "U"   .END.','000039','000033','.CON.','5','','','5','ValType(nValTab) <> "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * nValTab / 100     .CNT.','000040','000039','.EXE.','5','nValor := nRef * nValTab / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000041','000039','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "5"   .END.','000042','000011','.CON.','5','','','5','cTpcalc == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','CPDACFIXOS += fo_GetVal( @ORG1 , "RG1_PD") + "-"     .CNT.','000043','000042','.EXE.','5','CPDACFIXOS += fo_GetVal( @ORG1 , "RG1_PD") + "-"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000044','000042','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "6"   .END.','000045','000011','.CON.','5','','','5','cTpcalc == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * SalMes / 100     .CNT.','000046','000045','.EXE.','5','nValor := nRef * SalMes / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000047','000045','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "7"   .END.','000048','000011','.CON.','5','','','5','cTpcalc == "7"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * VAL_SALMIN / 100     .CNT.','000049','000048','.EXE.','5','nValor := nRef * VAL_SALMIN / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000050','000048','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nTotAdic += nValor     .CNT.','000051','000011','.EXE.','5','nTotAdic += nValor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp == "S"   .END.','000052','000011','.CON.','5','','','5','cProp == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto  := DDATADE     .CNT.','000053','000052','.EXE.','5','dDtIniPgto  := DDATADE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := DDATAATE     .CNT.','000054','000052','.EXE.','5','dDtFimPagto := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtaDem := If( c__roteiro == "RES", GETMEMVAR("RG_DATADEM"),','000055','000052','.EXE.','5','dDtaDem := If( c__roteiro == "RES", GETMEMVAR("RG_DATADEM"), SRA->RA_DEMISSA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( LAdm := ( CANOMES == MesAno(SRA->RA_ADMISSA) ) )   .END.','000056','000052','.CON.','5','','','5','( LAdm := ( CANOMES == MesAno(SRA->RA_ADMISSA) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto := SRA->RA_ADMISSA     .END.','000057','000056','.EXE.','5','dDtIniPgto := SRA->RA_ADMISSA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( CANOMES == MesAno(DDTLIB) )   .END.','000058','000052','.CON.','5','','','5','( CANOMES == MesAno(DDTLIB) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( !LAdm .Or. ( LAdm .And. DDTLIB > SRA->RA_ADMISSA ) )   .','000059','000058','.CON.','5','','','5','( !LAdm .Or. ( LAdm .And. DDTLIB > SRA->RA_ADMISSA ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto := DDTLIB     .END.','000060','000059','.EXE.','5','dDtIniPgto := DDTLIB','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( LDem := ( CANOMES == MesAno(dDtaDem) ) )   .END.','000061','000052','.CON.','5','','','5','( LDem := ( CANOMES == MesAno(dDtaDem) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := dDtaDem     .END.','000062','000061','.EXE.','5','dDtFimPagto := dDtaDem','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( CANOMES == MesAno(DDTFIMPG) )   .END.','000063','000052','.CON.','5','','','5','( CANOMES == MesAno(DDTFIMPG) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( !LDem .Or. ( LDem .And. DDTFIMPG < dDtaDem ) )   .END.','000064','000063','.CON.','5','','','5','( !LDem .Or. ( LDem .And. DDTFIMPG < dDtaDem ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := DDTFIMPG     .END.','000065','000064','.EXE.','5','dDtFimPagto := DDTFIMPG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaIniRG1 := DAY(dDtIniPgto)     .CNT.','000066','000052','.EXE.','5','nDiaIniRG1 := DAY(dDtIniPgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := DAY(dDtFimPagto)     .CNT.','000067','000052','.EXE.','5','nDiaFimRG1 := DAY(dDtFimPagto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .Or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000068','000052','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .Or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .And. P_DIASMES <> "S" )) .And. (nDiaFimRG1 > 30) .And. cVerba # FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := 30     .END.','000069','000068','.EXE.','5','nDiaFimRG1 := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','NREF:= ( nDiaFimRG1 - nDiaIniRG1 + 1 ) - NDIASAFAS     .CNT.','000070','000052','.EXE.','5','NREF:= ( nDiaFimRG1 - nDiaIniRG1 + 1 ) - NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','NVALOR := NVALOR / 30 * MIN(NREF,30)     .END.','000071','000052','.EXE.','5','NVALOR := NVALOR / 30 * MIN(NREF,30)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1   .END.','000072','000011','.CON.','5','','','5','lGravaRg1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc}) .AND. FO_G','000073','000072','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc}) .AND. FO_GETVAL(@&cObjeto,cCpoTipo2) # "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC $ " *1"   .END.','000074','000073','.CON.','5','','','5','SRV->RV_QTDLANC $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)     .CNT.','000075','000074','.EXE.','5','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)     .CNT.','000076','000074','.EXE.','5','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)     .CNT.','000077','000074','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))     .','000078','000074','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC > "1" .AND. NVALOR > 0   .END.','000079','000073','.CON.','5','','','5','SRV->RV_QTDLANC > "1" .AND. NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nSeq := fo_count( @&cObjeto ,cCpoPd , cVerba ) + 1     .CNT.','000080','000079','.EXE.','5','nSeq := fo_count( @&cObjeto ,cCpoPd , cVerba ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cVerb','000081','000079','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cVerba,nRef,Round(nValor,2),Str(nSeq,1)},{cCpoPd,cCpoSeq},{cVerba,Str(nSeq,1)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc})  .and. SR','000082','000072','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc})  .and. SRV->RV_QTDLANC <> "0" .and. (nValor > 0 .or. cTpcalc == "5")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cVerba','000083','000082','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cVerba,nRef,Round(nValor,2),cCc})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!Empty(cCodCor)   .END.','000084','000072','.CON.','5','','','5','!Empty(cCodCor)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','PosSrv(cCodCor,SRA->RA_FILIAL)     .CNT.','000085','000084','.EXE.','5','PosSrv(cCodCor,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})   .END.','000086','000084','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC $ " *1"   .END.','000087','000086','.CON.','5','','','5','SRV->RV_QTDLANC $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)     .CNT.','000088','000087','.EXE.','5','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)     .CNT.','000089','000087','.EXE.','5','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)     .CNT.','000090','000087','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))     .','000091','000087','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC > "1" .And. nValor > 0   .END.','000092','000086','.CON.','5','','','5','SRV->RV_QTDLANC > "1" .And. nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nSeq := fo_count( @&cObjeto ,cCpoPd , cCodCor ) + 1     .CNT','000093','000092','.EXE.','5','nSeq := fo_count( @&cObjeto ,cCpoPd , cCodCor ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cCodC','000094','000092','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cCodCor,nRef,Round(nValor,2),Str(nSeq,1)},{cCpoPd,cCpoSeq},{cCodCor,Str(nSeq,1)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})  .and. S','000095','000084','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})  .and. SRV->RV_QTDLANC <> "0" .and. nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cCodCo','000096','000095','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cCodCor,nRef,Round(nValor,2),cCc})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','fo_Skip( @ORG1 )     .END.','000097','000007','.EXE.','5','fo_Skip( @ORG1 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0069    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0069( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCRGB','PROCESSA INFORMACOES DE RGB PARA SRC','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCRGB','FO_GOTOP(@ORGB)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@ORGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','!FO_EOF(@ORGB)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@ORGB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cNPagRGB := fo_GetVal(@oRGB, "RGB_SEMANA")     .CNT.','000003','000002','.EXE.','5','cNPagRGB := fo_GetVal(@oRGB, "RGB_SEMANA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cMatRGB := fo_GetVal(@oRGB, "RGB_MAT")     .CNT.','000004','000002','.EXE.','5','cMatRGB := fo_GetVal(@oRGB, "RGB_MAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cHrRGB := fo_GetVal(@oRGB , "RGB_HORAS")     .CNT.','000005','000002','.EXE.','5','cHrRGB := fo_GetVal(@oRGB , "RGB_HORAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','nVlRGB := fo_GetVal(@oRGB , "RGB_VALOR")     .CNT.','000006','000002','.EXE.','5','nVlRGB := fo_GetVal(@oRGB , "RGB_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cCCRGB := fo_GetVal(@oRGB , "RGB_CC")     .CNT.','000007','000002','.EXE.','5','cCCRGB := fo_GetVal(@oRGB , "RGB_CC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cPDRGB := fo_GetVal(@oRGB , "RGB_PD")     .CNT.','000008','000002','.EXE.','5','cPDRGB := fo_GetVal(@oRGB , "RGB_PD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cTp1RGB := fo_GetVal(@oRGB , "RGB_TIPO1")     .CNT.','000009','000002','.EXE.','5','cTp1RGB := fo_GetVal(@oRGB , "RGB_TIPO1")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cTp2RGB := fo_GetVal(@oRGB , "RGB_TIPO2")     .CNT.','000010','000002','.EXE.','5','cTp2RGB := fo_GetVal(@oRGB , "RGB_TIPO2")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cDtRGB := fo_GetVal(@oRGB , "RGB_DTREF")     .CNT.','000011','000002','.EXE.','5','cDtRGB := fo_GetVal(@oRGB , "RGB_DTREF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cParRGB := fo_GetVal(@oRGB , "RGB_PARCEL")     .CNT.','000012','000002','.EXE.','5','cParRGB := fo_GetVal(@oRGB , "RGB_PARCEL")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cSeqRGB := fo_GetVal(@oRGB , "RGB_SEQ")     .CNT.','000013','000002','.EXE.','5','cSeqRGB := fo_GetVal(@oRGB , "RGB_SEQ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','fo_ADD(@&cObjeto, {cCpoMat,cCpoHoras, cCpoValor, cCpoCC, cCp','000014','000002','.EXE.','5','fo_ADD(@&cObjeto, {cCpoMat,cCpoHoras, cCpoValor, cCpoCC, cCpoPd, cCpoTipo1, cCpoTipo2,cCpoDtRef, cCpoParcel, cCpoSeq},{cMatRGB,cHrRGB,nVlRGB,cCCRGB,cPDRGB,cTp1RGB,cTp2RGB, cDtRGB, cParRGB, cSeqRGB} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SKIP(@oRGB)     .END.','000015','000002','.EXE.','5','FO_SKIP(@oRGB)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0070    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0070( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSR8','Geracao Ausencias','','000260','103','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSR8','NDIASAFAS := 0     .CNT.','000001','000000','.EXE.','5','NDIASAFAS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerbGoz := FGETCODFOL("0072")     .CNT.','000002','000000','.EXE.','5','cVerbGoz := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Eof(@oSR8)   .END.','000003','000000','.CON.','5','','','5','!fo_Eof(@oSR8)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dFimPer := dDataAte   .CNT.','000004','000003','.EXE.','5','dFimPer',':=','5','dDataAte','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIniFer := dDtFimFer := CTOD("")     .CNT.','000005','000003','.EXE.','5','dDtIniFer := dDtFimFer := CTOD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas := 0     .CNT.','000006','000003','.EXE.','5','nDiasAfas := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasFGTS := 0   .CNT.','000007','000003','.EXE.','5','nDiasFGTS',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nLinha := 0     .CNT.','000008','000003','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','aIncapTemp := {}     .CNT.','000009','000003','.EXE.','5','aIncapTemp := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Eof( @oSR8)   .END.','000010','000003','.ENQ.','5','','','5','!fo_Eof( @oSR8)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nLinha ++     .CNT.','000011','000010','.EXE.','5','nLinha ++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )     .CNT.','000012','000010','.EXE.','5','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )     .','000013','000010','.EXE.','5','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerbaAfas := FO_GETVAL( @OSR8 , "R8_PD" ,nLinha )     .CNT.','000014','000010','.EXE.','5','cVerbaAfas := FO_GETVAL( @OSR8 , "R8_PD" ,nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lContinua := FO_GETVAL( @OSR8 , "R8_CONTINU" ,nLinha )  == "','000015','000010','.EXE.','5','lContinua := FO_GETVAL( @OSR8 , "R8_CONTINU" ,nLinha )  == "1"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", n','000016','000010','.EXE.','5','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", nLinha), SRA->RA_FILIAL, "RCM_TIPOAF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoDia := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", n','000017','000010','.EXE.','5','cTipoDia := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", nLinha), SRA->RA_FILIAL, "RCM_TIPODI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lInformativo:= (cTipoAfa == "3")     .CNT.','000018','000010','.EXE.','5','lInformativo:= (cTipoAfa == "3")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPer <= cPeriodo .AND.','000019','000010','.CON.','5','','','5','cAfaPer','<=','5','cPeriodo','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','(cAfaNPag <= cNumPag) .And. (!lInformativo)   .END.','000020','000010','.CON.','5','','','5','(cAfaNPag <= cNumPag) .And. (!lInformativo)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )     .CNT.','000021','000020','.EXE.','5','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )     .CNT','000022','000020','.EXE.','5','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )     .CN','000023','000020','.EXE.','5','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerba == cVerbGoz .AND. cTipoRot # "1"   .END.','000024','000020','.CON.','5','','','5','cVerba == cVerbGoz .AND. cTipoRot # "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_SKIP(@oSR8)     .CNT.','000025','000024','.EXE.','5','FO_SKIP(@oSR8)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','RetorneEnq()     .END.','000026','000024','.EXE.','5','RetorneEnq()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','Empty(dDtFim)   .END.','000027','000020','.CON.','5','','','5','Empty(dDtFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFim := dFimPer     .END.','000028','000027','.EXE.','5','dDtFim := dFimPer','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni:= 0     .CNT.','000029','000020','.EXE.','5','nDiaIni:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes == MesAno( DDTINI ) .Or. ( cAnoMes < MesAno( DDTIN','000030','000020','.CON.','5','','','5','cAnoMes == MesAno( DDTINI ) .Or. ( cAnoMes < MesAno( DDTINI ) .And. lContinua )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni := Day( dDtIni )     .END.','000031','000030','.EXE.','5','nDiaIni := Day( dDtIni )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes > MesAno(dDtIni) .END.','000032','000020','.CON.','5','','','5','cAnoMes','>','5','MesAno(dDtIni)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni := 1     .END.','000033','000032','.EXE.','5','nDiaIni := 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim:= 0     .CNT.','000034','000020','.EXE.','5','nDiaFim:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes == MesAno( dDtFim ) .END.','000035','000020','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtFim )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := Day( dDtFim )     .END.','000036','000035','.EXE.','5','nDiaFim := Day( dDtFim )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes < MesAno(dDtFim) .END.','000037','000020','.CON.','5','','','5','cAnoMes','<','5','MesAno(dDtFim)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := Day(dFimPer)     .END.','000038','000037','.EXE.','5','nDiaFim := Day(dFimPer)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000039','000020','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .and. P_DIASMES <> "S" )) .and. (nDiaFim > 30)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerbaAfas # FGETCODFOL("0072") .And. cVerbaAfas # FGETCOD','000040','000039','.CON.','5','','','5','cVerbaAfas # FGETCODFOL("0072") .And. cVerbaAfas # FGETCODFOL("0786")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := 30     .END.','000041','000040','.EXE.','5','nDiaFim := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIn','000042','000020','.EXE.','5','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIni + 1), 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoDia ==  '+"'"+'1'+"'"+' .AND. nDias > 0 .And. cVerbaAfas # FGETCO','000043','000020','.CON.','5','','','5','cTipoDia ==  '+"'"+'1'+"'"+' .AND. nDias > 0 .And. cVerbaAfas # FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LOK:=( CANOMES = MESANO(DDTINI) )   .END.','000044','000043','.CON.','5','','','5','LOK:=( CANOMES = MESANO(DDTINI) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS -= DATENOWORKDAY(DDTINI, STOD( (ANOMES(DDTINI)+ALLTRIM','000045','000044','.EXE.','5','NDIAS -= DATENOWORKDAY(DDTINI, STOD( (ANOMES(DDTINI)+ALLTRIM(STR(NDIAFIM))) ))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LOK   .END.','000046','000043','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS -= DATENOWORKDAY( STOD(CANOMES + ALLTRIM(STRZERO(NDIAI','000047','000046','.EXE.','5','NDIAS -= DATENOWORKDAY( STOD(CANOMES + ALLTRIM(STRZERO(NDIAINI,2))), DDTFIM )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas += nDias   .CNT.','000048','000020','.EXE.','5','nDiasAfas','+=','5','nDias','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSdoPagar := fo_GetVal ( @oSR8 , "R8_SDPAGAR" , nLinha )','000049','000020','.EXE.','5','nSdoPagar := fo_GetVal ( @oSR8 , "R8_SDPAGAR" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0   .END.','000050','000020','.CON.','5','','','5','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)     .CN','000051','000050','.EXE.','5','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','MesAno(dDtFimAnt) > MesAno(dDtIni)   .END.','000052','000050','.CON.','5','','','5','MesAno(dDtFimAnt) > MesAno(dDtIni)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LIf:= (Month(dDtIni) = 2)   .END.','000053','000052','.CON.','5','','','5','LIf:= (Month(dDtIni) = 2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2     .END.','000054','000053','.EXE.','5','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LIf   .END.','000055','000052','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni','000056','000055','.EXE.','5','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIn','000057','000050','.EXE.','5','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIni+1,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas-= nDiasNaoAplic     .CNT.','000058','000050','.EXE.','5','nDiasAfas-= nDiasNaoAplic','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LIf:= (cAnoMes==MesAno(DDTINI))   .END.','000059','000050','.CON.','5','','','5','LIf:= (cAnoMes==MesAno(DDTINI))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nPagarMes:= Max(nDiasAfas-fo_GetVal( @oSR8, "R8_DURACAO", nL','000060','000059','.EXE.','5','nPagarMes:= Max(nDiasAfas-fo_GetVal( @oSR8, "R8_DURACAO", nLinha-1),0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LIf   .END.','000061','000050','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nPagarMes:= nDiasAfas     .END.','000062','000061','.EXE.','5','nPagarMes:= nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','000063','000050','.EXE.','5','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDPAGARPER := NDIAS     .CNT.','000064','000020','.EXE.','5','NDPAGARPER := NDIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSeq := fo_count( @&cObjeto , cCpoPD , cVerba ) + 1     .CNT','000065','000020','.EXE.','5','nSeq := fo_count( @&cObjeto , cCpoPD , cVerba ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','( lOk := !fo_Seek(@&cObjeto, cCpoPD, cVerba) .AND. !fo_Del','000066','000020','.CON.','5','','','5','( lOk := !fo_Seek(@&cObjeto, cCpoPD, cVerba) .AND. !fo_Deleted(@&cObjeto) ) .AND. NDPAGARPER > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!CTIPOAFA == "4" .OR. ( CTIPOAFA == "4" .AND. DDTINI >= DD','000067','000066','.CON.','5','','','5','!CTIPOAFA == "4" .OR. ( CTIPOAFA == "4" .AND. DDTINI >= DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoHoras, cCpoSeq}','000068','000067','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoHoras, cCpoSeq} , {cVerba, "D" , nDPagarPer, STR(nSeq, GetSx3Cache( cCpoSeq , "X3_TAMANHO" )) },{cCpoPd, cCpoSeq},{cVerba, STR(nSeq, GetSx3Cache( cCpoSeq , "X3_TAMANHO" ))})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cPaisLoc == "ANG" .And. fo_GetVal(@oSR8, "R8_PERCINC") > 0','000069','000066','.CON.','5','','','5','cPaisLoc == "ANG" .And. fo_GetVal(@oSR8, "R8_PERCINC") > 0 .and. fo_GetVal(@oSR8, "R8_PERCINC") <> 100','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','AADD(AINCAPTEMP, { cVerbaAfas, cAfaPer, cAfaNPag, FO_GETVAL(','000070','000069','.EXE.','5','AADD(AINCAPTEMP, { cVerbaAfas, cAfaPer, cAfaNPag, FO_GETVAL(@OSR8, "R8_PERCINC")} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!lOk   .END.','000071','000020','.CON.','5','','','5','!lOk','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_SETVAL(@&cObjeto,cCPOHORAS, NDIASAFAS )     .END.','000072','000071','.EXE.','5','FO_SETVAL(@&cObjeto,cCPOHORAS, NDIASAFAS )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_Skip ( @oSR8 )     .END.','000073','000010','.EXE.','5','fo_Skip ( @oSR8 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0071    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0071( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRC','Valoriza Verbas','','001176','077','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRC','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000001','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lGerRes := If (Type("lGerRes") == "U" .Or. lGerRes == Nil  ,','000002','000000','.EXE.','5','lGerRes',':=','5','If (Type("lGerRes") == "U" .Or. lGerRes == Nil  , .F. , lGerRes)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerbAdic := fGetCodFol("001")+"*"+fGetCodFol("002")+"*"+fGe','000003','000000','.EXE.','5','cVerbAdic := fGetCodFol("001")+"*"+fGetCodFol("002")+"*"+fGetCodFol("003")+"*"+fGetCodFol("004")+"*"+fGetCodFol("005")+"*"+fGetCodFol("036")+"*"+fGetCodFol("037")+"*"+fGetCodFol("038")+"*"+fGetCodFol("039")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp := IIf(c__Roteiro $ "FOL*RES", DiasTrab, NIL)   .C','000004','000000','.EXE.','5','nDiasProp',':=','5','IIf(c__Roteiro $ "FOL*RES", DiasTrab, NIL)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_GoTop(@&cObjeto)     .CNT.','000005','000000','.EXE.','5','fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!fo_Eof( @&cObjeto )   .END.','000006','000000','.CON.','5','','','5','!fo_Eof( @&cObjeto )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha := 1     .CNT.','000007','000006','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSRC := aClone(&cObjeto:aCols)     .CNT.','000008','000006','.EXE.','5','aSRC := aClone(&cObjeto:aCols)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosPD := GdFieldPos(cCpoPD, & (cObjeto + ":aHeader"))     .','000009','000006','.EXE.','5','nPosPD := GdFieldPos(cCpoPD, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosSeq := GdFieldPos(cCpoSeq, & (cObjeto + ":aHeader"))','000010','000006','.EXE.','5','nPosSeq := GdFieldPos(cCpoSeq, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosCC := GdFieldPos(cCpoCC, & (cObjeto + ":aHeader"))     .','000011','000006','.EXE.','5','nPosCC := GdFieldPos(cCpoCC, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosDel := GdFieldPos("GDDELETED", & (cObjeto + ":aHeader"))','000012','000006','.EXE.','5','nPosDel := GdFieldPos("GDDELETED", & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSort( aSRC ,,, { |x,y| x[ nPosPD ] < y[ nPosPD ] } )     .C','000013','000006','.EXE.','5','aSort( aSRC ,,, { |x,y| x[ nPosPD ] < y[ nPosPD ] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha <= Len(aSRC)   .END.','000014','000006','.ENQ.','5','','','5','nLinha <= Len(aSRC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSRC[nLinha, nPosDel] == .F.   .END.','000015','000014','.CON.','5','','','5','aSRC[nLinha, nPosDel] == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Seek(@&cObjeto, {cCpoPD, cCpoCC, cCpoSeq}, {aSRC[nLinha','000016','000015','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPD, cCpoCC, cCpoSeq}, {aSRC[nLinha,nPosPD], aSRC[nLinha,nPosCC], aSRC[nLinha,nPosSeq]})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .F.     .CNT.','000017','000016','.EXE.','5','lValAlterou := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .F.     .CNT.','000018','000016','.EXE.','5','lQtdAlterou := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 := fo_GetVal( @&cObjeto , cCpoTipo2)     .CNT.','000019','000016','.EXE.','5','cTipo2 := fo_GetVal( @&cObjeto , cCpoTipo2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cTipoRot = "1" .AND. cTipo2 $ "R/I" .AND. lGerRes)   .EN','000020','000016','.CON.','5','','','5','!(cTipoRot = "1" .AND. cTipo2 $ "R/I" .AND. lGerRes)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo := fo_GetVal( @&cObjeto , cCpoTipo1)     .CNT.','000021','000020','.EXE.','5','cTipo := fo_GetVal( @&cObjeto , cCpoTipo1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba := fo_GetVal( @&cObjeto , cCpoPD)     .CNT.','000022','000020','.EXE.','5','cVerba := fo_GetVal( @&cObjeto , cCpoPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPercent := IF (( nPercent := PosSRV(cVerba, SRA->RA_FILIAL,','000023','000020','.EXE.','5','nPercent := IF (( nPercent := PosSRV(cVerba, SRA->RA_FILIAL, "RV_PERC") ) = 0,1,nPercent / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )     .CN','000024','000020','.EXE.','5','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 == "I" .END.','000025','000020','.CON.','5','','','5','cTipo2','==','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)     .CNT.','000026','000025','.EXE.','5','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := fo_GetVal( @&cObjeto , cCpoValor)     .END.','000027','000025','.EXE.','5','nValor := fo_GetVal( @&cObjeto , cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 # "I" .END.','000028','000020','.CON.','5','','','5','cTipo2','#','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)     .CNT.','000029','000028','.EXE.','5','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := fo_GetVal( @&cObjeto , cCpoValor )     .END.','000030','000028','.EXE.','5','nValor := fo_GetVal( @&cObjeto , cCpoValor )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba $ CPDACFIXOS   .END.','000031','000020','.CON.','5','','','5','cVerba $ CPDACFIXOS','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','CFILTRO := MSMM(SRV->RV_CODMEMO,80,,,,,,,,"RE6")     .CNT.','000032','000031','.EXE.','5','CFILTRO := MSMM(SRV->RV_CODMEMO,80,,,,,,,,"RE6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NBASEACU := FO_SOMAINCSRV(@&COBJETO,CCPOVALOR,{CFILTRO},{.T.','000033','000031','.EXE.','5','NBASEACU := FO_SOMAINCSRV(@&COBJETO,CCPOVALOR,{CFILTRO},{.T.})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)     .CNT.','000034','000031','.EXE.','5','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NVALOR :=  NQTD * NBASEACU / 100     .CNT.','000035','000031','.EXE.','5','NVALOR :=  NQTD * NBASEACU / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','FO_RESTORE(@&COBJETO)     .CNT.','000036','000031','.EXE.','5','FO_RESTORE(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','LVALALTEROU:=.T.     .END.','000037','000031','.EXE.','5','LVALALTEROU:=.T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTarefa := PosSrv(cVerba, SRA->RA_FILIAL, "RV_TAREFA")     .','000038','000020','.EXE.','5','cTarefa := PosSrv(cVerba, SRA->RA_FILIAL, "RV_TAREFA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTarefa := If (Len(AllTrim(cTarefa))#3,"   ",cTarefa)     .C','000039','000020','.EXE.','5','cTarefa := If (Len(AllTrim(cTarefa))#3,"   ",cTarefa)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(SalMes # Nil .Or. (SalMes = Nil .And. PosSrv(cVerba, SRA-','000040','000020','.CON.','5','','','5','(SalMes # Nil .Or. (SalMes = Nil .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")  # "S" )) .And. Empty(cTarefa)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cVerba $ cVerbAdic) .Or. (cVerba $ cVerbAdic .And. nValo','000041','000040','.CON.','5','','','5','!(cVerba $ cVerbAdic) .Or. (cVerba $ cVerbAdic .And. nValor = 0 .And. cTipo2 $ "I*F*G" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "H" .END.','000042','000041','.CON.','5','','','5','cTipo','==','5','"H"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round(nQtd*SALHORA*nPercent,nDecimais)   .CNT.','000043','000042','.EXE.','5','nValor',':=','5','round(nQtd*SALHORA*nPercent,nDecimais)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Restore(@&cObjeto)     .CNT.','000044','000042','.EXE.','5','fo_Restore(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000045','000042','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "D" .END.','000046','000041','.CON.','5','','','5','cTipo','==','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round(nQtd*SALDIA * nPercent, nDecimais)   .CNT.','000047','000046','.EXE.','5','nValor',':=','5','round(nQtd*SALDIA * nPercent, nDecimais)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Restore(@&cObjeto)     .CNT.','000048','000046','.EXE.','5','fo_Restore(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000049','000046','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "V" .AND.','000050','000041','.CON.','5','','','5','cTipo','==','5','"V"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 == "I" .AND.','000051','000041','.CON.','5','','','5','cTipo2','==','5','"I"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor > 0 .END.','000052','000041','.CON.','5','','','5','nValor','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000053','000052','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','( SalMes # NIL ) .And. !( cVerba $ CVRBPROP )   .AND.','000054','000020','.CON.','5','','','5','( SalMes # NIL ) .And. !( cVerba $ CVRBPROP )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP") = "S" .END.','000055','000020','.CON.','5','','','5','PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalMes += nValor   .CNT.','000056','000055','.EXE.','5','SalMes','+=','5','nValor','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalHora += (nValor / SRA->RA_HRSMES)   .CNT.','000057','000055','.EXE.','5','SalHora','+=','5','(nValor / SRA->RA_HRSMES)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalDia += (nValor / 30)   .CNT.','000058','000055','.EXE.','5','SalDia','+=','5','(nValor / 30)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lLctoFixo := FO_SEEK( @ORG1, "RG1_PD", CVERBA)     .CNT.','000059','000055','.EXE.','5','lLctoFixo := FO_SEEK( @ORG1, "RG1_PD", CVERBA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # Nil .AND.','000060','000055','.CON.','5','','','5','nDiasProp','#','5','Nil','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp >= 0 .AND.','000061','000055','.CON.','5','','','5','nDiasProp','>=','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cVerba $ (fGetCodFol("165")+'+"'"+'*'+"'"+'+fGetCodFol("166")+'+"'"+'*'+"'"+'+ f','000062','000055','.CON.','5','','','5','!(cVerba $ (fGetCodFol("165")+'+"'"+'*'+"'"+'+fGetCodFol("166")+'+"'"+'*'+"'"+'+ fGetCodFol("347")))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','Empty(cTarefa)   .END.','000063','000055','.CON.','5','','','5','Empty(cTarefa)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo $ "D*H" .AND. nQtd > 0 .OR.lLctoFixo   .END.','000064','000063','.CON.','5','','','5','cTipo $ "D*H" .AND. nQtd > 0 .OR.lLctoFixo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := ( ( nQtd / 30 ) * nDiasProp )     .CNT.','000065','000064','.EXE.','5','nQtd := ( ( nQtd / 30 ) * nDiasProp )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .T.   .END.','000066','000064','.EXE.','5','lQtdAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cTipo $ "D*H" .AND. nQtd > 0) .AND. !lLctoFixo   .END.','000067','000063','.CON.','5','','','5','!(cTipo $ "D*H" .AND. nQtd > 0) .AND. !lLctoFixo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := nDiasProp     .CNT.','000068','000067','.EXE.','5','nQtd := nDiasProp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .T.   .END.','000069','000067','.EXE.','5','lQtdAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := Round(( (nValor / 30 ) * nDiasProp ), nDecimais)','000070','000063','.EXE.','5','nValor := Round(( (nValor / 30 ) * nDiasProp ), nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000071','000063','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(SalMes # NIL .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_IN','000072','000020','.CON.','5','','','5','!(SalMes # NIL .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP") = "S")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(cVerba $ cVerbAdic .Or.  (cVerba $ cVerbAdic .And. !cTipo','000073','000020','.CON.','5','','','5','(cVerba $ cVerbAdic .Or.  (cVerba $ cVerbAdic .And. !cTipo2 $ "I*F*G" ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .T.     .CNT.','000074','000073','.EXE.','5','lPropAdic := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # 0 .END.','000075','000073','.CON.','5','','','5','nDiasProp','#','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99)','000076','000075','.CON.','5','','','5','(cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99) .Or.       (cVerba = fGetCodfol("038") .And. SRA->RA_INSMED = 999.99) .Or. (cVerba = fGetCodfol("039") .And. SRA->RA_INSMED = 999.99)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .F.     .END.','000077','000076','.EXE.','5','lPropAdic := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!((cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.9','000078','000075','.CON.','5','','','5','!((cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99) .Or.       (cVerba = fGetCodfol("038") .And. SRA->RA_INSMED = 999.99) .Or. (cVerba = fGetCodfol("039") .And. SRA->RA_INSMED = 999.99))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba = fGetCodFol("036") .And. SRA->RA_PERICUL = 999.99','000079','000075','.CON.','5','','','5','cVerba = fGetCodFol("036") .And. SRA->RA_PERICUL = 999.99','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .F.     .END.','000080','000079','.EXE.','5','lPropAdic := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # Nil .And. lPropAdic .And. SRA->RA_TIPOPGT # "S','000081','000073','.CON.','5','','','5','nDiasProp # Nil .And. lPropAdic .And. SRA->RA_TIPOPGT # "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round( ( (nValor / 30 ) * Min(nDiasProp, 30) ) ,nD','000082','000081','.EXE.','5','nValor := round( ( (nValor / 30 ) * Min(nDiasProp, 30) ) ,nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000083','000081','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor <= 0 .END.','000084','000081','.CON.','5','','','5','nValor','<=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Delete(@&cObjeto)     .END.','000085','000084','.EXE.','5','fo_Delete(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou   .END.','000086','000020','.CON.','5','','','5','lValAlterou','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','( cVerba $ cVrbPagto ) .And. ( cTipo2 # "I" ) .And. ( nTot','000087','000086','.CON.','5','','','5','( cVerba $ cVrbPagto ) .And. ( cTipo2 # "I" ) .And. ( nTotAdic > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValAdic := nTotAdic / 30 * nQtd     .CNT.','000088','000087','.EXE.','5','nValAdic := nTotAdic / 30 * nQtd','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor += nValAdic     .END.','000089','000087','.EXE.','5','nValor += nValAdic','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto , cCpoValor, nValor)     .END.','000090','000086','.EXE.','5','fo_SetVal(@&cObjeto , cCpoValor, nValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou   .END.','000091','000020','.CON.','5','','','5','lQtdAlterou','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto , cCpoHoras, nQtd)     .END.','000092','000091','.EXE.','5','fo_SetVal(@&cObjeto , cCpoHoras, nQtd)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipoRot == "9" .And. cTipo2 == "I"   .END.','000093','000020','.CON.','5','','','5','cTipoRot == "9" .And. cTipo2 == "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto, cCpoData, dData_Pgto)     .CNT.','000094','000093','.EXE.','5','fo_SetVal(@&cObjeto, cCpoData, dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto, cCpoDtRef, dData_Pgto)     .END.','000095','000093','.EXE.','5','fo_SetVal(@&cObjeto, cCpoDtRef, dData_Pgto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCodPd := PosSrv(cVerba, SRA->RA_FILIAL, "RV_CODCORR")   .CN','000096','000020','.EXE.','5','cCodPd',':=','5','PosSrv(cVerba, SRA->RA_FILIAL, "RV_CODCORR")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCodPd # "   " .END.','000097','000020','.CON.','5','','','5','cCodPd','#','5','"   "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCC := fo_GetVal(@&cObjeto, cCpoCC)     .CNT.','000098','000097','.EXE.','5','cCC := fo_GetVal(@&cObjeto, cCpoCC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoCC, cCp','000099','000097','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoCC, cCpoTipo1, cCpoTipo2, cCpoSeq, cCpoData}, {cCodPd, nValor, nQtd, cCC, cTipo, cTipo2, fo_GetVal(@&cObjeto, cCpoSeq), fo_GetVal(@&cObjeto, cCpoData)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha ++     .END.','000100','000014','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0072    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0072( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRK','Geracao Val. Futuros no Mvto','','000265','039','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRK','dData := if(cTipoRot == "4", dDataDem, dData_Pgto)     .CNT.','000001','000000','.EXE.','5','dData := if(cTipoRot == "4", dDataDem, dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cSitFolh <> "D" .AND.','000002','000000','.CON.','5','','','5','cSitFolh','<>','5','"D"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!fo_Eof( @OSRK )   .END.','000003','000000','.CON.','5','','','5','!fo_Eof( @OSRK )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','aCampos := {cCpoPD, cCpoTipo1, cCpoValor , cCpoNumId, cCpoSe','000004','000003','.EXE.','5','aCampos := {cCpoPD, cCpoTipo1, cCpoValor , cCpoNumId, cCpoSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_GoTop( @OSRK )     .CNT.','000005','000003','.EXE.','5','fo_GoTop( @OSRK )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nLinha := 0     .CNT.','000006','000003','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!fo_Eof( @OSRK )   .END.','000007','000003','.ENQ.','5','','','5','!fo_Eof( @OSRK )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nLinha++     .CNT.','000008','000007','.EXE.','5','nLinha++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_GetVal(@oSRK, "RK_STATUS", nLinha) == "2"   .END.','000009','000007','.CON.','5','','','5','fo_GetVal(@oSRK, "RK_STATUS", nLinha) == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','dDtVenc := fo_GetVal( @OSRK , "RK_DTVENC", nLinha)     .CNT.','000010','000009','.EXE.','5','dDtVenc := fo_GetVal( @OSRK , "RK_DTVENC", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcPg := fo_GetVal( @OSRK , "RK_PARCPAG", nLinha)     .CNT','000011','000009','.EXE.','5','nParcPg := fo_GetVal( @OSRK , "RK_PARCPAG", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcela := fo_GetVal( @OSRK , "RK_PARCELA", nLinha)     .CN','000012','000009','.EXE.','5','nParcela := fo_GetVal( @OSRK , "RK_PARCELA", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','( (cTipoRot == "4" ) .Or. ( dDtVenc <= dData ) )   .AND.','000013','000009','.CON.','5','','','5','( (cTipoRot == "4" ) .Or. ( dDtVenc <= dData ) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcPg < nParcela   .END.','000014','000009','.CON.','5','','','5','nParcPg < nParcela','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cVerba := fo_GetVal( @OSRK , "RK_PD", nLinha)     .CNT.','000015','000014','.EXE.','5','cVerba := fo_GetVal( @OSRK , "RK_PD", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cNumId := fo_GetVal( @OSRK , "RK_NUMID", nLinha)     .CNT.','000016','000014','.EXE.','5','cNumId := fo_GetVal( @OSRK , "RK_NUMID", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nVlParcela := fo_GetVal( @OSRK , "RK_VALORPA", nLinha)     .','000017','000014','.EXE.','5','nVlParcela := fo_GetVal( @OSRK , "RK_VALORPA", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo := fo_GetVal( @OSRK , "RK_VLSALDO", nLinha)     .CNT.','000018','000014','.EXE.','5','nSaldo := fo_GetVal( @OSRK , "RK_VLSALDO", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cTipoRot == "4" .END.','000019','000014','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor := nSaldo + fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','000020','000019','.EXE.','5','nValor',':=','5','nSaldo + fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!(cTipoRot == "4")   .END.','000021','000014','.CON.','5','','','5','!(cTipoRot == "4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo >= nVlParcela .END.','000022','000021','.CON.','5','','','5','nSaldo','>=','5','nVlParcela','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor := nVlParcela     .END.','000023','000022','.EXE.','5','nValor := nVlParcela','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo < nVlParcela .END.','000024','000021','.CON.','5','','','5','nSaldo','<','5','nVlParcela','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor  := nSaldo     .END.','000025','000024','.EXE.','5','nValor  := nSaldo','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','(nParcela - nParcPg) = 1 .END.','000026','000021','.CON.','5','','','5','(nParcela - nParcPg)','=','5','1','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor += fo_GetVal(@oSRK, "RK_VALORAR", nLinha)   .END.','000027','000026','.EXE.','5','nValor','+=','5','fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cSeq := Alltrim(Str(fo_count( @&cObjeto , cCpoPD , cVerba )','000028','000014','.EXE.','5','cSeq := Alltrim(Str(fo_count( @&cObjeto , cCpoPD , cVerba ) + 1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','aConteudos := {cVerba, "V", nValor, cNumId, cSeq}     .CNT.','000029','000014','.EXE.','5','aConteudos := {cVerba, "V", nValor, cNumId, cSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_Add( @&cObjeto , aCampos, aConteudos, {cCpoPD, cCpoSeq},','000030','000014','.EXE.','5','fo_Add( @&cObjeto , aCampos, aConteudos, {cCpoPD, cCpoSeq}, {cVerba, cSeq})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_Skip( @OSRK )     .END.','000031','000007','.EXE.','5','fo_Skip( @OSRK )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0073    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0073( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVI13','CALCULA PROVISAO DE 13 SALARIO','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVI13','NTIPOPRV > 1   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','S_CALCNAT()     .CNT.','000002','000001','.EXE.','5','S_CALCNAT()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','NVALNATAL > 0   .END.','000003','000001','.CON.','5','','','5','NVALNATAL > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','CVRBPRV := FGETCODFOL("0777")     .CNT.','000004','000003','.EXE.','5','CVRBPRV := FGETCODFOL("0777")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','LOK := !EMPTY(CVRBPRV)   .END.','000005','000003','.CON.','5','','','5','LOK := !EMPTY(CVRBPRV)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})   .END.','000006','000005','.CON.','5','','','5','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','FO_SETVAL(@OSRC,CCPOVALOR,NVALNATAL)     .END.','000007','000006','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,NVALNATAL)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','!LIF   .END.','000008','000005','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','FO_ADD(@OSRC,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVRBPRV, NVALNATA','000009','000008','.EXE.','5','FO_ADD(@OSRC,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVRBPRV, NVALNATAL, NAVOS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','!LOK   .END.','000010','000003','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','CMSGLOG := FMSGFORM({19}) + "0777 - " + FDESC("RCN", "0777",','000011','000010','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0777 - " + FDESC("RCN", "0777", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','S_MSGLOG()     .END.','000012','000010','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0074    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0074( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVIFER','CALCULA PROVISAO DE FERIAS','','','031','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVIFER','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_GOTOP(@OSRF)     .CNT.','000002','000001','.EXE.','5','FO_GOTOP(@OSRF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CVRBFER := FGETCODFOL("0072")     .CNT.','000003','000001','.EXE.','5','CVRBFER := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CVRBPRV := FGETCODFOL("0776")     .CNT.','000004','000001','.EXE.','5','CVRBPRV := FGETCODFOL("0776")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasProG := 0     .CNT.','000005','000001','.EXE.','5','nDiasProG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasVenG := 0     .CNT.','000006','000001','.EXE.','5','nDiasVenG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NPERCENTF == 0   .END.','000007','000001','.CON.','5','','','5','NPERCENTF == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','aTabFer := {}     .CNT.','000008','000007','.EXE.','5','aTabFer := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','fRetTab(@aTabFer,"S004",,,dDataBase)     .CNT.','000009','000007','.EXE.','5','fRetTab(@aTabFer,"S004",,,dDataBase)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','LEN(aTabFer) > 0   .END.','000010','000007','.CON.','5','','','5','LEN(aTabFer) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NPERCENTF := aTabFer[10]     .END.','000011','000010','.EXE.','5','NPERCENTF := aTabFer[10]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!FO_EOF(@OSRF)   .END.','000012','000001','.ENQ.','5','','','5','!FO_EOF(@OSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','( FO_GETVAL(@OSRF,"RF_PD") == CVRBFER ) .AND. ( FO_GETVAL(','000013','000012','.CON.','5','','','5','( FO_GETVAL(@OSRF,"RF_PD") == CVRBFER ) .AND. ( FO_GETVAL(@OSRF,"RF_DATABAS") <= DDATAATE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"   .END.','000014','000013','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasProG += FO_GETVAL(@OSRF,"RF_DFERAAT")     .CNT.','000015','000014','.EXE.','5','nDiasProG += FO_GETVAL(@OSRF,"RF_DFERAAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasVenG += FO_GETVAL(@OSRF,"RF_DFERVAT")     .END.','000016','000014','.EXE.','5','nDiasVenG += FO_GETVAL(@OSRF,"RF_DFERVAT")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_SKIP(@OSRF)     .END.','000017','000012','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nValorG := ( nDiasVenG + nDiasProG ) * SalDia     .CNT.','000018','000001','.EXE.','5','nValorG := ( nDiasVenG + nDiasProG ) * SalDia','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NVALORG > 0 .AND. ( LOK := !EMPTY(CVRBPRV) )   .END.','000019','000001','.CON.','5','','','5','NVALORG > 0 .AND. ( LOK := !EMPTY(CVRBPRV) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})   .END.','000020','000019','.CON.','5','','','5','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_SETVAL(@OSRC,CCPOVALOR,NVALORG)     .END.','000021','000020','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,NVALORG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!LIF   .END.','000022','000019','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR, CCPOHORAS},{CVRBPRV, NVALOR','000023','000022','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR, CCPOHORAS},{CVRBPRV, NVALORG, NDIASVENG+NDIASPROG})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NVALORG > 0 .AND. !LOK   .END.','000024','000001','.CON.','5','','','5','NVALORG > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CMSGLOG := FMSGFORM({19}) + "0776 - " + FDESC("RCN", "0776",','000025','000024','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0776 - " + FDESC("RCN", "0776", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','S_MSGLOG()     .END.','000026','000024','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0075    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0075( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVIMES','CALCULO DE PROVISAO DO MES','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVIMES','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORG := 0     .CNT.','000002','000001','.EXE.','5','NVALORG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CVERBGZ := FGETCODFOL("0130")     .CNT.','000003','000001','.EXE.','5','CVERBGZ := FGETCODFOL("0130")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})   .END.','000004','000001','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORG += FO_GETVAL(@OSRC,CCPOVALOR)     .CNT.','000005','000004','.EXE.','5','NVALORG += FO_GETVAL(@OSRC,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORG -= IF(NPRACUMGZ<0,NPRACUMGZ*(-1),NPRACUMGZ)     .CNT','000006','000004','.EXE.','5','NVALORG -= IF(NPRACUMGZ<0,NPRACUMGZ*(-1),NPRACUMGZ)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORG > 0 .AND. ( LOK := !EMPTY(CVERBGZ)  )   .END.','000007','000004','.CON.','5','','','5','NVALORG > 0 .AND. ( LOK := !EMPTY(CVERBGZ)  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{CVERBGZ, NVALORG})     .EN','000008','000007','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{CVERBGZ, NVALORG})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORG > 0 .AND. !LOK   .END.','000009','000004','.CON.','5','','','5','NVALORG > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CMSGLOG := FMSGFORM({19}) + "0130 - " + FDESC("RCN", "0130",','000010','000009','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0130 - " + FDESC("RCN", "0130", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','S_MSGLOG()     .END.','000011','000009','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORF := 0     .CNT.','000012','000001','.EXE.','5','NVALORF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CVERBFER := FGETCODFOL("0254")     .CNT.','000013','000001','.EXE.','5','CVERBFER := FGETCODFOL("0254")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0825")})   .END.','000014','000001','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0825")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORF += FO_GETVAL(@OSRC,CCPOVALOR)     .CNT.','000015','000014','.EXE.','5','NVALORF += FO_GETVAL(@OSRC,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORF -= IF(NPRACUFER<0,NPRACUFER*(-1),NPRACUFER)     .CNT','000016','000014','.EXE.','5','NVALORF -= IF(NPRACUFER<0,NPRACUFER*(-1),NPRACUFER)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORF > 0 .AND. ( LOK := !EMPTY(CVERBFER) )   .END.','000017','000014','.CON.','5','','','5','NVALORF > 0 .AND. ( LOK := !EMPTY(CVERBFER) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{CVERBFER, NVALORF})     .E','000018','000017','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{CVERBFER, NVALORF})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORF > 0 .AND. !LOK   .END.','000019','000014','.CON.','5','','','5','NVALORF > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CMSGLOG := FMSGFORM({19}) + "0254 - " + FDESC("RCN", "0254",','000020','000019','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0254 - " + FDESC("RCN", "0254", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','S_MSGLOG()     .END.','000021','000019','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NTIPOPRV > 1   .END.','000022','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR := 0     .CNT.','000023','000022','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CVERBPF := FGETCODFOL("0136")     .END.','000024','000022','.EXE.','5','CVERBPF := FGETCODFOL("0136")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})   .END.','000025','000022','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR += FO_GETVAL(@OSRC,CCPOVALOR)     .CNT.','000026','000025','.EXE.','5','NVALOR += FO_GETVAL(@OSRC,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR -= IF(NPRACU13<0,NPRACU13*(-1),NPRACU13)     .CNT.','000027','000025','.EXE.','5','NVALOR -= IF(NPRACU13<0,NPRACU13*(-1),NPRACU13)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR > 0 .AND. ( LOK := !EMPTY(CVERBPF) )   .END.','000028','000025','.CON.','5','','','5','NVALOR > 0 .AND. ( LOK := !EMPTY(CVERBPF) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{FGETCODFOL("0136"), NVALOR','000029','000028','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{FGETCODFOL("0136"), NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR > 0 .AND. !LOK   .END.','000030','000025','.CON.','5','','','5','NVALOR > 0 .AND. !LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CMSGLOG := FMSGFORM({19}) + "0136 - " + FDESC("RCN", "0136",','000031','000030','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0136 - " + FDESC("RCN", "0136", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','S_MSGLOG()     .END.','000032','000030','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0076    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0076( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOB','SALARIO BASE MES DOS FUNCIONAR','SALARIO','001065','004','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOB','SALMES     .END.','000001','000000','.EXE.','2','SALMES','','1','','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0077    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0077( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOD','SALARIO DIA DOS FUNCIONARIOS','SALDIA','001066','003','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','sra->ra_salario / 30   .END.','000003','000002','.EXE.','1','sra->ra_salario','/','5','30','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_TIPOPGT = "S" .AND.','000004','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC = "S" .END.','000005','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO / 7   .END.','000006','000005','.EXE.','1','SRA->RA_SALARIO','/','5','7','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC $ "H*T*G" .END.','000007','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO * SRA->RA_HRSMES / 30 .END.','000008','000007','.EXE.','1','SRA->RA_SALARIO','*','1','SRA->RA_HRSMES','/','5','30','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_CATFUNC = "D" .END.','000009','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOD','SRA->RA_SALARIO     .END.','000010','000009','.EXE.','1','SRA->RA_SALARIO','','5','','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0078    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0078( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOH','SALARIO HORA DOS FUNCIONARIOS','SALHORA','001067','004','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','sra->ra_salario / SRA->RA_HRSMES   .END.','000003','000002','.EXE.','1','sra->ra_salario','/','1','SRA->RA_HRSMES','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_TIPOPGT = "S" .AND.','000004','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC = "S" .END.','000005','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SALHORA := SRA->RA_SALARIO / 7 .CNT.','000006','000005','.EXE.','2','SALHORA',':=','1','SRA->RA_SALARIO','/','5','7','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SALHORA *= 30 / SRA->RA_HRSMES .END.','000007','000005','.EXE.','2','SALHORA','*=','5','30','/','1','SRA->RA_HRSMES','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC $ "H*T*G" .END.','000008','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_SALARIO     .END.','000009','000008','.EXE.','1','SRA->RA_SALARIO','','5','','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_CATFUNC = "D" .END.','000010','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOH','SRA->RA_SALARIO * 30 / SRA->RA_HRSMES .END.','000011','000010','.EXE.','1','SRA->RA_SALARIO','*','5','30','/','1','SRA->RA_HRSMES','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0079    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0079( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOM','SALARIO MENSAL DOS FUNCIONARIO','','001068','008','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_TIPOPGT == "M" .AND.','000001','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','==','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "M*C*P*A*E" .END.','000002','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"M*C*P*A*E"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := sra->ra_salario   .CNT.','000003','000002','.EXE.','5','SALMES',':=','5','sra->ra_salario','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000004','000002','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000005','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_TIPOPGT = "S" .AND.','000006','000000','.CON.','2','','','1','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC = "S" .END.','000007','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO / 7 * 30 .CNT.','000008','000007','.EXE.','5','SALMES := SRA->RA_SALARIO','/','5','7','*','5','30','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000009','000007','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000010','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "H*T*G" .AND.','000011','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTipoRot == "1" .END.','000012','000000','.CON.','2','','','5','cTipoRot','==','5','"1"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','NCOMPHRS := nHorasTrab + nHorasDSR .CNT.','000013','000012','.EXE.','2','NCOMPHRS',':=','5','nHorasTrab','+','5','nHorasDSR','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * NCOMPHRS   .CNT.','000014','000012','.EXE.','5','SALMES := SRA->RA_SALARIO','*','2','NCOMPHRS','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000015','000012','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000016','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC == "H" .AND.','000017','000000','.CON.','2','','','1','SRA->RA_CATFUNC','==','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTipoRot == "2I" .AND.','000018','000000','.CON.','2','','','5','cTipoRot','==','5','"2I"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cCompMes == "S" .AND.','000019','000000','.CON.','2','','','2','cCompMes','==','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','cTip == "B" .END.','000020','000000','.CON.','2','','','2','cTip','==','5','"B"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','NCOMPHRS := nHorasTrab + nHorasDSR .CNT.','000021','000020','.EXE.','2','NCOMPHRS',':=','5','nHorasTrab','+','5','nHorasDSR','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * NCOMPHRS   .CNT.','000022','000020','.EXE.','5','SALMES := SRA->RA_SALARIO','*','2','NCOMPHRS','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000023','000020','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000024','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC $ "H*T*G" .END.','000025','000000','.CON.','2','','','1','SRA->RA_CATFUNC','$','5','"H*T*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * SRA->RA_HRSMES   .CNT.','000026','000025','.EXE.','5','SALMES := SRA->RA_SALARIO','*','1','SRA->RA_HRSMES','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','lExec := .T.     .END.','000027','000025','.EXE.','5','lExec := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','!lExec   .AND.','000028','000000','.CON.','2','','','5','!lExec','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SRA->RA_CATFUNC = "D" .END.','000029','000000','.CON.','2','','','1','SRA->RA_CATFUNC','=','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALARIOM','SALMES := SRA->RA_SALARIO * 30   .END.','000030','000029','.EXE.','5','SALMES := SRA->RA_SALARIO','*','5','30','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0080    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0080( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALINC','SALARIO INCORPORADO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRC()     .CNT.','000001','000000','.EXE.','5','S_CARGASRC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRK()     .CNT.','000002','000000','.EXE.','5','S_CARGASRK()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARGB()     .CNT.','000003','000000','.EXE.','5','S_CARGARGB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCH()     .CNT.','000004','000000','.EXE.','5','S_CARGARCH()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGATAB()     .CNT.','000005','000000','.EXE.','5','S_CARGATAB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCF()     .CNT.','000006','000000','.EXE.','5','S_CARGARCF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARCM()     .CNT.','000007','000000','.EXE.','5','S_CARGARCM()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRF()     .CNT.','000008','000000','.EXE.','5','S_CARGASRF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASR8()     .CNT.','000009','000000','.EXE.','5','S_CARGASR8()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGASRB()     .CNT.','000010','000000','.EXE.','5','S_CARGASRB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CARGARG1()     .CNT.','000011','000000','.EXE.','5','S_CARGARG1()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCRGB()     .CNT.','000012','000000','.EXE.','5','S_PROCRGB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCSR8()     .CNT.','000013','000000','.EXE.','5','S_PROCSR8()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_DIASTRAB()     .CNT.','000014','000000','.EXE.','5','S_DIASTRAB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOM()     .CNT.','000015','000000','.EXE.','5','S_SALARIOM()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOD()     .CNT.','000016','000000','.EXE.','5','S_SALARIOD()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOH()     .CNT.','000017','000000','.EXE.','5','S_SALARIOH()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_SALARIOB()     .CNT.','000018','000000','.EXE.','5','S_SALARIOB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_CALCDSR()     .CNT.','000019','000000','.EXE.','5','S_CALCDSR()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_GRAVASAL()     .CNT.','000020','000000','.EXE.','5','S_GRAVASAL()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCRG1()     .CNT.','000021','000000','.EXE.','5','S_PROCRG1()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALINC','S_PROCSRC()     .END.','000022','000000','.EXE.','5','S_PROCSRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0081    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0081( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALMIN','SALARIO MINIMO','VAL_SALMIN','000268','011','2','1',} )

aAdd(aRc3Cols, { '','S_','SALMIN','VAL_SALMIN := FTABELA("S014",1,4, dDataRef)     .CNT.','000001','000000','.EXE.','5','VAL_SALMIN := FTABELA("S014",1,4, dDataRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SALMIN','Type("VAL_SALMIN") = "U" .END.','000002','000000','.CON.','5','','','5','Type("VAL_SALMIN")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SALMIN','VAL_SALMIN := 0   .END.','000003','000002','.EXE.','5','VAL_SALMIN',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0082    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0082( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SDOSALA','CALCULA SALDO DE SALARIO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','SDOSALA','CVERBA := FGETCODFOL("0048")     .CNT.','000001','000000','.EXE.','5','CVERBA := FGETCODFOL("0048")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','EMPTY(CVERBA)   .END.','000002','000000','.CON.','5','','','5','EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','CMSGLOG := FMSGFORM({19}) + "0048 - " + FDESC("RCN", "0048",','000003','000002','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0048 - " + FDESC("RCN", "0048", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','S_MSGLOG()     .CNT.','000004','000002','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','FINALFUN()     .END.','000005','000002','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000006','000000','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','NPOS > 0 .AND. FTABELA("S015",NPOS,6) == "S"   .END.','000007','000000','.CON.','5','','','5','NPOS > 0 .AND. FTABELA("S015",NPOS,6) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','NVALOR := ROUND( (SALMES / 30) * DIASTRAB,MSDECIMAIS(1))','000008','000007','.EXE.','5','NVALOR := ROUND( (SALMES / 30) * DIASTRAB,MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','SDOSALA','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVERBA,ROUND(','000009','000007','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVERBA,ROUND(NVALOR,2),DIASTRAB})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddANG0083    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddANG0083( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','VALRES','VALORIZA VERBAS NA RESCISAO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','VALRES','FO_GOTOP(@&COBJETO)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','!FO_EOF(@&COBJETO)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','VALRES','CTIPO := FO_GETVAL( @&COBJETO , CCPOTIPO1)     .CNT.','000003','000002','.EXE.','5','CTIPO := FO_GETVAL( @&COBJETO , CCPOTIPO1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NDECIMAIS := GETSX3CACHE( CCPOVALOR , "X3_DECIMAL" )     .CN','000004','000002','.EXE.','5','NDECIMAIS := GETSX3CACHE( CCPOVALOR , "X3_DECIMAL" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','CVERBA := FO_GETVAL( @&COBJETO , CCPOPD)     .CNT.','000005','000002','.EXE.','5','CVERBA := FO_GETVAL( @&COBJETO , CCPOPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','CTIPO2 := FO_GETVAL( @&COBJETO , CCPOTIPO2)     .CNT.','000006','000002','.EXE.','5','CTIPO2 := FO_GETVAL( @&COBJETO , CCPOTIPO2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NVALOR := FO_GETVAL( @&COBJETO , CCPOVALOR)     .CNT.','000007','000002','.EXE.','5','NVALOR := FO_GETVAL( @&COBJETO , CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)     .CNT.','000008','000002','.EXE.','5','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NPERCENT := IF (( NPERCENT := POSSRV(CVERBA, SRA->RA_FILIAL,','000009','000002','.EXE.','5','NPERCENT := IF (( NPERCENT := POSSRV(CVERBA, SRA->RA_FILIAL, "RV_PERC") ) = 0,1,NPERCENT / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','NVALOR = 0 .AND. CTIPO2 $ " *I*F*G"   .END.','000010','000002','.CON.','5','','','5','NVALOR = 0 .AND. CTIPO2 $ " *I*F*G"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VALRES','CTIPO=="H"   .END.','000011','000010','.CON.','5','','','5','CTIPO=="H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VALRES','NVALOR:=ROUND(NQTD*SALHORA*NPERCENT,NDECIMAIS)     .CNT.','000012','000011','.EXE.','5','NVALOR:=ROUND(NQTD*SALHORA*NPERCENT,NDECIMAIS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','FO_SETVAL(@&COBJETO , CCPOVALOR, NVALOR)     .END.','000013','000011','.EXE.','5','FO_SETVAL(@&COBJETO , CCPOVALOR, NVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','CTIPO=="D"   .END.','000014','000010','.CON.','5','','','5','CTIPO=="D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','VALRES','NVALOR:=ROUND(NQTD*SALDIA * NPERCENT, NDECIMAIS)     .CNT.','000015','000014','.EXE.','5','NVALOR:=ROUND(NQTD*SALDIA * NPERCENT, NDECIMAIS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','FO_SETVAL(@&COBJETO , CCPOVALOR, NVALOR)     .END.','000016','000014','.EXE.','5','FO_SETVAL(@&COBJETO , CCPOVALOR, NVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','VALRES','FO_SKIP(@&COBJETO)     .END.','000017','000002','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )