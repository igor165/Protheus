#INCLUDE "PROTHEUS.CH"

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³GpForEQU      ³Autor³ Gerado pelo sistema ³ Data ³27/02/2013³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Formulas padroes                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function GpForEQU()

Local aRC2Header  := {}
Local aRC3Header  := {}
Local aSYPHeader  := {}

Local bForm	    := NIL

Local cFormNum
Local cForm

Local lRet        := .T.
Local nItem       := 0
Local cFil        := Alltrim(Str(FWGETTAMFILIAL))

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Cabecalho de RC2 e RC3 gerado pela formula padrao            ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
aAdd(aRC2Header, { 'Sucursal','RC2_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Origen','RC2_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','€€€€€€€€€€€€€€°','C','      ','R','S_=Sistema;U_=Usuario                                                                                                           ','"U_"','','V','','','.F.' })
aAdd(aRC2Header, { 'Cod. Formula','RC2_CODIGO','@!','15','0','RC2CodigoVld()','€€€€€€€€€€€€€€°','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Desc. Form.','RC2_DESC','@!','40','0','NaoVAzio()','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Retorno','RC2_RETURN','@!','10','0','Vazio() .or. ExistCpo("RCA")','€€€€€€€€€€€€€€°','C','RCA01 ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Cod. Observ.','RC2_CODOBS','@!','6','0','NaoVazio()','€€€€€€€€€€€€€€€','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Version Form','RC2_VERSAO','','3','0','','€€€€€€€€€€€€€€ˆ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Recompilar','RC2_RECOMP','9','1','0','Pertence("12")','€€€€€€€€€€€€€€€','C','      ','R','1=Si;2=No                                                                                                                       ','"1"','','V','','','.F.' })
aAdd(aRC2Header, { 'Mod.Planilla','RC2_MODELO','@!','1','0','Pertence("12")','€€€€€€€€€€€€€€€','C','      ','R','1=Planilla Modelo 1;2=Planilla Modelo 2                                                                                         ','fGetModFol()','','V','','','.F.' })

aAdd(aRC3Header, { 'Sucursal','RC3_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Origen','RC3_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','€€€€€€€€€€€€€€°','C','      ','R','S_=Sistema;U_=Usuario                                                                                                           ','"U_"','','V','','','.F.' })
aAdd(aRC3Header, { 'Cod. Formula','RC3_CODIGO','@!','15','0','','€€€€€€€€€€€€€€°','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC3Header, { 'Descripcion','RC3_DESCR','@!S31','60','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Sec.','RC3_SEQFOR','999999','6','0','NaoVazio() .and. Gpea290SeqFor( .T. )','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','Gpea290SeqFor()','SeqWhen()',' ','','','.F.' })
aAdd(aRC3Header, { 'Cod Sec. Pri','RC3_SEQPAI','999999','6','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Expr.','RC3_TIPO','@!','5','0','NaoVazio()','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp1','RC3_TPRESU','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"2"','','V','','','.F.' })
aAdd(aRC3Header, { 'Resultado','RC3_RESULT','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.1','RC3_OPERA1','@!','16','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp2','RC3_TPFM01','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '1ª Expresion','RC3_FORM01','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.2','RC3_OPERA2','@!','5','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp3','RC3_TPFM02','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '2ª Expresion','RC3_FORM02','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.3','RC3_OPERA3','@!','5','0','Gpea290Return()','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','".END."','',' ','','','.F.' })
aAdd(aRC3Header, { 'Imagen 1','RC3_RESOU1','@!','20','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Imagen 2','RC3_RESOU2','@!','20','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })

aAdd(aSYPHeader, { 'Sucursal','YP_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Clave','YP_CHAVE','','6','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Secuencia','YP_SEQ','','3','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Linea','YP_TEXTO','','80','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Campo','YP_CAMPO','','10','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Só carrega se estiver utilizando modelo padrão do pais.       ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
If !(MV_MODFOL == "1")
	Return
EndIf

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Validar a Estrutura das Tabela RC2 e RC3 com a do Cliente     ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
lRet := fNewOldSx3(aRC2Header, aRC3Header, "RC2", "RC3")
lRet := fNewOldSx3(aSYPHeader, NIL, "SYP")

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Executar gravacao da formula.                                 ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
IF ( lRet )

	/*/
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Chamada da funcao de gravacao                                ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
	cFormNum := "0000"
	For nItem := 1 To 121
		cFormNum	:= __Soma1( cFormNum )
		cForm		:= ( "Add" + cPaisLoc + cFormNum )
		IF IsFunction( cForm )
			bForm := __ExecMacro( '{ ||' +  cForm + '( aRc2Header , aRc3Header, aSYPHeader ) }' )
			CheckExecForm( bForm , .T. , 'ERRADDFRM' , cForm )
		EndIF
	Next nItem

EndIF

Return( NIL )


/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0001    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0001( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEFER','OBTEM DATA BASE DE FERIAS','','000870','005','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEFER','DFIM := DDATAATE     .CNT.','000001','','.EXE.','5','DFIM := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GOTOP(@OSRF)     .CNT.','000002','','.EXE.','5','FO_GOTOP(@OSRF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','!FO_EOF(@OSRF)   .END.','000003','','.ENQ.','5','','','5','!FO_EOF(@OSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEFER','( FO_GETVAL(@OSRF,"RF_PD") == FGETCODFOL("0072") ) .AND. (','000004','','.CON.','5','','','5','( FO_GETVAL(@OSRF,"RF_PD") == FGETCODFOL("0072") ) .AND. ( FO_GETVAL(@OSRF,"RF_DATABAS") <= DFIM )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"   .END.','000005','000004','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEFER','DDTBASFER := FO_GETVAL(@OSRF,"RF_DATABAS")     .CNT.','000006','000005','.EXE.','5','DDTBASFER := FO_GETVAL(@OSRF,"RF_DATABAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GOBOTTOM(@OSRF)     .END.','000007','000005','.EXE.','5','FO_GOBOTTOM(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_SKIP(@OSRF)     .END.','000008','000003','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0002    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0002( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BENEFIC','CALCULA E GRAVA BENEFICIOS','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','BENEFIC','Ajuda de Custo Nacional / Estrangeiro     .CNT.','000001','000000','.MSG.','5','Ajuda de Custo Nacional / Estrangeiro','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCAJC()     .CNT.','000002','000000','.EXE.','5','S_CALCAJC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVAJC()     .CNT.','000003','000000','.EXE.','5','S_GRAVAJC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','Ajuda de Custo Formaçao     .CNT.','000004','000000','.MSG.','5','Ajuda de Custo Formaçao','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCAJCF()     .CNT.','000005','000000','.EXE.','5','S_CALCAJCF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVAJCF()     .CNT.','000006','000000','.EXE.','5','S_GRAVAJCF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','Abono Familiar     .CNT.','000007','000000','.MSG.','5','Abono Familiar','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCABFA()     .CNT.','000008','000000','.EXE.','5','S_CALCABFA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVABFA()     .CNT.','000009','000000','.EXE.','5','S_GRAVABFA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','Subsidio Alimentaçao     .CNT.','000010','000000','.MSG.','5','Subsidio Alimentaçao','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCSBAL()     .CNT.','000011','000000','.EXE.','5','S_CALCSBAL()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVSBAL()     .CNT.','000012','000000','.EXE.','5','S_GRAVSBAL()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','Subsidio Transporte     .CNT.','000013','000000','.MSG.','5','Subsidio Transporte','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_CALCSBTR()     .CNT.','000014','000000','.EXE.','5','S_CALCSBTR()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BENEFIC','S_GRAVSBTR()     .END.','000015','000000','.EXE.','5','S_GRAVSBTR()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0003    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0003( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPROFER','REALIZA BAIXA PROVISAO FERIAS','','','033','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPROFER','c__Roteiro == "PRV"   .END.','000001','000000','.CON.','5','','','5','c__Roteiro == "PRV"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CVRBFER := FGETCODFOL("0233")     .CNT.','000002','000001','.EXE.','5','CVRBFER := FGETCODFOL("0233")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','lok := .t.     .CNT.','000003','000001','.EXE.','5','lok := .t.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','APERABER := {}     .CNT.','000004','000001','.EXE.','5','APERABER := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','aPERFECH:= {}     .CNT.','000005','000001','.EXE.','5','aPERFECH:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBAS:= {}     .CNT.','000006','000001','.EXE.','5','AVERBAS:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBASFER := {}     .CNT.','000007','000001','.EXE.','5','AVERBASFER := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR','000008','000001','.EXE.','5','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR+DTOS(RC_DATA)")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORFER := 0     .CNT.','000009','000001','.EXE.','5','NHORFER := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALFER := 0     .CNT.','000010','000001','.EXE.','5','NVALFER := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000011','000001','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, SRA->RA_PROCES, NIL, @APERABER, @APERFECH)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AADD(AVERBAS, {FGETCODFOL("0072")})     .CNT.','000012','000001','.EXE.','5','AADD(AVERBAS, {FGETCODFOL("0072")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBASFER := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT','000013','000001','.EXE.','5','AVERBASFER := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , AVERBAS,  APERABER, APERFECH )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','LEN(AVERBASFER)  > 0   .END.','000014','000001','.CON.','5','','','5','LEN(AVERBASFER)  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX := 1     .CNT.','000015','000014','.EXE.','5','NX := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX <= LEN(AVERBASFER )   .END.','000016','000014','.ENQ.','5','','','5','NX <= LEN(AVERBASFER )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORFER += AVERBASFER[ NX , 6]     .CNT.','000017','000016','.EXE.','5','NHORFER += AVERBASFER[ NX , 6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALFER += AVERBASFER[ NX , 7]     .CNT.','000018','000016','.EXE.','5','NVALFER += AVERBASFER[ NX , 7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX += 1     .END.','000019','000016','.EXE.','5','NX += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','!LOK   .END.','000020','000001','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CMSGLOG := FMSGFORM({19}) + "0233 - " + FDESC("RCN", "0233",','000021','000020','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0233 - " + FDESC("RCN", "0233", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000022','000020','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBAS:= {}     .CNT.','000023','000001','.EXE.','5','AVERBAS:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBASFER := {}     .CNT.','000024','000001','.EXE.','5','AVERBASFER := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CVRBRES := FGETCODFOL("0262")     .CNT.','000025','000001','.EXE.','5','CVRBRES := FGETCODFOL("0262")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORRES := 0     .CNT.','000026','000001','.EXE.','5','NHORRES := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALRES := 0     .CNT.','000027','000001','.EXE.','5','NVALRES := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AADD(AVERBAS, {FGETCODFOL("0086")})     .CNT.','000028','000001','.EXE.','5','AADD(AVERBAS, {FGETCODFOL("0086")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBASFER := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT','000029','000001','.EXE.','5','AVERBASFER := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , AVERBAS,  APERABER, APERFECH )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','LEN(AVERBASFER)  > 0   .END.','000030','000001','.CON.','5','','','5','LEN(AVERBASFER)  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX := 1     .CNT.','000031','000030','.EXE.','5','NX := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX <= LEN(AVERBASFER )   .END.','000032','000030','.ENQ.','5','','','5','NX <= LEN(AVERBASFER )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORRES += AVERBASFER[ NX , 6]     .CNT.','000033','000032','.EXE.','5','NHORRES += AVERBASFER[ NX , 6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALRES += AVERBASFER[ NX , 7]     .CNT.','000034','000032','.EXE.','5','NVALRES += AVERBASFER[ NX , 7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX += 1     .END.','000035','000032','.EXE.','5','NX += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBAS:= {}     .CNT.','000036','000001','.EXE.','5','AVERBAS:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBASFER := {}     .CNT.','000037','000001','.EXE.','5','AVERBASFER := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AADD(AVERBAS, {FGETCODFOL("0087")})     .CNT.','000038','000001','.EXE.','5','AADD(AVERBAS, {FGETCODFOL("0087")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','AVERBASFER := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT','000039','000001','.EXE.','5','AVERBASFER := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , AVERBAS,  APERABER, APERFECH )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','LEN(AVERBASFER)  > 0   .END.','000040','000001','.CON.','5','','','5','LEN(AVERBASFER)  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX := 1     .CNT.','000041','000040','.EXE.','5','NX := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX <= LEN(AVERBASFER )   .END.','000042','000040','.ENQ.','5','','','5','NX <= LEN(AVERBASFER )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORRES += AVERBASFER[ NX , 6]     .CNT.','000043','000042','.EXE.','5','NHORRES += AVERBASFER[ NX , 6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALRES += AVERBASFER[ NX , 7]     .CNT.','000044','000042','.EXE.','5','NVALRES += AVERBASFER[ NX , 7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NX += 1     .END.','000045','000042','.EXE.','5','NX += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALFER > 0   .END.','000046','000001','.CON.','5','','','5','NVALFER > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','LVRB := !EMPTY(CVRBFER)   .END.','000047','000046','.CON.','5','','','5','LVRB := !EMPTY(CVRBFER)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBFER, NHORFE','000048','000047','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBFER, NHORFER, NVALFER})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','!LVRB   .END.','000049','000046','.CON.','5','','','5','!LVRB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CMSGLOG := FMSGFORM({19}) + CVRBFER + " - " + FDESC("RCN", C','000050','000049','.EXE.','5','CMSGLOG := FMSGFORM({19}) + CVRBFER + " - " + FDESC("RCN", CVRBFER, "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000051','000049','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000052','000048','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALRES > 0   .END.','000053','000001','.CON.','5','','','5','NVALRES > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','LVRE := !EMPTY(CVRBRES)   .END.','000054','000053','.CON.','5','','','5','LVRE := !EMPTY(CVRBRES)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBRES, NHORRE','000055','000054','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBRES, NHORRES, NVALRES})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','!LVRE   .END.','000056','000053','.CON.','5','','','5','!LVRE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CMSGLOG := FMSGFORM({19}) + CVRBRES + " - " + FDESC("RCN", C','000057','000056','.EXE.','5','CMSGLOG := FMSGFORM({19}) + CVRBRES + " - " + FDESC("RCN", CVRBRES, "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000058','000056','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','S_MSGLOG()     .END.','000059','000053','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0004    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0004( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPROV13','REALIZA BAIXA PROVISAO 13 SALARIO','','','015','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPROV13','c__Roteiro == "PRV"   .END.','000001','000000','.CON.','5','','','5','c__Roteiro == "PRV"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','APERAB:= {}     .CNT.','000002','000001','.EXE.','5','APERAB:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','APERFECH:= {}     .CNT.','000003','000001','.EXE.','5','APERFECH:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','AVERBAS:= {}     .CNT.','000004','000001','.EXE.','5','AVERBAS:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','AVERBASB13:= {}     .CNT.','000005','000001','.EXE.','5','AVERBASB13:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CVERBX1 := FGETCODFOL("0332")     .CNT.','000006','000001','.EXE.','5','CVERBX1 := FGETCODFOL("0332")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','LOK := .T.     .CNT.','000007','000001','.EXE.','5','LOK := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX := 0     .CNT.','000008','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX := 0     .CNT.','000009','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000010','000001','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, SRA->RA_PROCES, NIL, @APERAB, @APERFECH)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','AADD(AVERBAS, {FGETCODFOL("0024")})     .CNT.','000011','000001','.EXE.','5','AADD(AVERBAS, {FGETCODFOL("0024")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','AVERBASB13 := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT','000012','000001','.EXE.','5','AVERBASB13 := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , AVERBAS,  APERAB, APERFECH )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','Len(aVerbasB13) > 0   .END.','000013','000001','.CON.','5','','','5','Len(aVerbasB13) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','nx := 1     .CNT.','000014','000013','.EXE.','5','nx := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','nx <= Len(aVerbasB13 )   .END.','000015','000013','.ENQ.','5','','','5','nx <= Len(aVerbasB13 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += aVerbasB13[ nx , 6]     .CNT.','000016','000015','.EXE.','5','NHORBX += aVerbasB13[ nx , 6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += aVerbasB13[ nx , 7]     .CNT.','000017','000015','.EXE.','5','NVALBX += aVerbasB13[ nx , 7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','nx += 1     .END.','000018','000015','.EXE.','5','nx += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX > 0 .AND. ( LOK := !EMPTY(CVERBX1) )   .END.','000019','000001','.CON.','5','','','5','NVALBX > 0 .AND. ( LOK := !EMPTY(CVERBX1) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX','000020','000019','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX, NVALBX})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','S_MSGLOG()     .END.','000021','000021','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','!LOK   .END.','000022','000001','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CMSGLOG := FMSGFORM({19}) + "0332 - " + FDESC("RCN", "0332",','000023','000022','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0332 - " + FDESC("RCN", "0332", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','S_MSGLOG()     .END.','000024','000022','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','APERAB:= {}     .CNT.','000025','000001','.EXE.','5','APERAB:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','APERFECH:= {}     .CNT.','000026','000001','.EXE.','5','APERFECH:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','AVERBAS:= {}     .CNT.','000027','000001','.EXE.','5','AVERBAS:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','AVERBASB13:= {}     .CNT.','000028','000001','.EXE.','5','AVERBASB13:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CVERBX2 := FGETCODFOL("0274")     .CNT.','000029','000001','.EXE.','5','CVERBX2 := FGETCODFOL("0274")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX := 0     .CNT.','000030','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX := 0     .CNT.','000031','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000032','000001','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, SRA->RA_PROCES, NIL, @APERAB, @APERFECH)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','AADD(AVERBAS, {FGETCODFOL("0025")})     .CNT.','000033','000001','.EXE.','5','AADD(AVERBAS, {FGETCODFOL("0025")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','AVERBASB13 := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT','000034','000001','.EXE.','5','AVERBASB13 := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , AVERBAS,  APERAB, APERFECH )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','Len(aVerbasB13) > 0   .END.','000035','000001','.CON.','5','','','5','Len(aVerbasB13) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','nx := 1     .CNT.','000036','000035','.EXE.','5','nx := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','nx <= Len(aVerbasB13 )   .END.','000037','000035','.ENQ.','5','','','5','nx <= Len(aVerbasB13 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += aVerbasB13[ nx , 6]     .CNT.','000038','000037','.EXE.','5','NHORBX += aVerbasB13[ nx , 6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += aVerbasB13[ nx , 7]     .CNT.','000039','000037','.EXE.','5','NVALBX += aVerbasB13[ nx , 7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','nx += 1     .END.','000040','000037','.EXE.','5','nx += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX > 0 .AND. ( LOK :=  !EMPTY(CVERBX2) )   .END.','000041','000001','.CON.','5','','','5','NVALBX > 0 .AND. ( LOK :=  !EMPTY(CVERBX2) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX2, NHORBX','000042','000041','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX2, NHORBX, NVALBX})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','!LOK   .END.','000043','000001','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CMSGLOG := FMSGFORM({19}) + "0274 - " + FDESC("RCN", "0274",','000044','000043','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0274 - " + FDESC("RCN", "0274", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','S_MSGLOG()     .END.','000045','000043','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0005    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0005( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPROV14','REALIZA BAIXA PROVISAO 14 SALARIO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPROV14','c__Roteiro == "PRV"   .END.','000001','000000','.CON.','5','','','5','c__Roteiro == "PRV"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','APERAB:= {}     .CNT.','000002','000001','.EXE.','5','APERAB:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','lok := .t.     .CNT.','000003','000001','.EXE.','5','lok := .t.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','APERFECH:= {}     .CNT.','000004','000001','.EXE.','5','APERFECH:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','AVERBAS:= {}     .CNT.','000005','000001','.EXE.','5','AVERBAS:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','AVERBASB14:= {}     .CNT.','000006','000001','.EXE.','5','AVERBASB14:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','CVERBX1 := FGETCODFOL("0280")     .CNT.','000007','000001','.EXE.','5','CVERBX1 := FGETCODFOL("0280")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NHORBX := 0     .CNT.','000008','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NVALBX := 0     .CNT.','000009','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000010','000001','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, SRA->RA_PROCES, NIL, @APERAB, @APERFECH)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','AADD(AVERBAS, {FGETCODFOL("1190")})     .CNT.','000011','000001','.EXE.','5','AADD(AVERBAS, {FGETCODFOL("1190")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','AVERBASB14 := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT','000012','000001','.EXE.','5','AVERBASB14 := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , AVERBAS,  APERAB, APERFECH )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','Len(aVerbasB14) > 0   .END.','000013','000001','.CON.','5','','','5','Len(aVerbasB14) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','nx := 1     .CNT.','000014','000013','.EXE.','5','nx := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','nx <= Len(aVerbasB14 )   .END.','000015','000013','.ENQ.','5','','','5','nx <= Len(aVerbasB14 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NHORBX += aVerbasB14[ nx , 6]     .CNT.','000016','000015','.EXE.','5','NHORBX += aVerbasB14[ nx , 6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NVALBX += aVerbasB14[ nx , 7]     .CNT.','000017','000015','.EXE.','5','NVALBX += aVerbasB14[ nx , 7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','nx += 1     .END.','000018','000015','.EXE.','5','nx += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NVALBX > 0 .AND. ( LOK := !EMPTY(CVERBX1) )   .END.','000019','000001','.CON.','5','','','5','NVALBX > 0 .AND. ( LOK := !EMPTY(CVERBX1) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX','000020','000019','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX, NVALBX})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','!LOK   .END.','000021','000001','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','CMSGLOG := FMSGFORM({19}) + "0280 - " + FDESC("RCN", "0280",','000022','000021','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0280 - " + FDESC("RCN", "0280", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','S_MSGLOG()     .END.','000023','000021','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','APERAB:= {}     .CNT.','000024','000001','.EXE.','5','APERAB:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','APERFECH:= {}     .CNT.','000025','000001','.EXE.','5','APERFECH:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','AVERBAS:= {}     .CNT.','000026','000001','.EXE.','5','AVERBAS:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','AVERBASB14:= {}     .CNT.','000027','000001','.EXE.','5','AVERBASB14:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','CVERBX2 := FGETCODFOL("0284")     .CNT.','000028','000001','.EXE.','5','CVERBX2 := FGETCODFOL("0284")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NHORBX := 0     .CNT.','000029','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NVALBX := 0     .CNT.','000030','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000031','000001','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, SRA->RA_PROCES, NIL, @APERAB, @APERFECH)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','AADD(AVERBAS, {FGETCODFOL("1205")})     .CNT.','000032','000001','.EXE.','5','AADD(AVERBAS, {FGETCODFOL("1205")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','AVERBASB14 := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT','000033','000001','.EXE.','5','AVERBASB14 := RETORNAVERBASFUNC( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , AVERBAS,  APERAB, APERFECH )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','Len(aVerbasB14) > 0   .END.','000034','000001','.CON.','5','','','5','Len(aVerbasB14) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','nx := 1     .CNT.','000035','000034','.EXE.','5','nx := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','nx <= Len(aVerbasB14 )   .END.','000036','000034','.ENQ.','5','','','5','nx <= Len(aVerbasB14 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NHORBX += aVerbasB14[ nx , 6]     .CNT.','000037','000036','.EXE.','5','NHORBX += aVerbasB14[ nx , 6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NVALBX += aVerbasB14[ nx , 7]     .CNT.','000038','000036','.EXE.','5','NVALBX += aVerbasB14[ nx , 7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','nx += 1     .END.','000039','000036','.EXE.','5','nx += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','NVALBX > 0 .AND. ( LOK :=  !EMPTY(CVERBX2) )   .END.','000040','000001','.CON.','5','','','5','NVALBX > 0 .AND. ( LOK :=  !EMPTY(CVERBX2) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX2, NHORBX','000041','000040','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX2, NHORBX, NVALBX})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','!LOK   .END.','000042','000001','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','CMSGLOG := FMSGFORM({19}) + "0284 - " + FDESC("RCN", "0284",','000043','000042','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0284 - " + FDESC("RCN", "0284", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV14','S_MSGLOG()     .END.','000044','000042','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0006    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0006( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALANTFE','CALCULO DE ANTECIPACAO DE FERIAS','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALANTFE','CVERBA := FGETCODFOL("1099")     .CNT.','000001','000000','.EXE.','5','CVERBA := FGETCODFOL("1099")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','LOK := !EMPTY(CVERBA)   .END.','000002','000000','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NDIASANT := GETMEMVAR("RH_DIASANT")     .CNT.','000003','000002','.EXE.','5','NDIASANT := GETMEMVAR("RH_DIASANT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','CPERANT := GETMEMVAR("RH_PERANTE")     .CNT.','000004','000002','.EXE.','5','CPERANT := GETMEMVAR("RH_PERANTE")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NDIASANT > 0   .END.','000005','000002','.CON.','5','','','5','NDIASANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NDIASCALC := IIF( P_DIASMES == '+"'"+'S'+"'"+' , F_ULTDIA( GETMEMVAR('+"'"+'RH','000006','000005','.EXE.','5','NDIASCALC := IIF( P_DIASMES == '+"'"+'S'+"'"+' , F_ULTDIA( GETMEMVAR('+"'"+'RH_DATABAS'+"'"+') ) , 30 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NVALANTECIP := ( SALMES / NDIASCALC ) * NDIASANT     .CNT.','000007','000005','.EXE.','5','NVALANTECIP := ( SALMES / NDIASCALC ) * NDIASANT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NVALFERANT  := NVALANTECIP     .CNT.','000008','000005','.EXE.','5','NVALFERANT  := NVALANTECIP','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','NVALFERANT > 0   .END.','000009','000005','.CON.','5','','','5','NVALFERANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR },{ CVERBA, N','000010','000009','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR },{ CVERBA, NDIASANT , NVALFERANT })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','!LOK   .END.','000011','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','CMSGLOG := FMSGFORM({19}) + "1099 - " + FDESC("RCN", "1099",','000012','000011','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "1099 - " + FDESC("RCN", "1099", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTFE','S_MSGLOG()     .END.','000013','000011','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0007    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0007( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALANTIG','CALCULA ANTIGUIDADE DO FUNCIONARIO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CALANTIG','aMAT := fRetMat(SRA->RA_FILIAL+SRA->RA_MAT)     .CNT.','000001','000000','.EXE.','5','aMAT := fRetMat(SRA->RA_FILIAL+SRA->RA_MAT)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALANTIG','ANTIGUIDADE := fCalAntig(aMat,3,dDataDem)     .END.','000002','000000','.EXE.','5','ANTIGUIDADE := fCalAntig(aMat,3,dDataDem)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0008    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0008( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALC13SA','CALCULA O VALOR DO 13O. SALARIO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','CALC13SA','SRA->RA_SITFOLH <> "D"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH <> "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC13SA','nVal13Sal := TOTACU13 / 12     .CNT.','000002','000001','.EXE.','5','nVal13Sal := TOTACU13 / 12','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC13SA','nVal13Sal > 0   .END.','000003','000001','.CON.','5','','','5','nVal13Sal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC13SA','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR} , { FGETCOD','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR} , { FGETCODFOL("0024") , DIAACU13 , nVal13Sal} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC13SA','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0896")','000005','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0896") , TOTACU13} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0009    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0009( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCABFA','CALCULA ABONO FAMILIAR','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCABFA','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','VAL(SRA->RA_DEPSF) > 0   .END.','000002','000000','.CON.','5','','','5','VAL(SRA->RA_DEPSF) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','( FTABELA("S008", 01, 04) = NIL )   .END.','000003','000002','.CON.','5','','','5','( FTABELA("S008", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000004','000003','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','CMSGLOG := FMSGFORM({40}) + "S005 - " + FDESC("RCB", "S005",','000005','000003','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S005 - " + FDESC("RCB", "S005", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','S_MSGLOG()     .CNT.','000006','000003','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','FINALFUN()     .END.','000007','000003','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','nValor := fTabela( "S005", 01, 04, )     .CNT.','000008','000002','.EXE.','5','nValor := fTabela( "S005", 01, 04, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','nValor *= VAL(SRA->RA_DEPSF)     .END.','000009','000002','.EXE.','5','nValor *= VAL(SRA->RA_DEPSF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCABFA','ABONOFAM := nValor     .END.','000010','000000','.EXE.','5','ABONOFAM := nValor','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0010    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0010( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCADI','CALCULO DO ADIANTAMENTO DE SALARIO','','','031','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCADI','INFORMADO := .F.     .CNT.','000001','000000','.EXE.','5','INFORMADO := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','NXULTDIA := IF(P_DIASMES = "S", F_ULTDIA(DDATAREF) , 30)','000002','000000','.EXE.','5','NXULTDIA := IF(P_DIASMES = "S", F_ULTDIA(DDATAREF) , 30)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','LOK := FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0006")})','000003','000000','.EXE.','5','LOK := FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0006")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','LOK .AND. FO_GETVAL(@&COBJETO,CCPOTIPO2)=="I"   .END.','000004','000000','.CON.','5','','','5','LOK .AND. FO_GETVAL(@&COBJETO,CCPOTIPO2)=="I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := ROUND(FO_GETVAL(@&COBJETO,CCPOVALOR),2)     .CNT','000005','000004','.EXE.','5','VAL_ADTO := ROUND(FO_GETVAL(@&COBJETO,CCPOVALOR),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','INFORMADO := .T.     .END.','000006','000004','.EXE.','5','INFORMADO := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','!LOK   .END.','000007','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := SALMES * ( SRA->RA_PERCADT / 100 )     .CNT.','000008','000007','.EXE.','5','VAL_ADTO := SALMES * ( SRA->RA_PERCADT / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','P_ADTOPRO == "S"   .END.','000009','000007','.CON.','5','','','5','P_ADTOPRO == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','LIF := (DIASTRAB < P_DIASTBAD)   .END.','000010','000009','.CON.','5','','','5','LIF := (DIASTRAB < P_DIASTBAD)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := 0.00     .CNT.','000011','000010','.EXE.','5','VAL_ADTO := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','CMSGLOG := FMSGFORM({1}) + SPACE(1) + SRA->RA_MAT + " - " +','000012','000010','.EXE.','5','CMSGLOG := FMSGFORM({1}) + SPACE(1) + SRA->RA_MAT + " - " + FMSGFORM({38})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','S_MSGLOG()     .END.','000013','000010','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','!LIF   .END.','000014','000009','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','LADM := ( SRA->RA_ADMISSA > DDATADE )   .END.','000015','000014','.CON.','5','','','5','LADM := ( SRA->RA_ADMISSA > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := ( VAL_ADTO * ( NXULTDIA  -  DAY(SRA->RA_ADMISSA)','000016','000015','.EXE.','5','VAL_ADTO := ( VAL_ADTO * ( NXULTDIA  -  DAY(SRA->RA_ADMISSA) + 1)) / NXULTDIA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','!LADM   .END.','000017','000014','.CON.','5','','','5','!LADM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := ( VAL_ADTO * DIASTRAB ) / NXULTDIA     .END.','000018','000017','.EXE.','5','VAL_ADTO := ( VAL_ADTO * DIASTRAB ) / NXULTDIA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := NOROUND( VAL_ADTO,2 )     .END.','000019','000007','.EXE.','5','VAL_ADTO := NOROUND( VAL_ADTO,2 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0011    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0011( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCAJC','CALCULA AJUDA DE CUSTO (NAC / ESTRANG)','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCAJC','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','!EMPTY(SRA->RA_AJUCUS)   .END.','000002','000000','.CON.','5','','','5','!EMPTY(SRA->RA_AJUCUS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','LOK := ( SRA->RA_NACIONA == "204" )   .END.','000003','000002','.CON.','5','','','5','LOK := ( SRA->RA_NACIONA == "204" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','( FTABELA("S008", 01, 04) = NIL )   .END.','000004','000003','.CON.','5','','','5','( FTABELA("S008", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000005','000004','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','CMSGLOG := FMSGFORM({40}) + "S008 - " + FDESC("RCB", "S008",','000006','000004','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S008 - " + FDESC("RCB", "S008", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','S_MSGLOG()     .CNT.','000007','000004','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','FINALFUN()     .END.','000008','000004','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','nValor := fPosTab( "S008", SRA->RA_AJUCUS, "=", 04, , , , 05','000009','000003','.EXE.','5','nValor := fPosTab( "S008", SRA->RA_AJUCUS, "=", 04, , , , 05, )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','!LOK   .END.','000010','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','( FTABELA("S009", 01, 04) = NIL )   .END.','000011','000010','.CON.','5','','','5','( FTABELA("S009", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000012','000011','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','CMSGLOG := FMSGFORM({40}) + "S009 - " + FDESC("RCB", "S009",','000013','000011','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S009 - " + FDESC("RCB", "S009", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','S_MSGLOG()     .CNT.','000014','000011','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','FINALFUN()     .END.','000015','000011','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','nValor := fPosTab( "S009", SRA->RA_AJUCUS, "=", 04, , , , 05','000016','000010','.EXE.','5','nValor := fPosTab( "S009", SRA->RA_AJUCUS, "=", 04, , , , 05, )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJC','AJCUSTO := nValor     .END.','000017','000000','.EXE.','5','AJCUSTO := nValor','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0012    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0012( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCAJCF','CALCULA AJUDA DE CUSTO FORMACAO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCAJCF','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','!EMPTY(SRA->RA_AJUFOR)   .END.','000002','000000','.CON.','5','','','5','!EMPTY(SRA->RA_AJUFOR)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','( FTABELA("S010", 01, 04) = NIL )   .END.','000003','000002','.CON.','5','','','5','( FTABELA("S010", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000004','000003','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','CMSGLOG := FMSGFORM({40}) + "S010 - " + FDESC("RCB", "S010",','000005','000003','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S010 - " + FDESC("RCB", "S010", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','S_MSGLOG()     .CNT.','000006','000003','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','FINALFUN()     .END.','000007','000003','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','nValor := fPosTab( "S010", SRA->RA_AJUFOR, "=", 04, , , , 05','000008','000002','.EXE.','5','nValor := fPosTab( "S010", SRA->RA_AJUFOR, "=", 04, , , , 05, )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAJCF','AJCUSTOFORM := nValor     .END.','000009','000000','.EXE.','5','AJCUSTOFORM := nValor','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0013    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0013( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCAVPR','CALCULA AVISO PREVIO','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCAVPR','nDiasAvPag := 0     .CNT.','000001','000000','.EXE.','5','nDiasAvPag := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nDiasAvDes := 0     .CNT.','000002','000000','.EXE.','5','nDiasAvDes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nVPgAvPrev := 0     .CNT.','000003','000000','.EXE.','5','nVPgAvPrev := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nVDsAvPrev := 0     .CNT.','000004','000000','.EXE.','5','nVDsAvPrev := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','cVrbAvInd := FGETCODFOL("0111")     .CNT.','000005','000000','.EXE.','5','cVrbAvInd := FGETCODFOL("0111")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','cVrbAvTrb := FGETCODFOL("0112")     .CNT.','000006','000000','.EXE.','5','cVrbAvTrb := FGETCODFOL("0112")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','cVrbAvDes := FGETCODFOL("0113")     .CNT.','000007','000000','.EXE.','5','cVrbAvDes := FGETCODFOL("0113")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','EMPTY(cVrbAvTrb) .And. !EMPTY(DDATAAV) .And. (DDATAAV < DD','000008','000000','.CON.','5','','','5','EMPTY(cVrbAvTrb) .And. !EMPTY(DDATAAV) .And. (DDATAAV < DDATADEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','CMSGLOG := FMSGFORM({19}) + "0112 - " + FDESC("RCN", "0112",','000009','000008','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0112 - " + FDESC("RCN", "0112", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','S_MSGLOG()     .CNT.','000010','000008','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','FINALFUN()     .END.','000011','000008','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','FTABELA("S018",01,04) = NIL   .END.','000012','000000','.CON.','5','','','5','FTABELA("S018",01,04) = NIL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','CMSGLOG := FMSGFORM({40}) + "S018 - " + FDESC("RCB", "S018",','000013','000012','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S018 - " + FDESC("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','S_MSGLOG()     .CNT.','000014','000012','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','FINALFUN()     .END.','000015','000012','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000016','000000','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','NPOS > 0   .END.','000017','000000','.CON.','5','','','5','NPOS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','S_CALANTIG()     .CNT.','000018','000017','.EXE.','5','S_CALANTIG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','LOK := ( FTABELA("S015",NPOS,10) == "P" )   .END.','000019','000017','.CON.','5','','','5','LOK := ( FTABELA("S015",NPOS,10) == "P" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nDiasAvPag := FPOSTAB( "S018", "P", "=", 04, ANTIGUIDADE, "<','000020','000019','.EXE.','5','nDiasAvPag := FPOSTAB( "S018", "P", "=", 04, ANTIGUIDADE, "<=", 05, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','!EMPTY(nDiasAvPag)   .END.','000021','000019','.CON.','5','','','5','!EMPTY(nDiasAvPag)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nVPgAvPrev := ROUND( (SALMES / 30) * nDiasAvPag, MSDECIMAIS(','000022','000021','.EXE.','5','nVPgAvPrev := ROUND( (SALMES / 30) * nDiasAvPag, MSDECIMAIS(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','!LOK .And. ( FTABELA("S015",NPOS,10) == "D" )   .END.','000023','000017','.CON.','5','','','5','!LOK .And. ( FTABELA("S015",NPOS,10) == "D" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nDiasAvDes := FPOSTAB( "S018", "D", "=", 04, ANTIGUIDADE, "<','000024','000023','.EXE.','5','nDiasAvDes := FPOSTAB( "S018", "D", "=", 04, ANTIGUIDADE, "<=", 05, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','!EMPTY(nDiasAvDes)   .END.','000025','000023','.CON.','5','','','5','!EMPTY(nDiasAvDes)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAVPR','nVDsAvPrev := ROUND( (SALMES / 30) * nDiasAvDes, MSDECIMAIS(','000026','000025','.EXE.','5','nVDsAvPrev := ROUND( (SALMES / 30) * nDiasAvDes, MSDECIMAIS(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0014    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0014( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCCOMP','CALCULA COMPENSACAO NA RESCISAO','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCCOMP','nVLRCOMPEN := 0     .CNT.','000001','000000','.EXE.','5','nVLRCOMPEN := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NDIFANTIG := 0     .CNT.','000002','000000','.EXE.','5','NDIFANTIG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NAUXILIAR := 0     .CNT.','000003','000000','.EXE.','5','NAUXILIAR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nBkpAnos := 0     .CNT.','000004','000000','.EXE.','5','nBkpAnos := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000005','000000','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NPOS > 0 .And.  ( FTABELA("S015",NPOS,12) == "S" )   .END.','000006','000000','.CON.','5','','','5','NPOS > 0 .And.  ( FTABELA("S015",NPOS,12) == "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','S_CALANTIG()     .CNT.','000007','000006','.EXE.','5','S_CALANTIG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','ANTIGUIDADE > 0   .END.','000008','000006','.CON.','5','','','5','ANTIGUIDADE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','FTABELA("S019", 01, 04) = NIL   .END.','000009','000008','.CON.','5','','','5','FTABELA("S019", 01, 04) = NIL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000010','000009','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','CMSGLOG := FMSGFORM({40}) + "S019 - " + FDESC("RCB", "S019",','000011','000009','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S019 - " + FDESC("RCB", "S019", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','S_MSGLOG()     .CNT.','000012','000009','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','FINALFUN()     .END.','000013','000009','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','ATAB := {}     .CNT.','000014','000008','.EXE.','5','ATAB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','fRetTab( @aTab, "S019", , , dDataRef, , .T.)     .CNT.','000015','000008','.EXE.','5','fRetTab( @aTab, "S019", , , dDataRef, , .T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nCont := 1     .CNT.','000016','000008','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','LEN(ATAB) > 0   .END.','000017','000008','.CON.','5','','','5','LEN(ATAB) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nCont <= LEN(ATAB)   .END.','000018','000017','.ENQ.','5','','','5','nCont <= LEN(ATAB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nPerc := ATAB[nCont, 06]     .CNT.','000019','000018','.EXE.','5','nPerc := ATAB[nCont, 06]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nAnos := ATAB[nCont, 05]     .CNT.','000020','000018','.EXE.','5','nAnos := ATAB[nCont, 05]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','LOK1 := ( nCont > 1 )   .END.','000021','000018','.CON.','5','','','5','LOK1 := ( nCont > 1 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nBkpAnos := ATAB[(nCont-1), 05]     .END.','000022','000021','.EXE.','5','nBkpAnos := ATAB[(nCont-1), 05]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','LOK := ( ANTIGUIDADE > nAnos )   .END.','000023','000018','.CON.','5','','','5','LOK := ( ANTIGUIDADE > nAnos )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NDIFANTIG := ( nAnos - nBkpAnos )     .END.','000024','000023','.EXE.','5','NDIFANTIG := ( nAnos - nBkpAnos )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','!LOK   .END.','000025','000018','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NDIFANTIG := ( ANTIGUIDADE - nBkpAnos )     .CNT.','000026','000025','.EXE.','5','NDIFANTIG := ( ANTIGUIDADE - nBkpAnos )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nCont += 99     .END.','000027','000025','.EXE.','5','nCont += 99','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','NAUXILIAR := ( SALMES * NDIFANTIG * nPerc / 100 )     .CNT.','000028','000018','.EXE.','5','NAUXILIAR := ( SALMES * NDIFANTIG * nPerc / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nVLRCOMPEN += NAUXILIAR     .CNT.','000029','000018','.EXE.','5','nVLRCOMPEN += NAUXILIAR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nCont += 1     .END.','000030','000018','.EXE.','5','nCont += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','nVLRCOMPEN := ROUND( nVLRCOMPEN, MSDECIMAIS(1))     .END.','000031','000017','.EXE.','5','nVLRCOMPEN := ROUND( nVLRCOMPEN, MSDECIMAIS(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0015    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0015( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCD14','CALCULO DECIMA CUARTA REMUNERACION','','','025','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCD14','LOK := ( FTABELA("S006", 01, 04) = NIL )   .END.','000001','000000','.CON.','5','','','5','LOK := ( FTABELA("S006", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','CMSGLOG := FMSGFORM({40}) + "S006 - " + FDESC("RCB", "S006",','000002','000001','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S006 - " + FDESC("RCB", "S006", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','S_MSGLOG()     .CNT.','000003','000001','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','FINALCALC()     .END.','000004','000001','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','!LOK   .END.','000005','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','SRA->RA_SITFOLH <> "D"   .END.','000006','000005','.CON.','5','','','5','SRA->RA_SITFOLH <> "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','NVALPRO := FTABELA("S006",1,4)     .CNT.','000007','000006','.EXE.','5','NVALPRO := FTABELA("S006",1,4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','NDIAS := 0.00     .CNT.','000008','000006','.EXE.','5','NDIAS := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ndiaadm := 0     .CNT.','000009','000006','.EXE.','5','ndiaadm := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','AAFAST := {}     .CNT.','000010','000006','.EXE.','5','AAFAST := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','DDATAFIM := DDATAREF - 1     .CNT.','000011','000006','.EXE.','5','DDATAFIM := DDATAREF - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','DDATAINI := MonthSub( DDATAFIM , 12 ) + 1     .CNT.','000012','000006','.EXE.','5','DDATAINI := MonthSub( DDATAFIM , 12 ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','DDATAINI := MAX(DDATAINI,SRA->RA_ADMISSA)     .CNT.','000013','000006','.EXE.','5','DDATAINI := MAX(DDATAINI,SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','NDIAS :=  (DDATAFIM - DDATAINI) + 1     .CNT.','000014','000006','.EXE.','5','NDIAS :=  (DDATAFIM - DDATAINI) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ndias >= 360   .END.','000015','000006','.CON.','5','','','5','ndias >= 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ndias := 360     .END.','000016','000015','.EXE.','5','ndias := 360','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ndias < 360   .END.','000017','000006','.CON.','5','','','5','ndias < 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ndias := 0     .CNT.','000018','000017','.EXE.','5','ndias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','Alterado devido calculo executado pelo Sistema de Salarios e','000019','000017','.MSG.','5','Alterado devido calculo executado pelo Sistema de Salarios em Linea onde o governo informa que deve ser calculado lenvando em consideração 30 dias mes comercial.','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ddataini == sra->ra_admissa   .END.','000020','000017','.CON.','5','','','5','ddataini == sra->ra_admissa','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ndiasad :=  (30 - Day(sra->Ra_admissa) ) + 1     .END.','000021','000020','.EXE.','5','ndiasad :=  (30 - Day(sra->Ra_admissa) ) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','nfrac := F_ultdia(ddataini)-day(ddataini)     .CNT.','000022','000017','.EXE.','5','nfrac := F_ultdia(ddataini)-day(ddataini)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ddata := ddataini + nfrac     .CNT.','000023','000017','.EXE.','5','ddata := ddataini + nfrac','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','Mesano(ddata) <= Mesano(ddatafim)   .END.','000024','000017','.ENQ.','5','','','5','Mesano(ddata) <= Mesano(ddatafim)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ddata := ddata + 28     .CNT.','000025','000024','.EXE.','5','ddata := ddata + 28','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','mesano(ddata) <= mesano(ddatafim)   .END.','000026','000024','.CON.','5','','','5','mesano(ddata) <= mesano(ddatafim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','Ndias := ndias + 30     .END.','000027','000026','.EXE.','5','Ndias := ndias + 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','ndias := ndias + ndiasad     .END.','000028','000017','.EXE.','5','ndias := ndias + ndiasad','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','FBUSCAAFAST(DDATAINI,DDATAFIM,@AAFAST)     .CNT.','000029','000006','.EXE.','5','FBUSCAAFAST(DDATAINI,DDATAFIM,@AAFAST)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','!EMPTY(AAFAST)   .END.','000030','000006','.CON.','5','','','5','!EMPTY(AAFAST)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','AEVAL(AAFAST, {|X| IF(X[14] = "1", NDIAS -= X[11], 0)})','000031','000030','.EXE.','5','AEVAL(AAFAST, {|X| IF(X[14] = "1", NDIAS -= X[11], 0)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','NVALD14 := Round((NVALPRO / 360) * NDIAS,2)     .CNT.','000032','000006','.EXE.','5','NVALD14 := Round((NVALPRO / 360) * NDIAS,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCD14','NVALD14 > 0.00   .END.','000033','000006','.CON.','5','','','5','NVALD14 > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCD14','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR','000034','000033','.EXE.','5','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR} , {FGETCODFOL("1190"), "V" , NDIAS, NVALD14  })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0016    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0016( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCDSR','Calculo DSR','','000261','051','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh := SRA->RA_SITFOLH     .CNT.','000001','000000','.EXE.','5','cSitFolh := SRA->RA_SITFOLH','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh = " " .END.','000002','000000','.CON.','5','','','5','cSitFolh','=','5','" "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT = "M" .END.','000003','000002','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "M*C*A*P*E*1*2*3*4" .END.','000004','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*A*P*E*1*2*3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Salmes     .CNT.','000005','000004','.EXE.','5','nSalPg     := Salmes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','MESANO(sra->ra_admissa) = cAnoMes .Or. DiasTrab < 30   .EN','000006','000004','.CON.','5','','','5','MESANO(sra->ra_admissa) = cAnoMes .Or. DiasTrab < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg := Round(SalMes / 30 * DiasTrab,2)     .END.','000007','000006','.EXE.','5','nSalPg := Round(SalMes / 30 * DiasTrab,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "H*G" .END.','000008','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))     .','000009','000008','.EXE.','5','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))     .END.','000010','000008','.EXE.','5','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "D" .END.','000011','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := SalDia * Diastrab     .END.','000012','000011','.EXE.','5','nSalPg     := SalDia * Diastrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT = "S" .END.','000013','000002','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','Type("NTOTDIAS") = "U" .END.','000014','000013','.CON.','5','','','5','Type("NTOTDIAS")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nTotDias := 7     .END.','000015','000014','.EXE.','5','nTotDias := 7','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','000016','000013','.EXE.','5','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','DiasDsr > 0 .END.','000017','000013','.CON.','5','','','5','DiasDsr','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nTotdias  := DiasTrab + DiasDsr     .CNT.','000018','000017','.EXE.','5','nTotdias  := DiasTrab + DiasDsr','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotD','000019','000017','.EXE.','5','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotDias-DiasTrab) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nHorasDsr  := nTotDias - DiasTrab     .END.','000020','000017','.EXE.','5','nHorasDsr  := nTotDias - DiasTrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh <> " " .AND. cSitFolh # "D"   .AND.','000021','000000','.CON.','5','','','5','cSitFolh <> " " .AND. cSitFolh # "D"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*1*2*3*4" .END.','000022','000000','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*D*S*A*P*E*1*2*3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))     .EN','000023','000022','.EXE.','5','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','(cSitFolh <> " ") .AND. (cSitFolh # "D") .AND. ! (SRA->RA_','000024','000000','.CON.','5','','','5','(cSitFolh <> " ") .AND. (cSitFolh # "D") .AND. ! (SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*1*2*3*4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','000025','000024','.EXE.','5','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))     .','000026','000024','.EXE.','5','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh = "A" .AND.','000027','000000','.CON.','5','','','5','cSitFolh','=','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT == "S" .END.','000028','000000','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))     .CNT','000029','000028','.EXE.','5','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nHorasDsr  := DiasDsr     .END.','000030','000028','.EXE.','5','nHorasDsr  := DiasDsr','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0017    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0017( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCFOND','CALCULA FONDO DE RESERVA','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCFOND','nBaseFondo:= 0     .CNT.','000001','000000','.EXE.','5','nBaseFondo:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nValFondo:= 0     .CNT.','000002','000000','.EXE.','5','nValFondo:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nBsFondFer:= 0     .CNT.','000003','000000','.EXE.','5','nBsFondFer:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nVlFonFer:= 0     .CNT.','000004','000000','.EXE.','5','nVlFonFer:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','aDiffDays:= {}     .CNT.','000005','000000','.EXE.','5','aDiffDays:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','lOK:= (fTabela("S024", 01, 04) = Nil)   .END.','000006','000000','.CON.','5','','','5','lOK:= (fTabela("S024", 01, 04) = Nil)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','cMsgLog := fMsgForm({40}) + "S024 - " + fDesc("RCB", "S024",','000007','000006','.EXE.','5','cMsgLog := fMsgForm({40}) + "S024 - " + fDesc("RCB", "S024", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','S_MSGLOG()     .CNT.','000008','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','FINALFUN()     .END.','000009','000006','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','!lOK   .END.','000010','000000','.CON.','5','','','5','!lOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','dDtFim:= Iif( cTipoRot == "4", dDataDem, dDataAte)     .CNT.','000011','000010','.EXE.','5','dDtFim:= Iif( cTipoRot == "4", dDataDem, dDataAte)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','aDiffDays := DateDiffYMD( SRA->RA_ADMISSA, dDtFim )     .CNT','000012','000010','.EXE.','5','aDiffDays := DateDiffYMD( SRA->RA_ADMISSA, dDtFim )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','aDiffDays[1] > 0   .END.','000013','000010','.CON.','5','','','5','aDiffDays[1] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','P_BSSEPVAC == "N"   .END.','000014','000013','.CON.','5','','','5','P_BSSEPVAC == "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nBaseFondo:= fo_SomaIncSrv(@&cObjeto, cCpoValor, "RV_FGTS",','000015','000014','.EXE.','5','nBaseFondo:= fo_SomaIncSrv(@&cObjeto, cCpoValor, "RV_FGTS", "1" )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','P_BSSEPVAC == "S"   .END.','000016','000013','.CON.','5','','','5','P_BSSEPVAC == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nBaseFondo:= fo_SomaIncSRV(@&cObjeto, cCpoValor, {"RV_FGTS",','000017','000016','.EXE.','5','nBaseFondo:= fo_SomaIncSRV(@&cObjeto, cCpoValor, {"RV_FGTS", "RV_REFFER"}, {"1", "2* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nBsFondFer := fo_SomaIncSRV(@&cObjeto, cCpoValor, {"RV_INSS"','000018','000016','.EXE.','5','nBsFondFer := fo_SomaIncSRV(@&cObjeto, cCpoValor, {"RV_INSS", "RV_REFFER"}, {"1", "1"} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','NPERFONDO := fTabela("S024", 01, 04)     .CNT.','000019','000013','.EXE.','5','NPERFONDO := fTabela("S024", 01, 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nBaseFondo > 0   .END.','000020','000013','.CON.','5','','','5','nBaseFondo > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nValFondo:= nBaseFondo * NPERFONDO / 100     .END.','000021','000020','.EXE.','5','nValFondo:= nBaseFondo * NPERFONDO / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nBsFondFer > 0   .END.','000022','000013','.CON.','5','','','5','nBsFondFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCFOND','nVlFonFer := nBsFondFer * NPERFONDO / 100     .END.','000023','000022','.EXE.','5','nVlFonFer := nBsFondFer * NPERFONDO / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0018    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0018( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCGUAR','CALCULO GUARDERIA','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCGUAR','NNUMHIJO := 0     .CNT.','000001','000000','.EXE.','5','NNUMHIJO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NVALGUA := 0.00     .CNT.','000002','000000','.EXE.','5','NVALGUA := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NVALOR := 0     .CNT.','000003','000000','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','CVERGUA := FGETCODFOL("0528")     .CNT.','000004','000000','.EXE.','5','CVERGUA := FGETCODFOL("0528")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NIDADE := 0     .CNT.','000005','000000','.EXE.','5','NIDADE := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','Lok:= !empty(cvergua)     .CNT.','000006','000000','.EXE.','5','Lok:= !empty(cvergua)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','!LOK   .END.','000007','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','CMSGLOG := FMSGFORM({19}) + "0528 - " + FDESC("RCN", "0528",','000008','000007','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0528 - " + FDESC("RCN", "0528", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','S_MSGLOG()     .END.','000009','000007','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','EMPTY(OSRB:ACOLS)   .END.','000010','000000','.CON.','5','','','5','EMPTY(OSRB:ACOLS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','FIMFORMULA()     .END.','000011','000010','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','LSAI := (FTABELA("S009", 01, 04) = NIL)   .END.','000012','000000','.CON.','5','','','5','LSAI := (FTABELA("S009", 01, 04) = NIL)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','CMSGLOG := FMSGFORM({40}) + " S009 - " + FDESC("RCB", "S009"','000013','000012','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S009 - " + FDESC("RCB", "S009", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','S_MSGLOG()     .CNT.','000014','000012','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','FINALCALC()     .END.','000015','000012','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','!LSAI .AND. LOK   .END.','000016','000000','.CON.','5','','','5','!LSAI .AND. LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','FO_GOTOP(@OSRB)     .CNT.','000017','000016','.EXE.','5','FO_GOTOP(@OSRB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','!FO_EOF(@OSRB)   .END.','000018','000016','.ENQ.','5','','','5','!FO_EOF(@OSRB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','FO_GETVAL(@OSRB, "RB_TIPSF") =="1"   .END.','000019','000018','.CON.','5','','','5','FO_GETVAL(@OSRB, "RB_TIPSF") =="1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NIDADE := CALC_IDADE(DDATA_PGTO, FO_GETVAL(@OSRB, "RB_DTNASC','000020','000019','.EXE.','5','NIDADE := CALC_IDADE(DDATA_PGTO, FO_GETVAL(@OSRB, "RB_DTNASC") )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NAUX := 0     .CNT.','000021','000019','.EXE.','5','NAUX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NIDADE >= 0   .END.','000022','000019','.CON.','5','','','5','NIDADE >= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NAUX := FPOSTAB("S009", NIDADE, "<=" , 04 )     .CNT.','000023','000022','.EXE.','5','NAUX := FPOSTAB("S009", NIDADE, "<=" , 04 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NAUX > 0   .END.','000024','000022','.CON.','5','','','5','NAUX > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NVALGUA:= FTABELA("S009", NAUX, 05 )     .CNT.','000025','000024','.EXE.','5','NVALGUA:= FTABELA("S009", NAUX, 05 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NNUMHIJO += 1     .END.','000026','000024','.EXE.','5','NNUMHIJO += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NVALGUA > 0   .END.','000027','000022','.CON.','5','','','5','NVALGUA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NVALOR += NVALGUA     .END.','000028','000027','.EXE.','5','NVALOR += NVALGUA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NVALGUA := 0     .CNT.','000029','000018','.EXE.','5','NVALGUA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','FO_SKIP(@OSRB)     .END.','000030','000018','.EXE.','5','FO_SKIP(@OSRB)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','NVALOR > 0   .END.','000031','000016','.CON.','5','','','5','NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCGUAR','FO_ADD(@&cObjeto,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERGUA, NN','000032','000031','.EXE.','5','FO_ADD(@&cObjeto,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERGUA, NNUMHIJO, NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0019    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0019( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIECE','CALCULO DEL IECE','','','011','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIECE','NBIECENO := 0     .CNT.','000001','000000','.EXE.','5','NBIECENO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','NVIECENO := 0     .CNT.','000002','000000','.EXE.','5','NVIECENO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','NBIECEFE:= 0     .CNT.','000003','000000','.EXE.','5','NBIECEFE:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','NVIECEFE := 0     .CNT.','000004','000000','.EXE.','5','NVIECEFE := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','NPERIECE  := 0     .CNT.','000005','000000','.EXE.','5','NPERIECE  := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','LOK := ( fTabela("S012", 01, 04) = NIL )   .END.','000006','000000','.CON.','5','','','5','LOK := ( fTabela("S012", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','CMSGLOG := FMSGFORM({40}) + "S012 - " + FDESC("RCB", "S012",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S012 - " + FDESC("RCB", "S012", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','S_MSGLOG()     .CNT.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','FINALCALC()     .END.','000010','000006','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','!LOK   .END.','000011','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','NPERIECE := fTabela("S012", 01, 04 )     .CNT.','000012','000011','.EXE.','5','NPERIECE := fTabela("S012", 01, 04 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','P_BSSEPVAC == "S"   .END.','000013','000011','.CON.','5','','','5','P_BSSEPVAC == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','nBIECENO := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IECE","','000014','000013','.EXE.','5','nBIECENO := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IECE","RV_REFFER"}, {"1","2* "}  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','nBIECEFE := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IECE",','000015','000013','.EXE.','5','nBIECEFE := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IECE", "RV_REFFER"}, {"1", "1* "} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','P_BSSEPVAC == "N"   .END.','000016','000011','.CON.','5','','','5','P_BSSEPVAC == "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','nBIECENO := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IECE",','000017','000016','.EXE.','5','nBIECENO := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IECE"}, {"1"} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','nBIECENO > 0   .END.','000018','000011','.CON.','5','','','5','nBIECENO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','NVIECENO := Round((nBIECENO * nPERIECE ) / 100,2)     .END.','000019','000018','.EXE.','5','NVIECENO := Round((nBIECENO * nPERIECE ) / 100,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','nBIECEFE > 0   .END.','000020','000011','.CON.','5','','','5','nBIECEFE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIECE','nVIECEFE := Round((nBIECEFE * nPERIECE ) / 100,2)     .END.','000021','000020','.EXE.','5','nVIECEFE := Round((nBIECEFE * nPERIECE ) / 100,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0020    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0020( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIESS','CALCULO DEL IESS','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIESS','nPINSSFun := 0     .CNT.','000001','000000','.EXE.','5','nPINSSFun := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nPINSSEmp := 0     .CNT.','000002','000000','.EXE.','5','nPINSSEmp := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nBINSS := 0     .CNT.','000003','000000','.EXE.','5','nBINSS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nBINSSFer := 0     .CNT.','000004','000000','.EXE.','5','nBINSSFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nVFINSS := 0     .CNT.','000005','000000','.EXE.','5','nVFINSS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nVEINSS := 0     .CNT.','000006','000000','.EXE.','5','nVEINSS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nVEINSSFer := 0     .CNT.','000007','000000','.EXE.','5','nVEINSSFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','LOK := ( fTabela("S011", 01, 04) = NIL )   .END.','000008','000000','.CON.','5','','','5','LOK := ( fTabela("S011", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000009','000008','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','CMSGLOG := FMSGFORM({40}) + "S011 - " + FDESC("RCB", "S011",','000010','000008','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S011 - " + FDESC("RCB", "S011", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','S_MSGLOG()     .CNT.','000011','000008','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','FINALCALC()     .END.','000012','000008','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','!LOK   .END.','000013','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','NPINSSFUN := FTABELA("S011", 01, 05, )     .CNT.','000014','000013','.EXE.','5','nPINSSFun := fTabela("S011", 01, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nPINSSEmp := fTabela("S011", 01, 04, )     .CNT.','000015','000013','.EXE.','5','nPINSSEmp := fTabela("S011", 01, 04, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','P_BSSEPVAC =="N"   .END.','000016','000013','.CON.','5','','','5','P_BSSEPVAC =="N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nBINSS := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS"}, {','000017','000016','.EXE.','5','nBINSS := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS"}, {"1"} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','P_BSSEPVAC =="S"   .END.','000018','000013','.CON.','5','','','5','P_BSSEPVAC =="S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nBINSS := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS", "R','000019','000018','.EXE.','5','nBINSS := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS", "RV_REFFER"}, {"1", "2* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nBINSSFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS",','000020','000018','.EXE.','5','nBINSSFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS", "RV_REFFER"}, {"1", "1"} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nBINSS > 0   .END.','000021','000013','.CON.','5','','','5','nBINSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nVFINSS := Round((nBINSS * nPINSSFun ) / 100 , 2)     .CNT.','000022','000021','.EXE.','5','nVFINSS := Round((nBINSS * nPINSSFun ) / 100 , 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nVEINSS := Round((nBINSS * nPINSSEmp) / 100 , 2)     .END.','000023','000021','.EXE.','5','nVEINSS := Round((nBINSS * nPINSSEmp) / 100 , 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nBINSSFer > 0   .END.','000024','000013','.CON.','5','','','5','nBINSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nVFINSSFer := Round((nBINSSFer * nPINSSFun ) / 100 , 2)','000025','000024','.EXE.','5','nVFINSSFer := Round((nBINSSFer * nPINSSFun ) / 100 , 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIESS','nVEINSSFer := Round((nBINSSFer * nPINSSEmp ) / 100  , 2)','000026','000024','.EXE.','5','nVEINSSFer := Round((nBINSSFer * nPINSSEmp ) / 100  , 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0021    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0021( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIND','CALCULA INDENIZACAO NA RESCISAO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIND','nVLRINDEN := 0     .CNT.','000001','000000','.EXE.','5','nVLRINDEN := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIND','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000002','000000','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIND','NPOS > 0 .And.  ( FTABELA("S015",NPOS,11) == "S" )   .END.','000003','000000','.CON.','5','','','5','NPOS > 0 .And.  ( FTABELA("S015",NPOS,11) == "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIND','S_CALANTIG()     .CNT.','000004','000003','.EXE.','5','S_CALANTIG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIND','ANTIGUIDADE > 0   .END.','000005','000003','.CON.','5','','','5','ANTIGUIDADE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIND','nVLRINDEN := ROUND( SALMES * ANTIGUIDADE, MSDECIMAIS(1))','000006','000005','.EXE.','5','nVLRINDEN := ROUND( SALMES * ANTIGUIDADE, MSDECIMAIS(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0022    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0022( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIRT','CALCULO IMPOSTO DE RENDA','','','040','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIRT','cTipoRot $ "1*4"   .END.','000001','000000','.CON.','5','','','5','cTipoRot $ "1*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := 0     .CNT.','000002','000001','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NBSIRTOT := 0.00     .CNT.','000003','000001','.EXE.','5','NBSIRTOT := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NBSIMPONO := 0.00     .CNT.','000004','000001','.EXE.','5','NBSIMPONO := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nMesIR:= 1     .CNT.','000005','000001','.EXE.','5','nMesIR:= 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','cTipoRot <> "4"   .END.','000006','000001','.CON.','5','','','5','cTipoRot <> "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NMESIR := (12 - MONTH(DDATA_PGTO) ) + 1     .CNT.','000007','000006','.EXE.','5','NMESIR := (12 - MONTH(DDATA_PGTO) ) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nResult := 0     .CNT.','000008','000001','.EXE.','5','nResult := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NPERCDED := FTABELA("S010",1,4) / 100     .CNT.','000009','000001','.EXE.','5','NPERCDED := FTABELA("S010",1,4) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','cTabela := "S014"     .CNT.','000010','000001','.EXE.','5','cTabela := "S014"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRT := 0     .CNT.','000011','000001','.EXE.','5','nBIRT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRTFer := 0     .CNT.','000012','000001','.EXE.','5','nBIRTFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT := 0     .CNT.','000013','000001','.EXE.','5','nPerIRT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRTFer := 0     .CNT.','000014','000001','.EXE.','5','nPerIRTFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRT := 0     .CNT.','000015','000001','.EXE.','5','nVLRIRT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRTFer := 0     .CNT.','000016','000001','.EXE.','5','nVLRIRTFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','LOK := ( FTABELA("S014", 01, 04) = NIL )   .END.','000017','000001','.CON.','5','','','5','LOK := ( FTABELA("S014", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','Gera LOG dizendo que Tabela nao foi encontrada     .CNT.','000018','000017','.MSG.','5','Gera LOG dizendo que Tabela nao foi encontrada','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','CMSGLOG := FMSGFORM({40}) + "S014 - " + FDESC("RCB", "S014",','000019','000017','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S014 - " + FDESC("RCB", "S014", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','S_MSGLOG()     .CNT.','000020','000017','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','FINALCALC()     .END.','000021','000017','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','!LOK   .END.','000022','000001','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := 0     .CNT.','000023','000022','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','P_BSSEPVAC == "N"   .END.','000024','000022','.CON.','5','','','5','P_BSSEPVAC == "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NBIRT := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR"}, {"1"','000025','000024','.EXE.','5','NBIRT := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR"}, {"1"} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','P_BSSEPVAC == "S"   .END.','000026','000022','.CON.','5','','','5','P_BSSEPVAC == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NBIRT := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_R','000027','000026','.EXE.','5','NBIRT := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_REFFER"}, {"1", "2* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBIRTFer:= fo_SomaIncSRV(@&cObjeto, cCpoValor, {"RV_IR", "RV','000028','000026','.EXE.','5','nBIRTFer:= fo_SomaIncSRV(@&cObjeto, cCpoValor, {"RV_IR", "RV_REFFER"}, {"1", "1"} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NBIRT <= 0   .END.','000029','000022','.CON.','5','','','5','NBIRT <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','FIMFORMULA()     .END.','000030','000029','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBsIRTot := nBIRT + nBsIRF107 + nBsIRProj + nBsIRAnt + nBIRT','000031','000022','.EXE.','5','nBsIRTot := nBIRT + nBsIRF107 + nBsIRProj + nBsIRAnt + nBIRTFer','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nIESSTot := nVIESSF107 + nVIESSProj + nVIESSAnt + nVFINSS +','000032','000022','.EXE.','5','nIESSTot := nVIESSF107 + nVIESSProj + nVIESSAnt + nVFINSS + nVFINSSFer','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nGastosDe > 0.00   .END.','000033','000022','.CON.','5','','','5','nGastosDe > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nGastosDe > (nBsIRTot * NPERCDED)   .END.','000034','000033','.CON.','5','','','5','nGastosDe > (nBsIRTot * NPERCDED)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NGASTOSDE := ROUND((NBSIRTOT * NPERCDED) , 2)     .END.','000035','000034','.EXE.','5','NGASTOSDE := ROUND((NBSIRTOT * NPERCDED) , 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','!Empty(nBsDesgr) .and. nGastosDe > nBsDesgr   .END.','000036','000033','.CON.','5','','','5','!Empty(nBsDesgr) .and. nGastosDe > nBsDesgr','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nGastosDe :=  nBsDesgr     .END.','000037','000036','.EXE.','5','nGastosDe :=  nBsDesgr','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBsImpoNo := nBsIRTot - nIESSTot - nGastosDe  - nBsTerida -','000038','000022','.EXE.','5','nBsImpoNo := nBsIRTot - nIESSTot - nGastosDe  - nBsTerida - nBsDeDisca','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBSIMPONO > 0.00   .END.','000039','000022','.CON.','5','','','5','nBSIMPONO > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := FPOSTAB(cTabela, nBSIMPONO , "<=" , 05 )     .CNT.','000040','000039','.EXE.','5','nAux := FPOSTAB(cTabela, nBSIMPONO , "<=" , 05 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux > 0   .END.','000041','000039','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT := FTABELA(cTabela, nAux, 07, )     .CNT.','000042','000041','.EXE.','5','nPerIRT := FTABELA(cTabela, nAux, 07, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRT > 0   .END.','000043','000041','.CON.','5','','','5','nPerIRT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nExcesso := FTABELA(cTabela, nAux, 04, )     .CNT.','000044','000043','.EXE.','5','nExcesso := FTABELA(cTabela, nAux, 04, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nParcFixa := FTABELA(cTabela, nAux, 06, )     .CNT.','000045','000043','.EXE.','5','nParcFixa := FTABELA(cTabela, nAux, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nResult := Round((nBSIMPONO - nExcesso) * nPerIRT / 100 , 2)','000046','000043','.EXE.','5','nResult := Round((nBSIMPONO - nExcesso) * nPerIRT / 100 , 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVLRIRT := round(((nResult + nParcFixa) - NVIRF107 ) / NMESI','000047','000043','.EXE.','5','nVLRIRT := round(((nResult + nParcFixa) - NVIRF107 - NVIRANT) / NMESIR ,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','Para calcular bases separadas de ferias, calculará IR sem as','000048','000022','.MSG.','5','Para calcular bases separadas de ferias, calculará IR sem as férias, para tirar a diferença.','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','P_BSSEPVAC == "S"   .END.','000049','000022','.CON.','5','','','5','P_BSSEPVAC == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBsIRTFer := nBIRT + nBsIRF107 + nBsIRProj + nBsIRAnt     .C','000050','000049','.EXE.','5','nBsIRTFer := nBIRT + nBsIRF107 + nBsIRProj + nBsIRAnt','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nIESSTFer := nVIESSF107 + nVIESSProj + nVIESSAnt + nVFINSS','000051','000049','.EXE.','5','nIESSTFer := nVIESSF107 + nVIESSProj + nVIESSAnt + nVFINSS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBsImpFer := nBsIRTFer - nIESSTFer - nGastosDe  - nBsTerIda','000052','000049','.EXE.','5','nBsImpFer := nBsIRTFer - nIESSTFer - nGastosDe  - nBsTerIda - nBsDeDisca','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nBsImpFer > 0.00   .END.','000053','000049','.CON.','5','','','5','nBsImpFer > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux := fPosTab( cTabela, nBsImpFer , "<=" , 05 )     .CNT.','000054','000053','.EXE.','5','nAux := fPosTab( cTabela, nBsImpFer , "<=" , 05 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nAux > 0   .END.','000055','000053','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRTFer := fTabela( cTabela, nAux, 07, )     .CNT.','000056','000055','.EXE.','5','nPerIRTFer := fTabela( cTabela, nAux, 07, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nPerIRTFer > 0   .END.','000057','000055','.CON.','5','','','5','nPerIRTFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nExcesso := fTabela( cTabela, nAux, 04, )     .CNT.','000058','000057','.EXE.','5','nExcesso := fTabela( cTabela, nAux, 04, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nParcFixa := fTabela( cTabela, nAux, 06, )     .CNT.','000059','000057','.EXE.','5','nParcFixa := fTabela( cTabela, nAux, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nResult := Round((nBsImpFer - nExcesso) * nPerIRTFer / 100 ,','000060','000057','.EXE.','5','nResult := Round((nBsImpFer - nExcesso) * nPerIRTFer / 100 , 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','NIRSemFer := Round(((nResult + nParcFixa) - nVIRF107 - nVIRA','000061','000057','.EXE.','5','NIRSemFer := Round(((nResult + nParcFixa) - nVIRF107 - nVIRAnt) / nMesIR ,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVlrIRTFer:= nVlrIRT - NIRSemFer     .CNT.','000062','000057','.EXE.','5','nVlrIRTFer:= nVlrIRT - NIRSemFer','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRT','nVlrIRT := nVlrIRT - nVlrIRTFer     .END.','000063','000057','.EXE.','5','nVlrIRT := nVlrIRT - nVlrIRTFer','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0023    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0023( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCNAT','CALCULO DO SUBISIDIO DE NATAL','','','029','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCNAT','lCalc := .T.     .CNT.','000001','000000','.EXE.','5','lCalc := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','cTipoRot == "4"   .END.','000002','000000','.CON.','5','','','5','cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)     .CNT.','000003','000002','.EXE.','5','NPOS := FPOSTAB("S015", CTIPRES, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NPOS > 0 .And.  ( FTABELA("S015",NPOS,9) == "S" )   .END.','000004','000002','.CON.','5','','','5','NPOS > 0 .And.  ( FTABELA("S015",NPOS,9) == "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','lCalc := .T.     .END.','000005','000004','.EXE.','5','lCalc := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NPOS > 0 .And.  ( FTABELA("S015",NPOS,9) == "N" )   .END.','000006','000002','.CON.','5','','','5','NPOS > 0 .And.  ( FTABELA("S015",NPOS,9) == "N" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','lCalc := .F.     .END.','000007','000006','.EXE.','5','lCalc := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','lCalc   .END.','000008','000000','.CON.','5','','','5','lCalc','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','obtem dados da tabela auxiliar     .CNT.','000009','000008','.MSG.','5','obtem dados da tabela auxiliar','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','EMPTY(NPERCNAT) .AND. EMPTY(NMINDIASNAT)   .END.','000010','000008','.CON.','5','','','5','EMPTY(NPERCNAT) .AND. EMPTY(NMINDIASNAT)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','ATAB := {}     .CNT.','000011','000010','.EXE.','5','ATAB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','FRETTAB(@ATAB,"S014",,,DDATAREF)     .CNT.','000012','000010','.EXE.','5','FRETTAB(@ATAB,"S014",,,DDATAREF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','LTAB := !EMPTY(ATAB)   .END.','000013','000010','.CON.','5','','','5','LTAB := !EMPTY(ATAB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NPERCNAT := ATAB[5]     .CNT.','000014','000013','.EXE.','5','NPERCNAT := ATAB[5]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NMINDIASNAT := ATAB[6]     .END.','000015','000013','.EXE.','5','NMINDIASNAT := ATAB[6]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','!LTAB   .END.','000016','000010','.CON.','5','','','5','!LTAB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014"','000017','000016','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','S_MSGLOG()     .CNT.','000018','000016','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','FINALCALC()     .END.','000019','000016','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','obtem meses completos de trabalho     .CNT.','000020','000008','.MSG.','5','obtem meses completos de trabalho','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','AAFAST := {}     .CNT.','000021','000008','.EXE.','5','AAFAST := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRINAT := MAX(FIRSTYDATE(VAL(LEFT(CANOMES,4))), SRA->RA_ADM','000022','000008','.EXE.','5','DPRINAT := MAX(FIRSTYDATE(VAL(LEFT(CANOMES,4))), SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRINAUX := MAX(FIRSTYDATE(VAL(LEFT(CANOMES,4))), SRA->RA_AD','000023','000008','.EXE.','5','DPRINAUX := MAX(FIRSTYDATE(VAL(LEFT(CANOMES,4))), SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DULTNAT := MIN(LASTYDATE(VAL(LEFT(CANOMES,4))), DDATAATE)','000024','000008','.EXE.','5','DULTNAT := MIN(LASTYDATE(VAL(LEFT(CANOMES,4))), DDATAATE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','CTIPOROT == "4"   .END.','000025','000008','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DULTNAT := MIN(DULTNAT, DDATADEM)     .END.','000026','000025','.EXE.','5','DULTNAT := MIN(DULTNAT, DDATADEM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASAFA := 0     .CNT.','000027','000008','.EXE.','5','NDIASAFA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASMES := 30     .CNT.','000028','000008','.EXE.','5','NDIASMES := 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NAVOS := 0     .CNT.','000029','000008','.EXE.','5','NAVOS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRINAUX <= DULTNAT   .END.','000030','000008','.ENQ.','5','','','5','DPRINAUX <= DULTNAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRI1 := DPRINAUX + F_ULTDIA(DPRINAUX) - 1     .CNT.','000031','000030','.EXE.','5','DPRI1 := DPRINAUX + F_ULTDIA(DPRINAUX) - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','fBuscaAfast(DPRINAUX,DPRI1,@aAfast)     .CNT.','000032','000030','.EXE.','5','fBuscaAfast(DPRINAUX,DPRI1,@aAfast)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','Len(aAfast) > 0   .END.','000033','000030','.CON.','5','','','5','Len(aAfast) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','Aeval( aAfast, { |x| iif( x[06]=="1" , nDiasAfa += x[11] , 0','000034','000033','.EXE.','5','Aeval( aAfast, { |x| iif( x[06]=="1" , nDiasAfa += x[11] , 0 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','P_DIASMES = "S"   .END.','000035','000030','.CON.','5','','','5','P_DIASMES = "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASMES := F_ULTDIA(DPRINAUX)     .END.','000036','000035','.EXE.','5','NDIASMES := F_ULTDIA(DPRINAUX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','CTIPOROT == "4" .AND. MESANO(DPRINAUX) == MESANO(DULTNAT)','000037','000030','.CON.','5','','','5','CTIPOROT == "4" .AND. MESANO(DPRINAUX) == MESANO(DULTNAT)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASMES := DAY(DDATADEM)     .END.','000038','000037','.EXE.','5','NDIASMES := DAY(DDATADEM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','(NDIASMES - NDIASAFA) >= NMINDIASNAT   .END.','000039','000030','.CON.','5','','','5','(NDIASMES - NDIASAFA) >= NMINDIASNAT','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NAVOS++     .END.','000040','000039','.EXE.','5','NAVOS++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DPRINAUX := DPRI1 + 1     .END.','000041','000030','.EXE.','5','DPRINAUX := DPRI1 + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','calcula o valor a pagar     .CNT.','000042','000008','.MSG.','5','calcula o valor a pagar','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NVALNATAL := SALMES * NPERCNAT / 100     .CNT.','000043','000008','.EXE.','5','NVALNATAL := SALMES * NPERCNAT / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NVALNATAL := ROUND(NVALNATAL / 12 * NAVOS,2)     .END.','000044','000008','.EXE.','5','NVALNATAL := ROUND(NVALNATAL / 12 * NAVOS,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0024    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0024( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCSBAL','CALCULA SUBSIDIO ALIMENTACAO','','','017','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCSBAL','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','CVERBA := FGETCODFOL("0050")     .CNT.','000002','000000','.EXE.','5','CVERBA := FGETCODFOL("0050")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nDias := 0     .CNT.','000003','000000','.EXE.','5','nDias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','!EMPTY(SRA->RA_SUBALIM)   .END.','000004','000000','.CON.','5','','','5','!EMPTY(SRA->RA_SUBALIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','( FTABELA("S008", 01, 04) = NIL )   .END.','000005','000004','.CON.','5','','','5','( FTABELA("S008", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000006','000005','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','CMSGLOG := FMSGFORM({40}) + "S006 - " + FDESC("RCB", "S006",','000007','000005','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S006 - " + FDESC("RCB", "S006", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','S_MSGLOG()     .CNT.','000008','000005','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','FINALFUN()     .END.','000009','000005','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nPos := fPosTab( "S008", SRA->RA_SUBALIM, "=", 04, , , , , )','000010','000004','.EXE.','5','nPos := fPosTab( "S008", SRA->RA_SUBALIM, "=", 04, , , , , )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nVlrDia := fTabela( "S008", nPos, 05, )     .CNT.','000011','000004','.EXE.','5','nVlrDia := fTabela( "S008", nPos, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nVlrMes := fTabela( "S008", nPos, 06, )     .CNT.','000012','000004','.EXE.','5','nVlrMes := fTabela( "S008", nPos, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','cProp := fTabela( "S008", nPos, 07, )     .CNT.','000013','000004','.EXE.','5','cProp := fTabela( "S008", nPos, 07, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','FPOSREG("RCF", 2, XFILIAL("RCF")+CPROCESSO+CPERIODO)   .EN','000014','000004','.CON.','5','','','5','FPOSREG("RCF", 2, XFILIAL("RCF")+CPROCESSO+CPERIODO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','NDIAS := RCF->RCF_DIATRA     .END.','000015','000014','.EXE.','5','NDIAS := RCF->RCF_DIATRA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','LOK := (NDIAS > 0 .AND. CPROP == "S")   .END.','000016','000004','.CON.','5','','','5','LOK := (NDIAS > 0 .AND. CPROP == "S")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nDescRGB := FO_SOMAALLREGS(@oRGB,"RGB_HORAS",{ "RGB_PD" },{','000017','000016','.EXE.','5','nDescRGB := FO_SOMAALLREGS(@oRGB,"RGB_HORAS",{ "RGB_PD" },{ FGETCODFOL("0054") })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','NDIAS -= nDescRGB     .CNT.','000018','000016','.EXE.','5','NDIAS -= nDescRGB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','NDIAS -= NDIASAFAS     .CNT.','000019','000016','.EXE.','5','NDIAS -= NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nDias := MAX( nDias , 0 )     .END.','000020','000016','.EXE.','5','nDias := MAX( nDias , 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nVlrDia > 0   .END.','000021','000004','.CON.','5','','','5','nVlrDia > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nValor := NDIAS * nVlrDia     .END.','000022','000021','.EXE.','5','nValor := NDIAS * nVlrDia','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nVlrMes > 0   .END.','000023','000004','.CON.','5','','','5','nVlrMes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','nValor := (NVLRMES / RCF->RCF_DIATRA * NDIAS)     .END.','000024','000023','.EXE.','5','nValor := (NVLRMES / RCF->RCF_DIATRA * NDIAS)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','NVALOR > 0   .END.','000025','000000','.CON.','5','','','5','NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','LOK := !EMPTY(CVERBA)   .END.','000026','000025','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS , CCPOVALOR}, {CVERBA, N','000027','000026','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS , CCPOVALOR}, {CVERBA, NDIAS , NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','!LOK   .END.','000028','000025','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','CMSGLOG := FMSGFORM({19}) + "0050 - " + FDESC("RCN", "0050",','000029','000028','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0050 - " + FDESC("RCN", "0050", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBAL','S_MSGLOG()     .END.','000030','000028','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0025    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0025( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCSBTR','CALCULA SUBSIDIO TRANSPORTE','','','017','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCSBTR','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','CVERBA := FGETCODFOL("0052")     .CNT.','000002','000000','.EXE.','5','CVERBA := FGETCODFOL("0052")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nDias := 0     .CNT.','000003','000000','.EXE.','5','nDias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','!EMPTY(SRA->RA_SUBTRAN)   .END.','000004','000000','.CON.','5','','','5','!EMPTY(SRA->RA_SUBTRAN)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','( FTABELA("S007", 01, 04) = NIL )   .END.','000005','000004','.CON.','5','','','5','( FTABELA("S007", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000006','000005','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','CMSGLOG := FMSGFORM({40}) + "S007 - " + FDESC("RCB", "S007",','000007','000005','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S007 - " + FDESC("RCB", "S007", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','S_MSGLOG()     .CNT.','000008','000005','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','FINALFUN()     .END.','000009','000005','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nPos := fPosTab( "S007", SRA->RA_SUBTRAN, "=", 04, , , , , )','000010','000004','.EXE.','5','nPos := fPosTab( "S007", SRA->RA_SUBTRAN, "=", 04, , , , , )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nVlrDia := FTABELA( "S007", NPOS, 05, )     .CNT.','000011','000004','.EXE.','5','nVlrDia := FTABELA( "S007", NPOS, 05, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nVlrMes := FTABELA( "S007", NPOS, 06, )     .CNT.','000012','000004','.EXE.','5','nVlrMes := FTABELA( "S007", NPOS, 06, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','cProp := FTABELA( "S007", NPOS, 07, )     .CNT.','000013','000004','.EXE.','5','cProp := FTABELA( "S007", NPOS, 07, )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','FPOSREG("RCF", 2, XFILIAL("RCF")+CPROCESSO+CPERIODO)   .EN','000014','000004','.CON.','5','','','5','FPOSREG("RCF", 2, XFILIAL("RCF")+CPROCESSO+CPERIODO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nDias := RCF->RCF_DIATRA     .END.','000015','000014','.EXE.','5','nDias := RCF->RCF_DIATRA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','(NDIAS > 0) .AND. (CPROP == "S")   .END.','000016','000004','.CON.','5','','','5','(NDIAS > 0) .AND. (CPROP == "S")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','NDESCRGB := FO_SOMAALLREGS(@ORGB,"RGB_HORAS",{"RGB_PD"},{ FG','000017','000016','.EXE.','5','NDESCRGB := FO_SOMAALLREGS(@ORGB,"RGB_HORAS",{"RGB_PD"},{ FGETCODFOL("0054") })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','NDIAS -= NDESCRGB     .CNT.','000018','000016','.EXE.','5','NDIAS -= NDESCRGB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','NDIAS -= NDIASAFAS     .CNT.','000019','000016','.EXE.','5','NDIAS -= NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nDias := MAX( nDias , 0 )     .END.','000020','000016','.EXE.','5','nDias := MAX( nDias , 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nVlrDia > 0   .END.','000021','000004','.CON.','5','','','5','nVlrDia > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nValor := nDias * nVlrDia     .END.','000022','000021','.EXE.','5','nValor := nDias * nVlrDia','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nVlrMes > 0   .END.','000023','000004','.CON.','5','','','5','nVlrMes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','nValor := (nVlrMes / RCF->RCF_DIATRA * nDias)     .END.','000024','000023','.EXE.','5','nValor := (nVlrMes / RCF->RCF_DIATRA * nDias)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','NVALOR > 0   .END.','000025','000000','.CON.','5','','','5','NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','LOK := !EMPTY(CVERBA)   .END.','000026','000025','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','FO_ADD(@&COBJETO,{CCPOPD , CCPOHORAS , CCPOVALOR}, {CVERBA,','000027','000026','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD , CCPOHORAS , CCPOVALOR}, {CVERBA, NDIAS , NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','!LOK   .END.','000028','000025','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','CMSGLOG := FMSGFORM({19}) + "0052 - " + FDESC("RCN", "0052','000029','000028','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0052 - " + FDESC("RCN", "0052", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSBTR','S_MSGLOG()     .END.','000030','000028','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0026    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0026( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCSECA','CALCULO DEL SECAP','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCSECA','NBISECPNO := 0     .CNT.','000001','000000','.EXE.','5','NBISECPNO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','NVSECPNO := 0     .CNT.','000002','000000','.EXE.','5','NVSECPNO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','NBSECPFE:= 0     .CNT.','000003','000000','.EXE.','5','NBSECPFE:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','NVSECPFE := 0     .CNT.','000004','000000','.EXE.','5','NVSECPFE := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','NPERSECAP  := 0     .CNT.','000005','000000','.EXE.','5','NPERSECAP  := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','LOK := ( fTabela("S013", 01, 04) = NIL )   .END.','000006','000000','.CON.','5','','','5','LOK := ( fTabela("S013", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE TABELA NAO FOI ENCONTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','CMSGLOG := FMSGFORM({40}) + "S013 - " + FDESC("RCB", "S013",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S013 - " + FDESC("RCB", "S013", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','S_MSGLOG()     .CNT.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','FINALCALC()     .END.','000010','000006','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','!LOK   .END.','000011','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','NPERSECAP := fTabela("S013", 01, 04)     .CNT.','000012','000011','.EXE.','5','NPERSECAP := fTabela("S013", 01, 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','P_BSSEPVAC =="N"   .END.','000013','000011','.CON.','5','','','5','P_BSSEPVAC =="N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','nBSECPNO := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_SECAP"}','000014','000013','.EXE.','5','nBSECPNO := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_SECAP"}, {"1"} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','P_BSSEPVAC =="S"   .END.','000015','000011','.CON.','5','','','5','P_BSSEPVAC =="S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','nBSECPNO := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_SECAP",','000016','000015','.EXE.','5','nBSECPNO := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_SECAP", "RV_REFFER"}, {"1", "2* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','nBSECPFE := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_SECAP",','000017','000015','.EXE.','5','nBSECPFE := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_SECAP", "RV_REFFER"}, {"1", "1* "} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','nBSECPNO > 0   .END.','000018','000011','.CON.','5','','','5','nBSECPNO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','NVSECPNO := Round( (nBSECPNO * nPERSECAP ) / 100 , 2)     .E','000019','000018','.EXE.','5','NVSECPNO := Round( (nBSECPNO * nPERSECAP ) / 100 , 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','nBSECPFE > 0   .END.','000020','000011','.CON.','5','','','5','nBSECPFE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSECA','nVSECPFE := Round( (nBSECPFE * nPERSECAP ) / 100 , 2)     .E','000021','000020','.EXE.','5','nVSECPFE := Round( (nBSECPFE * nPERSECAP ) / 100 , 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0027    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0027( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCSFER','CALCULO DO SUBSIDIO DE FERIAS','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCSFER','ATAB := {}     .CNT.','000001','000000','.EXE.','5','ATAB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','FRETTAB(@ATAB,"S004",,,DDATABASE)     .CNT.','000002','000000','.EXE.','5','FRETTAB(@ATAB,"S004",,,DDATABASE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','LEN(ATAB) > 0   .END.','000003','000000','.CON.','5','','','5','LEN(ATAB) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NPERC := ATAB[10]     .CNT.','000004','000003','.EXE.','5','NPERC := ATAB[10]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NDIASFER := GETMEMVAR("RH_DFERIAS")     .CNT.','000005','000003','.EXE.','5','NDIASFER := GETMEMVAR("RH_DFERIAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NDIASMES := IF(P_DIASMES="S",DAY(DDATAATE),30)     .CNT.','000006','000003','.EXE.','5','NDIASMES := IF(P_DIASMES="S",DAY(DDATAATE),30)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NVALFERIAS := SALMES * ( NPERC / 100 )     .CNT.','000007','000003','.EXE.','5','NVALFERIAS := SALMES * ( NPERC / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NVALFERIAS := NVALFERIAS / NDIASMES * NDIASFER     .CNT.','000008','000003','.EXE.','5','NVALFERIAS := NVALFERIAS / NDIASMES * NDIASFER','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','NVALFERIAS > 0   .END.','000009','000003','.CON.','5','','','5','NVALFERIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCSFER','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL','000010','000009','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL("0072"), NDIASFER , NVALFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0028    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0028( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALFERES','CALCULO DE FERIAS NA RESCISAO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALFERES','ATAB := {}     .CNT.','000001','000000','.EXE.','5','ATAB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','FRETTAB(@ATAB,"S004",,,DDATABASE)     .CNT.','000002','000000','.EXE.','5','FRETTAB(@ATAB,"S004",,,DDATABASE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','LEN(ATAB) > 0   .END.','000003','000000','.CON.','5','','','5','LEN(ATAB) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NPERC := ATAB[10]     .CNT.','000004','000003','.EXE.','5','NPERC := ATAB[10]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDIASMES := IF(P_DIASMES="S",DAY(DDATAATE),30)     .CNT.','000005','000003','.EXE.','5','NDIASMES := IF(P_DIASMES="S",DAY(DDATAATE),30)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NSALFERIAS := SALMES     .CNT.','000006','000003','.EXE.','5','NSALFERIAS := SALMES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NSUBFERIAS := NSALFERIAS * ( NPERC / 100 )     .CNT.','000007','000003','.EXE.','5','NSUBFERIAS := NSALFERIAS * ( NPERC / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','CALCULO DE SUBSIDIO PROPORCIONAL     .CNT.','000008','000003','.MSG.','5','CALCULO DE SUBSIDIO PROPORCIONAL','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDSUBPRO  := GETMEMVAR('+"'"+'RG_DSUBAVE'+"'"+')     .CNT.','000009','000003','.EXE.','5','NDSUBPRO  := GETMEMVAR('+"'"+'RG_DSUBAVE'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS := NSUBFERIAS / NDIASMES * NDSUBPRO     .CNT.','000010','000003','.EXE.','5','NVALFERIAS := NSUBFERIAS / NDIASMES * NDSUBPRO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS > 0   .END.','000011','000003','.CON.','5','','','5','NVALFERIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFERES','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL','000012','000011','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL("0087"), NDSUBPRO , NVALFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','CALCULO DE SUBSIDIO VENCIDAS     .CNT.','000013','000003','.MSG.','5','CALCULO DE SUBSIDIO VENCIDAS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDSUBVEN := GETMEMVAR('+"'"+'RG_DSUBVEN'+"'"+')     .CNT.','000014','000003','.EXE.','5','NDSUBVEN := GETMEMVAR('+"'"+'RG_DSUBVEN'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS := NSUBFERIAS / NDIASMES * NDSUBVEN     .CNT.','000015','000003','.EXE.','5','NVALFERIAS := NSUBFERIAS / NDIASMES * NDSUBVEN','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS > 0   .END.','000016','000003','.CON.','5','','','5','NVALFERIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFERES','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL','000017','000016','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL("0086"), NDSUBVEN , NVALFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','CALCULO DE DIAS DE FERIAS NAO GOZADAS     .CNT.','000018','000003','.MSG.','5','CALCULO DE DIAS DE FERIAS NAO GOZADAS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDIASPRO := GETMEMVAR("RG_DFERPRO")     .CNT.','000019','000003','.EXE.','5','NDIASPRO := GETMEMVAR("RG_DFERPRO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDIASVEN := GETMEMVAR("RG_DFERVEN")     .CNT.','000020','000003','.EXE.','5','NDIASVEN := GETMEMVAR("RG_DFERVEN")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NDIASFER := NDIASPRO + NDIASVEN     .CNT.','000021','000003','.EXE.','5','NDIASFER := NDIASPRO + NDIASVEN','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS := NSALFERIAS / NDIASMES * NDIASFER     .CNT.','000022','000003','.EXE.','5','NVALFERIAS := NSALFERIAS / NDIASMES * NDIASFER','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALFERES','NVALFERIAS > 0   .END.','000023','000003','.CON.','5','','','5','NVALFERIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFERES','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL','000024','000023','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{ FGETCODFOL("1100"), NDIASFER , NVALFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0029    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0029( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALVALPL','CALCULA VALORES PARA PLR','','','016','2','1',} )

aAdd(aRc3Cols, { '','S_','CALVALPL','NDIAREM := PLRTOTREM / PLRTOTDIA     .CNT.','000001','000000','.EXE.','5','NDIAREM := PLRTOTREM / PLRTOTDIA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVALPL','NDIAFAM := PLRTOTFAM / PLRTOTDEP     .CNT.','000002','000000','.EXE.','5','NDIAFAM := PLRTOTFAM / PLRTOTDEP','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVALPL','(NPOS := ASCAN(AFUNPLR,{|X| X[1] = SRA->RA_MAT})) > 0   .E','000003','000000','.CON.','5','','','5','(NPOS := ASCAN(AFUNPLR,{|X| X[1] = SRA->RA_MAT})) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVALPL','PLRREFREM := ROUND(AFUNPLR[NPOS,2],2)     .CNT.','000004','000003','.EXE.','5','PLRREFREM := ROUND(AFUNPLR[NPOS,2],2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVALPL','PLRREFFAM := ROUND(AFUNPLR[NPOS,3],2)     .CNT.','000005','000003','.EXE.','5','PLRREFFAM := ROUND(AFUNPLR[NPOS,3],2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVALPL','PLRVALREM := ROUND(PLRREFREM * NDIAREM,2)     .CNT.','000006','000003','.EXE.','5','PLRVALREM := ROUND(PLRREFREM * NDIAREM,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVALPL','PLRVALFAM := ROUND(PLRREFFAM * NDIAFAM,2)     .END.','000007','000003','.EXE.','5','PLRVALFAM := ROUND(PLRREFFAM * NDIAFAM,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0030    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0030( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARACU13','CARREGA VALOR ACUMULADO PARA 13. SAL.','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CARACU13','aAfast := {}     .CNT.','000001','000000','.EXE.','5','aAfast := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','dData := dDataRef - 1     .CNT.','000002','000000','.EXE.','5','dData := dDataRef - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','cPerIni := ""     .CNT.','000003','000000','.EXE.','5','cPerIni := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','cPerFim := ""     .CNT.','000004','000000','.EXE.','5','cPerFim := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','aPerTodos := {}     .CNT.','000005','000000','.EXE.','5','aPerTodos := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','FRETPERCOMP( AllTrim(StrZero(Month(dData),2)), AllTrim(StrZe','000006','000000','.EXE.','5','FRETPERCOMP( AllTrim(StrZero(Month(dData),2)), AllTrim(StrZero(Year(dData),4)), NIL, SRA->RA_PROCES, NIL, NIL, NIL,@aPerTodos)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','!Empty(aPerTodos)   .END.','000007','000000','.CON.','5','','','5','!Empty(aPerTodos)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARACU13','cPerFim := aPerTodos[len(aPerTodos),1]     .END.','000008','000007','.EXE.','5','cPerFim := aPerTodos[len(aPerTodos),1]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','!Empty(cPerFim)   .END.','000009','000000','.CON.','5','','','5','!Empty(cPerFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARACU13','dDtFim := dData     .CNT.','000010','000009','.EXE.','5','dDtFim := dData','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','dData := MonthSub(dDataRef,12)     .CNT.','000011','000009','.EXE.','5','dData := MonthSub(dDataRef,12)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','dDtIni := Max(dData,SRA->RA_ADMISSA)     .CNT.','000012','000009','.EXE.','5','dDtIni := Max(dData,SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','aPerTodos := {}     .CNT.','000013','000009','.EXE.','5','aPerTodos := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','FRETPERCOMP( AllTrim(StrZero(Month(dData),2)), AllTrim(StrZe','000014','000009','.EXE.','5','FRETPERCOMP( AllTrim(StrZero(Month(dData),2)), AllTrim(StrZero(Year(dData),4)), NIL, SRA->RA_PROCES, NIL, NIL, NIL,@aPerTodos)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','!Empty(aPerTodos)   .END.','000015','000009','.CON.','5','','','5','!Empty(aPerTodos)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARACU13','cPerIni := aPerTodos[1,1]     .CNT.','000016','000015','.EXE.','5','cPerIni := aPerTodos[1,1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','!Empty(cPerIni)   .END.','000017','000015','.CON.','5','','','5','!Empty(cPerIni)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARACU13','fBuscaAcmPer(NIL, "SRV->RV_MED13=='+"'"+'1'+"'"+'", "V", @TOTACU13, NIL,','000018','000017','.EXE.','5','fBuscaAcmPer(NIL, "SRV->RV_MED13=='+"'"+'1'+"'"+'", "V", @TOTACU13, NIL, cPerIni, cPerFim, NIL, NIL, "LIQ", .F.,.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','DIAACU13 := (dDtFim - dDtIni) + 1     .CNT.','000019','000009','.EXE.','5','DIAACU13 := (dDtFim - dDtIni) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','fBuscaAfast(dDtIni,dDtFim,@aAfast)     .CNT.','000020','000009','.EXE.','5','fBuscaAfast(dDtIni,dDtFim,@aAfast)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARACU13','!Empty(aAfast)   .END.','000021','000009','.CON.','5','','','5','!Empty(aAfast)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARACU13','AEVAL(aAfast, {|X| IF(X[6] = "1", DIAACU13 -= X[11], 0)})','000022','000021','.EXE.','5','AEVAL(aAfast, {|X| IF(X[6] = "1", DIAACU13 -= X[11], 0)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0031    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0031( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARDEDES','CARGA  DEDUCIONES ESPECIALES','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CARDEDES','NBSDEDiSCA := 0.00     .CNT.','000001','000000','.EXE.','5','NBSDEDiSCA := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','NBSTERIDA := 0.00     .CNT.','000002','000000','.EXE.','5','NBSTERIDA := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','NBSMIN := 0.00     .CNT.','000003','000000','.EXE.','5','NBSMIN := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','nIdade := (year(ddata_pgto) - 1) - Year(SRA->RA_NASC)     .C','000004','000000','.EXE.','5','nIdade := (year(ddata_pgto) - 1) - Year(SRA->RA_NASC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','nIdade >= 65   .END.','000005','000000','.CON.','5','','','5','nIdade >= 65','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','LSAI := (FTABELA("S010", 01, 06 = NIL)   .END.','000006','000005','.CON.','5','','','5','LSAI := (FTABELA("S010", 01, 06) = NIL)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','CMSGLOG := FMSGFORM({40}) + " S010 - " + FDESC("RCB", "S010"','000007','000006','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S010 - " + FDESC("RCB", "S010", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','S_MSGLOG()     .CNT.','000008','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','FINALCALC()     .END.','000009','000006','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','!LSAI .AND. (LSAI := (FTABELA("S014", 01, 04) = NIL))   .E','000010','000005','.CON.','5','','','5','!LSAI .AND. (LSAI := (FTABELA("S014", 01, 04) = NIL))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014"','000011','000010','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','S_MSGLOG()     .CNT.','000012','000010','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','FINALCALC()     .END.','000013','000010','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','!LSAI   .END.','000014','000005','.CON.','5','','','5','!LSAI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','NBSTERIDA := FTABELA("S010",1,6)     .CNT.','000015','000014','.EXE.','5','NBSTERIDA := FTABELA("S010",1,6)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','NBsMIN := FTABELA("S014",1,4)     .CNT.','000016','000014','.EXE.','5','NBsMIN := FTABELA("S014",1,4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','NBSTERIDA :=  NBSTERIDA * NBSMIN     .END.','000017','000014','.EXE.','5','NBSTERIDA :=  NBSTERIDA * NBSMIN','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','SRA->RA_DEFIFIS <> "2"   .END.','000018','000000','.CON.','5','','','5','SRA->RA_DEFIFIS <> "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','LSAI := (FTABELA("S010", 01, 07) = NIL)   .END.','000019','000018','.CON.','5','','','5','LSAI := (FTABELA("S010", 01, 07) = NIL)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','CMSGLOG := FMSGFORM({40}) + " S010 - " + FDESC("RCB", "S010"','000020','000019','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S010 - " + FDESC("RCB", "S010", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','S_MSGLOG()     .CNT.','000021','000019','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','FINALCALC()     .END.','000022','000019','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','!LSAI .AND. (LSAI := (FTABELA("S014", 01, 04) = NIL))   .E','000023','000018','.CON.','5','','','5','!LSAI .AND. (LSAI := (FTABELA("S014", 01, 04) = NIL))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014"','000024','000023','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','S_MSGLOG()     .CNT.','000025','000023','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','FINALCALC()     .END.','000026','000023','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','!LSAI   .END.','000027','000018','.CON.','5','','','5','!LSAI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','NBSDEDISCA := FTABELA("S010",1,7)     .CNT.','000028','000027','.EXE.','5','NBSDEDISCA := FTABELA("S010",1,7)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','NBsMIN := FTABELA("S014",1,4)     .CNT.','000029','000027','.EXE.','5','NBsMIN := FTABELA("S014",1,4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARDEDES','NBSDEDISCA := NBSDEDISCA * NBSMIN     .END.','000030','000027','.EXE.','5','NBSDEDISCA := NBSDEDISCA * NBSMIN','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0032    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0032( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGACM','CARGA VALORES ACUMULADOS P/ IR','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGACM','NBSIRANT := 0.00     .CNT.','000001','000000','.EXE.','5','NBSIRANT := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','nVIESSAnt:= 0     .CNT.','000002','000000','.EXE.','5','nVIESSAnt:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','DPERINI := CTOD(" /  /  ")     .CNT.','000003','000000','.EXE.','5','DPERINI := CTOD(" /  /  ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','DPERFIM := CTOD(" /  /  ")     .CNT.','000004','000000','.EXE.','5','DPERFIM := CTOD(" /  /  ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NVIRANT := 0.00     .CNT.','000005','000000','.EXE.','5','NVIRANT := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','EMPTY(CVERBASAC)   .END.','000006','000000','.CON.','5','','','5','EMPTY(CVERBASAC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','S_VERBASAC()     .END.','000007','000006','.EXE.','5','S_VERBASAC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','MONTH(DDATA_PGTO) > 1   .END.','000008','000000','.CON.','5','','','5','MONTH(DDATA_PGTO) > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','DPERINI := CtoD("01/01/" + StrZero(Year(dDataRef), 4))     .','000009','000008','.EXE.','5','DPERINI := CtoD("01/01/" + StrZero(Year(dDataRef), 4))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','DPERFIM  := dDataRef - 1     .CNT.','000010','000008','.EXE.','5','DPERFIM  := dDataRef - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC := FBUSCAACM(CVERBASAC, , DPERINI, DPERFIM, "V"','000011','000008','.EXE.','5','AVERBASGANAC := FBUSCAACM(CVERBASAC, , DPERINI, DPERFIM, "V", , ,"LIQ" ,.T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','LEN(AVERBASGANAC) > 0   .END.','000012','000008','.CON.','5','','','5','LEN(AVERBASGANAC) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NX := 1     .CNT.','000013','000012','.EXE.','5','NX := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NX <= LEN(AVERBASGANAC)   .END.','000014','000012','.ENQ.','5','','','5','NX <= LEN(AVERBASGANAC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC[NX,1] $ FGETCODFOL("0015")   .END.','000015','000014','.CON.','5','','','5','AVERBASGANAC[NX,1] $ FGETCODFOL("0015")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NBSIRANT += AVERBASGANAC[NX,3]     .END.','000016','000015','.EXE.','5','NBSIRANT += AVERBASGANAC[NX,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC[NX,1] $ FGETCODFOL("0066")   .END.','000017','000014','.CON.','5','','','5','AVERBASGANAC[NX,1] $ FGETCODFOL("0066")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NVIRANT += AVERBASGANAC[NX,3]     .END.','000018','000017','.EXE.','5','NVIRANT += AVERBASGANAC[NX,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC[NX,1] $ FGETCODFOL("0016")   .END.','000019','000014','.CON.','5','','','5','AVERBASGANAC[NX,1] $ FGETCODFOL("0016")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NBSIRANT += AVERBASGANAC[NX,3]     .END.','000020','000019','.EXE.','5','NBSIRANT += AVERBASGANAC[NX,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC[NX,1] $ FGETCODFOL("0067")   .END.','000021','000014','.CON.','5','','','5','AVERBASGANAC[NX,1] $ FGETCODFOL("0067")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NVIRANT += AVERBASGANAC[NX,3]     .END.','000022','000021','.EXE.','5','NVIRANT += AVERBASGANAC[NX,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC[NX,1] $ FGETCODFOL("1118")   .END.','000023','000014','.CON.','5','','','5','AVERBASGANAC[NX,1] $ FGETCODFOL("1118")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NBSIRANT += AVERBASGANAC[NX,3]     .END.','000024','000023','.EXE.','5','NBSIRANT += AVERBASGANAC[NX,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC[NX,1] $ (FGETCODFOL("0064")  +"|"+ FGETCODFOL','000025','000014','.CON.','5','','','5','AVERBASGANAC[NX,1] $ (FGETCODFOL("0064")  +"|"+ FGETCODFOL("0065") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','nVIESSAnt += AVERBASGANAC[NX,3]     .END.','000026','000025','.EXE.','5','nVIESSAnt += AVERBASGANAC[NX,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','Esta deduzindo o IESS do Formulario 107 para criar a base ne','000027','000014','.MSG.','5','Esta deduzindo o IESS do Formulario 107 para criar a base neta mes anterior','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC[NX,1] $ FGETCODFOL("0289")   .END.','000028','000014','.CON.','5','','','5','AVERBASGANAC[NX,1] $ FGETCODFOL("0289")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NBSIRANT -= AVERBASGANAC[NX,3]     .END.','000029','000028','.EXE.','5','NBSIRANT -= AVERBASGANAC[NX,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','AVERBASGANAC[NX,1] $ FGETCODFOL("1187")   .END.','000030','000014','.CON.','5','','','5','AVERBASGANAC[NX,1] $ FGETCODFOL("1187")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NVIRANT += AVERBASGANAC[NX,3]     .END.','000031','000030','.EXE.','5','NVIRANT += AVERBASGANAC[NX,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGACM','NX+=1     .END.','000032','000014','.EXE.','5','NX+=1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0033    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0033( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCF','Carrega Periodos','','001046','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCF','lRotBlank := .F.     .CNT.','000001','000000','.EXE.','5','lRotBlank := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cKey :=  xFilial( "RCH" ) + cProcesso + cPeriodo + cNumPag +','000002','000000','.EXE.','5','cKey :=  xFilial( "RCH" ) + cProcesso + cPeriodo + cNumPag + c__roteiro','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','nIndice := RETORDER("RCF", "RCF_FILIAL+RCF_PROCES+RCF_PER+RC','000003','000000','.EXE.','5','nIndice := RETORDER("RCF", "RCF_FILIAL+RCF_PROCES+RCF_PER+RCF_SEMANA+RCF_ROTEIR+RCF_TNOTRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','fPosPeriodo( xFilial( "RCH" ), cProcesso, cPeriodo, cNumPa','000004','000000','.CON.','5','','','5','fPosPeriodo( xFilial( "RCH" ), cProcesso, cPeriodo, cNumPag, c__roteiro, , @lRotBlank, 1 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cKey := xFilial("RCF") + cProcesso + cPeriodo + cNumPag + If','000005','000004','.EXE.','5','cKey := xFilial("RCF") + cProcesso + cPeriodo + cNumPag + If( lRotBlank, Space(3),  c__Roteiro )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','fo_New( @oRCF , "RCF" , nIndice , cKey )     .END.','000006','000000','.EXE.','5','fo_New( @oRCF , "RCF" , nIndice , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0034    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0034( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCH','Carrega Periodos de Calculo','','001047','033','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCH','cPeriodo := GetPeriodCalc()   .CNT.','000001','000000','.EXE.','5','cPeriodo',':=','5','GetPeriodCalc()','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cNumPag := GetNumPgCalc()   .CNT.','000002','000000','.EXE.','5','cNumPag',':=','5','GetNumPgCalc()','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cProcesso := SRA->RA_PROCES   .CNT.','000003','000000','.EXE.','5','cProcesso',':=','5','SRA->RA_PROCES','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','nRchOrd := RetOrder( "RCH" , "RCH_FILIAL+RCH_PROCES+RCH_PER+','000004','000000','.EXE.','5','nRchOrd := RetOrder( "RCH" , "RCH_FILIAL+RCH_PROCES+RCH_PER+RCH_NUMPAG+RCH_ROTEIR" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000005','000000','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo + cNumPag + c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_Eof(@oRCH)   .END.','000006','000000','.CON.','5','','','5','fo_Eof(@oRCH)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000007','000006','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo + cNumPag + "   ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_Eof(@oRCH) .And. cTipoRot == "9"   .END.','000008','000000','.CON.','5','','','5','fo_Eof(@oRCH) .And. cTipoRot == "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000009','000008','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo +  "  " + "   ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataDe := fo_GetVal(@oRCH, "RCH_DTINI", 1)   .CNT.','000010','000000','.EXE.','5','dDataDe',':=','5','fo_GetVal(@oRCH, "RCH_DTINI", 1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataAte := fo_GetVal(@oRCH, "RCH_DTFIM", 1)   .CNT.','000011','000000','.EXE.','5','dDataAte',':=','5','fo_GetVal(@oRCH, "RCH_DTFIM", 1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cAnoMes  := fo_GetVal(@oRCH, "RCH_ANO", 1) + fo_GetVal(@oRCH','000012','000000','.EXE.','5','cAnoMes  := fo_GetVal(@oRCH, "RCH_ANO", 1) + fo_GetVal(@oRCH, "RCH_MES",1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPAGO", 1)     .CNT.','000013','000000','.EXE.','5','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPAGO", 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataref := CTOD("01/" + fo_getVal(@oRCH, "RCH_MES", 1) + "/','000014','000000','.EXE.','5','dDataref',':=','5','CTOD("01/" + fo_getVal(@oRCH, "RCH_MES", 1) + "/" + fo_getVal(@oRCH, "RCH_ANO", 1))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fPosReg("SRY", 1, xFIlial("SRY") + c__Roteiro)     .CNT.','000015','000000','.EXE.','5','fPosReg("SRY", 1, xFIlial("SRY") + c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cTipoRot := SRY->RY_TIPO   .END.','000016','000000','.EXE.','5','cTipoRot',':=','5','SRY->RY_TIPO','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0035    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0035( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCM','Carrega Tipo de Ausencia','','001048','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCM','fo_New(@oRCM, "RCM", 1, xFIlial("RCM"))     .END.','000001','000000','.EXE.','5','fo_New(@oRCM, "RCM", 1, xFIlial("RCM"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0036    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0036( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARG1','CARGA RG1','','','032','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARG1','cRetOrder := "RG1_FILIAL+RG1_MAT+RG1_ORDEM+RG1_PD+DTOS(RG1_D','000001','000000','.EXE.','5','cRetOrder := "RG1_FILIAL+RG1_MAT+RG1_ORDEM+RG1_PD+DTOS(RG1_DINIPG)"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','nRG1Order := RetOrder( "RG1" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nRG1Order := RetOrder( "RG1" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','LSQLWHERE := .T.     .CNT.','000004','000000','.EXE.','5','LSQLWHERE := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','LTOPFILTER := .T.     .CNT.','000005','000000','.EXE.','5','LTOPFILTER := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cTipoRot = "3"   .END.','000006','000000','.CON.','5','','','5','cTipoRot = "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cAnoMes := MesAno(GetMemVar("RH_DATAINI") )     .END.','000007','000006','.EXE.','5','cAnoMes := MesAno(GetMemVar("RH_DATAINI") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','( LTOP := IFDEFTOP() )   .END.','000008','000000','.CON.','5','','','5','( LTOP := IFDEFTOP() )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere := "RG1_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " +','000009','000008','.EXE.','5','cQueryWhere := "RG1_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "RG1_MAT='+"'"+'" + SRA->RA_MAT + "'+"'"+' AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "  RG1_DINIPG<= '+"'"+'" + CANOMES +  StrZero(f_Ult','000010','000008','.EXE.','5','cQueryWhere += "  RG1_DINIPG<= '+"'"+'" + CANOMES +  StrZero(f_Ultdia(dDataRef),2) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " AND "     .CNT.','000011','000008','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "( RG1_DFIMPG =  '+"'"+'        '+"'"+' "+ " or " + "RG1_','000012','000008','.EXE.','5','cQueryWhere','+=','5','"( RG1_DFIMPG =  '+"'"+'        '+"'"+' "+ " or " + "RG1_DFIMPG >= '+"'"+'" + CANOMES + '+"'"+'01'+"'"+' + "'+"'"+'  ) "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " AND "     .CNT.','000013','000008','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "D_E_L_E_T_<> '+"'"+'*'+"'"+' "     .END.','000014','000008','.EXE.','5','cQueryWhere += "D_E_L_E_T_<> '+"'"+'*'+"'"+' "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','!LTOP   .END.','000015','000000','.CON.','5','','','5','!LTOP','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere := "  DTOS(RG1_DINIPG) <= '+"'"+'" + CANOMES +  StrZer','000016','000015','.EXE.','5','cQueryWhere := "  DTOS(RG1_DINIPG) <= '+"'"+'" + CANOMES +  StrZero(f_Ultdia(dDataRef),2) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " .AND. "     .CNT.','000017','000015','.EXE.','5','cQueryWhere += " .AND. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " (DTOS(RG1_DFIMPG) == '+"'"+'        '+"'"+'  .OR. DTOS(','000018','000015','.EXE.','5','cQueryWhere += " (DTOS(RG1_DFIMPG) == '+"'"+'        '+"'"+'  .OR. DTOS(RG1_DFIMPG)  >='+"'"+'" + CANOMES +'+"'"+'01'+"'"+'+"'+"'"+' ) "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','FO_NEW(@oRG1 , "RG1",nRG1Order , cKey , cQueryWhere, @lSqlWh','000019','000000','.EXE.','5','FO_NEW(@oRG1 , "RG1",nRG1Order , cKey , cQueryWhere, @lSqlWhere , @lTopFilter)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0037    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0037( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARGB','CARGA TABELA RGB','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARGB','GetRgb()     .END.','000001','000000','.EXE.','5','GetRgb()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0038    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0038( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARH5','CARGA RH5','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARH5','cRetOrder := "RH5_FILIAL+RH5_MAT"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RH5_FILIAL+RH5_MAT"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARH5','nSrbOrder := RetOrder( "RH5" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSrbOrder := RetOrder( "RH5" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARH5','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARH5','FO_NEW(@oRH5 , "RH5",nSrbOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oRH5 , "RH5",nSrbOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0039    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0039( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASR8','Carrega Ausencias','','001049','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASR8','GetSr8()     .END.','000001','000000','.EXE.','5','GetSr8()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0040    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0040( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRB','CARGA SRB','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRB','cRetOrder := "RB_FILIAL+RB_MAT"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RB_FILIAL+RB_MAT"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','nSrbOrder := RetOrder( "SRB" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSrbOrder := RetOrder( "SRB" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','FO_NEW(@oSRB , "SRB",nSrbOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oSRB , "SRB",nSrbOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0041    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0041( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRC','CARREGA LANCAMENTOS','','001050','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRC','GetSrc()     .END.','000001','000000','.EXE.','5','GetSrc()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0042    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0042( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRF','CARREGA SRF','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRF','cRetOrder := "RF_FILIAL+RF_MAT+DTOS(RF_DATABAS)"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RF_FILIAL+RF_MAT+DTOS(RF_DATABAS)"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','nSRFOrder := RetOrder( "SRF" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSRFOrder := RetOrder( "SRF" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','FO_NEW(@oSRF , "SRF",nSRFOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oSRF , "SRF",nSRFOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0043    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0043( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRK','CARREGA VALORES FUTUROS','','001051','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRK','GetSrk()     .END.','000001','000000','.EXE.','5','GetSrk()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0044    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0044( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGATAB','CARREGA INFORMACOES DA TABELA','','000320','008','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGATAB','cTipoRot $ "3*4" .END.','000001','000000','.CON.','5','','','5','cTipoRot','$','5','"3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cObjeto := "oSRR"   .CNT.','000002','000001','.EXE.','5','cObjeto',':=','5','"oSRR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoCC := "RR_CC"   .CNT.','000003','000001','.EXE.','5','cCpoCC',':=','5','"RR_CC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoData := "RR_DATA"   .CNT.','000004','000001','.EXE.','5','cCpoData',':=','5','"RR_DATA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHoras := "RR_HORAS"   .CNT.','000005','000001','.EXE.','5','cCpoHoras',':=','5','"RR_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHorInf := "RR_HORINFO"   .CNT.','000006','000001','.EXE.','5','cCpoHorInf',':=','5','"RR_HORINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNPagto := "RR_SEMANA"   .CNT.','000007','000001','.EXE.','5','cCpoNPagto',':=','5','"RR_SEMANA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNumID := "RR_NUMID"   .CNT.','000008','000001','.EXE.','5','cCpoNumID',':=','5','"RR_NUMID"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPD := "RR_PD"   .CNT.','000009','000001','.EXE.','5','cCpoPD',':=','5','"RR_PD"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoSeq := "RR_SEQ"   .CNT.','000010','000001','.EXE.','5','cCpoSeq',':=','5','"RR_SEQ"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo1 := "RR_TIPO1"   .CNT.','000011','000001','.EXE.','5','cCpoTipo1',':=','5','"RR_TIPO1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo2 := "RR_TIPO2"   .CNT.','000012','000001','.EXE.','5','cCpoTipo2',':=','5','"RR_TIPO2"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValor := "RR_VALOR"   .CNT.','000013','000001','.EXE.','5','cCpoValor',':=','5','"RR_VALOR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValInf := "RR_VALINFO"   .CNT.','000014','000001','.EXE.','5','cCpoValInf',':=','5','"RR_VALINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMat := "RR_MAT"   .CNT.','000015','000001','.EXE.','5','cCpoMat',':=','5','"RR_MAT"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoRot := "RR_ROTEIR"   .CNT.','000016','000001','.EXE.','5','cCpoRot',':=','5','"RR_ROTEIR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPer := "RR_PERIODO"   .CNT.','000017','000001','.EXE.','5','cCpoPer',':=','5','"RR_PERIODO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoFilial := "RR_FILIAL"     .CNT.','000018','000001','.EXE.','5','cCpoFilial := "RR_FILIAL"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoProc := "RR_PROCES"     .CNT.','000019','000001','.EXE.','5','cCpoProc := "RR_PROCES"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDepto := "RR_DEPTO"     .END.','000020','000001','.EXE.','5','cCpoDepto := "RR_DEPTO"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','!(cTipoRot $ "3*4")   .END.','000021','000000','.CON.','5','','','5','!(cTipoRot $ "3*4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cObjeto := "oSRC"   .CNT.','000022','000021','.EXE.','5','cObjeto',':=','5','"oSRC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoCC := "RC_CC"   .CNT.','000023','000021','.EXE.','5','cCpoCC',':=','5','"RC_CC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoData := "RC_DATA"   .CNT.','000024','000021','.EXE.','5','cCpoData',':=','5','"RC_DATA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHoras := "RC_HORAS"   .CNT.','000025','000021','.EXE.','5','cCpoHoras',':=','5','"RC_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHorInf := "RC_HORINFO"   .CNT.','000026','000021','.EXE.','5','cCpoHorInf',':=','5','"RC_HORINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNPagto := "RC_SEMANA"   .CNT.','000027','000021','.EXE.','5','cCpoNPagto',':=','5','"RC_SEMANA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNumID := "RC_NUMID"   .CNT.','000028','000021','.EXE.','5','cCpoNumID',':=','5','"RC_NUMID"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPD := "RC_PD"   .CNT.','000029','000021','.EXE.','5','cCpoPD',':=','5','"RC_PD"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoQtdSem := "RC_QTDSEM"   .CNT.','000030','000021','.EXE.','5','cCpoQtdSem',':=','5','"RC_QTDSEM"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoSeq := "RC_SEQ"   .CNT.','000031','000021','.EXE.','5','cCpoSeq',':=','5','"RC_SEQ"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo1 := "RC_TIPO1"   .CNT.','000032','000021','.EXE.','5','cCpoTipo1',':=','5','"RC_TIPO1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo2 := "RC_TIPO2"   .CNT.','000033','000021','.EXE.','5','cCpoTipo2',':=','5','"RC_TIPO2"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValInf := "RC_VALINFO"   .CNT.','000034','000021','.EXE.','5','cCpoValInf',':=','5','"RC_VALINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValor := "RC_VALOR"   .CNT.','000035','000021','.EXE.','5','cCpoValor',':=','5','"RC_VALOR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMat := "RC_MAT"   .CNT.','000036','000021','.EXE.','5','cCpoMat',':=','5','"RC_MAT"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoParcel := "RC_PARCELA"   .CNT.','000037','000021','.EXE.','5','cCpoParcel',':=','5','"RC_PARCELA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoRot := "RC_ROTEIR"   .CNT.','000038','000021','.EXE.','5','cCpoRot',':=','5','"RC_ROTEIR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPer := "RC_PERIODO"   .CNT.','000039','000021','.EXE.','5','cCpoPer',':=','5','"RC_PERIODO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDtRef := "RC_DTREF"   .CNT.','000040','000021','.EXE.','5','cCpoDtRef',':=','5','"RC_DTREF"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoFilial := "RC_FILIAL"     .CNT.','000041','000021','.EXE.','5','cCpoFilial := "RC_FILIAL"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPosto := "RC_POSTO"     .CNT.','000042','000021','.EXE.','5','cCpoPosto := "RC_POSTO"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoProc := "RC_PROCES"     .CNT.','000043','000021','.EXE.','5','cCpoProc := "RC_PROCES"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDepto := "RC_DEPTO"     .END.','000044','000021','.EXE.','5','cCpoDepto := "RC_DEPTO"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0045    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0045( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGF107','CARGA VALORES FORMULARIO 107','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGF107','FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("1118")})   .END.','000001','000000','.CON.','5','','','5','FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("1118")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGF107','NBSIRF107 :=FO_GETVAL(@&cObjeto,CCPOVALOR)     .END.','000002','000001','.EXE.','5','NBSIRF107 :=FO_GETVAL(@&cObjeto,CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGF107','FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("0289")})   .END.','000003','000000','.CON.','5','','','5','FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("0289")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGF107','NVIESSF107 :=FO_GETVAL(@&cObjeto,CCPOVALOR)     .END.','000004','000003','.EXE.','5','NVIESSF107 :=FO_GETVAL(@&cObjeto,CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGF107','FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("1187")})   .END.','000005','000000','.CON.','5','','','5','FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("1187")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGF107','NVIRF107:=FO_GETVAL(@&cObjeto,CCPOVALOR)     .END.','000006','000005','.EXE.','5','NVIRF107:=FO_GETVAL(@&cObjeto,CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0046    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0046( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGGAST','CARGA GASTOS DEDUCIONES','','','024','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGGAST','NGASTOSDE := 0.00     .CNT.','000001','000000','.EXE.','5','NGASTOSDE := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NRH5ANO := 0     .CNT.','000002','000000','.EXE.','5','NRH5ANO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NRH5COD := 0     .CNT.','000003','000000','.EXE.','5','NRH5COD := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NRH5VAL := 0     .CNT.','000004','000000','.EXE.','5','NRH5VAL := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','LSAI := (FTABELA("S010", 01, 05) = NIL)   .END.','000005','000000','.CON.','5','','','5','LSAI := (FTABELA("S010", 01, 05) = NIL)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','CMSGLOG := FMSGFORM({40}) + " S010 - " + FDESC("RCB", "S010"','000006','000005','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S010 - " + FDESC("RCB", "S010", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','S_MSGLOG()     .CNT.','000007','000005','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','FINALCALC()     .END.','000008','000005','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','!LSAI .AND. (LSAI := (FTABELA("S014", 01, 04) = NIL))   .E','000009','000000','.CON.','5','','','5','!LSAI .AND. (LSAI := (FTABELA("S014", 01, 04) = NIL))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014"','000010','000009','.EXE.','5','CMSGLOG := FMSGFORM({40}) + " S014 - " + FDESC("RCB", "S014", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','S_MSGLOG()     .CNT.','000011','000009','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','FINALCALC()     .END.','000012','000009','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','!LSAI   .END.','000013','000000','.CON.','5','','','5','!LSAI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NBASELIM := FTABELA("S014",1,4)     .CNT.','000014','000013','.EXE.','5','NBASELIM := FTABELA("S014",1,4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NPERCLIM := FTABELA("S010",1,5)     .CNT.','000015','000013','.EXE.','5','NPERCLIM := FTABELA("S010",1,5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NBSDESGR :=  ROUND(NBASELIM * NPERCLIM,2)     .CNT.','000016','000013','.EXE.','5','NBSDESGR :=  ROUND(NBASELIM * NPERCLIM,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','FO_GOTOP(@ORH5)     .CNT.','000017','000013','.EXE.','5','FO_GOTOP(@ORH5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','!FO_EOF(@ORH5)   .END.','000018','000013','.ENQ.','5','','','5','!FO_EOF(@ORH5)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NRH5ANO := FO_GETVAL(@ORH5, "RH5_ANO")     .CNT.','000019','000018','.EXE.','5','NRH5ANO := FO_GETVAL(@ORH5, "RH5_ANO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NRH5COD := FO_GETVAL(@ORH5, "RH5_CODIGO")     .CNT.','000020','000018','.EXE.','5','NRH5COD := FO_GETVAL(@ORH5, "RH5_CODIGO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NRH5VAL := FO_GETVAL(@ORH5, "RH5_VALOR")     .CNT.','000021','000018','.EXE.','5','NRH5VAL := FO_GETVAL(@ORH5, "RH5_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NRH5VAL > 0.00  .and.   NRH5ANO == STRZERO(Year(ddata_pgto','000022','000018','.CON.','5','','','5','NRH5VAL > 0.00  .and.   NRH5ANO == STRZERO(Year(ddata_pgto),4)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','LIF := ( NBSDESGR > 0 )   .END.','000023','000022','.CON.','5','','','5','LIF := ( NBSDESGR > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NGASTOSDE += NRH5VAL     .END.','000024','000023','.EXE.','5','NGASTOSDE += NRH5VAL','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','!LIF   .END.','000025','000022','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NTOTGAS := NRH5VAL     .CNT.','000026','000025','.EXE.','5','NTOTGAS := NRH5VAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NPOS := FPOSTAB("S019", NRH5COD, "=", 4)     .CNT.','000027','000025','.EXE.','5','NPOS := FPOSTAB("S019", NRH5COD, "=", 4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NLIMGAS := FTABELA("S019",NPOS,6)     .CNT.','000028','000025','.EXE.','5','NLIMGAS := FTABELA("S019",NPOS,6)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NLIMGAS > 0   .END.','000029','000025','.CON.','5','','','5','NLIMGAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NTOTGAS := ROUND(NBASELIM * NLIMGAS,2 )     .END.','000030','000029','.EXE.','5','NTOTGAS := ROUND(NBASELIM * NLIMGAS,2 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','NGASTOSDE += MIN(NRH5VAL,NTOTGAS)     .END.','000031','000025','.EXE.','5','NGASTOSDE += MIN(NRH5VAL,NTOTGAS)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGGAST','FO_SKIP(@ORH5)     .END.','000032','000018','.EXE.','5','FO_SKIP(@ORH5)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0047    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0047( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGPROJ','CARGA PROJECAO PARA IR','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGPROJ','NMESPROJ := (12 - Month(ddata_pgto) )     .CNT.','000001','000000','.EXE.','5','NMESPROJ := (12 - Month(ddata_pgto) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGPROJ','CTIPOROT = "4" .AND. NMESPROJ > 1   .END.','000002','000000','.CON.','5','','','5','CTIPOROT = "4" .AND. NMESPROJ > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGPROJ','NMESPROJ := 1     .END.','000003','000002','.EXE.','5','NMESPROJ := 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGPROJ','nPercIESS := FTABELA("S011",1,5)     .CNT.','000004','000000','.EXE.','5','nPercIESS := FTABELA("S011",1,5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGPROJ','nBsIRProj := 0.00     .CNT.','000005','000000','.EXE.','5','nBsIRProj := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGPROJ','NVIESSProj := 0.00     .CNT.','000006','000000','.EXE.','5','NVIESSProj := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGPROJ','cTipoRot <> "4"   .END.','000007','000000','.CON.','5','','','5','cTipoRot <> "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGPROJ','nBsIRPROJ := sra->ra_salario * nmesproj     .CNT.','000008','000007','.EXE.','5','nBsIRPROJ := sra->ra_salario * nmesproj','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGPROJ','nVIESSProj := round((nBsIRProj * nPercIESS) / 100, 2)     .E','000009','000007','.EXE.','5','nVIESSProj := round((nBsIRProj * nPercIESS) / 100, 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0048    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0048( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CHKFUNC','FAZ VERIFICACOES INICIAIS DO FUNCIONARIO','','','024','2','1',} )

aAdd(aRc3Cols, { '','S_','CHKFUNC','DDATA := IF(C__ROTEIRO="UTI",CTOD("31/12/"+PLRANO),DDATAATE)','000001','000000','.EXE.','5','DDATA := IF(C__ROTEIRO="UTI",CTOD("31/12/"+PLRANO),DDATAATE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','!FCHKFUNC(DDATA, CNUMPAG)   .END.','000002','000000','.CON.','5','','','5','!FCHKFUNC(DDATA, CNUMPAG)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','FinalFun()     .END.','000003','000002','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','CTIPOROT = "1"   .END.','000004','000000','.CON.','5','','','5','CTIPOROT = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','LCOND := !EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDA','000005','000004','.EXE.','5','LCOND := !EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDATADE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','CTIPOROT = "2"   .END.','000006','000000','.CON.','5','','','5','CTIPOROT = "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','LCOND := !EMPTY(SRA->RA_DEMISSA) .OR. (SRA->RA_TIPOPGT = "S"','000007','000006','.EXE.','5','LCOND := !EMPTY(SRA->RA_DEMISSA) .OR. (SRA->RA_TIPOPGT = "S") .OR. (SRA->RA_PERCADT <= 0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','CTIPOROT = "5"   .END.','000008','000000','.CON.','5','','','5','CTIPOROT = "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','LCOND := !EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDA','000009','000008','.EXE.','5','LCOND := !EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDATAATE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','CTIPOROT = "6"   .END.','000010','000000','.CON.','5','','','5','CTIPOROT = "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','LCOND := !EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDA','000011','000010','.EXE.','5','LCOND := !EMPTY(SRA->RA_DEMISSA) .AND. SRA->RA_DEMISSA < DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','LIF := (NTAB := FPOSTAB("S020", SRA->RA_REGIAO , "=" , 04','000012','000010','.CON.','5','','','5','LIF := (NTAB := FPOSTAB("S020", SRA->RA_REGIAO , "=" , 04 )) <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','LCOND := .T.     .END.','000013','000012','.EXE.','5','LCOND := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','!LIF   .END.','000014','000010','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','MESPAGO14 := FTABELA("S020", NTAB, 06)     .CNT.','000015','000014','.EXE.','5','MESPAGO14 := FTABELA("S020", NTAB, 06)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','LCOND := (MESPAGO14 != VAL(RIGHT(CANOMES,2)))     .END.','000016','000014','.EXE.','5','LCOND := (MESPAGO14 != VAL(RIGHT(CANOMES,2)))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','LCOND   .END.','000017','000000','.CON.','5','','','5','LCOND','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKFUNC','FINALFUN()     .END.','000018','000017','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0049    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0049( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','D13RES','13 SALARIO NA RESCISAO','','','048','2','1',} )

aAdd(aRc3Cols, { '','S_','D13RES','aAfast := {}     .CNT.','000001','000000','.EXE.','5','aAfast := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','aVerbas:= {}     .CNT.','000002','000000','.EXE.','5','aVerbas:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','aPerAb:= {}     .CNT.','000003','000000','.EXE.','5','aPerAb:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','aPerFech:= {}     .CNT.','000004','000000','.EXE.','5','aPerFech:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','aVerbasD13:= {}     .CNT.','000005','000000','.EXE.','5','aVerbasD13:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= CtoD("//")     .CNT.','000006','000000','.EXE.','5','dPerIni:= CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerFim:= CtoD("//")     .CNT.','000007','000000','.EXE.','5','dPerFim:= CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nPos:= 0     .CNT.','000008','000000','.EXE.','5','nPos:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nprv13dia := 0     .CNT.','000009','000000','.EXE.','5','nprv13dia := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAcu13Res:= 0     .CNT.','000010','000000','.EXE.','5','nAcu13Res:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAfasD13:= 0     .CNT.','000011','000000','.EXE.','5','nAfasD13:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res:= 0     .CNT.','000012','000000','.EXE.','5','nD13Res:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nPrv13Acu:= 0     .CNT.','000013','000000','.EXE.','5','nPrv13Acu:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DaTDem := iif (c__Roteiro == "PRV", SRA->RA_DEMISSA, dDataDe','000014','000000','.EXE.','5','DaTDem := iif (c__Roteiro == "PRV", SRA->RA_DEMISSA, dDataDem)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','cVerba13Sal:= ""     .CNT.','000015','000000','.EXE.','5','cVerba13Sal:= ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DtIni := CtoD("//")     .CNT.','000016','000000','.EXE.','5','DtIni := CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DtFim := CtoD("//")     .CNT.','000017','000000','.EXE.','5','DtFim := CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAfast := 0     .CNT.','000018','000000','.EXE.','5','nAfast := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nQtdDiaMes := 0     .CNT.','000019','000000','.EXE.','5','nQtdDiaMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','cTipoRot = "4"   .END.','000020','000000','.CON.','5','','','5','cTipoRot = "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','fTabela("S018", 01, 04) = Nil   .END.','000021','000020','.CON.','5','','','5','fTabela("S018", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018",','000022','000021','.EXE.','5','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','S_MSGLOG()     .CNT.','000023','000021','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','FINALFUN()     .END.','000024','000021','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nPos := fPosTab("S018", cTipRes, "==", 04)     .END.','000025','000020','.EXE.','5','nPos := fPosTab("S018", cTipRes, "==", 04)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','(nPos > 0 .And. fTabela("S018", nPos, 09) == "S") .Or. ( l','000026','000000','.CON.','5','','','5','(nPos > 0 .And. fTabela("S018", nPos, 09) == "S") .Or. ( lProv:= (c__Roteiro == "PRV") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','Se a rescisao for em dezembro, verifica se jah foi pago 13 s','000027','000026','.MSG.','5','Se a rescisao for em dezembro, verifica se jah foi pago 13 salario.','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','D13RES','lOK:= (Month(dDataRef) == 12)   .END.','000028','000026','.CON.','5','','','5','lOK:= (Month(dDataRef) == 12)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','!lProv   .END.','000029','000028','.CON.','5','','','5','!lProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataR','000030','000029','.EXE.','5','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataRef),4), Nil, SRA->RA_PROCES, Nil, @aPerAb, @aPerFech)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','aAdd(aVerbas, {fGetCodFol("0024")})     .CNT.','000031','000029','.EXE.','5','aAdd(aVerbas, {fGetCodFol("0024")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','aVerbasD13:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT,','000032','000029','.EXE.','5','aVerbasD13:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , aVerbas,  aPerAb, aPerFech )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','Se ainda nao foi pago 13 salario, paga tambem do periodo ant','000033','000029','.MSG.','5','Se ainda nao foi pago 13 salario, paga tambem do periodo anterior.','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','D13RES','!(len(aVerbasD13) >= 1 )   .END.','000034','000029','.CON.','5','','','5','!(len(aVerbasD13) >= 1 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= YearSub(dDataRef,1)     .CNT.','000035','000034','.EXE.','5','dPerIni:= YearSub(dDataRef,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= Max(dPerIni,SRA->RA_ADMISSA)     .CNT.','000036','000034','.EXE.','5','dPerIni:= Max(dPerIni,SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerFim:= (dDataRef - 1)     .CNT.','000037','000034','.EXE.','5','dPerFim:= (dDataRef - 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13:= ( dPerFim - dPerIni ) + 1     .CNT.','000038','000034','.EXE.','5','DiaAcu13:= ( dPerFim - dPerIni ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','fBuscaAcm(	Nil, "SRV->RV_MED13=='+"'"+'1'+"'"+'", dPerIni, dPerFim, "V",','000039','000034','.EXE.','5','fBuscaAcm(	Nil, "SRV->RV_MED13=='+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @TotAcu13, , , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','Calcula dias     .CNT.','000040','000034','.MSG.','5','Calcula dias','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 >= 360   .END.','000041','000034','.CON.','5','','','5','DiaAcu13 >= 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := 360     .END.','000042','000041','.EXE.','5','DiaAcu13 := 360','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 < 360   .END.','000043','000034','.CON.','5','','','5','DiaAcu13 < 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DPERINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(S','000044','000043','.CON.','5','','','5','MESANO(DPERINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(SRA->RA_ADMISSA)==MESANO(DaTDem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 :=(DaTDem - SRA->RA_ADMISSA) +1     .END.','000045','000044','.EXE.','5','DiaAcu13 :=(DaTDem - SRA->RA_ADMISSA) +1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DPERINI = SRA->RA_ADMISSA  .AND. MESANO(SRA->RA_ADMISSA) <','000046','000043','.CON.','5','','','5','DPERINI = SRA->RA_ADMISSA  .AND. MESANO(SRA->RA_ADMISSA) <> MESANO(DaTDem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := (30 - DAY(SRA->RA_ADMISSA)) + 1     .END.','000047','000046','.EXE.','5','DiaAcu13 := (30 - DAY(SRA->RA_ADMISSA)) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DPERINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(D','000048','000043','.CON.','5','','','5','MESANO(DPERINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(DPERINI) <> MESANO(DPERFIM) .AND. MESANO(DPERFIM) <> MESANO(DATDEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := 30     .END.','000049','000048','.EXE.','5','DiaAcu13 := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := 0     .CNT.','000050','000043','.EXE.','5','NDIAS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','NFRAC := F_ULTDIA(DPERINI)-DAY(DPERINI)     .CNT.','000051','000043','.EXE.','5','NFRAC := F_ULTDIA(DPERINI)-DAY(DPERINI)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DDATA := DPERINI + NFRAC     .CNT.','000052','000043','.EXE.','5','DDATA := DPERINI + NFRAC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DDATA) <= MESANO(DPERFIM)   .END.','000053','000043','.ENQ.','5','','','5','MESANO(DDATA) <= MESANO(DPERFIM)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','D13RES','DDATA := DDATA + 28     .CNT.','000054','000053','.EXE.','5','DDATA := DDATA + 28','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DDATA) <= MESANO(DPERFIM)   .END.','000055','000053','.CON.','5','','','5','MESANO(DDATA) <= MESANO(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := DiaAcu13 + 30     .CNT.','000056','000055','.EXE.','5','DiaAcu13 := DiaAcu13 + 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MONTH(DDATA) == MONTH(DPERFIM)   .END.','000057','000055','.CON.','5','','','5','MONTH(DDATA) == MONTH(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DAY(DPERFIM) < 30   .END.','000058','000057','.CON.','5','','','5','DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','month(dPerFim) = 2 .and.  DAY(DPERFIM) < 28   .END.','000059','000058','.CON.','5','','','5','month(dPerFim) = 2 .and.  DAY(DPERFIM) < 28','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000060','000059','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','month(dPerFim) <> 2 .and.  DAY(DPERFIM) < 30   .END.','000061','000058','.CON.','5','','','5','month(dPerFim) <> 2 .and.  DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000062','000061','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := DiaAcu13 - NDIAS     .END.','000063','000058','.EXE.','5','DiaAcu13 := DiaAcu13 - NDIAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','FBUSCAAFAST(DPERINI,DPERFIM,@AAFAST)     .CNT.','000064','000034','.EXE.','5','FBUSCAAFAST(DPERINI,DPERFIM,@AAFAST)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','LEN(AAFAST) > 0   .END.','000065','000034','.CON.','5','','','5','LEN(AAFAST) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','AEVAL( AAFAST, { |X| IIF( X[06]=="1" , @NAFASD13 += X[11] ,','000066','000065','.EXE.','5','AEVAL( AAFAST, { |X| IIF( X[06]=="1" , @NAFASD13 += X[11] , 0 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAfasD13:= Abs(nAfasD13)     .CNT.','000067','000034','.EXE.','5','nAfasD13:= Abs(nAfasD13)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13-= nAfasD13     .CNT.','000068','000034','.EXE.','5','DiaAcu13-= nAfasD13','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAfasD13:= 0     .END.','000069','000034','.EXE.','5','nAfasD13:= 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= dDataRef     .END.','000070','000029','.EXE.','5','dPerIni:= dDataRef','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','lProv   .END.','000071','000028','.CON.','5','','','5','lProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= dDataRef     .END.','000072','000071','.EXE.','5','dPerIni:= dDataRef','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','!lOK   .END.','000073','000026','.CON.','5','','','5','!lOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= CtoD("01/12/" + StrZero( Year(dDataRef) - 1, 4))','000074','000073','.EXE.','5','dPerIni:= CtoD("01/12/" + StrZero( Year(dDataRef) - 1, 4))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DAY(DDATAATE) = 31   .END.','000075','000026','.CON.','5','','','5','DAY(DDATAATE) = 31','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','dDataAte := dDataAte -1     .END.','000076','000075','.EXE.','5','dDataAte := dDataAte -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= Max(dPerIni,SRA->RA_ADMISSA)     .CNT.','000077','000026','.EXE.','5','dPerIni:= Max(dPerIni,SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerFim:= Iif(!lProv, SRA->RA_DEMISSA, dDataAte)     .CNT.','000078','000026','.EXE.','5','dPerFim:= Iif(!lProv, DaTDem, dDataAte)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','LPROV .AND. SRA->RA_SITFOLH == "D"   .END.','000079','000026','.CON.','5','','','5','LPROV .AND. SRA->RA_SITFOLH == "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DaTDem) == MESANO(DPERFIM)   .END.','000080','000079','.CON.','5','','','5','MESANO(DaTDem) == MESANO(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerfim := datdem     .END.','000081','000080','.EXE.','5','dPerfim := datdem','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','fBuscaAcm(	Nil, "SRV->RV_MED13=='+"'"+'1'+"'"+'", dPerIni, dPerFim, "V",','000082','000026','.EXE.','5','fBuscaAcm(	Nil, "SRV->RV_MED13=='+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @nAcu13Res, , , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAcu13Res+= fo_SomaIncSRV(@&cObjeto, CCPOVALOR, {"RV_MED13"}','000083','000026','.EXE.','5','nAcu13Res+= fo_SomaIncSRV(@&cObjeto, CCPOVALOR, {"RV_MED13"}, {"1"} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','calcula dias     .CNT.','000084','000026','.MSG.','5','calcula dias','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','D13RES','FBUSCAAFAST(DPERINI,DPERFIM,@AAFAST)     .CNT.','000085','000026','.EXE.','5','FBUSCAAFAST(DPERINI,DPERFIM,@AAFAST)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','LEN(AAFAST) > 0   .END.','000086','000026','.CON.','5','','','5','LEN(AAFAST) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','AEVAL( AAFAST, { |X| IIF( X[06]=="1" , @NAFASD13 += X[11] ,','000087','000086','.EXE.','5','AEVAL( AAFAST, { |X| IIF( X[06]=="1" , @NAFASD13 += X[11] , 0 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAfasD13:= Abs(nAfasD13)     .CNT.','000088','000026','.EXE.','5','nAfasD13:= Abs(nAfasD13)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res:= ( dPerFim - dPerIni ) + 1     .CNT.','000089','000026','.EXE.','5','nD13Res:= ( dPerFim - dPerIni ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res >= 360   .END.','000090','000026','.CON.','5','','','5','nD13Res >= 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res := 360     .END.','000091','000090','.EXE.','5','nD13Res := 360','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res < 360   .END.','000092','000026','.CON.','5','','','5','nD13Res < 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DPERINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(S','000093','000092','.CON.','5','','','5','MESANO(DPERINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(SRA->RA_ADMISSA)==MESANO(DaTDem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res :=(DaTDem - SRA->RA_ADMISSA) +1     .END.','000094','000093','.EXE.','5','nD13Res :=(DaTDem - SRA->RA_ADMISSA) +1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DPERINI <> SRA->RA_ADMISSA  .AND. MESANO(DaTDem) = MESANO(','000095','000092','.CON.','5','','','5','DPERINI <> SRA->RA_ADMISSA  .AND. MESANO(DaTDem) = MESANO(DPERINI)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','ND13RES := (DAY(DPERFIM) - 1) + 1     .END.','000096','000095','.EXE.','5','ND13RES := (DAY(DPERFIM) - 1) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DPERINI = SRA->RA_ADMISSA  .AND. MESANO(SRA->RA_ADMISSA) <','000097','000092','.CON.','5','','','5','DPERINI = SRA->RA_ADMISSA  .AND. MESANO(SRA->RA_ADMISSA) <> MESANO(DaTDem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res := (30 - DAY(SRA->RA_ADMISSA)) + 1     .END.','000098','000097','.EXE.','5','nD13Res := (30 - DAY(SRA->RA_ADMISSA)) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DPERINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(D','000099','000092','.CON.','5','','','5','MESANO(DPERINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(DPERINI) <> MESANO(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res := 30     .END.','000100','000099','.EXE.','5','nD13Res := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := 0     .CNT.','000101','000092','.EXE.','5','NDIAS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','NFRAC := F_ULTDIA(DPERINI)-DAY(DPERINI)     .CNT.','000102','000092','.EXE.','5','NFRAC := F_ULTDIA(DPERINI)-DAY(DPERINI)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DDATA := DPERINI + NFRAC     .CNT.','000103','000092','.EXE.','5','DDATA := DPERINI + NFRAC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DDATA) <= MESANO(DPERFIM)   .END.','000104','000092','.ENQ.','5','','','5','MESANO(DDATA) <= MESANO(DPERFIM)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','D13RES','DDATA := DDATA + 28     .CNT.','000105','000104','.EXE.','5','DDATA := DDATA + 28','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DDATA) <= MESANO(DPERFIM)   .END.','000106','000104','.CON.','5','','','5','MESANO(DDATA) <= MESANO(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res := nD13Res + 30     .CNT.','000107','000106','.EXE.','5','nD13Res := nD13Res + 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MONTH(DDATA) == MONTH(DPERFIM)   .END.','000108','000106','.CON.','5','','','5','MONTH(DDATA) == MONTH(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DAY(DPERFIM) < 30   .END.','000109','000108','.CON.','5','','','5','DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','month(dPerFim) = 2 .and.  DAY(DPERFIM) < 28   .END.','000110','000109','.CON.','5','','','5','month(dPerFim) = 2 .and.  DAY(DPERFIM) < 28','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000111','000110','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','month(dPerFim) <> 2 .and.  DAY(DPERFIM) < 30   .END.','000112','000109','.CON.','5','','','5','month(dPerFim) <> 2 .and.  DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000113','000112','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res := nD13Res - NDIAS     .END.','000114','000109','.EXE.','5','nD13Res := nD13Res - NDIAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res-= nAfasD13     .CNT.','000115','000026','.EXE.','5','nD13Res-= nAfasD13','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DtIni := MAX(DDATADE, SRA->RA_ADMISSA)     .CNT.','000116','000026','.EXE.','5','DtIni := MAX(DDATADE, SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','!Empty(SRA->RA_DEMISSA)   .END.','000117','000026','.CON.','5','','','5','!Empty(SRA->RA_DEMISSA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DtFim := MIN(DDATAATE, SRA->RA_DEMISSA)     .END.','000118','000117','.EXE.','5','DtFim := MIN(DDATAATE, SRA->RA_DEMISSA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','Empty(SRA->RA_DEMISSA)   .END.','000119','000026','.CON.','5','','','5','Empty(SRA->RA_DEMISSA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DtFim := DDATAATE     .END.','000120','000119','.EXE.','5','DtFim := DDATAATE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nQtdDiaMes := (DtFim - DtIni) + 1     .CNT.','000121','000026','.EXE.','5','nQtdDiaMes := (DtFim - DtIni) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','FBUSCAAFAST(DtIni, DtFim, @AAFAST)     .CNT.','000122','000026','.EXE.','5','FBUSCAAFAST(DtIni, DtFim, @AAFAST)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','LEN(AAFAST) > 0   .END.','000123','000026','.CON.','5','','','5','LEN(AAFAST) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','AEVAL( AAFAST, { |X| IIF( X[06]=="1" , @nAfast += X[11] , 0','000124','000123','.EXE.','5','AEVAL( AAFAST, { |X| IIF( X[06]=="1" , @nAfast += X[11] , 0 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','NPRV13DIA := (nQtdDiaMes - nAfast)     .CNT.','000125','000026','.EXE.','5','NPRV13DIA := (nQtdDiaMes - nAfast)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','lProv   .END.','000126','000026','.CON.','5','','','5','lProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','cVerba13Sal:= fGetCodFol("1214")     .CNT.','000127','000126','.EXE.','5','cVerba13Sal:= fGetCodFol("1214")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','fBuscaAcm( cVerba13Sal, , dPerIni, dPerFim, "V", @nPrv13Acu,','000128','000126','.EXE.','5','fBuscaAcm( cVerba13Sal, , dPerIni, dPerFim, "V", @nPrv13Acu, , , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nPrv13Ano:=  ( nAcu13Res / 12 )     .CNT.','000129','000126','.EXE.','5','nPrv13Ano:=  ( nAcu13Res / 12 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nPrv13Mes:= nPrv13Ano   - nPrv13Acu     .CNT.','000130','000126','.EXE.','5','nPrv13Mes:= nPrv13Ano   - nPrv13Acu','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MONTH(DDATAREF) = 12   .END.','000131','000126','.CON.','5','','','5','MONTH(DDATAREF) = 12','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataR','000132','000131','.EXE.','5','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataRef),4), Nil, SRA->RA_PROCES, Nil, @aPerAb, @aPerFech)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','aAdd(aVerbas, {fGetCodFol("0024")})     .CNT.','000133','000131','.EXE.','5','aAdd(aVerbas, {fGetCodFol("0024")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','aVerbasD13:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT,','000134','000131','.EXE.','5','aVerbasD13:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , aVerbas,  aPerAb, aPerFech )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','len(aVerbasD13) >= 1   .END.','000135','000131','.CON.','5','','','5','len(aVerbasD13) >= 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= YearSub(dDataRef,1)     .CNT.','000136','000135','.EXE.','5','dPerIni:= YearSub(dDataRef,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res := 30     .CNT.','000137','000135','.EXE.','5','nD13Res := 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerIni:= Max(dPerIni,SRA->RA_ADMISSA)     .CNT.','000138','000135','.EXE.','5','dPerIni:= Max(dPerIni,SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','dPerFim:= (dDataRef - 1)     .CNT.','000139','000135','.EXE.','5','dPerFim:= (dDataRef - 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13:= ( dPerFim - dPerIni ) + 1     .CNT.','000140','000135','.EXE.','5','DiaAcu13:= ( dPerFim - dPerIni ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','fBuscaAcm(	Nil, "SRV->RV_MED13=='+"'"+'1'+"'"+'", dPerIni, dPerFim, "V",','000141','000135','.EXE.','5','fBuscaAcm(	Nil, "SRV->RV_MED13=='+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @TotAcu13, , , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','Calcula dias     .CNT.','000142','000135','.MSG.','5','Calcula dias','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 >= 360   .END.','000143','000135','.CON.','5','','','5','DiaAcu13 >= 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := 360     .END.','000144','000143','.EXE.','5','DiaAcu13 := 360','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 < 360   .END.','000145','000135','.CON.','5','','','5','DiaAcu13 < 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DPERINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(S','000146','000145','.CON.','5','','','5','MESANO(DPERINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(SRA->RA_ADMISSA)==MESANO(DaTDem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 :=(DaTDem - SRA->RA_ADMISSA) +1     .END.','000147','000146','.EXE.','5','DiaAcu13 :=(DaTDem - SRA->RA_ADMISSA) +1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DPERINI = SRA->RA_ADMISSA  .AND. MESANO(SRA->RA_ADMISSA) <','000148','000145','.CON.','5','','','5','DPERINI = SRA->RA_ADMISSA  .AND. MESANO(SRA->RA_ADMISSA) <> MESANO(DaTDem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := (30 - DAY(SRA->RA_ADMISSA)) + 1     .END.','000149','000148','.EXE.','5','DiaAcu13 := (30 - DAY(SRA->RA_ADMISSA)) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DPERINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(D','000150','000145','.CON.','5','','','5','MESANO(DPERINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(DPERINI) <> MESANO(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := 30     .END.','000151','000150','.EXE.','5','DiaAcu13 := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := 0     .CNT.','000152','000145','.EXE.','5','NDIAS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','NFRAC := F_ULTDIA(DPERINI)-DAY(DPERINI)     .CNT.','000153','000145','.EXE.','5','NFRAC := F_ULTDIA(DPERINI)-DAY(DPERINI)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DDATA := DPERINI + NFRAC     .CNT.','000154','000145','.EXE.','5','DDATA := DPERINI + NFRAC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DDATA) <= MESANO(DPERFIM)   .END.','000155','000145','.ENQ.','5','','','5','MESANO(DDATA) <= MESANO(DPERFIM)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','D13RES','DDATA := DDATA + 28     .CNT.','000156','000155','.EXE.','5','DDATA := DDATA + 28','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MESANO(DDATA) <= MESANO(DPERFIM)   .END.','000157','000155','.CON.','5','','','5','MESANO(DDATA) <= MESANO(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := DiaAcu13 + 30     .CNT.','000158','000157','.EXE.','5','DiaAcu13 := DiaAcu13 + 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','MONTH(DDATA) == MONTH(DPERFIM)   .END.','000159','000157','.CON.','5','','','5','MONTH(DDATA) == MONTH(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','DAY(DPERFIM) < 30   .END.','000160','000159','.CON.','5','','','5','DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','month(dPerFim) = 2 .and.  DAY(DPERFIM) < 28   .END.','000161','000160','.CON.','5','','','5','month(dPerFim) = 2 .and.  DAY(DPERFIM) < 28','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000162','000161','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','month(dPerFim) <> 2 .and.  DAY(DPERFIM) < 30   .END.','000163','000160','.CON.','5','','','5','month(dPerFim) <> 2 .and.  DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000164','000163','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13 := DiaAcu13 - NDIAS     .END.','000165','000160','.EXE.','5','DiaAcu13 := DiaAcu13 - NDIAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','FBUSCAAFAST(DPERINI,DPERFIM,@AAFAST)     .CNT.','000166','000135','.EXE.','5','FBUSCAAFAST(DPERINI,DPERFIM,@AAFAST)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','LEN(AAFAST) > 0   .END.','000167','000135','.CON.','5','','','5','LEN(AAFAST) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D13RES','AEVAL( AAFAST, { |X| IIF( X[06]=="1" , @NAFASD13 += X[11] ,','000168','000167','.EXE.','5','AEVAL( AAFAST, { |X| IIF( X[06]=="1" , @NAFASD13 += X[11] , 0 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAfasD13:= Abs(nAfasD13)     .CNT.','000169','000135','.EXE.','5','nAfasD13:= Abs(nAfasD13)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','DiaAcu13-= nAfasD13     .CNT.','000170','000135','.EXE.','5','DiaAcu13-= nAfasD13','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nAfasD13:= 0     .CNT.','000171','000135','.EXE.','5','nAfasD13:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nPrv13Ano +=  ( TotAcu13 / 12 )     .CNT.','000172','000135','.EXE.','5','nPrv13Ano +=  ( TotAcu13 / 12 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D13RES','nD13Res += DiaAcu13     .END.','000173','000135','.EXE.','5','nD13Res += DiaAcu13','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0050    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0050( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','D14RES','14 SALARIO NA RESCISAO','','','045','2','1',} )

aAdd(aRc3Cols, { '','S_','D14RES','aPerAb:= {}     .CNT.','000001','000000','.EXE.','5','aPerAb:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','ndias := 0     .CNT.','000002','000000','.EXE.','5','ndias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aPerFech:= {}     .CNT.','000003','000000','.EXE.','5','aPerFech:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aVerbas:= {}     .CNT.','000004','000000','.EXE.','5','aVerbas:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aVerbasD14:= {}     .CNT.','000005','000000','.EXE.','5','aVerbasD14:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aAfast:= {}     .CNT.','000006','000000','.EXE.','5','aAfast:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DaTDem := iif (c__Roteiro == "PRV", SRA->RA_DEMISSA, dDataDe','000007','000000','.EXE.','5','DaTDem := iif (c__Roteiro == "PRV", SRA->RA_DEMISSA, dDataDem)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','cVrbAfast:= ""     .CNT.','000008','000000','.EXE.','5','cVrbAfast:= ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','NPRV14DIA := 0     .CNT.','000009','000000','.EXE.','5','NPRV14DIA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','cVerba14Sal:= ""     .CNT.','000010','000000','.EXE.','5','cVerba14Sal:= ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nPos:= 0     .CNT.','000011','000000','.EXE.','5','nPos:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nAfasD14:= 0     .CNT.','000012','000000','.EXE.','5','nAfasD14:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := 0     .CNT.','000013','000000','.EXE.','5','DiaAcu14 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nVal14Res:= 0     .CNT.','000014','000000','.EXE.','5','nVal14Res:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nD14Res:= 0     .CNT.','000015','000000','.EXE.','5','nD14Res:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nPrv14Acu:= 0     .CNT.','000016','000000','.EXE.','5','nPrv14Acu:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= CtoD("//")     .CNT.','000017','000000','.EXE.','5','dDataIni:= CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','dPerFim := CtoD("//")     .CNT.','000018','000000','.EXE.','5','dPerFim := CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','cTipoRot = "4"   .END.','000019','000000','.CON.','5','','','5','cTipoRot = "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','fTabela("S018", 01, 04) = Nil   .END.','000020','000019','.CON.','5','','','5','fTabela("S018", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018",','000021','000020','.EXE.','5','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','S_MSGLOG()     .CNT.','000022','000020','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','FINALFUN()     .END.','000023','000020','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nPos := fPosTab("S018", cTipRes, "==", 04)     .END.','000024','000019','.EXE.','5','nPos := fPosTab("S018", cTipRes, "==", 04)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','fTabela("S006", 01, 04) = Nil   .END.','000025','000000','.CON.','5','','','5','fTabela("S006", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','cMsgLog := fMsgForm({40}) + "S006 - " + fDesc("RCB", "S006",','000026','000025','.EXE.','5','cMsgLog := fMsgForm({40}) + "S006 - " + fDesc("RCB", "S006", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','S_MSGLOG()     .CNT.','000027','000025','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','FINALCALC()     .END.','000028','000025','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','fTabela("S020", 01, 04) = Nil   .END.','000029','000000','.CON.','5','','','5','fTabela("S020", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','cMsgLog := fMsgForm({40}) + "S020 - " + fDesc("RCB", "S020",','000030','000029','.EXE.','5','cMsgLog := fMsgForm({40}) + "S020 - " + fDesc("RCB", "S020", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','S_MSGLOG()     .CNT.','000031','000029','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','FINALFUN()     .END.','000032','000029','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nPosPg := fPosTab("S020", SRA->RA_REGIAO , "=" , 04 )     .C','000033','000000','.EXE.','5','nPosPg := fPosTab("S020", SRA->RA_REGIAO , "=" , 04 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nPosPg > 0 .And. ( ( lProv:= (c__Roteiro == "PRV")) .Or. (','000034','000000','.CON.','5','','','5','nPosPg > 0 .And. ( ( lProv:= (c__Roteiro == "PRV")) .Or. ( nPos > 0 .And. fTabela("S018", nPos, 10) == "S"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','nMesPago:= fTabela("S020", nPosPg, 06)     .CNT.','000035','000034','.EXE.','5','nMesPago:= fTabela("S020", nPosPg, 06)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nBaseD14 := fTabela("S006", 01, 04)     .CNT.','000036','000034','.EXE.','5','nBaseD14 := fTabela("S006", 01, 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','Se a rescisao eh no mesmo mes de pagamento de 14 salario, ve','000037','000034','.MSG.','5','Se a rescisao eh no mesmo mes de pagamento de 14 salario, verifica se o roteiro de D14 já foi processado (14 salário ja foi pago) ou não.','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','D14RES','lOK:= (Month(dDataRef) == nMesPago)   .END.','000038','000034','.CON.','5','','','5','lOK:= (Month(dDataRef) == nMesPago)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','!lProv   .END.','000039','000038','.CON.','5','','','5','!lProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataR','000040','000039','.EXE.','5','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataRef),4), Nil, SRA->RA_PROCES, NIL, @aPerAb, @aPerFech)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aAdd(aVerbas, {fGetCodFol("1190")})     .CNT.','000041','000039','.EXE.','5','aAdd(aVerbas, {fGetCodFol("1190")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aVerbasD14:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT,','000042','000039','.EXE.','5','aVerbasD14:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , aVerbas,  aPerAb, aPerFech )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','lPago:= (len(aVerbasD14) < 1)   .END.','000043','000039','.CON.','5','','','5','lPago:= (len(aVerbasD14) < 1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','fRetPerComp( StrZero(Month(dDataRef - 1 ),2), StrZero(Year(d','000044','000043','.EXE.','5','fRetPerComp( StrZero(Month(dDataRef - 1 ),2), StrZero(Year(dDataRef),4), Nil, SRA->RA_PROCES, NIL, @aPerAb, @aPerFech)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aVerbasD14:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT,','000045','000043','.EXE.','5','aVerbasD14:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , aVerbas,  aPerAb, aPerFech )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','lPago:= (len(aVerbasD14) >= 1)   .END.','000046','000039','.CON.','5','','','5','lPago:= (len(aVerbasD14) >= 1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= dDataRef     .END.','000047','000046','.EXE.','5','dDataIni:= dDataRef','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','!lPago   .END.','000048','000039','.CON.','5','','','5','!lPago','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= YearSub(dDataRef, 1)     .CNT.','000049','000048','.EXE.','5','dDataIni:= YearSub(dDataRef, 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= MAX(dDataIni,SRA->RA_ADMISSA)     .CNT.','000050','000048','.EXE.','5','dDataIni:= MAX(dDataIni,SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','dPerFim := dDataRef - 1     .CNT.','000051','000048','.EXE.','5','dPerFim := dDataRef - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := ( dPerFim - dDataIni ) + 1     .CNT.','000052','000048','.EXE.','5','DiaAcu14 := ( dPerFim - dDataIni ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 >= 360   .END.','000053','000048','.CON.','5','','','5','DiaAcu14 >= 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := 360     .END.','000054','000053','.EXE.','5','DiaAcu14 := 360','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 < 360   .END.','000055','000048','.CON.','5','','','5','DiaAcu14 < 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATAINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(','000056','000055','.CON.','5','','','5','MESANO(DDATAINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(SRA->RA_ADMISSA)==MESANO(DATDEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := (DATDEM - SRA->RA_ADMISSA) +1     .END.','000057','000056','.EXE.','5','DiaAcu14 := (DATDEM - SRA->RA_ADMISSA) +1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','ddataini = Sra->Ra_admissa  .and. mesano(SRA->RA_ADMISSA)','000058','000055','.CON.','5','','','5','ddataini = Sra->Ra_admissa  .and. mesano(SRA->RA_ADMISSA) <> mesano(DATDEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := (30 - Day(sra->Ra_admissa)) + 1     .END.','000059','000058','.EXE.','5','DiaAcu14 := (30 - Day(sra->Ra_admissa)) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATAINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(','000060','000055','.CON.','5','','','5','MESANO(DDATAINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(DDATAINI) <> MESANO(DPERFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := 30     .END.','000061','000060','.EXE.','5','DiaAcu14 := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','NFRAC := F_ULTDIA(DDATAINI)-DAY(DDATAINI)     .CNT.','000062','000055','.EXE.','5','NFRAC := F_ULTDIA(DDATAINI)-DAY(DDATAINI)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DDATA := DDATAINI + NFRAC     .CNT.','000063','000055','.EXE.','5','DDATA := DDATAINI + NFRAC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATA) <= MESANO(Dperfim)   .END.','000064','000055','.ENQ.','5','','','5','MESANO(DDATA) <= MESANO(Dperfim)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','D14RES','DDATA := DDATA + 28     .CNT.','000065','000064','.EXE.','5','DDATA := DDATA + 28','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATA) <= MESANO(DPerFim)   .END.','000066','000064','.CON.','5','','','5','MESANO(DDATA) <= MESANO(DPerFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := DiaAcu14 + 30     .CNT.','000067','000066','.EXE.','5','DiaAcu14 := DiaAcu14 + 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','Month(ddata) == Month(dPerFim)   .END.','000068','000066','.CON.','5','','','5','Month(ddata) == Month(dPerFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','day(DPERFIM) < 30   .END.','000069','000068','.CON.','5','','','5','day(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','MONTH(DPERFIM) = 2 .AND.  DAY(DPERFIM) < 28   .END.','000070','000069','.CON.','5','','','5','MONTH(DPERFIM) = 2 .AND.  DAY(DPERFIM) < 28','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000071','000070','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MONTH(DPERFIM) <> 2 .AND.  DAY(DPERFIM) < 30   .END.','000072','000069','.CON.','5','','','5','MONTH(DPERFIM) <> 2 .AND.  DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000073','000072','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := DiaAcu14 - ndias     .END.','000074','000069','.EXE.','5','DiaAcu14 := DiaAcu14 - ndias','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','fo_GoTop(@oRCM)     .CNT.','000075','000055','.EXE.','5','fo_GoTop(@oRCM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','!(fo_Eof(@oRCM))   .END.','000076','000055','.ENQ.','5','','','5','!(fo_Eof(@oRCM))','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','D14RES','fo_GetVal(@oRCM,"RCM_CUARTA") == "1"   .END.','000077','000076','.CON.','5','','','5','fo_GetVal(@oRCM,"RCM_CUARTA") == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','cVrbAfast += fo_GetVal(@oRCM,"RCM_PD") + "/"     .END.','000078','000077','.EXE.','5','cVrbAfast += fo_GetVal(@oRCM,"RCM_PD") + "/"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','fo_Skip(@oRCM)     .END.','000079','000076','.EXE.','5','fo_Skip(@oRCM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','fBuscaAcm( cVrbAfast, , dDataIni, dPerFim, "H"	, , @nAfasD14','000080','000055','.EXE.','5','fBuscaAcm( cVrbAfast, , dDataIni, dPerFim, "H"	, , @nAfasD14, , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nAfasD14+= fo_SomaIncSRV(@&cObjeto, cCpoHoras, {"RV_COD"}, {','000081','000055','.EXE.','5','nAfasD14+= fo_SomaIncSRV(@&cObjeto, cCpoHoras, {"RV_COD"}, {cVrbAfast} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nAfasD14:= Abs(nAfasD14)     .CNT.','000082','000055','.EXE.','5','nAfasD14:= Abs(nAfasD14)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 -= nAfasD14     .CNT.','000083','000055','.EXE.','5','DiaAcu14 -= nAfasD14','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','TotAcu14:= ROUND((nBaseD14 / 360) * Diaacu14 ,2)     .END.','000084','000055','.EXE.','5','TotAcu14:= ROUND((nBaseD14 / 360) * Diaacu14 ,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DdataINI:= DDATAREF     .END.','000085','000039','.EXE.','5','DdataINI:= DDATAREF','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','lProv   .END.','000086','000038','.CON.','5','','','5','lProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= dDataRef     .END.','000087','000086','.EXE.','5','dDataIni:= dDataRef','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','!lOK   .END.','000088','000034','.CON.','5','','','5','!lOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','lOk2:= (Month(dDataRef) < nMesPago)   .END.','000089','000088','.CON.','5','','','5','lOk2:= (Month(dDataRef) < nMesPago)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:=  CtoD("01/" + StrZero(nMesPago, 2) + "/" + StrZer','000090','000089','.EXE.','5','dDataIni:=  CtoD("01/" + StrZero(nMesPago, 2) + "/" + StrZero((Year(dDataRef) - 1), 4) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','!lOK2   .END.','000091','000088','.CON.','5','','','5','!lOK2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:=  CtoD("01/" + StrZero(nMesPago, 2) + "/" + StrZer','000092','000091','.EXE.','5','dDataIni:=  CtoD("01/" + StrZero(nMesPago, 2) + "/" + StrZero(Year(dDataRef), 4) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= MAX(dDataIni,SRA->RA_ADMISSA)     .CNT.','000093','000034','.EXE.','5','dDataIni:= MAX(dDataIni,SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','Calcula dias trabalhados     .CNT.','000094','000034','.MSG.','5','Calcula dias trabalhados','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','D14RES','fo_GoTop(@oRCM)     .CNT.','000095','000034','.EXE.','5','fo_GoTop(@oRCM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','!(fo_Eof(@oRCM))   .END.','000096','000034','.ENQ.','5','','','5','!(fo_Eof(@oRCM))','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','D14RES','fo_GetVal(@oRCM,"RCM_CUARTA") == "1"   .END.','000097','000096','.CON.','5','','','5','fo_GetVal(@oRCM,"RCM_CUARTA") == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','cVrbAfast += fo_GetVal(@oRCM,"RCM_PD") + "/"     .END.','000098','000097','.EXE.','5','cVrbAfast += fo_GetVal(@oRCM,"RCM_PD") + "/"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','fo_Skip(@oRCM)     .END.','000099','000096','.EXE.','5','fo_Skip(@oRCM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','day(ddataate) = 31   .END.','000100','000034','.CON.','5','','','5','day(ddataate) = 31','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataate := DdataAte - 1     .END.','000101','000100','.EXE.','5','dDataate := DdataAte - 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','dPerFim:= Iif(!lProv, DATDEM, dDataAte)     .CNT.','000102','000034','.EXE.','5','dPerFim:= Iif(!lProv, DATDEM, dDataAte)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','lProv .and. SRA->RA_SITFOLH == "D"   .END.','000103','000034','.CON.','5','','','5','lProv .and. SRA->RA_SITFOLH == "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DATDEM) == MESANO(dPerFim)   .END.','000104','000103','.CON.','5','','','5','MESANO(DATDEM) == MESANO(dPerFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dPerFim := DATDEM     .END.','000105','000104','.EXE.','5','dPerFim := DATDEM','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nD14Res:= ( dPerFim - dDataIni ) + 1     .CNT.','000106','000034','.EXE.','5','nD14Res:= ( dPerFim - dDataIni ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','ND14RES >= 360   .END.','000107','000034','.CON.','5','','','5','ND14RES >= 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','ND14RES := 360     .END.','000108','000107','.EXE.','5','ND14RES := 360','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','ND14RES < 360   .END.','000109','000034','.CON.','5','','','5','ND14RES < 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATAINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(','000110','000109','.CON.','5','','','5','MESANO(DDATAINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(SRA->RA_ADMISSA)==MESANO(DATDEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','ND14RES := (DATDEM - SRA->RA_ADMISSA) +1     .END.','000111','000110','.EXE.','5','ND14RES := (DATDEM - SRA->RA_ADMISSA) +1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','ddataini <> Sra->Ra_admissa  .and. mesano(DATDEM) = mesano','000112','000109','.CON.','5','','','5','ddataini <> Sra->Ra_admissa  .and. mesano(DATDEM) = mesano(ddataini)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','nD14res := (Day(dPerFim) - 1) + 1     .END.','000113','000112','.EXE.','5','nD14res := (Day(dPerFim) - 1) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','ddataini = Sra->Ra_admissa  .and. mesano(SRA->RA_ADMISSA)','000114','000109','.CON.','5','','','5','ddataini = Sra->Ra_admissa  .and. mesano(SRA->RA_ADMISSA) <> mesano(DATDEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','nD14res := (30 - Day(sra->Ra_admissa)) + 1     .END.','000115','000114','.EXE.','5','nD14res := (30 - Day(sra->Ra_admissa)) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATAINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(','000116','000109','.CON.','5','','','5','MESANO(DDATAINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(DATDEM) <> MESANO(Ddataini)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','ND14RES := 30     .END.','000117','000116','.EXE.','5','ND14RES := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','NFRAC := F_ULTDIA(DDATAINI)-DAY(DDATAINI)     .CNT.','000118','000109','.EXE.','5','NFRAC := F_ULTDIA(DDATAINI)-DAY(DDATAINI)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DDATA := DDATAINI + NFRAC     .CNT.','000119','000109','.EXE.','5','DDATA := DDATAINI + NFRAC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATA) <= MESANO(Dperfim)   .END.','000120','000109','.ENQ.','5','','','5','MESANO(DDATA) <= MESANO(Dperfim)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','D14RES','DDATA := DDATA + 28     .CNT.','000121','000120','.EXE.','5','DDATA := DDATA + 28','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATA) <= MESANO(DPerFim)   .END.','000122','000120','.CON.','5','','','5','MESANO(DDATA) <= MESANO(DPerFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','nd14res := nd14res + 30     .END.','000123','000122','.EXE.','5','nd14res := nd14res + 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','Month(ddata) == Month(dPerFim)   .END.','000124','000122','.CON.','5','','','5','Month(ddata) == Month(dPerFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','day(DPERFIM) < 30   .END.','000125','000124','.CON.','5','','','5','day(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','MONTH(DPERFIM) = 2 .AND.  DAY(DPERFIM) < 28   .END.','000126','000125','.CON.','5','','','5','MONTH(DPERFIM) = 2 .AND.  DAY(DPERFIM) < 28','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000127','000126','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MONTH(DPERFIM) <> 2 .AND.  DAY(DPERFIM) < 30   .END.','000128','000125','.CON.','5','','','5','MONTH(DPERFIM) <> 2 .AND.  DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000129','000128','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','ND14RES := ND14RES - ndias     .END.','000130','000125','.EXE.','5','ND14RES := ND14RES - ndias','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','fBuscaAcm( cVrbAfast, , dDataIni, dPerFim, "H"	, , @nAfasD14','000131','000034','.EXE.','5','fBuscaAcm( cVrbAfast, , dDataIni, dPerFim, "H"	, , @nAfasD14, , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nAfasD14+= fo_SomaIncSRV(@&cObjeto, cCpoHoras, {"RV_COD"}, {','000132','000034','.EXE.','5','nAfasD14+= fo_SomaIncSRV(@&cObjeto, cCpoHoras, {"RV_COD"}, {cVrbAfast} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nAfasD14:= Abs(nAfasD14)     .CNT.','000133','000034','.EXE.','5','nAfasD14:= Abs(nAfasD14)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nD14Res-= nAfasD14     .CNT.','000134','000034','.EXE.','5','nD14Res-= nAfasD14','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','NPRV14DIA := ND14RES     .CNT.','000135','000034','.EXE.','5','NPRV14DIA := ND14RES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nVal14Res := ROUND((nBaseD14 / 360) * nD14Res,2)     .CNT.','000136','000034','.EXE.','5','nVal14Res := ROUND((nBaseD14 / 360) * nD14Res,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','lProv   .END.','000137','000034','.CON.','5','','','5','lProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','cVerba14Sal:= fGetCodFol("1216")     .CNT.','000138','000137','.EXE.','5','cVerba14Sal:= fGetCodFol("1216")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','fBuscaAcm( cVerba14Sal, , dDataIni, dPerFim, "V", @nPrv14Acu','000139','000137','.EXE.','5','fBuscaAcm( cVerba14Sal, , dDataIni, dPerFim, "V", @nPrv14Acu, , , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nPrv14Ano:= nVal14Res     .CNT.','000140','000137','.EXE.','5','nPrv14Ano:= nVal14Res','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nPrv14Mes:= nPrv14Ano - nPrv14Acu     .CNT.','000141','000137','.EXE.','5','nPrv14Mes:= nPrv14Ano - nPrv14Acu','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','Month(dDataRef) == nMesPago   .END.','000142','000137','.CON.','5','','','5','Month(dDataRef) == nMesPago','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataR','000143','000142','.EXE.','5','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataRef),4), Nil, SRA->RA_PROCES, NIL, @aPerAb, @aPerFech)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aAdd(aVerbas, {fGetCodFol("1190")})     .CNT.','000144','000142','.EXE.','5','aAdd(aVerbas, {fGetCodFol("1190")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aVerbasD14:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT,','000145','000142','.EXE.','5','aVerbasD14:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , aVerbas,  aPerAb, aPerFech )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','lPago:= (len(aVerbasD14) < 1)   .END.','000146','000142','.CON.','5','','','5','lPago:= (len(aVerbasD14) < 1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','fRetPerComp( StrZero(Month(dDataRef - 1 ),2), StrZero(Year(d','000147','000146','.EXE.','5','fRetPerComp( StrZero(Month(dDataRef - 1 ),2), StrZero(Year(dDataRef),4), Nil, SRA->RA_PROCES, NIL, @aPerAb, @aPerFech)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','aVerbasD14:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT,','000148','000146','.EXE.','5','aVerbasD14:= RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT, SRA->RA_CC, , aVerbas,  aPerAb, aPerFech )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','lPago:= (len(aVerbasD14) >= 1)   .END.','000149','000142','.CON.','5','','','5','lPago:= (len(aVerbasD14) >= 1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= dDataRef     .END.','000150','000149','.EXE.','5','dDataIni:= dDataRef','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','lPago   .END.','000151','000142','.CON.','5','','','5','lPago','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= YearSub(dDataRef, 1)     .CNT.','000152','000151','.EXE.','5','dDataIni:= YearSub(dDataRef, 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','dDataIni:= MAX(dDataIni,SRA->RA_ADMISSA)     .CNT.','000153','000151','.EXE.','5','dDataIni:= MAX(dDataIni,SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := ( dPerFim - dDataIni ) + 1     .CNT.','000154','000151','.EXE.','5','DiaAcu14 := ( dPerFim - dDataIni ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 >= 360   .END.','000155','000151','.CON.','5','','','5','DiaAcu14 >= 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := 360     .END.','000156','000155','.EXE.','5','DiaAcu14 := 360','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 < 360   .END.','000157','000151','.CON.','5','','','5','DiaAcu14 < 360','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATAINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(','000158','000157','.CON.','5','','','5','MESANO(DDATAINI) ==  MESANO(SRA->RA_ADMISSA) .AND. MESANO(SRA->RA_ADMISSA)==MESANO(DATDEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := (DATDEM- SRA->RA_ADMISSA) +1     .END.','000159','000158','.EXE.','5','DiaAcu14 := (DATDEM- SRA->RA_ADMISSA) +1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','ddataini = Sra->Ra_admissa  .and. mesano(SRA->RA_ADMISSA)','000160','000157','.CON.','5','','','5','ddataini = Sra->Ra_admissa  .and. mesano(SRA->RA_ADMISSA) <> mesano(DATDEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := (30 - Day(sra->Ra_admissa)) + 1     .END.','000161','000160','.EXE.','5','DiaAcu14 := (30 - Day(sra->Ra_admissa)) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATAINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(','000162','000157','.CON.','5','','','5','MESANO(DDATAINI) <>  MESANO(SRA->RA_ADMISSA) .AND. MESANO(DATDEM) <> MESANO(Ddataini)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := 30     .END.','000163','000162','.EXE.','5','DiaAcu14 := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','NFRAC := F_ULTDIA(DDATAINI)-DAY(DDATAINI)     .CNT.','000164','000157','.EXE.','5','NFRAC := F_ULTDIA(DDATAINI)-DAY(DDATAINI)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DDATA := DDATAINI + NFRAC     .CNT.','000165','000157','.EXE.','5','DDATA := DDATAINI + NFRAC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATA) <= MESANO(Dperfim)   .END.','000166','000157','.ENQ.','5','','','5','MESANO(DDATA) <= MESANO(Dperfim)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','D14RES','DDATA := DDATA + 28     .CNT.','000167','000166','.EXE.','5','DDATA := DDATA + 28','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MESANO(DDATA) <= MESANO(DPerFim)   .END.','000168','000166','.CON.','5','','','5','MESANO(DDATA) <= MESANO(DPerFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := DiaAcu14 + 30     .CNT.','000169','000168','.EXE.','5','DiaAcu14 := DiaAcu14 + 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','Month(ddata) == Month(dPerFim)   .END.','000170','000168','.CON.','5','','','5','Month(ddata) == Month(dPerFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','day(DPERFIM) < 30   .END.','000171','000170','.CON.','5','','','5','day(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','MONTH(DPERFIM) = 2 .AND.  DAY(DPERFIM) < 28   .END.','000172','000171','.CON.','5','','','5','MONTH(DPERFIM) = 2 .AND.  DAY(DPERFIM) < 28','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000173','000172','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','MONTH(DPERFIM) <> 2 .AND.  DAY(DPERFIM) < 30   .END.','000174','000171','.CON.','5','','','5','MONTH(DPERFIM) <> 2 .AND.  DAY(DPERFIM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','D14RES','NDIAS := (30 - DAY(DPERFIM))     .END.','000175','000174','.EXE.','5','NDIAS := (30 - DAY(DPERFIM))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','DiaAcu14 := DiaAcu14 - ndias     .CNT.','000176','000157','.EXE.','5','DiaAcu14 := DiaAcu14 - ndias','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nD14Res +=DiaAcu14     .CNT.','000177','000157','.EXE.','5','nD14Res +=DiaAcu14','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nVal14Res := ROUND((nBaseD14 / 360) * nD14Res,2)     .CNT.','000178','000157','.EXE.','5','nVal14Res := ROUND((nBaseD14 / 360) * nD14Res,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','D14RES','nPrv14Ano:= nVal14Res     .END.','000179','000157','.EXE.','5','nPrv14Ano:= nVal14Res','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0051    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0051( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DELENAT','DELETA VERBAS DO OBJETO PARA SUB. NATAL','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','DELENAT','FO_GOTOP(@&COBJETO)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DELENAT','!FO_EOF(@&COBJETO)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','DELENAT','FO_DELETE(@&COBJETO)     .CNT.','000003','000002','.EXE.','5','FO_DELETE(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DELENAT','FO_SKIP(@&COBJETO)     .END.','000004','000002','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0052    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0052( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DELVERBA','DELETA VERBAS DO OBJETO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','DELVERBA','FO_GOTOP(@&COBJETO)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DELVERBA','!FO_EOF(@&COBJETO)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','DELVERBA','FO_GETVAL(@&COBJETO, CCPOTIPO2) != "I"   .END.','000003','000002','.CON.','5','','','5','FO_GETVAL(@&COBJETO, CCPOTIPO2) != "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DELVERBA','FO_DELETE(@&COBJETO)     .END.','000004','000003','.EXE.','5','FO_DELETE(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DELVERBA','FO_SKIP(@&COBJETO)     .END.','000005','000002','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0053    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0053( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DESAHUCI','CALCULA DESAHUCIO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','DESAHUCI','nValAno:= 0     .CNT.','000001','000000','.EXE.','5','nValAno:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nValDesah:= 0     .CNT.','000002','000000','.EXE.','5','nValDesah:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nAnosDesah:= 0     .CNT.','000003','000000','.EXE.','5','nAnosDesah:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','aDiffDays:= {}     .CNT.','000004','000000','.EXE.','5','aDiffDays:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','fTabela("S018", 01, 04) = Nil   .END.','000005','000000','.CON.','5','','','5','fTabela("S018", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018",','000006','000005','.EXE.','5','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','S_MSGLOG()     .CNT.','000007','000005','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','FINALFUN()     .END.','000008','000005','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','fTabela("S004", 01, 04) = Nil   .END.','000009','000000','.CON.','5','','','5','fTabela("S004", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','cMsgLog := fMsgForm({40}) + "S004 - " + fDesc("RCB", "S004",','000010','000009','.EXE.','5','cMsgLog := fMsgForm({40}) + "S004 - " + fDesc("RCB", "S004", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','S_MSGLOG()     .CNT.','000011','000009','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','FINALFUN()     .END.','000012','000009','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nPos := fPosTab("S018", cTipRes, "==", 04)     .CNT.','000013','000000','.EXE.','5','nPos := fPosTab("S018", cTipRes, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nPos > 0 .And. fTabela("S018", nPos, 11) == "S"   .END.','000014','000000','.CON.','5','','','5','nPos > 0 .And. fTabela("S018", nPos, 11) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nPorcDes:= fTabela("S004", 01, 04)     .CNT.','000015','000014','.EXE.','5','nPorcDes:= fTabela("S004", 01, 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nPorcDes > 0   .END.','000016','000014','.CON.','5','','','5','nPorcDes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nValAno:= SalMes * ( nPorcDes / 100 )     .CNT.','000017','000016','.EXE.','5','nValAno:= SalMes * ( nPorcDes / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','aDiffDays := DateDiffYMD( SRA->RA_ADMISSA, dDataDem )     .C','000018','000016','.EXE.','5','aDiffDays := DateDiffYMD( SRA->RA_ADMISSA, dDataDem )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nAnosDesah := aDiffDays[1]     .CNT.','000019','000016','.EXE.','5','nAnosDesah := aDiffDays[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','aDiffDays[2] > 0 .Or. aDiffDays[3] > 0   .END.','000020','000016','.CON.','5','','','5','aDiffDays[2] > 0 .Or. aDiffDays[3] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nAnosDesah:= nAnosDesah + 1     .END.','000021','000020','.EXE.','5','nAnosDesah:= nAnosDesah + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESAHUCI','nValDesah:= nValAno * nAnosDesah     .END.','000022','000016','.EXE.','5','nValDesah:= nValAno * nAnosDesah','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0054    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0054( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DESCNAT','DESCONTO SUBSIDIO DE NATAL ANTECIPADO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','DESCNAT','obtem valor antecipado para desconto     .CNT.','000001','000000','.MSG.','5','obtem valor antecipado para desconto','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','NVALOR := 0     .CNT.','000002','000000','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','AVERBAS := FBUSCAACM(,'+"'"+'SRV->RV_REF13 = "S"'+"'"+', DPRINAT, DULTNA','000003','000000','.EXE.','5','AVERBAS := FBUSCAACM(,'+"'"+'SRV->RV_REF13 = "S"'+"'"+', DPRINAT, DULTNAT, "V", , , '+"'"+'FOL'+"'"+', .T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','LEN(AVERBAS) > 0   .END.','000004','000000','.CON.','5','','','5','LEN(AVERBAS) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','AEVAL(AVERBAS, {|X| NVALOR += X[3]})     .CNT.','000005','000004','.EXE.','5','AEVAL(AVERBAS, {|X| NVALOR += X[3]})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','NVALOR > 0   .END.','000006','000004','.CON.','5','','','5','NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESCNAT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {FGETCODFOL("0023"),','000007','000006','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {FGETCODFOL("0023"), NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0055    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0055( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DESPINT','DESPIDO INTEMPESTIVO','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','DESPINT','aDiffDays:= {}     .CNT.','000001','000000','.EXE.','5','aDiffDays:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nValIntemp:= 0     .CNT.','000002','000000','.EXE.','5','nValIntemp:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nBsIntemp:= 0     .CNT.','000003','000000','.EXE.','5','nBsIntemp:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMesIntemp:= 0     .CNT.','000004','000000','.EXE.','5','nMesIntemp:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','dPerIni:= CtoD("//")     .CNT.','000005','000000','.EXE.','5','dPerIni:= CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','dPerFim:= CtoD("//")     .CNT.','000006','000000','.EXE.','5','dPerFim:= CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','fTabela("S005", 01, 04) = Nil   .END.','000007','000000','.CON.','5','','','5','fTabela("S005", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','cMsgLog := fMsgForm({40}) + "S005 - " + fDesc("RCB", "S005",','000008','000007','.EXE.','5','cMsgLog := fMsgForm({40}) + "S005 - " + fDesc("RCB", "S005", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','S_MSGLOG()     .CNT.','000009','000007','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','FINALFUN()     .END.','000010','000007','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','fTabela("S017", 01, 04) = Nil   .END.','000011','000000','.CON.','5','','','5','fTabela("S017", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','cMsgLog := fMsgForm({40}) + "S017 - " + fDesc("RCB", "S017",','000012','000011','.EXE.','5','cMsgLog := fMsgForm({40}) + "S017 - " + fDesc("RCB", "S017", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','S_MSGLOG()     .CNT.','000013','000011','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','FINALFUN()     .END.','000014','000011','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','fTabela("S018", 01, 04) = Nil   .END.','000015','000000','.CON.','5','','','5','fTabela("S018", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018",','000016','000015','.EXE.','5','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','S_MSGLOG()     .CNT.','000017','000015','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','FINALFUN()     .END.','000018','000015','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nPos := fPosTab("S018", cTipRes, "==", 04)     .CNT.','000019','000000','.EXE.','5','nPos := fPosTab("S018", cTipRes, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nPos > 0 .And. fTabela("S018", nPos, 12) == "S"   .END.','000020','000000','.CON.','5','','','5','nPos > 0 .And. fTabela("S018", nPos, 12) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','!Empty(SRA->RA_TIPOCO)   .END.','000021','000020','.CON.','5','','','5','!Empty(SRA->RA_TIPOCO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nPosCon := fPosTab("S017", SRA->RA_TIPOCO, "==", 04)     .CN','000022','000021','.EXE.','5','nPosCon := fPosTab("S017", SRA->RA_TIPOCO, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','lDeterm:= Iif(fTabela("S017", nPosCon, 06) == "S", .T., .F.)','000023','000021','.EXE.','5','lDeterm:= Iif(fTabela("S017", nPosCon, 06) == "S", .T., .F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','calcula valor base (uma remuneracao). Para comissionados, me','000024','000021','.MSG.','5','calcula valor base (uma remuneracao). Para comissionados media do ano. Caso contrario remuneracao do mes anterior a demissao','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','DESPINT','lComissio:= (SRA->RA_CATFUNC == "C")   .END.','000025','000021','.CON.','5','','','5','lComissio:= (SRA->RA_CATFUNC == "C")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','dPerIni:= MonthSub( dDataRef, 12 )     .CNT.','000026','000025','.EXE.','5','dPerIni:= MonthSub( dDataRef, 12 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','dPerFim:= dDataRef - 1     .CNT.','000027','000025','.EXE.','5','dPerFim:= dDataRef - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','fBuscaAcm( , "SRV->RV_INDEN = '+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @','000028','000025','.EXE.','5','fBuscaAcm( , "SRV->RV_INDEN = '+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @nBsIntemp, , , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMeses:= 12     .CNT.','000029','000025','.EXE.','5','nMeses:= 12','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','SRA->RA_ADMISSA > dPerIni   .END.','000030','000025','.CON.','5','','','5','SRA->RA_ADMISSA > dPerIni','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','aDiffDays:= DateDiffYMD( SRA->RA_ADMISSA, dPerFim )     .CNT','000031','000030','.EXE.','5','aDiffDays:= DateDiffYMD( SRA->RA_ADMISSA, dPerFim )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMeses:= aDiffDays[2]     .CNT.','000032','000030','.EXE.','5','nMeses:= aDiffDays[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','aDiffDays[3] > 0   .END.','000033','000030','.CON.','5','','','5','aDiffDays[3] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMeses+= 1     .END.','000034','000033','.EXE.','5','nMeses+= 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nBsIntemp:= nBsIntemp / nMeses     .END.','000035','000025','.EXE.','5','nBsIntemp:= nBsIntemp / nMeses','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','!lComissio   .END.','000036','000021','.CON.','5','','','5','!lComissio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','dPerIni:= MonthSub( dDataRef, 1 )     .CNT.','000037','000036','.EXE.','5','dPerIni:= MonthSub( dDataRef, 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','dPerFim:= dDataRef - 1     .CNT.','000038','000036','.EXE.','5','dPerFim:= dDataRef - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','fBuscaAcm( , "SRV->RV_INDEN = '+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @','000039','000036','.EXE.','5','fBuscaAcm( , "SRV->RV_INDEN = '+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @nBsIntemp, , , .F. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','se contrato for de tempo determinado     .CNT.','000040','000021','.MSG.','5','se contrato for de tempo determinado','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','DESPINT','lDeterm   .END.','000041','000021','.CON.','5','','','5','lDeterm','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nPorc:= fTabela("S005", 01, 05)     .CNT.','000042','000041','.EXE.','5','nPorc:= fTabela("S005", 01, 05)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMesDur:= fTabela("S017", nPosCon, 07)     .CNT.','000043','000041','.EXE.','5','nMesDur:= fTabela("S017", nPosCon, 07)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nAuxDia := DAY(SRA->RA_ADMISSA)     .CNT.','000044','000041','.EXE.','5','nAuxDia := DAY(SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nAuxMes := MONTH(SRA->RA_ADMISSA)     .CNT.','000045','000041','.EXE.','5','nAuxMes := MONTH(SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nAuxAno := YEAR(SRA->RA_ADMISSA)     .CNT.','000046','000041','.EXE.','5','nAuxAno := YEAR(SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nAuxAno += Int(nMesDur / 12)     .CNT.','000047','000041','.EXE.','5','nAuxAno += Int(nMesDur / 12)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nAuxMes += (nMesDur % 12) - 1     .CNT.','000048','000041','.EXE.','5','nAuxMes += (nMesDur % 12) - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nAuxMes > 12   .END.','000049','000041','.CON.','5','','','5','nAuxMes > 12','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nAuxAno++     .CNT.','000050','000049','.EXE.','5','nAuxAno++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nAuxMes := nAuxMes - 11     .END.','000051','000049','.EXE.','5','nAuxMes := nAuxMes - 11','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','dDtFimCon:= Ctod( Day2Str( nAuxDia ) + "/" + Month2Str( nAux','000052','000041','.EXE.','5','dDtFimCon:= Ctod( Day2Str( nAuxDia ) + "/" + Month2Str( nAuxMes ) + "/" + Year2Str( nAuxAno ) , "DDMMYYYY" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','dDtFimCon > dDataDem   .END.','000053','000041','.CON.','5','','','5','dDtFimCon > dDataDem','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','aDiffDays:= DateDiffYMD( dDataDem, dDtFimCon )     .CNT.','000054','000053','.EXE.','5','aDiffDays:= DateDiffYMD( dDataDem, dDtFimCon )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMesIntemp:= aDiffDays[1] * 12     .CNT.','000055','000053','.EXE.','5','nMesIntemp:= aDiffDays[1] * 12','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMesIntemp+= aDiffDays[2]     .CNT.','000056','000053','.EXE.','5','nMesIntemp+= aDiffDays[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','aDiffDays[3] > 0   .END.','000057','000053','.CON.','5','','','5','aDiffDays[3] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMesIntemp++     .END.','000058','000057','.EXE.','5','nMesIntemp++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nValIntemp:= nBsIntemp * nPorc / 100 * nMesIntemp     .END.','000059','000053','.EXE.','5','nValIntemp:= nBsIntemp * nPorc / 100 * nMesIntemp','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','se contrato for de tempo indeterminado     .CNT.','000060','000021','.MSG.','5','se contrato for de tempo indeterminado','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','DESPINT','!lDeterm   .END.','000061','000021','.CON.','5','','','5','!lDeterm','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','aDiffDays:= DateDiffYMD( SRA->RA_ADMISSA, dDataDem )     .CN','000062','000061','.EXE.','5','aDiffDays:= DateDiffYMD( SRA->RA_ADMISSA, dDataDem )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMesIntemp:= aDiffDays[1]     .CNT.','000063','000061','.EXE.','5','nMesIntemp:= aDiffDays[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','aDiffDays[2] > 0 .Or. aDiffDays[3] > 0   .END.','000064','000061','.CON.','5','','','5','aDiffDays[2] > 0 .Or. aDiffDays[3] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nMesIntemp++     .END.','000065','000064','.EXE.','5','nMesIntemp++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','NAUX := FPOSTAB("S005" , nMesIntemp , "<=" , 04 )     .CNT.','000066','000061','.EXE.','5','NAUX := FPOSTAB("S005" , nMesIntemp , "<=" , 04 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','NAUX > 0   .END.','000067','000061','.CON.','5','','','5','NAUX > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nTeto:= fTabela("S005", NAUX, 06) * nBsIntemp     .END.','000068','000067','.EXE.','5','nTeto:= fTabela("S005", NAUX, 06) * nBsIntemp','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nValIntemp:= nBsIntemp * nMesIntemp     .CNT.','000069','000061','.EXE.','5','nValIntemp:= nBsIntemp * nMesIntemp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nValIntemp > nTeto   .END.','000070','000061','.CON.','5','','','5','nValIntemp > nTeto','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DESPINT','nValIntemp := nTeto     .END.','000071','000070','.EXE.','5','nValIntemp := nTeto','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0056    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0056( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DIASANTF','DIAS ANTECIPADOS EM FERIAS','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','DIASANTF','cVerbPagF := fGetCodFol("1099")     .CNT.','000001','000000','.EXE.','5','cVerbPagF := fGetCodFol("1099")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','cVerbAntF := fGetCodFol("1105")     .CNT.','000002','000000','.EXE.','5','cVerbAntF := fGetCodFol("1105")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nValAntF := 0     .CNT.','000003','000000','.EXE.','5','nValAntF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nDiasAnt := 0     .END.','000004','000000','.EXE.','5','nDiasAnt := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','FPOSREG("SRH", 4, SRA->RA_FILIAL+SRA->RA_MAT+CPERIODO)   .','000005','000000','.CON.','5','','','5','FPOSREG("SRH", 4, SRA->RA_FILIAL+SRA->RA_MAT+CPERIODO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','FPOSREG("SRR", 5, SRA->RA_FILIAL+SRA->RA_MAT+DTOS(SRH->RH_','000006','000005','.CON.','5','','','5','FPOSREG("SRR", 5, SRA->RA_FILIAL+SRA->RA_MAT+DTOS(SRH->RH_DTRECIB)+CVERBPAGF)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nValAntF := SRR->RR_VALOR     .CNT.','000007','000006','.EXE.','5','nValAntF := SRR->RR_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nDiasAnt := SRR->RR_HORAS     .END.','000008','000006','.EXE.','5','nDiasAnt := SRR->RR_HORAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','nValAntF > 0   .END.','000009','000005','.CON.','5','','','5','nValAntF > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASANTF','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { cVerbAn','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR }, { cVerbAntF , nDiasAnt , nValAntF } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0057    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0057( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DIASTRAB','DIAS/HOR TRAB E DIAS/HOR DSR','','000830','075','2','1',} )

aAdd(aRc3Cols, { '','S_','DIASTRAB','!fo_Seek(@oRCF, "RCF_TNOTRA", SRA->RA_TNOTRAB)   .END.','000001','000000','.CON.','5','','','5','!fo_Seek(@oRCF, "RCF_TNOTRA", SRA->RA_TNOTRAB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fo_Seek(@oRCF, "RCF_TNOTRA",  "@@@")     .END.','000002','000001','.EXE.','5','fo_Seek(@oRCF, "RCF_TNOTRA",  "@@@")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','NORMAL :=  fo_GetVal(@oRCF , "RCF_HRSTRA")     .CNT.','000003','000000','.EXE.','5','NORMAL :=  fo_GetVal(@oRCF , "RCF_HRSTRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DESCANSO := fo_GetVal(@oRCF , "RCF_HRSDSR")     .CNT.','000004','000000','.EXE.','5','DESCANSO := fo_GetVal(@oRCF , "RCF_HRSDSR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*P*A*E*I*1*2*3*4*5*6"','000005','000000','.EXE.','5','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*P*A*E*I*1*2*3*4*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_SITFOLH == " "  .and. MesAno(sra->ra_admissa) < cA','000006','000000','.CON.','5','','','5','SRA->RA_SITFOLH == " "  .and. MesAno(sra->ra_admissa) < cAnoMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasDSR := fo_GetVal(@oRCF, "RCF_DIADSR")     .CNT.','000007','000006','.EXE.','5','DiasDSR := fo_GetVal(@oRCF, "RCF_DIADSR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasDSR := DESCANSO     .CNT.','000008','000006','.EXE.','5','nHorasDSR := DESCANSO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasTrab := NORMAL     .CNT.','000009','000006','.EXE.','5','nHorasTrab := NORMAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "M" .END.','000010','000006','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .T.   .END.','000011','000010','.CON.','5','','','5','lCatMensal == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM")     .END.','000012','000011','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .F.   .END.','000013','000010','.CON.','5','','','5','lCatMensal == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA") + fo_GetVal(@oRCF','000014','000013','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA") + fo_GetVal(@oRCF, "RCF_DIADSR") + fo_GetVal(@oRCF, "RCF_DNTRAB")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "S" .END.','000015','000006','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA")     .END.','000016','000015','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_SITFOLH <> " " .or. MesAno(SRA->RA_ADMISSA) == cAn','000017','000000','.CON.','5','','','5','SRA->RA_SITFOLH <> " " .or. MesAno(SRA->RA_ADMISSA) == cAnoMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHoras','000018','000017','.EXE.','5','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHorasDSR , @nHorasTrab , , , , cNumPag, .T., , , c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DIASEFTRB := DIASTRAB     .CNT.','000019','000017','.EXE.','5','DIASEFTRB := DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .T.   .AND.','000020','000017','.CON.','5','','','5','lCatMensal == .T.','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "M" .END.','000021','000017','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM") - nDiasAfas     .','000022','000021','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM") - nDiasAfas','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes := fo_getVal(@ORCH, "RCH_MES",  1)   .CNT.','000023','000021','.EXE.','5','cMes',':=','5','fo_getVal(@ORCH, "RCH_MES",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cAno := fo_getVal(@ORCH, "RCH_ANO",  1)   .CNT.','000024','000021','.EXE.','5','cAno',':=','5','fo_getVal(@ORCH, "RCH_ANO",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','MesAno(SRA->RA_ADMISSA) = cAnoMes .and. Day(SRA->RA_ADMISS','000025','000021','.CON.','5','','','5','MesAno(SRA->RA_ADMISSA) = cAnoMes .and. Day(SRA->RA_ADMISSA) > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas     .','000026','000025','.EXE.','5','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cmes $ "01*02*03*05*07*08*10*12"   .END.','000027','000025','.CON.','5','','','5','cmes $ "01*02*03*05*07*08*10*12"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 30 - day(SRA->RA_ADMISSA) + 1 - nDiasAfas     .E','000028','000027','.EXE.','5','DiasTrab := 30 - day(SRA->RA_ADMISSA) + 1 - nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR.','000029','000021','.CON.','5','','','5','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR. (cMes $ "04*06*09*11" .AND. nDiasAfas == 30)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000030','000029','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas ==','000031','000021','.CON.','5','','','5','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas == 28) .OR.  (VAL(cAno) % 4 == 0 .AND. nDiasAfas == 29) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000032','000031','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0058    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0058( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DTRABRES','DIAS TRABALHADOS NA RESCISAO','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB := DATEDIFFDAY(MAX(DDATADE,SRA->RA_ADMISSA), MIN(DD','000001','000000','.EXE.','5','DIASTRAB := DATEDIFFDAY(MAX(DDATADE,SRA->RA_ADMISSA), MIN(DDATAATE,DDATADEM)) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB -= NDIASAFAS     .CNT.','000002','000000','.EXE.','5','DIASTRAB -= NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB := MAX(DIASTRAB,0)     .CNT.','000003','000000','.EXE.','5','DIASTRAB := MAX(DIASTRAB,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','MESANO(SRA->RA_ADMISSA)  <>  MESANO(DDATADEM)   .END.','000004','000000','.CON.','5','','','5','MESANO(SRA->RA_ADMISSA)  <>  MESANO(DDATADEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','( SRA->RA_CATFUNC $ "M*C*P*A*E*I" ) .AND. ( DAY(DDATADEM)','000005','000004','.CON.','5','','','5','( SRA->RA_CATFUNC $ "M*C*P*A*E*I" ) .AND. ( DAY(DDATADEM) > 30 .OR. ( MONTH(DDATADEM) == 2 .AND. DAY(DDATADEM) == F_ULTDIA(DDATADEM) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB := 30     .END.','000006','000005','.EXE.','5','DIASTRAB := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','fTrabCalend( cPeriodo, @DiasEfTrb, , @DiasDSR, , , , @nHoras','000007','000000','.EXE.','5','fTrabCalend( cPeriodo, @DiasEfTrb, , @DiasDSR, , , , @nHorasDSR, @nHorasTrab, , , , cNumPag, .T., , dDataDem, c__Roteiro )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0059    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0059( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FCALARRE','CALCULA ARREDONDAMENTO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','FCALARRE','nResto := Mod(nVlrTot , nArred)   .CNT.','000001','000000','.EXE.','5','nResto',':=','5','Mod(nVlrTot , nArred)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','Round(nResto,2) > 0 .END.','000002','000000','.CON.','5','','','5','Round(nResto,2)','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrArre := (nArred - nResto )   .CNT.','000003','000002','.EXE.','5','nVlrArre',':=','5','(nArred - nResto )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrTot := (nVlrTot + nVlrArre )   .END.','000004','000002','.EXE.','5','nVlrTot',':=','5','(nVlrTot + nVlrArre )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','Round(nResto,2) <= 0 .END.','000005','000000','.CON.','5','','','5','Round(nResto,2)','<=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrArre := 0   .END.','000006','000005','.EXE.','5','nVlrArre',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0060    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0060( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FLIQFERI','LIQUIDOS DE FERIAS','','','022','2','1',} )

aAdd(aRc3Cols, { '','S_','FLIQFERI','nVAL_ARRE := VLR_INS := 0.00     .CNT.','000001','000000','.EXE.','5','nVAL_ARRE := VLR_INS := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NARRED := P_ARREDFE     .CNT.','000002','000000','.EXE.','5','NARRED := P_ARREDFE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq +=  FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000003','000000','.EXE.','5','nValLiq +=  FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "1" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq +=  FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000004','000000','.EXE.','5','nValLiq +=  FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "2" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','DDTRECIB := If(Empty(dDtRecibo), GetMemVar("RH_RECIB"), dDtR','000005','000000','.EXE.','5','DDTRECIB := If(Empty(dDtRecibo), GetMemVar("RH_RECIB"), dDtRecibo )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NARRED > 0   .END.','000006','000000','.CON.','5','','','5','NARRED > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NVLRTOT := nValLiq     .CNT.','000007','000006','.EXE.','5','NVLRTOT := nValLiq','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nSALV_ARR := NARRED     .CNT.','000008','000006','.EXE.','5','nSALV_ARR := NARRED','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','S_FCALARRE()     .CNT.','000009','000006','.EXE.','5','S_FCALARRE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValArrFe := nSalv_Arr     .CNT.','000010','000006','.EXE.','5','nValArrFe := nSalv_Arr','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nVLRARRE > 0   .END.','000011','000006','.CON.','5','','','5','nVLRARRE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoData},{FGETCODFOL("01','000012','000011','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoData},{FGETCODFOL("0104"),nVLRARRE, dDtRecibo}, cCpoPD, fGetCodFol("0104"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq += nVLRARRE     .END.','000013','000006','.EXE.','5','nValLiq += nVLRARRE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq > 0   .END.','000014','000000','.CON.','5','','','5','nValLiq > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor, cCpoData},{FGETCODFOL("0','000015','000014','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor, cCpoData},{FGETCODFOL("0102"),nValLiq, dDtRecibo}, cCpoPD, fGetCodfol("0102") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0061    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0061( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FLIQUIDO','GERA VALOR LIQUIDO','','','044','2','1',} )

aAdd(aRc3Cols, { '','S_','FLIQUIDO','ROTEIRO DE FOLHA / AUTONOMOS     .CNT.','000001','000000','.MSG.','5','ROTEIRO DE FOLHA / AUTONOMOS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot $ "1|9" .END.','000002','000000','.CON.','5','','','5','cTipoRot','$','5','"1|9"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0047")   .CNT.','000003','000002','.EXE.','5','cCodliq',':=','5','fGetCodFol("0047")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := P_ARREDFO   .CNT.','000004','000002','.EXE.','5','nArred',':=','5','P_ARREDFO','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := fGetCodFol("0043")   .CNT.','000005','000002','.EXE.','5','cCodArred',':=','5','fGetCodFol("0043")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Empty(cCodArred)   .END.','000006','000002','.CON.','5','','','5','Empty(cCodArred)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CMSGLOG := FMSGFORM({19}) + "0043 - " + FDESC("RCN", "0043",','000007','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0043 - " + FDESC("RCN", "0043", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','S_MSGLOG()     .END.','000008','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .T.   .CNT.','000009','000002','.EXE.','5','lIns',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := fGetCodFol("0045")     .CNT.','000010','000002','.EXE.','5','cCodIns := fGetCodFol("0045")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .T.     .CNT.','000011','000002','.EXE.','5','lObrigat := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000012','000002','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','ROTEIRO DE RESCISAO     .CNT.','000013','000000','.MSG.','5','ROTEIRO DE RESCISAO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "4" .END.','000014','000000','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0126")   .CNT.','000015','000014','.EXE.','5','cCodliq',':=','5','fGetCodFol("0126")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := 0   .CNT.','000016','000014','.EXE.','5','nArred',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := Space(3)   .CNT.','000017','000014','.EXE.','5','cCodArred',':=','5','Space(3)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .T.   .CNT.','000018','000014','.EXE.','5','lIns',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := fGetCodFol("0045")   .CNT.','000019','000014','.EXE.','5','cCodIns',':=','5','fGetCodFol("0045")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .T.   .CNT.','000020','000014','.EXE.','5','lObrigat',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000021','000014','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','ROTEIRO DE DECIMA TERCERA REMUNERACAO     .CNT.','000022','000000','.MSG.','5','ROTEIRO DE DECIMA TERCERA REMUNERACAO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "5" .END.','000023','000000','.CON.','5','','','5','cTipoRot','==','5','"5"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodLiq := fGetCodFol("0021")   .CNT.','000024','000023','.EXE.','5','cCodLiq',':=','5','fGetCodFol("0021")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := P_ARRED13   .CNT.','000025','000023','.EXE.','5','nArred',':=','5','P_ARRED13','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := fGetCodFol("0026")   .CNT.','000026','000023','.EXE.','5','cCodArred',':=','5','fGetCodFol("0026")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .F.   .CNT.','000027','000023','.EXE.','5','lIns',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lCodIns := Space(4)   .CNT.','000028','000023','.EXE.','5','lCodIns',':=','5','Space(4)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .CNT.','000029','000023','.EXE.','5','lDemiss',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .F.   .END.','000030','000023','.EXE.','5','lObrigat',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','ROTEIRO DE DECIMA QUARTA REMUNERACAO     .CNT.','000031','000000','.MSG.','5','ROTEIRO DE DECIMA QUARTA REMUNERACAO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "6" .END.','000032','000000','.CON.','5','','','5','cTipoRot','==','5','"6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CCODLIQ := FGETCODFOL("1191")   .CNT.','000033','000032','.EXE.','5','cCodliq',':=','5','fGetCodFol("1191")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := P_ARRED14   .CNT.','000034','000032','.EXE.','5','nArred',':=','5','P_ARRED14','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := fGetCodFol("0026")     .CNT.','000035','000032','.EXE.','5','cCodArred := fGetCodFol("0026")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','EMPTY(CCODARRED)','000036','000032','.CON.','5','','','5','Empty(cCodArred)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CMSGLOG := FMSGFORM({19}) + "0026 - " + FDESC("RCN", "0026",','000037','000036','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0026 - " + FDESC("RCN", "0026", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','S_MSGLOG()     .END.','000038','000036','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .F.   .CNT.','000039','000032','.EXE.','5','lIns',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .F.   .CNT.','000040','000032','.EXE.','5','lObrigat',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000041','000032','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "7"   .END.','000042','000000','.CON.','5','','','5','cTipoRot == "7"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("1021")   .CNT.','000043','000042','.EXE.','5','cCodliq',':=','5','fGetCodFol("1021")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := 0   .END.','000044','000042','.EXE.','5','nArred',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat := 0   .CNT.','000045','000000','.EXE.','5','nObrigat',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cProxNum := "  "   .CNT.','000046','000000','.EXE.','5','cProxNum',':=','5','"  "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000047','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := 0   .CNT.','000048','000000','.EXE.','5','nLiquido',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000049','000000','.EXE.','5','nLiquido',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "1" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido += FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000050','000000','.EXE.','5','nLiquido','+=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "2" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat == .T. .END.','000051','000000','.CON.','5','','','5','lObrigat','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_GOTOP(@&cObjeto)     .CNT.','000052','000051','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_EOF(@&cObjeto)   .END.','000053','000051','.ENQ.','5','','','5','!FO_EOF(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_GETVAL(@&cObjeto, cCpoNPagto) == cNumPag .AND.','000054','000053','.CON.','5','','','5','FO_GETVAL(@&cObjeto, cCpoNPagto)','==','5','cNumPag','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_DELETED(@&cObjeto)   .AND.','000055','000053','.CON.','5','','','5','!FO_DELETED(@&cObjeto)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','POSSRV(FO_GETVAL(@&cObjeto, cCpoPd) , SRA->RA_FILIAL, "RV_','000056','000053','.CON.','5','','','5','POSSRV(FO_GETVAL(@&cObjeto, cCpoPd) , SRA->RA_FILIAL, "RV_OBRIGAT" )','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat += FO_GETVAL(@&cObjeto, cCpoValor )   .END.','000057','000056','.EXE.','5','nObrigat','+=','5','FO_GETVAL(@&cObjeto, cCpoValor )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_SKIP(@&cObjeto)     .END.','000058','000053','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Type("P_CALCINF") != "U" .and. P_CALCINF == "S"   .END.','000059','000000','.CON.','5','','','5','Type("P_CALCINF") != "U" .and. P_CALCINF == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat := 0   .END.','000060','000059','.EXE.','5','nObrigat',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVAL_ARRE := NVLR_INS := 0.00     .CNT.','000061','000000','.EXE.','5','nVAL_ARRE := NVLR_INS := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( nLiquido < 0  .Or.  ( lObrigat .and. nliquido < nObrigat','000062','000000','.CON.','5','','','5','( nLiquido < 0  .Or.  ( lObrigat .and. nliquido < nObrigat) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns == .T. .END.','000063','000000','.CON.','5','','','5','lIns','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := 0   .CNT.','000064','000063','.EXE.','5','nVlr_ins',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!( cSitFolh $ "D*E" )   .OR.','000065','000063','.CON.','5','','','5','!( cSitFolh $ "D*E" )','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( cSitFolh == "D" .and. lDemiss== .T. )   .END.','000066','000063','.CON.','5','','','5','( cSitFolh == "D" .and. lDemiss== .T. )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) < 0 .OR.','000067','000066','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','<','5','0','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( lObrigat == .T.  .And. Round(nLiquido, MsDecimais(1) ) <','000068','000066','.CON.','5','','','5','( lObrigat == .T.  .And. Round(nLiquido, MsDecimais(1) ) < nObrigat )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) < 0 .END.','000069','000068','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := (nLiquido * -1) + nObrigat   .CNT.','000070','000069','.EXE.','5','nVlr_ins',':=','5','(nLiquido * -1) + nObrigat','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := nObrigat   .END.','000071','000069','.EXE.','5','nLiquido',':=','5','nObrigat','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) > 0 .AND.','000072','000068','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat == .T. .END.','000073','000068','.CON.','5','','','5','lObrigat','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := nObrigat - nLiquido   .CNT.','000074','000073','.EXE.','5','nVlr_ins',':=','5','nObrigat - nLiquido','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := nObrigat   .END.','000075','000073','.EXE.','5','nLiquido',':=','5','nObrigat','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','! ( !( cSitFolh $ "D*E" ) .or. ( cSitFolh == "D" .and. lDe','000076','000063','.CON.','5','','','5','! ( !( cSitFolh $ "D*E" ) .or. ( cSitFolh == "D" .and. lDemiss )  )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round( nLiquido , MsDecimais(1) ) < 0 .END.','000077','000063','.CON.','5','','','5','Round( nLiquido , MsDecimais(1) )','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := ( nLiquido * -1 )   .END.','000078','000077','.EXE.','5','nVlr_ins',':=','5','( nLiquido * -1 )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred > 0 .AND.','000079','000000','.CON.','5','','','5','nArred','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido > 0 .END.','000080','000000','.CON.','5','','','5','nLiquido','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := Round( nLiquido, MsDecimais(1) )   .CNT.','000081','000080','.EXE.','5','nLiquido',':=','5','Round( nLiquido, MsDecimais(1) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CCODARRED <> SPACE(4) .AND.','000082','000080','.CON.','5','','','2','CCODARRED','<>','5','SPACE(4)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_SEEK(@&cObjeto, {cCpoPd, cCpoNPagto } , { cCodArred, c','000083','000080','.CON.','5','','','5','!FO_SEEK(@&cObjeto, {cCpoPd, cCpoNPagto } , { cCodArred, cNumPag }  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nSALV_ARR := nArred   .CNT.','000084','000083','.EXE.','5','nSALV_ARR',':=','5','nArred','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlrTot := nLiquido   .CNT.','000085','000083','.EXE.','5','nVlrTot',':=','5','nLiquido','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','S_FCALARRE()     .CNT.','000086','000083','.EXE.','4','S_FCALARRE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := nSALV_ARR   .CNT.','000087','000083','.EXE.','5','nArred',':=','5','nSALV_ARR','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLIQUIDO := nVlrTot   .CNT.','000088','000083','.EXE.','5','nLIQUIDO',':=','5','nVlrTot','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVal_Arre := nVlrArre   .END.','000089','000083','.EXE.','5','nVal_Arre',':=','5','nVlrArre','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0062    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0062( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAADI','GERACAO DE ADIANTAMENTO','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAADI','CTIPOROT <> "4"   .END.','000001','000000','.CON.','5','','','5','CTIPOROT <> "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cRot := Fo_GetVal(@&cObjeto,cCpoRot)     .CNT.','000002','000001','.EXE.','5','cRot := Fo_GetVal(@&cObjeto,cCpoRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','oSrcBkp := Fo_Clone(@&cObjeto)     .CNT.','000003','000001','.EXE.','5','oSrcBkp := Fo_Clone(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','&cObjeto := NIL     .CNT.','000004','000001','.EXE.','5','&cObjeto := NIL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','GetSrcAdi()     .CNT.','000005','000001','.EXE.','5','GetSrcAdi()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','oSrcAdi := Fo_Clone(@&cObjeto)     .CNT.','000006','000001','.EXE.','5','oSrcAdi := Fo_Clone(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','&cObjeto := Fo_Clone(@oSrcBkp)     .CNT.','000007','000001','.EXE.','5','&cObjeto := Fo_Clone(@oSrcBkp)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Len(oSrcAdi:aCols) > 0   .END.','000008','000001','.CON.','5','','','5','Len(oSrcAdi:aCols) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0006")})   .END.','000009','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0006")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0007"))     .CNT.','000010','000009','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000011','000009','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000012','000009','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0713")})   .END.','000013','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0713")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0008"))     .CNT.','000014','000013','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0008"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000015','000013','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000016','000013','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0010")})   .END.','000017','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0010")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0012"))     .CNT.','000018','000017','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0012"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000019','000017','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000020','000017','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','CTIPOROT == "4"   .END.','000021','000000','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GoTop(@&cObjeto)     .CNT.','000022','000021','.EXE.','5','Fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!Fo_Eof(@&cObjeto)   .END.','000023','000021','.ENQ.','5','','','5','!Fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GetVal(@&cObjeto,cCpoTipo2) == "I"   .END.','000024','000023','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo2) == "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)     .CNT.','000025','000024','.EXE.','5','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','LIF := ( cVerba == FGETCODFOL("0006") )   .END.','000026','000024','.CON.','5','','','5','LIF := ( cVerba == FGETCODFOL("0006") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))     .END.','000027','000026','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GetVal(@&cObjeto,cCpoTipo2) == "A"   .END.','000028','000023','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo2) == "A"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)     .CNT.','000029','000028','.EXE.','5','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','LIF := ( cVerba == FGETCODFOL("0006") )   .END.','000030','000028','.CON.','5','','','5','LIF := ( cVerba == FGETCODFOL("0006") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))     .END.','000031','000030','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0713") ) )   .','000032','000028','.CON.','5','','','5','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0713") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0008"))     .END.','000033','000032','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0008"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0010") ) )   .','000034','000028','.CON.','5','','','5','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0010") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0012"))     .END.','000035','000034','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0012"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF   .END.','000036','000028','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Delete(@&cObjeto)     .END.','000037','000036','.EXE.','5','Fo_Delete(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Skip(@&cObjeto)     .END.','000038','000023','.EXE.','5','Fo_Skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0063    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0063( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAFER','GERACAO DE FERIAS NA FOLHA','','','039','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAFER','NDIASDIR := 0     .CNT.','000001','000000','.EXE.','5','NDIASDIR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASFER := 0     .CNT.','000002','000000','.EXE.','5','NDIASFER := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASGOZ := 0     .CNT.','000003','000000','.EXE.','5','NDIASGOZ := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASADI := 0     .CNT.','000004','000000','.EXE.','5','NDIASADI := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nSubSal := 0     .CNT.','000005','000000','.EXE.','5','nSubSal := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDifSub := 0     .CNT.','000006','000000','.EXE.','5','nDifSub := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALFER := 0     .CNT.','000007','000000','.EXE.','5','NVALFER := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALGOZ := 0     .CNT.','000008','000000','.EXE.','5','NVALGOZ := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALADI := 0     .CNT.','000009','000000','.EXE.','5','NVALADI := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_SEEK(@&COBJETO, {CCPOPD}, {FGETCODFOL("0072")})   .END.','000010','000000','.CON.','5','','','5','FO_SEEK(@&COBJETO, {CCPOPD}, {FGETCODFOL("0072")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASFER := FO_GETVAL(@&COBJETO, CCPOHORAS)     .CNT.','000011','000010','.EXE.','5','NDIASFER := FO_GETVAL(@&COBJETO, CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FPOSREG("SRH", 1 , SRA->RA_FILIAL+SRA->RA_MAT )     .CNT.','000012','000010','.EXE.','5','FPOSREG("SRH", 1 , SRA->RA_FILIAL+SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!SRH->(EOF()) .AND. SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_','000013','000010','.ENQ.','5','','','5','!SRH->(EOF()) .AND. SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_FILIAL+SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->RH_PERIODO = CPERIODO   .END.','000014','000013','.CON.','5','','','5','SRH->RH_PERIODO = CPERIODO','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','DTINIFER := SRH->RH_DATABAS     .CNT.','000015','000014','.EXE.','5','DTINIFER := SRH->RH_DATABAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','DTFIMFER := SRH->RH_DBASEAT     .CNT.','000016','000014','.EXE.','5','DTFIMFER := SRH->RH_DBASEAT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FPOSREG("SRF", 1 , SRA->RA_FILIAL+SRA->RA_MAT+DTOS(DTINIFE','000017','000014','.CON.','5','','','5','FPOSREG("SRF", 1 , SRA->RA_FILIAL+SRA->RA_MAT+DTOS(DTINIFER) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASDIR := SRF->RF_DIASDIR     .END.','000018','000017','.EXE.','5','NDIASDIR := SRF->RF_DIASDIR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LACHOU := .T.     .CNT.','000019','000014','.EXE.','5','LACHOU := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FIMENQUANTO()     .END.','000020','000014','.EXE.','5','FIMENQUANTO()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->(DBSKIP())     .END.','000021','000013','.EXE.','5','SRH->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LACHOU   .END.','000022','000010','.CON.','5','','','5','LACHOU','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','S_GETACUFE()     .CNT.','000023','000022','.EXE.','5','S_GETACUFE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LMSG := EMPTY(NBASEFER)   .END.','000024','000022','.CON.','5','','','5','LMSG := EMPTY(NBASEFER)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','CINI := STRZERO(DAY(DTINIFER),2) + "/" + STRZERO(MONTH(DTINI','000025','000024','.EXE.','5','CINI := STRZERO(DAY(DTINIFER),2) + "/" + STRZERO(MONTH(DTINIFER),2) + "/" + STRZERO(YEAR(DTINIFER),4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','CFIM := STRZERO(DAY(DTFIMFER),2) + "/" + STRZERO(MONTH(DTFIM','000026','000024','.EXE.','5','CFIM := STRZERO(DAY(DTFIMFER),2) + "/" + STRZERO(MONTH(DTFIMFER),2) + "/" + STRZERO(YEAR(DTFIMFER),4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','CMSGLOG := FMSGFORM({1}) + SPACE(1) + SRA->RA_MAT + " - " +','000027','000024','.EXE.','5','CMSGLOG := FMSGFORM({1}) + SPACE(1) + SRA->RA_MAT + " - " + FMSGFORM({46}) + SPACE(1) + CINI + " - " + CFIM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','S_MSGLOG()     .END.','000028','000024','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LMSG   .END.','000029','000022','.CON.','5','','','5','!LMSG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASFER > NDIASDIR   .END.','000030','000029','.CON.','5','','','5','NDIASFER > NDIASDIR','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASGOZ := NDIASFER - NDIASDIR     .CNT.','000031','000030','.EXE.','5','NDIASGOZ := NDIASFER - NDIASDIR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASFER -= NDIASGOZ     .END.','000032','000030','.EXE.','5','NDIASFER -= NDIASGOZ','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nSubSal := (sra->ra_salario * P_percprov) / 100     .CNT.','000033','000029','.EXE.','5','nSubSal := (sra->ra_salario * P_percprov) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALFER := NBASEFER / NDIASDIR * NDIASFER     .CNT.','000034','000029','.EXE.','5','NVALFER := NBASEFER / 24','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFer < nSubSal   .END.','000035','000029','.CON.','5','','','5','nValFer < nSubSal','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDifSub := nSubSal - nValfer     .CNT.','000036','000035','.EXE.','5','nDifSub := nSubSal - nValfer','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFer += nDifSub     .END.','000037','000035','.EXE.','5','nValFer += nDifSub','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFer := NValFer / nDiasDir * nDiasFer     .CNT.','000038','000029','.EXE.','5','nValFer := NValFer / nDiasDir * nDiasFer','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALFER > 0   .END.','000039','000029','.CON.','5','','','5','NVALFER > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_SETVAL(@&COBJETO, CCPOHORAS , NDIASFER )     .CNT.','000040','000039','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOHORAS , NDIASFER )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_SETVAL(@&COBJETO, CCPOVALOR , NVALFER )     .END.','000041','000039','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR , NVALFER )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALGOZ := NBASEFER / 24     .CNT.','000042','000029','.EXE.','5','NVALGOZ := NBASEFER / 24','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALGOZ := NVALGOZ / NDIASDIR * NDIASGOZ     .CNT.','000043','000029','.EXE.','5','NVALGOZ := NVALGOZ / NDIASDIR * NDIASGOZ','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALGOZ > 0   .END.','000044','000029','.CON.','5','','','5','NVALGOZ > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR} , {FGETCODF','000045','000044','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR} , {FGETCODFOL("1207"), NDIASGOZ, NVALGOZ} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!EMPTY(FGETCODFOL("1213"))   .END.','000046','000029','.CON.','5','','','5','!EMPTY(FGETCODFOL("1213"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , {FGETCODFOL("1213"),','000047','000046','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , {FGETCODFOL("1213"), NACUMFER} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!EMPTY(ORGB)   .END.','000048','000029','.CON.','5','','','5','!EMPTY(ORGB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_SEEK(@&COBJETO, {CCPOPD}, {FGETCODFOL("1004")})   .END.','000049','000048','.CON.','5','','','5','FO_SEEK(@&COBJETO, {CCPOPD}, {FGETCODFOL("1004")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NDIASADI := FO_GETVAL(@&COBJETO, CCPOHORAS)     .CNT.','000050','000049','.EXE.','5','NDIASADI := FO_GETVAL(@&COBJETO, CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALADI := NBASEFER / 24     .CNT.','000051','000049','.EXE.','5','NVALADI := NBASEFER / 24','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NVALADI := NVALADI / NDIASDIR * NDIASADI     .CNT.','000052','000049','.EXE.','5','NVALADI := NVALADI / NDIASDIR * NDIASADI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FO_SETVAL(@&COBJETO, CCPOVALOR, NVALADI)     .END.','000053','000049','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, NVALADI)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0064    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0064( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAPERI','GERA PERIODOS A PROVISIONAR','','','040','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAPERI','NTIPOPRV <> 2   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV <> 2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','dDtBasFer := SRA->RA_ADMISSA     .CNT.','000002','000001','.EXE.','5','dDtBasFer := SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','cVerba := FGETCODFOL("0072")     .CNT.','000003','000001','.EXE.','5','cVerba := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','S_BASEFER()     .CNT.','000004','000001','.EXE.','5','S_BASEFER()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','Calc_Fer(@aPerFerias,Ctod("31/12/"+StrZero(Year(dDataBase),4','000005','000001','.EXE.','5','Calc_Fer(@aPerFerias,Ctod("31/12/"+StrZero(Year(dDataBase),4)),,,,,,.f.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','Len(aPerFerias) == 0 .And. NTIPOPRV == 1   .END.','000006','000001','.CON.','5','','','5','Len(aPerFerias) == 0 .And. NTIPOPRV == 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FinalFun()     .END.','000007','000006','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont := 1     .CNT.','000008','000001','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont <= Len(aPerFerias)   .END.','000009','000001','.ENQ.','5','','','5','nCont <= Len(aPerFerias)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','LIF := FO_SEEK(@OSRF,{"RF_DATABAS","RF_PD"},{aPerFerias[nC','000010','000009','.CON.','5','','','5','LIF := FO_SEEK(@OSRF,{"RF_DATABAS","RF_PD"},{aPerFerias[nCont,1],cVerba})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_SETVAL(@OSRF,"RF_DFERVAT",aPerFerias[nCont,3])     .CNT.','000011','000010','.EXE.','5','FO_SETVAL(@OSRF,"RF_DFERVAT",aPerFerias[nCont,3])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_SETVAL(@OSRF,"RF_DFERAAT",aPerFerias[nCont,4])     .END.','000012','000010','.EXE.','5','FO_SETVAL(@OSRF,"RF_DFERAAT",aPerFerias[nCont,4])','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nVenc := 0     .CNT.','000013','000012','.EXE.','5','nVenc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','dFim := CTOD("31/12/"+StrZero(Year(dDataAte),4))     .END.','000014','000012','.EXE.','5','dFim := CTOD("31/12/"+StrZero(Year(dDataAte),4))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','!LIF   .END.','000015','000009','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_ADD(@OSRF, {"RF_PD", "RF_DATABAS", "RF_DATAFIM", "RF_DFER','000016','000015','.EXE.','5','FO_ADD(@OSRF, {"RF_PD", "RF_DATABAS", "RF_DATAFIM", "RF_DFERVAT", "RF_DFERAAT", "RF_DIASDIR", "RF_PAGOFER"}, {cVerba, aPerFerias[nCont,1], aPerFerias[nCont,2], aPerFerias[nCont,3],  aPerFerias[nCont,4], 22 ,  aPerFerias[nCont,29] })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont++     .END.','000017','000009','.EXE.','5','nCont++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0065    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0065( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERARES','GERA RESCISAO NA FOLHA','','','031','2','1',} )

aAdd(aRc3Cols, { '','S_','GERARES','SRA->RA_SITFOLH = "D" .and. cTipoRot = "1"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH = "D" .and. cTipoRot = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aRecnos := {}     .CNT.','000002','000001','.EXE.','5','aRecnos := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCCusFun := SRA->RA_CC     .CNT.','000003','000001','.EXE.','5','cCCusFun := SRA->RA_CC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lDeleta := .F.     .CNT.','000004','000001','.EXE.','5','lDeleta := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nPosPdCc := 0.00     .CNT.','000005','000001','.EXE.','5','nPosPdCc := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nRecno := 0.00     .CNT.','000006','000001','.EXE.','5','nRecno := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nRecnos := 0.00     .CNT.','000007','000001','.EXE.','5','nRecnos := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLenSeq := Len( SRC->RC_SEQ )     .CNT.','000008','000001','.EXE.','5','nLenSeq := Len( SRC->RC_SEQ )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := .F.     .CNT.','000009','000001','.EXE.','5','lGerRes := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','fPosReg("SRG",1,SRA->( RA_FILIAL + RA_MAT ))     .CNT.','000010','000001','.EXE.','5','fPosReg("SRG",1,SRA->( RA_FILIAL + RA_MAT ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) == RG_FILI','000011','000001','.ENQ.','5','','','5','SRG->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) == RG_FILIAL + RG_MAT )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( ( MesAno( RG_DTGERAR ) == cAnoMes ) .and. RG_EFETIV','000012','000011','.CON.','5','','','5','SRG->( ( MesAno( RG_DTGERAR ) == cAnoMes ) .and. RG_EFETIVA $ " S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := .T.     .CNT.','000013','000012','.EXE.','5','lGerRes := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','LIF := ( SRG->( MesAno( RG_DATADEM ) == MesAno( RG_DTGERAR','000014','000012','.CON.','5','','','5','LIF := ( SRG->( MesAno( RG_DATADEM ) == MesAno( RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','LIF2 := ( Empty( aRecnos ) )   .END.','000015','000014','.CON.','5','','','5','LIF2 := ( Empty( aRecnos ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aAdd( aRecnos , SRG->( Recno() ) )     .END.','000016','000015','.EXE.','5','aAdd( aRecnos , SRG->( Recno() ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!LIF2   .END.','000017','000014','.CON.','5','','','5','!LIF2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aRecnos[ Len( aRecnos ) ] := SRG->( Recno() )     .END.','000018','000017','.EXE.','5','aRecnos[ Len( aRecnos ) ] := SRG->( Recno() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!LIF   .END.','000019','000012','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aAdd( aRecnos , SRG->( Recno() ) )     .END.','000020','000019','.EXE.','5','aAdd( aRecnos , SRG->( Recno() ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( dbSkip() )     .END.','000021','000011','.EXE.','5','SRG->( dbSkip() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha := 1     .CNT.','000022','000001','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','( nRecnos := Len( aRecnos ) ) > 0.00   .END.','000023','000001','.CON.','5','','','5','( nRecnos := Len( aRecnos ) ) > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha <= nRecnos   .END.','000024','000023','.ENQ.','5','','','5','nLinha <= nRecnos','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( dbGoto( aRecnos[ nLinha ] ) )     .CNT.','000025','000024','.EXE.','5','SRG->( dbGoto( aRecnos[ nLinha ] ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( dbSetOrder(1) )     .CNT.','000026','000024','.EXE.','5','SRR->( dbSetOrder(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SR','000027','000024','.CON.','5','','','5','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SRG->RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','FO_DEL(@&cObjeto,{"RC_FILIAL","RC_MAT"},{SRR->RR_FILIAL,SRR-','000028','000027','.EXE.','5','FO_DEL(@&cObjeto,{"RC_FILIAL","RC_MAT"},{SRR->RR_FILIAL,SRR->RR_MAT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == R','000029','000027','.ENQ.','5','','','5','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == RR_FILIAL + RR_MAT + RR_TIPO3 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGER','000030','000029','.CON.','5','','','5','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGERAR .and. !Empty( RR_VALOR ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','000031','000030','.EXE.','5','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR-','000032','000030','.EXE.','5','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR->RR_DATAPAG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','aCampos:={cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpoCc,cCpoT','000033','000030','.EXE.','5','aCampos:={cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpoCc,cCpoTipo1,cCpoTipo2,cCpoData,cCpoSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','aConteudos:={SRR->RR_PD,SRR->RR_VALOR,SRR->RR_HORAS,SRR->RR_','000034','000030','.EXE.','5','aConteudos:={SRR->RR_PD,SRR->RR_VALOR,SRR->RR_HORAS,SRR->RR_SEMANA,cCCAux,SRR->RR_TIPO1,SRR->RR_TIPO2,dDataPgt,SRR->RR_SEQ}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','FO_ADD(@&cObjeto,aCampos,aConteudos)     .END.','000035','000030','.EXE.','5','FO_ADD(@&cObjeto,aCampos,aConteudos)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->(DBSKIP())     .END.','000036','000029','.EXE.','5','SRR->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha ++     .END.','000037','000024','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes   .END.','000038','000001','.CON.','5','','','5','lGerRes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','S_GRAVASRC()     .CNT.','000039','000038','.EXE.','5','S_GRAVASRC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','LGERRES := .F.     .CNT.','000040','000038','.EXE.','5','LGERRES := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','FINALFUN()     .END.','000041','000038','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0066    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0066( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GETACUFE','OBTEM ACUMULADO PARA FERIAS','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','GETACUFE','CROTMED := FGETROTORDINAR()     .CNT.','000001','000000','.EXE.','5','CROTMED := FGETROTORDINAR()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','NACUMFER := 0     .CNT.','000002','000000','.EXE.','5','NACUMFER := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','LPROV := (C__ROTEIRO == "PRV")   .END.','000003','000000','.CON.','5','','','5','LPROV := (C__ROTEIRO == "PRV")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','FBUSCAACM(,'+"'"+'SRV->RV_MEDFER = "S" .OR. SRV->RV_CODFOL ="0072"','000004','000003','.EXE.','5','FBUSCAACM(,'+"'"+'SRV->RV_MEDFER = "S" .OR. SRV->RV_CODFOL ="0072"'+"'"+', DTINIFER, DTFIMFER, "V", @NACUMFER , , CROTMED, .T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','!LPROV   .END.','000005','000000','.CON.','5','','','5','!LPROV','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','FBUSCAACM(,'+"'"+'SRV->RV_MEDFER = "S"'+"'"+', DTINIFER, DTFIMFER, "V",','000006','000005','.EXE.','5','FBUSCAACM(,'+"'"+'SRV->RV_MEDFER = "S"'+"'"+', DTINIFER, DTFIMFER, "V", @NACUMFER , , CROTMED, .T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','lAcumPer   .END.','000007','000000','.CON.','5','','','5','lAcumPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','NACUMFER+= fo_SomaIncSRV(@&cObjeto, CCPOVALOR, "RV_MEDFER" ,','000008','000007','.EXE.','5','NACUMFER+= fo_SomaIncSRV(@&cObjeto, CCPOVALOR, "RV_MEDFER" , "S" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','lAcumPer:= .F.     .END.','000009','000007','.EXE.','5','lAcumPer:= .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETACUFE','NBASEFER := NACUMFER     .END.','000010','000000','.EXE.','5','NBASEFER := NACUMFER','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0067    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0067( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GETPRACU','OBTEM PROVISAO ACUMULADA','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','GETPRACU','AAREA := GETAREA()     .CNT.','000001','000000','.EXE.','5','AAREA := GETAREA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000002','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NVALANTG := 0     .CNT.','000003','000002','.EXE.','5','NVALANTG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','CVERBAG := FGETCODFOL("0776")     .CNT.','000004','000002','.EXE.','5','CVERBAG := FGETCODFOL("0776")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','FBUSCAACM(CVERBAG, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATA','000005','000002','.EXE.','5','FBUSCAACM(CVERBAG, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATADE), "V", @NVALANTG, , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NPRACUMGZ  := NVALANTG     .CNT.','000006','000002','.EXE.','5','NPRACUMGZ  := NVALANTG','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NVALANTF := 0     .CNT.','000007','000002','.EXE.','5','NVALANTF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','CVERBAF := FGETCODFOL("0825")     .CNT.','000008','000002','.EXE.','5','CVERBAF := FGETCODFOL("0825")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','FBUSCAACM(CVERBAF, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATA','000009','000002','.EXE.','5','FBUSCAACM(CVERBAF, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATADE), "V", @NVALANTF, , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NPRACUFER  := NVALANTF     .END.','000010','000002','.EXE.','5','NPRACUFER  := NVALANTF','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NTIPOPRV > 1   .END.','000011','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NVALANT := 0     .CNT.','000012','000011','.EXE.','5','NVALANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','CVERBAS := FGETCODFOL("0777")     .CNT.','000013','000011','.EXE.','5','CVERBAS := FGETCODFOL("0777")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','FBUSCAACM(CVERBAS, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATA','000014','000011','.EXE.','5','FBUSCAACM(CVERBAS, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATADE), "V", @NVALANT, , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NPRACU13 := NVALANT     .END.','000015','000011','.EXE.','5','NPRACU13 := NVALANT','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','RESTAREA(AAREA)     .END.','000016','000000','.EXE.','5','RESTAREA(AAREA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0068    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0068( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GETVARPL','CARGA DE VARIAVEIS PARA PLR','','','020','2','1',} )

aAdd(aRc3Cols, { '','S_','GETVARPL','EMPTY(PLRBASE)   .END.','000001','000000','.CON.','5','','','5','EMPTY(PLRBASE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','LIF := ( FTABELA("S016", 01, 04) = NIL )   .END.','000002','000001','.CON.','5','','','5','LIF := ( FTABELA("S016", 01, 04) = NIL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','CMSGLOG := FMSGFORM({40}) + "S016 - " + FDESC("RCB", "S016",','000003','000002','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "S016 - " + FDESC("RCB", "S016", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','S_MSGLOG()     .CNT.','000004','000002','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','FINALCALC()     .END.','000005','000002','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','!LIF   .END.','000006','000001','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','NVALTOT := FTABELA("S016",01,04)     .CNT.','000007','000006','.EXE.','5','NVALTOT := FTABELA("S016",01,04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','NPERREM := FTABELA("S016",01,05)     .CNT.','000008','000006','.EXE.','5','NPERREM := FTABELA("S016",01,05)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','NPERFAM := FTABELA("S016",01,06)     .CNT.','000009','000006','.EXE.','5','NPERFAM := FTABELA("S016",01,06)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','NVALTOT > 0   .END.','000010','000006','.CON.','5','','','5','NVALTOT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','PLRTOTREM := ROUND(NVALTOT * (NPERREM / 100),2)     .CNT.','000011','000010','.EXE.','5','PLRTOTREM := ROUND(NVALTOT * (NPERREM / 100),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','PLRTOTFAM := ROUND(NVALTOT * (NPERFAM / 100),2)     .CNT.','000012','000010','.EXE.','5','PLRTOTFAM := ROUND(NVALTOT * (NPERFAM / 100),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETVARPL','PLRBASE := PLRTOTREM + PLRTOTFAM     .END.','000013','000010','.EXE.','5','PLRBASE := PLRTOTREM + PLRTOTFAM','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0069    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0069( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAADI','GERA ADIANTAMENTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAADI','VAL_ADTO <> 0   .END.','000001','000000','.CON.','5','','','5','VAL_ADTO <> 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAADI','!( FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("0006")}) )   .E','000002','000001','.CON.','5','','','5','!( FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("0006")}) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAADI','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras},{fGetCodFol("0','000003','000002','.EXE.','5','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras},{fGetCodFol("0006"),Val_adto,SRA->RA_PERCADT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0070    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0070( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVABFA','GRAVA ABONO FAMILIAR','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVABFA','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','ABONOFAM > 0   .END.','000002','000000','.CON.','5','','','5','ABONOFAM > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','CVERBA := FGETCODFOL("0617")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("0617")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, ABONOFAM})','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, ABONOFAM})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','CMSGLOG := FMSGFORM({19}) + "0617 - " + FDESC("RCN", "0617",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0617 - " + FDESC("RCN", "0617", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVABFA','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0071    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0071( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAJC','GRAVA AJUDA DE CUSTO (NAC / ESTRANG)','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAJC','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','AJCUSTO > 0   .END.','000002','000000','.CON.','5','','','5','AJCUSTO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','CVERBA := FGETCODFOL("1092")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("1092")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, AJCUSTO})','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, AJCUSTO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','CMSGLOG := FMSGFORM({19}) + "1092 - " + FDESC("RCN", "1092",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "1092 - " + FDESC("RCN", "1092", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJC','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0072    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0072( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAJCF','GRAVA AJUDA DE CUSTO FORMACAO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAJCF','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','AJCUSTOFORM > 0   .END.','000002','000000','.CON.','5','','','5','AJCUSTOFORM > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','CVERBA := FGETCODFOL("1093")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("1093")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, AJCUSTOFORM})','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {CVERBA, AJCUSTOFORM})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','CMSGLOG := FMSGFORM({19}) + "1093 - " + FDESC("RCN", "1093",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "1093 - " + FDESC("RCN", "1093", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAJCF','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0073    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0073( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVANAT','GRAVA SUBSIDIO DE NATAL','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVANAT','NVALNATAL > 0   .END.','000001','000000','.CON.','5','','','5','NVALNATAL > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVANAT','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {FGETCODFOL(','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {FGETCODFOL("0024"),NPERCNAT,NVALNATAL})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0074    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0074( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASAL','Grava Salario','','000262','054','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASAL','C__ROTEIRO == "PRV"   .END.','000001','000000','.CON.','5','','','5','C__ROTEIRO == "PRV"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','FIMFORMULA()     .END.','000002','000001','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','lDiaHora :=GetNewPar('+"'"+'MV_DIAHOR'+"'"+',.T.)     .CNT.','000003','000000','.EXE.','5','lDiaHora :=GetNewPar('+"'"+'MV_DIAHOR'+"'"+',.T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000004','000000','.EXE.','5','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','Salario > 0 .AND.','000005','000000','.CON.','5','','','5','Salario','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','cSitFolh # "D" .END.','000006','000000','.CON.','5','','','5','cSitFolh','#','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','P_CALCINF # "S" .END.','000007','000006','.CON.','5','','','5','P_CALCINF','#','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "M*C*D" .AND.','000008','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*D"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000009','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000010','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0031") , cNumpag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000011','000010','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0031"), "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "P" .AND.','000012','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"P"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000013','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0217") # Space(3) .AND.','000014','000007','.CON.','5','','','5','fGetCodFol("0217")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000015','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0217") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000016','000015','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0217") , "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "A" .AND.','000017','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000018','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0218") # Space(3) .AND.','000019','000007','.CON.','5','','','5','fGetCodFol("0218")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000020','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0218") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000021','000020','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0218") , "V" , nSalPg, Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "E" .AND.','000022','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"E"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000023','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0219") # Space(3) .AND.','000024','000007','.CON.','5','','','5','fGetCodFol("0219")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000025','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0219") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000026','000025','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0219") , "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "H" .AND.','000027','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000028','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0032") # SPACE(3) .AND.','000029','000007','.CON.','5','','','5','fGetCodFol("0032")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0033") = SPACE(3) .AND.','000030','000007','.CON.','5','','','5','fGetCodFol("0033")','=','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032")}, .T.)','000031','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000032','000031','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg+nDsr , nHorastrab+nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "G" .AND.','000033','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"G"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000034','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0220") # SPACE(3) .AND.','000035','000007','.CON.','5','','','5','fGetCodFol("0220")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0220")}, .T.)','000036','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0220")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000037','000036','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0220") , "V" , nSalPg+nDsr , nHorastrab+nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "H" .AND.','000038','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000039','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0032") # SPACE(3) .AND.','000040','000007','.CON.','5','','','5','fGetCodFol("0032")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0033") # SPACE(3) .END.','000041','000007','.CON.','5','','','5','fGetCodFol("0033")','#','5','SPACE(3)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032") }, .T.)','000042','000041','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032") }, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000043','000042','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg, nHorastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0033")}, .T.)','000044','000041','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0033")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000045','000044','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0033") , "V" , nDsr, nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "S" .AND.','000046','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000047','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0032") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000048','000047','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg, Diastrab })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000049','000047','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0033") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000050','000049','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0033") , "V" , nDsr, nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0075    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0075( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASRC','GRAVA ASIENTOS','','000871','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASRC','!lDissidio   .END.','000001','000000','.CON.','5','','','5','!lDissidio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASRC','PUTSRC()     .END.','000002','000001','.EXE.','5','PUTSRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0076    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0076( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASRF','GRAVA OBJETO SRF','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASRF','FO_PUT(@oSRF)     .END.','000001','000000','.EXE.','5','FO_PUT(@oSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0077    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0077( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAVPR','GRAVA AVISO PREVIO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAVPR','CVRBAVIND := FGETCODFOL("0111")     .CNT.','000001','000000','.EXE.','5','CVRBAVIND := FGETCODFOL("0111")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','CVRBAVTRB := FGETCODFOL("0112")     .CNT.','000002','000000','.EXE.','5','CVRBAVTRB := FGETCODFOL("0112")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','CVRBAVDES := FGETCODFOL("0113")     .CNT.','000003','000000','.EXE.','5','CVRBAVDES := FGETCODFOL("0113")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','NVPGAVPREV > 0   .END.','000004','000000','.CON.','5','','','5','NVPGAVPREV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','LOK := !EMPTY(DDATAAV) .And. (DDATAAV < DDATADEM)   .END.','000005','000004','.CON.','5','','','5','LOK := !EMPTY(DDATAAV) .And. (DDATAAV < DDATADEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','LIF := EMPTY(CVRBAVTRB)   .END.','000006','000005','.CON.','5','','','5','LIF := EMPTY(CVRBAVTRB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','CMSGLOG := FMSGFORM({19}) + "0112 - " + FDESC("RCN", "112",','000007','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0112 - " + FDESC("RCN", "112", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','S_MSGLOG()     .END.','000008','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','!LIF   .END.','000009','000005','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVTRB','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVTRB, NDIASAVPAG, NVPGAVPREV })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','!LOK   .END.','000011','000004','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVIND','000012','000011','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVIND, NDIASAVPAG, NVPGAVPREV })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','NVDSAVPREV > 0   .END.','000013','000000','.CON.','5','','','5','NVDSAVPREV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAVPR','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVDES','000014','000013','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR}, {CVRBAVDES, NDIASAVDES, NVDSAVPREV })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0078    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0078( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVCOMP','GRAVA COMPENSACAO NA RESCISAO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVCOMP','CVERBA := FGETCODFOL("1091")     .CNT.','000001','000000','.EXE.','5','CVERBA := FGETCODFOL("1091")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVCOMP','NVLRCOMPEN > 0   .END.','000002','000000','.CON.','5','','','5','NVLRCOMPEN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVCOMP','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {CVERBA, NVLRCOMPEN }','000003','000002','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {CVERBA, NVLRCOMPEN })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0079    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0079( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVIECE','GRABA CALCULO DEL CREDITO EDUCATIVO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVIECE','nVIECENO > 0   .END.','000001','000000','.CON.','5','','','5','nVIECENO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIECE','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("1180") , nVIECENO, NPERIECE} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIECE','NBIECENO > 0   .END.','000003','000000','.CON.','5','','','5','NBIECENO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIECE','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1179")','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1179") ,NBIECENO } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIECE','nVIECEFE  > 0   .END.','000005','000000','.CON.','5','','','5','nVIECEFE  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIECE','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000006','000005','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("1184") , nVIECEFE, NPERIECE } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIECE','nBIECEFE > 0   .END.','000007','000000','.CON.','5','','','5','nBIECEFE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIECE','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1183")','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1183") , nBIECEFE } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0080    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0080( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVIESS','GRABA CALCULO DEL IESS','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVIESS','nVFINSS > 0   .END.','000001','000000','.CON.','5','','','5','nVFINSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0064") , nVFINSS, NPINSSFun } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','nVEINSS > 0   .END.','000003','000000','.CON.','5','','','5','nVEINSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0148") , nVEINSS, nPINSSEmp } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','nBINSS > 0   .END.','000005','000000','.CON.','5','','','5','nBINSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0013")','000006','000005','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0013") , nBINSS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','nVFINSSFer > 0   .END.','000007','000000','.CON.','5','','','5','nVFINSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0065") , nVFINSSFer, NPINSSFun } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','nVEINSSFer > 0   .END.','000009','000000','.CON.','5','','','5','nVEINSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0783") , nVEINSSFer, NPINSSEmp } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','nBINSSFer > 0   .END.','000011','000000','.CON.','5','','','5','nBINSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIESS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0787")','000012','000011','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0787") , nBINSSFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0081    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0081( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVIND','GRAVA INDENIZACAO NA RESCISAO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVIND','CVERBA := FGETCODFOL("0110")     .CNT.','000001','000000','.EXE.','5','CVERBA := FGETCODFOL("0110")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIND','NVLRINDEN > 0   .END.','000002','000000','.CON.','5','','','5','NVLRINDEN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIND','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {CVERBA, NVLRINDEN })','000003','000002','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {CVERBA, NVLRINDEN })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0082    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0082( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVIRT','GRAVACAO CALCULO IRT','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVIRT','NBIRT <= 0   .END.','000001','000000','.CON.','5','','','5','NBIRT <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FIMFORMULA()     .END.','000002','000001','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBIRT > 0   .END.','000003','000000','.CON.','5','','','5','NBIRT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0015")','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0015") , NBIRT } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVLRIRT > 0   .END.','000005','000000','.CON.','5','','','5','NVLRIRT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000006','000005','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0066") , NVLRIRT, NPERIRT } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVLRIRT','000007','000000','.MSG.','5','NVLRIRT     < 0  // NÃO EXISTE DEVOLUÇÃO DE IR','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000008','000000','.MSG.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("1130") , Abs(NVLRIRT), NPERIRT } )','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBSIRANT > 0   .END.','000009','000000','.CON.','5','','','5','NBSIRANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0327")','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0327") , NBSIRANT } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVIRANT > 0   .END.','000011','000000','.CON.','5','','','5','NVIRANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000012','000011','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0320") , NVIRANT, NPERIRT } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVIESSANT > 0   .END.','000013','000000','.CON.','5','','','5','NVIESSANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0323")','000014','000013','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0323") , NVIESSANT } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBSIMPONO > 0.00   .END.','000015','000000','.CON.','5','','','5','NBSIMPONO > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0322")','000016','000015','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0322") , NBSIMPONO } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NGASTOSDE > 0.00   .END.','000017','000000','.CON.','5','','','5','NGASTOSDE > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0321")','000018','000017','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0321") , NGASTOSDE } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBSIRPROJ > 0.00   .END.','000019','000000','.CON.','5','','','5','NBSIRPROJ > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1188")','000020','000019','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1188") , NBSIRPROJ } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVIESSPROJ > 0.00   .END.','000021','000000','.CON.','5','','','5','NVIESSPROJ > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1189")','000022','000021','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1189") , NVIESSPROJ } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBSTERIDA > 0.00   .END.','000023','000000','.CON.','5','','','5','NBSTERIDA > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1204")','000024','000023','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1204") , NBSTERIDA } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBSDEDISCAP > 0.00   .END.','000025','000000','.CON.','5','','','5','NBSDEDISCAP > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1203")','000026','000025','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1203") , NBSDEDISCA } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NBIRTFer > 0   .END.','000027','000000','.CON.','5','','','5','NBIRTFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0016")','000028','000027','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0016") , NBIRTFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','NVLRIRTFer > 0   .END.','000029','000000','.CON.','5','','','5','NVLRIRTFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVIRT','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000030','000029','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0067") , NVLRIRTFer, NPERIRTFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0083    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0083( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVLIQU','GRAVACAO DO LIQUIDO','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVLIQU','nVlr_ins > 0 .END.','000001','000000','.CON.','5','','','5','nVlr_ins','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor } , { cCodIns , nVlr_in','000002','000001','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor } , { cCodIns , nVlr_ins } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','nVal_Arre > 0 .END.','000003','000000','.CON.','5','','','5','nVal_Arre','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {cCodArred , nVal_Arr','000004','000003','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {cCodArred , nVal_Arre} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','! FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto } , { cCodLiq, cN','000005','000000','.CON.','5','','','5','! FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto } , { cCodLiq, cNumpag } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT == "9"   .END.','000006','000006','.CON.','5','','','5','CTIPOROT == "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor,cCpoData, cCpoDtRef} ,','000007','000006','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor,cCpoData, cCpoDtRef} , {cCodLiq , nLiquido, dData_Pgto, dData_Pgto} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor, cCpoData } , { cCodLiq','000008','000005','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor, cCpoData } , { cCodLiq, nLiquido, dData_Pgto } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0084    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0084( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVSBAL','GRAVA SUBSIDIO ALIMENTACAO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVSBAL','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','SUBALIMENT > 0   .END.','000002','000000','.CON.','5','','','5','SUBALIMENT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','CVERBA := FGETCODFOL("0050")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("0050")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS , CCPOVALOR}, {CVERBA, D','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS , CCPOVALOR}, {CVERBA, DIASUBALIM , SUBALIMENT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','CMSGLOG := FMSGFORM({19}) + "0050 - " + FDESC("RCN", "0050",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0050 - " + FDESC("RCN", "0050", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBAL','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0085    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0085( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVSBTR','GRAVA SUBSIDIO TRANSPORTE','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVSBTR','CMSGLOG := ""     .CNT.','000001','000000','.EXE.','5','CMSGLOG := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','SUBTRANSP > 0   .END.','000002','000000','.CON.','5','','','5','SUBTRANSP > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','CVERBA := FGETCODFOL("0052")     .CNT.','000003','000002','.EXE.','5','CVERBA := FGETCODFOL("0052")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','LOK := !EMPTY(CVERBA)   .END.','000004','000002','.CON.','5','','','5','LOK := !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','FO_ADD(@&COBJETO,{CCPOPD , CCPOHORAS , CCPOVALOR}, {CVERBA,','000005','000004','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD , CCPOHORAS , CCPOVALOR}, {CVERBA, DIASUBTRANS , SUBTRANSP})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','!LOK   .END.','000006','000002','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO     .CNT.','000007','000006','.MSG.','5','GERA LOG DIZENDO QUE ID NAO FOI CADASTRADO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','CMSGLOG := FMSGFORM({19}) + "0052 - " + FDESC("RCN", "0052",','000008','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0052 - " + FDESC("RCN", "0052", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVSBTR','S_MSGLOG()     .END.','000009','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0086    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0086( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRV13PRV','GRAVA PROVISAO 13 SALARIO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','GRV13PRV','nPrv13Ano > 0   .END.','000001','000000','.CON.','5','','','5','nPrv13Ano > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRV13PRV','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCod','000002','000001','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCodFol("1215") , nD13Res , nPrv13Ano} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRV13PRV','nPrv13Mes > 0   .END.','000003','000000','.CON.','5','','','5','nPrv13Mes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRV13PRV','fo_Add(@&cObjeto, {CCPOPD,CCPOHORAS, CCPOVALOR} , { fGetCodF','000004','000003','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD,CCPOHORAS, CCPOVALOR} , { fGetCodFol("1214") , iIf(nPrv13dia > 30, 30, nPrv13dia),  nPrv13Mes} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0087    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0087( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRV13RES','GRAVA 13 SALARIO NA RESCISAO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRV13RES','nVal13Sal := nAcu13Res / 12     .CNT.','000001','000000','.EXE.','5','nVal13Sal := nAcu13Res / 12','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRV13RES','nVal13Sal > 0   .END.','000002','000000','.CON.','5','','','5','nVal13Sal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRV13RES','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCod','000003','000002','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCodFol("0025") , nD13Res , nVal13Sal} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRV13RES','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR} , { fGetCodFol("1202")','000004','000002','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR} , { fGetCodFol("1202") , nAcu13Res} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0088    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0088( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRV14PRV','GRAVA PROVISAO 14 SALARIO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRV14PRV','nPrv14Ano > 0   .END.','000001','000000','.CON.','5','','','5','nPrv14Ano > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRV14PRV','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCod','000002','000001','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCodFol("1217") , nD14Res , nPrv14Ano} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRV14PRV','nPrv14Mes > 0   .END.','000003','000000','.CON.','5','','','5','nPrv14Mes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRV14PRV','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCod','000004','000003','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCodFol("1216") ,iIf (nPrv14Dia > 30, 30.00,nPrv14Dia), nPrv14Mes} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0089    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0089( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRV14RES','GRAVA 14 SALARIO NA RESCISAO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRV14RES','nVal14Res > 0   .END.','000001','000000','.CON.','5','','','5','nVal14Res > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRV14RES','fo_Add( @&cObjeto , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR','000002','000001','.EXE.','5','fo_Add( @&cObjeto , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR} , {fGetCodFol("1205"), "V" , nD14Res, nVal14Res  })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRV14RES','Totacu14 > 0   .END.','000003','000000','.CON.','5','','','5','Totacu14 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRV14RES','fo_Add( @&cObjeto , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR','000004','000003','.EXE.','5','fo_Add( @&cObjeto , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR} , {fGetCodFol("1190"), "V" , DiaAcu14, TotAcu14  })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0090    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0090( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVDESAH','GRAVA DESAHUCIO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVDESAH','nValDesah > 0   .END.','000001','000000','.CON.','5','','','5','nValDesah > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDESAH','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCod','000002','000001','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { fGetCodFol("0768") , nAnosDesah , nValDesah} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0091    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0091( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVDINT','GRAVA DESPIDO INTEMPESTIVO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVDINT','nBsIntemp > 0   .END.','000001','000000','.CON.','5','','','5','nBsIntemp > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDINT','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR},{fGetCodFol("1208"), n','000002','000001','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR},{fGetCodFol("1208"), nBsIntemp})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDINT','nValIntemp > 0   .END.','000003','000000','.CON.','5','','','5','nValIntemp > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDINT','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR},{fGetCodFol','000004','000003','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR},{fGetCodFol("1209"), nMesIntemp, nValIntemp})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0092    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0092( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVFONDO','GRAVA FONDO DE RESERVA','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVFONDO','nBaseFondo > 0   .END.','000001','000000','.CON.','5','','','5','nBaseFondo > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR} , { fGetCodFol("1218")','000002','000001','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR} , { fGetCodFol("1218"), nBaseFondo} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','nBsFondFer > 0   .END.','000003','000000','.CON.','5','','','5','nBsFondFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR} , { fGetCodFol("1224")','000004','000003','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR} , { fGetCodFol("1224"), nBsFondFer} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','nValFondo > 0   .END.','000005','000000','.CON.','5','','','5','nValFondo > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','lOK:= (SRA->RA_FUNDO == "1")   .END.','000006','000005','.CON.','5','','','5','lOK:= (SRA->RA_FUNDO == "1")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','cVerbaFondo:= fGetCodFol("1219")     .END.','000007','000006','.EXE.','5','cVerbaFondo:= fGetCodFol("1219")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','!lOK   .END.','000008','000005','.CON.','5','','','5','!lOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','cVerbaFondo:= fGetCodFol("1220")     .END.','000009','000008','.EXE.','5','cVerbaFondo:= fGetCodFol("1220")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { cVerbaF','000010','000005','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { cVerbaFondo, NPERFONDO, nValFondo} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','nVlFonFer > 0   .END.','000011','000000','.CON.','5','','','5','nVlFonFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','lOK:= (SRA->RA_FUNDO == "1")   .END.','000012','000011','.CON.','5','','','5','lOK:= (SRA->RA_FUNDO == "1")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','cVerbaFondo:= fGetCodFol("1225")     .END.','000013','000012','.EXE.','5','cVerbaFondo:= fGetCodFol("1225")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','!lOK   .END.','000014','000011','.CON.','5','','','5','!lOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','cVerbaFondo:= fGetCodFol("1226")     .END.','000015','000014','.EXE.','5','cVerbaFondo:= fGetCodFol("1226")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVFONDO','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { cVerbaF','000016','000011','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR} , { cVerbaFondo, NPERFONDO, nVlFonFer} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0093    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0093( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVINDAN','GRAVA INDEMNIZACION TERMINO ANTECIPADO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVINDAN','nBsIndAnt > 0   .END.','000001','000000','.CON.','5','','','5','nBsIndAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVINDAN','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR},{fGetCodFol("1233"), n','000002','000001','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOVALOR},{fGetCodFol("1233"), nBsIndAnt})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVINDAN','nValIndAnt > 0   .END.','000003','000000','.CON.','5','','','5','nValIndAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVINDAN','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR},{fGetCodFol','000004','000003','.EXE.','5','fo_Add(@&cObjeto, {CCPOPD, CCPOHORAS, CCPOVALOR},{fGetCodFol("1234"), nMesIntemp, nValIndAnt})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0094    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0094( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVLIQAD','GERA LIQUIDO ADIANTAMENTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVLIQAD','NVLRTOT > 0   .END.','000001','000000','.CON.','5','','','5','NVLRTOT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVLIQAD','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS, CCPONPAGTO,','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS, CCPONPAGTO, CCPOTIPO1, CCPOTIPO2, CCPODATA},{FGETCODFOL("0546"),NVLRTOT,0,CNUMPAG,"V","A",RCH->RCH_DTPAGO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0095    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0095( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVSECAP','GRABA CALCULO DEL CAPACITACION PROFISION','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVSECAP','nVSECPNO > 0   .END.','000001','000000','.CON.','5','','','5','nVSECPNO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSECAP','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("1182") , nVSECPNO, NPERSECAP} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVSECAP','NBSECPNO > 0   .END.','000003','000000','.CON.','5','','','5','NBSECPNO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSECAP','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1179")','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1181") ,NBSECPNO } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVSECAP','nVSECPFE  > 0   .END.','000005','000000','.CON.','5','','','5','nVSECPFE  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSECAP','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000006','000005','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("1186") , nVSECPFE, NPERSECAP} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVSECAP','nBSECPFE > 0   .END.','000007','000000','.CON.','5','','','5','nBSECPFE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSECAP','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1185")','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("1185") , nBSECPFE } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0096    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0096( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVVALPL','GRAVA VALORES PARA PLR','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVVALPL','PLRBASE > 0   .END.','000001','000000','.CON.','5','','','5','PLRBASE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {FGETCODFOL("1150"),','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR}, {FGETCODFOL("1150"), PLRBASE})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','PLRVALREM > 0   .END.','000003','000000','.CON.','5','','','5','PLRVALREM > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR}, {FGETCODFOL','000004','000003','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR}, {FGETCODFOL("0881"), PLRREFREM, PLRVALREM})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','PLRTOTDIA > 0   .END.','000005','000003','.CON.','5','','','5','PLRTOTDIA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {FGETCODFOL("1221"), P','000006','000005','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {FGETCODFOL("1221"), PLRTOTDIA})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','PLRVALFAM > 0   .END.','000007','000000','.CON.','5','','','5','PLRVALFAM > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR}, {FGETCODFOL','000008','000007','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR}, {FGETCODFOL("1201"), PLRREFFAM, PLRVALFAM})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','PLRTOTDEP > 0   .END.','000009','000007','.CON.','5','','','5','PLRTOTDEP > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVVALPL','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {FGETCODFOL("1222"), P','000010','000009','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {FGETCODFOL("1222"), PLRTOTDEP})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0097    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0097( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','INDMANTE','INDEMNIZACION TERMINO ANTECIPADO CONTRAC','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','INDMANTE','aDiffDays:= {}     .CNT.','000001','000000','.EXE.','5','aDiffDays:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nValIndant := 0     .CNT.','000002','000000','.EXE.','5','nValIndant := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nBsIndAnt := 0     .CNT.','000003','000000','.EXE.','5','nBsIndAnt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nMesIntemp:= 0     .CNT.','000004','000000','.EXE.','5','nMesIntemp:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','dPerIni:= CtoD("//")     .CNT.','000005','000000','.EXE.','5','dPerIni:= CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','dPerFim:= CtoD("//")     .CNT.','000006','000000','.EXE.','5','dPerFim:= CtoD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','fTabela("S004", 01, 04) = Nil   .END.','000007','000000','.CON.','5','','','5','fTabela("S004", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','cMsgLog := fMsgForm({40}) + "S004 - " + fDesc("RCB", "S004",','000008','000007','.EXE.','5','cMsgLog := fMsgForm({40}) + "S004 - " + fDesc("RCB", "S004", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','S_MSGLOG()     .CNT.','000009','000007','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','FINALFUN()     .END.','000010','000007','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','fTabela("S017", 01, 04) = Nil   .END.','000011','000000','.CON.','5','','','5','fTabela("S017", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','cMsgLog := fMsgForm({40}) + "S017 - " + fDesc("RCB", "S017",','000012','000011','.EXE.','5','cMsgLog := fMsgForm({40}) + "S017 - " + fDesc("RCB", "S017", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','S_MSGLOG()     .CNT.','000013','000011','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','FINALFUN()     .END.','000014','000011','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','fTabela("S018", 01, 04) = Nil   .END.','000015','000000','.CON.','5','','','5','fTabela("S018", 01, 04) = Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018",','000016','000015','.EXE.','5','cMsgLog := fMsgForm({40}) + "S018 - " + fDesc("RCB", "S018", "RCB_DESC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','S_MSGLOG()     .CNT.','000017','000015','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','FINALFUN()     .END.','000018','000015','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nPos := fPosTab("S018", cTipRes, "==", 04)     .CNT.','000019','000000','.EXE.','5','nPos := fPosTab("S018", cTipRes, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nPos > 0 .And. fTabela("S018", nPos, 13) == "S"   .END.','000020','000000','.CON.','5','','','5','nPos > 0 .And. fTabela("S018", nPos, 13) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','!Empty(SRA->RA_TIPOCO)   .END.','000021','000020','.CON.','5','','','5','!Empty(SRA->RA_TIPOCO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nPosCon := fPosTab("S017", SRA->RA_TIPOCO, "==", 04)     .CN','000022','000021','.EXE.','5','nPosCon := fPosTab("S017", SRA->RA_TIPOCO, "==", 04)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','lDeterm:= Iif(fTabela("S017", nPosCon, 06) == "S", .T., .F.)','000023','000021','.EXE.','5','lDeterm:= Iif(fTabela("S017", nPosCon, 06) == "S", .T., .F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','calcula valor base (uma remuneracao). Para comissionados, me','000024','000021','.MSG.','5','calcula valor base (uma remuneracao). Para comissionados media do ano. Caso contrario remuneracao do mes anterior a demissao','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','lComissio:= (SRA->RA_CATFUNC == "C")   .END.','000025','000021','.CON.','5','','','5','lComissio:= (SRA->RA_CATFUNC == "C")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','dPerIni:= MonthSub( dDataRef, 12 )     .CNT.','000026','000025','.EXE.','5','dPerIni:= MonthSub( dDataRef, 12 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','dPerFim:= dDataRef - 1     .CNT.','000027','000025','.EXE.','5','dPerFim:= dDataRef - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','fBuscaAcm( , "SRV->RV_INDEN = '+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @','000028','000025','.EXE.','5','fBuscaAcm( , "SRV->RV_INDEN = '+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @nBsIntemp, , , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nMeses:= 12     .CNT.','000029','000025','.EXE.','5','nMeses:= 12','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','SRA->RA_ADMISSA > dPerIni   .END.','000030','000025','.CON.','5','','','5','SRA->RA_ADMISSA > dPerIni','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','aDiffDays:= DateDiffYMD( SRA->RA_ADMISSA, dPerFim )     .CNT','000031','000030','.EXE.','5','aDiffDays:= DateDiffYMD( SRA->RA_ADMISSA, dPerFim )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nMeses:= aDiffDays[2]     .CNT.','000032','000030','.EXE.','5','nMeses:= aDiffDays[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','aDiffDays[3] > 0   .END.','000033','000030','.CON.','5','','','5','aDiffDays[3] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nMeses+= 1     .END.','000034','000033','.EXE.','5','nMeses+= 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nBsIntemp:= nBsIntemp / nMeses     .END.','000035','000025','.EXE.','5','nBsIndAnt := nBsIndant / nMeses','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','!lComissio   .END.','000036','000021','.CON.','5','','','5','!lComissio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','dPerIni:= MonthSub( dDataRef, 1 )     .CNT.','000037','000036','.EXE.','5','dPerIni:= MonthSub( dDataRef, 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','dPerFim:= dDataRef - 1     .CNT.','000038','000036','.EXE.','5','dPerFim:= dDataRef - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','fBuscaAcm( , "SRV->RV_INDEN = '+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @','000039','000036','.EXE.','5','fBuscaAcm( , "SRV->RV_INDEN = '+"'"+'1'+"'"+'", dPerIni, dPerFim, "V", @nBsIndAnt, , , .F. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','se contrato for de tempo determinado     .CNT.','000040','000021','.MSG.','5','se contrato for de tempo determinado','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','lDeterm   .END.','000041','000021','.CON.','5','','','5','lDeterm','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nPorc:= fTabela("S004", 01, 05)     .CNT.','000042','000041','.EXE.','5','nPorc:= fTabela("S004", 01, 05)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nMesDur:= fTabela("S017", nPosCon, 07)     .CNT.','000043','000041','.EXE.','5','nMesDur:= fTabela("S017", nPosCon, 07)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','dDtFimCon:= MonthSum(SRA->RA_ADMISSA, nMesDur)     .CNT.','000044','000041','.EXE.','5','dDtFimCon:= MonthSum(SRA->RA_ADMISSA, nMesDur)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','dDtFimCon > dDataDem   .END.','000045','000041','.CON.','5','','','5','dDtFimCon > dDataDem','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','aDiffDays:= DateDiffYMD( dDataDem, dDtFimCon )     .CNT.','000046','000045','.EXE.','5','aDiffDays:= DateDiffYMD( dDataDem, dDtFimCon )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nMesIntemp:= aDiffDays[1] * 12     .CNT.','000047','000045','.EXE.','5','nMesIntemp:= aDiffDays[1] * 12','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nMesIntemp+= aDiffDays[2]     .CNT.','000048','000045','.EXE.','5','nMesIntemp+= aDiffDays[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','aDiffDays[3] > 0   .END.','000049','000045','.CON.','5','','','5','aDiffDays[3] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nMesIntemp++     .END.','000050','000049','.EXE.','5','nMesIntemp++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nBsIndAnt := nBsIndAnt *  nMesIntemp     .CNT.','000051','000045','.EXE.','5','nBsIndAnt := nBsIndAnt *  nMesIntemp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDMANTE','nValIndAnt:= nBsIndAnt * nPorc / 100     .END.','000052','000045','.EXE.','5','nValIndAnt:= nBsIndAnt * nPorc / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0098    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0098( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LIQDOLAR','CALCULA VALOR LIQUIDO EM DOLAR','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','LIQDOLAR','NVALOR := 0     .CNT.','000001','000000','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','LIF := (CTIPOROT == "2")   .END.','000002','000000','.CON.','5','','','5','LIF := (CTIPOROT == "2")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NVALOR := &("NVLRTOT")     .END.','000003','000002','.EXE.','5','NVALOR := &("NVLRTOT")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','!LIF .AND. (LIF := (CTIPOROT == "3"))   .END.','000004','000000','.CON.','5','','','5','!LIF .AND. (LIF := (CTIPOROT == "3"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NVALOR := &("NVALLIQ")     .END.','000005','000004','.EXE.','5','NVALOR := &("NVALLIQ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','!LIF   .END.','000006','000000','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NVALOR := NLIQUIDO     .END.','000007','000006','.EXE.','5','NVALOR := NLIQUIDO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NLIQDOLAR := xMoeda(NVALOR,1,2,DDATA_PGTO)     .CNT.','000008','000000','.EXE.','5','NLIQDOLAR := xMoeda(NVALOR,1,2,DDATA_PGTO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','LMSG := (NVALOR > 0) .AND. (NLIQDOLAR = 0)   .END.','000009','000000','.CON.','5','','','5','LMSG := (NVALOR > 0) .AND. (NLIQDOLAR = 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','CMSGLOG := FMSGFORM({43})     .CNT.','000010','000009','.EXE.','5','CMSGLOG := FMSGFORM({43})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','S_MSGLOG()     .END.','000011','000009','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','!LMSG   .END.','000012','000000','.CON.','5','','','5','!LMSG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NLIQDOLAR := ROUND(NLIQDOLAR,2)     .CNT.','000013','000012','.EXE.','5','NLIQDOLAR := ROUND(NLIQDOLAR,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','NLIQDOLAR > 0   .END.','000014','000012','.CON.','5','','','5','NLIQDOLAR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQDOLAR','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPODATA} , {FGETCODFO','000015','000014','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPODATA} , {FGETCODFOL("1101"), NLIQDOLAR, DDATA_PGTO} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0099    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0099( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LIQUIADI','LIQUIDO DO ADIANTAMENTO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI := 0     .CNT.','000001','000000','.EXE.','5','NLIQADI := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NPROVADI:=0     .CNT.','000002','000000','.EXE.','5','NPROVADI:=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NDESCADI:=0     .CNT.','000003','000000','.EXE.','5','NDESCADI:=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NVLRTOT := 0     .CNT.','000004','000000','.EXE.','5','NVLRTOT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_GOTOP(@&COBJETO)     .CNT.','000005','000000','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','!FO_EOF(@&COBJETO)   .END.','000006','000000','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_GETVAL(@&COBJETO,CCPOPD) <> FGETCODFOL("0006")   .AND.','000007','000006','.CON.','5','','','5','FO_GETVAL(@&COBJETO,CCPOPD) <> FGETCODFOL("0006")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','!FO_DELETED(@&COBJETO)   .AND.','000008','000006','.CON.','5','','','5','!FO_DELETED(@&COBJETO)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD), SRA->RA_FILIAL, "RV_AD','000009','000006','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD), SRA->RA_FILIAL, "RV_ADIANTA")  == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPO','000010','000009','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPOCOD")=="1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NPROVADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT.','000011','000010','.EXE.','5','NPROVADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI+=NPROVADI     .END.','000012','000010','.EXE.','5','NLIQADI+=NPROVADI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPO','000013','000009','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPOCOD")=="2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NDESCADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT.','000014','000013','.EXE.','5','NDESCADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI-=NDESCADI     .END.','000015','000013','.EXE.','5','NLIQADI-=NDESCADI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_SKIP(@&COBJETO)     .END.','000016','000006','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NVLRTOT := NLIQADI + VAL_ADTO     .END.','000017','000000','.EXE.','5','NVLRTOT := NLIQADI + VAL_ADTO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0100    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0100( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','MSGLOG','MENSAGEM P/ APRESENTACAO NO LOG DE CALC','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','MSGLOG','!EMPTY(CMSGLOG)   .END.','000001','000000','.CON.','5','','','5','!EMPTY(CMSGLOG)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','NPOS := ASCAN(AMSGLOG,{|X| X == CMSGLOG})     .CNT.','000002','000001','.EXE.','5','NPOS := ASCAN(AMSGLOG,{|X| X == CMSGLOG})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','LOK := EMPTY(NPOS)   .END.','000003','000001','.CON.','5','','','5','LOK := EMPTY(NPOS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','AADD(AMSGLOG,CMSGLOG)     .CNT.','000004','000003','.EXE.','5','AADD(AMSGLOG,CMSGLOG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','ADDLOGEXECROT(CMSGLOG)     .END.','000005','000003','.EXE.','5','ADDLOGEXECROT(CMSGLOG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0101    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0101( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PARAMPRV','PARAMETROS PROVISAO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','PARAMPRV','NTIPOPRV := APERGUNTE[1,3]     .END.','000001','000000','.EXE.','5','NTIPOPRV := APERGUNTE[1,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0102    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0102( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCRG1','PROCESSAR RG1','','','068','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCRG1','CPDACFIXOS := ""     .CNT.','000001','000000','.EXE.','5','CPDACFIXOS := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','CVERBADIC := FGETCODFOL("001")+"*"+FGETCODFOL("002")+"*"+FGE','000002','000000','.EXE.','5','CVERBADIC := FGETCODFOL("001")+"*"+FGETCODFOL("002")+"*"+FGETCODFOL("003")+"*"+FGETCODFOL("004")+"*"+FGETCODFOL("005")+"*"+FGETCODFOL("036")+"*"+FGETCODFOL("037")+"*"+FGETCODFOL("038")+"*"+FGETCODFOL("039")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPg:= CToD("")     .CNT.','000003','000000','.EXE.','5','dDtFimPg:= CToD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaIniRG1 := 0     .CNT.','000004','000000','.EXE.','5','nDiaIniRG1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := 0     .CNT.','000005','000000','.EXE.','5','nDiaFimRG1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','fo_GoTop( @ORG1)     .CNT.','000006','000000','.EXE.','5','fo_GoTop( @ORG1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!fo_Eof( @ORG1 )   .END.','000007','000000','.ENQ.','5','','','5','!fo_Eof( @ORG1 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_GETVAL(@oRG1,"RG1_AUTOM") = "1"   .END.','000008','000007','.CON.','5','','','5','FO_GETVAL(@oRG1,"RG1_AUTOM") = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtLib := FO_GETVAL(@ORG1,"RG1_LIBPAG")     .CNT.','000009','000008','.EXE.','5','dDtLib := FO_GETVAL(@ORG1,"RG1_LIBPAG")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPg:= fo_GetVal(@oRG1, "RG1_DFIMPG")     .CNT.','000010','000008','.EXE.','5','dDtFimPg:= fo_GetVal(@oRG1, "RG1_DFIMPG")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!EMPTY(dDtLIb) .And. cAnoMes >= MesAno(dDtLib)   .END.','000011','000008','.CON.','5','','','5','!EMPTY(dDtLIb) .And. cAnoMes >= MesAno(dDtLib)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cVerba := fo_GetVal( @ORG1 , "RG1_PD")     .CNT.','000012','000011','.EXE.','5','cVerba := fo_GetVal( @ORG1 , "RG1_PD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc := fo_GetVal( @ORG1 , "RG1_TPCALC")     .CNT.','000013','000011','.EXE.','5','cTpcalc := fo_GetVal( @ORG1 , "RG1_TPCALC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nRef := fo_GetVal( @ORG1 , "RG1_REFER")     .CNT.','000014','000011','.EXE.','5','nRef := fo_GetVal( @ORG1 , "RG1_REFER")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','PosSrv(cVerba,SRA->RA_FILIAL)     .CNT.','000015','000011','.EXE.','5','PosSrv(cVerba,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nPercVrb := If (SRV->RV_PERC=0,100,SRV->RV_PERC)     .CNT.','000016','000011','.EXE.','5','nPercVrb := If (SRV->RV_PERC=0,100,SRV->RV_PERC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cCodCor := SRV->RV_CODCORR     .CNT.','000017','000011','.EXE.','5','cCodCor := SRV->RV_CODCORR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','Lincorp := IF ( SRV->RV_INCORP ="S",.T.,.F.)     .CNT.','000018','000011','.EXE.','5','Lincorp := IF ( SRV->RV_INCORP ="S",.T.,.F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp := FO_GETVAL(@ORG1,"RG1_PROP")     .CNT.','000019','000011','.EXE.','5','cProp := FO_GETVAL(@ORG1,"RG1_PROP")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp := IF( ( cProp == "1" .And. ( !lIncorp .Or. DiasTrab >','000020','000011','.EXE.','5','cProp := IF( ( cProp == "1" .And. ( !lIncorp .Or. DiasTrab >= 30 ) .And. !( cVerba $ cVerbAdic ) ) .OR. ( cProp == "2" .And. cAfaPagto == "S" ) ,"S","N")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .f.     .CNT.','000021','000011','.EXE.','5','lGravaRg1 := .f.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cCc := FO_GETVAL(@oRG1,"RG1_CC")     .CNT.','000022','000011','.EXE.','5','cCc := FO_GETVAL(@oRG1,"RG1_CC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValTab := 0     .CNT.','000023','000011','.EXE.','5','nValTab := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "1"   .END.','000024','000011','.CON.','5','','','5','cTpcalc == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := FO_GETVAL(@ORG1,"RG1_VALOR")     .CNT.','000025','000024','.EXE.','5','nValor := FO_GETVAL(@ORG1,"RG1_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000026','000024','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "2"   .END.','000027','000011','.CON.','5','','','5','cTpcalc == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * Saldia / 100 * nPercVrb     .CNT.','000028','000027','.EXE.','5','nValor := nRef * Saldia / 100 * nPercVrb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000029','000027','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "3"   .END.','000030','000011','.CON.','5','','','5','cTpcalc == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * SalHora / 100 * nPercVrb     .CNT.','000031','000030','.EXE.','5','nValor := nRef * SalHora / 100 * nPercVrb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000032','000030','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "4"   .END.','000033','000011','.CON.','5','','','5','cTpcalc == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTab := FO_GETVAL(@ORG1,"RG1_CODTAB")     .CNT.','000034','000033','.EXE.','5','cTab := FO_GETVAL(@ORG1,"RG1_CODTAB")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nLin :=FO_GETVAL(@ORG1,"RG1_LINHA")     .CNT.','000035','000033','.EXE.','5','nLin :=FO_GETVAL(@ORG1,"RG1_LINHA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nCol :=FO_GETVAL(@ORG1,"RG1_COLUNA")     .CNT.','000036','000033','.EXE.','5','nCol :=FO_GETVAL(@ORG1,"RG1_COLUNA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValTab := fTabela(cTab,nLin,nCol)     .CNT.','000037','000033','.EXE.','5','nValTab := fTabela(cTab,nLin,nCol)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nRef := If ( nRef = 0,nPercVrb,nRef)     .CNT.','000038','000033','.EXE.','5','nRef := If ( nRef = 0,nPercVrb,nRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','ValType(nValTab) <> "U"   .END.','000039','000033','.CON.','5','','','5','ValType(nValTab) <> "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * nValTab / 100     .CNT.','000040','000039','.EXE.','5','nValor := nRef * nValTab / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000041','000039','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "5"   .END.','000042','000011','.CON.','5','','','5','cTpcalc == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','CPDACFIXOS += fo_GetVal( @ORG1 , "RG1_PD") + "-"     .CNT.','000043','000042','.EXE.','5','CPDACFIXOS += fo_GetVal( @ORG1 , "RG1_PD") + "-"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000044','000042','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "6"   .END.','000045','000011','.CON.','5','','','5','cTpcalc == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * SalMes / 100     .CNT.','000046','000045','.EXE.','5','nValor := nRef * SalMes / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000047','000045','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "7"   .END.','000048','000011','.CON.','5','','','5','cTpcalc == "7"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * VAL_SALMIN / 100     .CNT.','000049','000048','.EXE.','5','nValor := nRef * VAL_SALMIN / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000050','000048','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nTotAdic += nValor     .CNT.','000051','000011','.EXE.','5','nTotAdic += nValor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp == "S"   .END.','000052','000011','.CON.','5','','','5','cProp == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto  := DDATADE     .CNT.','000053','000052','.EXE.','5','dDtIniPgto  := DDATADE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := DDATAATE     .CNT.','000054','000052','.EXE.','5','dDtFimPagto := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtaDem := If( c__roteiro == "RES", GETMEMVAR("RG_DATADEM"),','000055','000052','.EXE.','5','dDtaDem := If( c__roteiro == "RES", GETMEMVAR("RG_DATADEM"), SRA->RA_DEMISSA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( LAdm := ( CANOMES == MesAno(SRA->RA_ADMISSA) ) )   .END.','000056','000052','.CON.','5','','','5','( LAdm := ( CANOMES == MesAno(SRA->RA_ADMISSA) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto := SRA->RA_ADMISSA     .END.','000057','000056','.EXE.','5','dDtIniPgto := SRA->RA_ADMISSA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( CANOMES == MesAno(DDTLIB) )   .END.','000058','000052','.CON.','5','','','5','( CANOMES == MesAno(DDTLIB) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( !LAdm .Or. ( LAdm .And. DDTLIB > SRA->RA_ADMISSA ) )   .','000059','000058','.CON.','5','','','5','( !LAdm .Or. ( LAdm .And. DDTLIB > SRA->RA_ADMISSA ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto := DDTLIB     .END.','000060','000059','.EXE.','5','dDtIniPgto := DDTLIB','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( LDem := ( CANOMES == MesAno(dDtaDem) ) )   .END.','000061','000052','.CON.','5','','','5','( LDem := ( CANOMES == MesAno(dDtaDem) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := dDtaDem     .END.','000062','000061','.EXE.','5','dDtFimPagto := dDtaDem','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( CANOMES == MesAno(DDTFIMPG) )   .END.','000063','000052','.CON.','5','','','5','( CANOMES == MesAno(DDTFIMPG) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( !LDem .Or. ( LDem .And. DDTFIMPG < dDtaDem ) )   .END.','000064','000063','.CON.','5','','','5','( !LDem .Or. ( LDem .And. DDTFIMPG < dDtaDem ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := DDTFIMPG     .END.','000065','000064','.EXE.','5','dDtFimPagto := DDTFIMPG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaIniRG1 := DAY(dDtIniPgto)     .CNT.','000066','000052','.EXE.','5','nDiaIniRG1 := DAY(dDtIniPgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := DAY(dDtFimPagto)     .CNT.','000067','000052','.EXE.','5','nDiaFimRG1 := DAY(dDtFimPagto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .Or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000068','000052','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .Or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .And. P_DIASMES <> "S" )) .And. (nDiaFimRG1 > 30) .And. cVerba # FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := 30     .END.','000069','000068','.EXE.','5','nDiaFimRG1 := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','NREF:= ( nDiaFimRG1 - nDiaIniRG1 + 1 ) - NDIASAFAS     .CNT.','000070','000052','.EXE.','5','NREF:= ( nDiaFimRG1 - nDiaIniRG1 + 1 ) - NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','NVALOR := NVALOR / 30 * MIN(NREF,30)     .END.','000071','000052','.EXE.','5','NVALOR := NVALOR / 30 * MIN(NREF,30)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1   .END.','000072','000011','.CON.','5','','','5','lGravaRg1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc}) .AND. FO_G','000073','000072','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc}) .AND. FO_GETVAL(@&cObjeto,cCpoTipo2) # "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC $ " *1"   .END.','000074','000073','.CON.','5','','','5','SRV->RV_QTDLANC $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)     .CNT.','000075','000074','.EXE.','5','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)     .CNT.','000076','000074','.EXE.','5','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)     .CNT.','000077','000074','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))     .','000078','000074','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC > "1" .AND. NVALOR > 0   .END.','000079','000073','.CON.','5','','','5','SRV->RV_QTDLANC > "1" .AND. NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nSeq := fo_count( @&cObjeto ,cCpoPd , cVerba ) + 1     .CNT.','000080','000079','.EXE.','5','nSeq := fo_count( @&cObjeto ,cCpoPd , cVerba ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cVerb','000081','000079','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cVerba,nRef,Round(nValor,2),Str(nSeq,1)},{cCpoPd,cCpoSeq},{cVerba,Str(nSeq,1)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc})  .and. SR','000082','000072','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc})  .and. SRV->RV_QTDLANC <> "0" .and. (nValor > 0 .or. cTpcalc == "5")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cVerba','000083','000082','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cVerba,nRef,Round(nValor,2),cCc})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!Empty(cCodCor)   .END.','000084','000072','.CON.','5','','','5','!Empty(cCodCor)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','PosSrv(cCodCor,SRA->RA_FILIAL)     .CNT.','000085','000084','.EXE.','5','PosSrv(cCodCor,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})   .END.','000086','000084','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC $ " *1"   .END.','000087','000086','.CON.','5','','','5','SRV->RV_QTDLANC $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)     .CNT.','000088','000087','.EXE.','5','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)     .CNT.','000089','000087','.EXE.','5','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)     .CNT.','000090','000087','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))     .','000091','000087','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC > "1" .And. nValor > 0   .END.','000092','000086','.CON.','5','','','5','SRV->RV_QTDLANC > "1" .And. nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nSeq := fo_count( @&cObjeto ,cCpoPd , cCodCor ) + 1     .CNT','000093','000092','.EXE.','5','nSeq := fo_count( @&cObjeto ,cCpoPd , cCodCor ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cCodC','000094','000092','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cCodCor,nRef,Round(nValor,2),Str(nSeq,1)},{cCpoPd,cCpoSeq},{cCodCor,Str(nSeq,1)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})  .and. S','000095','000084','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})  .and. SRV->RV_QTDLANC <> "0" .and. nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cCodCo','000096','000095','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cCodCor,nRef,Round(nValor,2),cCc})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','fo_Skip( @ORG1 )     .END.','000097','000007','.EXE.','5','fo_Skip( @ORG1 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0103    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0103( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCRGB','PROCESSA INFORMACOES DE RGB PARA SRC','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCRGB','FO_GOTOP(@ORGB)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@ORGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','!FO_EOF(@ORGB)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@ORGB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cNPagRGB := fo_GetVal(@oRGB, "RGB_SEMANA")     .CNT.','000003','000002','.EXE.','5','cNPagRGB := fo_GetVal(@oRGB, "RGB_SEMANA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cMatRGB := fo_GetVal(@oRGB, "RGB_MAT")     .CNT.','000004','000002','.EXE.','5','cMatRGB := fo_GetVal(@oRGB, "RGB_MAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cHrRGB := fo_GetVal(@oRGB , "RGB_HORAS")     .CNT.','000005','000002','.EXE.','5','cHrRGB := fo_GetVal(@oRGB , "RGB_HORAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','nVlRGB := fo_GetVal(@oRGB , "RGB_VALOR")     .CNT.','000006','000002','.EXE.','5','nVlRGB := fo_GetVal(@oRGB , "RGB_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cCCRGB := fo_GetVal(@oRGB , "RGB_CC")     .CNT.','000007','000002','.EXE.','5','cCCRGB := fo_GetVal(@oRGB , "RGB_CC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cPDRGB := fo_GetVal(@oRGB , "RGB_PD")     .CNT.','000008','000002','.EXE.','5','cPDRGB := fo_GetVal(@oRGB , "RGB_PD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cTp1RGB := fo_GetVal(@oRGB , "RGB_TIPO1")     .CNT.','000009','000002','.EXE.','5','cTp1RGB := fo_GetVal(@oRGB , "RGB_TIPO1")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cTp2RGB := fo_GetVal(@oRGB , "RGB_TIPO2")     .CNT.','000010','000002','.EXE.','5','cTp2RGB := fo_GetVal(@oRGB , "RGB_TIPO2")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cDtRGB := fo_GetVal(@oRGB , "RGB_DTREF")     .CNT.','000011','000002','.EXE.','5','cDtRGB := fo_GetVal(@oRGB , "RGB_DTREF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cParRGB := fo_GetVal(@oRGB , "RGB_PARCEL")     .CNT.','000012','000002','.EXE.','5','cParRGB := fo_GetVal(@oRGB , "RGB_PARCEL")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cSeqRGB := fo_GetVal(@oRGB , "RGB_SEQ")     .CNT.','000013','000002','.EXE.','5','cSeqRGB := fo_GetVal(@oRGB , "RGB_SEQ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','fo_ADD(@&cObjeto, {cCpoMat,cCpoHoras, cCpoValor, cCpoCC, cCp','000014','000002','.EXE.','5','fo_ADD(@&cObjeto, {cCpoMat,cCpoHoras, cCpoValor, cCpoCC, cCpoPd, cCpoTipo1, cCpoTipo2,cCpoDtRef, cCpoParcel, cCpoSeq},{cMatRGB,cHrRGB,nVlRGB,cCCRGB,cPDRGB,cTp1RGB,cTp2RGB, cDtRGB, cParRGB, cSeqRGB} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SKIP(@oRGB)     .END.','000015','000002','.EXE.','5','FO_SKIP(@oRGB)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0104    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0104( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSR8','Geracao Ausencias','','000260','107','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSR8','NDIASAFAS := 0     .CNT.','000001','000000','.EXE.','5','NDIASAFAS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Eof(@oSR8)   .END.','000002','000000','.CON.','5','','','5','!fo_Eof(@oSR8)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dFimPer := dDataAte   .CNT.','000003','000002','.EXE.','5','dFimPer',':=','5','dDataAte','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIniFer := dDtFimFer := CTOD("")     .CNT.','000004','000002','.EXE.','5','dDtIniFer := dDtFimFer := CTOD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas := 0     .CNT.','000005','000002','.EXE.','5','nDiasAfas := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nLinha := 0     .CNT.','000006','000002','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Eof( @oSR8)   .END.','000007','000002','.ENQ.','5','','','5','!fo_Eof( @oSR8)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nLinha ++     .CNT.','000008','000007','.EXE.','5','nLinha ++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )     .CNT.','000009','000007','.EXE.','5','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )     .','000010','000007','.EXE.','5','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerbaAfas := FO_GETVAL( @OSR8 , "R8_PD" ,nLinha )     .CNT.','000011','000007','.EXE.','5','cVerbaAfas := FO_GETVAL( @OSR8 , "R8_PD" ,nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", n','000012','000007','.EXE.','5','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", nLinha), SRA->RA_FILIAL, "RCM_TIPOAF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoDia := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", n','000013','000007','.EXE.','5','cTipoDia := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", nLinha), SRA->RA_FILIAL, "RCM_TIPODI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lInformativo:= (cTipoAfa == "3")     .CNT.','000014','000007','.EXE.','5','lInformativo:= (cTipoAfa == "3")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lFerias:= (cTipoAfa == "4")     .CNT.','000015','000007','.EXE.','5','lFerias:= (cTipoAfa == "4")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPer <= cPeriodo .AND.','000016','000007','.CON.','5','','','5','cAfaPer','<=','5','cPeriodo','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','(cAfaNPag <= cNumPag) .And. (!lInformativo)   .END.','000017','000007','.CON.','5','','','5','(cAfaNPag <= cNumPag) .And. (!lInformativo)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )     .CNT.','000018','000017','.EXE.','5','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lFerias   .END.','000019','000017','.CON.','5','','','5','lFerias','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS := FO_GETVAL( @OSR8 , "R8_DURACAO" , NLINHA )     .END','000020','000019','.EXE.','5','NDIAS := FO_GETVAL( @OSR8 , "R8_DURACAO" , NLINHA )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!lFerias   .END.','000021','000017','.CON.','5','','','5','!lFerias','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )     .CNT','000022','000021','.EXE.','5','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )     .CN','000023','000021','.EXE.','5','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','Empty(dDtFim)   .END.','000024','000021','.CON.','5','','','5','Empty(dDtFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFim := dFimPer     .END.','000025','000024','.EXE.','5','dDtFim := dFimPer','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni:= 0     .CNT.','000026','000021','.EXE.','5','nDiaIni:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes == MesAno( dDtIni ) .END.','000027','000021','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtIni )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni := Day( dDtIni )     .END.','000028','000027','.EXE.','5','nDiaIni := Day( dDtIni )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes > MesAno(dDtIni) .END.','000029','000021','.CON.','5','','','5','cAnoMes','>','5','MesAno(dDtIni)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni := 1     .END.','000030','000029','.EXE.','5','nDiaIni := 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim:= 0     .CNT.','000031','000021','.EXE.','5','nDiaFim:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes == MesAno( dDtFim ) .END.','000032','000021','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtFim )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := Day( dDtFim )     .END.','000033','000032','.EXE.','5','nDiaFim := Day( dDtFim )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes < MesAno(dDtFim) .END.','000034','000021','.CON.','5','','','5','cAnoMes','<','5','MesAno(dDtFim)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := Day(dFimPer)     .END.','000035','000034','.EXE.','5','nDiaFim := Day(dFimPer)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000036','000021','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .and. P_DIASMES <> "S" )) .and. (nDiaFim > 30) .and. cVerbaAfas # FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := 30     .END.','000037','000036','.EXE.','5','nDiaFim := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIn','000038','000021','.EXE.','5','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIni + 1), 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoDia ==  '+"'"+'1'+"'"+' .AND. nDias > 0   .END.','000039','000017','.CON.','5','','','5','cTipoDia ==  '+"'"+'1'+"'"+' .AND. nDias > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LOK:=( CANOMES = MESANO(DDTINI) )   .END.','000040','000039','.CON.','5','','','5','LOK:=( CANOMES = MESANO(DDTINI) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS -= DATENOWORKDAY(DDTINI, STOD( (ANOMES(DDTINI)+ALLTRIM','000041','000040','.EXE.','5','NDIAS -= DATENOWORKDAY(DDTINI, STOD( (ANOMES(DDTINI)+ALLTRIM(STR(NDIAFIM))) ))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LOK   .END.','000042','000039','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS -= DATENOWORKDAY(DDTINI, DDTFIM)     .END.','000043','000042','.EXE.','5','NDIAS -= DATENOWORKDAY(DDTINI, DDTFIM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas += nDias   .CNT.','000044','000017','.EXE.','5','nDiasAfas','+=','5','nDias','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','CTIPOROT != "2"   .END.','000045','000017','.CON.','5','','','5','CTIPOROT != "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSdoPagar := fo_GetVal ( @oSR8 , "R8_SDPAGAR" , nLinha )','000046','000045','.EXE.','5','nSdoPagar := fo_GetVal ( @oSR8 , "R8_SDPAGAR" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0   .END.','000047','000045','.CON.','5','','','5','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)     .CN','000048','000047','.EXE.','5','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','MesAno(dDtFimAnt) > MesAno(dDtIni)   .END.','000049','000047','.CON.','5','','','5','MesAno(dDtFimAnt) > MesAno(dDtIni)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LIf:= (Month(dDtIni) = 2)   .END.','000050','000049','.CON.','5','','','5','LIf:= (Month(dDtIni) = 2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2     .END.','000051','000050','.EXE.','5','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LIf   .END.','000052','000049','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni','000053','000052','.EXE.','5','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIn','000054','000047','.EXE.','5','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIni+1,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas-= nDiasNaoAplic     .CNT.','000055','000047','.EXE.','5','nDiasAfas-= nDiasNaoAplic','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LIf:= (cAnoMes==MesAno(DDTINI))   .END.','000056','000047','.CON.','5','','','5','LIf:= (cAnoMes==MesAno(DDTINI))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nPagarMes:= Max(nDiasAfas-fo_GetVal( @oSR8, "R8_DURACAO", nL','000057','000056','.EXE.','5','nPagarMes:= Max(nDiasAfas-fo_GetVal( @oSR8, "R8_DURACAO", nLinha-1),0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LIf   .END.','000058','000047','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nPagarMes:= nDiasAfas     .END.','000059','000058','.EXE.','5','nPagarMes:= nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','000060','000047','.EXE.','5','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!EMPTY(CVERBA) .AND. NDIAS > 0   .END.','000061','000045','.CON.','5','','','5','!EMPTY(CVERBA) .AND. NDIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDPAGARPER := NDIAS     .CNT.','000062','000061','.EXE.','5','NDPAGARPER := NDIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSeq := fo_count( @&cObjeto , cCpoPD , cVerba ) + 1     .CNT','000063','000061','.EXE.','5','nSeq := fo_count( @&cObjeto , cCpoPD , cVerba ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','( lOk := !fo_Seek(@&cObjeto, cCpoPD, cVerba) .AND. !fo_Del','000064','000061','.CON.','5','','','5','( lOk := !fo_Seek(@&cObjeto, cCpoPD, cVerba) .AND. !fo_Deleted(@&cObjeto) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoHoras, cCpoSeq}','000065','000064','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoHoras, cCpoSeq} , {cVerba, "D" , nDPagarPer, STR(nSeq, GetSx3Cache( cCpoSeq , "X3_TAMANHO" )) },{cCpoPd, cCpoSeq},{cVerba, STR(nSeq, GetSx3Cache( cCpoSeq , "X3_TAMANHO" ))})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!lOk   .END.','000066','000061','.CON.','5','','','5','!lOk','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','FO_SETVAL(@&cObjeto,cCPOHORAS, NDIASAFAS )     .END.','000067','000066','.EXE.','5','FO_SETVAL(@&cObjeto,cCPOHORAS, NDIASAFAS )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','POSSRV(CVERBA, SRA->RA_FILIAL, "RV_TIPOCOD") = '+"'"+'2'+"'"+'   .END.','000068','000061','.CON.','5','','','5','POSSRV(CVERBA, SRA->RA_FILIAL, "RV_TIPOCOD") = '+"'"+'2'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIASAFAS -= NDIAS     .END.','000069','000068','.EXE.','5','NDIASAFAS -= NDIAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_Skip ( @oSR8 )     .END.','000070','000007','.EXE.','5','fo_Skip ( @oSR8 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0105    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0105( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRC','Valoriza Verbas','','001176','079','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRC','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000001','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lGerRes := If (Type("lGerRes") == "U" .Or. lGerRes == Nil  ,','000002','000000','.EXE.','5','lGerRes',':=','5','If (Type("lGerRes") == "U" .Or. lGerRes == Nil  , .F. , lGerRes)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerbAdic := fGetCodFol("001")+"*"+fGetCodFol("002")+"*"+fGe','000003','000000','.EXE.','5','cVerbAdic := fGetCodFol("001")+"*"+fGetCodFol("002")+"*"+fGetCodFol("003")+"*"+fGetCodFol("004")+"*"+fGetCodFol("005")+"*"+fGetCodFol("036")+"*"+fGetCodFol("037")+"*"+fGetCodFol("038")+"*"+fGetCodFol("039")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp := IIf(c__Roteiro $ "FOL*RES", DiasTrab, NIL)   .C','000004','000000','.EXE.','5','nDiasProp',':=','5','IIf(c__Roteiro $ "FOL*RES", DiasTrab, NIL)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_GoTop(@&cObjeto)     .CNT.','000005','000000','.EXE.','5','fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!fo_Eof( @&cObjeto )   .END.','000006','000000','.CON.','5','','','5','!fo_Eof( @&cObjeto )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha := 1     .CNT.','000007','000006','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSRC := aClone(&cObjeto:aCols)     .CNT.','000008','000006','.EXE.','5','aSRC := aClone(&cObjeto:aCols)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosPD := GdFieldPos(cCpoPD, & (cObjeto + ":aHeader"))     .','000009','000006','.EXE.','5','nPosPD := GdFieldPos(cCpoPD, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosSeq := GdFieldPos(cCpoSeq, & (cObjeto + ":aHeader"))','000010','000006','.EXE.','5','nPosSeq := GdFieldPos(cCpoSeq, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosCC := GdFieldPos(cCpoCC, & (cObjeto + ":aHeader"))     .','000011','000006','.EXE.','5','nPosCC := GdFieldPos(cCpoCC, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosDel := GdFieldPos("GDDELETED", & (cObjeto + ":aHeader"))','000012','000006','.EXE.','5','nPosDel := GdFieldPos("GDDELETED", & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSort( aSRC ,,, { |x,y| x[ nPosPD ] < y[ nPosPD ] } )     .C','000013','000006','.EXE.','5','aSort( aSRC ,,, { |x,y| x[ nPosPD ] < y[ nPosPD ] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha <= Len(aSRC)   .END.','000014','000006','.ENQ.','5','','','5','nLinha <= Len(aSRC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSRC[nLinha, nPosDel] == .F.   .END.','000015','000014','.CON.','5','','','5','aSRC[nLinha, nPosDel] == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Seek(@&cObjeto, {cCpoPD, cCpoCC, cCpoSeq}, {aSRC[nLinha','000016','000015','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPD, cCpoCC, cCpoSeq}, {aSRC[nLinha,nPosPD], aSRC[nLinha,nPosCC], aSRC[nLinha,nPosSeq]})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .F.     .CNT.','000017','000016','.EXE.','5','lValAlterou := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .F.     .CNT.','000018','000016','.EXE.','5','lQtdAlterou := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 := fo_GetVal( @&cObjeto , cCpoTipo2)     .CNT.','000019','000016','.EXE.','5','cTipo2 := fo_GetVal( @&cObjeto , cCpoTipo2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cTipoRot = "1" .AND. cTipo2 $ "R/I" .AND. lGerRes)   .EN','000020','000016','.CON.','5','','','5','!(cTipoRot = "1" .AND. cTipo2 $ "R/I" .AND. lGerRes)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo := fo_GetVal( @&cObjeto , cCpoTipo1)     .CNT.','000021','000020','.EXE.','5','cTipo := fo_GetVal( @&cObjeto , cCpoTipo1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba := fo_GetVal( @&cObjeto , cCpoPD)     .CNT.','000022','000020','.EXE.','5','cVerba := fo_GetVal( @&cObjeto , cCpoPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','CVERBA $ FGETCODFOL("0072") + "/" + FGETCODFOL("1004")   .','000023','000020','.CON.','5','','','5','CVERBA $ FGETCODFOL("0072") + "/" + FGETCODFOL("1004")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NLINHA ++     .CNT.','000024','000023','.EXE.','5','NLINHA ++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','RETORNEENQ()     .END.','000025','000023','.EXE.','5','RETORNEENQ()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPercent := IF (( nPercent := PosSRV(cVerba, SRA->RA_FILIAL,','000026','000020','.EXE.','5','nPercent := IF (( nPercent := PosSRV(cVerba, SRA->RA_FILIAL, "RV_PERC") ) = 0,1,nPercent / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )     .CN','000027','000020','.EXE.','5','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 == "I" .END.','000028','000020','.CON.','5','','','5','cTipo2','==','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)     .CNT.','000029','000028','.EXE.','5','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := fo_GetVal( @&cObjeto , cCpoValor)     .END.','000030','000028','.EXE.','5','nValor := fo_GetVal( @&cObjeto , cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 # "I" .END.','000031','000020','.CON.','5','','','5','cTipo2','#','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)     .CNT.','000032','000031','.EXE.','5','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := fo_GetVal( @&cObjeto , cCpoValor )     .END.','000033','000031','.EXE.','5','nValor := fo_GetVal( @&cObjeto , cCpoValor )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba $ CPDACFIXOS   .END.','000034','000020','.CON.','5','','','5','cVerba $ CPDACFIXOS','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','CFILTRO := MSMM(SRV->RV_CODMEMO,80,,,,,,,,"RE6")     .CNT.','000035','000034','.EXE.','5','CFILTRO := MSMM(SRV->RV_CODMEMO,80,,,,,,,,"RE6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NBASEACU := FO_SOMAINCSRV(@&COBJETO,CCPOVALOR,{CFILTRO},{.T.','000036','000034','.EXE.','5','NBASEACU := FO_SOMAINCSRV(@&COBJETO,CCPOVALOR,{CFILTRO},{.T.})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)     .CNT.','000037','000034','.EXE.','5','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NVALOR :=  NQTD * NBASEACU / 100     .CNT.','000038','000034','.EXE.','5','NVALOR :=  NQTD * NBASEACU / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','FO_RESTORE(@&COBJETO)     .CNT.','000039','000034','.EXE.','5','FO_RESTORE(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','LVALALTEROU:=.T.     .END.','000040','000034','.EXE.','5','LVALALTEROU:=.T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTarefa := PosSrv(cVerba, SRA->RA_FILIAL, "RV_TAREFA")     .','000041','000020','.EXE.','5','cTarefa := PosSrv(cVerba, SRA->RA_FILIAL, "RV_TAREFA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTarefa := If (Len(AllTrim(cTarefa))#3,"   ",cTarefa)     .C','000042','000020','.EXE.','5','cTarefa := If (Len(AllTrim(cTarefa))#3,"   ",cTarefa)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(SalMes # Nil .Or. (SalMes = Nil .And. PosSrv(cVerba, SRA-','000043','000020','.CON.','5','','','5','(SalMes # Nil .Or. (SalMes = Nil .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")  # "S" )) .And. Empty(cTarefa)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cVerba $ cVerbAdic) .Or. (cVerba $ cVerbAdic .And. nValo','000044','000043','.CON.','5','','','5','!(cVerba $ cVerbAdic) .Or. (cVerba $ cVerbAdic .And. nValor = 0 .And. cTipo2 $ "I*F*G" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "H" .END.','000045','000044','.CON.','5','','','5','cTipo','==','5','"H"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round(nQtd*SALHORA*nPercent,nDecimais)   .CNT.','000046','000045','.EXE.','5','nValor',':=','5','round(nQtd*SALHORA*nPercent,nDecimais)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Restore(@&cObjeto)     .CNT.','000047','000045','.EXE.','5','fo_Restore(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000048','000045','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "D" .END.','000049','000044','.CON.','5','','','5','cTipo','==','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round(nQtd*SALDIA * nPercent, nDecimais)   .CNT.','000050','000049','.EXE.','5','nValor',':=','5','round(nQtd*SALDIA * nPercent, nDecimais)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Restore(@&cObjeto)     .CNT.','000051','000049','.EXE.','5','fo_Restore(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000052','000049','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "V" .AND.','000053','000044','.CON.','5','','','5','cTipo','==','5','"V"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 == "I" .AND.','000054','000044','.CON.','5','','','5','cTipo2','==','5','"I"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor > 0 .END.','000055','000044','.CON.','5','','','5','nValor','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000056','000055','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','( SalMes # NIL ) .And. !( cVerba $ CVRBPROP )   .AND.','000057','000020','.CON.','5','','','5','( SalMes # NIL ) .And. !( cVerba $ CVRBPROP )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP") = "S" .END.','000058','000020','.CON.','5','','','5','PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalMes += nValor   .CNT.','000059','000058','.EXE.','5','SalMes','+=','5','nValor','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalHora += (nValor / SRA->RA_HRSMES)   .CNT.','000060','000058','.EXE.','5','SalHora','+=','5','(nValor / SRA->RA_HRSMES)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalDia += (nValor / 30)   .CNT.','000061','000058','.EXE.','5','SalDia','+=','5','(nValor / 30)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lLctoFixo := FO_SEEK( @ORG1, "RG1_PD", CVERBA)     .CNT.','000062','000058','.EXE.','5','lLctoFixo := FO_SEEK( @ORG1, "RG1_PD", CVERBA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # Nil .AND.','000063','000058','.CON.','5','','','5','nDiasProp','#','5','Nil','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp >= 0 .AND.','000064','000058','.CON.','5','','','5','nDiasProp','>=','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cVerba $ (fGetCodFol("165")+'+"'"+'*'+"'"+'+fGetCodFol("166")+'+"'"+'*'+"'"+'+ f','000065','000058','.CON.','5','','','5','!(cVerba $ (fGetCodFol("165")+'+"'"+'*'+"'"+'+fGetCodFol("166")+'+"'"+'*'+"'"+'+ fGetCodFol("347")))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','Empty(cTarefa)   .END.','000066','000058','.CON.','5','','','5','Empty(cTarefa)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo $ "D*H" .AND. nQtd > 0 .OR.lLctoFixo   .END.','000067','000066','.CON.','5','','','5','cTipo $ "D*H" .AND. nQtd > 0 .OR.lLctoFixo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := ( ( nQtd / 30 ) * nDiasProp )     .CNT.','000068','000067','.EXE.','5','nQtd := ( ( nQtd / 30 ) * nDiasProp )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .T.   .END.','000069','000067','.EXE.','5','lQtdAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cTipo $ "D*H" .AND. nQtd > 0) .AND. !lLctoFixo   .END.','000070','000066','.CON.','5','','','5','!(cTipo $ "D*H" .AND. nQtd > 0) .AND. !lLctoFixo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := nDiasProp     .CNT.','000071','000070','.EXE.','5','nQtd := nDiasProp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .T.   .END.','000072','000070','.EXE.','5','lQtdAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := Round(( (nValor / 30 ) * nDiasProp ), nDecimais)','000073','000066','.EXE.','5','nValor := Round(( (nValor / 30 ) * nDiasProp ), nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000074','000066','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(SalMes # NIL .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_IN','000075','000020','.CON.','5','','','5','!(SalMes # NIL .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP") = "S")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(cVerba $ cVerbAdic .Or.  (cVerba $ cVerbAdic .And. !cTipo','000076','000020','.CON.','5','','','5','(cVerba $ cVerbAdic .Or.  (cVerba $ cVerbAdic .And. !cTipo2 $ "I*F*G" ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .T.     .CNT.','000077','000076','.EXE.','5','lPropAdic := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # 0 .END.','000078','000076','.CON.','5','','','5','nDiasProp','#','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99)','000079','000078','.CON.','5','','','5','(cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99) .Or.       (cVerba = fGetCodfol("038") .And. SRA->RA_INSMED = 999.99) .Or. (cVerba = fGetCodfol("039") .And. SRA->RA_INSMED = 999.99)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .F.     .END.','000080','000079','.EXE.','5','lPropAdic := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!((cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.9','000081','000078','.CON.','5','','','5','!((cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99) .Or.       (cVerba = fGetCodfol("038") .And. SRA->RA_INSMED = 999.99) .Or. (cVerba = fGetCodfol("039") .And. SRA->RA_INSMED = 999.99))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba = fGetCodFol("036") .And. SRA->RA_PERICUL = 999.99','000082','000078','.CON.','5','','','5','cVerba = fGetCodFol("036") .And. SRA->RA_PERICUL = 999.99','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .F.     .END.','000083','000082','.EXE.','5','lPropAdic := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # Nil .And. lPropAdic .And. SRA->RA_TIPOPGT # "S','000084','000076','.CON.','5','','','5','nDiasProp # Nil .And. lPropAdic .And. SRA->RA_TIPOPGT # "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round( ( (nValor / 30 ) * Min(nDiasProp, 30) ) ,nD','000085','000084','.EXE.','5','nValor := round( ( (nValor / 30 ) * Min(nDiasProp, 30) ) ,nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000086','000084','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor <= 0 .END.','000087','000084','.CON.','5','','','5','nValor','<=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Delete(@&cObjeto)     .END.','000088','000087','.EXE.','5','fo_Delete(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou   .END.','000089','000020','.CON.','5','','','5','lValAlterou','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','( cVerba $ cVrbPagto ) .And. ( cTipo2 # "I" ) .And. ( nTot','000090','000089','.CON.','5','','','5','( cVerba $ cVrbPagto ) .And. ( cTipo2 # "I" ) .And. ( nTotAdic > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValAdic := nTotAdic / 30 * nQtd     .CNT.','000091','000090','.EXE.','5','nValAdic := nTotAdic / 30 * nQtd','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor += nValAdic     .END.','000092','000090','.EXE.','5','nValor += nValAdic','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto , cCpoValor, nValor)     .END.','000093','000089','.EXE.','5','fo_SetVal(@&cObjeto , cCpoValor, nValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou   .END.','000094','000020','.CON.','5','','','5','lQtdAlterou','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto , cCpoHoras, nQtd)     .END.','000095','000094','.EXE.','5','fo_SetVal(@&cObjeto , cCpoHoras, nQtd)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipoRot == "9" .And. cTipo2 == "I"   .END.','000096','000020','.CON.','5','','','5','cTipoRot == "9" .And. cTipo2 == "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto, cCpoData, dData_Pgto)     .CNT.','000097','000096','.EXE.','5','fo_SetVal(@&cObjeto, cCpoData, dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto, cCpoDtRef, dData_Pgto)     .END.','000098','000096','.EXE.','5','fo_SetVal(@&cObjeto, cCpoDtRef, dData_Pgto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCodPd := PosSrv(cVerba, SRA->RA_FILIAL, "RV_CODCORR")   .CN','000099','000020','.EXE.','5','cCodPd',':=','5','PosSrv(cVerba, SRA->RA_FILIAL, "RV_CODCORR")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCodPd # "   " .END.','000100','000020','.CON.','5','','','5','cCodPd','#','5','"   "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCC := fo_GetVal(@&cObjeto, cCpoCC)     .CNT.','000101','000100','.EXE.','5','cCC := fo_GetVal(@&cObjeto, cCpoCC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoCC, cCp','000102','000100','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoCC, cCpoTipo1, cCpoTipo2, cCpoSeq, cCpoData}, {cCodPd, nValor, nQtd, cCC, cTipo, cTipo2, fo_GetVal(@&cObjeto, cCpoSeq), fo_GetVal(@&cObjeto, cCpoData)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha ++     .END.','000103','000014','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0106    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0106( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRK','Geracao Val. Futuros no Mvto','','000265','039','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRK','dData := if(cTipoRot == "4", dDataDem, dData_Pgto)     .CNT.','000001','000000','.EXE.','5','dData := if(cTipoRot == "4", dDataDem, dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cSitFolh <> "D" .AND.','000002','000000','.CON.','5','','','5','cSitFolh','<>','5','"D"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!fo_Eof( @OSRK )   .END.','000003','000000','.CON.','5','','','5','!fo_Eof( @OSRK )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','aCampos := {cCpoPD, cCpoTipo1, cCpoValor , cCpoNumId, cCpoSe','000004','000003','.EXE.','5','aCampos := {cCpoPD, cCpoTipo1, cCpoValor , cCpoNumId, cCpoSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_GoTop( @OSRK )     .CNT.','000005','000003','.EXE.','5','fo_GoTop( @OSRK )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nLinha := 0     .CNT.','000006','000003','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!fo_Eof( @OSRK )   .END.','000007','000003','.ENQ.','5','','','5','!fo_Eof( @OSRK )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nLinha++     .CNT.','000008','000007','.EXE.','5','nLinha++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_GetVal(@oSRK, "RK_STATUS", nLinha) == "2"   .END.','000009','000007','.CON.','5','','','5','fo_GetVal(@oSRK, "RK_STATUS", nLinha) == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','dDtVenc := fo_GetVal( @OSRK , "RK_DTVENC", nLinha)     .CNT.','000010','000009','.EXE.','5','dDtVenc := fo_GetVal( @OSRK , "RK_DTVENC", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcPg := fo_GetVal( @OSRK , "RK_PARCPAG", nLinha)     .CNT','000011','000009','.EXE.','5','nParcPg := fo_GetVal( @OSRK , "RK_PARCPAG", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcela := fo_GetVal( @OSRK , "RK_PARCELA", nLinha)     .CN','000012','000009','.EXE.','5','nParcela := fo_GetVal( @OSRK , "RK_PARCELA", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','( (cTipoRot == "4" ) .Or. ( dDtVenc <= dData ) )   .AND.','000013','000009','.CON.','5','','','5','( (cTipoRot == "4" ) .Or. ( dDtVenc <= dData ) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcPg < nParcela   .END.','000014','000009','.CON.','5','','','5','nParcPg < nParcela','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cVerba := fo_GetVal( @OSRK , "RK_PD", nLinha)     .CNT.','000015','000014','.EXE.','5','cVerba := fo_GetVal( @OSRK , "RK_PD", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cNumId := fo_GetVal( @OSRK , "RK_NUMID", nLinha)     .CNT.','000016','000014','.EXE.','5','cNumId := fo_GetVal( @OSRK , "RK_NUMID", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nVlParcela := fo_GetVal( @OSRK , "RK_VALORPA", nLinha)     .','000017','000014','.EXE.','5','nVlParcela := fo_GetVal( @OSRK , "RK_VALORPA", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo := fo_GetVal( @OSRK , "RK_VLSALDO", nLinha)     .CNT.','000018','000014','.EXE.','5','nSaldo := fo_GetVal( @OSRK , "RK_VLSALDO", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cTipoRot == "4" .END.','000019','000014','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor := nSaldo + fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','000020','000019','.EXE.','5','nValor',':=','5','nSaldo + fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!(cTipoRot == "4")   .END.','000021','000014','.CON.','5','','','5','!(cTipoRot == "4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo >= nVlParcela .END.','000022','000021','.CON.','5','','','5','nSaldo','>=','5','nVlParcela','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor := nVlParcela     .END.','000023','000022','.EXE.','5','nValor := nVlParcela','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo < nVlParcela .END.','000024','000021','.CON.','5','','','5','nSaldo','<','5','nVlParcela','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor  := nSaldo     .END.','000025','000024','.EXE.','5','nValor  := nSaldo','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','(nParcela - nParcPg) = 1 .END.','000026','000021','.CON.','5','','','5','(nParcela - nParcPg)','=','5','1','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor += fo_GetVal(@oSRK, "RK_VALORAR", nLinha)   .END.','000027','000026','.EXE.','5','nValor','+=','5','fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cSeq := Alltrim(Str(fo_count( @&cObjeto , cCpoPD , cVerba )','000028','000014','.EXE.','5','cSeq := Alltrim(Str(fo_count( @&cObjeto , cCpoPD , cVerba ) + 1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','aConteudos := {cVerba, "V", nValor, cNumId, cSeq}     .CNT.','000029','000014','.EXE.','5','aConteudos := {cVerba, "V", nValor, cNumId, cSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_Add( @&cObjeto , aCampos, aConteudos, {cCpoPD, cCpoSeq},','000030','000014','.EXE.','5','fo_Add( @&cObjeto , aCampos, aConteudos, {cCpoPD, cCpoSeq}, {cVerba, cSeq})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_Skip( @OSRK )     .END.','000031','000007','.EXE.','5','fo_Skip( @OSRK )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0107    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0107( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVI13','CALCULA PROVISAO DE 13 SALARIO','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVI13','NTIPOPRV > 1   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','S_CALCNAT()     .CNT.','000002','000001','.EXE.','5','S_CALCNAT()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','NVALNATAL > 0   .END.','000003','000001','.CON.','5','','','5','NVALNATAL > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','CVRBPRV := FGETCODFOL("0777")     .CNT.','000004','000003','.EXE.','5','CVRBPRV := FGETCODFOL("0777")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','LOK := !EMPTY(CVRBPRV)   .END.','000005','000003','.CON.','5','','','5','LOK := !EMPTY(CVRBPRV)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})   .END.','000006','000005','.CON.','5','','','5','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','FO_SETVAL(@OSRC,CCPOVALOR,NVALNATAL)     .END.','000007','000006','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,NVALNATAL)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','!LIF   .END.','000008','000005','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','FO_ADD(@OSRC,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVRBPRV, NVALNATA','000009','000008','.EXE.','5','FO_ADD(@OSRC,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVRBPRV, NVALNATAL, NAVOS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','!LOK   .END.','000010','000003','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','CMSGLOG := FMSGFORM({19}) + "0777 - " + FDESC("RCN", "0777",','000011','000010','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0777 - " + FDESC("RCN", "0777", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','S_MSGLOG()     .END.','000012','000010','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0108    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0108( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVIFER','CALCULA PROVISAO DE FERIAS','','','028','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVIFER','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_GOTOP(@OSRF)     .CNT.','000002','000001','.EXE.','5','FO_GOTOP(@OSRF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CVRBFER := FGETCODFOL("0072")     .CNT.','000003','000001','.EXE.','5','CVRBFER := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CVRBPRV := FGETCODFOL("0776")     .CNT.','000004','000001','.EXE.','5','CVRBPRV := FGETCODFOL("0776")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','cVerbPRVF := FGETCODFOL('+"'"+'0825'+"'"+')     .END.','000005','000001','.EXE.','5','cVerbPRVF := FGETCODFOL('+"'"+'0825'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasProF := 0     .CNT.','000006','000001','.EXE.','5','nDiasProF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasProG := 0     .CNT.','000007','000001','.EXE.','5','nDiasProG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasVenF := 0     .CNT.','000008','000001','.EXE.','5','nDiasVenF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasVenG := 0     .CNT.','000009','000001','.EXE.','5','nDiasVenG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NPERCENTF == 0   .END.','000010','000001','.CON.','5','','','5','NPERCENTF == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','aTabFer := {}     .CNT.','000011','000010','.EXE.','5','aTabFer := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','fRetTab(@aTabFer,"S004",,,dDataBase)     .CNT.','000012','000010','.EXE.','5','fRetTab(@aTabFer,"S004",,,dDataBase)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','LEN(aTabFer) > 0   .END.','000013','000010','.CON.','5','','','5','LEN(aTabFer) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NPERCENTF := aTabFer[10]     .END.','000014','000013','.EXE.','5','NPERCENTF := aTabFer[10]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!FO_EOF(@OSRF)   .END.','000015','000001','.ENQ.','5','','','5','!FO_EOF(@OSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','( FO_GETVAL(@OSRF,"RF_PD") == CVRBFER ) .AND. ( FO_GETVAL(','000016','000015','.CON.','5','','','5','( FO_GETVAL(@OSRF,"RF_PD") == CVRBFER ) .AND. ( FO_GETVAL(@OSRF,"RF_DATABAS") <= DDATAATE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"   .END.','000017','000016','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_GETVAL(@OSRF,"RF_PAGOFER") $ " A"   .END.','000018','000017','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_PAGOFER") $ " A"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasProG += FO_GETVAL(@OSRF,"RF_DFERAAT")     .CNT.','000019','000018','.EXE.','5','nDiasProG += FO_GETVAL(@OSRF,"RF_DFERAAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasVenG += FO_GETVAL(@OSRF,"RF_DFERVAT")     .END.','000020','000018','.EXE.','5','nDiasVenG += FO_GETVAL(@OSRF,"RF_DFERVAT")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_GETVAL(@OSRF,"RF_PAGOFER") $ " B"   .END.','000021','000017','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_PAGOFER") $ " B"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasProF += FO_GETVAL(@OSRF,"RF_DFERAAT")     .CNT.','000022','000021','.EXE.','5','nDiasProF += FO_GETVAL(@OSRF,"RF_DFERAAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasVenF += FO_GETVAL(@OSRF,"RF_DFERVAT")     .END.','000023','000021','.EXE.','5','nDiasVenF += FO_GETVAL(@OSRF,"RF_DFERVAT")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_SKIP(@OSRF)     .END.','000024','000015','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nValorG := ( nDiasVenG + nDiasProG ) * SalDia     .CNT.','000025','000001','.EXE.','5','nValorG := ( nDiasVenG + nDiasProG ) * SalDia','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nValorF := ( nDiasVenF + nDiasProF ) * NPERCENTF     .CNT.','000026','000001','.EXE.','5','nValorF := ( nDiasVenF + nDiasProF ) * NPERCENTF','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NVALORG > 0 .AND. ( LOK := !EMPTY(CVRBPRV) )   .END.','000027','000001','.CON.','5','','','5','NVALORG > 0 .AND. ( LOK := !EMPTY(CVRBPRV) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})   .END.','000028','000027','.CON.','5','','','5','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_SETVAL(@OSRC,CCPOVALOR,NVALORG)     .END.','000029','000028','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,NVALORG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!LIF   .END.','000030','000027','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR, CCPOHORAS},{CVRBPRV, NVALOR','000031','000030','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR, CCPOHORAS},{CVRBPRV, NVALORG, NDIASVENG+NDIASPROG})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!LOK   .END.','000032','000001','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CMSGLOG := FMSGFORM({19}) + "0776 - " + FDESC("RCN", "0776",','000033','000032','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0776 - " + FDESC("RCN", "0776", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','S_MSGLOG()     .END.','000034','000032','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NVALORF > 0 .AND. ( LOK := !EMPTY(cVerbPRVF) )   .END.','000035','000001','.CON.','5','','','5','NVALORF > 0 .AND. ( LOK := !EMPTY(cVerbPRVF) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','LIF := FO_SEEK(@OSRC,{CCPOPD},{cVerbPRVF})   .END.','000036','000035','.CON.','5','','','5','LIF := FO_SEEK(@OSRC,{CCPOPD},{cVerbPRVF})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_SETVAL(@OSRC,CCPOVALOR, nValorF )     .END.','000037','000036','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR, nValorF )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!LIF   .END.','000038','000035','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR, CCPOHORAS},{cVerbPRVF, NVAL','000039','000038','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR, CCPOHORAS},{cVerbPRVF, NVALORF, NDIASVENF+NDIASPROF})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!LOK   .END.','000040','000001','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CMSGLOG := FMSGFORM({19}) + "0825 - " + FDESC("RCN", "0825",','000041','000040','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0825 - " + FDESC("RCN", "0825", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','S_MSGLOG()     .END.','000042','000040','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0109    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0109( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVIMES','CALCULO DE PROVISAO DO MES','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVIMES','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORG := 0     .CNT.','000002','000001','.EXE.','5','NVALORG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CVERBGZ := FGETCODFOL("0130")     .CNT.','000003','000001','.EXE.','5','CVERBGZ := FGETCODFOL("0130")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})   .END.','000004','000001','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORG += FO_GETVAL(@OSRC,CCPOVALOR)     .CNT.','000005','000004','.EXE.','5','NVALORG += FO_GETVAL(@OSRC,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORG -= IF(NPRACUMGZ<0,NPRACUMGZ*(-1),NPRACUMGZ)     .CNT','000006','000004','.EXE.','5','NVALORG -= IF(NPRACUMGZ<0,NPRACUMGZ*(-1),NPRACUMGZ)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','LOK := !EMPTY(CVERBGZ)   .END.','000007','000004','.CON.','5','','','5','LOK := !EMPTY(CVERBGZ)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{CVERBGZ, NVALORG})     .EN','000008','000007','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{CVERBGZ, NVALORG})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','!LOK   .END.','000009','000004','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CMSGLOG := FMSGFORM({19}) + "0130 - " + FDESC("RCN", "0130",','000010','000009','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0130 - " + FDESC("RCN", "0130", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','S_MSGLOG()     .END.','000011','000009','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORF := 0     .CNT.','000012','000001','.EXE.','5','NVALORF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CVERBFER := FGETCODFOL("0254")     .CNT.','000013','000001','.EXE.','5','CVERBFER := FGETCODFOL("0254")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0825")})   .END.','000014','000001','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0825")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORF += FO_GETVAL(@OSRC,CCPOVALOR)     .CNT.','000015','000014','.EXE.','5','NVALORF += FO_GETVAL(@OSRC,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALORF -= IF(NPRACUFER<0,NPRACUFER*(-1),NPRACUFER)     .CNT','000016','000014','.EXE.','5','NVALORF -= IF(NPRACUFER<0,NPRACUFER*(-1),NPRACUFER)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','LOK := !EMPTY(CVERBFER)   .END.','000017','000014','.CON.','5','','','5','LOK := !EMPTY(CVERBFER)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{CVERBFER, NVALORF})     .E','000018','000017','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{CVERBFER, NVALORF})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','!LOK   .END.','000019','000014','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CMSGLOG := FMSGFORM({19}) + "0254 - " + FDESC("RCN", "0254",','000020','000019','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0254 - " + FDESC("RCN", "0254", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','S_MSGLOG()     .END.','000021','000019','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NTIPOPRV > 1   .END.','000022','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR := 0     .CNT.','000023','000022','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CVERBPF := FGETCODFOL("0136")     .END.','000024','000022','.EXE.','5','CVERBPF := FGETCODFOL("0136")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})   .END.','000025','000022','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR += FO_GETVAL(@OSRC,CCPOVALOR)     .CNT.','000026','000025','.EXE.','5','NVALOR += FO_GETVAL(@OSRC,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR -= IF(NPRACU13<0,NPRACU13*(-1),NPRACU13)     .CNT.','000027','000025','.EXE.','5','NVALOR -= IF(NPRACU13<0,NPRACU13*(-1),NPRACU13)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','LOK := !EMPTY(CVERBPF)   .END.','000028','000025','.CON.','5','','','5','LOK := !EMPTY(CVERBPF)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{FGETCODFOL("0136"), NVALOR','000029','000028','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{FGETCODFOL("0136"), NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','!LOK   .END.','000030','000025','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','CMSGLOG := FMSGFORM({19}) + "0136 - " + FDESC("RCN", "0136",','000031','000030','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0136 - " + FDESC("RCN", "0136", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','S_MSGLOG()     .END.','000032','000030','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddEQU0110    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddEQU0110( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVVAC','PROVISAO DE FERIAS','','','021','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVVAC','nDiasDir:= 0     .CNT.','000001','000000','.EXE.','5','nDiasDir:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nDiasAdq:= 0     .CNT.','000002','000000','.EXE.','5','nDiasAdq:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nAvos := 0     .CNT.','000003','000000','.EXE.','5','nAvos := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvFer:= 0     .CNT.','000004','000000','.EXE.','5','nProvFer:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nvalSub := 0     .CNT.','000005','000000','.EXE.','5','nvalSub := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nValDif := 0     .CNT.','000006','000000','.EXE.','5','nValDif := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nValAdic := 0     .CNT.','000007','000000','.EXE.','5','nValAdic := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nAdicDias :=   0     .CNT.','000008','000000','.EXE.','5','nAdicDias :=   0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvMFer := 0     .CNT.','000009','000000','.EXE.','5','nProvMFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nAcProvFer:= 0     .CNT.','000010','000000','.EXE.','5','nAcProvFer:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','aDiasEqu:= {}     .CNT.','000011','000000','.EXE.','5','aDiasEqu:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','DtIniFer:= MonthSub(dDataAte, 12) + 1     .CNT.','000012','000000','.EXE.','5','DtIniFer:= MonthSub(dDataAte, 12) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','DtFimFer:= dDataAte     .CNT.','000013','000000','.EXE.','5','DtFimFer:= dDataAte','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','LFERIAS := .F.     .CNT.','000014','000000','.EXE.','5','LFERIAS := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','FPOSREG("SRH", 1 , SRA->RA_FILIAL+SRA->RA_MAT )     .CNT.','000015','000000','.EXE.','5','FPOSREG("SRH", 1 , SRA->RA_FILIAL+SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','!SRH->(EOF()) .AND. SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_','000016','000000','.ENQ.','5','','','5','!SRH->(EOF()) .AND. SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_FILIAL+SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','SRH->RH_PERIODO = CPERIODO   .END.','000017','000016','.CON.','5','','','5','SRH->RH_PERIODO = CPERIODO','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','DTINIFER := SRH->RH_DATABAS     .CNT.','000018','000017','.EXE.','5','DTINIFER := SRH->RH_DATABAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','LFERIAS := .T.     .CNT.','000019','000017','.EXE.','5','LFERIAS := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','FIMENQUANTO()     .END.','000020','000017','.EXE.','5','FIMENQUANTO()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','SRH->(DBSKIP())     .END.','000021','000016','.EXE.','5','SRH->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','!LFERIAS   .END.','000022','000000','.CON.','5','','','5','!LFERIAS','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','FPOSREG("SRF", 1 , SRA->RA_FILIAL+SRA->RA_MAT )     .CNT.','000023','000022','.EXE.','5','FPOSREG("SRF", 1 , SRA->RA_FILIAL+SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','!SRF->(EOF()) .AND. SRF->RF_FILIAL+SRF->RF_MAT == SRA->RA_','000024','000022','.ENQ.','5','','','5','!SRF->(EOF()) .AND. SRF->RF_FILIAL+SRF->RF_MAT == SRA->RA_FILIAL+SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','SRF->RF_STATUS $ '+"'"+'1 '+"'"+'   .END.','000025','000024','.CON.','5','','','5','SRF->RF_STATUS $ '+"'"+'1 '+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','DTINIFER := SRF->RF_DATABAS     .CNT.','000026','000025','.EXE.','5','DTINIFER := SRF->RF_DATABAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','FIMENQUANTO()     .END.','000027','000025','.EXE.','5','FIMENQUANTO()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','SRF->(DBSKIP())     .END.','000028','000024','.EXE.','5','SRF->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','S_GETACUFE()     .CNT.','000029','000000','.EXE.','5','S_GETACUFE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','lMsg := Empty(nBaseFer)   .END.','000030','000000','.CON.','5','','','5','lMsg := Empty(nBaseFer)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','cIni := StrZero(Day(DtIniFer),2) + "/" + StrZero(Month(DtIni','000031','000030','.EXE.','5','cIni := StrZero(Day(DtIniFer),2) + "/" + StrZero(Month(DtIniFer),2) + "/" + StrZero(Year(DtIniFer),4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','cFim := StrZero(Day(DtFimFer),2) + "/" + StrZero(Month(DtFim','000032','000030','.EXE.','5','cFim := StrZero(Day(DtFimFer),2) + "/" + StrZero(Month(DtFimFer),2) + "/" + StrZero(Year(DtFimFer),4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','cMsgLog := fMsgForm({1}) + Space(1) + SRA->RA_MAT + " - " +','000033','000030','.EXE.','5','cMsgLog := fMsgForm({1}) + Space(1) + SRA->RA_MAT + " - " + fMsgForm({46}) + Space(1) + cIni + " - " + cFim','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','S_MSGLOG()     .END.','000034','000030','.EXE.','5','S_MSGLOG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','!lMsg   .END.','000035','000000','.CON.','5','','','5','!lMsg','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','DiasFerEqu(DTINIFER,DTFIMFER,@aDiasEqu)     .CNT.','000036','000035','.EXE.','5','DiasFerEqu(DTINIFER,DTFIMFER,@aDiasEqu)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','len(aDiasEqu) > 0   .END.','000037','000035','.CON.','5','','','5','len(aDiasEqu) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nDiasDir:= aDiasEqu[1] + aDiasEqu[2]     .CNT.','000038','000037','.EXE.','5','nDiasDir:= aDiasEqu[1] + aDiasEqu[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nDiasAdq:= aDiasEqu[3] + aDiasEqu[4]     .CNT.','000039','000037','.EXE.','5','nDiasAdq:= aDiasEqu[3] + aDiasEqu[4]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nAdicdias := aDiasEqu[4]     .CNT.','000040','000037','.EXE.','5','nAdicdias := aDiasEqu[4]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nAvos := aDiasEqu[3]     .CNT.','000041','000037','.EXE.','5','nAvos := aDiasEqu[3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvFer := nBaseFer / nDiasDir * nDiasAdq     .CNT.','000042','000037','.EXE.','5','nProvFer := nBaseFer / 24','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','NVALSUB :=  ( SRA->RA_SALARIO * P_PercProv)     .CNT.','000043','000037','.EXE.','5','NVALSUB :=  ( SRA->RA_SALARIO * P_PercProv)  / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvFer < nValSub   .END.','000044','000037','.CON.','5','','','5','nProvFer < nValSub','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nValDif :=  ( nValSub - nProvFer ) / 12     .CNT.','000045','000044','.EXE.','5','nValDif :=  ( nValSub - nProvFer ) / 12','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvFer +=  ( nValDif  * (int ((nAvos / 12) *10)))     .END','000046','000044','.EXE.','5','nProvFer +=  ( nValDif  * (int ((nAvos / 12) *10)))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nAdicDias > 0   .END.','000047','000037','.CON.','5','','','5','nAdicDias > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nValAdic :=   nAdicDias     .CNT.','000048','000047','.EXE.','5','nValAdic :=   nAdicDias   * Saldia','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvFer += (( nValAdic / 12 ) * (int ((nAvos / 12) *10)))','000049','000047','.EXE.','5','nProvFer += (( nValAdic / 12 ) * (int ((nAvos / 12) *10)))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvFer > 0   .END.','000050','000037','.CON.','5','','','5','nProvFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','cVrbAcFer:= fGetCodFol("911")     .CNT.','000051','000050','.EXE.','5','cVrbAcFer:= fGetCodFol("911")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','fBuscaAcm( cVrbAcFer, , DTINIFER, DTFIMFER, "V"	, @nAcProvFe','000052','000050','.EXE.','5','fBuscaAcm( cVrbAcFer, , DTINIFER, DTFIMFER, "V"	, @nAcProvFer, , , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvMFer := nProvFer - nAcProvFer     .CNT.','000053','000050','.EXE.','5','nProvMFer := nProvFer - nAcProvFer','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','nProvFer > 0.00   .END.','000054','000050','.CON.','5','','','5','nProvFer > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','fo_Add( @&cObjeto , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR','000055','000054','.EXE.','5','fo_Add( @&cObjeto , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR} , {fGetCodFol("910"), "V", nDiasAdq, nProvFer })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVVAC','fo_Add( @&cObjeto , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR','000056','000054','.EXE.','5','fo_Add( @&cObjeto , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR} , {fGetCodFol("911"), "V", 1.25 , nProvMFer })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )