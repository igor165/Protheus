#INCLUDE "PROTHEUS.CH"

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³GpForPTG      ³Autor³ Gerado pelo sistema ³ Data ³04/12/2012³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Formulas padroes                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function GpForPTG()

Local aRC2Header  := {}
Local aRC3Header  := {}
Local aSYPHeader  := {}

Local bForm	    := NIL

Local cFormNum
Local cForm

Local lRet        := .T.
Local nItem       := 0
Local cFil        := Alltrim(Str(FWGETTAMFILIAL))

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Cabecalho de RC2 e RC3 gerado pela formula padrao            ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
aAdd(aRC2Header, { 'Filial','RC2_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Origem','RC2_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','€€€€€€€€€€€€€€°','C','      ','R','S_=sistema;U_=utilizador                                                                                                        ','"U_"','','V','','','.F.' })
aAdd(aRC2Header, { 'Cód. Fórmula','RC2_CODIGO','@!','15','0','RC2CodigoVld()','€€€€€€€€€€€€€€°','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Desc.fórmula','RC2_DESC','@!','40','0','NaoVAzio()','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Retorno','RC2_RETURN','@!','10','0','Vazio() .or. ExistCpo("RCA")','€€€€€€€€€€€€€€°','C','RCA01 ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Cód. Obs.','RC2_CODOBS','@!','6','0','NaoVazio()','€€€€€€€€€€€€€€€','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Versão Fórm.','RC2_VERSAO','','3','0','','€€€€€€€€€€€€€€ˆ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Recompilar','RC2_RECOMP','9','1','0','Pertence("12")','€€€€€€€€€€€€€€€','C','      ','R','1=sim;2=não                                                                                                                     ','"1"','','V','','','.F.' })
aAdd(aRC2Header, { 'Modelo Folha','RC2_MODELO','@!','1','0','Pertence("12")','€€€€€€€€€€€€€€€','C','      ','R','1=Folha modelo 1;2=Folha modelo 2                                                                                               ','fGetModFol()','','V','','','.F.' })

aAdd(aRC3Header, { 'Filial','RC3_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Origem','RC3_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','€€€€€€€€€€€€€€°','C','      ','R','S_=sistema;U_=utilizador                                                                                                        ','"U_"','','V','','','.F.' })
aAdd(aRC3Header, { 'Cód. Fórmula','RC3_CODIGO','@!','15','0','','€€€€€€€€€€€€€€°','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC3Header, { 'Description','RC3_DESCR','@!S31','60','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Seq.','RC3_SEQFOR','999999','6','0','NaoVazio() .and. Gpea290SeqFor( .T. )','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','Gpea290SeqFor()','SeqWhen()',' ','','','.F.' })
aAdd(aRC3Header, { 'Cód Seq Pai','RC3_SEQPAI','999999','6','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Expr.','RC3_TIPO','@!','5','0','NaoVazio()','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp1','RC3_TPRESU','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"2"','','V','','','.F.' })
aAdd(aRC3Header, { 'Resultado','RC3_RESULT','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.1','RC3_OPERA1','@!','16','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp2','RC3_TPFM01','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '1ªexpressão','RC3_FORM01','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.2','RC3_OPERA2','@!','5','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp3','RC3_TPFM02','@!','1','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '2ªexpressão','RC3_FORM02','@!S25','250','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.3','RC3_OPERA3','@!','5','0','Gpea290Return()','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','".END."','',' ','','','.F.' })
aAdd(aRC3Header, { 'Imagem 1','RC3_RESOU1','@!','20','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Imagem 2','RC3_RESOU2','@!','20','0','','€€€€€€€€€€€€€€ ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })

aAdd(aSYPHeader, { 'Filial','YP_FILIAL','',,'0','','€€€€€€€€€€€€€€€','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Chave','YP_CHAVE','','6','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Seqüência','YP_SEQ','','3','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Linha','YP_TEXTO','','80','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Campo','YP_CAMPO','','10','0','','€€€€€€€€€€€€€€ ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Só carrega se estiver utilizando modelo padrão do pais.       ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
If !(MV_MODFOL == "1")
	Return
EndIf

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Validar a Estrutura das Tabela RC2 e RC3 com a do Cliente     ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
lRet := fNewOldSx3(aRC2Header, aRC3Header, "RC2", "RC3")
lRet := fNewOldSx3(aSYPHeader, NIL, "SYP")

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Executar gravacao da formula.                                 ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
IF ( lRet )

	/*/
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Chamada da funcao de gravacao                                ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
	cFormNum := "0000"
	For nItem := 1 To 124
		cFormNum	:= __Soma1( cFormNum )
		cForm		:= ( "Add" + cPaisLoc + cFormNum )
		IF IsFunction( cForm )
			bForm := __ExecMacro( '{ ||' +  cForm + '( aRc2Header , aRc3Header, aSYPHeader ) }' )
			CheckExecForm( bForm , .T. , 'ERRADDFRM' , cForm )
		EndIF
	Next nItem

EndIF

Return( NIL )


/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0001    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0001( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AJCUSTO','CALCULO DE AJUDA DE CUSTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','AJCUSTO','nRefAjCusPt := 0     .CNT.','000001','000000','.EXE.','5','nRefAjCusPt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nRefAjCusEx := 0     .CNT.','000002','000000','.EXE.','5','nRefAjCusEx := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nAjCusPtIsent := 0     .CNT.','000003','000000','.EXE.','5','nAjCusPtIsent := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nAjCusExIsent := 0     .CNT.','000004','000000','.EXE.','5','nAjCusExIsent := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nAjCusPtTrib := 0     .CNT.','000005','000000','.EXE.','5','nAjCusPtTrib := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nAjCusExTrib := 0     .CNT.','000006','000000','.EXE.','5','nAjCusExTrib := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValDiaPt := 0     .CNT.','000007','000000','.EXE.','5','nValDiaPt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValDiaEx := 0     .CNT.','000008','000000','.EXE.','5','nValDiaEx := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nLimPtg := 0     .CNT.','000009','000000','.EXE.','5','nLimPtg := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nLimEx := 0     .CNT.','000010','000000','.EXE.','5','nLimEx := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValPtg := 0     .CNT.','000011','000000','.EXE.','5','nValPtg := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValExt := 0     .CNT.','000012','000000','.EXE.','5','nValExt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nLinha := 0     .CNT.','000013','000000','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','dDtIni := ""     .CNT.','000014','000000','.EXE.','5','dDtIni := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','dDtFim := ""     .CNT.','000015','000000','.EXE.','5','dDtFim := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nDias := 0     .CNT.','000016','000000','.EXE.','5','nDias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','cCpoAux := ""     .CNT.','000017','000000','.EXE.','5','cCpoAux := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','FPOSREG("RH7", 1 , SRA->RA_FILIAL+SRA->RA_MAT )     .CNT.','000018','000000','.EXE.','5','FPOSREG("RH7", 1 , SRA->RA_FILIAL+SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','!RH7->(Eof()) .And. RH7->RH7_FILIAL+RH7->RH7_MAT == SRA->R','000019','000000','.ENQ.','5','','','5','!RH7->(Eof()) .And. RH7->RH7_FILIAL+RH7->RH7_MAT == SRA->RA_FILIAL+SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','(RH7->RH7_DTFIM >= dDataDe .OR. Empty(RH7->RH7_DTFIM)) .AN','000020','000019','.CON.','5','','','5','(RH7->RH7_DTFIM >= dDataDe .OR. Empty(RH7->RH7_DTFIM)) .AND. ((RH7->RH7_DTINI >= dDataDe .AND. RH7->RH7_DTINI <= dDataAte) .OR. (RH7->RH7_DTINI < dDataDe .AND. (Empty(RH7->RH7_DTFIM) .OR. RH7->RH7_DTFIM >= dDataDe ) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','dDtIni := Iif(RH7->RH7_DTINI >= dDataDe, RH7->RH7_DTINI, dDa','000021','000020','.EXE.','5','dDtIni := Iif(RH7->RH7_DTINI >= dDataDe, RH7->RH7_DTINI, dDataDe)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','Empty(RH7->RH7_DTFIM)   .END.','000022','000020','.CON.','5','','','5','Empty(RH7->RH7_DTFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','dDtFim := dDataAte     .END.','000023','000022','.EXE.','5','dDtFim := dDataAte','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','!Empty(RH7->RH7_DTFIM)   .END.','000024','000020','.CON.','5','','','5','!Empty(RH7->RH7_DTFIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','dDtFim := Iif(RH7->RH7_DTFIM <= dDataAte, RH7->RH7_DTFIM, dD','000025','000024','.EXE.','5','dDtFim := Iif(RH7->RH7_DTFIM <= dDataAte, RH7->RH7_DTFIM, dDataAte)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','FPOSREG("RCO", 1 , xFilial("RCO")+RH7->RH7_CESTAB ) == .T.','000026','000020','.CON.','5','','','5','FPOSREG("RCO", 1 , xFilial("RCO")+RH7->RH7_CESTAB ) == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','UPPER (RCO->RCO_CDPAIS) == '+"'"+'PT'+"'"+'   .END.','000027','000026','.CON.','5','','','5','UPPER (RCO->RCO_CDPAIS) == '+"'"+'PT'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','GpeCalend(,,,,,dDtIni,dDtFim,@nDias,"D", cCpoAux, .F.)     .','000028','000027','.EXE.','5','GpeCalend(,,,,,dDtIni,dDtFim,@nDias,"D", cCpoAux, .F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nRefAjCusPt += nDias     .END.','000029','000027','.EXE.','5','nRefAjCusPt += nDias','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','!UPPER(RCO->RCO_CDPAIS) == "PT"   .END.','000030','000026','.CON.','5','','','5','!UPPER(RCO->RCO_CDPAIS) == "PT"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nDias := DATEDIFFDAY( dDtIni , dDtFim ) + 1     .CNT.','000031','000030','.EXE.','5','nDias := DATEDIFFDAY( dDtIni , dDtFim ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nRefAjCusEx += nDias     .END.','000032','000030','.EXE.','5','nRefAjCusEx += nDias','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nDias := 0     .END.','000033','000026','.EXE.','5','nDias := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','RH7->(DbSkip())     .END.','000034','000019','.EXE.','5','RH7->(DbSkip())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','SRA->RA_CODCUST <> SPACE(2) .And. (nRefAjCusPt > 0 .Or. nR','000035','000000','.CON.','5','','','5','SRA->RA_CODCUST <> SPACE(2) .And. (nRefAjCusPt > 0 .Or. nRefAjCusEx > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','(nLinha := FPOSTAB("S030", SRA->RA_CODCUST, "=" , 4 )) > 0','000036','000035','.CON.','5','','','5','(nLinha := FPOSTAB("S030", SRA->RA_CODCUST, "=" , 4 )) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nLimPtg := FTABELA( "S030" , nLinha , 8)     .CNT.','000037','000036','.EXE.','5','nLimPtg := FTABELA( "S030" , nLinha , 8)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValDiaPt := FTABELA( "S030" , nLinha , 6)     .CNT.','000038','000036','.EXE.','5','nValDiaPt := FTABELA( "S030" , nLinha , 6)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nLimEx := FTABELA( "S030" , nLinha , 9)     .CNT.','000039','000036','.EXE.','5','nLimEx := FTABELA( "S030" , nLinha , 9)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValDiaEx := FTABELA( "S030" , nLinha , 7)     .CNT.','000040','000036','.EXE.','5','nValDiaEx := FTABELA( "S030" , nLinha , 7)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','!SRA->RA_AJCUSPT == 0   .END.','000041','000036','.CON.','5','','','5','!SRA->RA_AJCUSPT == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValDiaPt := SRA->RA_AJCUSPT     .END.','000042','000041','.EXE.','5','nValDiaPt := SRA->RA_AJCUSPT','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','!SRA->RA_AJCUSES == 0   .END.','000043','000036','.CON.','5','','','5','!SRA->RA_AJCUSES == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValDiaEx := SRA->RA_AJCUSES     .END.','000044','000043','.EXE.','5','nValDiaEx := SRA->RA_AJCUSES','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValPtg := nRefAjCusPt * nValDiaPt     .CNT.','000045','000036','.EXE.','5','nValPtg := nRefAjCusPt * nValDiaPt','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nAjCusPtIsent := If (nLimPtg > nValPtg, nValPtg,  nLimPtg )','000046','000036','.EXE.','5','nAjCusPtIsent := If (nLimPtg > nValPtg, nValPtg,  nLimPtg )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nAjCusPtTrib := nValPtg - nLimPtg     .CNT.','000047','000036','.EXE.','5','nAjCusPtTrib := nValPtg - nLimPtg','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nValExt := nRefAjCusEx * nValDiaEx     .CNT.','000048','000036','.EXE.','5','nValExt := nRefAjCusEx * nValDiaEx','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nAjCusExIsent := If (nLimEx > nValExt, nValExt,  nLimEx )','000049','000036','.EXE.','5','nAjCusExIsent := If (nLimEx > nValExt, nValExt,  nLimEx )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AJCUSTO','nAjCusExTrib := nValExt - nLimEx     .END.','000050','000036','.EXE.','5','nAjCusExTrib := nValExt - nLimEx','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0002    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0002( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AMEDICA','CALCULO ASSISTENCIA MEDICA','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','AMEDICA','FGETCODFOL("049") # Space(3) .And. SRA->RA_ASMEDIC # Space','000001','000000','.CON.','5','','','5','FGETCODFOL("049") # Space(3) .And. SRA->RA_ASMEDIC # Space(02)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','( cTipoRot = "4" .and. ( cCompl # "S" .OR. (cCompl == "S"','000002','000001','.CON.','5','','','5','( cTipoRot = "4" .and. ( cCompl # "S" .OR. (cCompl == "S" .and. MesAno(GetMemVar("RG_DATADEM")) == MesAno(GetMemVar("RG_DTGERAR")) ) .And. aIncRes[11] = "S"))','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','( cTipoRot = "1" .and. ( SRA->RA_TIPOPGT # "S" .or. ( SRA-','000003','000001','.CON.','5','','','5','( cTipoRot = "1" .and. ( SRA->RA_TIPOPGT # "S" .or. ( SRA->RA_TIPOPGT == "S" .and. lUltSemana)))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nBusca := SALMES     .CNT.','000004','000003','.EXE.','5','nBusca := SALMES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTab := "S016"     .CNT.','000005','000003','.EXE.','5','cTab := "S016"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','SRA->RA_TIPAMED = "2"   .END.','000006','000003','.CON.','5','','','5','SRA->RA_TIPAMED = "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nBusca := Val(Left(cAnoMes,4)) - Year(SRA->RA_NASC)     .CNT','000007','000006','.EXE.','5','nBusca := Val(Left(cAnoMes,4)) - Year(SRA->RA_NASC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTab := "S017"     .CNT.','000008','000006','.EXE.','5','cTab := "S017"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','Month(SRA->RA_NASC) > Val(Right(cAnoMes,2))   .END.','000009','000006','.CON.','5','','','5','Month(SRA->RA_NASC) > Val(Right(cAnoMes,2))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nBusca --     .END.','000010','000009','.EXE.','5','nBusca --','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','(nLinha := fPosTab(cTab,SRA->RA_ASMEDIC,"=",4,nBusca,"<=",','000011','000003','.CON.','5','','','5','(nLinha := fPosTab(cTab,SRA->RA_ASMEDIC,"=",4,nBusca,"<=",6)  ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','TITULAR := fTabela(cTab,nLinha,7)     .CNT.','000012','000011','.EXE.','5','TITULAR := fTabela(cTab,nLinha,7)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nPerTit := fTabela(cTab,nLinha,10) / 100     .CNT.','000013','000011','.EXE.','5','nPerTit := fTabela(cTab,nLinha,10) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_TIT := TITULAR * nPerTit     .CNT.','000014','000011','.EXE.','5','NAMED_TIT := TITULAR * nPerTit','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_DEP := NAMED_AGR := 0     .CNT.','000015','000011','.EXE.','5','NAMED_DEP := NAMED_AGR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_EMPT := TITULAR - NAMED_TIT     .CNT.','000016','000011','.EXE.','5','NAMED_EMPT := TITULAR - NAMED_TIT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','FO_GOTOP(@oSRB)     .CNT.','000017','000011','.EXE.','5','FO_GOTOP(@oSRB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','!FO_EOF(@oSRB)   .END.','000018','000011','.ENQ.','5','','','5','!FO_EOF(@oSRB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTipAmed := FO_GETVAL(@oSRB,"RB_TIPAMED")     .CNT.','000019','000018','.EXE.','5','cTipAmed := FO_GETVAL(@oSRB,"RB_TIPAMED")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cCodAmed := FO_GETVAL(@oSRB,"RB_CODAMED")     .CNT.','000020','000018','.EXE.','5','cCodAmed := FO_GETVAL(@oSRB,"RB_CODAMED")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTipDep := FO_GETVAL(@oSRB,"RB_TPDEPAM")     .CNT.','000021','000018','.EXE.','5','cTipDep := FO_GETVAL(@oSRB,"RB_TPDEPAM")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nBusca := SALMES     .CNT.','000022','000018','.EXE.','5','nBusca := SALMES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTab := "S016"     .CNT.','000023','000018','.EXE.','5','cTab := "S016"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTipAmed = "2"   .END.','000024','000018','.CON.','5','','','5','cTipAmed = "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','dDtNasc := FO_GETVAL(@oSRB,"RB_DTNASC")     .CNT.','000025','000024','.EXE.','5','dDtNasc := FO_GETVAL(@oSRB,"RB_DTNASC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nBusca := Val(Left(cAnoMes,4)) - Year(dDtNasc)     .CNT.','000026','000024','.EXE.','5','nBusca := Val(Left(cAnoMes,4)) - Year(dDtNasc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTab := "S017"     .CNT.','000027','000024','.EXE.','5','cTab := "S017"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','Month(dDtNasc) > Val(Right(cAnoMes,2))   .END.','000028','000024','.CON.','5','','','5','Month(dDtNasc) > Val(Right(cAnoMes,2))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nBusca --     .END.','000029','000028','.EXE.','5','nBusca --','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','(nLinha := fPosTab(cTab,cCodAmed,"=",4,nBusca,"<=",6)  ) >','000030','000018','.CON.','5','','','5','(nLinha := fPosTab(cTab,cCodAmed,"=",4,nBusca,"<=",6)  ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','DEPASME := fTabela(cTab,nLinha,8)   .CNT.','000031','000030','.EXE.','5','DEPASME',':=','5','fTabela(cTab,nLinha,8)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','AGREGADO := fTabela(cTab,nLinha,9)     .CNT.','000032','000030','.EXE.','5','AGREGADO := fTabela(cTab,nLinha,9)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nPerDep := fTabela(cTab,nLinha,11) /100     .CNT.','000033','000030','.EXE.','5','nPerDep := fTabela(cTab,nLinha,11) /100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','nPerAgr := fTabela(cTab,nLinha,12) / 100     .CNT.','000034','000030','.EXE.','5','nPerAgr := fTabela(cTab,nLinha,12) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTipDep = "1"   .END.','000035','000030','.CON.','5','','','5','cTipDep = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_DEP += ( DEPASME * nPerDep )     .CNT.','000036','000035','.EXE.','5','NAMED_DEP += ( DEPASME * nPerDep )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_EMPD +=  ( DEPASME - ( DEPASME * nPerDep ))     .CNT.','000037','000035','.EXE.','5','NAMED_EMPD +=  ( DEPASME - ( DEPASME * nPerDep ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_QTDP ++     .END.','000038','000035','.EXE.','5','NAMED_QTDP ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','cTipDep = "2"   .END.','000039','000030','.CON.','5','','','5','cTipDep = "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_AGR += ( AGREGADO * nPerAgr )     .CNT.','000040','000039','.EXE.','5','NAMED_AGR += ( AGREGADO * nPerAgr )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_EMPA +=  ( AGREGADO - ( AGREGADO * nPerAgr ) )     .CN','000041','000039','.EXE.','5','NAMED_EMPA +=  ( AGREGADO - ( AGREGADO * nPerAgr ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','NAMED_QTAG ++     .END.','000042','000039','.EXE.','5','NAMED_QTAG ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AMEDICA','FO_SKIP(@oSRB)     .END.','000043','000018','.EXE.','5','FO_SKIP(@oSRB)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0003    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0003( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AUS13PT','AUSENCIA PARA SUBSIDIO DE NATAL','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','AUS13PT','NAUS13PT := 0     .CNT.','000001','000000','.EXE.','5','NAUS13PT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','aArea := GetArea()     .CNT.','000002','000000','.EXE.','5','aArea := GetArea()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','!Empty(SRA->RA_CODIRCT)   .END.','000003','000000','.CON.','5','','','5','!Empty(SRA->RA_CODIRCT)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','cAusIRCT := Posicione("RGD",1,xFilial("RGD")+SRA->RA_CODIRCT','000004','000003','.EXE.','5','cAusIRCT := Posicione("RGD",1,xFilial("RGD")+SRA->RA_CODIRCT,"RGD_CDFNAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','!Empty(cAusIRCT)   .END.','000005','000003','.CON.','5','','','5','!Empty(cAusIRCT)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','nPdAus := 1     .CNT.','000006','000005','.EXE.','5','nPdAus := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','dDataIni   := CTOD("01/01/"+Substr(cAnoMes,1,4))     .CNT.','000007','000005','.EXE.','5','dDataIni   := CTOD("01/01/"+Substr(cAnoMes,1,4))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','dDataFim   := CTOD("31/12/"+Substr(cAnoMes,1,4))     .CNT.','000008','000005','.EXE.','5','dDataFim   := CTOD("31/12/"+Substr(cAnoMes,1,4))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','cStrPD := ""     .CNT.','000009','000005','.EXE.','5','cStrPD := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','nPdAus <= Len(AllTrim(cAusIRCT))   .END.','000010','000005','.ENQ.','5','','','5','nPdAus <= Len(AllTrim(cAusIRCT))','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','cTipoAus := Substr(cAusIRCT,nPdAus,3)     .CNT.','000011','000010','.EXE.','5','cTipoAus := Substr(cAusIRCT,nPdAus,3)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','fo_Seek(@oRCM,"RCM_TIPO",cTipoAus)   .END.','000012','000010','.CON.','5','','','5','fo_Seek(@oRCM,"RCM_TIPO",cTipoAus)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','cStrPd += fo_GetVal( @oRCM , "RCM_PD" )     .END.','000013','000012','.EXE.','5','cStrPd += fo_GetVal( @oRCM , "RCM_PD" )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','nPdAus += 3     .CNT.','000014','000010','.EXE.','5','nPdAus += 3','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','nPdAus <= Len(AllTrim(cAusIRCT))   .END.','000015','000010','.CON.','5','','','5','nPdAus <= Len(AllTrim(cAusIRCT))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','cStrPd += "/"     .END.','000016','000015','.EXE.','5','cStrPd += "/"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','NAUS13PT  := fBuscaAcm(cStrPd,,dDataIni,dDataFim,"H")     .E','000017','000005','.EXE.','5','NAUS13PT  := fBuscaAcm(cStrPd,,dDataIni,dDataFim,"H")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUS13PT','RestArea(aArea)     .END.','000018','000000','.EXE.','5','RestArea(aArea)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0004    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0004( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AVISOPTG','CALCULA AVISO PREVIO PORTUGAL','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','AVISOPTG','FTABELA("S021",VAL(CTIPRES),11) == "S"   .END.','000001','000000','.CON.','5','','','5','FTABELA("S021",VAL(CTIPRES),11) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','NFATOR := 0     .CNT.','000002','000001','.EXE.','5','NFATOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','LIF := ( CTIPRES <> "11" )   .END.','000003','000001','.CON.','5','','','5','LIF := ( CTIPRES <> "11" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','CVERBA := FGETCODFOL("0111")     .CNT.','000004','000003','.EXE.','5','CVERBA := FGETCODFOL("0111")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','NFATOR := 2     .END.','000005','000003','.EXE.','5','NFATOR := 2','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','!LIF   .END.','000006','000001','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','CVERBA := FGETCODFOL("0113")     .CNT.','000007','000006','.EXE.','5','CVERBA := FGETCODFOL("0113")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','LIF := (SRA->RA_TIPOCO = "01")   .END.','000008','000006','.CON.','5','','','5','LIF := (SRA->RA_TIPOCO = "01")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','NFATOR := IF(ANTIGUIDADE<=2,1,2)     .END.','000009','000008','.EXE.','5','NFATOR := IF(ANTIGUIDADE<=2,1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','LIF := (SRA->RA_TIPOCO $ "02*03")   .END.','000010','000006','.CON.','5','','','5','LIF := (SRA->RA_TIPOCO $ "02*03")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','NFATOR := IF(NMESESCON<6,1/2,1)     .END.','000011','000010','.EXE.','5','NFATOR := IF(NMESESCON<6,1/2,1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','NVALOR := SALMES * NFATOR     .CNT.','000012','000001','.EXE.','5','NVALOR := SALMES * NFATOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','NVALOR > 0 .AND. !EMPTY(CVERBA)   .END.','000013','000001','.CON.','5','','','5','NVALOR > 0 .AND. !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVISOPTG','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {CVERBA,NFAT','000014','000013','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {CVERBA,NFATOR * 30,NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0005    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0005( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEATVF','BASE H.ATIV. PROFESSOR (FIXAS)','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEATVF','SRA->RA_CATFUNC $ "I*J" .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"I*J"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','NBSHRSATIV := 0     .CNT.','000002','000001','.EXE.','5','NBSHRSATIV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','FO_GOTOP(@oSRO)     .CNT.','000003','000001','.EXE.','5','FO_GOTOP(@oSRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','!FO_EOF(@oSRO)   .END.','000004','000001','.ENQ.','5','','','5','!FO_EOF(@oSRO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','cVerba := FO_GETVAL(@oSRO,"RO_VERBA")     .CNT.','000005','000004','.EXE.','5','cVerba := FO_GETVAL(@oSRO,"RO_VERBA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','cTpVerba := FO_GETVAL(@oSRO,"RO_TIPO")     .CNT.','000006','000004','.EXE.','5','cTpVerba := FO_GETVAL(@oSRO,"RO_TIPO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','PosSrv(cVerba,SRA->RA_FILIAL,"RV_HRSATIV") == "S" .END.','000007','000004','.CON.','5','','','5','PosSrv(cVerba,SRA->RA_FILIAL,"RV_HRSATIV")  == "S" .And. cTpVerba == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','NBSHRSATIV += FO_GETVAL(@oSRO,"RO_VALTOT")   .END.','000008','000007','.EXE.','5','NBSHRSATIV','+=','5','FO_GETVAL(@oSRO,"RO_VALTOT")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','FO_SKIP(@oSRO)     .END.','000009','000004','.EXE.','5','FO_SKIP(@oSRO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','nBsHrsAtiv += IF(PosSrv(FGETCODFOL("033"),SRA->RA_FILIAL,"RV','000010','000001','.EXE.','5','nBsHrsAtiv += IF(PosSrv(FGETCODFOL("033"),SRA->RA_FILIAL,"RV_HRSATIV") = "S",(nBsHrsAtiv*aParProf[2] ),0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0006    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0006( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEATVV','BASE H. ATV  PROF. ( VARIAV )','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEATVV','SRA->RA_CATFUNC $ "I*J" .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"I*J"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','NBSHATVVAR := 0     .CNT.','000002','000001','.EXE.','5','NBSHATVVAR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','FO_GOTOP(@oSRO)     .CNT.','000003','000001','.EXE.','5','FO_GOTOP(@oSRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','!FO_EOF(@oSRO)   .END.','000004','000001','.ENQ.','5','','','5','!FO_EOF(@oSRO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','cVerba := FO_GETVAL(@oSRO,"RO_VERBA")     .CNT.','000005','000004','.EXE.','5','cVerba := FO_GETVAL(@oSRO,"RO_VERBA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','cTpVerba := FO_GETVAL(@oSRO,"RO_TIPO")     .CNT.','000006','000004','.EXE.','5','cTpVerba := FO_GETVAL(@oSRO,"RO_TIPO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','PosSrv(cVerba,SRA->RA_FILIAL,"RV_HRSATIV")   == "S" .and.','000007','000004','.CON.','5','','','5','PosSrv(cVerba,SRA->RA_FILIAL,"RV_HRSATIV")   == "S" .and. cTpVerba == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','NBSHATVVAR += FO_GETVAL(@oSRO,"RO_VALTOT")   .END.','000008','000007','.EXE.','5','NBSHATVVAR','+=','5','FO_GETVAL(@oSRO,"RO_VALTOT")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','FO_SKIP(@oSRO)     .END.','000009','000004','.EXE.','5','FO_SKIP(@oSRO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','FO_GOTOP(@&cObjeto)     .CNT.','000010','000001','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','!FO_EOF(@&cObjeto)   .END.','000011','000001','.ENQ.','5','','','5','!FO_EOF(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','cVerba := FO_GETVAL(@&cObjeto,cCpoPd)     .CNT.','000012','000011','.EXE.','5','cVerba := FO_GETVAL(@&cObjeto,cCpoPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','cTpVerba := FO_GETVAL(@&cObjeto,cCpoTipo2)     .CNT.','000013','000011','.EXE.','5','cTpVerba := FO_GETVAL(@&cObjeto,cCpoTipo2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','PosSrv(cVerba,SRA->RA_FILIAL,"RV_HRSATIV")   == "S" .AND.','000014','000011','.CON.','5','','','5','PosSrv(cVerba,SRA->RA_FILIAL,"RV_HRSATIV")   == "S" .AND. cTpVerba = "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','NBSHATVVAR += FO_GETVAL(@&cObjeto,cCpoValor)   .END.','000015','000014','.EXE.','5','NBSHATVVAR','+=','5','FO_GETVAL(@&cObjeto,cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','FO_SKIP(@&cObjeto)     .END.','000016','000011','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVV','NBSHATVVAR += IF (PosSrv(FGETCODFOL("602"),SRA->RA_FILIAL,"R','000017','000001','.EXE.','5','NBSHATVVAR += IF (PosSrv(FGETCODFOL("602"),SRA->RA_FILIAL,"RV_HRSATIV") = "S",(nBsDsrVar*aParProf[2] ),0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0007    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0007( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEDSRT','BASE DSR TAREFEIRO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEDSRT','SRA->RA_CATFUNC = "T"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC = "T"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','aDsrAux := {}     .CNT.','000002','000001','.EXE.','5','aDsrAux := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','FO_GOTOP(@oSRO)     .CNT.','000003','000001','.EXE.','5','FO_GOTOP(@oSRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','!FO_EOF(@oSro)   .END.','000004','000001','.ENQ.','5','','','5','!FO_EOF(@oSro)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nPos := Ascan( aDsrAux, { |X| X[2] == FO_GETVAL(@oSRO,"RO_CC','000005','000004','.EXE.','5','nPos := Ascan( aDsrAux, { |X| X[2] == FO_GETVAL(@oSRO,"RO_CC") .And. X[3] == FO_GETVAL(@oSRO,"RO_DATA") } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nPos > 0   .END.','000006','000004','.CON.','5','','','5','nPos > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','aDsrAux[nPos,1] += FO_GETVAL(@oSRO,"RO_VALTOT")     .END.','000007','000006','.EXE.','5','aDsrAux[nPos,1] += FO_GETVAL(@oSRO,"RO_VALTOT")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nPos = 0   .END.','000008','000004','.CON.','5','','','5','nPos = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','Aadd( aDsrAux, { FO_GETVAL(@oSRO,"RO_VALTOT"),  FO_GETVAL(@o','000009','000008','.EXE.','5','Aadd( aDsrAux, { FO_GETVAL(@oSRO,"RO_VALTOT"),  FO_GETVAL(@oSRO,"RO_CC"),FO_GETVAL(@oSRO,"RO_DATA")})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','FO_SKIP(@oSRO)     .END.','000010','000004','.EXE.','5','FO_SKIP(@oSRO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nCnt := 1     .CNT.','000011','000001','.EXE.','5','nCnt := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','cCcGerados  := ""     .CNT.','000012','000001','.EXE.','5','cCcGerados  := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nCnt <= Len(aDsrAux)   .END.','000013','000001','.ENQ.','5','','','5','nCnt <= Len(aDsrAux)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','!aDsrAux[nCnt,2] $ cCcGerados   .END.','000014','000013','.CON.','5','','','5','!aDsrAux[nCnt,2] $ cCcGerados','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nValdsr := nNroTar := 0     .CNT.','000015','000014','.EXE.','5','nValdsr := nNroTar := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','cCcGerados += aDsrAux[nCnt,2]+"*"     .CNT.','000016','000014','.EXE.','5','cCcGerados += aDsrAux[nCnt,2]+"*"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','Aeval( aDsrAux, {|X| If( X[2]==aDsrAux[nCnt,2], nValDsr  +=','000017','000014','.EXE.','5','Aeval( aDsrAux, {|X| If( X[2]==aDsrAux[nCnt,2], nValDsr  += X[1], "") } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','Aeval( aDsrAux, {|X| If( X[2]==aDsrAux[nCnt,2], nNroTar ++','000018','000014','.EXE.','5','Aeval( aDsrAux, {|X| If( X[2]==aDsrAux[nCnt,2], nNroTar ++     , "") } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','Aadd(  aDsrTarefa , { FGETCODFOL("033") , Round( nValDsr / n','000019','000014','.EXE.','5','Aadd(  aDsrTarefa , { FGETCODFOL("033") , Round( nValDsr / nNroTar, 2 ), nNroTar, aDsrAux[nCnt,2] } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nCnt ++     .END.','000020','000013','.EXE.','5','nCnt ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0008    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0008( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEFER','OBTEM DATA BASE DE FERIAS','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEFER','DFIM := IF(CTIPOROT="4",DDATADEM,DDATAATE)     .CNT.','000001','000000','.EXE.','5','DFIM := IF(CTIPOROT="4",DDATADEM,DDATAATE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GOTOP(@OSRF)     .CNT.','000002','000000','.EXE.','5','FO_GOTOP(@OSRF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','!FO_EOF(@OSRF)   .END.','000003','000000','.ENQ.','5','','','5','!FO_EOF(@OSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEFER','( FO_GETVAL(@OSRF,"RF_PD") == FGETCODFOL("0072") ) .AND. (','000004','000003','.CON.','5','','','5','( FO_GETVAL(@OSRF,"RF_PD") == FGETCODFOL("0072") ) .AND. ( FO_GETVAL(@OSRF,"RF_DATABAS") <= DFIM )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"   .END.','000005','000004','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEFER','DFERINI := FO_GETVAL(@OSRF,"RF_DATABAS")     .CNT.','000006','000005','.EXE.','5','DFERINI := FO_GETVAL(@OSRF,"RF_DATABAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','DFERFIM := FO_GETVAL(@OSRF,"RF_DATAFIM")     .CNT.','000007','000005','.EXE.','5','DFERFIM := FO_GETVAL(@OSRF,"RF_DATAFIM")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_GOBOTTOM(@OSRF)     .END.','000008','000005','.EXE.','5','FO_GOBOTTOM(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','FO_SKIP(@OSRF)     .END.','000009','000003','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','DFERFIM := MIN (DFERFIM, DDATADEM)     .CNT.','000010','000000','.EXE.','5','DFERFIM := MIN (DFERFIM, DDATADEM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEFER','!EMPTY(DFERFIM) .AND. !EMPTY(DFERINI)   .END.','000011','000000','.CON.','5','','','5','!EMPTY(DFERFIM) .AND. !EMPTY(DFERINI)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEFER','NMESESCON := ( Month(dFerFim ) /  30 ) + DateDiffMonth( DFER','000012','000011','.EXE.','5','NMESESCON := ( Month(dFerFim ) /  30 ) + DateDiffMonth( DFERINI , DFERFIM )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0009    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0009( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPROFER','REALIZA BAIXA PROVISAO FERIAS','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPROFER','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CVERBX1 := FGETCODFOL("0233")     .CNT.','000002','000001','.EXE.','5','CVERBX1 := FGETCODFOL("0233")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR','000003','000001','.EXE.','5','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR+DTOS(RC_DATA)")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBX := 0     .CNT.','000004','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX := 0     .CNT.','000005','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRH", RETORDER("SRH","RH_FILIAL+RH_MAT+RH_ROTEIR+','000006','000001','.CON.','5','','','5','FPOSREG("SRH", RETORDER("SRH","RH_FILIAL+RH_MAT+RH_ROTEIR+DTOS(RH_DTRECIB)") , SRA->RA_FILIAL+SRA->RA_MAT+"FER"+ANOMES(DDATAATE) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000007','000006','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0072")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBX += SRC->RC_HORAS     .CNT.','000008','000007','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX += SRC->RC_VALOR     .END.','000009','000007','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000010','000006','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0075")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBX += SRC->RC_HORAS     .CNT.','000011','000010','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX += SRC->RC_VALOR     .END.','000012','000010','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000013','000006','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0084")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBX += SRC->RC_HORAS     .CNT.','000014','000013','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX += SRC->RC_VALOR     .END.','000015','000013','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX > 0 .AND. !EMPTY(CVERBX1)   .END.','000016','000006','.CON.','5','','','5','NVALBX > 0 .AND. !EMPTY(CVERBX1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX','000017','000016','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX, NVALBX})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})   .END.','000018','000016','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','000019','000018','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','CVERBX2 := FGETCODFOL("0262")     .CNT.','000020','000001','.EXE.','5','CVERBX2 := FGETCODFOL("0262")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBX := 0     .CNT.','000021','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX := 0     .CNT.','000022','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRG", 1 , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATA','000023','000001','.CON.','5','','','5','FPOSREG("SRG", 1 , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATAATE))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000024','000023','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0087")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBX += SRC->RC_HORAS     .CNT.','000025','000024','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX += SRC->RC_VALOR     .END.','000026','000024','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000027','000023','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0249")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NHORBX += SRC->RC_HORAS     .CNT.','000028','000027','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX += SRC->RC_VALOR     .END.','000029','000027','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','NVALBX > 0 .AND. !EMPTY(CVERBX2)   .END.','000030','000023','.CON.','5','','','5','NVALBX > 0 .AND. !EMPTY(CVERBX2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX2, NHORBX','000031','000030','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX2, NHORBX, NVALBX})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})   .END.','000032','000030','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROFER','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','000033','000032','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0010    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0010( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPROV13','REALIZA BAIXA PROVISAO 13 SALARIO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPROV13','NTIPOPRV > 1   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CVERBX1 := FGETCODFOL("0332")     .CNT.','000002','000001','.EXE.','5','CVERBX1 := FGETCODFOL("0332")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR','000003','000001','.EXE.','5','NINDSRC := RETORDER("SRC", "RC_FILIAL+RC_MAT+RC_PD+RC_ROTEIR+DTOS(RC_DATA)")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX := 0     .CNT.','000004','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX := 0     .CNT.','000005','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000006','000001','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0024")+"NAT")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += SRC->RC_HORAS     .CNT.','000007','000006','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRC->RC_VALOR     .END.','000008','000006','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000009','000001','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0123")+"NAT")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += SRC->RC_HORAS     .CNT.','000010','000009','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRC->RC_VALOR     .END.','000011','000009','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000012','000001','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0124")+"NAT")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += SRC->RC_HORAS     .CNT.','000013','000012','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRC->RC_VALOR     .END.','000014','000012','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000015','000001','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0022"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','SRC->(!EOF()) .AND. SRC->RC_MAT == SRA->RA_MAT .AND. SRC->','000016','000015','.ENQ.','5','','','5','SRC->(!EOF()) .AND. SRC->RC_MAT == SRA->RA_MAT .AND. SRC->RC_PD == FGETCODFOL("0022") .AND. SUBSTR( MESANO(SRC->RC_DATA),1,4) == SUBSTR( CANOMES ,1,4)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += SRC->RC_HORAS     .CNT.','000017','000016','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRC->RC_VALOR     .CNT.','000018','000016','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','SRC->(DBSKIP())     .END.','000019','000016','.EXE.','5','SRC->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRD", 6 , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("','000020','000001','.CON.','5','','','5','FPOSREG("SRD", 6 , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0022"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','SRD->(!EOF()) .AND. SRD->RD_MAT == SRA->RA_MAT .AND. SRD->','000021','000020','.ENQ.','5','','','5','SRD->(!EOF()) .AND. SRD->RD_MAT == SRA->RA_MAT .AND. SRD->RD_PD == FGETCODFOL("0022") .AND. SUBSTR(SRD->RD_DATARQ ,1,4) == SUBSTR( CANOMES ,1,4)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += SRD->RD_HORAS     .CNT.','000022','000021','.EXE.','5','NHORBX += SRD->RD_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRD->RD_VALOR     .CNT.','000023','000021','.EXE.','5','NVALBX += SRD->RD_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','SRD->(DBSKIP())     .END.','000024','000021','.EXE.','5','SRD->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX > 0 .AND. !EMPTY(CVERBX1)   .END.','000025','000001','.CON.','5','','','5','NVALBX > 0 .AND. !EMPTY(CVERBX1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX','000026','000025','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX, NVALBX})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})   .END.','000027','000025','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','000028','000027','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','CVERBX2 := FGETCODFOL("0274")     .CNT.','000029','000001','.EXE.','5','CVERBX2 := FGETCODFOL("0274")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX := 0     .CNT.','000030','000001','.EXE.','5','NHORBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX := 0     .CNT.','000031','000001','.EXE.','5','NVALBX := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRG", 1 , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATA','000032','000001','.CON.','5','','','5','FPOSREG("SRG", 1 , SRA->RA_FILIAL+SRA->RA_MAT+ANOMES(DDATAATE))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCO','000033','000032','.CON.','5','','','5','FPOSREG("SRC", NINDSRC , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0025")+"FOL")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NHORBX += SRC->RC_HORAS     .CNT.','000034','000033','.EXE.','5','NHORBX += SRC->RC_HORAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX += SRC->RC_VALOR     .END.','000035','000033','.EXE.','5','NVALBX += SRC->RC_VALOR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','NVALBX > 0 .AND. !EMPTY(CVERBX1)   .END.','000036','000032','.CON.','5','','','5','NVALBX > 0 .AND. !EMPTY(CVERBX1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX','000037','000036','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVERBX1, NHORBX, NVALBX})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})   .END.','000038','000036','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPROV13','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','000039','000038','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,FO_GETVAL(@OSRC,CCPOVALOR)-NVALBX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0011    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0011( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALABOFA','CALCULO DO ABONO POR FALHAS','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CALABOFA','nAboFalIsent := 0     .CNT.','000001','000000','.EXE.','5','nAboFalIsent := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nAboFalTrib := 0     .CNT.','000002','000000','.EXE.','5','nAboFalTrib := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nVlAbono := 0     .CNT.','000003','000000','.EXE.','5','nVlAbono := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nVlLimite := 0     .CNT.','000004','000000','.EXE.','5','nVlLimite := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nPercAboFal := 0     .CNT.','000005','000000','.EXE.','5','nPercAboFal := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nLinha := 0     .CNT.','000006','000000','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','FGETCODFOL("0494")<>SPACE(3)   .END.','000007','000000','.CON.','5','','','5','FGETCODFOL("0494")<>SPACE(3)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','(nLinha := FPOSTAB("S032", SRA->RA_CODIRCT, "=" , 4 )) > 0','000008','000007','.CON.','5','','','5','(nLinha := FPOSTAB("S032", SRA->RA_CODIRCT, "=" , 4 )) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nVlLimite := FTABELA( "S032" , nLinha , 5)     .CNT.','000009','000008','.EXE.','5','nVlLimite := FTABELA( "S032" , nLinha , 5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nPercAboFal := FTABELA( "S032" , nLinha , 6)     .CNT.','000010','000008','.EXE.','5','nPercAboFal := FTABELA( "S032" , nLinha , 6)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nVlLimite > 0 .And. nPercAboFal > 0   .END.','000011','000008','.CON.','5','','','5','nVlLimite > 0 .And. nPercAboFal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nVlAbono := SALMES * nPercAboFal / 100     .CNT.','000012','000011','.EXE.','5','nVlAbono := SALMES * nPercAboFal / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nAboFalIsent := If (nVlLimite > nVlAbono, nVlAbono,  nVlLimi','000013','000011','.EXE.','5','nAboFalIsent := If (nVlLimite > nVlAbono, nVlAbono,  nVlLimite )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALABOFA','nAboFalTrib := nVlAbono - nVlLimite     .END.','000014','000011','.EXE.','5','nAboFalTrib := nVlAbono - nVlLimite','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0012    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0012( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALANTIG','CALCULA ANTIGUIDADE DO FUNCIONARIO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CALANTIG','NDIASANO > 0   .END.','000001','000000','.CON.','5','','','5','NDIASANO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALANTIG','ANTIGUIDADE := DATEDIFFDAY( SRA->RA_ADMISSA , DDATADEM ) / N','000002','000001','.EXE.','5','ANTIGUIDADE := DATEDIFFDAY( SRA->RA_ADMISSA , DDATADEM ) / NDIASANO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0013    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0013( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCADI','CALCULO DO ADIANTAMENTO DE SALARIO','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCADI','SRA->RA_PERCADT <= 0   .END.','000001','000000','.CON.','5','','','5','SRA->RA_PERCADT <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','FINALFUN()     .END.','000002','000001','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0006")})     .CNT.','000003','000000','.EXE.','5','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0006")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := FO_GETVAL(@&cObjeto,"RC_VALOR")     .CNT.','000004','000000','.EXE.','5','VAL_ADTO := FO_GETVAL(@&cObjeto,"RC_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO = 0   .END.','000005','000000','.CON.','5','','','5','VAL_ADTO = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADI','VAL_ADTO := SRA->RA_PERCADT  * Salario / 100     .END.','000006','000005','.EXE.','5','VAL_ADTO := SRA->RA_PERCADT  * Salario / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0014    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0014( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCDSR','Calculo DSR','','000261','051','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh := SRA->RA_SITFOLH     .CNT.','000001','000000','.EXE.','5','cSitFolh := SRA->RA_SITFOLH','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh = " " .END.','000002','000000','.CON.','5','','','5','cSitFolh','=','5','" "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT = "M" .END.','000003','000002','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "M*C*A*P*E*1*2*3*4" .END.','000004','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*A*P*E*1*2*3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Salmes     .CNT.','000005','000004','.EXE.','5','nSalPg     := Salmes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','MESANO(sra->ra_admissa) = cAnoMes .Or. DiasTrab < 30   .EN','000006','000004','.CON.','5','','','5','MESANO(sra->ra_admissa) = cAnoMes .Or. DiasTrab < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg := Round(SalMes / 30 * DiasTrab,2)     .END.','000007','000006','.EXE.','5','nSalPg := Round(SalMes / 30 * DiasTrab,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "H*G" .END.','000008','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))     .','000009','000008','.EXE.','5','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))     .END.','000010','000008','.EXE.','5','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "D" .END.','000011','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := SalDia * Diastrab     .END.','000012','000011','.EXE.','5','nSalPg     := SalDia * Diastrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT = "S" .END.','000013','000002','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','Type("NTOTDIAS") = "U" .END.','000014','000013','.CON.','5','','','5','Type("NTOTDIAS")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nTotDias := 7     .END.','000015','000014','.EXE.','5','nTotDias := 7','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','000016','000013','.EXE.','5','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','DiasDsr > 0 .END.','000017','000013','.CON.','5','','','5','DiasDsr','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nTotdias  := DiasTrab + DiasDsr     .CNT.','000018','000017','.EXE.','5','nTotdias  := DiasTrab + DiasDsr','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotD','000019','000017','.EXE.','5','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotDias-DiasTrab) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nHorasDsr  := nTotDias - DiasTrab     .END.','000020','000017','.EXE.','5','nHorasDsr  := nTotDias - DiasTrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh <> " " .AND. cSitFolh # "D"   .AND.','000021','000000','.CON.','5','','','5','cSitFolh <> " " .AND. cSitFolh # "D"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*1*2*3*4" .END.','000022','000000','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*D*S*A*P*E*1*2*3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))     .EN','000023','000022','.EXE.','5','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','(cSitFolh <> " ") .AND. (cSitFolh # "D") .AND. ! (SRA->RA_','000024','000000','.CON.','5','','','5','(cSitFolh <> " ") .AND. (cSitFolh # "D") .AND. ! (SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*1*2*3*4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','000025','000024','.EXE.','5','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))     .','000026','000024','.EXE.','5','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh = "A" .AND.','000027','000000','.CON.','5','','','5','cSitFolh','=','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT == "S" .END.','000028','000000','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))     .CNT','000029','000028','.EXE.','5','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nHorasDsr  := DiasDsr     .END.','000030','000028','.EXE.','5','nHorasDsr  := DiasDsr','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0015    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0015( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIRS','CALCULO IMPOSTO DE RENDA SINGULAR','','','020','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIRS','nPerFunc :=0     .CNT.','000001','000000','.EXE.','5','nPerFunc :=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTabela := " "     .CNT.','000002','000000','.EXE.','5','cTabela := " "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cCodReg := "1"     .CNT.','000003','000000','.EXE.','5','cCodReg := "1"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux := 0     .CNT.','000004','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nColDep := 7     .CNT.','000005','000000','.EXE.','5','nColDep := 7','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRS := 0     .CNT.','000006','000000','.EXE.','5','nBaseIRS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIRS := 0     .CNT.','000007','000000','.EXE.','5','nPerIRS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIRS := 0     .CNT.','000008','000000','.EXE.','5','nVLIRS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRSFer := 0     .CNT.','000009','000000','.EXE.','5','nBaseIRSFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRS13:= 0     .CNT.','000010','000000','.EXE.','5','nBaseIRS13:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIRSFer := 0     .CNT.','000011','000000','.EXE.','5','nPerIRSFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIrs13 := 0     .CNT.','000012','000000','.EXE.','5','nPerIrs13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIrsFer := 0     .CNT.','000013','000000','.EXE.','5','nVLIrsFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIrs13 := 0     .CNT.','000014','000000','.EXE.','5','nVLIrs13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_TAXIRS = 0   .END.','000015','000000','.CON.','5','','','5','SRA->RA_TAXIRS = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_ESTCIVF == "1"   .END.','000016','000015','.CON.','5','','','5','SRA->RA_ESTCIVF == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_DEFIFIS == "1"   .END.','000017','000016','.CON.','5','','','5','SRA->RA_DEFIFIS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTabela := "S002"     .END.','000018','000017','.EXE.','5','cTabela := "S002"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_DEFIFIS == "2"   .END.','000019','000016','.CON.','5','','','5','SRA->RA_DEFIFIS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTabela := "S005"     .END.','000020','000019','.EXE.','5','cTabela := "S005"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_ESTCIVF == "2"   .END.','000021','000015','.CON.','5','','','5','SRA->RA_ESTCIVF == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_DEFIFIS == "1"   .END.','000022','000021','.CON.','5','','','5','SRA->RA_DEFIFIS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTabela := "S003"     .END.','000023','000022','.EXE.','5','cTabela := "S003"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_DEFIFIS == "2"   .END.','000024','000021','.CON.','5','','','5','SRA->RA_DEFIFIS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTabela := "S006"     .END.','000025','000024','.EXE.','5','cTabela := "S006"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_ESTCIVF == "3"   .END.','000026','000015','.CON.','5','','','5','SRA->RA_ESTCIVF == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_DEFIFIS == "1"   .END.','000027','000026','.CON.','5','','','5','SRA->RA_DEFIFIS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTabela := "S004"     .END.','000028','000027','.EXE.','5','cTabela := "S004"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_DEFIFIS == "2"   .END.','000029','000026','.CON.','5','','','5','SRA->RA_DEFIFIS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTabela := "S007"     .END.','000030','000029','.EXE.','5','cTabela := "S007"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','!Empty(SRA->RA_DEPIR)   .END.','000031','000015','.CON.','5','','','5','!Empty(SRA->RA_DEPIR)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','Val(SRA->RA_DEPIR) == 1   .END.','000032','000031','.CON.','5','','','5','Val(SRA->RA_DEPIR) == 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nColDep := 8     .END.','000033','000032','.EXE.','5','nColDep := 8','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','Val(SRA->RA_DEPIR) == 2   .END.','000034','000031','.CON.','5','','','5','Val(SRA->RA_DEPIR) == 2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nColDep := 9     .END.','000035','000034','.EXE.','5','nColDep := 9','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','Val(SRA->RA_DEPIR) == 3   .END.','000036','000031','.CON.','5','','','5','Val(SRA->RA_DEPIR) == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nColDep := 10     .END.','000037','000036','.EXE.','5','nColDep := 10','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','Val(SRA->RA_DEPIR) == 4   .END.','000038','000031','.CON.','5','','','5','Val(SRA->RA_DEPIR) == 4','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nColDep := 11     .END.','000039','000038','.EXE.','5','nColDep := 11','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','Val(SRA->RA_DEPIR) > 4   .END.','000040','000031','.CON.','5','','','5','Val(SRA->RA_DEPIR) > 4','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nColDep := 12     .END.','000041','000040','.EXE.','5','nColDep := 12','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','!Empty( SRA->RA_DEPTO )   .END.','000042','000015','.CON.','5','','','5','!Empty( SRA->RA_DEPTO )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','FPOSREG("SQB", RETORDER("SQB","QB_FILIAL+QB_DEPTO"), XFILI','000043','000042','.CON.','5','','','5','FPOSREG("SQB", RETORDER("SQB","QB_FILIAL+QB_DEPTO"), XFILIAL("SQB")+SRA->RA_DEPTO )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cEstab := SQB->QB_CESTAB     .CNT.','000044','000043','.EXE.','5','cEstab := SQB->QB_CESTAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','!Empty(cEstab)   .END.','000045','000043','.CON.','5','','','5','!Empty(cEstab)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','FPOSREG("RCO",RETORDER("RCO","RCO_FILIAL+RCO_CODIGO+RCO_NR','000046','000045','.CON.','5','','','5','FPOSREG("RCO",RETORDER("RCO","RCO_FILIAL+RCO_CODIGO+RCO_NREPAT"), XFILIAL("RCO")+cEstab ) == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cCodDist := RCO->RCO_UF     .CNT.','000047','000046','.EXE.','5','cCodDist := RCO->RCO_UF','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cCodDist  <= "18"   .END.','000048','000046','.CON.','5','','','5','cCodDist  <= "18"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cCodReg := "1"     .END.','000049','000048','.EXE.','5','cCodReg := "1"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cCodDist > "30" .And. cCodDist <= "32"   .END.','000050','000046','.CON.','5','','','5','cCodDist > "30" .And. cCodDist <= "32"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cCodReg := "2"     .END.','000051','000050','.EXE.','5','cCodReg := "2"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cCodDist > "40" .And. cCodDist <= "49"   .END.','000052','000046','.CON.','5','','','5','cCodDist > "40" .And. cCodDist <= "49"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cCodReg := "3"     .END.','000053','000052','.EXE.','5','cCodReg := "3"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','!Empty(cCodReg)   .END.','000054','000015','.CON.','5','','','5','!Empty(cCodReg)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTipoRot == "1" .Or. cTipoRot == "4"   .END.','000055','000054','.CON.','5','','','5','cTipoRot == "1" .Or. cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux := 0     .CNT.','000056','000055','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRS := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "R','000057','000055','.EXE.','5','nBaseIRS := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_REFFER", "RV_REF13"}, {"S", "N* ", "N* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRS > 0   .END.','000058','000055','.CON.','5','','','5','nBaseIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux := FPOSTAB(cTabela, cCodReg, "=" , 4 , nBaseIRS, "<=" ,','000059','000058','.EXE.','5','nAux := FPOSTAB(cTabela, cCodReg, "=" , 4 , nBaseIRS, "<=" , 6 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux > 0   .END.','000060','000058','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIRS := IF( FTABELA(cTabela, nAux, nColDep, DDATAREF ) <>','000061','000060','.EXE.','5','nPerIRS := IF( FTABELA(cTabela, nAux, nColDep, DDATAREF ) <> NIL, FTABELA(cTabela, nAux, nColDep, DDATAREF), FTABELA(cTabela, nAux, nColDep ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIRS > 0   .END.','000062','000060','.CON.','5','','','5','nPerIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIRS := (nBaseIRS * nPerIRS) / 100     .CNT.','000063','000062','.EXE.','5','nVLIRS := (nBaseIRS * nPerIRS) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVlIRS > 0   .END.','000064','000062','.CON.','5','','','5','nVlIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVlIRS := Int(nVlIRS)     .END.','000065','000064','.EXE.','5','nVlIRS := Int(nVlIRS)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_TAXIRS > 0   .END.','000066','000055','.CON.','5','','','5','SRA->RA_TAXIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIRS := SRA->RA_TAXIRS     .END.','000067','000066','.EXE.','5','nVLIRS := SRA->RA_TAXIRS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTipoRot == "3" .Or. cTipoRot == "4"   .END.','000068','000054','.CON.','5','','','5','cTipoRot == "3" .Or. cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux := 0     .CNT.','000069','000068','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRSFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR",','000070','000068','.EXE.','5','nBaseIRSFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_REFFER", "RV_REF13"}, {"S", "S", "N* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRSFer > 0   .END.','000071','000068','.CON.','5','','','5','nBaseIRSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux := FPOSTAB(cTabela, cCodReg, "=" , 4 , nBaseIRSFer, "<=','000072','000071','.EXE.','5','nAux := FPOSTAB(cTabela, cCodReg, "=" , 4 , nBaseIRSFer, "<=" , 6 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux > 0   .END.','000073','000071','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIRSFer := IF( FTABELA(cTabela, nAux, nColDep, DDATAREF )','000074','000073','.EXE.','5','nPerIRSFer := IF( FTABELA(cTabela, nAux, nColDep, DDATAREF ) <> NIL, FTABELA(cTabela, nAux, nColDep, DDATAREF), FTABELA(cTabela, nAux, nColDep ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIRSFer > 0   .END.','000075','000073','.CON.','5','','','5','nPerIRSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIRSFer := (nBaseIRSFer * nPerIRSFer) / 100     .CNT.','000076','000075','.EXE.','5','nVLIRSFer := (nBaseIRSFer * nPerIRSFer) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVlIRSFer > 0   .END.','000077','000075','.CON.','5','','','5','nVlIRSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVlIRSFer := Int(nVlIRSFer)     .END.','000078','000077','.EXE.','5','nVlIRSFer := Int(nVlIRSFer)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_TAXIRS > 0   .END.','000079','000068','.CON.','5','','','5','SRA->RA_TAXIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIRSFer := SRA->RA_TAXIRS     .END.','000080','000079','.EXE.','5','nVLIRSFer := SRA->RA_TAXIRS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','cTipoRot == "6" .Or. cTipoRot == "4"   .END.','000081','000054','.CON.','5','','','5','cTipoRot == "6" .Or. cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux := 0     .CNT.','000082','000081','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRS13 := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR",','000083','000081','.EXE.','5','nBaseIRS13 := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_REFFER", "RV_REF13"}, {"S", "N* ", "S"} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nBaseIRS13 > 0   .END.','000084','000081','.CON.','5','','','5','nBaseIRS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux := FPOSTAB(cTabela, cCodReg, "=" , 4 , nBaseIRS13, "<="','000085','000084','.EXE.','5','nAux := FPOSTAB(cTabela, cCodReg, "=" , 4 , nBaseIRS13, "<=" , 6 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nAux > 0   .END.','000086','000084','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIRS13 := IF( FTABELA(cTabela, nAux, nColDep, DDATAREF )','000087','000086','.EXE.','5','nPerIRS13 := IF( FTABELA(cTabela, nAux, nColDep, DDATAREF ) <> NIL, FTABELA(cTabela, nAux, nColDep, DDATAREF), FTABELA(cTabela, nAux, nColDep ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nPerIRS13 > 0   .END.','000088','000086','.CON.','5','','','5','nPerIRS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIRS13 := (nBaseIRS13 * nPerIRS13) / 100     .CNT.','000089','000088','.EXE.','5','nVLIRS13 := (nBaseIRS13 * nPerIRS13) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVlIRS13 > 0   .END.','000090','000088','.CON.','5','','','5','nVlIRS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVlIRS13 := Int(nVlIRS13)     .END.','000091','000090','.EXE.','5','nVlIRS13 := Int(nVlIRS13)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','SRA->RA_TAXIRS > 0   .END.','000092','000081','.CON.','5','','','5','SRA->RA_TAXIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIRS','nVLIRS13 := SRA->RA_TAXIRS     .END.','000093','000092','.EXE.','5','nVLIRS13 := SRA->RA_TAXIRS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0016    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0016( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCNAT','CALCULO DO SUBISIDIO DE NATAL','','','021','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCNAT','DDTINI := Max( SRA->RA_ADMISSA , CTOD("01/01/"+SUBSTR(CANOME','000001','000000','.EXE.','5','DDTINI := Max( SRA->RA_ADMISSA , CTOD("01/01/"+SUBSTR(CANOMES,1,4) ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DDTINI <> CTOD("01/01/"+SUBSTR(CANOMES,1,4) )   .END.','000002','000000','.CON.','5','','','5','DDTINI <> CTOD("01/01/"+SUBSTR(CANOMES,1,4) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','SRA->RA_CATFUNC == "M"   .END.','000003','000002','.CON.','5','','','5','SRA->RA_CATFUNC == "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASADM := ( ( 30 - DAY(DDTINI) ) + 1 ) / 30     .END.','000004','000003','.EXE.','5','NDIASADM := ( ( 30 - DAY(DDTINI) ) + 1 ) / 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','SRA->RA_CATFUNC <> "M"   .END.','000005','000002','.CON.','5','','','5','SRA->RA_CATFUNC <> "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','NDIASADM := ( ( F_ULTDIA(DDTINI)-DAY(DDTINI) )+1 )  / 30','000006','000005','.EXE.','5','NDIASADM := ( ( F_ULTDIA(DDTINI)-DAY(DDTINI) )+1 )  / 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DDTINI := CTOD("01/" + ( STRZERO(MONTH(DDTINI) +1,2) ) +"/"+','000007','000002','.EXE.','5','DDTINI := CTOD("01/" + ( STRZERO(MONTH(DDTINI) +1,2) ) +"/"+ SUBSTR( CANOMES , 1, 4 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','DDTFIM := DDATAREF     .CNT.','000008','000000','.EXE.','5','DDTFIM := DDATAREF','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','ndias13pt := DATEDIFFMONTH( DDTINI , DDTFIM ) + 1 + NDIASADM','000009','000000','.EXE.','5','ndias13pt := DATEDIFFMONTH( DDTINI , DDTFIM ) + 1 + NDIASADM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','N13SAL := SALMES / 12 * ndias13pt     .CNT.','000010','000000','.EXE.','5','N13SAL := SALMES / 12 * ndias13pt','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','FPOSREG("SRD", 6 , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("','000011','000000','.CON.','5','','','5','FPOSREG("SRD", 6 , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0022"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','SRD->(!EOF()) .AND. SRD->RD_MAT == SRA->RA_MAT .AND. SRD->','000012','000011','.ENQ.','5','','','5','SRD->(!EOF()) .AND. SRD->RD_MAT == SRA->RA_MAT .AND. SRD->RD_PD == FGETCODFOL("0022") .AND. SUBSTR(SRD->RD_DATARQ ,1,4) == SUBSTR( CANOMES ,1,4)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','N13VALDES += SRD->RD_VALOR     .CNT.','000013','000012','.EXE.','5','N13VALDES += SRD->RD_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','SRD->(DBSKIP())     .END.','000014','000012','.EXE.','5','SRD->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','FPOSREG("SRC", 8 , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("','000015','000000','.CON.','5','','','5','FPOSREG("SRC", 8 , SRA->RA_FILIAL+SRA->RA_MAT+FGETCODFOL("0022"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','SRC->(!EOF()) .AND. SRC->RC_MAT == SRA->RA_MAT .AND. SRC->','000016','000015','.ENQ.','5','','','5','SRC->(!EOF()) .AND. SRC->RC_MAT == SRA->RA_MAT .AND. SRC->RC_PD == FGETCODFOL("0022") .AND. SUBSTR( MESANO(SRC->RC_DATA),1,4) == SUBSTR( CANOMES ,1,4)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','N13VALDES += SRC->RC_VALOR     .CNT.','000017','000016','.EXE.','5','N13VALDES += SRC->RC_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCNAT','SRC->(DBSKIP())     .END.','000018','000016','.EXE.','5','SRC->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0017    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0017( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALDSRHE','CALCULO DE DSR SOBRE HORAS EXT','','','039','2','1',} )

aAdd(aRc3Cols, { '','S_','CALDSRHE','nHrsTrab:=  If (Normal=0,1,Normal)     .CNT.','000001','000000','.EXE.','5','nHrsTrab:=  If (Normal=0,1,Normal)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHrsDesc:= If (Descanso=0,1,Descanso)     .CNT.','000002','000000','.EXE.','5','nHrsDesc:= If (Descanso=0,1,Descanso)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrn := nValDsrc := nDsrhex_B := nHorDsrn := nHorDsrc :=','000003','000000','.EXE.','5','nValDsrn := nValDsrc := nDsrhex_B := nHorDsrn := nHorDsrc := nHrTDsr := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C:= 0     .CNT.','000004','000000','.EXE.','5','nDsrhex_C:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lPos:= .F.     .CNT.','000005','000000','.EXE.','5','lPos:= .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0166"))   .END.','000006','000000','.CON.','5','','','5','!Empty(fGetCodFol("0166"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodSep:= Alltrim(fGetCodFol("0165")) + "/" + Alltrim(fGetCo','000007','000006','.EXE.','5','cCodSep:= Alltrim(fGetCodFol("0165")) + "/" + Alltrim(fGetCodFol("0347")) + "/"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0122"))   .END.','000008','000000','.CON.','5','','','5','!Empty(fGetCodFol("0122"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodSep+= Alltrim(fGetCodFol("0121"))     .END.','000009','000008','.EXE.','5','cCodSep+= Alltrim(fGetCodFol("0121"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0035"))   .END.','000010','000000','.CON.','5','','','5','!Empty(fGetCodFol("0035"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','FO_GOTOP(@&cObjeto)     .CNT.','000011','000010','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_B:= 0.00     .CNT.','000012','000010','.EXE.','5','nDsrhex_B:= 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!fo_Eof(@&cObjeto)   .END.','000013','000010','.ENQ.','5','','','5','!fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(! fo_Deleted(@&cObjeto))   .END.','000014','000013','.CON.','5','','','5','(! fo_Deleted(@&cObjeto))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodVerba:= fo_GetVal(@&cObjeto,cCpoPD)     .CNT.','000015','000014','.EXE.','5','cCodVerba:= fo_GetVal(@&cObjeto,cCpoPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(cTipoRot == "3") .AND. !(cCodverba $ cCodSep) .AND. PosSr','000016','000014','.CON.','5','','','5','(cTipoRot == "3") .AND. !(cCodverba $ cCodSep) .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_DSRHE")  == "S" .AND.  PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_REFFER") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_B+= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000017','000016','.EXE.','5','nDsrhex_B+= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(cTipoRot # "3") .AND. !(cCodVerba $ cCodSep) .AND. PosSrv','000018','000014','.CON.','5','','','5','(cTipoRot # "3") .AND. !(cCodVerba $ cCodSep) .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_DSRHE")=="S" .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_REFFER")=="N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_B+= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000019','000018','.EXE.','5','nDsrhex_B+= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_skip(@&cObjeto)     .END.','000020','000013','.EXE.','5','fo_skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0035") ) .AND. (','000021','000010','.EXE.','5','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0035") ) .AND. (! fo_Deleted(@&cObjeto))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','000022','000010','.CON.','5','','','5','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_B * fo_GetVal(@&cObjeto,cCpoValor)) / n','000023','000022','.EXE.','5','nValDsrvv:= (nDsrhex_B * fo_GetVal(@&cObjeto,cCpoValor)) / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000024','000022','.EXE.','5','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .F.)   .END.','000025','000010','.CON.','5','','','5','(lPos == .F.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_B * nHrsDesc) / nHrsTrab     .CNT.','000026','000025','.EXE.','5','nValDsrvv:= (nDsrhex_B * nHrsDesc) / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= If( Salhora > 0 , nValDsrvv / Salhora , 0 )','000027','000025','.EXE.','5','nHorDsrvv:= If( Salhora > 0 , nValDsrvv / Salhora , 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrn:= nValDsrvv     .CNT.','000028','000010','.EXE.','5','nValDsrn:= nValDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrn:= nHorDsrvv     .CNT.','000029','000010','.EXE.','5','nHorDsrn:= nHorDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHrtDsr  := ((nHrtDsr * nHrsDesc) / nHrsTrab )     .CNT.','000030','000010','.EXE.','5','nHrtDsr  := ((nHrtDsr * nHrsDesc) / nHrsTrab )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(nValDsrvv > 0)   .END.','000031','000010','.CON.','5','','','5','(nValDsrvv > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol(','000032','000031','.EXE.','5','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol("0035"), nHorDsrvv, nValDsrvv})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0166"))   .END.','000033','000000','.CON.','5','','','5','!Empty(fGetCodFol("0166"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_GoTop(@&cObjeto)     .CNT.','000034','000033','.EXE.','5','fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C:= 0.00     .CNT.','000035','000033','.EXE.','5','nDsrhex_C:= 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!fo_Eof(@&cObjeto)   .END.','000036','000033','.ENQ.','5','','','5','!fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(! fo_Deleted(@&cObjeto))   .END.','000037','000036','.CON.','5','','','5','(! fo_Deleted(@&cObjeto))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodVerba:= fo_GetVal(@&cObjeto,cCpoPD)     .CNT.','000038','000037','.EXE.','5','cCodVerba:= fo_GetVal(@&cObjeto,cCpoPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodVerba $ (fGetCodFol("0165")+"\"+fGetCodFol("0347")) .A','000039','000037','.CON.','5','','','5','cCodVerba $ (fGetCodFol("0165")+"\"+fGetCodFol("0347")) .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_DSRHE")  == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C+= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000040','000039','.EXE.','5','nDsrhex_C+= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_skip(@&cObjeto)     .END.','000041','000036','.EXE.','5','fo_skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0166") ) .AND. (','000042','000033','.EXE.','5','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0166") ) .AND. (! fo_Deleted(@&cObjeto))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','000043','000033','.CON.','5','','','5','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_C * fo_GetVal(@&cObjeto,cCpoValor) / nH','000044','000043','.EXE.','5','nValDsrvv:= (nDsrhex_C * fo_GetVal(@&cObjeto,cCpoValor) / nHrsTrab)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000045','000043','.EXE.','5','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .F.)   .END.','000046','000033','.CON.','5','','','5','(lPos == .F.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_C * nHrsDesc )  / nHrsTrab     .CNT.','000047','000046','.EXE.','5','nValDsrvv:= (nDsrhex_C * nHrsDesc )  / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= nHrsDesc     .END.','000048','000046','.EXE.','5','nHorDsrvv:= nHrsDesc','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrc:= nValDsrvv     .CNT.','000049','000033','.EXE.','5','nValDsrc:= nValDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrc := nHorDsrvv     .CNT.','000050','000033','.EXE.','5','nHorDsrc := nHorDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(nValDsrvv > 0)   .END.','000051','000033','.CON.','5','','','5','(nValDsrvv > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol(','000052','000051','.EXE.','5','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol("0166"), nHorDsrvv, nValDsrvv})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= nValDsrn + nValDsrc     .CNT.','000053','000000','.EXE.','5','nValDsrvv:= nValDsrn + nValDsrc','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= nHorDsrn + nHorDsrc     .CNT.','000054','000000','.EXE.','5','nHorDsrvv:= nHorDsrn + nHorDsrc','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0122"))   .END.','000055','000000','.CON.','5','','','5','!Empty(fGetCodFol("0122"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_Gotop(@&cObjeto)     .CNT.','000056','000055','.EXE.','5','fo_Gotop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C := 0.00     .CNT.','000057','000055','.EXE.','5','nDsrhex_C := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!fo_Eof(@&cObjeto)   .END.','000058','000055','.ENQ.','5','','','5','!fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(! fo_Deleted(@&cObjeto))   .END.','000059','000058','.CON.','5','','','5','(! fo_Deleted(@&cObjeto))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodVerba := fo_GetVal(@&cObjeto,cCpoPD)   .CNT.','000060','000059','.EXE.','5','cCodVerba',':=','5','fo_GetVal(@&cObjeto,cCpoPD)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','( cCodVerba $ fGetCodFol("0121")) .AND. PosSrv(cCodVerba,S','000061','000059','.CON.','5','','','5','( cCodVerba $ fGetCodFol("0121")) .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_DSRHE")  == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C+= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000062','000061','.EXE.','5','nDsrhex_C+= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_skip(@&cObjeto)     .END.','000063','000058','.EXE.','5','fo_skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0122") ) .AND. (','000064','000055','.EXE.','5','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0122") ) .AND. (! fo_Deleted(@&cObjeto))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','000065','000055','.CON.','5','','','5','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_C* fo_GetVal(@&cObjeto,cCpoValor)) / nH','000066','000065','.EXE.','5','nValDsrvv:= (nDsrhex_C* fo_GetVal(@&cObjeto,cCpoValor)) / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000067','000065','.EXE.','5','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .F.)   .END.','000068','000055','.CON.','5','','','5','(lPos == .F.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_C * nHrsDesc )  / nHrsTrab     .CNT.','000069','000068','.EXE.','5','nValDsrvv:= (nDsrhex_C * nHrsDesc )  / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= nHrsDesc     .END.','000070','000068','.EXE.','5','nHorDsrvv:= nHrsDesc','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrC+= nValDsrvv     .CNT.','000071','000055','.EXE.','5','nValDsrC+= nValDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrC+= nHorDsrvv     .CNT.','000072','000055','.EXE.','5','nHorDsrC+= nHorDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(nValDsrvv > 0)   .END.','000073','000055','.CON.','5','','','5','(nValDsrvv > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol(','000074','000073','.EXE.','5','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol("0122"), nHorDsrvv, nValDsrvv})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:=   nValDsrN + nValDsrC     .CNT.','000075','000000','.EXE.','5','nValDsrvv:=   nValDsrN + nValDsrC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:=   nHorDsrN + nHorDsrC     .END.','000076','000000','.EXE.','5','nHorDsrvv:=   nHorDsrN + nHorDsrC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0018    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0018( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALIRSFE','CALCULO IMPOSTO DE RENDA SINGULAR FERIAS','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CALIRSFE','nPerFunc :=0     .CNT.','000001','000000','.EXE.','5','nPerFunc :=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','cTabela := " "     .CNT.','000002','000000','.EXE.','5','cTabela := " "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','cCodReg := "1"     .CNT.','000003','000000','.EXE.','5','cCodReg := "1"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nAux := 0     .CNT.','000004','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nColDep := 7     .CNT.','000005','000000','.EXE.','5','nColDep := 7','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nBaseIRSFer := 0     .CNT.','000006','000000','.EXE.','5','nBaseIRSFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nPerIRS := 0     .CNT.','000007','000000','.EXE.','5','nPerIRS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nVLIRSFer := 0     .CNT.','000008','000000','.EXE.','5','nVLIRSFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_TAXIRS = 0   .END.','000009','000000','.CON.','5','','','5','SRA->RA_TAXIRS = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_ESTCIVF == "1"   .END.','000010','000009','.CON.','5','','','5','SRA->RA_ESTCIVF == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_DEFIFIS == "1"   .END.','000011','000010','.CON.','5','','','5','SRA->RA_DEFIFIS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','cTabela := "S002"     .END.','000012','000011','.EXE.','5','cTabela := "S002"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_DEFIFIS == "2"   .END.','000013','000010','.CON.','5','','','5','SRA->RA_DEFIFIS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','cTabela := "S005"     .END.','000014','000013','.EXE.','5','cTabela := "S005"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_ESTCIVF == "2"   .END.','000015','000009','.CON.','5','','','5','SRA->RA_ESTCIVF == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_DEFIFIS == "1"   .END.','000016','000015','.CON.','5','','','5','SRA->RA_DEFIFIS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','cTabela := "S003"     .END.','000017','000016','.EXE.','5','cTabela := "S003"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_DEFIFIS == "2"   .END.','000018','000015','.CON.','5','','','5','SRA->RA_DEFIFIS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','cTabela := "S006"     .END.','000019','000018','.EXE.','5','cTabela := "S006"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_ESTCIVF == "3"   .END.','000020','000009','.CON.','5','','','5','SRA->RA_ESTCIVF == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_DEFIFIS == "1"   .END.','000021','000020','.CON.','5','','','5','SRA->RA_DEFIFIS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','cTabela := "S004"     .END.','000022','000021','.EXE.','5','cTabela := "S004"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_DEFIFIS == "2"   .END.','000023','000020','.CON.','5','','','5','SRA->RA_DEFIFIS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','cTabela := "S007"     .END.','000024','000023','.EXE.','5','cTabela := "S007"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','!Empty(SRA->RA_DEPIR)   .END.','000025','000009','.CON.','5','','','5','!Empty(SRA->RA_DEPIR)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','Val(SRA->RA_DEPIR) == 1   .END.','000026','000025','.CON.','5','','','5','Val(SRA->RA_DEPIR) == 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nColDep := 8     .END.','000027','000026','.EXE.','5','nColDep := 8','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','Val(SRA->RA_DEPIR) == 2   .END.','000028','000025','.CON.','5','','','5','Val(SRA->RA_DEPIR) == 2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nColDep := 9     .END.','000029','000028','.EXE.','5','nColDep := 9','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','Val(SRA->RA_DEPIR) == 3   .END.','000030','000025','.CON.','5','','','5','Val(SRA->RA_DEPIR) == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nColDep := 10     .END.','000031','000030','.EXE.','5','nColDep := 10','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','Val(SRA->RA_DEPIR) == 4   .END.','000032','000025','.CON.','5','','','5','Val(SRA->RA_DEPIR) == 4','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nColDep := 11     .END.','000033','000032','.EXE.','5','nColDep := 11','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','Val(SRA->RA_DEPIR) > 4   .END.','000034','000025','.CON.','5','','','5','Val(SRA->RA_DEPIR) > 4','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nColDep := 12     .END.','000035','000034','.EXE.','5','nColDep := 12','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','!Empty(cCodReg)   .END.','000036','000009','.CON.','5','','','5','!Empty(cCodReg)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nBaseIRSFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR",','000037','000036','.EXE.','5','nBaseIRSFer := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_IR", "RV_REFFER", "RV_REF13"}, {"S","S","N* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nBaseIRSFer > 0   .END.','000038','000036','.CON.','5','','','5','nBaseIRSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nAux := FPOSTAB(cTabela, cCodReg, "=" , 4 , nBaseIRSFer, "<=','000039','000038','.EXE.','5','nAux := FPOSTAB(cTabela, cCodReg, "=" , 4 , nBaseIRSFer, "<=" , 6 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nAux > 0   .END.','000040','000038','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nPerIRS := IF( FTABELA(cTabela, nAux, nColDep, DDATAREF ) <>','000041','000040','.EXE.','5','nPerIRS := IF( FTABELA(cTabela, nAux, nColDep, DDATAREF ) <> NIL, FTABELA(cTabela, nAux, nColDep, DDATAREF), FTABELA(cTabela, nAux, nColDep ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nPerIRS > 0   .END.','000042','000040','.CON.','5','','','5','nPerIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nVLIRSFer := (nBaseIRSFer * nPerIRS) / 100     .END.','000043','000042','.EXE.','5','nVLIRSFer := (nBaseIRSFer * nPerIRS) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','SRA->RA_TAXIRS > 0   .END.','000044','000000','.CON.','5','','','5','SRA->RA_TAXIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIRSFE','nVLIRSFer := SRA->RA_TAXIRS     .END.','000045','000044','.EXE.','5','nVLIRSFer := SRA->RA_TAXIRS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0019    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0019( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALMEDPT','CALCULA MEDIAS FERIAS E 13 SAL','','','032','2','1',} )

aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG := {}     .CNT.','000001','000000','.EXE.','5','AMEDIASPTG := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','NX := 1     .CNT.','000002','000000','.EXE.','5','NX := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LRES := .F.     .CNT.','000003','000000','.EXE.','5','LRES := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','L13SAL := .F.     .CNT.','000004','000000','.EXE.','5','L13SAL := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRB13 := ""     .CNT.','000005','000000','.EXE.','5','CVRB13 := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LFERIAS := .F.     .CNT.','000006','000000','.EXE.','5','LFERIAS := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBFER := ""     .CNT.','000007','000000','.EXE.','5','CVRBFER := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBFERVEN := ""     .CNT.','000008','000000','.EXE.','5','CVRBFERVEN := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBFERPRO := ""     .CNT.','000009','000000','.EXE.','5','CVRBFERPRO := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LAVISO := .F.     .CNT.','000010','000000','.EXE.','5','LAVISO := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBAVI := ""     .CNT.','000011','000000','.EXE.','5','CVRBAVI := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','dDataRefCal := dDataBase     .CNT.','000012','000000','.EXE.','5','dDataRefCal := dDataBase','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','C__ROTEIRO == "NAT"   .END.','000013','000000','.CON.','5','','','5','C__ROTEIRO == "NAT"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','L13SAL := .T.     .CNT.','000014','000013','.EXE.','5','L13SAL := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRB13 := FGETCODFOL("0123")     .END.','000015','000013','.EXE.','5','CVRB13 := FGETCODFOL("0123")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','C__ROTEIRO == "RES"   .END.','000016','000000','.CON.','5','','','5','C__ROTEIRO == "RES"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LRES := .T.     .CNT.','000017','000016','.EXE.','5','LRES := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0087")})   .END.','000018','000016','.CON.','5','','','5','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0087")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LFERIAS := .T.     .CNT.','000019','000018','.EXE.','5','LFERIAS := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBFERVEN := FGETCODFOL("0248")     .CNT.','000020','000018','.EXE.','5','CVRBFERVEN := FGETCODFOL("0248")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBFERPRO := FGETCODFOL("0249")     .END.','000021','000018','.EXE.','5','CVRBFERPRO := FGETCODFOL("0249")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0025")})   .END.','000022','000016','.CON.','5','','','5','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0025")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','L13SAL := .T.     .CNT.','000023','000022','.EXE.','5','L13SAL := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRB13 := FGETCODFOL("0123")     .END.','000024','000022','.EXE.','5','CVRB13 := FGETCODFOL("0123")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0111")})   .END.','000025','000016','.CON.','5','','','5','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0111")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LAVISO := .T.     .CNT.','000026','000025','.EXE.','5','LAVISO := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBAVI := FGETCODFOL("0250")     .END.','000027','000025','.EXE.','5','CVRBAVI := FGETCODFOL("0250")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','C__ROTEIRO == "FER"   .END.','000028','000000','.CON.','5','','','5','C__ROTEIRO == "FER"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LFERIAS := .T.     .CNT.','000029','000028','.EXE.','5','LFERIAS := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','dDataRefCal := GetMemVar("RH_DBASEAT")     .CNT.','000030','000028','.EXE.','5','dDataRefCal := GetMemVar("RH_DBASEAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBFER := FGETCODFOL("0075")     .END.','000031','000028','.EXE.','5','CVRBFER := FGETCODFOL("0075")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','C__ROTEIRO == "PRV"   .END.','000032','000000','.CON.','5','','','5','C__ROTEIRO == "PRV"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000033','000032','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LFERIAS := .T.     .CNT.','000034','000033','.EXE.','5','LFERIAS := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRBFER := FGETCODFOL("0254")     .END.','000035','000033','.EXE.','5','CVRBFER := FGETCODFOL("0254")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','NTIPOPRV > 1   .END.','000036','000032','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','L13SAL := .T.     .CNT.','000037','000036','.EXE.','5','L13SAL := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','CVRB13 := FGETCODFOL("0267")     .END.','000038','000036','.EXE.','5','CVRB13 := FGETCODFOL("0267")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LMESATU := .F.     .CNT.','000039','000000','.EXE.','5','LMESATU := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','dDataMed := CTOD("//")     .CNT.','000040','000000','.EXE.','5','dDataMed := CTOD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','NX <= 4   .END.','000041','000000','.ENQ.','5','','','5','NX <= 4','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AADD(AMEDIASPTG,ARRAY(3))     .CNT.','000042','000041','.EXE.','5','AADD(AMEDIASPTG,ARRAY(3))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[NX,1] := ""     .CNT.','000043','000041','.EXE.','5','AMEDIASPTG[NX,1] := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[NX,2] := 0     .CNT.','000044','000041','.EXE.','5','AMEDIASPTG[NX,2] := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[NX,3] := 0     .CNT.','000045','000041','.EXE.','5','AMEDIASPTG[NX,3] := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','NX++     .END.','000046','000041','.EXE.','5','NX++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','FPOSREG("RGD",1,SRA->RA_FILIAL+SRA->RA_CODIRCT)   .END.','000047','000000','.CON.','5','','','5','FPOSREG("RGD",1,SRA->RA_FILIAL+SRA->RA_CODIRCT)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','LMESATU := (RGD->RGD_APUMED="S")     .END.','000048','000047','.EXE.','5','LMESATU := (RGD->RGD_APUMED="S")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','lIf := Len(aPerFerias) > 0   .END.','000049','000000','.CON.','5','','','5','lIf := Len(aPerFerias) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','dDataMed := aPerFerias[1,1]     .END.','000050','000049','.EXE.','5','dDataMed := aPerFerias[1,1]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','lIf = .F.  .And. c__Roteiro == "FER"   .END.','000051','000000','.CON.','5','','','5','lIf = .F.  .And. c__Roteiro == "FER"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','DDATAMED := GetmemVar("RH_DATABAS")     .END.','000052','000051','.EXE.','5','DDATAMED := GetmemVar("RH_DATABAS")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','aBkp := aClone(aPerferias)     .CNT.','000053','000000','.EXE.','5','aBkp := aClone(aPerferias)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','aPerferias := {}     .CNT.','000054','000000','.EXE.','5','aPerferias := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','GPEXMED(dDataMed,,DDATADE,,dDataRefCal,SALHORA,VAL_SALMIN,','000055','000000','.CON.','5','','','5','GPEXMED(dDataMed,,DDATADE,,dDataRefCal,SALHORA,VAL_SALMIN,ACODFOL,LMESATU,LMOVTO,LFALTAS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','aPerferias := aClone(aBkp)     .CNT.','000056','000055','.EXE.','5','aPerferias := aClone(aBkp)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','cCpoHor := "TRP->RP_HORAS"     .CNT.','000057','000055','.EXE.','5','cCpoHor := "TRP->RP_HORAS"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','cCpoVal := "TRP->RP_VALATU"     .CNT.','000058','000055','.EXE.','5','cCpoVal := "TRP->RP_VALATU"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','lFerias   .END.','000059','000055','.CON.','5','','','5','lFerias','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorMed := 0     .CNT.','000060','000059','.EXE.','5','nHorMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorAux := 0     .CNT.','000061','000059','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed := 0     .CNT.','000062','000059','.EXE.','5','nValMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValAux := 0     .CNT.','000063','000059','.EXE.','5','nValAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"1"+"999"+"99MD','000064','000059','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"1"+"999"+"99MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorAux := &cCpoHor     .CNT.','000065','000064','.EXE.','5','nHorAux := &cCpoHor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorMed += nHorMed     .CNT.','000066','000064','.EXE.','5','nHorMed += nHorMed','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValAux := &cCpoVal     .CNT.','000067','000064','.EXE.','5','nValAux := &cCpoVal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed += nValAux     .END.','000068','000064','.EXE.','5','nValMed += nValAux','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed > 0   .END.','000069','000059','.CON.','5','','','5','nValMed > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[1,1] := IF(LRES,CVRBFERVEN,CVRBFER)     .CNT.','000070','000069','.EXE.','5','AMEDIASPTG[1,1] := IF(LRES,CVRBFERVEN,CVRBFER)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[1,2] := nHorMed     .CNT.','000071','000069','.EXE.','5','AMEDIASPTG[1,2] := nHorMed','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[1,3] := nValMed     .END.','000072','000069','.EXE.','5','AMEDIASPTG[1,3] := nValMed','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorMed := 0     .CNT.','000073','000059','.EXE.','5','nHorMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorAux := 0     .CNT.','000074','000059','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed := 0     .CNT.','000075','000059','.EXE.','5','nValMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValAux := 0     .CNT.','000076','000059','.EXE.','5','nValAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"2"+"999"+"99MD','000077','000059','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"2"+"999"+"99MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorAux := &cCpoHor     .CNT.','000078','000077','.EXE.','5','nHorAux := &cCpoHor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorMed += nHorAux     .CNT.','000079','000077','.EXE.','5','nHorMed += nHorAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValAux := &cCpoVal     .CNT.','000080','000077','.EXE.','5','nValAux := &cCpoVal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed += nValAux     .END.','000081','000077','.EXE.','5','nValMed += nValAux','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed > 0   .END.','000082','000059','.CON.','5','','','5','nValMed > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[2,1] := IF(LRES,CVRBFERPRO,CVRBFER)     .CNT.','000083','000082','.EXE.','5','AMEDIASPTG[2,1] := IF(LRES,CVRBFERPRO,CVRBFER)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[2,2] := nHorMed     .CNT.','000084','000082','.EXE.','5','AMEDIASPTG[2,2] := nHorMed','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[2,3] := nValMed     .END.','000085','000082','.EXE.','5','AMEDIASPTG[2,3] := nValMed','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','l13Sal   .END.','000086','000055','.CON.','5','','','5','l13Sal','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorMed := 0     .CNT.','000087','000086','.EXE.','5','nHorMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorAux := 0     .CNT.','000088','000086','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed := 0     .CNT.','000089','000086','.EXE.','5','nValMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValAux := 0     .CNT.','000090','000086','.EXE.','5','nValAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"99MD','000091','000086','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"99MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorAux := &cCpoHor     .CNT.','000092','000091','.EXE.','5','nHorAux := &cCpoHor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorMed += nHorAux     .CNT.','000093','000091','.EXE.','5','nHorMed += nHorAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValAux := &cCpoVal     .CNT.','000094','000091','.EXE.','5','nValAux := &cCpoVal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed += nValAux     .END.','000095','000091','.EXE.','5','nValMed += nValAux','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed > 0   .END.','000096','000086','.CON.','5','','','5','nValMed > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[3,1] := CVRB13     .CNT.','000097','000096','.EXE.','5','AMEDIASPTG[3,1] := CVRB13','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[3,2] := nHorMed     .CNT.','000098','000096','.EXE.','5','AMEDIASPTG[3,2] := nHorMed','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[3,3] := nValMed     .END.','000099','000096','.EXE.','5','AMEDIASPTG[3,3] := nValMed','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','lAviso   .END.','000100','000055','.CON.','5','','','5','lAviso','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorMed := 0     .CNT.','000101','000100','.EXE.','5','nHorMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorAux := 0     .CNT.','000102','000100','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed := 0     .CNT.','000103','000100','.EXE.','5','nValMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValAux := 0     .CNT.','000104','000100','.EXE.','5','nValAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"4"+"999"+"99MD','000105','000100','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"4"+"999"+"99MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorAux := &cCpoHor     .CNT.','000106','000105','.EXE.','5','nHorAux := &cCpoHor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nHorMed += nHorAux     .CNT.','000107','000105','.EXE.','5','nHorMed += nHorAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValAux := &cCpoVal     .CNT.','000108','000105','.EXE.','5','nValAux := &cCpoVal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed += nValAux     .END.','000109','000105','.EXE.','5','nValMed += nValAux','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','nValMed > 0   .END.','000110','000100','.CON.','5','','','5','nValMed > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[3,1] := CVRBAVI     .CNT.','000111','000110','.EXE.','5','AMEDIASPTG[3,1] := CVRBAVI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[3,2] := nHorMed     .CNT.','000112','000110','.EXE.','5','AMEDIASPTG[3,2] := nHorMed','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALMEDPT','AMEDIASPTG[3,3] := nValMed     .END.','000113','000110','.EXE.','5','AMEDIASPTG[3,3] := nValMed','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0020    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0020( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALSSFER','CALCULO DE SEGURO SOCIAL FERIAS','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CALSSFER','nAux := 0     .CNT.','000001','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nPerSSFun := 0     .CNT.','000002','000000','.EXE.','5','nPerSSFun := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nBaseSS := 0     .CNT.','000003','000000','.EXE.','5','nBaseSS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nVlMaxSS := 0     .CNT.','000004','000000','.EXE.','5','nVlMaxSS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','!Empty(SRA->RA_CODSS)   .END.','000005','000000','.CON.','5','','','5','!Empty(SRA->RA_CODSS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nAux := fPosTab("S001", SRA->RA_CODSS, "=" , 4 )     .CNT.','000006','000005','.EXE.','5','nAux := fPosTab("S001", SRA->RA_CODSS, "=" , 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nAux > 0   .END.','000007','000005','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nPerSSFun := If( FTABELA( "S001", nAux,7, DDATAREF) <> NIL,','000008','000007','.EXE.','5','nPerSSFun := If( FTABELA( "S001", nAux,7, DDATAREF) <> NIL, FTABELA("S001", nAux, 7, DDATAREF),  FTABELA("S001", nAux,7 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nPerSSEmp := If( FTABELA( "S001", nAux,6, DDATAREF) <> NIL,','000009','000007','.EXE.','5','nPerSSEmp := If( FTABELA( "S001", nAux,6, DDATAREF) <> NIL, FTABELA("S001", nAux, 6, DDATAREF),  FTABELA("S001", nAux,6 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nVlrMaxSS :=  If( FTABELA( "S001", nAux,8, DDATAREF) <> NIL,','000010','000007','.EXE.','5','nVlrMaxSS :=  If( FTABELA( "S001", nAux,8, DDATAREF) <> NIL, FTABELA("S001", nAux, 8, DDATAREF),  FTABELA("S001", nAux, 8 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','NBASESSFER := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS"','000011','000007','.EXE.','5','NBASESSFER := FO_SOMAINCSRV(@&COBJETO, CCPOVALOR, {"RV_INSS", "RV_REFFER", "RV_REF13"}, {"S", "S", "N* "} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nBaseSSFer > 0   .END.','000012','000007','.CON.','5','','','5','nBaseSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nVlSSFer := (nBaseSSFer * nPerSSFun ) / 100     .CNT.','000013','000012','.EXE.','5','nVlSSFer := (nBaseSSFer * nPerSSFun ) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nVlMaxSS > 0   .END.','000014','000012','.CON.','5','','','5','nVlMaxSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSSFER','nVlSSFer := If(nVlMaxSS < nVlSSFer , nVlMaxSS , nVlSSFer )','000015','000014','.EXE.','5','nVlSSFer := If(nVlMaxSS < nVlSSFer , nVlMaxSS , nVlSSFer )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0021    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0021( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALSUBRE','CALCULO SUBSIDIO REFEICAO','','','029','2','1',} )

aAdd(aRc3Cols, { '','S_','CALSUBRE','nSubsIsent := 0     .CNT.','000001','000000','.EXE.','5','nSubsIsent := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','( C__ROTEIRO == "RES" ) .AND. ( FTABELA("S021",VAL(CTIPRES','000002','000000','.CON.','5','','','5','( C__ROTEIRO == "RES" ) .AND. ( FTABELA("S021",VAL(CTIPRES),7) <> "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','FIMFORMULA()     .END.','000003','000002','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nSubsTrib := 0     .CNT.','000004','000000','.EXE.','5','nSubsTrib := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nVlSubs := 0     .CNT.','000005','000000','.EXE.','5','nVlSubs := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nAux := 0     .CNT.','000006','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nDiasUt := 0     .CNT.','000007','000000','.EXE.','5','nDiasUt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','cCodigo := ""     .CNT.','000008','000000','.EXE.','5','cCodigo := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas := 0     .CNT.','000009','000000','.EXE.','5','nFaltas := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','cVerFal := ""     .CNT.','000010','000000','.EXE.','5','cVerFal := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nHrsMinPer := 0     .CNT.','000011','000000','.EXE.','5','nHrsMinPer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','aAtrasos := {}     .CNT.','000012','000000','.EXE.','5','aAtrasos := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nAux := fPosTab("S019", SRA->RA_CODIRCT, "=" , 4 )     .CNT.','000013','000000','.EXE.','5','nAux := fPosTab("S019", SRA->RA_CODIRCT, "=" , 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nAux > 0   .END.','000014','000000','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nVlSubs := fTabela( "S019" , nAux, 5 )     .END.','000015','000014','.EXE.','5','nVlSubs := fTabela( "S019" , nAux, 5 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','! Empty (SRA->RA_TCKALIM)   .END.','000016','000000','.CON.','5','','','5','! Empty (SRA->RA_TCKALIM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nVlSubs := SRA->RA_TCKALIM     .END.','000017','000016','.EXE.','5','nVlSubs := SRA->RA_TCKALIM','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nVlLimite := fTabela( "S020" , 1 , 4)     .CNT.','000018','000000','.EXE.','5','nVlLimite := fTabela( "S020" , 1 , 4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','ValType(nVlLimite) <> "N"   .END.','000019','000000','.CON.','5','','','5','ValType(nVlLimite) <> "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nVlLimite:=0     .END.','000020','000019','.EXE.','5','nVlLimite:=0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nDiasUt :=  FO_GETVAL(@oRCF,"RCF_DIATRA")     .CNT.','000021','000000','.EXE.','5','nDiasUt :=  FO_GETVAL(@oRCF,"RCF_DIATRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','FPOSREG("RGD",1,XFILIAL("RGD")+SRA->RA_CODIRCT) == .T.   .','000022','000000','.CON.','5','','','5','FPOSREG("RGD",1,XFILIAL("RGD")+SRA->RA_CODIRCT) == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','cCodigos := RGD->RGD_CDFREF     .CNT.','000023','000022','.EXE.','5','cCodigos := RGD->RGD_CDFREF','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nHrsMinPer := RGD->RGD_HORMIN     .CNT.','000024','000022','.EXE.','5','nHrsMinPer := RGD->RGD_HORMIN','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nx := 1     .CNT.','000025','000022','.EXE.','5','nx := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nx <= 80   .END.','000026','000022','.ENQ.','5','','','5','nx <= 80','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','Empty(Substr(cCodigos,nx,3) )   .END.','000027','000026','.CON.','5','','','5','Empty(Substr(cCodigos,nx,3) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','FimEnquanto()     .END.','000028','000027','.EXE.','5','FimEnquanto()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','FO_SEEK(@ORCM, "RCM_TIPO", SUBSTR(CCODIGOS, NX,3))   .END.','000029','000026','.CON.','5','','','5','FO_SEEK(@ORCM, "RCM_TIPO", SUBSTR(CCODIGOS, NX,3))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','CVERFAL := FO_GETVAL(@ORCM, "RCM_PD")     .END.','000030','000029','.EXE.','5','CVERFAL := FO_GETVAL(@ORCM, "RCM_PD")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','!Empty(cVerFal)   .END.','000031','000026','.CON.','5','','','5','!Empty(cVerFal)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','cVerFal $ fGetCodFol("055") + "|" +fGetCodFol("243")   .EN','000032','000031','.CON.','5','','','5','cVerFal $ fGetCodFol("055") + "|" +fGetCodFol("243")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GoTop(@oRGB)     .CNT.','000033','000032','.EXE.','5','fo_GoTop(@oRGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','!fo_Eof(@oRGB)   .END.','000034','000032','.ENQ.','5','','','5','!fo_Eof(@oRGB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','Fo_GetVal(@oRGB , "RGB_PD") == cVerFal   .END.','000035','000034','.CON.','5','','','5','Fo_GetVal(@oRGB , "RGB_PD") == cVerFal','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_DUM")>0 .or.fo_GetVal(@ORGB, "RGB_DD','000036','000035','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_DUM")>0 .or.fo_GetVal(@ORGB, "RGB_DDOIS")>0 .Or. fo_GetVal(@ORGB, "RGB_DTRES")>0 .Or. fo_GetVal(@ORGB, "RGB_DQUATR")>0 .or.fo_GetVal(@ORGB, "RGB_DCINCO")>0 .Or. fo_GetVal(@ORGB, "RGB_DSEIS")>0 .Or. fo_GetVal(@ORGB,"RGB_DSETE")>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','lBox := .T.     .END.','000037','000036','.EXE.','5','lBox := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_DUM") >= nHrsMinPer   .END.','000038','000035','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_DUM") >= nHrsMinPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas++     .END.','000039','000038','.EXE.','5','nFaltas++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_DDOIS") >= nHrsMinPer   .END.','000040','000035','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_DDOIS") >= nHrsMinPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas++     .END.','000041','000040','.EXE.','5','nFaltas++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_DTRES") >= nHrsMinPer   .END.','000042','000035','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_DTRES") >= nHrsMinPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas++     .END.','000043','000042','.EXE.','5','nFaltas++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_DQUATR") >= nHrsMinPer   .END.','000044','000035','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_DQUATR") >= nHrsMinPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas++     .END.','000045','000044','.EXE.','5','nFaltas++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_DCINCO") >= nHrsMinPer   .END.','000046','000035','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_DCINCO") >= nHrsMinPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas++     .END.','000047','000046','.EXE.','5','nFaltas++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_DSEIS") >= nHrsMinPer   .END.','000048','000035','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_DSEIS") >= nHrsMinPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas++     .END.','000049','000048','.EXE.','5','nFaltas++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_DSETE") >= nHrsMinPer   .END.','000050','000035','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_DSETE") >= nHrsMinPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas++     .END.','000051','000050','.EXE.','5','nFaltas++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','lBox == .F.   .END.','000052','000035','.CON.','5','','','5','lBox == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_GetVal(@oRGB, "RGB_HORAS") >= nHrsMinPer   .END.','000053','000052','.CON.','5','','','5','fo_GetVal(@oRGB, "RGB_HORAS") >= nHrsMinPer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas++     .END.','000054','000053','.EXE.','5','nFaltas++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','lBox := .F.     .END.','000055','000035','.EXE.','5','lBox := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','FO_SKIP(@oRGB)     .END.','000056','000034','.EXE.','5','FO_SKIP(@oRGB)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','!(cVerFal $ fGetCodFol("055") + "|" +fGetCodFol("243") )','000057','000031','.CON.','5','','','5','!(cVerFal $ fGetCodFol("055") + "|" +fGetCodFol("243") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_Gotop(@&cObjeto)     .CNT.','000058','000057','.EXE.','5','fo_Gotop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','fo_Seek(@&cObjeto, {cCpoPd, cCpoNPagto} , {cVerFal, cNumPa','000059','000057','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPd, cCpoNPagto} , {cVerFal, cNumPag } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nFaltas += fo_GetVal(@&cObjeto, cCpoHoras)     .END.','000060','000059','.EXE.','5','nFaltas += fo_GetVal(@&cObjeto, cCpoHoras)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','cVerFal := ""     .CNT.','000061','000026','.EXE.','5','cVerFal := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nx += 3     .END.','000062','000026','.EXE.','5','nx += 3','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nHrsMinPer := 0     .END.','000063','000022','.EXE.','5','nHrsMinPer := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nSubsidio := ( nDiasUt - nFaltas ) * nVlSubs     .CNT.','000064','000000','.EXE.','5','nSubsidio := ( nDiasUt - nFaltas ) * nVlSubs','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nSubsIsent := If( (nVlLimite * nDiasUt) > nSubsidio, nSubsid','000065','000000','.EXE.','5','nSubsIsent := If( (nVlLimite * nDiasUt) > nSubsidio, nSubsidio,  (nVlLimite * nDiasUt ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nSubsTrib := (nSubsidio - nSubsIsent)     .CNT.','000066','000000','.EXE.','5','nSubsTrib := (nSubsidio - nSubsIsent)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSUBRE','nDiasSub := ( nDiasUt - nFaltas)     .END.','000067','000000','.EXE.','5','nDiasSub := ( nDiasUt - nFaltas)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0022    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0022( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALVLFER','CALCULA VALOR DE FERIAS','','','020','2','1',} )

aAdd(aRc3Cols, { '','S_','CALVLFER','!FO_SEEK(@&cObjeto, cCpoPD, FGETCODFOL("0072"))   .END.','000001','000000','.CON.','5','','','5','!FO_SEEK(@&cObjeto, cCpoPD, FGETCODFOL("0072"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','nValor := ROUND( SALDIA * GetMemVar("RH_DFERIAS") , 2 )','000002','000001','.EXE.','5','nValor := ROUND( SALDIA * GetMemVar("RH_DFERIAS") , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','nValor > 0   .END.','000003','000001','.CON.','5','','','5','nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','Fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras } , { fGetCo','000004','000003','.EXE.','5','Fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras } , { fGetCodFol("0072"), ROUND(nValor,2), GetMemVar("RH_DFERIAS") } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0023    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0023( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCF','Carrega Periodos','','001046','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCF','lRotBlank := .F.     .CNT.','000001','000000','.EXE.','5','lRotBlank := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cKey :=  xFilial( "RCH" ) + cProcesso + cPeriodo + cNumPag +','000002','000000','.EXE.','5','cKey :=  xFilial( "RCH" ) + cProcesso + cPeriodo + cNumPag + c__roteiro','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','nIndice := RETORDER("RCF", "RCF_FILIAL+RCF_PROCES+RCF_PER+RC','000003','000000','.EXE.','5','nIndice := RETORDER("RCF", "RCF_FILIAL+RCF_PROCES+RCF_PER+RCF_SEMANA+RCF_ROTEIR+RCF_TNOTRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','fPosPeriodo( xFilial( "RCH" ), cProcesso, cPeriodo, cNumPa','000004','000000','.CON.','5','','','5','fPosPeriodo( xFilial( "RCH" ), cProcesso, cPeriodo, cNumPag, c__roteiro, , @lRotBlank, 1 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cKey := xFilial("RCF") + cProcesso + cPeriodo + cNumPag + If','000005','000004','.EXE.','5','cKey := xFilial("RCF") + cProcesso + cPeriodo + cNumPag + If( lRotBlank, Space(3),  c__Roteiro )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','fo_New( @oRCF , "RCF" , nIndice , cKey )     .END.','000006','000000','.EXE.','5','fo_New( @oRCF , "RCF" , nIndice , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0024    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0024( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCH','Carrega Periodos de Calculo','','001047','033','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCH','cPeriodo := GetPeriodCalc()   .CNT.','000001','000000','.EXE.','5','cPeriodo',':=','5','GetPeriodCalc()','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cNumPag := GetNumPgCalc()   .CNT.','000002','000000','.EXE.','5','cNumPag',':=','5','GetNumPgCalc()','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cProcesso := SRA->RA_PROCES   .CNT.','000003','000000','.EXE.','5','cProcesso',':=','5','SRA->RA_PROCES','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','nRchOrd := RetOrder( "RCH" , "RCH_FILIAL+RCH_PROCES+RCH_PER+','000004','000000','.EXE.','5','nRchOrd := RetOrder( "RCH" , "RCH_FILIAL+RCH_PROCES+RCH_PER+RCH_NUMPAG+RCH_ROTEIR" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000005','000000','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo + cNumPag + c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_Eof(@oRCH)   .END.','000006','000000','.CON.','5','','','5','fo_Eof(@oRCH)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000007','000006','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo + cNumPag + "   ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_Eof(@oRCH) .And. cTipoRot == "9"   .END.','000008','000000','.CON.','5','','','5','fo_Eof(@oRCH) .And. cTipoRot == "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + c','000009','000008','.EXE.','5','fo_New(@oRCH, "RCH", nRchOrd, xFilial("RCH") + cProcesso + cPeriodo +  "  " + "   ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataDe := fo_GetVal(@oRCH, "RCH_DTINI", 1)   .CNT.','000010','000000','.EXE.','5','dDataDe',':=','5','fo_GetVal(@oRCH, "RCH_DTINI", 1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataAte := fo_GetVal(@oRCH, "RCH_DTFIM", 1)   .CNT.','000011','000000','.EXE.','5','dDataAte',':=','5','fo_GetVal(@oRCH, "RCH_DTFIM", 1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cAnoMes  := fo_GetVal(@oRCH, "RCH_ANO", 1) + fo_GetVal(@oRCH','000012','000000','.EXE.','5','cAnoMes  := fo_GetVal(@oRCH, "RCH_ANO", 1) + fo_GetVal(@oRCH, "RCH_MES",1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPAGO", 1)     .CNT.','000013','000000','.EXE.','5','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPAGO", 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataref := CTOD("01/" + fo_getVal(@oRCH, "RCH_MES", 1) + "/','000014','000000','.EXE.','5','dDataref',':=','5','CTOD("01/" + fo_getVal(@oRCH, "RCH_MES", 1) + "/" + fo_getVal(@oRCH, "RCH_ANO", 1))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fPosReg("SRY", 1, xFIlial("SRY") + c__Roteiro)     .CNT.','000015','000000','.EXE.','5','fPosReg("SRY", 1, xFIlial("SRY") + c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cTipoRot := SRY->RY_TIPO   .END.','000016','000000','.EXE.','5','cTipoRot',':=','5','SRY->RY_TIPO','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0025    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0025( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCM','Carrega Tipo de Ausencia','','001048','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCM','fo_New(@oRCM, "RCM", 1, xFIlial("RCM"))     .END.','000001','000000','.EXE.','5','fo_New(@oRCM, "RCM", 1, xFIlial("RCM"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0026    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0026( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARG1','CARGA RG1','','','032','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARG1','cRetOrder := "RG1_FILIAL+RG1_MAT+RG1_ORDEM+RG1_PD+DTOS(RG1_D','000001','000000','.EXE.','5','cRetOrder := "RG1_FILIAL+RG1_MAT+RG1_ORDEM+RG1_PD+DTOS(RG1_DINIPG)"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','nRG1Order := RetOrder( "RG1" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nRG1Order := RetOrder( "RG1" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','LSQLWHERE := .T.     .CNT.','000004','000000','.EXE.','5','LSQLWHERE := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','LTOPFILTER := .T.     .CNT.','000005','000000','.EXE.','5','LTOPFILTER := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cTipoRot = "3"   .END.','000006','000000','.CON.','5','','','5','cTipoRot = "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cAnoMes := MesAno(GetMemVar("RH_DATAINI") )     .END.','000007','000006','.EXE.','5','cAnoMes := MesAno(GetMemVar("RH_DATAINI") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','( LTOP := IFDEFTOP() )   .END.','000008','000000','.CON.','5','','','5','( LTOP := IFDEFTOP() )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere := "RG1_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " +','000009','000008','.EXE.','5','cQueryWhere := "RG1_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "RG1_MAT='+"'"+'" + SRA->RA_MAT + "'+"'"+' AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "  RG1_DINIPG<= '+"'"+'" + CANOMES +  StrZero(f_Ult','000010','000008','.EXE.','5','cQueryWhere += "  RG1_DINIPG<= '+"'"+'" + CANOMES +  StrZero(f_Ultdia(dDataRef),2) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " AND "     .CNT.','000011','000008','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "( RG1_DFIMPG =  '+"'"+'        '+"'"+' "+ " or " + "RG1_','000012','000008','.EXE.','5','cQueryWhere','+=','5','"( RG1_DFIMPG =  '+"'"+'        '+"'"+' "+ " or " + "RG1_DFIMPG >= '+"'"+'" + CANOMES + '+"'"+'01'+"'"+' + "'+"'"+'  ) "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " AND "     .CNT.','000013','000008','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "D_E_L_E_T_<> '+"'"+'*'+"'"+' "     .END.','000014','000008','.EXE.','5','cQueryWhere += "D_E_L_E_T_<> '+"'"+'*'+"'"+' "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','!LTOP   .END.','000015','000000','.CON.','5','','','5','!LTOP','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere := "  DTOS(RG1_DINIPG) <= '+"'"+'" + CANOMES +  StrZer','000016','000015','.EXE.','5','cQueryWhere := "  DTOS(RG1_DINIPG) <= '+"'"+'" + CANOMES +  StrZero(f_Ultdia(dDataRef),2) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " .AND. "     .CNT.','000017','000015','.EXE.','5','cQueryWhere += " .AND. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " (DTOS(RG1_DFIMPG) == '+"'"+'        '+"'"+'  .OR. DTOS(','000018','000015','.EXE.','5','cQueryWhere += " (DTOS(RG1_DFIMPG) == '+"'"+'        '+"'"+'  .OR. DTOS(RG1_DFIMPG)  >='+"'"+'" + CANOMES +'+"'"+'01'+"'"+'+"'+"'"+' ) "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','FO_NEW(@oRG1 , "RG1",nRG1Order , cKey , cQueryWhere, @lSqlWh','000019','000000','.EXE.','5','FO_NEW(@oRG1 , "RG1",nRG1Order , cKey , cQueryWhere, @lSqlWhere , @lTopFilter)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0027    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0027( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARGB','CARGA TABELA RGB','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARGB','GetRgb()     .END.','000001','000000','.EXE.','5','GetRgb()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0028    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0028( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASR8','Carrega Ausencias','','001049','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASR8','GetSr8()     .END.','000001','000000','.EXE.','5','GetSr8()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0029    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0029( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRB','CARGA SRB','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRB','cRetOrder := "RB_FILIAL+RB_MAT"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RB_FILIAL+RB_MAT"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','nSrbOrder := RetOrder( "SRB" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSrbOrder := RetOrder( "SRB" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','FO_NEW(@oSRB , "SRB",nSrbOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oSRB , "SRB",nSrbOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0030    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0030( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRC','CARREGA LANCAMENTOS','','001050','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRC','GetSrc()     .END.','000001','000000','.EXE.','5','GetSrc()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0031    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0031( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRF','CARREGA SRF','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRF','cRetOrder := "RF_FILIAL+RF_MAT+DTOS(RF_DATABAS)"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RF_FILIAL+RF_MAT+DTOS(RF_DATABAS)"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','nSRFOrder := RetOrder( "SRF" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSRFOrder := RetOrder( "SRF" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','FO_NEW(@oSRF , "SRF",nSRFOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oSRF , "SRF",nSRFOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0032    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0032( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRK','CARREGA VALORES FUTUROS','','001051','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRK','GetSrk()     .END.','000001','000000','.EXE.','5','GetSrk()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0033    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0033( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRO','CARGA SRO','','','024','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRO','cRetOrder := "RO_FILIAL+RO_MAT+DTOS(RO_DATA)+RO_CODTAR"','000001','000000','.EXE.','5','cRetOrder := "RO_FILIAL+RO_MAT+DTOS(RO_DATA)+RO_CODTAR"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','nSroOrder := RetOrder( "SRO" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSroOrder := RetOrder( "SRO" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','LSQLWHERE := .T.     .CNT.','000004','000000','.EXE.','5','LSQLWHERE := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','LTOPFILTER := .T.     .CNT.','000005','000000','.EXE.','5','LTOPFILTER := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','LTOP := IFDEFTOP()   .END.','000006','000000','.CON.','5','','','5','LTOP := IFDEFTOP()','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere := "RO_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "','000007','000006','.EXE.','5','cQueryWhere := "RO_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "RO_MAT='+"'"+'" + SRA->RA_MAT + "'+"'"+' AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " ( (RO_TIPO = '+"'"+'1'+"'"+' "+ "AND" + " RO_DATA<='+"'"+'" +','000008','000006','.EXE.','5','cQueryWhere += " ( (RO_TIPO = '+"'"+'1'+"'"+' "+ "AND" + " RO_DATA<='+"'"+'" + cAnoMes +'+"'"+'31'+"'"+'+ "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " AND "     .CNT.','000009','000006','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( RO_DATAATE = '+"'"+'        '+"'"+'  "+" OR "+ "RO_DAT','000010','000006','.EXE.','5','cQueryWhere += "( RO_DATAATE = '+"'"+'        '+"'"+'  "+" OR "+ "RO_DATAATE >='+"'"+'" + cAnoMes + '+"'"+'01'+"'"+' + "'+"'"+' ) ) "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " OR "     .CNT.','000011','000006','.EXE.','5','cQueryWhere += " OR "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( RO_TIPO = '+"'"+'2'+"'"+'   " + " AND "+  "RO_DATA   <','000012','000006','.EXE.','5','cQueryWhere += "( RO_TIPO = '+"'"+'2'+"'"+'   " + " AND "+  "RO_DATA   <=  '+"'"+'"              +DTOS(dDataAte) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " AND "     .CNT.','000013','000006','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( RO_DATAATE = '+"'"+'        '+"'"+'   "+ "OR '+"'"+'" + Dtos','000014','000006','.EXE.','5','cQueryWhere += "( RO_DATAATE = '+"'"+'        '+"'"+'   "+ "OR '+"'"+'" + Dtos(dDataAte)+"'+"'"+' >= '+"'"+'" + Dtos(dDataDe) + "'+"'"+') ) )"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','!LTOP   .END.','000015','000000','.CON.','5','','','5','!LTOP','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere := " ( (RO_TIPO ==  '+"'"+'1'+"'"+' .AND.  DTOS(RO_DATA) <=','000016','000015','.EXE.','5','cQueryWhere := " ( (RO_TIPO ==  '+"'"+'1'+"'"+' .AND.  DTOS(RO_DATA) <= '+"'"+'" +CANOMES +'+"'"+'31'+"'"+'+ "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " .AND. "     .CNT.','000017','000015','.EXE.','5','cQueryWhere += " .AND. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( DTOS(RO_DATAATE)  == '+"'"+'        '+"'"+'  .OR. DTOS','000018','000015','.EXE.','5','cQueryWhere += "( DTOS(RO_DATAATE)  == '+"'"+'        '+"'"+'  .OR. DTOS(RO_DATAATE) >= '+"'"+'" + cAnoMes + '+"'"+'01'+"'"+'+"'+"'"+' ) )"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " .OR. "     .CNT.','000019','000015','.EXE.','5','cQueryWhere += " .OR. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "(RO_TIPO  == '+"'"+'2'+"'"+' .AND. DTOS(RO_DATA) <='+"'"+'" +','000020','000015','.EXE.','5','cQueryWhere += "(RO_TIPO  == '+"'"+'2'+"'"+' .AND. DTOS(RO_DATA) <='+"'"+'" + Dtos(dDataAte) +"'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " .AND. "     .CNT.','000021','000015','.EXE.','5','cQueryWhere += " .AND. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( DTOS(RO_DATAATE) == '+"'"+'        '+"'"+'   .OR. '+"'"+'" +','000022','000015','.EXE.','5','cQueryWhere += "( DTOS(RO_DATAATE) == '+"'"+'        '+"'"+'   .OR. '+"'"+'" +Dtos(dDataAte)+"'+"'"+' >='+"'"+'" + Dtos(dDataDe) + "'+"'"+' ) ) ) "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','FO_NEW(@oSRO , "SRO",nSroOrder , cKey , cQueryWhere, @LSQLWH','000023','000000','.EXE.','5','FO_NEW(@oSRO , "SRO",nSroOrder , cKey , cQueryWhere, @LSQLWHERE , @LTOPFILTER)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0034    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0034( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGATAB','CARREGA INFORMACOES DA TABELA','','000320','008','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGATAB','cTipoRot $ "3*4" .END.','000001','000000','.CON.','5','','','5','cTipoRot','$','5','"3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cObjeto := "oSRR"   .CNT.','000002','000001','.EXE.','5','cObjeto',':=','5','"oSRR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoCC := "RR_CC"   .CNT.','000003','000001','.EXE.','5','cCpoCC',':=','5','"RR_CC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoData := "RR_DATA"   .CNT.','000004','000001','.EXE.','5','cCpoData',':=','5','"RR_DATA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHoras := "RR_HORAS"   .CNT.','000005','000001','.EXE.','5','cCpoHoras',':=','5','"RR_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHorInf := "RR_HORINFO"   .CNT.','000006','000001','.EXE.','5','cCpoHorInf',':=','5','"RR_HORINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNPagto := "RR_SEMANA"   .CNT.','000007','000001','.EXE.','5','cCpoNPagto',':=','5','"RR_SEMANA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNumID := "RR_NUMID"   .CNT.','000008','000001','.EXE.','5','cCpoNumID',':=','5','"RR_NUMID"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPD := "RR_PD"   .CNT.','000009','000001','.EXE.','5','cCpoPD',':=','5','"RR_PD"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoSeq := "RR_SEQ"   .CNT.','000010','000001','.EXE.','5','cCpoSeq',':=','5','"RR_SEQ"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo1 := "RR_TIPO1"   .CNT.','000011','000001','.EXE.','5','cCpoTipo1',':=','5','"RR_TIPO1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo2 := "RR_TIPO2"   .CNT.','000012','000001','.EXE.','5','cCpoTipo2',':=','5','"RR_TIPO2"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValor := "RR_VALOR"   .CNT.','000013','000001','.EXE.','5','cCpoValor',':=','5','"RR_VALOR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValInf := "RR_VALINFO"   .CNT.','000014','000001','.EXE.','5','cCpoValInf',':=','5','"RR_VALINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMat := "RR_MAT"   .CNT.','000015','000001','.EXE.','5','cCpoMat',':=','5','"RR_MAT"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoRot := "RR_ROTEIR"   .CNT.','000016','000001','.EXE.','5','cCpoRot',':=','5','"RR_ROTEIR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPer := "RR_PERIODO"   .CNT.','000017','000001','.EXE.','5','cCpoPer',':=','5','"RR_PERIODO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoFilial := "RR_FILIAL"     .CNT.','000018','000001','.EXE.','5','cCpoFilial := "RR_FILIAL"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoProc := "RR_PROCES"     .CNT.','000019','000001','.EXE.','5','cCpoProc := "RR_PROCES"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDepto := "RR_DEPTO"     .END.','000020','000001','.EXE.','5','cCpoDepto := "RR_DEPTO"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','!(cTipoRot $ "3*4")   .END.','000021','000000','.CON.','5','','','5','!(cTipoRot $ "3*4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cObjeto := "oSRC"   .CNT.','000022','000021','.EXE.','5','cObjeto',':=','5','"oSRC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoCC := "RC_CC"   .CNT.','000023','000021','.EXE.','5','cCpoCC',':=','5','"RC_CC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoData := "RC_DATA"   .CNT.','000024','000021','.EXE.','5','cCpoData',':=','5','"RC_DATA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHoras := "RC_HORAS"   .CNT.','000025','000021','.EXE.','5','cCpoHoras',':=','5','"RC_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHorInf := "RC_HORINFO"   .CNT.','000026','000021','.EXE.','5','cCpoHorInf',':=','5','"RC_HORINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNPagto := "RC_SEMANA"   .CNT.','000027','000021','.EXE.','5','cCpoNPagto',':=','5','"RC_SEMANA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNumID := "RC_NUMID"   .CNT.','000028','000021','.EXE.','5','cCpoNumID',':=','5','"RC_NUMID"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPD := "RC_PD"   .CNT.','000029','000021','.EXE.','5','cCpoPD',':=','5','"RC_PD"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoQtdSem := "RC_QTDSEM"   .CNT.','000030','000021','.EXE.','5','cCpoQtdSem',':=','5','"RC_QTDSEM"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoSeq := "RC_SEQ"   .CNT.','000031','000021','.EXE.','5','cCpoSeq',':=','5','"RC_SEQ"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo1 := "RC_TIPO1"   .CNT.','000032','000021','.EXE.','5','cCpoTipo1',':=','5','"RC_TIPO1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo2 := "RC_TIPO2"   .CNT.','000033','000021','.EXE.','5','cCpoTipo2',':=','5','"RC_TIPO2"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValInf := "RC_VALINFO"   .CNT.','000034','000021','.EXE.','5','cCpoValInf',':=','5','"RC_VALINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValor := "RC_VALOR"   .CNT.','000035','000021','.EXE.','5','cCpoValor',':=','5','"RC_VALOR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMat := "RC_MAT"   .CNT.','000036','000021','.EXE.','5','cCpoMat',':=','5','"RC_MAT"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoParcel := "RC_PARCELA"   .CNT.','000037','000021','.EXE.','5','cCpoParcel',':=','5','"RC_PARCELA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoRot := "RC_ROTEIR"   .CNT.','000038','000021','.EXE.','5','cCpoRot',':=','5','"RC_ROTEIR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPer := "RC_PERIODO"   .CNT.','000039','000021','.EXE.','5','cCpoPer',':=','5','"RC_PERIODO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDtRef := "RC_DTREF"   .CNT.','000040','000021','.EXE.','5','cCpoDtRef',':=','5','"RC_DTREF"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoFilial := "RC_FILIAL"     .CNT.','000041','000021','.EXE.','5','cCpoFilial := "RC_FILIAL"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPosto := "RC_POSTO"     .CNT.','000042','000021','.EXE.','5','cCpoPosto := "RC_POSTO"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoProc := "RC_PROCES"     .CNT.','000043','000021','.EXE.','5','cCpoProc := "RC_PROCES"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDepto := "RC_DEPTO"     .END.','000044','000021','.EXE.','5','cCpoDepto := "RC_DEPTO"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0035    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0035( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARPARFE','CARREGA PAR. MEDIA ROT. FERIAS','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CARPARFE','dDt1 := GetMemVar("RH_DATABAS")   .CNT.','000001','000000','.EXE.','5','dDt1',':=','5','GetMemVar("RH_DATABAS")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARFE','dDt2 := CTOD("")   .CNT.','000002','000000','.EXE.','5','dDt2',':=','5','CTOD("")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARFE','dDt3 := GetMemVar("RH_DATAINI")   .CNT.','000003','000000','.EXE.','5','dDt3',':=','5','GetMemVar("RH_DATAINI")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARFE','dDt4 := CTOD("")   .CNT.','000004','000000','.EXE.','5','dDt4',':=','5','CTOD("")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARFE','dDt5 := IF(FUNNAME()=="GPEM060",M->RH_DATAINI,DDATABASE)   .','000005','000000','.EXE.','5','dDt5',':=','5','IF(FUNNAME()=="GPEM060",M->RH_DATAINI,DDATABASE)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARFE','lMesAtu := If (GetMemVar("RH_MEDATU") == "S" , .T. , .F.)','000006','000000','.EXE.','5','lMesAtu',':=','5','If (GetMemVar("RH_MEDATU") == "S" , .T. , .F.)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARFE','lMovto := .T.   .CNT.','000007','000000','.EXE.','5','lMovto',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARFE','lFaltas := .F.   .END.','000008','000000','.EXE.','5','lFaltas',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0036    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0036( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','COTASIND','CALCULO DE COTA SINDICAL','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','COTASIND','nBsSinFun := 0     .CNT.','000001','000000','.EXE.','5','nBsSinFun := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','COTASIND','nVlCotaSind := 0     .CNT.','000002','000000','.EXE.','5','nVlCotaSind := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','COTASIND','nPerCtSind := 0     .CNT.','000003','000000','.EXE.','5','nPerCtSind := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','COTASIND','!EMPTY(SRA->RA_SINDICA) .AND. ( FPOSREG("RCE",1,XFILIAL("R','000004','000000','.CON.','5','','','5','!EMPTY(SRA->RA_SINDICA) .AND. ( FPOSREG("RCE",1,XFILIAL("RCE")+SRA->RA_SINDICA)==.T. )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','COTASIND','nPerCtSind := RCE->RCE_PORSIN     .CNT.','000005','000004','.EXE.','5','nPerCtSind := RCE->RCE_PORSIN','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','COTASIND','nBsSinFun := FO_SOMAINCSRV(@&cObjeto,cCpoValor,"RV_SINDICA",','000006','000004','.EXE.','5','nBsSinFun := FO_SOMAINCSRV(@&cObjeto,cCpoValor,"RV_SINDICA","S")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','COTASIND','nPerCtSind > 0 .And. nBsSinFun > 0   .END.','000007','000004','.CON.','5','','','5','nPerCtSind > 0 .And. nBsSinFun > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','COTASIND','nVlCotaSind := nBsSinFun *  (nPerCtSind / 100)     .END.','000008','000007','.EXE.','5','nVlCotaSind := nBsSinFun *  (nPerCtSind / 100)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0037    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0037( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DEFVARES','DEFINE VARIAVEIS PARA CALCULO RESCISAO','','','011','2','1',} )

aAdd(aRc3Cols, { '','S_','DEFVARES','S_DIASANO()     .CNT.','000001','000000','.EXE.','5','S_DIASANO()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DEFVARES','S_BASEFER()     .CNT.','000002','000000','.EXE.','5','S_BASEFER()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DEFVARES','S_CALANTIG()     .END.','000003','000000','.EXE.','5','S_CALANTIG()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0038    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0038( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DIAS13PT','DIAS DE 13 ADQUIRIDOS PORTUGAL','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','DIAS13PT','nDias13PT := 0     .CNT.','000001','000000','.EXE.','5','nDias13PT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIAS13PT','dDataIni := Max(CTOD("01/01/"+STRZERO(YEAR(DDATAATE),4)), SR','000002','000000','.EXE.','5','dDataIni := Max(CTOD("01/01/"+STRZERO(YEAR(DDATAATE),4)), SRA->RA_ADMISSA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIAS13PT','dDataFim := DDATAATE     .CNT.','000003','000000','.EXE.','5','dDataFim := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIAS13PT','Month(DDATAINI) <= Month(DDATAATE)   .END.','000004','000000','.ENQ.','5','','','5','Month(DDATAINI) <= Month(DDATAATE)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','DIAS13PT','nDiasNat := F_ULTDIA(dDataIni)     .CNT.','000005','000004','.EXE.','5','nDiasNat := F_ULTDIA(dDataIni)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIAS13PT','nDias13PT += nDiasNat     .CNT.','000006','000004','.EXE.','5','nDias13PT += nDiasNat','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIAS13PT','DDATAINI := DDATAINI + nDiasNat     .END.','000007','000004','.EXE.','5','DDATAINI := DDATAINI + nDiasNat','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIAS13PT','nDias13PT := nDias13PT + NAUS13PT     .END.','000008','000000','.EXE.','5','nDias13PT := nDias13PT + NAUS13PT','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0039    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0039( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DIASANO','OBTEM DIAS NO ANO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','DIASANO','NDIASANO := 365 + IF(MOD(VAL(SUBSTR(CANOMES,1,4)),4) == 0, 1','000001','000000','.EXE.','5','NDIASANO := 365 + IF(MOD(VAL(SUBSTR(CANOMES,1,4)),4) == 0, 1, 0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0040    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0040( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DIASTRAB','DIAS/HOR TRAB E DIAS/HOR DSR','','000830','072','2','1',} )

aAdd(aRc3Cols, { '','S_','DIASTRAB','!fo_Seek(@oRCF, "RCF_TNOTRA", SRA->RA_TNOTRAB)   .END.','000001','000000','.CON.','5','','','5','!fo_Seek(@oRCF, "RCF_TNOTRA", SRA->RA_TNOTRAB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fo_Seek(@oRCF, "RCF_TNOTRA",  "@@@")     .END.','000002','000001','.EXE.','5','fo_Seek(@oRCF, "RCF_TNOTRA",  "@@@")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','NORMAL :=  fo_GetVal(@oRCF , "RCF_HRSTRA")     .CNT.','000003','000000','.EXE.','5','NORMAL :=  fo_GetVal(@oRCF , "RCF_HRSTRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DESCANSO := fo_GetVal(@oRCF , "RCF_HRSDSR")     .CNT.','000004','000000','.EXE.','5','DESCANSO := fo_GetVal(@oRCF , "RCF_HRSDSR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*P*A*E*I*1*2*3*4*5*6"','000005','000000','.EXE.','5','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*P*A*E*I*1*2*3*4*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_SITFOLH == " "  .and. MesAno(sra->ra_admissa) < cA','000006','000000','.CON.','5','','','5','SRA->RA_SITFOLH == " "  .and. MesAno(sra->ra_admissa) < cAnoMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasDSR := fo_GetVal(@oRCF, "RCF_DIADSR")     .CNT.','000007','000006','.EXE.','5','DiasDSR := fo_GetVal(@oRCF, "RCF_DIADSR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasDSR := DESCANSO     .CNT.','000008','000006','.EXE.','5','nHorasDSR := DESCANSO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasTrab := NORMAL     .CNT.','000009','000006','.EXE.','5','nHorasTrab := NORMAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "M" .END.','000010','000006','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .T.   .END.','000011','000010','.CON.','5','','','5','lCatMensal == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM")     .END.','000012','000011','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .F.   .END.','000013','000010','.CON.','5','','','5','lCatMensal == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA") + fo_GetVal(@oRCF','000014','000013','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA") + fo_GetVal(@oRCF, "RCF_DIADSR") + fo_GetVal(@oRCF, "RCF_DNTRAB")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "S" .END.','000015','000006','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA")     .END.','000016','000015','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_SITFOLH <> " " .or. MesAno(SRA->RA_ADMISSA) == cAn','000017','000000','.CON.','5','','','5','SRA->RA_SITFOLH <> " " .or. MesAno(SRA->RA_ADMISSA) == cAnoMes .Or. (cPaisLoc == "PTG" .And. nDiasAfas > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHoras','000018','000017','.EXE.','5','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHorasDSR , @nHorasTrab , , , , cNumPag, .T., , , c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .T.   .AND.','000019','000017','.CON.','5','','','5','lCatMensal == .T.','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "M" .END.','000020','000017','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM") - nDiasAfas     .','000021','000020','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM") - nDiasAfas','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','MesAno(SRA->RA_ADMISSA) = cAnoMes .and. Day(SRA->RA_ADMISS','000022','000020','.CON.','5','','','5','MesAno(SRA->RA_ADMISSA) = cAnoMes .and. Day(SRA->RA_ADMISSA) > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas     .','000023','000022','.EXE.','5','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes := fo_getVal(@ORCH, "RCH_MES",  1)   .CNT.','000024','000020','.EXE.','5','cMes',':=','5','fo_getVal(@ORCH, "RCH_MES",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cAno := fo_getVal(@ORCH, "RCH_ANO",  1)   .CNT.','000025','000020','.EXE.','5','cAno',':=','5','fo_getVal(@ORCH, "RCH_ANO",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR.','000026','000020','.CON.','5','','','5','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR. (cMes $ "04*06*09*11" .AND. nDiasAfas == 30)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000027','000026','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas ==','000028','000020','.CON.','5','','','5','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas == 28) .OR.  (VAL(cAno) % 4 == 0 .AND. nDiasAfas == 29) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000029','000028','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0041    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0041( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FCALARRE','CALCULA ARREDONDAMENTO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','FCALARRE','nResto := Mod(nVlrTot , nArred)   .CNT.','000001','000000','.EXE.','5','nResto',':=','5','Mod(nVlrTot , nArred)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','Round(nResto,2) > 0 .END.','000002','000000','.CON.','5','','','5','Round(nResto,2)','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrArre := Round(nArred - nResto,2)   .CNT.','000003','000002','.EXE.','5','nVlrArre',':=','5','Round(nArred - nResto,2)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrTot := (nVlrTot + nVlrArre )   .END.','000004','000002','.EXE.','5','nVlrTot',':=','5','(nVlrTot + nVlrArre )','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0042    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0042( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FCALCPEN','CALCULO DE PENSAO ALIMENTICIA','','','076','2','1',} )

aAdd(aRc3Cols, { '','S_','FCALCPEN','nPercPensao := 0     .CNT.','000001','000000','.EXE.','5','nPercPensao := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipo     := If(cTipo == Nil, Space(3), cTipo)     .CNT.','000002','000000','.EXE.','5','cTipo     := If(cTipo == Nil, Space(3), cTipo)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cPensao := ""     .CNT.','000003','000000','.EXE.','5','cPensao := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','dDataPgto := DDATA_PGTO   .CNT.','000004','000000','.EXE.','5','dDataPgto',':=','2','DDATA_PGTO','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "1" .END.','000005','000000','.CON.','5','','','5','cTipoRot','==','5','"1"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cIR := fGetCodFol("0066")   .END.','000006','000005','.EXE.','5','cIR',':=','5','fGetCodFol("0066")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "2" .END.','000007','000000','.CON.','5','','','5','cTipoRot','==','5','"2"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cIR := fGetCodFol("0009")   .END.','000008','000007','.EXE.','5','cIR',':=','5','fGetCodFol("0009")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "6" .END.','000009','000000','.CON.','5','','','5','cTipoRot','==','5','"6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cIR := fGetCodFol("0071")   .END.','000010','000009','.EXE.','5','cIR',':=','5','fGetCodFol("0071")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "4" .END.','000011','000000','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','dDataPgto := GetMemVar("RG_DATAHOM")   .CNT.','000012','000011','.EXE.','5','dDataPgto',':=','5','GetMemVar("RG_DATAHOM")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoPens := If( Empty(cTipo), "FOL", cTipo )   .CNT.','000013','000011','.EXE.','5','cTipoPens',':=','5','If( Empty(cTipo), "FOL", cTipo )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoPens == "FOL" .END.','000014','000011','.CON.','5','','','5','cTipoPens','==','5','"FOL"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cIR := fGetCodFol("0066")   .END.','000015','000014','.EXE.','5','cIR',':=','5','fGetCodFol("0066")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoPens == "FER" .END.','000016','000011','.CON.','5','','','5','cTipoPens','==','5','"FER"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cIR := fGetCodFol("0067")   .END.','000017','000016','.EXE.','5','cIR',':=','5','fGetCodFol("0067")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoPens == "132" .END.','000018','000011','.CON.','5','','','5','cTipoPens','==','5','"132"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cIR := fGetCodFol("0071")   .END.','000019','000018','.EXE.','5','cIR',':=','5','fGetCodFol("0071")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "3" .END.','000020','000000','.CON.','5','','','5','cTipoRot','==','5','"3"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','dDataPgto := GetMemVar("RH_DTRECIB")   .CNT.','000021','000020','.EXE.','5','dDataPgto',':=','5','GetMemVar("RH_DTRECIB")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cIR := fGetCodFol("0067")   .END.','000022','000020','.EXE.','5','cIR',':=','5','fGetCodFol("0067")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot ==  "9"   .END.','000023','000000','.CON.','5','','','5','cTipoRot ==  "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cIR := fGetCodFol("0066")   .CNT.','000024','000023','.EXE.','5','cIR',':=','5','fGetCodFol("0066")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoPens := "FOL"   .END.','000025','000023','.EXE.','5','cTipoPens',':=','5','"FOL"','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase   := nLiqTemp   := 0     .CNT.','000026','000000','.EXE.','5','nValBase   := nLiqTemp   := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValInss   := nValIR     := 0     .CNT.','000027','000000','.EXE.','5','nValInss   := nValIR     := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nNrSlMin   := nValFixo   := 0     .CNT.','000028','000000','.EXE.','5','nNrSlMin   := nValFixo   := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValPensao := nVlPens131 := 0     .CNT.','000029','000000','.EXE.','5','nValPensao := nVlPens131 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nPosRot  := 0     .CNT.','000030','000000','.EXE.','5','nPosRot  := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cRotVerba  := ""     .CNT.','000031','000000','.EXE.','5','cRotVerba  := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVbBaseP   := ""     .CNT.','000032','000000','.EXE.','5','cVbBaseP   := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVb131     := ""     .CNT.','000033','000000','.EXE.','5','cVb131     := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVbPLR     := ""     .CNT.','000034','000000','.EXE.','5','cVbPLR     := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVbAdt     := ""     .CNT.','000035','000000','.EXE.','5','cVbAdt     := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCalSlLiq  := .T.     .CNT.','000036','000000','.EXE.','5','lCalSlLiq  := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCadPensao := .T.     .CNT.','000037','000000','.EXE.','5','lCadPensao := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCalSlBru  := .F.     .CNT.','000038','000000','.EXE.','5','lCalSlBru  := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lUsarIR    := .T.     .CNT.','000039','000000','.EXE.','5','lUsarIR    := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','aCodBenef  := {}     .CNT.','000040','000000','.EXE.','5','aCodBenef  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp   := 1     .CNT.','000041','000000','.EXE.','5','nIndProp   := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','aPdIR := {}     .CNT.','000042','000000','.EXE.','5','aPdIR := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nPosIR  := 0     .CNT.','000043','000000','.EXE.','5','nPosIR  := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nx   := 0     .CNT.','000044','000000','.EXE.','5','nx   := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVal_Peal := 0     .CNT.','000045','000000','.EXE.','5','nVal_Peal := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nPosx := 0     .CNT.','000046','000000','.EXE.','5','nPosx := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cCodPenAdt := ""     .CNT.','000047','000000','.EXE.','5','cCodPenAdt := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndPropAnt:= 1     .CNT.','000048','000000','.EXE.','5','nIndPropAnt:= 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','c_Pensao  := " "     .CNT.','000049','000000','.EXE.','5','c_Pensao  := " "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','n_PercPensao := 0     .CNT.','000050','000000','.EXE.','5','n_PercPensao := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','n_ValFixo:= 0     .CNT.','000051','000000','.EXE.','5','n_ValFixo:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','n_NrSlMin  := 0     .CNT.','000052','000000','.EXE.','5','n_NrSlMin  := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','c_VbBaseP  := ""     .CNT.','000053','000000','.EXE.','5','c_VbBaseP  := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','l_CalSlLiq := .T.     .CNT.','000054','000000','.EXE.','5','l_CalSlLiq := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lDtPen := .F.     .CNT.','000055','000000','.EXE.','5','lDtPen := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cMVProPens := P_PROPENS   .CNT.','000056','000000','.EXE.','5','cMVProPens',':=','5','P_PROPENS','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cMVPENSOUT := P_PENSOUT   .CNT.','000057','000000','.EXE.','5','cMVPENSOUT',':=','5','P_PENSOUT','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','LCARRBENEF := IF(LCARRBENEF == NIL, .T., LCARRBENEF )     .C','000058','000000','.EXE.','5','LCARRBENEF := IF(LCARRBENEF == NIL, .T., LCARRBENEF )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cFilialCor := If(cFilialCor == NIL, SRA->RA_FILIAL, cFilialC','000059','000000','.EXE.','5','cFilialCor',':=','5','If(cFilialCor == NIL, SRA->RA_FILIAL, cFilialCor )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot $ "1|4|9" .END.','000060','000000','.CON.','5','','','5','cTipoRot','$','5','"1|4|9"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := ( Min( DiasTrab, 30 ) / 30 )     .END.','000061','000060','.EXE.','5','nIndProp := ( Min( DiasTrab, 30 ) / 30 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "3" .END.','000062','000000','.CON.','5','','','5','cTipoRot','==','5','"3"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := ( Min( GetMemVar("RH_DFERIAS") , 30 ) / 30 )','000063','000062','.EXE.','5','nIndProp := ( Min( GetMemVar("RH_DFERIAS") , 30 ) / 30 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "2" .END.','000064','000000','.CON.','5','','','5','cTipoRot','==','5','"2"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := ( Min( DiasTb, 30 ) / 30 )     .END.','000065','000064','.EXE.','5','nIndProp := ( Min( DiasTb, 30 ) / 30 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot $ "5|6" .END.','000066','000000','.CON.','5','','','5','cTipoRot','$','5','"5|6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := ( Min( nAvos, 12 ) / 12 )     .END.','000067','000066','.EXE.','5','nIndProp := ( Min( nAvos, 12 ) / 12 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndPropAnt := nIndProp     .CNT.','000068','000000','.EXE.','5','nIndPropAnt := nIndProp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCarrBenef == .T. .END.','000069','000000','.CON.','5','','','5','lCarrBenef','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FBUSCACADBEN(@ACODBENEF, CTIPOPENS )     .END.','000070','000069','.EXE.','5','FBUSCACADBEN(@ACODBENEF, CTIPOPENS )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','Len(aCodBenef) == 0 .END.','000071','000000','.CON.','5','','','5','Len(aCodBenef)','==','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','Len(aPensao) > 0 .END.','000072','000071','.CON.','5','','','5','Len(aPensao)','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nX := 1   .CNT.','000073','000072','.EXE.','5','nX',':=','5','1','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nX <= Len(aPensao)   .END.','000074','000072','.ENQ.','5','','','5','nX <= Len(aPensao)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','Len(aPensao[nx]) == 6   .END.','000075','000074','.CON.','5','','','5','Len(aPensao[nx]) == 6','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','c_Pensao := If(ValType(aPensao[nx,1]) == ValType(cPensao),aP','000076','000075','.EXE.','5','c_Pensao',':=','5','If(ValType(aPensao[nx,1]) == ValType(cPensao),aPensao[nx,1],cPensao)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','n_PercPensao := If(ValType(aPensao[nx,2]) == ValType(nPercPe','000077','000075','.EXE.','5','n_PercPensao',':=','5','If(ValType(aPensao[nx,2]) == ValType(nPercPensao),aPensao[nx,2],nPercPensao)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','n_ValFixo := If(ValType(aPensao[nx,3]) == ValType(nValFixo),','000078','000075','.EXE.','5','n_ValFixo',':=','5','If(ValType(aPensao[nx,3]) == ValType(nValFixo),aPensao[nx,3],nValFixo)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','n_NrSlMin := If(ValType(aPensao[nx,4]) == ValType(nNrSlMin),','000079','000075','.EXE.','5','n_NrSlMin',':=','5','If(ValType(aPensao[nx,4]) == ValType(nNrSlMin),aPensao[nx,4],nNrSlMin)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','c_VbBaseP := If(ValType(aPensao[nx,5]) == ValType(cVbBaseP),','000080','000075','.EXE.','5','c_VbBaseP',':=','5','If(ValType(aPensao[nx,5]) == ValType(cVbBaseP),aPensao[nx,5],cVbBaseP)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','l_CalSlLiq := If(ValType(aPensao[nx,6]) == ValType(lCalSlLiq','000081','000075','.EXE.','5','l_CalSlLiq',':=','5','If(ValType(aPensao[nx,6]) == ValType(lCalSlLiq),aPensao[nx,6],lCalSlLiq)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','Aadd(aCodBenef, { c_Pensao, n_PercPensao, n_ValFixo, n_NrSlM','000082','000075','.EXE.','5','Aadd(aCodBenef, { c_Pensao, n_PercPensao, n_ValFixo, n_NrSlMin, c_VbBaseP, l_CalSlLiq, fGetCodFol("0172") , cVbPLR, "", "", "", "", "", "", "", "", "", "" })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nX := nX + 1 .END.','000083','000074','.EXE.','5','nX',':=','5','nX','+','5','1','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','Len(aPensao) == 0   .END.','000084','000071','.CON.','5','','','5','Len(aPensao) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','Aadd(aCodBenef, { cPensao, nPercPensao, nValFixo, nNrSlMin,','000085','000084','.EXE.','5','Aadd(aCodBenef, { cPensao, nPercPensao, nValFixo, nNrSlMin, cVbBaseP, lCalSlLiq, fGetCodFol("0172") , cVbPLR, "", "", "", "", "", "", "", "", "", "" })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCadPensao := .F.   .END.','000086','000071','.EXE.','5','lCadPensao',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','//aSort( aCodBenef ,,, {|X,Y| X[3]+X[4] > Y[3]+Y[4] .And. X[','000087','000000','.EXE.','5','//aSort( aCodBenef ,,, {|X,Y| X[3]+X[4] > Y[3]+Y[4] .And. X[17] < Y[17] })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 := 1   .CNT.','000088','000000','.EXE.','5','nCnt1',':=','5','1','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 <=  Len(aCodBenef)   .END.','000089','000000','.ENQ.','5','','','5','nCnt1 <=  Len(aCodBenef)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := nIndPropAnt     .CNT.','000090','000089','.EXE.','5','nIndProp := nIndPropAnt','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cPensao := If( cTipo == "DFE", aCodBenef[nCnt1,13], aCodBene','000091','000089','.EXE.','5','cPensao := If( cTipo == "DFE", aCodBenef[nCnt1,13], aCodBenef[nCnt1,1] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nPercPensao := aCodBenef[nCnt1,2]     .CNT.','000092','000089','.EXE.','5','nPercPensao := aCodBenef[nCnt1,2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValFixo    := aCodBenef[nCnt1,3]     .CNT.','000093','000089','.EXE.','5','nValFixo    := aCodBenef[nCnt1,3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nNrSlMin    := aCodBenef[nCnt1,4]     .CNT.','000094','000089','.EXE.','5','nNrSlMin    := aCodBenef[nCnt1,4]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVbBaseP    := aCodBenef[nCnt1,5]     .CNT.','000095','000089','.EXE.','5','cVbBaseP    := aCodBenef[nCnt1,5]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCalSlLiq   := aCodBenef[nCnt1,6]     .CNT.','000096','000089','.EXE.','5','lCalSlLiq   := aCodBenef[nCnt1,6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVb131      := aCodBenef[nCnt1,7]     .CNT.','000097','000089','.EXE.','5','cVb131      := aCodBenef[nCnt1,7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVbPLR      := aCodBenef[nCnt1,8]     .CNT.','000098','000089','.EXE.','5','cVbPLR      := aCodBenef[nCnt1,8]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVbAdt      := aCodBenef[nCnt1,14]     .CNT.','000099','000089','.EXE.','5','cVbAdt      := aCodBenef[nCnt1,14]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cRotVerba   := aCodBenef[nCnt1,16]     .CNT.','000100','000089','.EXE.','5','cRotVerba   := aCodBenef[nCnt1,16]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cMVProPens == "N" .END.','000101','000089','.CON.','5','','','5','cMVProPens','==','5','"N"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValFixo > 0 .Or. nNrSlMin > 0   .END.','000102','000101','.CON.','5','','','5','nValFixo > 0 .Or. nNrSlMin > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "1" .END.','000103','000102','.CON.','5','','','5','cTipoRot','==','5','"1"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := 1     .CNT.','000104','000103','.EXE.','5','nIndProp := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cSitFolha == "F"   .AND.','000105','000103','.CON.','5','','','5','cSitFolha == "F"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','( nPosRot := AT( "FER", cRotVerba ) ) > 0   .END.','000106','000103','.CON.','5','','','5','( nPosRot := AT( "FER", cRotVerba ) ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!Empty( Substr( cRotVerba, nPosRot + 3, 3 ) )   .AND.','000107','000106','.CON.','5','','','5','!Empty( Substr( cRotVerba, nPosRot + 3, 3 ) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SEEK(@&cObjeto, cCpoPD, Substr( cRotVerba, nPosRot + 3,','000108','000106','.CON.','5','','','5','FO_SEEK(@&cObjeto, cCpoPD, Substr( cRotVerba, nPosRot + 3, 3 ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := 0     .END.','000109','000108','.EXE.','5','nIndProp := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot $ "3|4|5|6" .END.','000110','000102','.CON.','5','','','5','cTipoRot','$','5','"3|4|5|6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := 1     .END.','000111','000110','.EXE.','5','nIndProp := 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "5" .AND.','000112','000089','.CON.','5','','','5','cTipoRot','==','5','"5"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','( nValFixo > 0 .Or. nNrSlMin > 0 )   .END.','000113','000089','.CON.','5','','','5','( nValFixo > 0 .Or. nNrSlMin > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!Empty(cPensao) .And. !Empty(cVb131)   .END.','000114','000113','.CON.','5','','','5','!Empty(cPensao) .And. !Empty(cVb131)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nIndProp := nIndProp * nPercentua   .END.','000115','000114','.EXE.','5','nIndProp',':=','5','nIndProp * nPercentua','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','CALCULAR PENSAO PLR - FAZER DEPOIS','000116','000089','.EXE.','5','1',':=','5','1','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','Empty(cPensao)   .OR.','000117','000089','.CON.','5','','','5','Empty(cPensao)','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','(nPercPensao == 0 .And. nValFixo == 0 .And. nNrSlMin == 0)','000118','000089','.CON.','5','','','5','(nPercPensao == 0 .And. nValFixo == 0 .And. nNrSlMin == 0)','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','( ( nValFixo > 0 .Or. nNrSlMin > 0 ) .And. nIndProp == 0 )','000119','000089','.CON.','5','','','5','( ( nValFixo > 0 .Or. nNrSlMin > 0 ) .And. nIndProp == 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 := nCnt1 + 1 .CNT.','000120','000119','.EXE.','5','nCnt1',':=','5','nCnt1','+','5','1','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','RETORNEENQ()     .END.','000121','000119','.EXE.','5','RETORNEENQ()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto}, {cPensao, cNumPag','000122','000089','.CON.','5','','','5','FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto}, {cPensao, cNumPag} )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 := nCnt1 + 1 .CNT.','000123','000122','.EXE.','5','nCnt1',':=','5','nCnt1','+','5','1','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','RETORNEENQ()     .END.','000124','000122','.EXE.','5','RETORNEENQ()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lUsarIR := ( Empty(cVbBaseP) .Or. cIR $ cVbBaseP )   .CNT.','000125','000089','.EXE.','5','lUsarIR',':=','5','( Empty(cVbBaseP) .Or. cIR $ cVbBaseP )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValIR := 0.00     .CNT.','000126','000089','.EXE.','5','nValIR := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lUsarIR == .T. .END.','000127','000089','.CON.','5','','','5','lUsarIR','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto} , {cIR, cNumPag} )','000128','000127','.CON.','5','','','5','FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto} , {cIR, cNumPag} )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValIR := FO_GETVAL(@&cObjeto, cCpoValor )   .END.','000129','000128','.EXE.','5','nValIR',':=','5','FO_GETVAL(@&cObjeto, cCpoValor )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase   := 0.00     .CNT.','000130','000089','.EXE.','5','nValBase   := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValPensao := 0.00     .CNT.','000131','000089','.EXE.','5','nValPensao := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nLiqTemp   := 0.00     .CNT.','000132','000089','.EXE.','5','nLiqTemp   := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValFixo > 0 .END.','000133','000089','.CON.','5','','','5','nValFixo','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValPensao := nValFixo * nIndProp   .CNT.','000134','000133','.EXE.','5','nValPensao',':=','5','nValFixo * nIndProp','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "3" .AND.','000135','000133','.CON.','5','','','5','cTipoRot','==','5','"3"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!empty(cVb131)   .AND.','000136','000133','.CON.','5','','','5','!empty(cVb131)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','PosSrv(cVb131,SRA->RA_FILIAL,"RV_PENSAO") = "S"   .END.','000137','000133','.CON.','5','','','5','PosSrv(cVb131,SRA->RA_FILIAL,"RV_PENSAO") = "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVlPens131 := NoRound( (nValFixo * GetMemVar("RH_PERC13S" )','000138','000137','.EXE.','5','nVlPens131',':=','5','NoRound( (nValFixo * GetMemVar("RH_PERC13S" ) ) / 100 ,2 )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVlPens131 > 0   .END.','000139','000137','.CON.','5','','','5','nVlPens131 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoNPagto,','000140','000139','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoNPagto, cCpoTipo1, cCpoData} , { cVb131, nVlPens131, nPercPensao, cNumPag, "V", dDataPgto} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nNrSlMin > 0 .END.','000141','000089','.CON.','5','','','5','nNrSlMin','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValPensao := NoRound(Val_SalMin * nNrSlMin, 2) * nIndProp','000142','000141','.EXE.','5','nValPensao',':=','5','NoRound(Val_SalMin * nNrSlMin, 2) * nIndProp','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "FER" .AND.','000143','000141','.CON.','5','','','5','cTipoRot','==','5','"FER"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!Empty(cVb131)   .AND.','000144','000141','.CON.','5','','','5','!Empty(cVb131)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','PosSrv(cVb131,SRA->RA_FILIAL,"RV_PENSAO") = "S"   .END.','000145','000141','.CON.','5','','','5','PosSrv(cVb131,SRA->RA_FILIAL,"RV_PENSAO") = "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVlPens131 := NoRound( ((Val_SalMin * nNrSlMin) * GetMemVar(','000146','000145','.EXE.','5','nVlPens131 := NoRound( ((Val_SalMin * nNrSlMin) * GetMemVar("RH_PERC13S" ) ) / 100 , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVlPens131:= NoRound( (nVlPens131 * nPercPensao / 100),2)','000147','000145','.EXE.','5','nVlPens131:= NoRound( (nVlPens131 * nPercPensao / 100),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVlPens131 > 0   .END.','000148','000145','.CON.','5','','','5','nVlPens131 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoNPagto,','000149','000148','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoNPagto, cCpoTipo1, cCpoData} , { cVb131, nVlPens131, nPercPensao, cNumPag, "V", dDataPgto} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValFixo <= 0 .AND. nNrSlMin <= 0   .END.','000150','000089','.CON.','5','','','5','nValFixo <= 0 .AND. nNrSlMin <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "2" .END.','000151','000150','.CON.','5','','','5','cTipoRot','==','5','"2"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','//	FBSPENSADT(APD,@NVALBASE) - CALCULAR DEPOIS','000152','000151','.EXE.','5','1',':=','5','1','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "5" .END.','000153','000150','.CON.','5','','','5','cTipoRot','==','5','"5"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCadPensao == .T. .END.','000154','000153','.CON.','5','','','5','lCadPensao','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_GOTOP(@&cObjeto)     .CNT.','000155','000154','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','! FO_EOF(@&cObjeto )   .END.','000156','000154','.ENQ.','5','','','5','! FO_EOF(@&cObjeto )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!FO_DELETED(@&cObjeto)   .AND.','000157','000156','.CON.','5','','','5','!FO_DELETED(@&cObjeto)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','( FO_GETVAL(@&cObjeto, cCpoPD ) $  cVbBaseP  .OR. Empty(cV','000158','000156','.CON.','5','','','5','( FO_GETVAL(@&cObjeto, cCpoPD ) $  cVbBaseP  .OR. Empty(cVbBaseP) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(FO_GETVAL(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_','000159','000158','.CON.','5','','','5','POSSRV(FO_GETVAL(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_PENSAO" ) == "S"  .And. FO_GETVAL(@&COBJETO,CCPONPAGTO) == CNUMPAG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000160','000159','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "1|3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase += fo_GetVal(@&cObjeto, cCpoValor)   .END.','000161','000160','.EXE.','5','nValBase','+=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000162','000159','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "2|4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto, cCpoValor)   .END.','000163','000162','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SKIP(@&cObjeto)     .END.','000164','000156','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCadPensao == .F. .END.','000165','000153','.CON.','5','','','5','lCadPensao','==','5','.F.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto} , { fGetCodFol("00','000166','000165','.CON.','5','','','5','FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto} , { fGetCodFol("0022") , cNumPag } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase := FO_GETVAL(@&cObjeto , cCpoValor )   .END.','000167','000166','.EXE.','5','nValBase',':=','5','FO_GETVAL(@&cObjeto , cCpoValor )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot $ "1|9" .END.','000168','000150','.CON.','5','','','5','cTipoRot','$','5','"1|9"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipo == "DFE" .END.','000169','000168','.CON.','5','','','5','cTipo','==','5','"DFE"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_GOTOP(@&cObjeto)     .CNT.','000170','000169','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!FO_EOF(@&cObjeto )   .END.','000171','000169','.ENQ.','5','','','5','!FO_EOF(@&cObjeto )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!FO_DELETED(@&cObjeto)   .END.','000172','000171','.CON.','5','','','5','!FO_DELETED(@&cObjeto)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_GetVal(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_P','000173','000172','.CON.','5','','','5','POSSRV(fo_GetVal(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_PENSAO" ) == "S"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_GETVAL(@&COBJETO,CCPONPAGTO) == CNUMPAG   .END.','000174','000172','.CON.','5','','','5','FO_GETVAL(@&COBJETO,CCPONPAGTO) == CNUMPAG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000175','000174','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "1|3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase += fo_GetVal(@&cObjeto, cCpoValor)   .END.','000176','000175','.EXE.','5','nValBase','+=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000177','000174','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "2|4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto, cCpoValor)   .END.','000178','000177','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SKIP(@&cObjeto)     .END.','000179','000171','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipo <> "DFE" .END.','000180','000168','.CON.','5','','','5','cTipo','<>','5','"DFE"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_GOTOP(@&cObjeto)     .CNT.','000181','000180','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!FO_EOF(@&cObjeto )   .END.','000182','000180','.ENQ.','5','','','5','!FO_EOF(@&cObjeto )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!FO_DELETED(@&cObjeto) .And. ( FO_GETVAL(@&cObjeto, cCpoPD','000183','000182','.CON.','5','','','5','!FO_DELETED(@&cObjeto) .And. ( FO_GETVAL(@&cObjeto, cCpoPD )  $ cVbBaseP  .OR. EMPTY(cVBBaseP) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cPaisLoc <> "URU" .END.','000184','000183','.CON.','5','','','5','cPaisLoc','<>','5','"URU"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_GetVal(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_P','000185','000184','.CON.','5','','','5','POSSRV(fo_GetVal(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_PENSAO" ) == "S"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_','000186','000184','.CON.','5','','','5','POSSRV(fo_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_REFFER" )  $ "N* "','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_','000187','000184','.CON.','5','','','5','POSSRV(fo_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_REF13" ) $ "N* "  .And. FO_GETVAL(@&COBJETO,CCPONPAGTO)==CNUMPAG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000188','000187','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "1|3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase += fo_GetVal(@&cObjeto, cCpoValor)   .END.','000189','000188','.EXE.','5','nValBase','+=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000190','000187','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "2|4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto, cCpoValor)   .END.','000191','000190','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SKIP(@&cObjeto)     .END.','000192','000182','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "4" .END.','000193','000150','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_GOTOP(@&CObjeto)     .CNT.','000194','000193','.EXE.','5','FO_GOTOP(@&CObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!FO_EOF(@&cObjeto)   .END.','000195','000193','.ENQ.','5','','','5','!FO_EOF(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!FO_DELETED(@&cObjeto) .And. (FO_GETVAL(@&cObjeto, cCpoPD','000196','000195','.CON.','5','','','5','!FO_DELETED(@&cObjeto) .And. (FO_GETVAL(@&cObjeto, cCpoPD )  $ cVbBaseP  .OR. EMPTY(cVBBaseP) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(FO_GETVAL(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_P','000197','000196','.CON.','5','','','5','POSSRV(FO_GETVAL(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_PENSAO" ) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoPens == "FER"   .END.','000198','000197','.CON.','5','','','5','cTipoPens == "FER"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','PosSrv(FO_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_','000199','000198','.CON.','5','','','5','PosSrv(FO_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_REFFER" )  == "S"  .AND.  PosSrv(FO_GETVAL(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_REF13" ) $ "N* " .And. FO_GetVal(@&COBJETO,CCPONPAGTO) == CNUMPAG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000200','000199','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "1|3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase += fo_GetVal(@&cObjeto, cCpoValor)   .END.','000201','000200','.EXE.','5','nValBase','+=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000202','000199','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "2|4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto, cCpoValor)   .END.','000203','000202','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoPens == "132"   .END.','000204','000197','.CON.','5','','','5','cTipoPens == "132"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','PosSrv(FO_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_','000205','000204','.CON.','5','','','5','PosSrv(FO_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_REFFER" )  $ "N* " .AND.  PosSrv(FO_GETVAL(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_REF13" ) == "S"    .And. FO_GETVAL(@&COBJETO,CCPONPAGTO)==CNUMPAG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000206','000205','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "1|3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase += fo_GetVal(@&cObjeto, cCpoValor)   .END.','000207','000206','.EXE.','5','nValBase','+=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000208','000205','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "2|4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto, cCpoValor)   .END.','000209','000208','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!(cTipoPens $  "FER|132")   .END.','000210','000197','.CON.','5','','','5','!(cTipoPens $  "FER|132")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','PosSrv(FO_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_','000211','000210','.CON.','5','','','5','PosSrv(FO_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_REFFER" )  $ "N* " .AND.  PosSrv(FO_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL, "RV_REF13" ) $ "N* "    .And. FO_GETVAL(@&COBJETO,CCPONPAGTO)==CNUMPAG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000212','000211','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "1|3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase += fo_GetVal(@&cObjeto, cCpoValor)   .END.','000213','000212','.EXE.','5','nValBase','+=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000214','000211','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "2|4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto, cCpoValor)   .END.','000215','000214','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SKIP(@&cObjeto)     .END.','000216','000195','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!( cTipoRot $ "1|2|4|5|9" )   .END.','000217','000150','.CON.','5','','','5','!( cTipoRot $ "1|2|4|5|9" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_GOTOP(@&cObjeto)     .CNT.','000218','000217','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','! FO_EOF(@&cObjeto )   .END.','000219','000217','.ENQ.','5','','','5','! FO_EOF(@&cObjeto )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','!FO_DELETED(@&cObjeto) .AND. (FO_GETVAL(@&cObjeto, cCpoPD','000220','000219','.CON.','5','','','5','!FO_DELETED(@&cObjeto) .AND. (FO_GETVAL(@&cObjeto, cCpoPD ) $  cVbBaseP  .OR.  EMPTY(cVbBaseP) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(FO_GETVAL(@&COBJETO, CCPOPD) , SRA->RA_FILIAL, "RV_','000221','000220','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO, CCPOPD) , SRA->RA_FILIAL, "RV_PENSAO" ) == "S"  .And. FO_GETVAL(@&COBJETO,CCPONPAGTO)==CNUMPAG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000222','000221','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "1|3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase += fo_GetVal(@&cObjeto, cCpoValor)   .END.','000223','000222','.EXE.','5','nValBase','+=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000224','000221','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "2|4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto, cCpoValor)   .END.','000225','000224','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SKIP(@&cObjeto)     .END.','000226','000219','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "3" .END.','000227','000217','.CON.','5','','','5','cTipoRot','==','5','"3"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto}, {fGetCodFol("0022','000228','000227','.CON.','5','','','5','FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto}, {fGetCodFol("0022") , cNumPag } )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','PosSrv(fo_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL , "RV','000229','000227','.CON.','5','','','5','PosSrv(fo_GetVal(@&cObjeto, cCpoPD) , SRA->RA_FILIAL , "RV_PENSAO" ) ==  "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto , cCpoValor)   .CNT.','000230','000229','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto , cCpoValor)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVlPens131 := NoRound((( Fo_GetVal(@&cObjeto, cCpoValor) * n','000231','000229','.EXE.','5','nVlPens131',':=','5','NoRound((( Fo_GetVal(@&cObjeto, cCpoValor) * nPercPensao) / 100 ) , 2 )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVlPens131 > 0   .END.','000232','000229','.CON.','5','','','5','nVlPens131 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoNPagto,','000233','000232','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoNPagto, cCpoTipo1, cCpoData} , { cVb131, nVlPens131, nPercPensao, cNumPag , "V", dDataPgto} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase := If(nValBase < 0 ,0, nValBase )     .CNT.','000234','000150','.EXE.','5','nValBase := If(nValBase < 0 ,0, nValBase )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nLiqTemp := NoRound(nValBase,2)     .END.','000235','000150','.EXE.','5','nLiqTemp := NoRound(nValBase,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValFixo == 0 .And. nNrSlMin == 0   .END.','000236','000089','.CON.','5','','','5','nValFixo == 0 .And. nNrSlMin == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValPensao := NoRound( ( ( ( nLiqTemp - nValIR )  * nPercPen','000237','000236','.EXE.','5','nValPensao := NoRound( ( ( ( nLiqTemp - nValIR )  * nPercPensao ) / 100 ) , 2 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nNrSlMin > 0   .END.','000238','000089','.CON.','5','','','5','nNrSlMin > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValPensao := NoRound((nValPensao * nPercPensao / 100),2)','000239','000238','.EXE.','5','nValPensao := NoRound((nValPensao * nPercPensao / 100),2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValPensao > 0   .END.','000240','000089','.CON.','5','','','5','nValPensao > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoNPagto,','000241','000240','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoNPagto, cCpoTipo1, cCpoData} , {cPensao, nValPensao, nPercPensao, cNumPag, "V", dDataPgto} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','(cTipoRot == "5" .And. cPaisLoc <> "URU" ) .Or.  (cTipoRot','000242','000089','.CON.','5','','','5','(cTipoRot == "5" .And. cPaisLoc <> "URU" ) .Or.  (cTipoRot == "2" .And. !lCadPensao) .Or. nValFixo > 0 .Or. nNrSlMin > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 := nCnt1 + 1 .CNT.','000243','000242','.EXE.','5','nCnt1',':=','5','nCnt1','+','5','1','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','RETORNEENQ()     .END.','000244','000242','.EXE.','5','RETORNEENQ()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lUsarIR == .F. .END.','000245','000089','.CON.','5','','','5','lUsarIR','==','5','.F.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 := nCnt1 + 1 .CNT.','000246','000245','.EXE.','5','nCnt1',':=','5','nCnt1','+','5','1','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','RETORNEENQ()     .END.','000247','000245','.EXE.','5','RETORNEENQ()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValPensao := 0     .CNT.','000248','000089','.EXE.','5','nValPensao := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lCalSlBru  := .F.     .CNT.','000249','000089','.EXE.','5','lCalSlBru  := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','1:=1     .CNT.','000250','000089','.EXE.','5','1:=1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','NCNT1 := NCNT1 + 1 .END.','000251','000089','.EXE.','5','NCNT1',':=','5','NCNT1','+','5','1','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cTipoRot == "6" .OR.','000252','000000','.CON.','5','','','5','cTipoRot','==','5','"6"','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','(cTipoRot == "4" .And. cTipo == "132")   .END.','000253','000000','.CON.','5','','','5','(cTipoRot == "4" .And. cTipo == "132")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 := 1   .CNT.','000254','000253','.EXE.','5','nCnt1',':=','5','1','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 <= Len(aCodBenef) .END.','000255','000253','.ENQ.','5','','','5','nCnt1','<=','5','Len(aCodBenef)','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cPensao := aCodBenef[nCnt1,1]   .CNT.','000256','000255','.EXE.','5','cPensao',':=','5','aCodBenef[nCnt1,1]','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','cVb131 := aCodBenef[nCnt1,7]   .CNT.','000257','000255','.EXE.','5','cVb131',':=','5','aCodBenef[nCnt1,7]','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','Len (aCodBenef[nCnt1]) > 16   .END.','000258','000255','.CON.','5','','','5','Len (aCodBenef[nCnt1]) > 16','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','dDtFimPg := aCodBenef[nCnt1,18]     .CNT.','000259','000258','.EXE.','5','dDtFimPg := aCodBenef[nCnt1,18]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','dDtIniPg := aCodBenef[nCnt1,17]     .CNT.','000260','000258','.EXE.','5','dDtIniPg := aCodBenef[nCnt1,17]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','lDtPen:=.T.     .END.','000261','000258','.EXE.','5','lDtPen:=.T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','(Empty(dDtFimPg) .OR. dDtFimPg > dDatade ) .AND. (!Empty(d','000262','000255','.CON.','5','','','5','(Empty(dDtFimPg) .OR. dDtFimPg > dDatade ) .AND. (!Empty(dDtIniPg) .AND. dDtIniPg < dDataate) .OR. !lDtPen','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto}, {cVb131, cNumPag}','000263','000262','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto}, {cVb131, cNumPag} )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nVlPriPar := fo_GetVal(@&cObjeto, cCpoValor)   .CNT.','000264','000263','.EXE.','5','nVlPriPar',':=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {cPensao, cNumPa','000265','000263','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {cPensao, cNumPag } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','fo_SetVal(@&cObjeto, cCpoValor, NoRound(Fo_GetVal(@&cObjeto,','000266','000265','.EXE.','5','fo_SetVal(@&cObjeto, cCpoValor, NoRound(Fo_GetVal(@&cObjeto, cCpoValor) - nVlPriPar, 2 )  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {cPensao , cNumP','000267','000262','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {cPensao , cNumPag} )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','fo_GetVal(@&cObjeto, cCpoValor) < 0 .END.','000268','000267','.CON.','5','','','5','fo_GetVal(@&cObjeto, cCpoValor)','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','fo_SetVal(@&cObjeto, cCpoValor, 0 )     .END.','000269','000268','.EXE.','5','fo_SetVal(@&cObjeto, cCpoValor, 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','fo_Seek(@&cObjeto, {cCpoPd, cCpoNPagto} , {cVb131, cNumPag','000270','000262','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPd, cCpoNPagto} , {cVb131, cNumPag} )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','fo_SetVal(@&cObjeto, cCpoValor, 0)     .END.','000271','000270','.EXE.','5','fo_SetVal(@&cObjeto, cCpoValor, 0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nCnt1 := nCnt1 + 1   .END.','000272','000255','.EXE.','5','nCnt1',':=','5','nCnt1 + 1','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_T','000273','000272','.CON.','5','','','5','POSSRV(fo_Getval(@&cObjeto, cCpoPD), SRA->RA_FILIAL, "RV_TIPOCOD" ) $ "2|4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','nValBase -= fo_GetVal(@&cObjeto, cCpoValor)   .END.','000274','000273','.EXE.','5','nValBase','-=','5','fo_GetVal(@&cObjeto, cCpoValor)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','NVLPRIPAR > 0   .END.','000275','000253','.CON.','5','','','5','NVLPRIPAR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALCPEN','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0173")','000276','000275','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0173"), NVLPRIPAR} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0043    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0043( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FDESMEDF','DESMEMBRA MEDIA DE FERIAS','','','032','2','1',} )

aAdd(aRc3Cols, { '','S_','FDESMEDF','dFerVen := IF ( cTipoRot="3" , GETMEMVAR("RH_DFERVEN" ) , SR','000001','000000','.EXE.','5','dFerVen := IF ( cTipoRot="3" , GETMEMVAR("RH_DFERVEN" ) , SRH->RH_DFERVEN )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','dFerAux := IF ( cTipoRot="3" , GETMEMVAR("RH_DFERIAS" ) , SR','000002','000000','.EXE.','5','dFerAux := IF ( cTipoRot="3" , GETMEMVAR("RH_DFERIAS" ) , SRH->RH_DFERIAS )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','TRP->(DbGoTop())     .CNT.','000003','000000','.EXE.','5','TRP->(DbGoTop())','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','TRP->(!EOF())   .END.','000004','000000','.ENQ.','5','','','5','TRP->(!EOF())','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','cDatarq := "TRP->RP_DATARQ"     .CNT.','000005','000004','.EXE.','5','cDatarq := "TRP->RP_DATARQ"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','cPd := "TRP->RP_PD"     .CNT.','000006','000004','.EXE.','5','cPd := "TRP->RP_PD"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','cVerba := &cPd     .CNT.','000007','000004','.EXE.','5','cVerba := &cPd','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','cTipo := "TRP->RP_TIPO"     .CNT.','000008','000004','.EXE.','5','cTipo := "TRP->RP_TIPO"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','( &cDatarq = "99MD" ) .AND. ( cVerba # "999" ) .AND. ( ( &','000009','000004','.CON.','5','','','5','( &cDatarq = "99MD" ) .AND. ( cVerba # "999" ) .AND. ( ( &cTipo = "1" ) .OR. ( &cTipo = "2" .AND. DFERVEN<ATABFER[3] ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','cValAtu := "TRP->RP_VALATU"     .CNT.','000010','000009','.EXE.','5','cValAtu := "TRP->RP_VALATU"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','cHoras := "TRP->RP_HORAS"     .CNT.','000011','000009','.EXE.','5','cHoras := "TRP->RP_HORAS"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','nValor := &cValAtu     .CNT.','000012','000009','.EXE.','5','nValor := &cValAtu','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','nHoras := &cHoras     .CNT.','000013','000009','.EXE.','5','nHoras := &cHoras','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','nValor > 0   .END.','000014','000009','.CON.','5','','','5','nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALOR := ROUND( (NVALOR / 30) * DFERAUX , 2 )     .CNT.','000015','000014','.EXE.','5','NVALOR := ROUND( (NVALOR / 30) * DFERAUX , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','( LFER := CTIPOROT="3" ) .AND. ( !FO_SEEK(@&cObjeto, {cCpo','000016','000014','.CON.','5','','','5','( LFER := CTIPOROT="3" ) .AND. ( !FO_SEEK(@&cObjeto, {cCpoPD, cCpoTipo2},{cVerba, "I"}) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras} , {cVerba,','000017','000016','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras} , {cVerba, nValor, nHoras } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','( !LFER ) .AND. ( !EMPTY(CVRBFER := POSSRV(cVerba,SRA->RA_','000018','000014','.CON.','5','','','5','( !LFER ) .AND. ( !EMPTY(CVRBFER := POSSRV(cVerba,SRA->RA_FILIAL,"RV_CODFER")) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','( !EMPTY(CVRBDIF := POSSRV(cVerba,SRA->RA_FILIAL,"RV_CODDI','000019','000014','.CON.','5','','','5','( !EMPTY(CVRBDIF := POSSRV(cVerba,SRA->RA_FILIAL,"RV_CODDIFE")) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALDIF := ROUND( (NVALOR/DFERAUX)*NDIASMES , 2 )     .CNT.','000020','000019','.EXE.','5','NVALDIF := ROUND( (NVALOR/DFERAUX)*NDIASMES , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_SEEK(@&cObjeto, {CCPOPD},{CVRBFER})   .END.','000021','000019','.CON.','5','','','5','FO_SEEK(@&cObjeto, {CCPOPD},{CVRBFER})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)     .END','000022','000021','.EXE.','5','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALDIF > 0   .END.','000023','000019','.CON.','5','','','5','NVALDIF > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','LIF := ( FO_SEEK(@&COBJETO, {CCPOPD}, {CVRBDIF}) )   .END.','000024','000023','.CON.','5','','','5','LIF := ( FO_SEEK(@&COBJETO, {CCPOPD}, {CVRBDIF}) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_SETVAL(@&COBJETO, CCPOVALOR, FO_GETVAL(@&COBJETO,CCPOVALO','000025','000024','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, FO_GETVAL(@&COBJETO,CCPOVALOR) + NVALDIF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','!LIF   .END.','000026','000023','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras} , {CVRBDIF,','000027','000026','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras} , {CVRBDIF, NVALDIF, NDIASMES } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALADIF += NVALDIF     .END.','000028','000023','.EXE.','5','NVALADIF += NVALDIF','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','!EMPTY(NDIASMSE)   .END.','000029','000019','.CON.','5','','','5','!EMPTY(NDIASMSE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALDIF := ROUND( (NVALOR/DFERAUX)*NDIASMSE , 2 )     .CNT.','000030','000029','.EXE.','5','NVALDIF := ROUND( (NVALOR/DFERAUX)*NDIASMSE , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','LMES := ( NDIASMES > 0 )   .END.','000031','000029','.CON.','5','','','5','LMES := ( NDIASMES > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NINDICE := MAX(RETORDER("SRV","RV_FILIAL+RV_CODMSEG"),1)','000032','000031','.EXE.','5','NINDICE := MAX(RETORDER("SRV","RV_FILIAL+RV_CODMSEG"),1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','( FPOSREG("SRV", NINDICE, XFILIAL("SRV")+CVRBFER) )   .END','000033','000031','.CON.','5','','','5','( FPOSREG("SRV", NINDICE, XFILIAL("SRV")+CVRBFER) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_SEEK(@&cObjeto, {CCPOPD},{SRV->RV_COD})   .END.','000034','000033','.CON.','5','','','5','FO_SEEK(@&cObjeto, {CCPOPD},{SRV->RV_COD})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)     .END','000035','000034','.EXE.','5','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','( NVALDIF > 0 ) .AND. ( FPOSREG("SRV", NINDICE, XFILIAL("S','000036','000033','.CON.','5','','','5','( NVALDIF > 0 ) .AND. ( FPOSREG("SRV", NINDICE, XFILIAL("SRV")+CVRBDIF) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','LIF := ( FO_SEEK(@&COBJETO, {CCPOPD}, {SRV->RV_COD}) )   .','000037','000036','.CON.','5','','','5','LIF := ( FO_SEEK(@&COBJETO, {CCPOPD}, {SRV->RV_COD}) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_SETVAL(@&COBJETO, CCPOVALOR, FO_GETVAL(@&COBJETO,CCPOVALO','000038','000037','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, FO_GETVAL(@&COBJETO,CCPOVALOR) + NVALDIF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','!LIF   .END.','000039','000036','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras} , {SRV->RV_','000040','000039','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras} , {SRV->RV_COD, NVALDIF, NDIASMSE } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALADIF += NVALDIF     .END.','000041','000036','.EXE.','5','NVALADIF += NVALDIF','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','!LMES   .END.','000042','000029','.CON.','5','','','5','!LMES','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_SEEK(@&cObjeto, {CCPOPD},{CVRBFER})   .END.','000043','000042','.CON.','5','','','5','FO_SEEK(@&cObjeto, {CCPOPD},{CVRBFER})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)     .END','000044','000043','.EXE.','5','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALDIF > 0   .END.','000045','000042','.CON.','5','','','5','NVALDIF > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','LIF := ( FO_SEEK(@&COBJETO, {CCPOPD}, {CVRBDIF}) )   .END.','000046','000045','.CON.','5','','','5','LIF := ( FO_SEEK(@&COBJETO, {CCPOPD}, {CVRBDIF}) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_SETVAL(@&COBJETO, CCPOVALOR, FO_GETVAL(@&COBJETO,CCPOVALO','000047','000046','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, FO_GETVAL(@&COBJETO,CCPOVALOR) + NVALDIF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','!LIF   .END.','000048','000045','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras} , {CVRBDIF,','000049','000048','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras} , {CVRBDIF, NVALDIF, NDIASMSE } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','NVALADIF += NVALDIF     .END.','000050','000045','.EXE.','5','NVALADIF += NVALDIF','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDESMEDF','TRP->(DbSkip())     .END.','000051','000004','.EXE.','5','TRP->(DbSkip())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0044    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0044( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FERNGOZ','CALCULA FERIAS NAO GOZADAS','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','FERNGOZ','CVRBFER := FGETCODFOL("0072")     .CNT.','000001','000000','.EXE.','5','CVRBFER := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','aDiasRet   := {}     .CNT.','000002','000000','.EXE.','5','aDiasRet   := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nDiasDir := 0     .CNT.','000003','000000','.EXE.','5','nDiasDir := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','lTemSRFExerc := .F.     .CNT.','000004','000000','.EXE.','5','lTemSRFExerc := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nQtdFerNGo := 0     .CNT.','000005','000000','.EXE.','5','nQtdFerNGo := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nVlFerNGoz := 0     .CNT.','000006','000000','.EXE.','5','nVlFerNGoz := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','FO_GOTOP(@OSRF)     .CNT.','000007','000000','.EXE.','5','FO_GOTOP(@OSRF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','!FO_EOF(@OSRF)   .END.','000008','000000','.ENQ.','5','','','5','!FO_EOF(@OSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','( FO_GETVAL(@OSRF,"RF_PD") == CVRBFER ) .AND. ( FO_GETVAL(','000009','000008','.CON.','5','','','5','( FO_GETVAL(@OSRF,"RF_PD") == CVRBFER ) .AND. ( FO_GETVAL(@OSRF,"RF_DATABAS") <= DDATADEM )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"   .END.','000010','000009','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','Year (dDataDem) == Year (FO_GETVAL(@OSRF,"RF_DATABAS"))','000011','000010','.CON.','5','','','5','Year (dDataDem) == Year (FO_GETVAL(@OSRF,"RF_DATABAS"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','lTemSRFExerc := .T.     .CNT.','000012','000011','.EXE.','5','lTemSRFExerc := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','DiasFerPtg(@aDiasRet,FO_GETVAL(@OSRF,"RF_DATABAS"),DDATADEM)','000013','000011','.EXE.','5','DiasFerPtg(@aDiasRet,FO_GETVAL(@OSRF,"RF_DATABAS"),DDATADEM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nDiasDir := aDiasRet[1][4]     .CNT.','000014','000011','.EXE.','5','nDiasDir := aDiasRet[1][4]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nQtdFerNGo += (nDiasDir  - FO_GETVAL(@OSRF,"RF_DFERANT") )','000015','000011','.EXE.','5','nQtdFerNGo += (nDiasDir  - FO_GETVAL(@OSRF,"RF_DFERANT") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','! Year (dDataDem) == Year (FO_GETVAL(@OSRF,"RF_DATABAS"))','000016','000010','.CON.','5','','','5','! Year (dDataDem) == Year (FO_GETVAL(@OSRF,"RF_DATABAS"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nQtdFerNGo += (FO_GETVAL(@OSRF,"RF_DIASDIR")  - FO_GETVAL(@O','000017','000016','.EXE.','5','nQtdFerNGo += (FO_GETVAL(@OSRF,"RF_DIASDIR")  - FO_GETVAL(@OSRF,"RF_DFERANT"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','FO_SKIP(@OSRF)     .END.','000018','000008','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','lTemSRFExerc == .F. .END.','000019','000000','.CON.','5','','','5','lTemSRFExerc','==','5','.F.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','Calc_Fer(@aDiasRet , dDataDem , , @nDiasDir,,,,.f.)     .CNT','000020','000019','.EXE.','5','Calc_Fer(@aDiasRet , dDataDem , , @nDiasDir,,,,.f.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','Neste caso a variavel nDiasDir ira armazenar a quantidade de','000021','000019','.MSG.','5','Neste caso a variavel nDiasDir ira armazenar a quantidade de dias de ferias proporcionais.','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nQtdFerNGo += nDiasDir     .END.','000022','000019','.EXE.','5','nQtdFerNGo += nDiasDir','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nQtdFerNGo > 0   .END.','000023','000000','.CON.','5','','','5','nQtdFerNGo > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FERNGOZ','nVlFerNGoz := SalDia * nQtdFerNGo / 22     .END.','000024','000023','.EXE.','5','nVlFerNGoz := SalDia * nQtdFerNGo / 22','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0045    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0045( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FERPROPO','SUBSIDIO DE FERIAS PROPORCIONAIS','','','017','2','1',} )

aAdd(aRc3Cols, { '','S_','FERPROPO','FTABELA("S021",VAL(CTIPRES),8) == "S"   .END.','000001','000000','.CON.','5','','','5','FTABELA("S021",VAL(CTIPRES),8) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FERPROPO','CVERBA := FGETCODFOL("0087")     .CNT.','000002','000001','.EXE.','5','CVERBA := FGETCODFOL("0087")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERPROPO','!EMPTY(CVERBA) .AND. NMESESCON > 0   .END.','000003','000001','.CON.','5','','','5','!EMPTY(CVERBA) .AND. NMESESCON > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FERPROPO','NFERPRO :=  ( SALMES / 12 * NMESESCON * 2 )     .CNT.','000004','000003','.EXE.','5','NFERPRO :=  ( SALMES / 12 * NMESESCON * 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FERPROPO','FO_ADD(@&COBJETO,{CCPOPD,CCPOHORAS,CCPOVALOR},{CVERBA,NMESES','000005','000003','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOHORAS,CCPOVALOR},{CVERBA,NMESESCON,NFERPRO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0046    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0046( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FLIQFERI','LIQUIDOS DE FERIAS','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','FLIQFERI','nVAL_ARRE := VLR_INS := 0.00     .CNT.','000001','000000','.EXE.','5','nVAL_ARRE := VLR_INS := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NARRED := P_ARREDFE     .CNT.','000002','000000','.EXE.','5','NARRED := P_ARREDFE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq := nValProv - nValDesc     .CNT.','000003','000000','.EXE.','5','nValLiq := nValProv - nValDesc','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','DDTRECIB := If(Empty(dDtRecibo), GetMemVar("RH_RECIB"), dDtR','000004','000000','.EXE.','5','DDTRECIB := If(Empty(dDtRecibo), GetMemVar("RH_RECIB"), dDtRecibo )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NARRED > 0   .END.','000005','000000','.CON.','5','','','5','NARRED > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','NVLRTOT := nValLiq     .CNT.','000006','000005','.EXE.','5','NVLRTOT := nValLiq','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nSALV_ARR := NARRED     .CNT.','000007','000005','.EXE.','5','nSALV_ARR := NARRED','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','S_FCALARRE()     .CNT.','000008','000005','.EXE.','5','S_FCALARRE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValArrFe := nSalv_Arr     .CNT.','000009','000005','.EXE.','5','nValArrFe := nSalv_Arr','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nVLRARRE > 0   .END.','000010','000005','.CON.','5','','','5','nVLRARRE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoData},{FGETCODFOL("01','000011','000010','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoData},{FGETCODFOL("0104"),nVLRARRE, dDtRecibo}, cCpoPD, fGetCodFol("0104"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq += nVLRARRE     .END.','000012','000005','.EXE.','5','nValLiq += nVLRARRE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','nValLiq > 0   .END.','000013','000000','.CON.','5','','','5','nValLiq > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQFERI','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor, cCpoData},{FGETCODFOL("0','000014','000013','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor, cCpoData},{FGETCODFOL("0102"),nValLiq, dDtRecibo}, cCpoPD, fGetCodfol("0102") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0047    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0047( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FLIQUIDO','GERA VALOR LIQUIDO','','','033','2','1',} )

aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot $ "1|9" .END.','000001','000000','.CON.','5','','','5','cTipoRot','$','5','"1|9"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0047")   .CNT.','000002','000001','.EXE.','5','cCodliq',':=','5','fGetCodFol("0047")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := P_ARREDFO   .CNT.','000003','000001','.EXE.','5','nArred',':=','5','P_ARREDFO','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := fGetCodFol("0043")   .CNT.','000004','000001','.EXE.','5','cCodArred',':=','5','fGetCodFol("0043")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .T.   .CNT.','000005','000001','.EXE.','5','lIns',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := If(cPaisLoc <> "URU", fGetCodFol("0045"), Space(3','000006','000001','.EXE.','5','cCodIns',':=','5','If(cPaisLoc <> "URU", fGetCodFol("0045"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := If(cPaisLoc <> "PAR", .T. , .F. )   .CNT.','000007','000001','.EXE.','5','lObrigat',':=','5','If(cPaisLoc <> "PAR", .T. , .F. )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000008','000001','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "6" .END.','000009','000000','.CON.','5','','','5','cTipoRot','==','5','"6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0021")   .CNT.','000010','000009','.EXE.','5','cCodliq',':=','5','fGetCodFol("0021")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := If(cPaisLoc  $ "ARG|CHI|DOM" , 0, P_ARRED13)   .CN','000011','000009','.EXE.','5','nArred',':=','5','If(cPaisLoc  $ "ARG|CHI|DOM" , 0, P_ARRED13)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := If(cPaisLoc $ "BRA|ARG", fGetCodFol("0026") , S','000012','000009','.EXE.','5','cCodArred',':=','5','If(cPaisLoc $ "BRA|ARG", fGetCodFol("0026") , Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := If(cPaisLoc == "BRA", .T. , .F. )   .CNT.','000013','000009','.EXE.','5','lIns',':=','5','If(cPaisLoc == "BRA", .T. , .F. )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := fGetCodFol("0030")   .CNT.','000014','000009','.EXE.','5','cCodIns',':=','5','fGetCodFol("0030")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .F.   .CNT.','000015','000009','.EXE.','5','lObrigat',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000016','000009','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "5" .END.','000017','000000','.CON.','5','','','5','cTipoRot','==','5','"5"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodLiq := If(cPaisLoc $ "ARG|URU|DOM" , fGetCodFol("0021"),','000018','000017','.EXE.','5','cCodLiq',':=','5','If(cPaisLoc $ "ARG|URU|DOM" , fGetCodFol("0021"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := If(cPaisLoc $ "ARG|DOM", 0, If(lArredonda,P_ARRED1','000019','000017','.EXE.','5','nArred',':=','5','If(cPaisLoc $ "ARG|DOM", 0, If(lArredonda,P_ARRED13,0) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := If(cPaisLoc == "URU", fGetCodFol("0026"), Space','000020','000017','.EXE.','5','cCodArred',':=','5','If(cPaisLoc == "URU", fGetCodFol("0026"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .F.   .CNT.','000021','000017','.EXE.','5','lIns',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lCodIns := Space(4)   .CNT.','000022','000017','.EXE.','5','lCodIns',':=','5','Space(4)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .CNT.','000023','000017','.EXE.','5','lDemiss',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .F.   .END.','000024','000017','.EXE.','5','lObrigat',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "4" .END.','000025','000000','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0126")   .CNT.','000026','000025','.EXE.','5','cCodliq',':=','5','fGetCodFol("0126")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := 0   .CNT.','000027','000025','.EXE.','5','nArred',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := Space(3)   .CNT.','000028','000025','.EXE.','5','cCodArred',':=','5','Space(3)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .T.   .CNT.','000029','000025','.EXE.','5','lIns',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := fGetCodFol("0045")   .CNT.','000030','000025','.EXE.','5','cCodIns',':=','5','fGetCodFol("0045")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .T.   .CNT.','000031','000025','.EXE.','5','lObrigat',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000032','000025','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat := 0   .CNT.','000033','000000','.EXE.','5','nObrigat',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cProxNum := "  "   .CNT.','000034','000000','.EXE.','5','cProxNum',':=','5','"  "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000035','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := 0   .CNT.','000036','000000','.EXE.','5','nLiquido',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000037','000000','.EXE.','5','nLiquido',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "1" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido += FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000038','000000','.EXE.','5','nLiquido','+=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "2" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat == .T. .END.','000039','000000','.CON.','5','','','5','lObrigat','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_GOTOP(@&cObjeto)     .CNT.','000040','000039','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_EOF(@&cObjeto)   .END.','000041','000039','.ENQ.','5','','','5','!FO_EOF(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_GETVAL(@&cObjeto, cCpoNPagto) == cNumPag .AND.','000042','000041','.CON.','5','','','5','FO_GETVAL(@&cObjeto, cCpoNPagto)','==','5','cNumPag','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_DELETED(@&cObjeto)   .AND.','000043','000041','.CON.','5','','','5','!FO_DELETED(@&cObjeto)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','POSSRV(FO_GETVAL(@&cObjeto, cCpoPd) , SRA->RA_FILIAL, "RV_','000044','000041','.CON.','5','','','5','POSSRV(FO_GETVAL(@&cObjeto, cCpoPd) , SRA->RA_FILIAL, "RV_OBRIGAT" )','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat += FO_GETVAL(@&cObjeto, cCpoValor )   .END.','000045','000044','.EXE.','5','nObrigat','+=','5','FO_GETVAL(@&cObjeto, cCpoValor )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_SKIP(@&cObjeto)     .END.','000046','000041','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Type("P_CALCINF") != "U" .and. P_CALCINF == "S"   .END.','000047','000000','.CON.','5','','','5','Type("P_CALCINF") != "U" .and. P_CALCINF == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat := 0   .END.','000048','000047','.EXE.','5','nObrigat',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVAL_ARRE := NVLR_INS := 0.00     .CNT.','000049','000000','.EXE.','5','nVAL_ARRE := NVLR_INS := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( nLiquido < 0  .Or.  ( lObrigat .and. nliquido < nObrigat','000050','000000','.CON.','5','','','5','( nLiquido < 0  .Or.  ( lObrigat .and. nliquido < nObrigat) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns == .T. .END.','000051','000000','.CON.','5','','','5','lIns','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := 0   .CNT.','000052','000051','.EXE.','5','nVlr_ins',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!( cSitFolh $ "D*E" )   .OR.','000053','000051','.CON.','5','','','5','!( cSitFolh $ "D*E" )','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( cSitFolh == "D" .and. lDemiss== .T. )   .END.','000054','000051','.CON.','5','','','5','( cSitFolh == "D" .and. lDemiss== .T. )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) < 0 .OR.','000055','000054','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','<','5','0','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( lObrigat == .T.  .And. Round(nLiquido, MsDecimais(1) ) <','000056','000054','.CON.','5','','','5','( lObrigat == .T.  .And. Round(nLiquido, MsDecimais(1) ) < nObrigat )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) < 0 .END.','000057','000056','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := (nLiquido * -1) + nObrigat   .CNT.','000058','000057','.EXE.','5','nVlr_ins',':=','5','(nLiquido * -1) + nObrigat','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := nObrigat   .END.','000059','000057','.EXE.','5','nLiquido',':=','5','nObrigat','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) > 0 .AND.','000060','000056','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat == .T. .END.','000061','000056','.CON.','5','','','5','lObrigat','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := nObrigat - nLiquido   .CNT.','000062','000061','.EXE.','5','nVlr_ins',':=','5','nObrigat - nLiquido','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := nObrigat   .END.','000063','000061','.EXE.','5','nLiquido',':=','5','nObrigat','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','! ( !( cSitFolh $ "D*E" ) .or. ( cSitFolh == "D" .and. lDe','000064','000051','.CON.','5','','','5','! ( !( cSitFolh $ "D*E" ) .or. ( cSitFolh == "D" .and. lDemiss )  )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round( nLiquido , MsDecimais(1) ) < 0 .END.','000065','000051','.CON.','5','','','5','Round( nLiquido , MsDecimais(1) )','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := ( nLiquido * -1 )   .END.','000066','000065','.EXE.','5','nVlr_ins',':=','5','( nLiquido * -1 )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred > 0 .AND.','000067','000000','.CON.','5','','','5','nArred','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido > 0 .END.','000068','000000','.CON.','5','','','5','nLiquido','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := Round( nLiquido, MsDecimais(1) )   .CNT.','000069','000068','.EXE.','5','nLiquido',':=','5','Round( nLiquido, MsDecimais(1) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CCODARRED <> SPACE(4) .AND.','000070','000068','.CON.','5','','','2','CCODARRED','<>','5','SPACE(4)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_SEEK(@&cObjeto, {cCpoPd, cCpoNPagto } , { cCodArred, c','000071','000068','.CON.','5','','','5','!FO_SEEK(@&cObjeto, {cCpoPd, cCpoNPagto } , { cCodArred, cNumPag }  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nSALV_ARR := nArred   .CNT.','000072','000071','.EXE.','5','nSALV_ARR',':=','5','nArred','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlrTot := nLiquido   .CNT.','000073','000071','.EXE.','5','nVlrTot',':=','5','nLiquido','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','S_FCALARRE()     .CNT.','000074','000071','.EXE.','4','S_FCALARRE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := nSALV_ARR   .CNT.','000075','000071','.EXE.','5','nArred',':=','5','nSALV_ARR','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLIQUIDO := nVlrTot   .CNT.','000076','000071','.EXE.','5','nLIQUIDO',':=','5','nVlrTot','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVal_Arre := nVlrArre   .END.','000077','000071','.EXE.','5','nVal_Arre',':=','5','nVlrArre','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0048    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0048( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FMEDFER','BUSCA MEDIA DE FERIAS','','','024','2','1',} )

aAdd(aRc3Cols, { '','S_','FMEDFER','lDesmembra := ( P_DESMED = "S" )   .END.','000001','000000','.CON.','5','','','5','lDesmembra := ( P_DESMED = "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','S_FDESMEDF()     .END.','000002','000001','.EXE.','5','S_FDESMEDF()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','!lDesmembra   .END.','000003','000000','.CON.','5','','','5','!lDesmembra','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','dFerVen := IF ( cTipoRot="3" , GETMEMVAR("RH_DFERVEN" ) , SR','000004','000003','.EXE.','5','dFerVen := IF ( cTipoRot="3" , GETMEMVAR("RH_DFERVEN" ) , SRH->RH_DFERVEN )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"1"+"999"+"97MD','000005','000003','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"1"+"999"+"97MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','cMedTemp := "TRP->RP_VALATU"   .CNT.','000006','000005','.EXE.','5','cMedTemp',':=','5','"TRP->RP_VALATU"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','nMediaOut := &cMedTemp   .END.','000007','000005','.EXE.','5','nMediaOut',':=','5','&cMedTemp','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"2"+"999"+"97MD','000008','000003','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"2"+"999"+"97MD")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','dFerVen < aTabFer[3]   .END.','000009','000003','.CON.','5','','','5','dFerVen < aTabFer[3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','cMedTemp := "TRP->RP_VALATU"   .CNT.','000010','000009','.EXE.','5','cMedTemp',':=','5','"TRP->RP_VALATU"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','nMediaOut := &cMedTemp   .END.','000011','000009','.EXE.','5','nMediaOut',':=','5','&cMedTemp','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FPOSREG("TRP", 1, SRA->RA_FILIAL+ SRA->RA_MAT+ "1"+"999"+','000012','000003','.CON.','5','','','5','FPOSREG("TRP", 1, SRA->RA_FILIAL+ SRA->RA_MAT+ "1"+"999"+ "98MD" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','cMedTemp := "TRP->RP_VALATU"   .CNT.','000013','000012','.EXE.','5','cMedTemp',':=','5','"TRP->RP_VALATU"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','nMediaHrs := &cMedTemp   .END.','000014','000012','.EXE.','5','nMediaHrs',':=','5','&cMedTemp','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FPOSREG("TRP", 1, SRA->RA_FILIAL+SRA->RA_MAT+"1"+"999"+"98','000015','000003','.CON.','5','','','5','FPOSREG("TRP", 1, SRA->RA_FILIAL+SRA->RA_MAT+"1"+"999"+"98MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','cMedTemp := "TRP->RP_VALATU"   .CNT.','000016','000015','.EXE.','5','cMedTemp',':=','5','"TRP->RP_VALATU"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','nMediaHrs := &cMedTemp   .END.','000017','000015','.EXE.','5','nMediaHrs',':=','5','&cMedTemp','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','P_MED1OP == "S" .END.','000018','000003','.CON.','5','','','5','P_MED1OP','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FPOSREG("TRP", 1, SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"99','000019','000018','.CON.','5','','','5','FPOSREG("TRP", 1, SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"99MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','cMedTemp := "TRP->RP_VALATU"   .CNT.','000020','000019','.EXE.','5','cMedTemp',':=','5','"TRP->RP_VALATU"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','nMedia13S := &cMedTemp   .END.','000021','000019','.EXE.','5','nMedia13S',':=','5','&cMedTemp','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','nMedPer := nMedIns := 0.00     .CNT.','000022','000003','.EXE.','5','nMedPer := nMedIns := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FMedPerIns(@nMedPer,@nMedIns,'+"'"+'1'+"'"+',SalHora,Val_SalMin,aCodFol)','000023','000003','.EXE.','5','FMedPerIns(@nMedPer,@nMedIns,'+"'"+'1'+"'"+',SalHora,Val_SalMin,aCodFol)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','nMediaHrs += (nMedPer+nMedIns)   .CNT.','000024','000003','.EXE.','5','nMediaHrs','+=','5','(nMedPer+nMedIns)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FPOSREG("TRP", 1, SRA->RA_FILIAL+SRA->RA_MAT+"3"+"997"+"95','000025','000003','.CON.','5','','','5','FPOSREG("TRP", 1, SRA->RA_FILIAL+SRA->RA_MAT+"3"+"997"+"9598")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','cMedTemp := "TRP->RP_VALATU"   .CNT.','000026','000025','.EXE.','5','cMedTemp',':=','5','"TRP->RP_VALATU"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','nAntec13o := &cMedTemp   .END.','000027','000025','.EXE.','5','nAntec13o',':=','5','&cMedTemp','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','LFER := ( CTIPOROT = "3" )   .END.','000028','000003','.CON.','5','','','5','LFER := ( CTIPOROT = "3" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','S_CODPGFER()     .CNT.','000029','000028','.EXE.','5','S_CODPGFER()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','S_GRMEDHOR()     .CNT.','000030','000028','.EXE.','5','S_GRMEDHOR()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','S_GRMEDVAL()     .END.','000031','000028','.EXE.','5','S_GRMEDVAL()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','( !LFER ) .AND. ( !EMPTY(CVRBDIF := POSSRV(FGETCODFOL("007','000032','000003','.CON.','5','','','5','( !LFER ) .AND. ( !EMPTY(CVRBDIF := POSSRV(FGETCODFOL("0075"),SRA->RA_FILIAL,"RV_CODDIFE")) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FO_SEEK(@&COBJETO, {CCPOPD},{FGETCODFOL("0075")})   .END.','000033','000032','.CON.','5','','','5','FO_SEEK(@&COBJETO, {CCPOPD},{FGETCODFOL("0075")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','NVALAUX := ROUND( (NMEDIAOUT / 30) * SRH->RH_DFERIAS , 2 )','000034','000033','.EXE.','5','NVALAUX := ROUND( (NMEDIAOUT / 30) * SRH->RH_DFERIAS , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','NVALDIF := ROUND( (NVALAUX / SRH->RH_DFERIAS) * NDIASMES , 2','000035','000033','.EXE.','5','NVALDIF := ROUND( (NVALAUX / SRH->RH_DFERIAS) * NDIASMES , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT','000036','000033','.EXE.','5','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','( NVALDIF > 0 )   .END.','000037','000033','.CON.','5','','','5','( NVALDIF > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , {CVRBDIF,','000038','000037','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , {CVRBDIF, NVALDIF, NDIASMES } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','NVALADIF += NVALDIF     .END.','000039','000037','.EXE.','5','NVALADIF += NVALDIF','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','!EMPTY(NDIASMSE)   .END.','000040','000033','.CON.','5','','','5','!EMPTY(NDIASMSE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','NVALDIF := ROUND( (NVALAUX / SRH->RH_DFERIAS) * NDIASMSE , 2','000041','000040','.EXE.','5','NVALDIF := ROUND( (NVALAUX / SRH->RH_DFERIAS) * NDIASMSE , 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','NINDICE := MAX(RETORDER("SRV","RV_FILIAL+RV_CODMSEG"),1)','000042','000040','.EXE.','5','NINDICE := MAX(RETORDER("SRV","RV_FILIAL+RV_CODMSEG"),1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FPOSREG("SRV", NINDICE, XFILIAL("SRV")+FGETCODFOL("0075"))','000043','000040','.CON.','5','','','5','FPOSREG("SRV", NINDICE, XFILIAL("SRV")+FGETCODFOL("0075"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FO_SEEK(@&COBJETO, {CCPOPD},{SRV->RV_COD})   .END.','000044','000043','.CON.','5','','','5','FO_SEEK(@&COBJETO, {CCPOPD},{SRV->RV_COD})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT','000045','000044','.EXE.','5','NVALDIF := NVALDIF - FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','( NVALDIF > 0 ) .AND. ( FPOSREG("SRV", NINDICE, XFILIAL("S','000046','000044','.CON.','5','','','5','( NVALDIF > 0 ) .AND. ( FPOSREG("SRV", NINDICE, XFILIAL("SRV")+CVRBDIF) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , {SRV->RV_','000047','000046','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , {SRV->RV_COD, NVALDIF, NDIASMSE } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FMEDFER','NVALADIF += NVALDIF     .END.','000048','000046','.EXE.','5','NVALADIF += NVALDIF','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0049    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0049( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GARANTCO','CALCULO GARANTIA DE COMISSAO','','','017','2','1',} )

aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := 0   .CNT.','000001','000000','.EXE.','5','nTotComis',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nVlGComis := 0   .CNT.','000002','000000','.EXE.','5','nVlGComis',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := 0   .CNT.','000003','000000','.EXE.','5','NVLCOMISSA',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','SRA->RA_CATFUNC == "C" .AND.','000004','000000','.CON.','2','','','5','SRA->RA_CATFUNC','==','5','"C"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','FPOSREG("RCE",1,XFILIAL("RCE")+SRA->RA_SINDICA) == .T. .AN','000005','000000','.CON.','5','','','5','FPOSREG("RCE",1,XFILIAL("RCE")+SRA->RA_SINDICA)','==','5','.T.','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','RCE->RCE_GCOMIS > 0 .END.','000006','000000','.CON.','5','','','5','RCE->RCE_GCOMIS','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "3" .END.','000007','000006','.CON.','5','','','5','cTipoRot','==','5','"3"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fG','000008','000007','.EXE.','5','nTotComis',':=','5','fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fGetCodfol("0072") )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis += fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fG','000009','000007','.EXE.','5','nTotComis','+=','5','fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fGetCodfol("0082") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis += fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoValor,','000010','000007','.EXE.','5','nTotComis','+=','5','fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoValor, fGetCodfol("0075") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis += fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fG','000011','000007','.EXE.','5','nTotComis','+=','5','fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fGetCodfol("0343") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nVlGComis := ROUND( RCE->RCE_GCOMIS / GETMEMVAR("RH_DFERVEN"','000012','000007','.EXE.','5','nVlGComis',':=','3','ROUND( RCE->RCE_GCOMIS / GETMEMVAR("RH_DFERVEN") * GETMEMVAR("RH_DFERIAS"),2)','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < nVlGComis .END.','000013','000007','.CON.','5','','','5','nTotComis','<','5','nVlGComis','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := nVlGComis - nTotComis   .END.','000014','000013','.EXE.','5','NVLCOMISSA',':=','5','nVlGComis - nTotComis','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "4" .END.','000015','000006','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := ( SalMes + nAdtServ + nPeric + nInsalub + nMedF','000016','000015','.EXE.','5','nTotComis',':=','5','( SalMes + nAdtServ + nPeric + nInsalub + nMedFerp )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','lMedDir == .T. .END.','000017','000015','.CON.','5','','','5','lMedDir','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nVlGComis := RCE->RCE_GCOMIS   .END.','000018','000017','.EXE.','5','nVlGComis',':=','5','RCE->RCE_GCOMIS','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','lMedDir == .F. .END.','000019','000015','.CON.','5','','','5','lMedDir','==','5','.F.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nVlGComis := RCE->RCE_GCOMIS * GETMEMVAR("RG_DFERPRO")  /  a','000020','000019','.EXE.','5','nVlGComis',':=','5','RCE->RCE_GCOMIS * GETMEMVAR("RG_DFERPRO")  /  aTabFer[3]','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < nVlGComis .END.','000021','000015','.CON.','5','','','5','nTotComis','<','5','nVlGComis','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NGCOMISFP := nVlGComis - nTotComis   .END.','000022','000021','.EXE.','5','NGCOMISFP',':=','5','nVlGComis - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := ( SalMes + nAdtServ + nPeric + nInsalub + nMedF','000023','000015','.EXE.','5','nTotComis',':=','5','( SalMes + nAdtServ + nPeric + nInsalub + nMedFerv )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000024','000015','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NGCOMISFV := RCE->RCE_GCOMIS - nTotComis   .END.','000025','000024','.EXE.','5','NGCOMISFV',':=','5','RCE->RCE_GCOMIS - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := ( SalMes + nAdtServ + nPeric + nInsalub + nMed1','000026','000015','.EXE.','5','nTotComis',':=','5','( SalMes + nAdtServ + nPeric + nInsalub + nMed13o )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000027','000015','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NGCOMIS13 := RCE->RCE_GCOMIS - nTotComis   .END.','000028','000027','.EXE.','5','NGCOMIS13',':=','5','RCE->RCE_GCOMIS - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := ( SalMes + nAdtServ + nPeric + nInsalub + nMedA','000029','000015','.EXE.','5','nTotComis',':=','5','( SalMes + nAdtServ + nPeric + nInsalub + nMedAviso )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000030','000015','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NGCOMISAV := RCE->RCE_GCOMIS - nTotComis   .END.','000031','000030','.EXE.','5','NGCOMISAV',':=','5','RCE->RCE_GCOMIS - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "5" .AND.','000032','000006','.CON.','5','','','5','cTipoRot','==','5','"5"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nAvos > 0 .END.','000033','000006','.CON.','5','','','2','nAvos','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := Fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fG','000034','000033','.EXE.','5','nTotComis',':=','5','Fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fGetCodFol("0022") )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < ROUND( RCE->RCE_GCOMIS * NPERCENTUA, 2 ) .END.','000035','000033','.CON.','5','','','5','nTotComis','<','5','ROUND( RCE->RCE_GCOMIS * NPERCENTUA, 2 )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := ROUND(RCE->RCE_GCOMIS * NPERCENTUA ,2 )   .END','000036','000035','.EXE.','5','NVLCOMISSA',':=','5','ROUND(RCE->RCE_GCOMIS * NPERCENTUA ,2 )','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "6" .AND.','000037','000006','.CON.','5','','','5','cTipoRot','==','5','"6"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nAvos > 0 .END.','000038','000006','.CON.','5','','','2','nAvos','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := 0   .CNT.','000039','000038','.EXE.','2','nTotComis',':=','5','0','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD','000040','000038','.EXE.','5','nTotComis',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD", "1" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000041','000038','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := RCE->RCE_GCOMIS - nTotComis   .END.','000042','000041','.EXE.','5','NVLCOMISSA',':=','5','RCE->RCE_GCOMIS - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "2" .AND.','000043','000006','.CON.','5','','','5','cTipoRot','==','5','"2"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','CALCULE == "S" .END.','000044','000006','.CON.','5','','','5','CALCULE','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComiss := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCO','000045','000044','.EXE.','5','nTotComiss',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD", "1")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < ROUND(RCE->RCE_GCOMIS*SRA->RA_PERCADT/100,2 )','000046','000044','.CON.','5','','','5','nTotComis','<','5','ROUND(RCE->RCE_GCOMIS*SRA->RA_PERCADT/100,2 )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','Val_Adto := ROUND(RCE->RCE_GCOMIS*SRA->RA_PERCADT/100,2)-nTo','000047','000046','.EXE.','5','Val_Adto',':=','5','ROUND(RCE->RCE_GCOMIS*SRA->RA_PERCADT/100,2)-nTotComis','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "1" .AND.','000048','000006','.CON.','5','','','5','cTipoRot','==','5','"1"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','DiasTrab > 0 .END.','000049','000006','.CON.','5','','','5','DiasTrab','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := FO_SOMAALLREGS(@&cObjeto, cCpoValor, cCpoPD, FG','000050','000049','.EXE.','5','nTotComis',':=','5','FO_SOMAALLREGS(@&cObjeto, cCpoValor, cCpoPD, FGETCODFOL("0165") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis += FO_SOMAALLREGS(@&cObjeto, cCpoValor, cCpoPD, FG','000051','000049','.EXE.','5','nTotComis','+=','5','FO_SOMAALLREGS(@&cObjeto, cCpoValor, cCpoPD, FGETCODFOL("0166") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000052','000049','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := RCE->RCE_GCOMIS - nTotComis   .END.','000053','000052','.EXE.','5','NVLCOMISSA',':=','5','RCE->RCE_GCOMIS - nTotComis','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0050    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0050( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAADI','GERACAO DE ADIANTAMENTO','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAADI','CTIPOROT <> "4"   .END.','000001','000000','.CON.','5','','','5','CTIPOROT <> "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cRot := Fo_GetVal(@&cObjeto,cCpoRot)     .CNT.','000002','000001','.EXE.','5','cRot := Fo_GetVal(@&cObjeto,cCpoRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','oSrcBkp := Fo_Clone(@&cObjeto)     .CNT.','000003','000001','.EXE.','5','oSrcBkp := Fo_Clone(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','&cObjeto := NIL     .CNT.','000004','000001','.EXE.','5','&cObjeto := NIL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','GetSrcAdi()     .CNT.','000005','000001','.EXE.','5','GetSrcAdi()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','oSrcAdi := Fo_Clone(@&cObjeto)     .CNT.','000006','000001','.EXE.','5','oSrcAdi := Fo_Clone(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','&cObjeto := Fo_Clone(@oSrcBkp)     .CNT.','000007','000001','.EXE.','5','&cObjeto := Fo_Clone(@oSrcBkp)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Len(oSrcAdi:aCols) > 0   .END.','000008','000001','.CON.','5','','','5','Len(oSrcAdi:aCols) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0006")})   .END.','000009','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0006")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0007"))     .CNT.','000010','000009','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000011','000009','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000012','000009','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0713")})   .END.','000013','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0713")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0008"))     .CNT.','000014','000013','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0008"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000015','000013','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000016','000013','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0010")})   .END.','000017','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0010")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0012"))     .CNT.','000018','000017','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0012"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000019','000017','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000020','000017','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','CTIPOROT == "4"   .END.','000021','000000','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GoTop(@&cObjeto)     .CNT.','000022','000021','.EXE.','5','Fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!Fo_Eof(@&cObjeto)   .END.','000023','000021','.ENQ.','5','','','5','!Fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GetVal(@&cObjeto,cCpoTipo2) == "A"   .END.','000024','000023','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo2) == "A"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)     .CNT.','000025','000024','.EXE.','5','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','LIF := ( cVerba == FGETCODFOL("0006") )   .END.','000026','000024','.CON.','5','','','5','LIF := ( cVerba == FGETCODFOL("0006") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))     .END.','000027','000026','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0713") ) )   .','000028','000024','.CON.','5','','','5','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0713") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0008"))     .END.','000029','000028','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0008"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0010") ) )   .','000030','000024','.CON.','5','','','5','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0010") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0012"))     .END.','000031','000030','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0012"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF   .END.','000032','000024','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Delete(@&cObjeto)     .END.','000033','000032','.EXE.','5','Fo_Delete(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Skip(@&cObjeto)     .END.','000034','000023','.EXE.','5','Fo_Skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0051    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0051( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAFER','GERA FERIAS NA FOLHA','','','024','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAFER','cAchou := "N"     .CNT.','000001','000000','.EXE.','5','cAchou := "N"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nOutAdic := 0.00     .CNT.','000002','000000','.EXE.','5','nOutAdic := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAux1:= 0     .CNT.','000003','000000','.EXE.','5','nValAux1:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAux2:= 0     .CNT.','000004','000000','.EXE.','5','nValAux2:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAux3:= 0     .CNT.','000005','000000','.EXE.','5','nValAux3:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValDes13 := 0.00     .CNT.','000006','000000','.EXE.','5','nValDes13 := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFer := 0.00     .CNT.','000007','000000','.EXE.','5','nValFer := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiaFer := 0     .CNT.','000008','000000','.EXE.','5','nDiaFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','aFerAux := {}     .CNT.','000009','000000','.EXE.','5','aFerAux := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nVezFer := 0     .CNT.','000010','000000','.EXE.','5','nVezFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValPriMes := 0     .CNT.','000011','000000','.EXE.','5','nValPriMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDataRef := If (dDataRef == Nil, dDataBase,dDataRef)     .CN','000012','000000','.EXE.','5','dDataRef := If (dDataRef == Nil, dDataBase,dDataRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','NULT_DIA := F_ULTDIA(DDATAREF)     .CNT.','000013','000000','.EXE.','5','NULT_DIA := F_ULTDIA(DDATAREF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lFerTri   := .F.     .CNT.','000014','000000','.EXE.','5','lFerTri   := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFerMs:= 0     .CNT.','000015','000000','.EXE.','5','nValFerMs:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','aCodFolTra:= {}     .CNT.','000016','000000','.EXE.','5','aCodFolTra:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cPerFeAc := If(type("cPerFeAc") == "U",P_FERPAC,cPerFeAc)','000017','000000','.EXE.','5','cPerFeAc := If(type("cPerFeAc") == "U",P_FERPAC,cPerFeAc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FPOSREG("SRH", 1 , SRA->RA_FILIAL+SRA->RA_MAT )     .CNT.','000018','000000','.EXE.','5','FPOSREG("SRH", 1 , SRA->RA_FILIAL+SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->RH_DATAFIM) =','000019','000000','.CON.','5','','','5','Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->RH_DATAFIM) == 3  .And.  Month(dDataRef) ==  3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','fCargaTrans(@aCodFolTra,aCodFol)     .END.','000020','000019','.EXE.','5','fCargaTrans(@aCodFolTra,aCodFol)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!SRH->(Eof()) .And. SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_','000021','000000','.ENQ.','5','','','5','!SRH->(Eof()) .And. SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_FILIAL+SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou  := "N"     .CNT.','000022','000021','.EXE.','5','cAchou  := "N"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer := "N"     .CNT.','000023','000021','.EXE.','5','cDifFer := "N"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDataFer := SRH->RH_DATAINI     .CNT.','000024','000021','.EXE.','5','dDataFer := SRH->RH_DATAINI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->(Type("RH_AMESFOL")) # "U" .and. !Empty(SRH->RH_AMESF','000025','000021','.CON.','5','','','5','SRH->(Type("RH_AMESFOL")) # "U" .and. !Empty(SRH->RH_AMESFOL)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDataFer := CTOD("01/" + RIGHT(SRH->RH_AMESFOL,2) + "/" + LE','000026','000025','.EXE.','5','dDataFer := CTOD("01/" + RIGHT(SRH->RH_AMESFOL,2) + "/" + LEFT(SRH->RH_AMESFOL,4))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LMesOk := ( MesAno(dDataFer)==MesAno(dDataRef) )   .END.','000027','000021','.CON.','5','','','5','LMesOk := ( MesAno(dDataFer)==MesAno(dDataRef) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( SRA->RA_CATFUNC ="S" .Or. (SRA->RA_CATFUNC = "H"','000028','000027','.CON.','5','','','5','LIF := ( SRA->RA_CATFUNC ="S" .Or. (SRA->RA_CATFUNC = "H" .AND. SRA->RA_TIPOPGT ="S") .And. nPosSem > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->RH_DATAINI >= aPeriodo[nPosSem,3] .And. SRH->RH_DATAI','000029','000028','.CON.','5','','','5','SRH->RH_DATAINI >= aPeriodo[nPosSem,3] .And. SRH->RH_DATAINI <= aPeriodo[ nPosSem,4]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou := "S"     .END.','000030','000029','.EXE.','5','cAchou := "S"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','(lUltSemana .and. !lDissidio) .or. (lDissidio .And. cAchou','000031','000028','.CON.','5','','','5','(lUltSemana .and. !lDissidio) .or. (lDissidio .And. cAchou = "S")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer := "S"     .END.','000032','000031','.EXE.','5','cDifFer := "S"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LiF   .END.','000033','000027','.CON.','5','','','5','!LiF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou := "S"     .CNT.','000034','000033','.EXE.','5','cAchou := "S"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer := "S"     .END.','000035','000033','.EXE.','5','cDifFer := "S"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. MesAno(SRH->RH_DATAFIM)==MesAno(dDataRef) .a','000036','000021','.CON.','5','','','5','!lMesOk .and. MesAno(SRH->RH_DATAFIM)==MesAno(dDataRef) .and. P_FERPRIME == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer  := "S"     .CNT.','000037','000036','.EXE.','5','cDifFer  := "S"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','Month(dDataRef) == 3 .And.     MesAno(SRH->RH_DATAINI)==St','000038','000036','.CON.','5','','','5','Month(dDataRef) == 3 .And.     MesAno(SRH->RH_DATAINI)==StrZero(Year(SRH->RH_DATAINI),4)+"01"   .and.      MesAno(SRH->RH_DATAFIM)==StrZero(Year(SRH->RH_DATAINI),4)+"03"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou := "S"     .END.','000039','000038','.EXE.','5','cAchou := "S"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lFerTri  := .F.     .CNT.','000040','000021','.EXE.','5','lFerTri  := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou == "S" .or. cDifFer == "S"   .END.','000041','000021','.CON.','5','','','5','cAchou == "S" .or. cDifFer == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lMesOk := ( Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->R','000042','000041','.CON.','5','','','5','lMesOk := ( Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->RH_DATAFIM) == 3  .And.  Month(dDataRef) ==  3 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := Day(SRH->RH_DATAFIM)     .CNT.','000043','000042','.EXE.','5','nDiasMes := Day(SRH->RH_DATAFIM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := 0     .CNT.','000044','000042','.EXE.','5','nDiasMse := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lFerTri  := .T.     .END.','000045','000042','.EXE.','5','lFerTri  := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI)==MesAn','000046','000041','.CON.','5','','','5','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI)==MesAno(SRH->RH_DATAFIM)  )  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := ( Day(SRH->RH_DATAFIM) - Day(SRH->RH_DATAINI) -','000047','000046','.EXE.','5','nDiasMes := ( Day(SRH->RH_DATAFIM) - Day(SRH->RH_DATAINI) - SRH->RH_DIALREM ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := 0     .CNT.','000048','000046','.EXE.','5','nDiasMse := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','( nDiasMes + SRH->RH_DIALREM ) > 30   .END.','000049','000046','.CON.','5','','','5','( nDiasMes + SRH->RH_DIALREM ) > 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := 30 - SRH->RH_DIALREM     .END.','000050','000049','.EXE.','5','nDiasMes := 30 - SRH->RH_DIALREM','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. MesAno(SRH->RH_DATAINI) == MesAno(dDataRef)','000051','000041','.CON.','5','','','5','!lMesOk .and. MesAno(SRH->RH_DATAINI) == MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := ( nUlt_Dia - Day(SRH->RH_DATAINI) - SRH->RH_DIAL','000052','000051','.EXE.','5','nDiasMes := ( nUlt_Dia - Day(SRH->RH_DATAINI) - SRH->RH_DIALREM ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( Month(ddataRef) < 12 )   .END.','000053','000051','.CON.','5','','','5','LIF := ( Month(ddataRef) < 12 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtMesSeg  := Ctod("01/"+StrZero(Month(dDataRef)+1,2)+"/"+St','000054','000053','.EXE.','5','dDtMesSeg  := Ctod("01/"+StrZero(Month(dDataRef)+1,2)+"/"+StrZero(Year(dDataRef),4),"DDMMYY")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIF   .END.','000055','000051','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtMesSeg := Ctod("01/01/"+StrZero(Year(dDataRef)+1,4),"DDMM','000056','000055','.EXE.','5','dDtMesSeg := Ctod("01/01/"+StrZero(Year(dDataRef)+1,4),"DDMMYY")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( MesAno(SRH->RH_DATAFIM) > MesAno(dDtMesSeg) )   .','000057','000051','.CON.','5','','','5','LIF := ( MesAno(SRH->RH_DATAFIM) > MesAno(dDtMesSeg) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := f_ultDia(dDtMesSeg)     .END.','000058','000057','.EXE.','5','nDiasMse := f_ultDia(dDtMesSeg)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIF   .END.','000059','000051','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := Day(SRH->RH_DATAFIM) - SRH->RH_DIALRE1     .END.','000060','000059','.EXE.','5','nDiasMse := Day(SRH->RH_DATAFIM) - SRH->RH_DIALRE1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cPerFeAc == "S"   .END.','000061','000041','.CON.','5','','','5','cPerFeAc == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( ( SRH->RH_DFERIAS - NoRound(SRH->RH_DFERIAS,0) )','000062','000061','.CON.','5','','','5','LIF := ( ( SRH->RH_DFERIAS - NoRound(SRH->RH_DFERIAS,0) ) > 0 .And. nDiasMse > 0 .And. nDiasMes > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes :=nDiasMes+ If(nFerDiaQb > 0,+nFerDiaQb,- 0.5)','000063','000062','.EXE.','5','nDiasMes :=nDiasMes+ If(nFerDiaQb > 0,+nFerDiaQb,- 0.5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nFerDiaQb := nFerDiaQb+ If(nFerDiaQb > 0 , -0.5 , +0.5 )','000064','000062','.EXE.','5','nFerDiaQb := nFerDiaQb+ If(nFerDiaQb > 0 , -0.5 , +0.5 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIF .AND. ( SRH->RH_DFERIAS - NoRound(SRH->RH_DFERIAS,0)','000065','000061','.CON.','5','','','5','!LIF .AND. ( SRH->RH_DFERIAS - NoRound(SRH->RH_DFERIAS,0) ) > 0 .And. nDiasMse == 0 .And. nDiasMes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := SRH->RH_DFERIAS     .CNT.','000066','000065','.EXE.','5','nDiasMes := SRH->RH_DFERIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nFerDiaQb += 0.5     .END.','000067','000065','.EXE.','5','nFerDiaQb += 0.5','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','MesAno(SRH->RH_DATAINI) == MesAno(SRH->RH_DATAFIM) .And. S','000068','000061','.CON.','5','','','5','MesAno(SRH->RH_DATAINI) == MesAno(SRH->RH_DATAFIM) .And. SRH->(RH_DATAFIM - RH_DATAINI + 1) <> SRH->RH_DFERIAS','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','aAdd(aFerAux,{SRH->(RH_DATAFIM - RH_DATAINI + 1),SRH->RH_DFE','000069','000068','.EXE.','5','aAdd(aFerAux,{SRH->(RH_DATAFIM - RH_DATAINI + 1),SRH->RH_DFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDMesFAC += nDiasMes     .CNT.','000070','000061','.EXE.','5','nDMesFAC += nDiasMes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDMseFAC += nDiasMse     .END.','000071','000061','.EXE.','5','nDMseFAC += nDiasMse','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->RH_DABONPE > 0   .END.','000072','000041','.CON.','5','','','5','SRH->RH_DABONPE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','Lif := ( !empty(SRH->RH_ABOPEC) )   .END.','000073','000072','.CON.','5','','','5','Lif := ( !empty(SRH->RH_ABOPEC) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAboAnt :=SRH->RH_ABOPEC     .END.','000074','000073','.EXE.','5','cAboAnt :=SRH->RH_ABOPEC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIf   .END.','000075','000072','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAboAnt :=P_ABOPEC     .CNT.','000076','000075','.EXE.','5','cAboAnt :=P_ABOPEC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAboAnt := if(cAboAnt=="S","1","2")     .END.','000077','000075','.EXE.','5','cAboAnt := if(cAboAnt=="S","1","2")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIf := ( cAboAnt == "1" )   .END.','000078','000072','.CON.','5','','','5','LIf := ( cAboAnt == "1" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtIAb := SRH->RH_DATAINI - SRH->RH_DABONPE     .CNT.','000079','000078','.EXE.','5','dDtIAb := SRH->RH_DATAINI - SRH->RH_DABONPE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtFAb := SRH->RH_DATAINI -1     .END.','000080','000078','.EXE.','5','dDtFAb := SRH->RH_DATAINI -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIf   .END.','000081','000072','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtIAb := SRH->RH_DATAFIM + 1     .CNT.','000082','000081','.EXE.','5','dDtIAb := SRH->RH_DATAFIM + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtFAb := SRH->RH_DATAFIM + SRH->RH_DABONPE     .END.','000083','000081','.EXE.','5','dDtFAb := SRH->RH_DATAFIM + SRH->RH_DABONPE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lMesOk := ( MesAno(dDtIAb) == MesAno(dDataRef)  .And. MesA','000084','000072','.CON.','5','','','5','lMesOk := ( MesAno(dDtIAb) == MesAno(dDataRef)  .And. MesAno(dDtFAb) # MesAno(dDataRef) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := (nUlt_Dia - Day(dDtIAb)) + 1     .CNT.','000085','000084','.EXE.','5','nDAbMes := (nUlt_Dia - Day(dDtIAb)) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := Day(dDtFAb)     .END.','000086','000084','.EXE.','5','nDAbMse := Day(dDtFAb)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','! lMesOk .and. ( lmesOk := ( MesAno(SRH->RH_DATAINI) # Mes','000087','000072','.CON.','5','','','5','! lMesOk .and. ( lmesOk := ( MesAno(SRH->RH_DATAINI) # MesAno(dDataRef) .And. MesAno(dDtIAb) >= MesAno(dDataRef) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := 0     .CNT.','000088','000087','.EXE.','5','nDAbMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := SRH->RH_DABONPE     .END.','000089','000087','.EXE.','5','nDAbMse := SRH->RH_DABONPE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI) == Mes','000090','000072','.CON.','5','','','5','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI) == MesAno(dDataRef) .And. MesAno(dDtIAb) > MesAno(dDataRef) ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := 0     .CNT.','000091','000090','.EXE.','5','nDAbMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := SRH->RH_DABONPE     .END.','000092','000090','.EXE.','5','nDAbMse := SRH->RH_DABONPE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI) == Mes','000093','000072','.CON.','5','','','5','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI) == MesAno(dDataRef) .And. MesAno(dDtFAb) == MesAno(dDataRef) .And. MesAno(dDtIAb) < MesAno(dDataRef) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := Day(dDtFAb)     .CNT.','000094','000093','.EXE.','5','nDAbMes := Day(dDtFAb)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := 0     .END.','000095','000093','.EXE.','5','nDAbMse := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk   .END.','000096','000072','.CON.','5','','','5','!lMesOk','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := SRH->RH_DABONPE     .CNT.','000097','000096','.EXE.','5','nDAbMes := SRH->RH_DABONPE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := 0     .END.','000098','000096','.EXE.','5','nDAbMse := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou == "S"   .END.','000099','000021','.CON.','5','','','5','cAchou == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','S_GERAITFE()     .END.','000100','000099','.EXE.','5','S_GERAITFE()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer = "S" .And. cAchou = "N"   .END.','000101','000021','.CON.','5','','','5','cDifFer = "S" .And. cAchou = "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := 0     .CNT.','000102','000101','.EXE.','5','nDiasMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := Day(SRH->RH_DATAFIM) - SRH->RH_DIALRE1     .END.','000103','000101','.EXE.','5','nDiasMse := Day(SRH->RH_DATAFIM) - SRH->RH_DIALRE1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer == "S"   .END.','000104','000021','.CON.','5','','','5','cDifFer == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','Aadd(aDifFer,{ SRH->(Recno()) , nDiasMes , nDiasMse })     .','000105','000104','.EXE.','5','Aadd(aDifFer,{ SRH->(Recno()) , nDiasMes , nDiasMse })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->(DbSkip())     .END.','000106','000021','.EXE.','5','SRH->(DbSkip())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cPerFeAc == "S"   .END.','000107','000000','.CON.','5','','','5','cPerFeAc == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','aEval(aFerAux,{|X| nValAux1 += x[1], nValAux2 += x[2], nValA','000108','000107','.EXE.','5','aEval(aFerAux,{|X| nValAux1 += x[1], nValAux2 += x[2], nValAux3 += If(x[1] < x[2],1,0) })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lDiaQbSegFer := nValAux1 <> nValAux2 .And.      ( nValAux2 -','000109','000107','.EXE.','5','lDiaQbSegFer := nValAux1 <> nValAux2 .And.      ( nValAux2 - NoRound(nValAux2,0) > 0 ) .And.     nValAux3 > 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( nFerDiaQb > 0 .And. ( nDMseFAC > 0 .Or.   ( nDMes','000110','000107','.CON.','5','','','5','LIF := ( nFerDiaQb > 0 .And. ( nDMseFAC > 0 .Or.   ( nDMesFAC - NoRound(nDMesFAC,0) > 0 .And. nDMseFAC == 0 ) .Or. lDiaQbSegFer ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lFerDiaQb := .T.     .END.','000111','000110','.EXE.','5','lFerDiaQb := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIF   .END.','000112','000107','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nFerDiaQb:= 0     .CNT.','000113','000112','.EXE.','5','nFerDiaQb:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lDiaQbSegFer:= .F.     .END.','000114','000112','.EXE.','5','lDiaQbSegFer:= .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0052    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0052( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAFERP','GERA FERIAS NA FOLHA PORTUGAL','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAFERP','DDATAREF := IF (DDATAREF == NIL, DDATABASE,DDATAREF)     .CN','000001','000000','.EXE.','5','DDATAREF := IF (DDATAREF == NIL, DDATABASE,DDATAREF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','NVALPRIMES := 0     .CNT.','000002','000000','.EXE.','5','NVALPRIMES := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','CPERFEAC := IF(TYPE("CPERFEAC") == "U",P_FERPAC,CPERFEAC)','000003','000000','.EXE.','5','CPERFEAC := IF(TYPE("CPERFEAC") == "U",P_FERPAC,CPERFEAC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','ACODFOLTRA:= {}     .CNT.','000004','000000','.EXE.','5','ACODFOLTRA:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','nOrdSrh := RetOrder( "SRH", "RH_FILIAL+ RH_MAT + DTOS(RH_DAT','000005','000000','.EXE.','5','nOrdSrh := RetOrder( "SRH", "RH_FILIAL+ RH_MAT + DTOS(RH_DATABAS) + DTOS(RH_DATAINI ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','FPOSREG("SRH", nOrdSrh , SRA->RA_FILIAL+SRA->RA_MAT )     .C','000006','000000','.EXE.','5','FPOSREG("SRH", nOrdSrh , SRA->RA_FILIAL+SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','!SRH->( EOF() ) .AND. (SRH->RH_FILIAL+SRH->RH_MAT == SRA->','000007','000000','.ENQ.','5','','','5','!SRH->( EOF() ) .AND. (SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_FILIAL+SRA->RA_MAT )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','SRH->RH_PERIODO == cPeriodo .and. SRH->RH_TIPO == '+"'"+'1'+"'"+'   .E','000008','000007','.CON.','5','','','5','SRH->RH_PERIODO == cPeriodo .and. SRH->RH_TIPO == '+"'"+'1'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','NDIASMES := SRH->RH_DFERIAS     .CNT.','000009','000008','.EXE.','5','NDIASMES := SRH->RH_DFERIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','NDIASMSE := 0     .CNT.','000010','000008','.EXE.','5','NDIASMSE := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','S_GERAITFER()     .END.','000011','000008','.EXE.','5','S_GERAITFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFERP','SRH->(DBSKIP())     .END.','000012','000007','.EXE.','5','SRH->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0053    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0053( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAITFE','GERA ITENS DE FERIAS','','','089','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAITFE','nSeq := FO_COUNT(@&cObjeto,cCpoPd,FGETCODFOL("0072"))     .C','000001','000000','.EXE.','5','nSeq := FO_COUNT(@&cObjeto,cCpoPd,FGETCODFOL("0072"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','nSeq := If ( nSeq = 0,FO_COUNT(@&cObjeto,CCpoPd,FGETCODFOL("','000002','000000','.EXE.','5','nSeq := If ( nSeq = 0,FO_COUNT(@&cObjeto,CCpoPd,FGETCODFOL("0102")),nSeq)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','nSeq > 0   .END.','000003','000000','.CON.','5','','','5','nSeq > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','nSeq ++     .END.','000004','000003','.EXE.','5','nSeq ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','nOutAdic := 0.00     .CNT.','000005','000000','.EXE.','5','nOutAdic := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','nValDes13 := 0.00     .CNT.','000006','000000','.EXE.','5','nValDes13 := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','NINDICE1 := MAX(RETORDER("SRV","RV_FILIAL+RV_CODFER"),1)','000007','000000','.EXE.','5','NINDICE1 := MAX(RETORDER("SRV","RV_FILIAL+RV_CODFER"),1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','NINDICE2 := MAX(RETORDER("SRV","RV_FILIAL+RV_CODMSEG"),1)','000008','000000','.EXE.','5','NINDICE2 := MAX(RETORDER("SRV","RV_FILIAL+RV_CODMSEG"),1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','dDtBusFer := fDtBusFer()     .CNT.','000009','000000','.EXE.','5','dDtBusFer := fDtBusFer()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','fPosReg("SRR",1,SRA->RA_FILIAL+SRA->RA_MAT+"F"+Dtos(dDtBusFe','000010','000000','.EXE.','5','fPosReg("SRR",1,SRA->RA_FILIAL+SRA->RA_MAT+"F"+Dtos(dDtBusFer) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!SRR->(Eof()) .And. SRA->RA_FILIAL+SRA->RA_MAT == SRR->RR_','000011','000000','.ENQ.','5','','','5','!SRR->(Eof()) .And. SRA->RA_FILIAL+SRA->RA_MAT == SRR->RR_FILIAL+SRR->RR_MAT .And. dDtBusFer == SRR->RR_DATA .And. SRR->RR_TIPO3 == '+"'"+'F'+"'"+'','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','nValPriMes := 0     .CNT.','000012','000011','.EXE.','5','nValPriMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','cVrbFer := ""     .CNT.','000013','000011','.EXE.','5','cVrbFer := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','NDIASMSE := 0     .END.','000014','000013','.EXE.','5','NDIASMSE := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','lVrbOk := ( SRR->RR_PD == FGETCODFOL("0072") )   .END.','000015','000011','.CON.','5','','','5','lVrbOk := ( SRR->RR_PD == FGETCODFOL("0072") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer := {FGETCODFOL("0072"),SRH->RH_DFERIAS,nDiasMes,,,nV','000016','000015','.EXE.','5','aVrbFer := {FGETCODFOL("0072"),SRH->RH_DFERIAS,nDiasMes,,,nValPriMes,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000017','000015','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0075','000018','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0075") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0075"),SRH->RH_DFERIAS,nDiasMes,,,nVa','000019','000018','.EXE.','5','aVrbFer:= {FGETCODFOL("0075"),SRH->RH_DFERIAS,nDiasMes,,,nValPriMes,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000020','000018','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0343','000021','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0343") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0343"),SRH->RH_DFERIAS,nDiasMes,,,nVa','000022','000021','.EXE.','5','aVrbFer:= {FGETCODFOL("0343"),SRH->RH_DFERIAS,nDiasMes,,,nValPriMes,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000023','000021','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0082','000024','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0082") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0082"),SRH->RH_DFERIAS,nDiasMes,,,nVa','000025','000024','.EXE.','5','aVrbFer:= {FGETCODFOL("0082"),SRH->RH_DFERIAS,nDiasMes,,,nValPriMes,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000026','000024','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0159','000027','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0159") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0159"),SRH->RH_DFERIAS,nDiasMes,,,nVa','000028','000027','.EXE.','5','aVrbFer:= {FGETCODFOL("0159"),SRH->RH_DFERIAS,nDiasMes,,,nValPriMes,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000029','000027','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0104','000030','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0104") .And. !lFerTri ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0104"),0,0,,,,,Str(nSeq,1)}     .CNT.','000031','000030','.EXE.','5','aVrbFer:= {FGETCODFOL("0104"),0,0,,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000032','000030','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0016','000033','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0016") .And. !lFerTri ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0016"),0,0,,,,,Str(nSeq,1)}     .CNT.','000034','000033','.EXE.','5','aVrbFer:= {FGETCODFOL("0016"),0,0,,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000035','000033','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0787','000036','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0787") .And. !lFerTri ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0787"),0,0,,,,,Str(nSeq,1)}     .CNT.','000037','000036','.EXE.','5','aVrbFer:= {FGETCODFOL("0787"),0,0,,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000038','000036','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0788','000039','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0788") .And. !lFerTri ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0788"),0,0,,,,,Str(nSeq,1)}     .CNT.','000040','000039','.EXE.','5','aVrbFer:= {FGETCODFOL("0788"),0,0,,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000041','000039','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0065','000042','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0065") .And. !lFerTri ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0065"),0,0,,,,,Str(nSeq,1)}     .CNT.','000043','000042','.EXE.','5','aVrbFer:= {FGETCODFOL("0065"),0,0,,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000044','000042','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0067','000045','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0067") .And. !lFerTri ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0067"),0,0,,,,,Str(nSeq,1)}     .CNT.','000046','000045','.EXE.','5','aVrbFer:= {FGETCODFOL("0067"),0,0,,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000047','000045','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0102','000048','000011','.CON.','5','','','5','!lVrbOk .and. ( lVrbOk := ( SRR->RR_PD == FGETCODFOL("0102") .and. !lFerTri ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("1003"),0,0,SRR->RR_VALOR,,,,Str(nSeq,','000049','000048','.EXE.','5','aVrbFer:= {FGETCODFOL("1003"),0,0,SRR->RR_VALOR,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000050','000048','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!lVrbOk   .END.','000051','000011','.CON.','5','','','5','!lVrbOk','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','cTipoCod := PosSrv(SRR->RR_PD,SRA->RA_FILIAL,"RV_TIPOCOD")','000052','000051','.EXE.','5','cTipoCod := PosSrv(SRR->RR_PD,SRA->RA_FILIAL,"RV_TIPOCOD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','CTIPOCOD == "1"   .OR.','000053','000051','.CON.','5','','','5','CTIPOCOD == "1"','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','CTIPOCOD == "2" .AND. SRR->RR_PD # FGETCODFOL("0064")   .O','000054','000051','.CON.','5','','','5','CTIPOCOD == "2" .AND. SRR->RR_PD # FGETCODFOL("0064")','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','CTIPOCOD == "3" .AND. !(SRR->RR_PD $ FGETCODFOL("0013") +','000055','000051','.CON.','5','','','5','CTIPOCOD == "3" .AND. !(SRR->RR_PD $ FGETCODFOL("0013") + '+"'"+'*'+"'"+' + FGETCODFOL("0014") + '+"'"+'*'+"'"+' + FGETCODFOL("0783"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','dDtPgFe  := dDtBusFer     .CNT.','000056','000055','.EXE.','5','dDtPgFe  := dDtBusFer','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','LIF := FPOSREG("SRV", NINDICE1, XFILIAL("SRV")+SRR->RR_PD)','000057','000055','.CON.','5','','','5','LIF := FPOSREG("SRV", NINDICE1, XFILIAL("SRV")+SRR->RR_PD)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','cVrbFer := SRV->RV_COD     .CNT.','000058','000057','.EXE.','5','cVrbFer := SRV->RV_COD','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','( nPos := Ascan(aAdicFer,{|X| X[1] = cVrbFer}) ) > 0   .EN','000059','000057','.CON.','5','','','5','( nPos := Ascan(aAdicFer,{|X| X[1] = cVrbFer}) ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','AADICFER[nPos,2] := ROUND( ( SRR->RR_VALOR / SRH->RH_DFERIAS','000060','000059','.EXE.','5','AADICFER[nPos,2] := ROUND( ( SRR->RR_VALOR / SRH->RH_DFERIAS ) * 30 , 2 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {SRR->RR_PD,SRH->RH_DFERIAS,nDiasMes,SRR->RR_VALOR','000061','000057','.EXE.','5','aVrbFer:= {SRR->RR_PD,SRH->RH_DFERIAS,nDiasMes,SRR->RR_VALOR,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .CNT.','000062','000057','.EXE.','5','S_GRAVAFER()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','( FPOSREG("SRV", NINDICE2, XFILIAL("SRV")+SRR->RR_PD) ) .A','000063','000057','.CON.','5','','','5','( FPOSREG("SRV", NINDICE2, XFILIAL("SRV")+SRR->RR_PD) ) .AND. ( SRV->RV_COD != SRR->RR_PD )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {SRV->RV_COD,SRH->RH_DFERIAS,nDiasMse,SRR->RR_VALO','000064','000063','.EXE.','5','aVrbFer:= {SRV->RV_COD,SRH->RH_DFERIAS,nDiasMse,SRR->RR_VALOR,,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000065','000063','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','( !LIF ) .AND. ( CTIPOCOD == "1" )   .END.','000066','000055','.CON.','5','','','5','( !LIF ) .AND. ( CTIPOCOD == "1" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','NOUTADIC := SRR->RR_VALOR     .CNT.','000067','000066','.EXE.','5','NOUTADIC := SRR->RR_VALOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','NPOS := ASCAN(AADICFER,{|X| X[1] = SRR->RR_PD}) > 0   .END','000068','000066','.CON.','5','','','5','NPOS := ASCAN(AADICFER,{|X| X[1] = SRR->RR_PD}) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','ADEL(AADICFER,NPOS)     .CNT.','000069','000068','.EXE.','5','ADEL(AADICFER,NPOS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','ASIZE(AADICFER,LEN(AADICFER)-1)     .END.','000070','000068','.EXE.','5','ASIZE(AADICFER,LEN(AADICFER)-1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','SRR->(DBSKIP())     .END.','000071','000011','.EXE.','5','SRR->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','nOutAdic > 0.00   .END.','000072','000000','.CON.','5','','','5','nOutAdic > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0084"),SRH->RH_DFERIAS,nDiasMes,nOutA','000073','000072','.EXE.','5','aVrbFer:= {FGETCODFOL("0084"),SRH->RH_DFERIAS,nDiasMes,nOutAdic,dDtPgFe,nValPriMes,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .CNT.','000074','000072','.EXE.','5','S_GRAVAFER()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0085"),SRH->RH_DFERIAS,nDiasMse,nOutA','000075','000072','.EXE.','5','aVrbFer:= {FGETCODFOL("0085"),SRH->RH_DFERIAS,nDiasMse,nOutAdic,dDtPgFe,nValPriMes,.T.,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000076','000072','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','nValFerMs > 0 .and. lFerTri   .END.','000077','000000','.CON.','5','','','5','nValFerMs > 0 .and. lFerTri','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','aVrbFer:= {FGETCODFOL("0164"),0,0,nValFerMs,dDtPgFe,,,Str(nS','000078','000077','.EXE.','5','aVrbFer:= {FGETCODFOL("0164"),0,0,nValFerMs,dDtPgFe,,,Str(nSeq,1)}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000079','000077','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0054    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0054( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAPERI','GERA PERIODOS A PROVISIONAR','','','037','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAPERI','NTIPOPRV <> 2   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV <> 2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','dDtBasFer := SRA->RA_ADMISSA     .CNT.','000002','000001','.EXE.','5','dDtBasFer := SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','cVerba := FGETCODFOL("0072")     .CNT.','000003','000001','.EXE.','5','cVerba := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_SKIP(@OSRF)     .END.','000004','000004','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','S_BASEFER()     .CNT.','000005','000001','.EXE.','5','S_BASEFER()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','DiasFerPtg(@aPerFerias,dDtBasFer,dDataAte)     .CNT.','000006','000001','.EXE.','5','DiasFerPtg(@aPerFerias,dDtBasFer,dDataAte)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','Len(aPerFerias) == 0 .And. NTIPOPRV == 1   .END.','000007','000001','.CON.','5','','','5','Len(aPerFerias) == 0 .And. NTIPOPRV == 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FinalFun()     .END.','000008','000007','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont := 1     .CNT.','000009','000001','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont <= Len(aPerFerias)   .END.','000010','000001','.ENQ.','5','','','5','nCont <= Len(aPerFerias)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','LIF := FO_SEEK(@OSRF,{"RF_DATABAS","RF_PD"},{aPerFerias[nC','000011','000010','.CON.','5','','','5','LIF := FO_SEEK(@OSRF,{"RF_DATABAS","RF_PD"},{aPerFerias[nCont,1],cVerba})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_SETVAL(@OSRF,"RF_DFERVAT",aPerFerias[nCont,3])     .CNT.','000012','000011','.EXE.','5','FO_SETVAL(@OSRF,"RF_DFERVAT",aPerFerias[nCont,3])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_SETVAL(@OSRF,"RF_DFERAAT",aPerFerias[nCont,4])     .END.','000013','000011','.EXE.','5','FO_SETVAL(@OSRF,"RF_DFERAAT",aPerFerias[nCont,4])','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nVenc := 0     .CNT.','000014','000013','.EXE.','5','nVenc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','dFim := CTOD("31/12/"+StrZero(Year(dDataAte),4))     .END.','000015','000013','.EXE.','5','dFim := CTOD("31/12/"+StrZero(Year(dDataAte),4))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','!LIF   .END.','000016','000010','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','FO_ADD(@OSRF, {"RF_PD", "RF_DATABAS", "RF_DATAFIM", "RF_DFER','000017','000016','.EXE.','5','FO_ADD(@OSRF, {"RF_PD", "RF_DATABAS", "RF_DATAFIM", "RF_DFERVAT", "RF_DFERAAT", "RF_DIASDIR"}, {cVerba, aPerFerias[nCont,1], aPerFerias[nCont,2], aPerFerias[nCont,3],  aPerFerias[nCont,4], 22})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPERI','nCont++     .END.','000018','000010','.EXE.','5','nCont++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0055    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0055( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAPGPT','GERA FERIAS E 13 JA PAGOS NA RESCISAO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAPGPT','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0087")})   .END.','000001','000000','.CON.','5','','','5','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0087")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','NVALPAG := 0     .CNT.','000002','000001','.EXE.','5','NVALPAG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','CVERBA := FGETCODFOL("0164")     .CNT.','000003','000001','.EXE.','5','CVERBA := FGETCODFOL("0164")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','FBUSCAACM(FGETCODFOL("0072"), , DDTBASFER, DDATADEM, "V", @N','000004','000001','.EXE.','5','FBUSCAACM(FGETCODFOL("0072"), , DDTBASFER, DDATADEM, "V", @NVALPAG, , "FOL")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','NVALPAG > 0 .AND. !EMPTY(CVERBA)   .END.','000005','000001','.CON.','5','','','5','NVALPAG > 0 .AND. !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR},{CVERBA,NVALPAG})     .E','000006','000005','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR},{CVERBA,NVALPAG})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0025")})   .END.','000007','000000','.CON.','5','','','5','FO_SEEK(@&COBJETO,{CCPOPD},{FGETCODFOL("0025")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','NVALPAG := 0     .CNT.','000008','000007','.EXE.','5','NVALPAG := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','CVERBA := FGETCODFOL("0023")     .CNT.','000009','000007','.EXE.','5','CVERBA := FGETCODFOL("0023")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','FBUSCAACM(FGETCODFOL("0025"), , DDTBASFER, DDATADEM, "V", @N','000010','000007','.EXE.','5','FBUSCAACM(FGETCODFOL("0025"), , DDTBASFER, DDATADEM, "V", @NVALPAG, , "NAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','NVALPAG > 0 .AND. !EMPTY(CVERBA)   .END.','000011','000007','.CON.','5','','','5','NVALPAG > 0 .AND. !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAPGPT','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR},{CVERBA,NVALPAG})     .E','000012','000011','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR},{CVERBA,NVALPAG})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0056    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0056( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERARES','GERA RESCISAO NA FOLHA','','','027','2','1',} )

aAdd(aRc3Cols, { '','S_','GERARES','SRA->RA_SITFOLH = "D" .and. cTipoRot = "1"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH = "D" .and. cTipoRot = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aRecnos := {}     .CNT.','000002','000001','.EXE.','5','aRecnos := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCCusFun := SRA->RA_CC     .CNT.','000003','000001','.EXE.','5','cCCusFun := SRA->RA_CC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lDeleta := .F.     .CNT.','000004','000001','.EXE.','5','lDeleta := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nPosPdCc := 0.00     .CNT.','000005','000001','.EXE.','5','nPosPdCc := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nRecno := 0.00     .CNT.','000006','000001','.EXE.','5','nRecno := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nRecnos := 0.00     .CNT.','000007','000001','.EXE.','5','nRecnos := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLenSeq := Len( SRC->RC_SEQ )     .CNT.','000008','000001','.EXE.','5','nLenSeq := Len( SRC->RC_SEQ )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := .F.     .CNT.','000009','000001','.EXE.','5','lGerRes := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','fPosReg("SRG",1,SRA->( RA_FILIAL + RA_MAT ))     .CNT.','000010','000001','.EXE.','5','fPosReg("SRG",1,SRA->( RA_FILIAL + RA_MAT ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) == RG_FILI','000011','000001','.ENQ.','5','','','5','SRG->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) == RG_FILIAL + RG_MAT )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( ( MesAno( RG_DTGERAR ) == cAnoMes ) .and. RG_EFETIV','000012','000011','.CON.','5','','','5','SRG->( ( MesAno( RG_DTGERAR ) == cAnoMes ) .and. RG_EFETIVA $ " S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := .T.     .CNT.','000013','000012','.EXE.','5','lGerRes := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','LIF := ( SRG->( MesAno( RG_DATADEM ) == MesAno( RG_DTGERAR','000014','000012','.CON.','5','','','5','LIF := ( SRG->( MesAno( RG_DATADEM ) == MesAno( RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','LIF2 := ( Empty( aRecnos ) )   .END.','000015','000014','.CON.','5','','','5','LIF2 := ( Empty( aRecnos ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aAdd( aRecnos , SRG->( Recno() ) )     .END.','000016','000015','.EXE.','5','aAdd( aRecnos , SRG->( Recno() ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!LIF2   .END.','000017','000014','.CON.','5','','','5','!LIF2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aRecnos[ Len( aRecnos ) ] := SRG->( Recno() )     .END.','000018','000017','.EXE.','5','aRecnos[ Len( aRecnos ) ] := SRG->( Recno() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!LIF   .END.','000019','000012','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aAdd( aRecnos , SRG->( Recno() ) )     .END.','000020','000019','.EXE.','5','aAdd( aRecnos , SRG->( Recno() ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( dbSkip() )     .END.','000021','000011','.EXE.','5','SRG->( dbSkip() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha := 1     .CNT.','000022','000001','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','( nRecnos := Len( aRecnos ) ) > 0.00   .END.','000023','000001','.CON.','5','','','5','( nRecnos := Len( aRecnos ) ) > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha <= nRecnos   .END.','000024','000023','.ENQ.','5','','','5','nLinha <= nRecnos','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( dbGoto( aRecnos[ nLinha ] ) )     .CNT.','000025','000024','.EXE.','5','SRG->( dbGoto( aRecnos[ nLinha ] ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SR','000026','000024','.CON.','5','','','5','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SRG->RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','FO_DEL(@&cObjeto,{"RC_FILIAL","RC_MAT"},{SRR->RR_FILIAL,SRR-','000027','000026','.EXE.','5','FO_DEL(@&cObjeto,{"RC_FILIAL","RC_MAT"},{SRR->RR_FILIAL,SRR->RR_MAT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == R','000028','000026','.ENQ.','5','','','5','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == RR_FILIAL + RR_MAT + RR_TIPO3 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGER','000029','000028','.CON.','5','','','5','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGERAR .and. !Empty( RR_VALOR ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','000030','000029','.EXE.','5','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR-','000031','000029','.EXE.','5','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR->RR_DATAPAG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','aCampos:={cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpoCc,cCpoT','000032','000029','.EXE.','5','aCampos:={cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpoCc,cCpoTipo1,cCpoTipo2,cCpoData,cCpoSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','aConteudos:={SRR->RR_PD,SRR->RR_VALOR,SRR->RR_HORAS,SRR->RR_','000033','000029','.EXE.','5','aConteudos:={SRR->RR_PD,SRR->RR_VALOR,SRR->RR_HORAS,SRR->RR_SEMANA,cCCAux,SRR->RR_TIPO1,SRR->RR_TIPO2,dDataPgt,SRR->RR_SEQ}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','FO_ADD(@&cObjeto,aCampos,aConteudos)     .END.','000034','000029','.EXE.','5','FO_ADD(@&cObjeto,aCampos,aConteudos)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->(DBSKIP())     .END.','000035','000028','.EXE.','5','SRR->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha ++     .END.','000036','000024','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes   .END.','000037','000001','.CON.','5','','','5','lGerRes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','S_GRAVASRC()     .END.','000038','000037','.EXE.','5','S_GRAVASRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','FINALFUN()     .END.','000039','000001','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0057    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0057( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERASNAT','GERACAO DE SUBSIDIO DE NATAL NA FOLHA','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GERASNAT','lSqlWhere := .T.     .CNT.','000001','000000','.EXE.','5','lSqlWhere := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERASNAT','LTOPFILTER := .T.     .CNT.','000002','000000','.EXE.','5','LTOPFILTER := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERASNAT','cQueryWhere := "RC_FILIAL= '+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " +','000003','000000','.EXE.','5','cQueryWhere := "RC_FILIAL= '+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "RC_MAT     ='+"'"+'" + SRA->RA_MAT +"'+"'"+' AND " + "RC_PERIODO ='+"'"+'" + CPERIODO + "'+"'"+' AND " + " RC_SEMANA ='+"'"+'" + CNUMPAG +"'+"'"+' AND " + " RC_ROTEIR ='+"'"+'" + "NAT" + "'+"'"+' AND " + "D_E_L_E_T_ <> '+"'"+'*'+"'"+' "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERASNAT','fo_New( @oSRCNAT , "SRC", 4, SRA->(RA_FILIAL+RA_MAT) + cPeri','000004','000000','.EXE.','5','fo_New( @oSRCNAT , "SRC", 4, SRA->(RA_FILIAL+RA_MAT) + cPeriodo + "NAT" + cNumPag, cQueryWhere, @lSqlWhere , @lTopFilter)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERASNAT','fo_GoTop( @oSRCNAT )     .CNT.','000005','000000','.EXE.','5','fo_GoTop( @oSRCNAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERASNAT','!FO_EOF(@oSRCNAT)   .END.','000006','000000','.ENQ.','5','','','5','!FO_EOF(@oSRCNAT)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERASNAT','FO_SETVAL(@OSRCNAT,CCPOROT,C__ROTEIRO)     .CNT.','000007','000006','.EXE.','5','FO_SETVAL(@OSRCNAT,CCPOROT,C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERASNAT','FO_CLONELINE(OSRCNAT,@&COBJETO,FO_NAT(@OSRCNAT))     .CNT.','000008','000006','.EXE.','5','FO_CLONELINE(OSRCNAT,@&COBJETO,FO_NAT(@OSRCNAT))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERASNAT','FO_SKIP(@oSRCNAT)     .END.','000009','000006','.EXE.','5','FO_SKIP(@oSRCNAT)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0058    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0058( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GETPRACU','OBTEM PROVISAO ACUMULADA','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','GETPRACU','AAREA := GETAREA()     .CNT.','000001','000000','.EXE.','5','AAREA := GETAREA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000002','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NVALANT := 0     .CNT.','000003','000002','.EXE.','5','NVALANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','CVERBAS := FGETCODFOL("0776")     .CNT.','000004','000002','.EXE.','5','CVERBAS := FGETCODFOL("0776")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','FBUSCAACM(CVERBAS, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATA','000005','000002','.EXE.','5','FBUSCAACM(CVERBAS, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATADE), "V", @NVALANT, , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NPRACUFER := NVALANT     .END.','000006','000002','.EXE.','5','NPRACUFER := NVALANT','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NTIPOPRV > 1   .END.','000007','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NVALANT := 0     .CNT.','000008','000007','.EXE.','5','NVALANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','CVERBAS := FGETCODFOL("0777")     .CNT.','000009','000007','.EXE.','5','CVERBAS := FGETCODFOL("0777")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','FBUSCAACM(CVERBAS, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATA','000010','000007','.EXE.','5','FBUSCAACM(CVERBAS, , DDATADE-DAY(DDATADE), DDATADE-DAY(DDATADE), "V", @NVALANT, , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','NPRACU13 := NVALANT     .END.','000011','000007','.EXE.','5','NPRACU13 := NVALANT','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GETPRACU','RESTAREA(AAREA)     .END.','000012','000000','.EXE.','5','RESTAREA(AAREA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0059    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0059( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GPEXMED','CALCULO DE MEDIAS','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GPEXMED','S_SALMIN()     .CNT.','000001','000000','.EXE.','5','S_SALMIN()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GPEXMED','S_SALMED()     .CNT.','000002','000000','.EXE.','5','S_SALMED()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GPEXMED','GPEXMED(dDt1,dDt2,dDt3,dDt4,dDt5,SalHora,Val_SalMin,aCodFol,','000003','000000','.EXE.','5','GPEXMED(dDt1,dDt2,dDt3,dDt4,dDt5,SalHora,Val_SalMin,aCodFol,lMesAtu,lMovto,lFaltas)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0060    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0060( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAADI','GERA ADIANTAMENTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAADI','VAL_ADTO <> 0   .END.','000001','000000','.CON.','5','','','5','VAL_ADTO <> 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAADI','!( FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("0006")}) )   .E','000002','000001','.CON.','5','','','5','!( FO_SEEK(@&cObjeto,{CCPOPD},{FGETCODFOL("0006")}) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAADI','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras},{fGetCodFol("0','000003','000002','.EXE.','5','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras},{fGetCodFol("0006"),Val_adto,SRA->RA_PERCADT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0061    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0061( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAFER','GRAVA VERBAS DE FERIAS','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAFER','nValorFe   := If (aVrbFer[4]  == Nil , SRR->RR_VALOR , aVrbF','000001','000000','.EXE.','5','nValorFe   := If (aVrbFer[4]  == Nil , SRR->RR_VALOR , aVrbFer[4])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nDiasFe := aVrbFer[2]     .CNT.','000002','000000','.EXE.','5','nDiasFe := aVrbFer[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nDMes := aVrbFer[3]     .CNT.','000003','000000','.EXE.','5','nDMes := aVrbFer[3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','dDtPgFe    := If (aVrbFer[5]  == Nil , SRH->RH_DTRECIB , aVr','000004','000000','.EXE.','5','dDtPgFe    := If (aVrbFer[5]  == Nil , SRH->RH_DTRECIB , aVrbFer[5])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','lSegMes    := If (aVrbFer[7] == Nil,.F.,aVrbFer[7] )     .CN','000005','000000','.EXE.','5','lSegMes    := If (aVrbFer[7] == Nil,.F.,aVrbFer[7] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','cSeq := If (aVrbFer[8]  == Nil .or. aVrbFer[8] == "0" ," ",','000006','000000','.EXE.','5','cSeq := If (aVrbFer[8]  == Nil .or. aVrbFer[8] == "0" ," ", aVrbFer[8])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nValPriMes := If (aVrbFer[6]  # Nil .And. lSegMes,aVrbFer[6]','000007','000000','.EXE.','5','nValPriMes := If (aVrbFer[6]  # Nil .And. lSegMes,aVrbFer[6],0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','lArrDFer   := If (Round(aVrbFer[2], 0) == aVrbFer[3] .And. n','000008','000000','.EXE.','5','lArrDFer   := If (Round(aVrbFer[2], 0) == aVrbFer[3] .And. nDiasMse > 0, .T., .F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','cCodigo := aVrbfer[1]     .CNT.','000009','000000','.EXE.','5','cCodigo := aVrbfer[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','!FO_SEEK(@&cObjeto,{cCPoPd,cCpoTipo2},{cCodigo,"I"})   .EN','000010','000000','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCPoPd,cCpoTipo2},{cCodigo,"I"})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','lOk := ( nDiasFe == nDMes)   .END.','000011','000010','.CON.','5','','','5','lOk := ( nDiasFe == nDMes)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','LIF := ( cCodigo $ (FGETCODFOL("0065")+","+FGETCODFOL("006','000012','000011','.CON.','5','','','5','LIF := ( cCodigo $ (FGETCODFOL("0065")+","+FGETCODFOL("0067")) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoData,cCpoSe','000013','000012','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoData,cCpoSeq},{cCodigo,nValorFe,SRR->RR_HORAS,dDtPgFe,cSeq})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','!LIF   .END.','000014','000011','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoData,cCpoSe','000015','000014','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoData,cCpoSeq},{cCodigo,nValorFe,nDMes,dDtPgFe,cSeq})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','lFerTri .and. (nPosFer:= Ascan(aCodFolTra,{|X| x[2] == cCo','000016','000011','.CON.','5','','','5','lFerTri .and. (nPosFer:= Ascan(aCodFolTra,{|X| x[2] == cCodigo .And. x[3] == "F"})) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nValFerMs+= nValorFe     .END.','000017','000016','.EXE.','5','nValFerMs+= nValorFe','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','!lOk   .END.','000018','000010','.CON.','5','','','5','!lOk','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','LiF := ( lSegMes .And. nValPriMes > 0 )   .END.','000019','000018','.CON.','5','','','5','LiF := ( lSegMes .And. nValPriMes > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nValorFeMs := nValorFe - nValPriMes     .END.','000020','000019','.EXE.','5','nValorFeMs := nValorFe - nValPriMes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->RH_DATAFIM) =','000021','000019','.CON.','5','','','5','Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->RH_DATAFIM) == 3 .And. ( Right(cFolMes,2) == "01" .or.  Right(cFolMes,2) == "03")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nValorFeMs := nValorFe / 30 * nDMes     .END.','000022','000021','.EXE.','5','nValorFeMs := nValorFe / 30 * nDMes','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nValorFeMs >0   .END.','000023','000019','.CON.','5','','','5','nValorFeMs >0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoData,cCpoSe','000024','000023','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoData,cCpoSeq},{cCodigo,nValorFeMs,nDMes,dDtPgFe,cSeq})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','!Lif   .END.','000025','000018','.CON.','5','','','5','!Lif','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nValPriMes := Round((nValorFe / nDiasFe)* nDMes, 2)     .CNT','000026','000025','.EXE.','5','nValPriMes := Round((nValorFe / nDiasFe)* nDMes, 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoData,cCpoSe','000027','000025','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoData,cCpoSeq},{cCodigo,nValPriMes,nDMes,dDtPgFe,cSeq})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','lFerTri .and. (nPosFer:= Ascan(aCodFolTra,{|X| x[2] == cCo','000028','000018','.CON.','5','','','5','lFerTri .and. (nPosFer:= Ascan(aCodFolTra,{|X| x[2] == cCodigo .And. x[3] == "F"})) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','nValFerMs+= nValPriMes     .END.','000029','000028','.EXE.','5','nValFerMs+= nValPriMes','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0062    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0062( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAIRS','GRAVACAO IRS','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAIRS','cTipoRot == "1" .Or. cTipoRot == "4"   .END.','000001','000000','.CON.','5','','','5','cTipoRot == "1" .Or. cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','NBASEIRS > 0   .END.','000002','000001','.CON.','5','','','5','NBASEIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0015")','000003','000002','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0015") , NBASEIRS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','NVLIRS > 0   .END.','000004','000001','.CON.','5','','','5','NVLIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000005','000004','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0066") , NVLIRS, NPERIRS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','cTipoRot == "3" .Or. cTipoRot == "4"   .END.','000006','000000','.CON.','5','','','5','cTipoRot == "3" .Or. cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','NBASEIRSFer > 0   .END.','000007','000006','.CON.','5','','','5','NBASEIRSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0016")','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0016") , NBASEIRSFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','NVLIRSFer > 0   .END.','000009','000006','.CON.','5','','','5','NVLIRSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0067") , NVLIRSFer, NPERIRSFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','cTipoRot == "6" .Or. cTipoRot == "4"   .END.','000011','000000','.CON.','5','','','5','cTipoRot == "6" .Or. cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','NBASEIRS13 > 0   .END.','000012','000011','.CON.','5','','','5','NBASEIRS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0027")','000013','000012','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0027") , NBASEIRS13 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','NVLIRS13 > 0   .END.','000014','000011','.CON.','5','','','5','NVLIRS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIRS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000015','000014','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0071") , NVLIRS13, NPERIRS13 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0063    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0063( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVANAT','GRAVA SUBISIDIO DE NATAL','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVANAT','FO_ADD(@&cobjeto,{ccpopd,ccpohoras,ccpovalor},{fgetcodfol("0','000001','000000','.EXE.','5','FO_ADD(@&cobjeto,{ccpopd,ccpohoras,ccpovalor},{fgetcodfol("0024"),ndias13pt,n13sal})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVANAT','N13VALDES > 0   .END.','000002','000000','.CON.','5','','','5','N13VALDES > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVANAT','FO_ADD(@&cobjeto,{ccpopd,ccpovalor},{fgetcodfol("0023"),N13V','000003','000002','.EXE.','5','FO_ADD(@&cobjeto,{ccpopd,ccpovalor},{fgetcodfol("0023"),N13VALDES})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0064    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0064( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASAL','Grava Salario','','000262','054','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASAL','C__ROTEIRO == "PRV"   .END.','000001','000000','.CON.','5','','','5','C__ROTEIRO == "PRV"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','FIMFORMULA()     .END.','000002','000001','.EXE.','5','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','lDiaHora :=GetNewPar('+"'"+'MV_DIAHOR'+"'"+',.T.)     .CNT.','000003','000000','.EXE.','5','lDiaHora :=GetNewPar('+"'"+'MV_DIAHOR'+"'"+',.T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000004','000000','.EXE.','5','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','Salario > 0 .AND.','000005','000000','.CON.','5','','','5','Salario','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','cSitFolh # "D" .END.','000006','000000','.CON.','5','','','5','cSitFolh','#','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','P_CALCINF # "S" .END.','000007','000006','.CON.','5','','','5','P_CALCINF','#','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "M*C*D" .AND.','000008','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*D"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000009','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000010','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0031") , cNumpag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000011','000010','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0031"), "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "P" .AND.','000012','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"P"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000013','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0217") # Space(3) .AND.','000014','000007','.CON.','5','','','5','fGetCodFol("0217")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000015','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0217") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000016','000015','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0217") , "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "A" .AND.','000017','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000018','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0218") # Space(3) .AND.','000019','000007','.CON.','5','','','5','fGetCodFol("0218")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000020','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0218") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000021','000020','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0218") , "V" , nSalPg, Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "E" .AND.','000022','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"E"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000023','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0219") # Space(3) .AND.','000024','000007','.CON.','5','','','5','fGetCodFol("0219")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000025','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0219") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000026','000025','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0219") , "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "H" .AND.','000027','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000028','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0032") # SPACE(3) .AND.','000029','000007','.CON.','5','','','5','fGetCodFol("0032")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0033") = SPACE(3) .AND.','000030','000007','.CON.','5','','','5','fGetCodFol("0033")','=','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032")}, .T.)','000031','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000032','000031','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg+nDsr , nHorastrab+nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "G" .AND.','000033','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"G"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000034','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0220") # SPACE(3) .AND.','000035','000007','.CON.','5','','','5','fGetCodFol("0220")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0220")}, .T.)','000036','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0220")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000037','000036','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0220") , "V" , nSalPg+nDsr , nHorastrab+nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "H" .AND.','000038','000007','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000039','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0032") # SPACE(3) .AND.','000040','000007','.CON.','5','','','5','fGetCodFol("0032")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0033") # SPACE(3) .END.','000041','000007','.CON.','5','','','5','fGetCodFol("0033")','#','5','SPACE(3)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032") }, .T.)','000042','000041','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032") }, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000043','000042','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg, nHorastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0033")}, .T.)','000044','000041','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0033")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000045','000044','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0033") , "V" , nDsr, nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "S" .AND.','000046','000007','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000047','000007','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0032") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000048','000047','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg, Diastrab })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000049','000047','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0033") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000050','000049','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0033") , "V" , nDsr, nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0065    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0065( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASRC','GRAVA ASIENTOS','','000014','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASRC','!lDissidio   .END.','000001','000000','.CON.','5','','','5','!lDissidio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASRC','PUTSRC()     .END.','000002','000001','.EXE.','5','PUTSRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0066    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0066( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASRF','GRAVA OBJETO SRF','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASRF','FO_PUT(@oSRF)     .END.','000001','000000','.EXE.','5','FO_PUT(@oSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0067    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0067( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASS','GRAVA SEGURO SOCIAL VENCIMENTO','','','019','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASS','nVlSSFun > 0   .END.','000001','000000','.CON.','5','','','5','nVlSSFun > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0064") , nVlSSFun, NPERSSFUN } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nVlSSEmpr > 0   .END.','000003','000000','.CON.','5','','','5','nVlSSEmpr > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0783") , nVlSSEmpr, nPerSSEmp } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nBaseSS > 0   .END.','000005','000000','.CON.','5','','','5','nBaseSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0013")','000006','000005','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0013") , NBASESS },  {CCPOPD ,"GDDELETED"}, {FGETCODFOL("0013"),.F.}  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nVlSSFer > 0   .END.','000007','000000','.CON.','5','','','5','nVlSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0065") , nVlSSFer, NPERSSFUN } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nBaseSSFer > 0   .END.','000009','000000','.CON.','5','','','5','nBaseSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0787")','000010','000009','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0787") , nBaseSSFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nVlSS13 > 0   .END.','000011','000000','.CON.','5','','','5','nVlSS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000012','000011','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0070") , nVlSS13, NPERSSFUN } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nVlSSEmp13 > 0   .END.','000013','000000','.CON.','5','','','5','nVlSSEmp13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000014','000013','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0788") , nVlSSEmp13, nPerSSEmp } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nBaseSS13 > 0   .END.','000015','000000','.CON.','5','','','5','nBaseSS13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nVlSSEmpr > 0   .END.','000016','000015','.CON.','5','','','5','nVlSSEmpr > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000017','000016','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0783") , nVlSSEmpr, nPerSSEmp } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','nBaseSS > 0   .END.','000018','000015','.CON.','5','','','5','nBaseSS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0013")','000019','000018','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0013") , nBaseSS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASS','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0019")','000020','000015','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0019") , nBaseSS13 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0068    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0068( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASSF','GRAVA SEGURO SOCIAL FERIAS','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASSF','nVlSSFer > 0   .END.','000001','000000','.CON.','5','','','5','nVlSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASSF','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0065") , nVlSSFer, NPERSSFUN } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASSF','nBaseSSFer > 0   .END.','000003','000000','.CON.','5','','','5','nBaseSSFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASSF','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0787")','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0787") , nBaseSSFer } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0069    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0069( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASUB','GRAVA SUBSIDIO REFEICAO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASUB','nSubsIsent > 0   .END.','000001','000000','.CON.','5','','','5','nSubsIsent > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASUB','fo_Add(@&cObjeto,{cCpoPd, cCpoValor, cCpoHoras}, { fGetCodFo','000002','000001','.EXE.','5','fo_Add(@&cObjeto,{cCpoPd, cCpoValor, cCpoHoras}, { fGetCodFol("0784"),  nSubsIsent, nDiasSub } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASUB','nSubsTrib > 0   .END.','000003','000000','.CON.','5','','','5','nSubsTrib > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASUB','fo_Add(@&cObjeto,{cCpoPd, cCpoValor, cCpoHoras},{fGetCodFol(','000004','000003','.EXE.','5','fo_Add(@&cObjeto,{cCpoPd, cCpoValor, cCpoHoras},{fGetCodFol("0785"),  nSubsTrib, nDiasSub } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0070    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0070( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVLIQU','GRAVACAO DO LIQUIDO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVLIQU','nVlr_ins > 0 .END.','000001','000000','.CON.','5','','','5','nVlr_ins','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor } , { cCodIns , nVlr_in','000002','000001','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor } , { cCodIns , nVlr_ins } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','nVal_Arre > 0 .END.','000003','000000','.CON.','5','','','5','nVal_Arre','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {cCodArred , nVal_Arr','000004','000003','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {cCodArred , nVal_Arre} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','! FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto } , { cCodLiq, cN','000005','000000','.CON.','5','','','5','! FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto } , { cCodLiq, cNumpag } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','cPaisLoc == "BRA"   .END.','000006','000005','.CON.','5','','','5','cPaisLoc == "BRA"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT <> "9"   .END.','000007','000006','.CON.','5','','','5','CTIPOROT <> "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor} , { cCodLiq , nLiquido','000008','000007','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor} , { cCodLiq , nLiquido} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT == "9"   .END.','000009','000006','.CON.','5','','','5','CTIPOROT == "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor,cCpoData, cCpoDtRef} ,','000010','000009','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor,cCpoData, cCpoDtRef} , {cCodLiq , nLiquido, dData_Pgto, dData_Pgto} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','cPaisLoc <>  "BRA"   .END.','000011','000005','.CON.','5','','','5','cPaisLoc <>  "BRA"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor, cCpoData } , { cCodLiq','000012','000011','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor, cCpoData } , { cCodLiq, nLiquido, dData_Pgto } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0071    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0071( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVSIND','GRAVA CONTRIBUICAO SINDICAL','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVSIND','lDescSin == .T. .END.','000001','000000','.CON.','5','','','5','lDescSin','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSIND','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor} , { FGETCODFOL("0068")','000002','000001','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor} , { FGETCODFOL("0068") , nContri } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0072    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0072( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRGARACO','GRAVA GARANTIA DE COMISSAO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GRGARACO','NVLCOMISSA > 0 .END.','000001','000000','.CON.','5','','','5','NVLCOMISSA','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','cTipoRot == "1" .END.','000002','000001','.CON.','5','','','5','cTipoRot','==','5','"1"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {FGETCODFOL("0347"),','000003','000002','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {FGETCODFOL("0347"), NVLCOMISSA } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','cTipoRot  == "3" .and. !FO_SEEK(@&cObjeto, {cCpoPD, cCpoTi','000004','000001','.CON.','5','','','5','cTipoRot  == "3" .and. !FO_SEEK(@&cObjeto, {cCpoPD, cCpoTipo2}, {FGETCODFOL("0072"), "I"})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0072"','000005','000004','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0072") , NVLCOMISSA} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','cTipoRot == "5" .END.','000006','000001','.CON.','5','','','5','cTipoRot','==','5','"5"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0022"','000007','000006','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0022") , NVLCOMISSA} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','cTipoRot == "6" .END.','000008','000001','.CON.','5','','','5','cTipoRot','==','5','"6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0024"','000009','000008','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0024") , NVLCOMISSA } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0073    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0073( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVABOFL','GRAVA ABONO POR FALHAS','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVABOFL','nAboFalIsent > 0   .END.','000001','000000','.CON.','5','','','5','nAboFalIsent > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVABOFL','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("0494"), nAboFalIsent, nPercAboFal } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVABOFL','nAboFalTrib > 0 .And. ( FGETCODFOL("0495")<>SPACE(3) )   .','000003','000000','.CON.','5','','','5','nAboFalTrib > 0 .And. ( FGETCODFOL("0495")<>SPACE(3) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVABOFL','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000004','000003','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("0495"), nAboFalTrib, nPercAboFal } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0074    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0074( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVAJCUS','GRAVA AJUDA DE CUSTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVAJCUS','(nAjCusPtIsent > 0 .And. ( FGETCODFOL("1197")<>SPACE(3) )','000001','000000','.CON.','5','','','5','(nAjCusPtIsent > 0 .And. ( FGETCODFOL("1197")<>SPACE(3) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAJCUS','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("1197"), nAjCusPtIsent, nRefAjCusPt } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAJCUS','( nAjCusPtTrib > 0 .AND. ( FGETCODFOL("1198")<>SPACE(3) )','000003','000000','.CON.','5','','','5','( nAjCusPtTrib > 0 .AND. ( FGETCODFOL("1198")<>SPACE(3) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAJCUS','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000004','000003','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("1198"), nAjCusPtTrib, nRefAjCusPt } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAJCUS','( nAjCusExIsent > 0 .AND. ( FGETCODFOL("1199")<>SPACE(3) )','000005','000000','.CON.','5','','','5','( nAjCusExIsent > 0 .AND. ( FGETCODFOL("1199")<>SPACE(3) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAJCUS','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000006','000005','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("1199"), nAjCusExIsent, nRefAjCusEx } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAJCUS','( nAjCusExTrib > 0 .AND. ( FGETCODFOL("1200")<>SPACE(3) )','000007','000000','.CON.','5','','','5','( nAjCusExTrib > 0 .AND. ( FGETCODFOL("1200")<>SPACE(3) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAJCUS','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000008','000007','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("1200"), nAjCusExTrib, nRefAjCusEx } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0075    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0075( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVASMED','GRAVA ASSIST. MEDICA','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVASMED','( NAMED_TIT + NAMED_DEP + NAMED_AGR + NAMED_EMPT + NAMED_E','000001','000000','.CON.','5','','','5','( NAMED_TIT + NAMED_DEP + NAMED_AGR + NAMED_EMPT + NAMED_EMPD + NAMED_EMPA ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','cVrbFun := FGETCODFOL("049")     .CNT.','000002','000001','.EXE.','5','cVrbFun := FGETCODFOL("049")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','cVrbDep := FGETCODFOL("607")     .CNT.','000003','000001','.EXE.','5','cVrbDep := FGETCODFOL("607")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','cVrbAgr := FGETCODFOL("609")     .CNT.','000004','000001','.EXE.','5','cVrbAgr := FGETCODFOL("609")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','cVrbBsTit := FGETCODFOL("213")     .CNT.','000005','000001','.EXE.','5','cVrbBsTit := FGETCODFOL("213")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','cVrbBsDep := FGETCODFOL("608")     .CNT.','000006','000001','.EXE.','5','cVrbBsDep := FGETCODFOL("608")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','cVrbBsAgr := FGETCODFOL("610")     .CNT.','000007','000001','.EXE.','5','cVrbBsAgr := FGETCODFOL("610")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nValAmed := NAMED_TIT     .CNT.','000008','000001','.EXE.','5','nValAmed := NAMED_TIT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nValEmp := NAMED_EMPT     .CNT.','000009','000001','.EXE.','5','nValEmp := NAMED_EMPT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nRef :=  1     .CNT.','000010','000001','.EXE.','5','nRef :=  1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','EMPTY(cVrbDep)   .END.','000011','000001','.CON.','5','','','5','EMPTY(cVrbDep)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nValAmed += NAMED_DEP     .END.','000012','000011','.EXE.','5','nValAmed += NAMED_DEP','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nRef += NAMED_QTDP     .END.','000013','000011','.EXE.','5','nRef += NAMED_QTDP','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','EMPTY(cVrbBsDep)   .END.','000014','000001','.CON.','5','','','5','EMPTY(cVrbBsDep)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nValEmp += NAMED_EMPD     .END.','000015','000014','.EXE.','5','nValEmp += NAMED_EMPD','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','EMPTY(cVrbAgr)   .END.','000016','000001','.CON.','5','','','5','EMPTY(cVrbAgr)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nValAmed += NAMED_AGR     .CNT.','000017','000016','.EXE.','5','nValAmed += NAMED_AGR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nRef += NAMED_QTAG     .END.','000018','000016','.EXE.','5','nRef += NAMED_QTAG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','EMPTY(cVrbBsAgr)   .END.','000019','000001','.CON.','5','','','5','EMPTY(cVrbBsAgr)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nValEmp += NAMED_EMPA     .END.','000020','000019','.EXE.','5','nValEmp += NAMED_EMPA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nValAmed > 0   .END.','000021','000001','.CON.','5','','','5','nValAmed > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{cVrbFun,nRef,','000022','000021','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{cVrbFun,nRef,nValAmed},cCpoPd,cVrbFun)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','nValEmp > 0   .END.','000023','000001','.CON.','5','','','5','nValEmp > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{cVrbBsTit,nValEmp},cCpo','000024','000023','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{cVrbBsTit,nValEmp},cCpoPd,cVrbBsTit)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','!Empty(cVrbDep)   .END.','000025','000001','.CON.','5','','','5','!Empty(cVrbDep)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{cVrbDep,NAMED','000026','000025','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{cVrbDep,NAMED_QTDP,NAMED_DEP},cCpoPd,cVrbDep)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','!Empty(cVrbBsDep)   .END.','000027','000001','.CON.','5','','','5','!Empty(cVrbBsDep)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{cVrbBsDep,NAMED_EMPD},c','000028','000027','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{cVrbBsDep,NAMED_EMPD},cCpoPd,cVrbBsDep)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','!Empty(cVrbAgr)   .END.','000029','000001','.CON.','5','','','5','!Empty(cVrbAgr)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{cVrbAgr,NAMED','000030','000029','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{cVrbAgr,NAMED_QTAG,NAMED_AGR},cCpoPd,cVrbAgr)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','!Empty(cVrbBsAgr)   .END.','000031','000001','.CON.','5','','','5','!Empty(cVrbBsAgr)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVASMED','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{cVrbBsAgr,NAMED_EMPA},c','000032','000031','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{cVrbBsAgr,NAMED_EMPA},cCpoPD,cVrbBsAgr)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0076    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0076( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVATVPF','GRAVA H. ATIV. PROFESSOR FIXA','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVATVPF','(SRA->RA_CATFUNC $ "I*J") .And.  nBsHrsAtiv > 0   .END.','000001','000000','.CON.','','','','5','(SRA->RA_CATFUNC $ "I*J") .And.  nBsHrsAtiv > 0','','','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVATVPF','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("3','000002','000001','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("317"), aParProf[3]*100,nBsHrsAtiv*aParProf[3]})','','','','','','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0077    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0077( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVATVPV','GRAVA H. ATIV. PROF. VARIAVEL','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVATVPV','(SRA->RA_CATFUNC $ "I*J") .And.  NBSHATVVAR  > 0   .END.','000001','000000','.CON.','','','','5','(SRA->RA_CATFUNC $ "I*J") .And.  NBSHATVVAR  > 0','','','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVATVPV','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("6','000002','000001','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("603"), aParProf[3]*100,NBSHATVVAR *aParProf[3]})','','','','','','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0078    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0078( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVCTSIN','GRAVA COTA SINDICAL','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVCTSIN','nVlCotaSind > 0 .And. ( FGETCODFOL("0068")<>SPACE(3) )   .','000001','000000','.CON.','5','','','5','nVlCotaSind > 0 .And. ( FGETCODFOL("0068")<>SPACE(3) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVCTSIN','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("0068"), nVlCotaSind, nPerCtSind } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVCTSIN','nBsSinFun > 0 .And. ( FGETCODFOL("1206")<>SPACE(3) )   .EN','000003','000000','.CON.','5','','','5','nBsSinFun > 0 .And. ( FGETCODFOL("1206")<>SPACE(3) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVCTSIN','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor},{FGETCODFOL("1206"), nB','000004','000003','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor},{FGETCODFOL("1206"), nBsSinFun } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0079    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0079( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVDISS','GRAVACAO DO DISSIDIO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVDISS','lDissidio   .END.','000001','000000','.CON.','5','','','5','lDissidio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDISS','aPD:= aClone( oSRC:aCols)     .CNT.','000002','000001','.EXE.','5','aPD:= aClone( oSRC:aCols)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDISS','ATOTREGS:= ARRAY(19)     .CNT.','000003','000001','.EXE.','5','ATOTREGS:= ARRAY(19)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDISS','AFILL(ATOTREGS,0)     .CNT.','000004','000001','.EXE.','5','AFILL(ATOTREGS,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDISS','GravaDissidio(aPD,aPDOld)     .END.','000005','000001','.EXE.','5','GravaDissidio(aPD,aPDOld)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0080    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0080( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVDSRTA','GRAVA DSR TAREFEIRO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVDSRTA','LEN(aDsrTarefa) > 0   .END.','000001','000000','.CON.','5','','','5','LEN(aDsrTarefa) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDSRTA','nLinha := 1     .CNT.','000002','000001','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDSRTA','nLinha <= Len(aDsrTarefa)   .END.','000003','000001','.ENQ.','5','','','5','nLinha <= Len(aDsrTarefa)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GRVDSRTA','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoCC},{ADSRTA','000004','000003','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoCC},{ADSRTAREFA[nLinha,1], ADSRTAREFA[nLinha,2],ADSRTAREFA[nLinha,3],ADSRTAREFA[nLinha,4]})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDSRTA','nLinha ++     .END.','000005','000003','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0081    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0081( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVFERNG','GRAVA FERIAS NAO GOZADAS','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVFERNG','nVlFerNGoz > 0 .AND. ( FGETCODFOL("0103") <> SPACE(3) )','000001','000000','.CON.','5','','','5','nVlFerNGoz > 0 .AND. ( FGETCODFOL("0103") <> SPACE(3) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVFERNG','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("0103"), nVlFerNGoz, nQtdFerNGoz } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0082    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0082( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVIRSFE','GRAVACAO IRS FERIAS','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVIRSFE','NBASEIRSFER > 0   .END.','000001','000000','.CON.','5','','','5','NBASEIRSFER > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVIRSFE','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0016")','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR} , { FGETCODFOL("0016") , NBASEIRSFER } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVIRSFE','NVLIRSFER > 0   .END.','000003','000000','.CON.','5','','','5','NVLIRSFER > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVIRSFE','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCOD','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , { FGETCODFOL("0067") , NVLIRSFER, NPERIRS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0083    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0083( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVLIQAD','GERA LIQUIDO ADIANTAMENTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVLIQAD','NVLRTOT > 0   .END.','000001','000000','.CON.','5','','','5','NVLRTOT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVLIQAD','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS, CCPONPAGTO,','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS, CCPONPAGTO, CCPOTIPO1, CCPOTIPO2, CCPODATA},{FGETCODFOL("0546"),NVLRTOT,0,CNUMPAG,"V","A",RCH->RCH_DTPAGO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0084    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0084( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVMEDPT','GRAVA MEDIAS PORTUGAL','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVMEDPT','NX := 1     .CNT.','000001','000000','.EXE.','5','NX := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVMEDPT','NX <= LEN(AMEDIASPTG)   .END.','000002','000000','.ENQ.','5','','','5','NX <= LEN(AMEDIASPTG)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GRVMEDPT','LIF := FO_SEEK(@&COBJETO,{CCPOPD},{AMEDIASPTG[NX,1]})   .E','000003','000002','.CON.','5','','','5','LIF := FO_SEEK(@&COBJETO,{CCPOPD},{AMEDIASPTG[NX,1]})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVMEDPT','FO_SETVAL(@&COBJETO,CCPOHORAS,FO_GETVAL(@&COBJETO,CCPOHORAS)','000004','000003','.EXE.','5','FO_SETVAL(@&COBJETO,CCPOHORAS,FO_GETVAL(@&COBJETO,CCPOHORAS)+AMEDIASPTG[NX,2])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVMEDPT','FO_SETVAL(@&COBJETO,CCPOVALOR,FO_GETVAL(@&COBJETO,CCPOVALOR)','000005','000003','.EXE.','5','FO_SETVAL(@&COBJETO,CCPOVALOR,FO_GETVAL(@&COBJETO,CCPOVALOR)+AMEDIASPTG[NX,3])','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVMEDPT','!LIF   .END.','000006','000002','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVMEDPT','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {AMEDIASPTG[','000007','000006','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {AMEDIASPTG[NX,1], AMEDIASPTG[NX,2], AMEDIASPTG[NX,3]})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVMEDPT','NX++     .END.','000008','000002','.EXE.','5','NX++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0085    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0085( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVSBTUR','GRAVA SUBSIDIO DE TURNO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVSBTUR','nVlSubTurno > 0   .END.','000001','000000','.CON.','5','','','5','nVlSubTurno > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSBTUR','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL(','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor, cCpoHoras},{FGETCODFOL("0469"), nVlSubTurno, nRefSubTur } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0086    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0086( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVSEGUR','GRAVA SEGURO DE VIDA','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVSEGUR','(NSEGURO+NSEGEMP+SEGURO_B) > 0   .END.','000001','000000','.CON.','5','','','5','(NSEGURO+NSEGEMP+SEGURO_B) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','cVrbFun := FGETCODFOL("153")     .CNT.','000002','000001','.EXE.','5','cVrbFun := FGETCODFOL("153")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','cVrbEmp := FGETCODFOL("154")     .CNT.','000003','000001','.EXE.','5','cVrbEmp := FGETCODFOL("154")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','cVrbBase := FGETCODFOL("155")     .CNT.','000004','000001','.EXE.','5','cVrbBase := FGETCODFOL("155")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','NSEGURO > 0   .END.','000005','000001','.CON.','5','','','5','NSEGURO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','FO_ADD(@&cObjeto,{cCpoPd,cCpovalor},{cVrbFun,NSEGURO})     .','000006','000005','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpovalor},{cVrbFun,NSEGURO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','NSEGEMP > 0   .END.','000007','000001','.CON.','5','','','5','NSEGEMP > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','FO_ADD(@&cObjeto,{cCpoPd,cCpovalor},{cVrbEmp,NSEGEMP})     .','000008','000007','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpovalor},{cVrbEmp,NSEGEMP})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','SEGURO_B > 0   .END.','000009','000001','.CON.','5','','','5','SEGURO_B > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVSEGUR','FO_ADD(@&cObjeto,{cCpoPd,cCpovalor},{cVrbBase,SEGURO_B})','000010','000009','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpovalor},{cVrbBase,SEGURO_B})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0087    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0087( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVTAREF','GRAVA TAREFAS DO SRO','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVTAREF','nLinha := 1     .CNT.','000001','000000','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVTAREF','nLinha <= Len(aTarefas)   .END.','000002','000000','.ENQ.','5','','','5','nLinha <= Len(aTarefas)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GRVTAREF','aTarefas[nLinha,8] == "SRO"   .END.','000003','000002','.CON.','5','','','5','aTarefas[nLinha,8] == "SRO"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVTAREF','FO_ADD(@&cObjeto,{cCpoPd,cCpoQtdSem,cCpoHoras,cCpoValor,cCpo','000004','000003','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoQtdSem,cCpoHoras,cCpoValor,cCpoCC},{aTarefas[nLinha,1],aTarefas[nLinha,3],aTarefas[nLinha,4],aTarefas[nLinha,2],aTarefas[nLinha,5]})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVTAREF','nLinha ++     .END.','000005','000002','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0088    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0088( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','INCAPTEM','CALCULO INCAPACIDADE TEMPORARIO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','INCAPTEM','nx := 1     .CNT.','000001','000000','.EXE.','5','nx := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INCAPTEM','nValorProp := 0     .CNT.','000002','000000','.EXE.','5','nValorProp := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INCAPTEM','Len(aIncapTemp) > 0   .END.','000003','000000','.CON.','5','','','5','Len(aIncapTemp) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INCAPTEM','nx <= Len(aIncapTemp)   .END.','000004','000003','.ENQ.','5','','','5','nx <= Len(aIncapTemp)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','INCAPTEM','FO_SEEK(@&COBJETO, {CCPOPD, CCPOPER, CCPONPAGTO} , {aIncap','000005','000004','.CON.','5','','','5','FO_SEEK(@&COBJETO, {CCPOPD, CCPOPER, CCPONPAGTO} , {aIncapTemp[nx,1], aIncapTemp[nx,2], aIncapTemp[nx,3]  } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INCAPTEM','nValorProp := (fo_GetVal(@&cObjeto, cCpoValor) * aIncapTemp[','000006','000005','.EXE.','5','nValorProp := (fo_GetVal(@&cObjeto, cCpoValor) * aIncapTemp[nx,4] ) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INCAPTEM','nValorProp > 0   .END.','000007','000005','.CON.','5','','','5','nValorProp > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INCAPTEM','fo_SetVal(@&cObjeto, cCpoValor, nValorProp )     .END.','000008','000007','.EXE.','5','fo_SetVal(@&cObjeto, cCpoValor, nValorProp )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INCAPTEM','nx := nx + 1     .END.','000009','000004','.EXE.','5','nx := nx + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0089    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0089( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','INDEMNIZ','CALCULO DE INDEMNIZACAO NA RESCISAO','','','021','2','1',} )

aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR := 0     .CNT.','000001','000000','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALEXC := 0     .CNT.','000002','000000','.EXE.','5','NVALEXC := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','CVERBA := FGETCODFOL("0110")     .CNT.','000003','000000','.EXE.','5','CVERBA := FGETCODFOL("0110")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','CVBEXC := FGETCODFOL("1212")     .CNT.','000004','000000','.EXE.','5','CVBEXC := FGETCODFOL("1212")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','CINDENIZ := FTABELA("S021",VAL(CTIPRES),10)     .CNT.','000005','000000','.EXE.','5','CINDENIZ := FTABELA("S021",VAL(CTIPRES),10)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NANTIG :=  DATEDIFFMONTH( SRA->RA_ADMISSA , DDATADEM )     .','000006','000000','.EXE.','5','NANTIG :=  DATEDIFFMONTH( SRA->RA_ADMISSA , DDATADEM )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','!Empty( CINDENIZ )   .END.','000007','000000','.CON.','5','','','5','!Empty( CINDENIZ )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NLIN := FPOSTAB("S033", CINDENIZ , "=" , 4 )     .CNT.','000008','000007','.EXE.','5','NLIN := FPOSTAB("S033", CINDENIZ , "=" , 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NLIN > 0   .END.','000009','000007','.CON.','5','','','5','NLIN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NDIASRETRIB := FTABELA( "S033" , NLIN , 6 )     .CNT.','000010','000009','.EXE.','5','NDIASRETRIB := FTABELA( "S033" , NLIN , 6 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NANTIGATEM := FTABELA( "S033" , NLIN , 7 )     .CNT.','000011','000009','.EXE.','5','NANTIGATEM := FTABELA( "S033" , NLIN , 7 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NANTIGATEA := FTABELA( "S033" , NLIN , 8 )     .CNT.','000012','000009','.EXE.','5','NANTIGATEA := FTABELA( "S033" , NLIN , 8 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NMINIMOPAG := FTABELA( "S033" , NLIN , 9 )     .CNT.','000013','000009','.EXE.','5','NMINIMOPAG := FTABELA( "S033" , NLIN , 9 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','CINDENIZ == "01"   .END.','000014','000009','.CON.','5','','','5','CINDENIZ == "01"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR := (SALMES / 30)     .CNT.','000015','000014','.EXE.','5','NVALOR := (SALMES / 30)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NDIASRETRIB > 0   .END.','000016','000014','.CON.','5','','','5','NDIASRETRIB > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR *= NDIASRETRIB     .END.','000017','000016','.EXE.','5','NVALOR *= NDIASRETRIB','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NANTIGATEM > 0  .AND. NANTIG >=  NANTIGATEM   .END.','000018','000014','.CON.','5','','','5','NANTIGATEM > 0  .AND. NANTIG >=  NANTIGATEM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR *= NANTIGATEM     .END.','000019','000018','.EXE.','5','NVALOR *= NANTIGATEM','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','CINDENIZ $ "02|03|04"   .END.','000020','000009','.CON.','5','','','5','CINDENIZ $ "02|03|04"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','( NANTIG / 12 ) >= NANTIGATEA   .END.','000021','000020','.CON.','5','','','5','( NANTIG / 12 ) >= NANTIGATEA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR := SALMES  * NANTIGATEA     .END.','000022','000021','.EXE.','5','NVALOR := SALMES  * NANTIGATEA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','CINDENIZ $ "05|06|07"   .END.','000023','000009','.CON.','5','','','5','CINDENIZ $ "05|06|07"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','( NANTIG / 12 ) >= NANTIGATEA   .END.','000024','000023','.CON.','5','','','5','( NANTIG / 12 ) >= NANTIGATEA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR := SALMES  * NANTIGATEA     .END.','000025','000024','.EXE.','5','NVALOR := SALMES  * NANTIGATEA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','CINDENIZ == "08"   .END.','000026','000009','.CON.','5','','','5','CINDENIZ == "08"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NDIASRETRIB > 0   .END.','000027','000026','.CON.','5','','','5','NDIASRETRIB > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR *= NDIASRETRIB     .END.','000028','000027','.EXE.','5','NVALOR *= NDIASRETRIB','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','(NANTIG / 12) >=  NANTIGATEA   .END.','000029','000026','.CON.','5','','','5','(NANTIG / 12) >=  NANTIGATEA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR *= NANTIGATEA     .END.','000030','000029','.EXE.','5','NVALOR *= NANTIGATEA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NMINIMOPAG > NVALOR   .END.','000031','000009','.CON.','5','','','5','NMINIMOPAG > NVALOR','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR := NMINIMOPAG     .END.','000032','000031','.EXE.','5','NVALOR := NMINIMOPAG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR > P_INDEMIRS .AND. P_INDEMIRS > 0   .END.','000033','000009','.CON.','5','','','5','NVALOR > P_INDEMIRS .AND. P_INDEMIRS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALEXC := NVALOR - P_INDEMIRS     .CNT.','000034','000033','.EXE.','5','NVALEXC := NVALOR - P_INDEMIRS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR := P_INDEMIRS     .END.','000035','000033','.EXE.','5','NVALOR := P_INDEMIRS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALEXC > 0 .AND. !EMPTY(CVBEXC)   .END.','000036','000009','.CON.','5','','','5','NVALEXC > 0 .AND. !EMPTY(CVBEXC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {CVBEXC,NANT','000037','000036','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {CVBEXC,NANTIG,NVALEXC})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','NVALOR > 0 .AND. !EMPTY(CVERBA)   .END.','000038','000009','.CON.','5','','','5','NVALOR > 0 .AND. !EMPTY(CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INDEMNIZ','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {CVERBA,NANT','000039','000038','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,CCPOHORAS,CCPOVALOR}, {CVERBA,NANTIG,NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0090    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0090( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LIQUIADI','LIQUIDO DO ADIANTAMENTO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI := 0     .CNT.','000001','000000','.EXE.','5','NLIQADI := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NPROVADI:=0     .CNT.','000002','000000','.EXE.','5','NPROVADI:=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NDESCADI:=0     .CNT.','000003','000000','.EXE.','5','NDESCADI:=0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NVLRTOT := 0     .CNT.','000004','000000','.EXE.','5','NVLRTOT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_GOTOP(@&COBJETO)     .CNT.','000005','000000','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','!FO_EOF(@&COBJETO)   .END.','000006','000000','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_GETVAL(@&COBJETO,CCPOPD) <> FGETCODFOL("0006")   .AND.','000007','000006','.CON.','5','','','5','FO_GETVAL(@&COBJETO,CCPOPD) <> FGETCODFOL("0006")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','!FO_DELETED(@&COBJETO)   .AND.','000008','000006','.CON.','5','','','5','!FO_DELETED(@&COBJETO)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD), SRA->RA_FILIAL, "RV_AD','000009','000006','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD), SRA->RA_FILIAL, "RV_ADIANTA"  == "S")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPO','000010','000009','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPOCOD")=="1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NPROVADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT.','000011','000010','.EXE.','5','NPROVADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI+=NPROVADI     .END.','000012','000010','.EXE.','5','NLIQADI+=NPROVADI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPO','000013','000009','.CON.','5','','','5','POSSRV(FO_GETVAL(@&COBJETO,CCPOPD),SRA->RA_FILIAL,"RV_TIPOCOD")=="2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NDESCADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)     .CNT.','000014','000013','.EXE.','5','NDESCADI:=FO_GETVAL(@&COBJETO,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NLIQADI-=NDESCADI     .END.','000015','000013','.EXE.','5','NLIQADI-=NDESCADI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','FO_SKIP(@&COBJETO)     .END.','000016','000006','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LIQUIADI','NVLRTOT := NLIQADI + VAL_ADTO     .END.','000017','000000','.EXE.','5','NVLRTOT := NLIQADI + VAL_ADTO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0091    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0091( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','MEDCOMIS','CALCULA MEDIA DE COMISSAO','','001063','035','2','1',} )

aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','Type("nMesMedDoe") = "U" .OR.','000002','000000','.CON.','5','','','5','Type("nMesMedDoe")','=','5','"U"','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','Type("nMesMedAci") = "U" .OR.','000003','000000','.CON.','5','','','5','Type("nMesMedAci")','=','5','"U"','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','Type("nMesMedMat") = "U" .END.','000004','000000','.CON.','5','','','5','Type("nMesMedMat")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMesMedDoe := nMesMedAci := nMesMedMat := 0     .END.','000005','000004','.EXE.','5','nMesMedDoe := nMesMedAci := nMesMedMat := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nDiasAfas > 0 .END.','000006','000000','.CON.','5','','','5','nDiasAfas','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMesMedDoe > 0 .END.','000007','000006','.CON.','5','','','5','nMesMedDoe','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fCMComiss(,@nMedComiss,nMesMedDoe)     .CNT.','000008','000007','.EXE.','5','fCMComiss(,@nMedComiss,nMesMedDoe)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := (nMedComiss / 30 * nDiasAfas)     .CNT.','000009','000007','.EXE.','5','nValor := (nMedComiss / 30 * nDiasAfas)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor>0   .END.','000010','000007','.CON.','5','','','5','nValor>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras},','000011','000010','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras}, {fGetCodFol("0407"), "V", nValor, nDiasAfas})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMesMedAci > 0 .END.','000012','000006','.CON.','5','','','5','nMesMedAci','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fCMComiss(,@nMedComiss,nMesMedAci)     .CNT.','000013','000012','.EXE.','5','fCMComiss(,@nMedComiss,nMesMedAci)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := nValor + (nMedComiss / 30 * nDiasAfas)   .CNT.','000014','000012','.EXE.','5','nValor',':=','5','nValor + (nMedComiss / 30 * nDiasAfas)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor>0   .END.','000015','000012','.CON.','5','','','5','nValor>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras},','000016','000015','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras}, {fGetCodFol("0407"), "V", nValor, nDiasAfas})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','(nMesMedMat > 0) .And. ( SRA->RA_CATFUNC $ "C*T" )   .END.','000017','000006','.CON.','5','','','5','(nMesMedMat > 0) .And. ( SRA->RA_CATFUNC $ "C*T" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fCMComiss(,@nMedComiss,nMesMedMat)     .CNT.','000018','000017','.EXE.','5','fCMComiss(,@nMedComiss,nMesMedMat)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := nValor + (nMedComiss / 30 * nDiasAfas)   .CNT.','000019','000017','.EXE.','5','nValor',':=','5','nValor + (nMedComiss / 30 * nDiasAfas)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor>0   .END.','000020','000017','.CON.','5','','','5','nValor>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras},','000021','000020','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras}, {fGetCodFol("0407"), "V", nValor, nDiasAfas})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Seek(@&cObjeto, cCpoPD, fGetCodFol("0040"))   .AND.','000022','000006','.CON.','5','','','5','fo_Seek(@&cObjeto, cCpoPD, fGetCodFol("0040"))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','!( SRA->RA_CATFUNC $ "C*T" )   .AND.','000023','000006','.CON.','5','','','5','!( SRA->RA_CATFUNC $ "C*T" )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','!fo_Seek(@&cObjeto, cCpoPD, fGetCodFol("0407"))   .END.','000024','000006','.CON.','5','','','5','!fo_Seek(@&cObjeto, cCpoPD, fGetCodFol("0407"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fCMComiss(,@nMedComiss,If(nMesMedMat==0,6,nMesMedMat), { ||','000025','000024','.EXE.','5','fCMComiss(,@nMedComiss,If(nMesMedMat==0,6,nMesMedMat), { || "S" $ RV_MEDFER .Or. Val(RV_MEDFER) > 0 })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := nValor + (nMedComiss / 30 * nDiasAfas)   .CNT.','000026','000024','.EXE.','5','nValor',':=','5','nValor + (nMedComiss / 30 * nDiasAfas)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor>0   .END.','000027','000024','.CON.','5','','','5','nValor>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras},','000028','000027','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras}, {fGetCodFol("0407"), "V", nValor, nDiasAfas})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nDiasFgts > 0 .END.','000029','000000','.CON.','5','','','5','nDiasFgts','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nAfasFgts := SalDia * nDiasFgts   .CNT.','000030','000029','.EXE.','5','nAfasFgts',':=','5','SalDia * nDiasFgts','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','SRA->RA_CATFUNC == "C" .END.','000031','000029','.CON.','5','','','5','SRA->RA_CATFUNC','==','5','"C"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','(nDiasAfas - nDiasFgts) > 0 .END.','000032','000031','.CON.','5','','','5','(nDiasAfas - nDiasFgts)','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMedComiss += nMedComiss / 30 * ( nDiasAfas - nDiasFgts)   .','000033','000032','.EXE.','5','nMedComiss','+=','5','nMedComiss / 30 * ( nDiasAfas - nDiasFgts)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','!((nDiasAfas - nDiasFgts) > 0)   .END.','000034','000031','.CON.','5','','','5','!((nDiasAfas - nDiasFgts) > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMedComiss += nMedComiss / 30 * nDiasFgts   .END.','000035','000034','.EXE.','5','nMedComiss','+=','5','nMedComiss / 30 * nDiasFgts','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nAfasFgts += nMedComiss   .END.','000036','000031','.EXE.','5','nAfasFgts','+=','5','nMedComiss','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0092    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0092( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','MESESCON','QTDE DE MESES POR CONTRATO','','','011','2','1',} )

aAdd(aRc3Cols, { '','S_','MESESCON','LIF := FPOSREG("RGE", 1, SRA->RA_FILIAL + SRA->RA_MAT + SR','000001','000000','.CON.','5','','','5','LIF := FPOSREG("RGE", 1, SRA->RA_FILIAL + SRA->RA_MAT + SRA->RA_TIPOCO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MESESCON','DINICIO := RGE->RGE_DATAIN     .END.','000002','000001','.EXE.','5','DINICIO := RGE->RGE_DATAIN','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MESESCON','!LIF   .END.','000003','000000','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MESESCON','DINICIO := SRA->RA_DATAINI     .END.','000004','000003','.EXE.','5','DINICIO := SRA->RA_DATAINI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MESESCON','DFIM := DDATADEM     .CNT.','000005','000000','.EXE.','5','DFIM := DDATADEM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MESESCON','NMESESCON := DateDiffMonth( DINICIO , DFIM ) + 1     .END.','000006','000000','.EXE.','5','NMESESCON := DateDiffMonth( DINICIO , DFIM ) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0093    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0093( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','NATPROPO','SUBSIDIO DE NATAL PROPORCIONAL','','','016','2','1',} )

aAdd(aRc3Cols, { '','S_','NATPROPO','FTABELA("S021",VAL(CTIPRES),9) == "S"   .END.','000001','000000','.CON.','5','','','5','FTABELA("S021",VAL(CTIPRES),9) == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','DDTINI := MAX( SRA->RA_ADMISSA , CTOD("01/01/"+SUBSTR(CANOME','000002','000001','.EXE.','5','DDTINI := MAX( SRA->RA_ADMISSA , CTOD("01/01/"+SUBSTR(CANOMES,1,4) ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','DDTFIM := DDATADEM     .CNT.','000003','000001','.EXE.','5','DDTFIM := DDATADEM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','DAY(DDTINI) <> 1   .END.','000004','000001','.CON.','5','','','5','DAY(DDTINI) <> 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','SRA->RA_CATFUNC == "M"   .END.','000005','000004','.CON.','5','','','5','SRA->RA_CATFUNC == "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','NDIASADM := ( ( 30 - DAY(DDTINI) ) + 1 )  / 30     .END.','000006','000005','.EXE.','5','NDIASADM := ( ( 30 - DAY(DDTINI) ) + 1 )  / 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','SRA->RA_CATFUNC <> "M"   .END.','000007','000004','.CON.','5','','','5','SRA->RA_CATFUNC <> "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','NDIASADM := ( ( F_ULTDIA(DDTINI)-DAY(DDTINI) ) + 1 ) / 30','000008','000007','.EXE.','5','NDIASADM := ( ( F_ULTDIA(DDTINI)-DAY(DDTINI) ) + 1 ) / 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','DDTINI := CTOD("01/" + ( STRZERO(MONTH(DDTINI) +1,2) ) +"/"+','000009','000004','.EXE.','5','DDTINI := CTOD("01/" + ( STRZERO(MONTH(DDTINI) +1,2) ) +"/"+ SUBSTR( CANOMES , 1, 4 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','DAY(DDATADEM) < 30   .END.','000010','000001','.CON.','5','','','5','DAY(DDATADEM) < 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','DDTFIM :=CTOD( STRZERO(F_ULTDIA(DDATADEM),2)+"/"+ STRZERO(MO','000011','000010','.EXE.','5','DDTFIM :=CTOD( STRZERO(F_ULTDIA(DDATADEM),2)+"/"+ STRZERO(MONTH(DDATADEM)-1,2)+"/"+SUBSTR( CANOMES , 1 , 4 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','NDIASDEM := DAY(  DDATADEM ) / 30     .END.','000012','000010','.EXE.','5','NDIASDEM := DAY(  DDATADEM ) / 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','NDIASPERPT := IIF( DDTINI < DDTFIM, DATEDIFFMONTH( DDTINI ,','000013','000001','.EXE.','5','NDIASPERPT := IIF( DDTINI < DDTFIM, DATEDIFFMONTH( DDTINI , DDTFIM ) + 1 , 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','NDIASPERPT := NDIASPERPT + NDIASADM + NDIASDEM     .CNT.','000014','000001','.EXE.','5','NDIASPERPT := NDIASPERPT + NDIASADM + NDIASDEM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','CVERBA := FGETCODFOL("0025")     .CNT.','000015','000001','.EXE.','5','CVERBA := FGETCODFOL("0025")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','!EMPTY(CVERBA) .AND. NDIASPERPT > 0   .END.','000016','000001','.CON.','5','','','5','!EMPTY(CVERBA) .AND. NDIASPERPT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','NNATPRO := SALMES / 12 * NDIASPERPT     .CNT.','000017','000016','.EXE.','5','NNATPRO := SALMES / 12 * NDIASPERPT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','NATPROPO','FO_ADD(@&COBJETO,{CCPOPD,CCPOHORAS,CCPOVALOR},{CVERBA,NDIASP','000018','000016','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOHORAS,CCPOVALOR},{CVERBA,NDIASPERPT,NNATPRO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0094    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0094( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PARAMPRV','PARAMETROS PROVISAO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','PARAMPRV','NTIPOPRV := APERGUNTE[1,3]     .END.','000001','000000','.EXE.','5','NTIPOPRV := APERGUNTE[1,3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0095    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0095( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PENVENCT','CALCULO DE PENHORA DE VENCIMENTOS','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','PENVENCT','NVLPENVENC := 0     .CNT.','000001','000000','.EXE.','5','NVLPENVENC := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nValAux := 0     .CNT.','000002','000000','.EXE.','5','nValAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nSalBruto := SRA->RA_SALARIO     .CNT.','000003','000000','.EXE.','5','nSalBruto := SRA->RA_SALARIO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nVlPenAnt := 0     .CNT.','000004','000000','.EXE.','5','nVlPenAnt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','Len(aPenVenc ) > 0   .END.','000005','000000','.CON.','5','','','5','Len(aPenVenc ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','aSort(aPenVenc, NIL, NIL, { |X,Y| X[6] < Y[6] } )     .CNT.','000006','000005','.EXE.','5','aSort(aPenVenc, NIL, NIL, { |X,Y| X[6] < Y[6] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nX := 1     .CNT.','000007','000005','.EXE.','5','nX := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nX <= Len(aPenVenc)   .END.','000008','000005','.ENQ.','5','','','5','nX <= Len(aPenVenc)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nVlNaoPen := IIf ( VAL_SALMIN > ((nSalBruto - nVlPenAnt) / 3','000009','000008','.EXE.','5','nVlNaoPen := IIf ( VAL_SALMIN > ((nSalBruto - nVlPenAnt) / 3) * 2, VAL_SALMIN, ((nSalBruto - nVlPenAnt) / 3) * 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nValAux := nSalBruto - nVlPenAnt - nVlNaoPen     .CNT.','000010','000008','.EXE.','5','nValAux := nSalBruto - nVlPenAnt - nVlNaoPen','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nVlPenVenc := IIF (nValAux < aPenVenc[nx,3], nValAux, aPenVe','000011','000008','.EXE.','5','nVlPenVenc := IIF (nValAux < aPenVenc[nx,3], nValAux, aPenVenc[nx, 3] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nVlPenVenc > 0   .END.','000012','000008','.CON.','5','','','5','nVlPenVenc > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor }, {aPenVenc[nx,1], nVlP','000013','000012','.EXE.','5','FO_ADD(@&COBJETO,{cCpoPd, cCpoValor }, {aPenVenc[nx,1], nVlPenVenc } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nVlPenAnt += nVlPenVenc     .END.','000014','000012','.EXE.','5','nVlPenAnt += nVlPenVenc','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PENVENCT','nX += 1     .END.','000015','000008','.EXE.','5','nX += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0096    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0096( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROADFER','PROCESSA ADICIONAIS DE FERIAS','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','PROADFER','S_CARGASRF()     .CNT.','000001','000000','.EXE.','5','S_CARGASRF()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROADFER','S_CARGARG1()     .CNT.','000002','000000','.EXE.','5','S_CARGARG1()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROADFER','S_CALATSGP()     .CNT.','000003','000000','.EXE.','5','S_CALATSGP()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROADFER','S_GRVATS()     .CNT.','000004','000000','.EXE.','5','S_GRVATS()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROADFER','S_PROCRG1()     .CNT.','000005','000000','.EXE.','5','S_PROCRG1()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROADFER','S_PROPADIF()     .END.','000006','000000','.EXE.','5','S_PROPADIF()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0097    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0097( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCRG1','PROCESSAR RG1','','','068','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCRG1','CPDACFIXOS := ""     .CNT.','000001','000000','.EXE.','5','CPDACFIXOS := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','CVERBADIC := FGETCODFOL("001")+"*"+FGETCODFOL("002")+"*"+FGE','000002','000000','.EXE.','5','CVERBADIC := FGETCODFOL("001")+"*"+FGETCODFOL("002")+"*"+FGETCODFOL("003")+"*"+FGETCODFOL("004")+"*"+FGETCODFOL("005")+"*"+FGETCODFOL("036")+"*"+FGETCODFOL("037")+"*"+FGETCODFOL("038")+"*"+FGETCODFOL("039")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPg:= CToD("")     .CNT.','000003','000000','.EXE.','5','dDtFimPg:= CToD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaIniRG1 := 0     .CNT.','000004','000000','.EXE.','5','nDiaIniRG1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := 0     .CNT.','000005','000000','.EXE.','5','nDiaFimRG1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','fo_GoTop( @ORG1)     .CNT.','000006','000000','.EXE.','5','fo_GoTop( @ORG1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!fo_Eof( @ORG1 )   .END.','000007','000000','.ENQ.','5','','','5','!fo_Eof( @ORG1 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_GETVAL(@oRG1,"RG1_AUTOM") = "1"   .END.','000008','000007','.CON.','5','','','5','FO_GETVAL(@oRG1,"RG1_AUTOM") = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtLib := FO_GETVAL(@ORG1,"RG1_LIBPAG")     .CNT.','000009','000008','.EXE.','5','dDtLib := FO_GETVAL(@ORG1,"RG1_LIBPAG")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPg:= fo_GetVal(@oRG1, "RG1_DFIMPG")     .CNT.','000010','000008','.EXE.','5','dDtFimPg:= fo_GetVal(@oRG1, "RG1_DFIMPG")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!EMPTY(dDtLIb) .And. cAnoMes >= MesAno(dDtLib)   .END.','000011','000008','.CON.','5','','','5','!EMPTY(dDtLIb) .And. cAnoMes >= MesAno(dDtLib)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cVerba := fo_GetVal( @ORG1 , "RG1_PD")     .CNT.','000012','000011','.EXE.','5','cVerba := fo_GetVal( @ORG1 , "RG1_PD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc := fo_GetVal( @ORG1 , "RG1_TPCALC")     .CNT.','000013','000011','.EXE.','5','cTpcalc := fo_GetVal( @ORG1 , "RG1_TPCALC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nRef := fo_GetVal( @ORG1 , "RG1_REFER")     .CNT.','000014','000011','.EXE.','5','nRef := fo_GetVal( @ORG1 , "RG1_REFER")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','PosSrv(cVerba,SRA->RA_FILIAL)     .CNT.','000015','000011','.EXE.','5','PosSrv(cVerba,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nPercVrb := If (SRV->RV_PERC=0,100,SRV->RV_PERC)     .CNT.','000016','000011','.EXE.','5','nPercVrb := If (SRV->RV_PERC=0,100,SRV->RV_PERC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cCodCor := SRV->RV_CODCORR     .CNT.','000017','000011','.EXE.','5','cCodCor := SRV->RV_CODCORR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','Lincorp := IF ( SRV->RV_INCORP ="S",.T.,.F.)     .CNT.','000018','000011','.EXE.','5','Lincorp := IF ( SRV->RV_INCORP ="S",.T.,.F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp := FO_GETVAL(@ORG1,"RG1_PROP")     .CNT.','000019','000011','.EXE.','5','cProp := FO_GETVAL(@ORG1,"RG1_PROP")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp := IF( ( cProp == "1" .And. ( !lIncorp .Or. DiasTrab >','000020','000011','.EXE.','5','cProp := IF( ( cProp == "1" .And. ( !lIncorp .Or. DiasTrab >= 30 ) .And. !( cVerba $ cVerbAdic ) ) .OR. ( cProp == "2" .And. cAfaPagto == "S" ) ,"S","N")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .f.     .CNT.','000021','000011','.EXE.','5','lGravaRg1 := .f.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cCc := FO_GETVAL(@oRG1,"RG1_CC")     .CNT.','000022','000011','.EXE.','5','cCc := FO_GETVAL(@oRG1,"RG1_CC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValTab := 0     .CNT.','000023','000011','.EXE.','5','nValTab := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "1"   .END.','000024','000011','.CON.','5','','','5','cTpcalc == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := FO_GETVAL(@ORG1,"RG1_VALOR")     .CNT.','000025','000024','.EXE.','5','nValor := FO_GETVAL(@ORG1,"RG1_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000026','000024','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "2"   .END.','000027','000011','.CON.','5','','','5','cTpcalc == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * Saldia / 100 * nPercVrb     .CNT.','000028','000027','.EXE.','5','nValor := nRef * Saldia / 100 * nPercVrb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000029','000027','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "3"   .END.','000030','000011','.CON.','5','','','5','cTpcalc == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * SalHora / 100 * nPercVrb     .CNT.','000031','000030','.EXE.','5','nValor := nRef * SalHora / 100 * nPercVrb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000032','000030','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "4"   .END.','000033','000011','.CON.','5','','','5','cTpcalc == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTab := FO_GETVAL(@ORG1,"RG1_CODTAB")     .CNT.','000034','000033','.EXE.','5','cTab := FO_GETVAL(@ORG1,"RG1_CODTAB")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nLin :=FO_GETVAL(@ORG1,"RG1_LINHA")     .CNT.','000035','000033','.EXE.','5','nLin :=FO_GETVAL(@ORG1,"RG1_LINHA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nCol :=FO_GETVAL(@ORG1,"RG1_COLUNA")     .CNT.','000036','000033','.EXE.','5','nCol :=FO_GETVAL(@ORG1,"RG1_COLUNA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValTab := fTabela(cTab,nLin,nCol)     .CNT.','000037','000033','.EXE.','5','nValTab := fTabela(cTab,nLin,nCol)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nRef := If ( nRef = 0,nPercVrb,nRef)     .CNT.','000038','000033','.EXE.','5','nRef := If ( nRef = 0,nPercVrb,nRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','ValType(nValTab) <> "U"   .END.','000039','000033','.CON.','5','','','5','ValType(nValTab) <> "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * nValTab / 100     .CNT.','000040','000039','.EXE.','5','nValor := nRef * nValTab / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000041','000039','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "5"   .END.','000042','000011','.CON.','5','','','5','cTpcalc == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','CPDACFIXOS += fo_GetVal( @ORG1 , "RG1_PD") + "-"     .CNT.','000043','000042','.EXE.','5','CPDACFIXOS += fo_GetVal( @ORG1 , "RG1_PD") + "-"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000044','000042','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "6"   .END.','000045','000011','.CON.','5','','','5','cTpcalc == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * SalMes / 100     .CNT.','000046','000045','.EXE.','5','nValor := nRef * SalMes / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000047','000045','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "7"   .END.','000048','000011','.CON.','5','','','5','cTpcalc == "7"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * VAL_SALMIN / 100     .CNT.','000049','000048','.EXE.','5','nValor := nRef * VAL_SALMIN / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000050','000048','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nTotAdic += nValor     .CNT.','000051','000011','.EXE.','5','nTotAdic += nValor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp == "S"   .END.','000052','000011','.CON.','5','','','5','cProp == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto  := DDATADE     .CNT.','000053','000052','.EXE.','5','dDtIniPgto  := DDATADE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := DDATAATE     .CNT.','000054','000052','.EXE.','5','dDtFimPagto := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtaDem := If( c__roteiro == "RES", GETMEMVAR("RG_DATADEM"),','000055','000052','.EXE.','5','dDtaDem := If( c__roteiro == "RES", GETMEMVAR("RG_DATADEM"), SRA->RA_DEMISSA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( LAdm := ( CANOMES == MesAno(SRA->RA_ADMISSA) ) )   .END.','000056','000052','.CON.','5','','','5','( LAdm := ( CANOMES == MesAno(SRA->RA_ADMISSA) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto := SRA->RA_ADMISSA     .END.','000057','000056','.EXE.','5','dDtIniPgto := SRA->RA_ADMISSA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( CANOMES == MesAno(DDTLIB) )   .END.','000058','000052','.CON.','5','','','5','( CANOMES == MesAno(DDTLIB) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( !LAdm .Or. ( LAdm .And. DDTLIB > SRA->RA_ADMISSA ) )   .','000059','000058','.CON.','5','','','5','( !LAdm .Or. ( LAdm .And. DDTLIB > SRA->RA_ADMISSA ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto := DDTLIB     .END.','000060','000059','.EXE.','5','dDtIniPgto := DDTLIB','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( LDem := ( CANOMES == MesAno(dDtaDem) ) )   .END.','000061','000052','.CON.','5','','','5','( LDem := ( CANOMES == MesAno(dDtaDem) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := dDtaDem     .END.','000062','000061','.EXE.','5','dDtFimPagto := dDtaDem','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( CANOMES == MesAno(DDTFIMPG) )   .END.','000063','000052','.CON.','5','','','5','( CANOMES == MesAno(DDTFIMPG) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( !LDem .Or. ( LDem .And. DDTFIMPG < dDtaDem ) )   .END.','000064','000063','.CON.','5','','','5','( !LDem .Or. ( LDem .And. DDTFIMPG < dDtaDem ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := DDTFIMPG     .END.','000065','000064','.EXE.','5','dDtFimPagto := DDTFIMPG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaIniRG1 := DAY(dDtIniPgto)     .CNT.','000066','000052','.EXE.','5','nDiaIniRG1 := DAY(dDtIniPgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := DAY(dDtFimPagto)     .CNT.','000067','000052','.EXE.','5','nDiaFimRG1 := DAY(dDtFimPagto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .Or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000068','000052','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .Or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .And. P_DIASMES <> "S" )) .And. (nDiaFimRG1 > 30) .And. cVerba # FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := 30     .END.','000069','000068','.EXE.','5','nDiaFimRG1 := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','NREF:= ( nDiaFimRG1 - nDiaIniRG1 + 1 ) - NDIASAFAS     .CNT.','000070','000052','.EXE.','5','NREF:= ( nDiaFimRG1 - nDiaIniRG1 + 1 ) - NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','NVALOR := NVALOR / 30 * MIN(NREF,30)     .END.','000071','000052','.EXE.','5','NVALOR := NVALOR / 30 * MIN(NREF,30)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1   .END.','000072','000011','.CON.','5','','','5','lGravaRg1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc}) .AND. FO_G','000073','000072','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc}) .AND. FO_GETVAL(@&cObjeto,cCpoTipo2) # "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC $ " *1"   .END.','000074','000073','.CON.','5','','','5','SRV->RV_QTDLANC $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)     .CNT.','000075','000074','.EXE.','5','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)     .CNT.','000076','000074','.EXE.','5','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)     .CNT.','000077','000074','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))     .','000078','000074','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC > "1" .AND. NVALOR > 0   .END.','000079','000073','.CON.','5','','','5','SRV->RV_QTDLANC > "1" .AND. NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nSeq := fo_count( @&cObjeto ,cCpoPd , cVerba ) + 1     .CNT.','000080','000079','.EXE.','5','nSeq := fo_count( @&cObjeto ,cCpoPd , cVerba ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cVerb','000081','000079','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cVerba,nRef,Round(nValor,2),Str(nSeq,1)},{cCpoPd,cCpoSeq},{cVerba,Str(nSeq,1)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc})  .and. SR','000082','000072','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc})  .and. SRV->RV_QTDLANC <> "0" .and. (nValor > 0 .or. cTpcalc == "5")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cVerba','000083','000082','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cVerba,nRef,Round(nValor,2),cCc})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!Empty(cCodCor)   .END.','000084','000072','.CON.','5','','','5','!Empty(cCodCor)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','PosSrv(cCodCor,SRA->RA_FILIAL)     .CNT.','000085','000084','.EXE.','5','PosSrv(cCodCor,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})   .END.','000086','000084','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC $ " *1"   .END.','000087','000086','.CON.','5','','','5','SRV->RV_QTDLANC $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)     .CNT.','000088','000087','.EXE.','5','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)     .CNT.','000089','000087','.EXE.','5','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)     .CNT.','000090','000087','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))     .','000091','000087','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC > "1" .And. nValor > 0   .END.','000092','000086','.CON.','5','','','5','SRV->RV_QTDLANC > "1" .And. nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nSeq := fo_count( @&cObjeto ,cCpoPd , cCodCor ) + 1     .CNT','000093','000092','.EXE.','5','nSeq := fo_count( @&cObjeto ,cCpoPd , cCodCor ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cCodC','000094','000092','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cCodCor,nRef,Round(nValor,2),Str(nSeq,1)},{cCpoPd,cCpoSeq},{cCodCor,Str(nSeq,1)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})  .and. S','000095','000084','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})  .and. SRV->RV_QTDLANC <> "0" .and. nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cCodCo','000096','000095','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cCodCor,nRef,Round(nValor,2),cCc})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','fo_Skip( @ORG1 )     .END.','000097','000007','.EXE.','5','fo_Skip( @ORG1 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0098    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0098( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCRGB','PROCESSA INFORMACOES DE RGB PARA SRC','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCRGB','FO_GOTOP(@ORGB)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP(@ORGB)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','!FO_EOF(@ORGB)   .END.','000002','000000','.ENQ.','5','','','5','!FO_EOF(@ORGB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cNPagRGB := fo_GetVal(@oRGB, "RGB_SEMANA")     .CNT.','000003','000002','.EXE.','5','cNPagRGB := fo_GetVal(@oRGB, "RGB_SEMANA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cMatRGB := fo_GetVal(@oRGB, "RGB_MAT")     .CNT.','000004','000002','.EXE.','5','cMatRGB := fo_GetVal(@oRGB, "RGB_MAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cHrRGB := fo_GetVal(@oRGB , "RGB_HORAS")     .CNT.','000005','000002','.EXE.','5','cHrRGB := fo_GetVal(@oRGB , "RGB_HORAS")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','nVlRGB := fo_GetVal(@oRGB , "RGB_VALOR")     .CNT.','000006','000002','.EXE.','5','nVlRGB := fo_GetVal(@oRGB , "RGB_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cCCRGB := fo_GetVal(@oRGB , "RGB_CC")     .CNT.','000007','000002','.EXE.','5','cCCRGB := fo_GetVal(@oRGB , "RGB_CC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cPDRGB := fo_GetVal(@oRGB , "RGB_PD")     .CNT.','000008','000002','.EXE.','5','cPDRGB := fo_GetVal(@oRGB , "RGB_PD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cTp1RGB := fo_GetVal(@oRGB , "RGB_TIPO1")     .CNT.','000009','000002','.EXE.','5','cTp1RGB := fo_GetVal(@oRGB , "RGB_TIPO1")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cTp2RGB := fo_GetVal(@oRGB , "RGB_TIPO2")     .CNT.','000010','000002','.EXE.','5','cTp2RGB := fo_GetVal(@oRGB , "RGB_TIPO2")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cDtRGB := fo_GetVal(@oRGB , "RGB_DTREF")     .CNT.','000011','000002','.EXE.','5','cDtRGB := fo_GetVal(@oRGB , "RGB_DTREF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cParRGB := fo_GetVal(@oRGB , "RGB_PARCEL")     .CNT.','000012','000002','.EXE.','5','cParRGB := fo_GetVal(@oRGB , "RGB_PARCEL")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','cSeqRGB := fo_GetVal(@oRGB , "RGB_SEQ")     .CNT.','000013','000002','.EXE.','5','cSeqRGB := fo_GetVal(@oRGB , "RGB_SEQ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','fo_ADD(@&cObjeto, {cCpoMat,cCpoHoras, cCpoValor, cCpoCC, cCp','000014','000002','.EXE.','5','fo_ADD(@&cObjeto, {cCpoMat,cCpoHoras, cCpoValor, cCpoCC, cCpoPd, cCpoTipo1, cCpoTipo2,cCpoDtRef, cCpoParcel, cCpoSeq},{cMatRGB,cHrRGB,nVlRGB,cCCRGB,cPDRGB,cTp1RGB,cTp2RGB, cDtRGB, cParRGB, cSeqRGB} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRGB','FO_SKIP(@oRGB)     .END.','000015','000002','.EXE.','5','FO_SKIP(@oRGB)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0099    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0099( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSR8','Geracao Ausencias','','000260','091','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSR8','NDIASAFAS := 0     .CNT.','000001','000000','.EXE.','5','NDIASAFAS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Eof(@oSR8)   .END.','000002','000000','.CON.','5','','','5','!fo_Eof(@oSR8)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dFimPer := dDataAte   .CNT.','000003','000002','.EXE.','5','dFimPer',':=','5','dDataAte','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIniFer := dDtFimFer := CTOD("")     .CNT.','000004','000002','.EXE.','5','dDtIniFer := dDtFimFer := CTOD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas := 0     .CNT.','000005','000002','.EXE.','5','nDiasAfas := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nLinha := 0     .CNT.','000006','000002','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','aIncapTemp := {}     .CNT.','000007','000002','.EXE.','5','aIncapTemp := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Eof( @oSR8)   .END.','000008','000002','.ENQ.','5','','','5','!fo_Eof( @oSR8)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nLinha ++     .CNT.','000009','000008','.EXE.','5','nLinha ++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )     .CNT.','000010','000008','.EXE.','5','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDuracao := fo_GetVal( @oSR8 , "R8_DURACAO" , nLinha )     .','000011','000008','.EXE.','5','nDuracao := fo_GetVal( @oSR8 , "R8_DURACAO" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )     .','000012','000008','.EXE.','5','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerbaAfas := FO_GETVAL( @OSR8 , "R8_PD" ,nLinha )     .CNT.','000013','000008','.EXE.','5','cVerbaAfas := FO_GETVAL( @OSR8 , "R8_PD" ,nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoDias := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA",','000014','000008','.EXE.','5','cTipoDias := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", nLinha), SRA->RA_FILIAL, "RCM_TIPODI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", n','000015','000008','.EXE.','5','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", nLinha), SRA->RA_FILIAL, "RCM_TIPOAF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','lInformativo:= (cTipoAfa == "3")     .CNT.','000016','000008','.EXE.','5','lInformativo:= (cTipoAfa == "3")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAfaPer <= cPeriodo .AND.','000017','000008','.CON.','5','','','5','cAfaPer','<=','5','cPeriodo','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','(cAfaNPag <= cNumPag) .And. (!lInformativo)   .END.','000018','000008','.CON.','5','','','5','(cAfaNPag <= cNumPag) .And. (!lInformativo)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )     .CNT.','000019','000018','.EXE.','5','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )     .CNT','000020','000018','.EXE.','5','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )     .CN','000021','000018','.EXE.','5','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','Empty(dDtFim)   .END.','000022','000018','.CON.','5','','','5','Empty(dDtFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFim := dFimPer     .END.','000023','000022','.EXE.','5','dDtFim := dFimPer','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni:= 0     .CNT.','000024','000018','.EXE.','5','nDiaIni:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes == MesAno( dDtIni ) .END.','000025','000018','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtIni )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni := Day( dDtIni )     .END.','000026','000025','.EXE.','5','nDiaIni := Day( dDtIni )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes > MesAno(dDtIni) .END.','000027','000018','.CON.','5','','','5','cAnoMes','>','5','MesAno(dDtIni)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaIni := 1     .END.','000028','000027','.EXE.','5','nDiaIni := 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim:= 0     .CNT.','000029','000018','.EXE.','5','nDiaFim:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes == MesAno( dDtFim ) .END.','000030','000018','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtFim )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := Day( dDtFim )     .END.','000031','000030','.EXE.','5','nDiaFim := Day( dDtFim )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cAnoMes < MesAno(dDtFim) .END.','000032','000018','.CON.','5','','','5','cAnoMes','<','5','MesAno(dDtFim)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := Day(dFimPer)     .END.','000033','000032','.EXE.','5','nDiaFim := Day(dFimPer)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000034','000018','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .and. P_DIASMES <> "S" )) .and. (nDiaFim > 30) .and. cVerbaAfas # FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiaFim := 30     .END.','000035','000034','.EXE.','5','nDiaFim := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIn','000036','000018','.EXE.','5','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIni + 1), 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cTipoDias == "1"   .END.','000037','000018','.CON.','5','','','5','cTipoDias == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDataAux := CTOD(ALLTRIM(STR(NDIAFIM))+"/"+SUBSTR(ANOMES(DDT','000038','000037','.EXE.','5','dDataAux := CTOD(ALLTRIM(STR(NDIAFIM))+"/"+SUBSTR(ANOMES(DDTINI),5,2)+"/"+SUBSTR(ANOMES(DDTINI),1,4) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDIAS -= DATENOWORKDAY(DDTINI, DDATAAUX)     .END.','000039','000037','.EXE.','5','NDIAS -= DATENOWORKDAY(DDTINI, DDATAAUX)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','cVerbaAfas == FGETCODFOL("0786") .And. ( TYPE("P_FERFRA")','000040','000018','.CON.','5','','','5','cVerbaAfas == FGETCODFOL("0786") .And. ( TYPE("P_FERFRA") != "U" .AND. P_FERFRA == "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas += nDias   .END.','000041','000040','.EXE.','5','nDiasAfas','+=','5','nDias','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSdoPagar := fo_GetVal ( @oSR8 , "R8_SDPAGAR" , nLinha )','000042','000018','.EXE.','5','nSdoPagar := fo_GetVal ( @oSR8 , "R8_SDPAGAR" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0   .END.','000043','000018','.CON.','5','','','5','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)     .CN','000044','000043','.EXE.','5','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','MesAno(dDtFimAnt) > MesAno(dDtIni)   .END.','000045','000043','.CON.','5','','','5','MesAno(dDtFimAnt) > MesAno(dDtIni)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LIf:= (Month(dDtIni) = 2)   .END.','000046','000045','.CON.','5','','','5','LIf:= (Month(dDtIni) = 2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2     .END.','000047','000046','.EXE.','5','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LIf   .END.','000048','000045','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni','000049','000048','.EXE.','5','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIn','000050','000043','.EXE.','5','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIni+1,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nDiasAfas-= nDiasNaoAplic     .CNT.','000051','000043','.EXE.','5','nDiasAfas-= nDiasNaoAplic','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','LIf:= (cAnoMes==MesAno(DDTINI))   .END.','000052','000043','.CON.','5','','','5','LIf:= (cAnoMes==MesAno(DDTINI))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nPagarMes:= Max(nDiasAfas-fo_GetVal( @oSR8, "R8_DURACAO", nL','000053','000052','.EXE.','5','nPagarMes:= Max(nDiasAfas-fo_GetVal( @oSR8, "R8_DURACAO", nLinha-1),0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!LIf   .END.','000054','000043','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nPagarMes:= nDiasAfas     .END.','000055','000054','.EXE.','5','nPagarMes:= nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','000056','000043','.EXE.','5','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','NDPAGARPER := NDIAS     .CNT.','000057','000018','.EXE.','5','NDPAGARPER := NDIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','nSeq := fo_count( @&cObjeto , cCpoPD , cVerba ) + 1     .CNT','000058','000018','.EXE.','5','nSeq := fo_count( @&cObjeto , cCpoPD , cVerba ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','!fo_Seek(@&cObjeto, cCpoPD, cVerba) .AND. ! fo_Deleted(@&c','000059','000018','.CON.','5','','','5','!fo_Seek(@&cObjeto, cCpoPD, cVerba) .AND. ! fo_Deleted(@&cObjeto)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoHoras, cCpoSeq}','000060','000059','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoHoras, cCpoSeq} , {cVerba, "D" , nDPagarPer, STR(nSeq, GetSx3Cache( cCpoSeq , "X3_TAMANHO" )) },{cCpoPd, cCpoSeq},{cVerba, STR(nSeq, GetSx3Cache( cCpoSeq , "X3_TAMANHO" ))})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_GetVal(@oSR8, "R8_PERCINC") > 0 .and. fo_GetVal(@oSR8,','000061','000059','.CON.','5','','','5','fo_GetVal(@oSR8, "R8_PERCINC") > 0 .and. fo_GetVal(@oSR8, "R8_PERCINC") <> 100','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','AADD(AINCAPTEMP, { cVerbaAfas, cAfaPer, cAfaNPag, FO_GETVAL(','000062','000061','.EXE.','5','AADD(AINCAPTEMP, { cVerbaAfas, cAfaPer, cAfaNPag, FO_GETVAL(@OSR8, "R8_PERCINC")} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSR8','fo_Skip ( @oSR8 )     .END.','000063','000008','.EXE.','5','fo_Skip ( @oSR8 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0100    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0100( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRC','Valoriza Verbas','','001176','082','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRC','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000001','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lGerRes := If (Type("lGerRes") == "U" .Or. lGerRes == Nil  ,','000002','000000','.EXE.','5','lGerRes',':=','5','If (Type("lGerRes") == "U" .Or. lGerRes == Nil  , .F. , lGerRes)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerbAdic := fGetCodFol("001")+"*"+fGetCodFol("002")+"*"+fGe','000003','000000','.EXE.','5','cVerbAdic := fGetCodFol("001")+"*"+fGetCodFol("002")+"*"+fGetCodFol("003")+"*"+fGetCodFol("004")+"*"+fGetCodFol("005")+"*"+fGetCodFol("036")+"*"+fGetCodFol("037")+"*"+fGetCodFol("038")+"*"+fGetCodFol("039")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp := IIf(c__Roteiro $ "FOL*RES", DiasTrab, NIL)   .C','000004','000000','.EXE.','5','nDiasProp',':=','5','IIf(c__Roteiro $ "FOL*RES", DiasTrab, NIL)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_GoTop(@&cObjeto)     .CNT.','000005','000000','.EXE.','5','fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!fo_Eof( @&cObjeto )   .END.','000006','000000','.CON.','5','','','5','!fo_Eof( @&cObjeto )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha := 1     .CNT.','000007','000006','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSRC := aClone(&cObjeto:aCols)     .CNT.','000008','000006','.EXE.','5','aSRC := aClone(&cObjeto:aCols)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosPD := GdFieldPos(cCpoPD, & (cObjeto + ":aHeader"))     .','000009','000006','.EXE.','5','nPosPD := GdFieldPos(cCpoPD, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosSeq := GdFieldPos(cCpoSeq, & (cObjeto + ":aHeader"))','000010','000006','.EXE.','5','nPosSeq := GdFieldPos(cCpoSeq, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosCC := GdFieldPos(cCpoCC, & (cObjeto + ":aHeader"))     .','000011','000006','.EXE.','5','nPosCC := GdFieldPos(cCpoCC, & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPosDel := GdFieldPos("GDDELETED", & (cObjeto + ":aHeader"))','000012','000006','.EXE.','5','nPosDel := GdFieldPos("GDDELETED", & (cObjeto + ":aHeader"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSort( aSRC ,,, { |x,y| x[ nPosPD ] < y[ nPosPD ] } )     .C','000013','000006','.EXE.','5','aSort( aSRC ,,, { |x,y| x[ nPosPD ] < y[ nPosPD ] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha <= Len(aSRC)   .END.','000014','000006','.ENQ.','5','','','5','nLinha <= Len(aSRC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','aSRC[nLinha, nPosDel] == .F.   .END.','000015','000014','.CON.','5','','','5','aSRC[nLinha, nPosDel] == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Seek(@&cObjeto, {cCpoPD, cCpoCC, cCpoSeq}, {aSRC[nLinha','000016','000015','.CON.','5','','','5','fo_Seek(@&cObjeto, {cCpoPD, cCpoCC, cCpoSeq}, {aSRC[nLinha,nPosPD], aSRC[nLinha,nPosCC], aSRC[nLinha,nPosSeq]})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .F.     .CNT.','000017','000016','.EXE.','5','lValAlterou := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .F.     .CNT.','000018','000016','.EXE.','5','lQtdAlterou := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 := fo_GetVal( @&cObjeto , cCpoTipo2)     .CNT.','000019','000016','.EXE.','5','cTipo2 := fo_GetVal( @&cObjeto , cCpoTipo2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cTipoRot = "1" .AND. cTipo2 $ "R/I" .AND. lGerRes)   .EN','000020','000016','.CON.','5','','','5','!(cTipoRot = "1" .AND. cTipo2 $ "R/I" .AND. lGerRes)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo := fo_GetVal( @&cObjeto , cCpoTipo1)     .CNT.','000021','000020','.EXE.','5','cTipo := fo_GetVal( @&cObjeto , cCpoTipo1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba := fo_GetVal( @&cObjeto , cCpoPD)     .CNT.','000022','000020','.EXE.','5','cVerba := fo_GetVal( @&cObjeto , cCpoPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nPercent := IF (( nPercent := PosSRV(cVerba, SRA->RA_FILIAL,','000023','000020','.EXE.','5','nPercent := IF (( nPercent := PosSRV(cVerba, SRA->RA_FILIAL, "RV_PERC") ) = 0,1,nPercent / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )     .CN','000024','000020','.EXE.','5','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 == "I" .END.','000025','000020','.CON.','5','','','5','cTipo2','==','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)     .CNT.','000026','000025','.EXE.','5','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := fo_GetVal( @&cObjeto , cCpoValor)     .END.','000027','000025','.EXE.','5','nValor := fo_GetVal( @&cObjeto , cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 # "I" .END.','000028','000020','.CON.','5','','','5','cTipo2','#','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)     .CNT.','000029','000028','.EXE.','5','nQtd := fo_GetVal( @&cObjeto , cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := fo_GetVal( @&cObjeto , cCpoValor )     .END.','000030','000028','.EXE.','5','nValor := fo_GetVal( @&cObjeto , cCpoValor )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba $ CPDACFIXOS   .END.','000031','000020','.CON.','5','','','5','cVerba $ CPDACFIXOS','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','CFILTRO := MSMM(SRV->RV_CODMEMO,80,,,,,,,,"RE6")     .CNT.','000032','000031','.EXE.','5','CFILTRO := MSMM(SRV->RV_CODMEMO,80,,,,,,,,"RE6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NBASEACU := FO_SOMAINCSRV(@&COBJETO,CCPOVALOR,{CFILTRO},{.T.','000033','000031','.EXE.','5','NBASEACU := FO_SOMAINCSRV(@&COBJETO,CCPOVALOR,{CFILTRO},{.T.})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)     .CNT.','000034','000031','.EXE.','5','NQTD := FO_GETVAL( @&COBJETO , CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','NVALOR :=  NQTD * NBASEACU / 100     .CNT.','000035','000031','.EXE.','5','NVALOR :=  NQTD * NBASEACU / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','FO_RESTORE(@&COBJETO)     .CNT.','000036','000031','.EXE.','5','FO_RESTORE(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','LVALALTEROU:=.T.     .END.','000037','000031','.EXE.','5','LVALALTEROU:=.T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTarefa := PosSrv(cVerba, SRA->RA_FILIAL, "RV_TAREFA")     .','000038','000020','.EXE.','5','cTarefa := PosSrv(cVerba, SRA->RA_FILIAL, "RV_TAREFA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTarefa := If (Len(AllTrim(cTarefa))#3,"   ",cTarefa)     .C','000039','000020','.EXE.','5','cTarefa := If (Len(AllTrim(cTarefa))#3,"   ",cTarefa)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(SalMes # Nil .Or. (SalMes = Nil .And. PosSrv(cVerba, SRA-','000040','000020','.CON.','5','','','5','(SalMes # Nil .Or. (SalMes = Nil .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")  # "S" )) .And. Empty(cTarefa)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cVerba $ cVerbAdic) .Or. (cVerba $ cVerbAdic .And. nValo','000041','000040','.CON.','5','','','5','!(cVerba $ cVerbAdic) .Or. (cVerba $ cVerbAdic .And. nValor = 0 .And. cTipo2 $ "I*F*G" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "H" .END.','000042','000041','.CON.','5','','','5','cTipo','==','5','"H"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round(nQtd*SALHORA*nPercent,nDecimais)   .CNT.','000043','000042','.EXE.','5','nValor',':=','5','round(nQtd*SALHORA*nPercent,nDecimais)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Restore(@&cObjeto)     .CNT.','000044','000042','.EXE.','5','fo_Restore(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000045','000042','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "D" .END.','000046','000041','.CON.','5','','','5','cTipo','==','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round(nQtd*SALDIA * nPercent, nDecimais)   .CNT.','000047','000046','.EXE.','5','nValor',':=','5','round(nQtd*SALDIA * nPercent, nDecimais)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Restore(@&cObjeto)     .CNT.','000048','000046','.EXE.','5','fo_Restore(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000049','000046','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo == "V" .AND.','000050','000041','.CON.','5','','','5','cTipo','==','5','"V"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo2 == "I" .AND.','000051','000041','.CON.','5','','','5','cTipo2','==','5','"I"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor > 0 .END.','000052','000041','.CON.','5','','','5','nValor','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000053','000052','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','( SalMes # NIL ) .And. !( cVerba $ CVRBPROP )   .AND.','000054','000020','.CON.','5','','','5','( SalMes # NIL ) .And. !( cVerba $ CVRBPROP )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")  = "S" .OR. (','000055','000020','.CON.','5','','','5','PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP")  = "S" .OR. ( CROTORIG $ PosSrv(cVerba, SRA->RA_FILIAL, "RV_RETRBAS") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalMes += nValor   .CNT.','000056','000055','.EXE.','5','SalMes','+=','5','nValor','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalHora += (nValor / SRA->RA_HRSMES)   .CNT.','000057','000055','.EXE.','5','SalHora','+=','5','(nValor / SRA->RA_HRSMES)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','SalDia += (nValor / 30)   .CNT.','000058','000055','.EXE.','5','SalDia','+=','5','(nValor / 30)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lLctoFixo := FO_SEEK( @ORG1, "RG1_PD", CVERBA)     .CNT.','000059','000055','.EXE.','5','lLctoFixo := FO_SEEK( @ORG1, "RG1_PD", CVERBA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # Nil .AND.','000060','000055','.CON.','5','','','5','nDiasProp','#','5','Nil','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp >= 0 .AND.','000061','000055','.CON.','5','','','5','nDiasProp','>=','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cVerba $ (fGetCodFol("165")+'+"'"+'*'+"'"+'+fGetCodFol("166")+'+"'"+'*'+"'"+'+ f','000062','000055','.CON.','5','','','5','!(cVerba $ (fGetCodFol("165")+'+"'"+'*'+"'"+'+fGetCodFol("166")+'+"'"+'*'+"'"+'+ fGetCodFol("347")))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','Empty(cTarefa)   .END.','000063','000055','.CON.','5','','','5','Empty(cTarefa)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipo $ "D*H" .AND. nQtd > 0 .OR.lLctoFixo   .END.','000064','000063','.CON.','5','','','5','cTipo $ "D*H" .AND. nQtd > 0 .OR.lLctoFixo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := ( ( nQtd / 30 ) * nDiasProp )     .CNT.','000065','000064','.EXE.','5','nQtd := ( ( nQtd / 30 ) * nDiasProp )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .T.   .END.','000066','000064','.EXE.','5','lQtdAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(cTipo $ "D*H" .AND. nQtd > 0) .AND. !lLctoFixo   .END.','000067','000063','.CON.','5','','','5','!(cTipo $ "D*H" .AND. nQtd > 0) .AND. !lLctoFixo','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nQtd := nDiasProp     .CNT.','000068','000067','.EXE.','5','nQtd := nDiasProp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou := .T.   .END.','000069','000067','.EXE.','5','lQtdAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := Round(( (nValor / 30 ) * nDiasProp ), nDecimais)','000070','000063','.EXE.','5','nValor := Round(( (nValor / 30 ) * nDiasProp ), nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000071','000063','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!(SalMes # NIL .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_IN','000072','000020','.CON.','5','','','5','!(SalMes # NIL .And. PosSrv(cVerba, SRA->RA_FILIAL, "RV_INCORP") = "S")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(cVerba $ cVerbAdic .Or.  (cVerba $ cVerbAdic .And. !cTipo','000073','000020','.CON.','5','','','5','(cVerba $ cVerbAdic .Or.  (cVerba $ cVerbAdic .And. !cTipo2 $ "I*F*G" ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .T.     .CNT.','000074','000073','.EXE.','5','lPropAdic := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # 0 .END.','000075','000073','.CON.','5','','','5','nDiasProp','#','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','(cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99)','000076','000075','.CON.','5','','','5','(cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99) .Or.       (cVerba = fGetCodfol("038") .And. SRA->RA_INSMED = 999.99) .Or. (cVerba = fGetCodfol("039") .And. SRA->RA_INSMED = 999.99)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .F.     .END.','000077','000076','.EXE.','5','lPropAdic := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','!((cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.9','000078','000075','.CON.','5','','','5','!((cVerba = fGetCodfol("037") .And. SRA->RA_INSMIN = 999.99) .Or.       (cVerba = fGetCodfol("038") .And. SRA->RA_INSMED = 999.99) .Or. (cVerba = fGetCodfol("039") .And. SRA->RA_INSMED = 999.99))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cVerba = fGetCodFol("036") .And. SRA->RA_PERICUL = 999.99','000079','000075','.CON.','5','','','5','cVerba = fGetCodFol("036") .And. SRA->RA_PERICUL = 999.99','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lPropAdic := .F.     .END.','000080','000079','.EXE.','5','lPropAdic := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nDiasProp # Nil .And. lPropAdic .And. SRA->RA_TIPOPGT # "S','000081','000073','.CON.','5','','','5','nDiasProp # Nil .And. lPropAdic .And. SRA->RA_TIPOPGT # "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor := round( ( (nValor / 30 ) * Min(nDiasProp, 30) ) ,nD','000082','000081','.EXE.','5','nValor := round( ( (nValor / 30 ) * Min(nDiasProp, 30) ) ,nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou := .T.   .END.','000083','000081','.EXE.','5','lValAlterou',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor <= 0 .END.','000084','000081','.CON.','5','','','5','nValor','<=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Delete(@&cObjeto)     .END.','000085','000084','.EXE.','5','fo_Delete(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lValAlterou   .END.','000086','000020','.CON.','5','','','5','lValAlterou','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','( cVerba $ cVrbPagto ) .And. ( cTipo2 # "I" ) .And. ( nTot','000087','000086','.CON.','5','','','5','( cVerba $ cVrbPagto ) .And. ( cTipo2 # "I" ) .And. ( nTotAdic > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValAdic := nTotAdic / 30 * nQtd     .CNT.','000088','000087','.EXE.','5','nValAdic := nTotAdic / 30 * nQtd','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nValor += nValAdic     .END.','000089','000087','.EXE.','5','nValor += nValAdic','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto , cCpoValor, nValor)     .END.','000090','000086','.EXE.','5','fo_SetVal(@&cObjeto , cCpoValor, nValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','lQtdAlterou   .END.','000091','000020','.CON.','5','','','5','lQtdAlterou','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto , cCpoHoras, nQtd)     .END.','000092','000091','.EXE.','5','fo_SetVal(@&cObjeto , cCpoHoras, nQtd)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cTipoRot == "9" .And. cTipo2 == "I"   .END.','000093','000020','.CON.','5','','','5','cTipoRot == "9" .And. cTipo2 == "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto, cCpoData, dData_Pgto)     .CNT.','000094','000093','.EXE.','5','fo_SetVal(@&cObjeto, cCpoData, dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_SetVal(@&cObjeto, cCpoDtRef, dData_Pgto)     .END.','000095','000093','.EXE.','5','fo_SetVal(@&cObjeto, cCpoDtRef, dData_Pgto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCodPd := PosSrv(cVerba, SRA->RA_FILIAL, "RV_CODCORR")   .CN','000096','000020','.EXE.','5','cCodPd',':=','5','PosSrv(cVerba, SRA->RA_FILIAL, "RV_CODCORR")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCodPd # "   " .END.','000097','000020','.CON.','5','','','5','cCodPd','#','5','"   "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','cCC := fo_GetVal(@&cObjeto, cCpoCC)     .CNT.','000098','000097','.EXE.','5','cCC := fo_GetVal(@&cObjeto, cCpoCC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoCC, cCp','000099','000097','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoValor, cCpoHoras, cCpoCC, cCpoTipo1, cCpoTipo2, cCpoSeq, cCpoData}, {cCodPd, nValor, nQtd, cCC, cTipo, cTipo2, fo_GetVal(@&cObjeto, cCpoSeq), fo_GetVal(@&cObjeto, cCpoData)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRC','nLinha ++     .END.','000100','000014','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0101    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0101( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRK','Geracao Val. Futuros no Mvto','','000265','040','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRK','dData := if(cTipoRot == "4", dDataDem, dData_Pgto)     .CNT.','000001','000000','.EXE.','5','dData := if(cTipoRot == "4", dDataDem, dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','lPenhora := .F.     .CNT.','000002','000000','.EXE.','5','lPenhora := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','APENVENC := {}     .CNT.','000003','000000','.EXE.','5','APENVENC := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cSitFolh <> "D" .AND.','000004','000000','.CON.','5','','','5','cSitFolh','<>','5','"D"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!fo_Eof( @OSRK )   .END.','000005','000000','.CON.','5','','','5','!fo_Eof( @OSRK )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','aCampos := {cCpoPD, cCpoTipo1, cCpoValor , cCpoNumId, cCpoSe','000006','000005','.EXE.','5','aCampos := {cCpoPD, cCpoTipo1, cCpoValor , cCpoNumId, cCpoSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_GoTop( @OSRK )     .CNT.','000007','000005','.EXE.','5','fo_GoTop( @OSRK )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nLinha := 0     .CNT.','000008','000005','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!fo_Eof( @OSRK )   .END.','000009','000005','.ENQ.','5','','','5','!fo_Eof( @OSRK )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nLinha++     .CNT.','000010','000009','.EXE.','5','nLinha++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_GetVal(@oSRK, "RK_STATUS", nLinha) == "2"   .END.','000011','000009','.CON.','5','','','5','fo_GetVal(@oSRK, "RK_STATUS", nLinha) == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','dDtVenc := fo_GetVal( @OSRK , "RK_DTVENC", nLinha)     .CNT.','000012','000011','.EXE.','5','dDtVenc := fo_GetVal( @OSRK , "RK_DTVENC", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcPg := fo_GetVal( @OSRK , "RK_PARCPAG", nLinha)     .CNT','000013','000011','.EXE.','5','nParcPg := fo_GetVal( @OSRK , "RK_PARCPAG", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcela := fo_GetVal( @OSRK , "RK_PARCELA", nLinha)     .CN','000014','000011','.EXE.','5','nParcela := fo_GetVal( @OSRK , "RK_PARCELA", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','( (cTipoRot == "4" ) .Or. ( dDtVenc <= dData ) )   .AND.','000015','000011','.CON.','5','','','5','( (cTipoRot == "4" ) .Or. ( dDtVenc <= dData ) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nParcPg < nParcela   .END.','000016','000011','.CON.','5','','','5','nParcPg < nParcela','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cVerba := fo_GetVal( @OSRK , "RK_PD", nLinha)     .CNT.','000017','000016','.EXE.','5','cVerba := fo_GetVal( @OSRK , "RK_PD", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cNumId := fo_GetVal( @OSRK , "RK_NUMID", nLinha)     .CNT.','000018','000016','.EXE.','5','cNumId := fo_GetVal( @OSRK , "RK_NUMID", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nVlParcela := fo_GetVal( @OSRK , "RK_VALORPA", nLinha)     .','000019','000016','.EXE.','5','nVlParcela := fo_GetVal( @OSRK , "RK_VALORPA", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo := fo_GetVal( @OSRK , "RK_VLSALDO", nLinha)     .CNT.','000020','000016','.EXE.','5','nSaldo := fo_GetVal( @OSRK , "RK_VLSALDO", nLinha)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','lPenhora := IIF( Val( fo_GetVal( @OSRK, "RK_PENHORA", nLinha','000021','000016','.EXE.','5','lPenhora := IIF( Val( fo_GetVal( @OSRK, "RK_PENHORA", nLinha ) ) == 1, .T., .F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cTipoRot == "4" .END.','000022','000016','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor := nSaldo + fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','000023','000022','.EXE.','5','nValor',':=','5','nSaldo + fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','!(cTipoRot == "4")   .END.','000024','000016','.CON.','5','','','5','!(cTipoRot == "4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo >= nVlParcela .END.','000025','000024','.CON.','5','','','5','nSaldo','>=','5','nVlParcela','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor := nVlParcela     .END.','000026','000025','.EXE.','5','nValor := nVlParcela','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nSaldo < nVlParcela .END.','000027','000024','.CON.','5','','','5','nSaldo','<','5','nVlParcela','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor  := nSaldo     .END.','000028','000027','.EXE.','5','nValor  := nSaldo','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','(nParcela - nParcPg) = 1 .END.','000029','000024','.CON.','5','','','5','(nParcela - nParcPg)','=','5','1','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','nValor += fo_GetVal(@oSRK, "RK_VALORAR", nLinha)   .END.','000030','000029','.EXE.','5','nValor','+=','5','fo_GetVal(@oSRK, "RK_VALORAR", nLinha)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','cSeq := Alltrim(Str(fo_count( @&cObjeto , cCpoPD , cVerba )','000031','000016','.EXE.','5','cSeq := Alltrim(Str(fo_count( @&cObjeto , cCpoPD , cVerba ) + 1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','! lPenhora   .END.','000032','000016','.CON.','5','','','5','! lPenhora','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','aConteudos := {cVerba, "V", nValor, cNumId, cSeq}     .CNT.','000033','000032','.EXE.','5','aConteudos := {cVerba, "V", nValor, cNumId, cSeq}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_Add( @&cObjeto , aCampos, aConteudos, {cCpoPD, cCpoSeq},','000034','000032','.EXE.','5','fo_Add( @&cObjeto , aCampos, aConteudos, {cCpoPD, cCpoSeq}, {cVerba, cSeq})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','lPenhora   .END.','000035','000016','.CON.','5','','','5','lPenhora','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','AADD(APENVENC, {cVERBA, "V", nVALOR, cNUMID, cSEQ, fo_GetVal','000036','000035','.EXE.','5','AADD(APENVENC, {cVERBA, "V", nVALOR, cNUMID, cSEQ, fo_GetVal( @OSRK, "RK_DTMOVI", nLinha ) , nSALDO} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRK','fo_Skip( @OSRK )     .END.','000037','000009','.EXE.','5','fo_Skip( @OSRK )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0102    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0102( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCSRO','PROCESSAR SRO','','','038','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCSRO','PROCESSA TAREFA DO SRO','000001','000000','.CON.','5','','','5','!fo_Eof( @OSRO )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','fo_GoTop( @OSRO )     .CNT.','000002','000001','.EXE.','5','fo_GoTop( @OSRO )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','!fo_Eof( @OSRO )   .END.','000003','000001','.ENQ.','5','','','5','!fo_Eof( @OSRO )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','cVerba := FO_GetVal( @OSRO , "RO_VERBA")     .CNT.','000004','000003','.EXE.','5','cVerba := FO_GetVal( @OSRO , "RO_VERBA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','cCCTar  := If(Empty(FO_GETVAL(@oSRO,"RO_CC")), SRA->RA_CC, F','000005','000003','.EXE.','5','cCCTar  := If(Empty(FO_GETVAL(@oSRO,"RO_CC")), SRA->RA_CC, FO_GETVAL(@oSRO,"RO_CC"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','nQuant := FO_GETVAL(@oSRO,"RO_QUANT")     .CNT.','000006','000003','.EXE.','5','nQuant := FO_GETVAL(@oSRO,"RO_QUANT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','nQtSeman := FO_GETVAL(@oSRO,"RO_QTDSEM")     .CNT.','000007','000003','.EXE.','5','nQtSeman := FO_GETVAL(@oSRO,"RO_QTDSEM")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','cTipVerba := PosSrv(cVerba,SRA->RA_FILIAL,"RV_TIPOCOD")','000008','000003','.EXE.','5','cTipVerba := PosSrv(cVerba,SRA->RA_FILIAL,"RV_TIPOCOD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','nValor := FO_GETVAL(@oSRO,"RO_VALTOT",nLinha)     .CNT.','000009','000003','.EXE.','5','nValor := FO_GETVAL(@oSRO,"RO_VALTOT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','( nPosTar := Ascan( aTarefas, { |X| X[1] == cVerba .And. X','000010','000003','.CON.','5','','','5','( nPosTar := Ascan( aTarefas, { |X| X[1] == cVerba .And. X[5] = cCcTar .and. X[8] == "SRO" })) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','Aadd( aTarefas, { cVerba, nValor,nQtSeman,nQuant, cCCTar, FO','000011','000010','.EXE.','5','Aadd( aTarefas, { cVerba, nValor,nQtSeman,nQuant, cCCTar, FO_GETVAL(@oSRO,"RO_DATA"), cTipVerba, "SRO", fo_getval(@oSRO,"RO_TIPO") } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','nPostar > 0   .END.','000012','000003','.CON.','5','','','5','nPostar > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','aTarefas[nPostar,2] += nValor     .CNT.','000013','000012','.EXE.','5','aTarefas[nPosTar,2] += nValor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','aTarefas[nPosTar,3] += nQtSeman     .CNT.','000014','000012','.EXE.','5','aTarefas[nPosTar,3] += nQtSeman','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','aTarefas[nPosTar,4] += nQuant     .END.','000015','000012','.EXE.','5','aTarefas[nPosTar,4] += nQuant','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCSRO','fo_Skip( @OSRO )     .END.','000016','000003','.EXE.','5','fo_Skip( @OSRO )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0103    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0103( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCTARV','PROCESSAR TAREFAS DO SRC','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCTARV','!fo_Eof( @&cObjeto )   .END.','000001','000000','.CON.','5','','','5','!fo_Eof( @&cObjeto )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','fo_GoTop( @&cObjeto )     .CNT.','000002','000001','.EXE.','5','fo_GoTop( @&cObjeto )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','!fo_Eof( @&cObjeto )   .END.','000003','000001','.ENQ.','5','','','5','!fo_Eof( @&cObjeto )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','cVerba := fo_GetVal( @&cObjeto ,cCpoPd)     .CNT.','000004','000003','.EXE.','5','cVerba := fo_GetVal( @&cObjeto ,cCpoPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','cTipo := fo_GetVal( @&cObjeto ,cCpoTipo1)     .CNT.','000005','000003','.EXE.','5','cTipo := fo_GetVal( @&cObjeto ,cCpoTipo1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','cCodTar := PosSrv(cVerba,SRA->RA_FILIAL,"RV_TAREFA")   .CNT.','000006','000003','.EXE.','5','cCodTar',':=','5','PosSrv(cVerba,SRA->RA_FILIAL,"RV_TAREFA")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','Len(Alltrim(cCodTar)) == 3 .AND.','000007','000003','.CON.','5','','','5','Len(Alltrim(cCodTar))','==','5','3','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','cTipo $ "H*D" .END.','000008','000003','.CON.','5','','','5','cTipo','$','5','"H*D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )     .CN','000009','000008','.EXE.','5','nDecimais := GetSx3Cache( cCpoValor , "X3_DECIMAL" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','nQtd := fo_GetVal( @&cObjeto ,cCpoHorInf)     .CNT.','000010','000008','.EXE.','5','nQtd := fo_GetVal( @&cObjeto ,cCpoHorInf)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','nValTar := Val( SubStr( Posicione("SRX",1,xFilial("SRX")+"59','000011','000008','.EXE.','5','nValTar',':=','5','Val( SubStr( Posicione("SRX",1,xFilial("SRX")+"590"+cCodTar, "RX_TXT"),31,12 ))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','nValor := round(nQtd * nValtar,nDecimais)     .CNT.','000012','000008','.EXE.','5','nValor := round(nQtd * nValtar,nDecimais)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','fo_SetVal(@&cObjeto , cCpoValor, nValor)     .CNT.','000013','000008','.EXE.','5','fo_SetVal(@&cObjeto , cCpoValor, nValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','Aadd( aTarefas , { cVerba,nValor, FO_GETVAL(@&cObjeto, cCpoQ','000014','000008','.EXE.','5','Aadd( aTarefas , { cVerba,nValor, FO_GETVAL(@&cObjeto, cCpoQtdSem), nQtd,FO_GETVAL(@&cObjeto,cCpoCC), FO_GETVAL(@&cObjeto,cCpoData),"1", "SRC", "2" } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCTARV','fo_Skip( @&cObjeto )     .END.','000015','000003','.EXE.','5','fo_Skip( @&cObjeto )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0104    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0104( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROPMED','GRAVA MEDIAS PORTUGAL','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','PROPMED','NX := 1     .CNT.','000001','000000','.EXE.','5','NX := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPMED','NX <= LEN(AMEDIASPTG)   .END.','000002','000000','.ENQ.','5','','','5','NX <= LEN(AMEDIASPTG)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROPMED','FO_SETVAL(@&COBJETO,CCPOVALOR,FO_GETVAL((@&COBJETO,CCPOVALOR','000003','000003','.EXE.','5','FO_SETVAL(@&COBJETO,CCPOVALOR,FO_GETVAL((@&COBJETO,CCPOVALOR)+AMEDIASPTG[NX,3])/NDIASANO*NDIAS13PT)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPMED','AMEDIASPTG[NX,3] := AMEDIASPTG[NX,3]/NDIASANO*NDIAS13PT','000004','000002','.EXE.','5','AMEDIASPTG[NX,3] := AMEDIASPTG[NX,3]/NDIASANO*NDIAS13PT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPMED','NX++     .END.','000005','000002','.EXE.','5','NX++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0105    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0105( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROPTARE','PROPORCIONALISA TAREFAS PROFES','','','016','2','1',} )

aAdd(aRc3Cols, { '','S_','PROPTARE','lAdmissao := If( MesAno(SRA->RA_ADMISSA) == cAnoMes,.T.,.F.)','000001','000000','.EXE.','5','lAdmissao := If( MesAno(SRA->RA_ADMISSA) == cAnoMes,.T.,.F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','(!Empty(cSitFolh) .And. cSitFolh # "D" ) .Or. lAdmissao','000002','000000','.CON.','5','','','5','(!Empty(cSitFolh) .And. cSitFolh # "D" ) .Or. lAdmissao','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nLinha := 1     .CNT.','000003','000002','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nLinha <= Len(aTarefas)   .END.','000004','000002','.ENQ.','5','','','5','nLinha <= Len(aTarefas)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','aTarefas[nLinha,9] == "1"   .END.','000005','000004','.CON.','5','','','5','aTarefas[nLinha,9] == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCc},{aTarefas[nLinha,1],aTar','000006','000005','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCc},{aTarefas[nLinha,1],aTarefas[nLinha,5]})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_GETVAL(@&cObjeto,cCpoTipo2) <> "I"   .END.','000007','000006','.CON.','5','','','5','FO_GETVAL(@&cObjeto,cCpoTipo2) <> "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nValor := Round( FO_GETVAL(@&cObjeto,cCpoValor) / 30 * Diast','000008','000007','.EXE.','5','nValor := Round( FO_GETVAL(@&cObjeto,cCpoValor) / 30 * Diastrab, MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','000009','000007','.EXE.','5','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoValor,nValor)     .CNT.','000010','000007','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,nValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)     .END.','000011','000007','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nLinha ++     .END.','000012','000004','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SEEK(@&cObjeto,cCpoPd,FGETCODFOL("033"))   .END.','000013','000002','.CON.','5','','','5','FO_SEEK(@&cObjeto,cCpoPd,FGETCODFOL("033"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nValor := ROUND(FO_GETVAL(@&cObjeto,cCpoValor) / 30 * DIASTR','000014','000013','.EXE.','5','nValor := ROUND(FO_GETVAL(@&cObjeto,cCpoValor) / 30 * DIASTRAB,MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','000015','000013','.EXE.','5','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)     .CNT.','000016','000013','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoValor,nValor)     .END.','000017','000013','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,nValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SEEK(@&cObjeto,cCpoPd,FGETCODFOL("317"))   .END.','000018','000002','.CON.','5','','','5','FO_SEEK(@&cObjeto,cCpoPd,FGETCODFOL("317"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nValor := ROUND(FO_GETVAL(@&cObjeto,cCpoValor) / 30 * DIASTR','000019','000018','.EXE.','5','nValor := ROUND(FO_GETVAL(@&cObjeto,cCpoValor) / 30 * DIASTRAB,MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','000020','000018','.EXE.','5','nHoras := FO_GETVAL(@&cObjeto,cCpoHoras) / 30 * DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)     .CNT.','000021','000018','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROPTARE','FO_SETVAL(@&cObjeto,cCpoHoras,nValor)     .END.','000022','000018','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0106    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0106( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVADIC','CALCULA ADICIONAIS DE PROVISAO','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVADIC','lFerias := (aPergunte[1,3] == 1 .OR. aPergunte[1,3] == 3)','000001','000000','.EXE.','5','lFerias := (aPergunte[1,3] == 1 .OR. aPergunte[1,3] == 3)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','l13Sal := (aPergunte[1,3] > 1)     .CNT.','000002','000000','.EXE.','5','l13Sal := (aPergunte[1,3] > 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','LMESATU := .F.     .CNT.','000003','000000','.EXE.','5','LMESATU := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','dDataMed := CTOD("//")     .CNT.','000004','000000','.EXE.','5','dDataMed := CTOD("//")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','FPOSREG("RGD",1,SRA->RA_FILIAL+SRA->RA_CODIRCT)   .END.','000005','000000','.CON.','5','','','5','FPOSREG("RGD",1,SRA->RA_FILIAL+SRA->RA_CODIRCT)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','LMESATU := (RGD->RGD_APUMED="S")     .END.','000006','000005','.EXE.','5','LMESATU := (RGD->RGD_APUMED="S")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','lFerias .And. Len(aPerFerias) > 0   .END.','000007','000000','.CON.','5','','','5','lFerias .And. Len(aPerFerias) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','dDataMed := aPerFerias[1,1]     .END.','000008','000007','.EXE.','5','dDataMed := aPerFerias[1,1]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','aBkp := aClone(aPerferias)     .CNT.','000009','000000','.EXE.','5','aBkp := aClone(aPerferias)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','aPerferias := {}     .CNT.','000010','000000','.EXE.','5','aPerferias := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','GPEXMED(dDataMed,,DDATADE,,DDATABASE,SALHORA,VAL_SALMIN,AC','000011','000000','.CON.','5','','','5','GPEXMED(dDataMed,,DDATADE,,DDATABASE,SALHORA,VAL_SALMIN,ACODFOL,LMESATU,LMOVTO,LFALTAS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','aPerferias := aClone(aBkp)     .CNT.','000012','000011','.EXE.','5','aPerferias := aClone(aBkp)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','cCpoHor := "TRP->RP_HORAS"     .CNT.','000013','000011','.EXE.','5','cCpoHor := "TRP->RP_HORAS"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','cCpoVal := "TRP->RP_VALATU"     .CNT.','000014','000011','.EXE.','5','cCpoVal := "TRP->RP_VALATU"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','lFerias   .END.','000015','000011','.CON.','5','','','5','lFerias','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorMed := 0     .CNT.','000016','000015','.EXE.','5','nHorMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorAux := 0     .CNT.','000017','000015','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValMed := 0     .CNT.','000018','000015','.EXE.','5','nValMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValAux := 0     .CNT.','000019','000015','.EXE.','5','nValAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"1"+"999"+"99MD','000020','000015','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"1"+"999"+"99MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorAux := &cCpoHor     .CNT.','000021','000020','.EXE.','5','nHorAux := &cCpoHor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorMed += nHorMed     .CNT.','000022','000020','.EXE.','5','nHorMed += nHorMed','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValAux := &cCpoVal     .CNT.','000023','000020','.EXE.','5','nValAux := &cCpoVal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValMed += nValAux     .END.','000024','000020','.EXE.','5','nValMed += nValAux','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"2"+"999"+"99MD','000025','000015','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"2"+"999"+"99MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorAux := &cCpoHor     .CNT.','000026','000025','.EXE.','5','nHorAux := &cCpoHor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorMed += nHorAux     .CNT.','000027','000025','.EXE.','5','nHorMed += nHorAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValAux := &cCpoVal     .CNT.','000028','000025','.EXE.','5','nValAux := &cCpoVal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValMed += nValAux     .END.','000029','000025','.EXE.','5','nValMed += nValAux','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValMed > 0 .And. !Empty(cVrbAdi := FGETCODFOL("0254"))','000030','000015','.CON.','5','','','5','nValMed > 0 .And. !Empty(cVrbAdi := FGETCODFOL("0254"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBADI, NHORME','000031','000030','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBADI, NHORMED, NVALMED})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','lFerias   .END.','000032','000011','.CON.','5','','','5','lFerias','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorMed := 0     .CNT.','000033','000032','.EXE.','5','nHorMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorAux := 0     .CNT.','000034','000032','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValMed := 0     .CNT.','000035','000032','.EXE.','5','nValMed := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValAux := 0     .CNT.','000036','000032','.EXE.','5','nValAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"99MD','000037','000032','.CON.','5','','','5','FPOSREG("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"99MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorAux := &cCpoHor     .CNT.','000038','000037','.EXE.','5','nHorAux := &cCpoHor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nHorMed += nHorAux     .CNT.','000039','000037','.EXE.','5','nHorMed += nHorAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValAux := &cCpoVal     .CNT.','000040','000037','.EXE.','5','nValAux := &cCpoVal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValMed += nValAux     .END.','000041','000037','.EXE.','5','nValMed += nValAux','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','nValMed > 0 .And. !Empty(cVrbAdi := FGETCODFOL("0267"))','000042','000032','.CON.','5','','','5','nValMed > 0 .And. !Empty(cVrbAdi := FGETCODFOL("0267"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVADIC','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBADI, NHORME','000043','000042','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOHORAS, CCPOVALOR},{CVRBADI, NHORMED, NVALMED})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0107    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0107( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVI13','CALCULA PROVISAO DE 13 SALARIO','','','015','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVI13','NTIPOPRV > 1   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','DDTINI := MAX( SRA->RA_ADMISSA , CTOD("01/01/"+SUBSTR(CANOME','000002','000001','.EXE.','5','DDTINI := MAX( SRA->RA_ADMISSA , CTOD("01/01/"+SUBSTR(CANOMES,1,4) ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','DDTINI <> CTOD("01/01/"+SUBSTR(CANOMES,1,4) )   .END.','000003','000001','.CON.','5','','','5','DDTINI <> CTOD("01/01/"+SUBSTR(CANOMES,1,4) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','SRA->RA_CATFUNC == "M"   .END.','000004','000003','.CON.','5','','','5','SRA->RA_CATFUNC == "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','NDIASADM := ( ( 30 - DAY(DDTINI) ) + 1 ) / 30     .END.','000005','000004','.EXE.','5','NDIASADM := ( ( 30 - DAY(DDTINI) ) + 1 ) / 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','SRA->RA_CATFUNC <> "M"   .END.','000006','000003','.CON.','5','','','5','SRA->RA_CATFUNC <> "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','NDIASADM := ( ( F_ULTDIA(DDTINI)-DAY(DDTINI) ) + 1 ) / 30','000007','000006','.EXE.','5','NDIASADM := ( ( F_ULTDIA(DDTINI)-DAY(DDTINI) ) + 1 ) / 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','DDTINI := CTOD("01/" + ( STRZERO(MONTH(DDTINI) +1,2) ) +"/"+','000008','000003','.EXE.','5','DDTINI := CTOD("01/" + ( STRZERO(MONTH(DDTINI) +1,2) ) +"/"+ SUBSTR( CANOMES , 1, 4 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','DDTFIM := DDATAATE     .CNT.','000009','000001','.EXE.','5','DDTFIM := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','NDIAS13PT := DATEDIFFMONTH( DDTINI , DDTFIM ) + 1 + NDIASADM','000010','000001','.EXE.','5','NDIAS13PT := DATEDIFFMONTH( DDTINI , DDTFIM ) + 1 + NDIASADM','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','NVAL13 := SALMES / 12 * NDIAS13PT     .CNT.','000011','000001','.EXE.','5','NVAL13 := SALMES / 12 * NDIAS13PT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','CVRBPRV := FGETCODFOL("0777")     .CNT.','000012','000001','.EXE.','5','CVRBPRV := FGETCODFOL("0777")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','NVAL13 > 0 .AND. !EMPTY(CVRBPRV)   .END.','000013','000001','.CON.','5','','','5','NVAL13 > 0 .AND. !EMPTY(CVRBPRV)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','LIF := FO_SEEK(@&cObjeto,{CCPOPD},{CVRBPRV})   .END.','000014','000013','.CON.','5','','','5','LIF := FO_SEEK(@&cObjeto,{CCPOPD},{CVRBPRV})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','FO_SETVAL(@OSRC,CCPOVALOR,NVAL13)     .END.','000015','000014','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,NVAL13)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVI13','!LIF   .END.','000016','000013','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVI13','FO_ADD(@OSRC,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVRBPRV, NVAL13,','000017','000016','.EXE.','5','FO_ADD(@OSRC,{CCPOPD,CCPOVALOR,CCPOHORAS},{CVRBPRV, NVAL13, NDIAS13PT})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0108    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0108( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVIFER','CALCULA PROVISAO DE FERIAS','','','015','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVIFER','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_GOTOP(@OSRF)     .CNT.','000002','000001','.EXE.','5','FO_GOTOP(@OSRF)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CVRBFER := FGETCODFOL("0072")     .CNT.','000003','000001','.EXE.','5','CVRBFER := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','CVRBPRV := FGETCODFOL("0776")     .CNT.','000004','000001','.EXE.','5','CVRBPRV := FGETCODFOL("0776")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasProp := 0     .CNT.','000005','000001','.EXE.','5','nDiasProp := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasVenc := 0     .CNT.','000006','000001','.EXE.','5','nDiasVenc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nValor := 0     .CNT.','000007','000001','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!FO_EOF(@OSRF)   .END.','000008','000001','.ENQ.','5','','','5','!FO_EOF(@OSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','( FO_GETVAL(@OSRF,"RF_PD") == CVRBFER ) .AND. ( FO_GETVAL(','000009','000008','.CON.','5','','','5','( FO_GETVAL(@OSRF,"RF_PD") == CVRBFER ) .AND. ( FO_GETVAL(@OSRF,"RF_DATABAS") <= DDATAATE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"   .END.','000010','000009','.CON.','5','','','5','FO_GETVAL(@OSRF,"RF_STATUS") $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasProp += FO_GETVAL(@OSRF,"RF_DFERAAT")     .CNT.','000011','000010','.EXE.','5','nDiasProp += FO_GETVAL(@OSRF,"RF_DFERAAT")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nDiasVenc += FO_GETVAL(@OSRF,"RF_DFERVAT")     .END.','000012','000010','.EXE.','5','nDiasVenc += FO_GETVAL(@OSRF,"RF_DFERVAT")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_SKIP(@OSRF)     .END.','000013','000008','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','nValor := ( nDiasVenc + nDiasProp ) * SalDia     .CNT.','000014','000001','.EXE.','5','nValor := ( nDiasVenc + nDiasProp ) * SalDia','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','NVALOR > 0 .AND. !EMPTY(CVRBPRV)   .END.','000015','000001','.CON.','5','','','5','NVALOR > 0 .AND. !EMPTY(CVRBPRV)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})   .END.','000016','000015','.CON.','5','','','5','LIF := FO_SEEK(@OSRC,{CCPOPD},{CVRBPRV})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_SETVAL(@OSRC,CCPOVALOR,NVALOR)     .END.','000017','000016','.EXE.','5','FO_SETVAL(@OSRC,CCPOVALOR,NVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','!LIF   .END.','000018','000015','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIFER','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR, CCPOHORAS},{CVRBPRV, NVALOR','000019','000018','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR, CCPOHORAS},{CVRBPRV, NVALOR, NDIASVENC+NDIASPROP})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0109    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0109( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROVIMES','CALCULO DE PROVISAO DO MES','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','PROVIMES','NTIPOPRV == 1 .OR. NTIPOPRV == 3   .END.','000001','000000','.CON.','5','','','5','NTIPOPRV == 1 .OR. NTIPOPRV == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR := 0     .CNT.','000002','000001','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})   .END.','000003','000001','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0776")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR += FO_GETVAL(@OSRC,CCPOVALOR)     .CNT.','000004','000003','.EXE.','5','NVALOR += FO_GETVAL(@OSRC,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR -= IF(NPRACUFER<0,NPRACUFER*(-1),NPRACUFER)     .CNT.','000005','000003','.EXE.','5','NVALOR -= IF(NPRACUFER<0,NPRACUFER*(-1),NPRACUFER)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{FGETCODFOL("0130"), NVALOR','000006','000003','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{FGETCODFOL("0130"), NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NTIPOPRV > 1   .END.','000007','000000','.CON.','5','','','5','NTIPOPRV > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR := 0     .CNT.','000008','000007','.EXE.','5','NVALOR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})   .END.','000009','000007','.CON.','5','','','5','FO_SEEK(@OSRC,{CCPOPD},{FGETCODFOL("0777")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR += FO_GETVAL(@OSRC,CCPOVALOR)     .CNT.','000010','000009','.EXE.','5','NVALOR += FO_GETVAL(@OSRC,CCPOVALOR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','NVALOR -= IF(NPRACU13<0,NPRACU13*(-1),NPRACU13)     .CNT.','000011','000009','.EXE.','5','NVALOR -= IF(NPRACU13<0,NPRACU13*(-1),NPRACU13)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROVIMES','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{FGETCODFOL("0136"), NVALOR','000012','000009','.EXE.','5','FO_ADD(@OSRC,{CCPOPD, CCPOVALOR},{FGETCODFOL("0136"), NVALOR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddPTG0110    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddPTG0110( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','SALARIOB','SALARIO BASE MES DOS FUNCIONAR','SALARIO','001065','004','2','1',} )

aAdd(aRc3Cols, { '','S_','SALARIOB','SALMES     .END.','000001','000000','.EXE.','2','SALMES','','1','','','1','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
IF ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIF
IF ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__')
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIF

Return( NIL )