#INCLUDE "PROTHEUS.CH"
#INCLUDE "GPER046CHI.CH"

/*ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ GPER046CHI ³ Autor ³ Jesus Peñaloza           ³ Data ³ 24.09.14   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Reporte INE (Chile)                                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                          ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³              ATUALIZACOES SOFRIDAS DESDE A CONSTRU€AO INICIAL.               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±	
±±³Programador   ³ Data   ³ BOPS/FNC  ³  Motivo da Alteracao                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ J. Peñaloza  ³15/12/14³  TRGLDZ   ³Se actualiza el nombre del fuente de      ³±±
±±³              ³        ³           ³GPER030CHI a GPER046CHI                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³JR. Briseno   ³24/08/15³  TTDVMI   ³Se corrige def. cuando la suc. esta vacia ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Alex Hdez.    ³11/12/15³PCREQ-7944 ³Se paso a la v12 a partir del fuente de   ³±±
±±³              ³        ³           ³v11 con la fecha 28/09/15                 ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/ 


Function GPER046CHI()
Local oReport
Local cFil    := ''
Local nFil := 0
Local nNum := 0
Private cPerg := 'GPER046CHI'
Private aOrd	 := {OemToAnsi(STR0020)} //Grupo Ocupacional
Private cAnio := ''
Private cMes  := ''
Private cTipo := ''
Private cPict := "@E 99,999,999,999.99"
Private nTam  := TamSX3("RD_VALOR")[1]+5
Private aFiliales := {}
If Pergunte(cPerg, .T.)
	MakeAdvplExpr(cPerg)
	cAnio:= Alltrim(Str(MV_PAR02))
	cMes := Padl(Alltrim(Str(MV_PAR03)),2,'0')
	cTipo := Alltrim(Str(MV_PAR04))
	aFiliales := Filiales(MV_PAR01)
	If cTipo == '1'
		For nFil := 1 to len (aFiliales)
			cFil := aFiliales[nFil]
			If HayTrabajadores(cFil)
				nNum++
				exit
			EndIf
		Next nFil
	Else
		For nFil := 1 to len (aFiliales)
			cFil := aFiliales[nFil]
			If HayTrabV(cFil)
				nNum++
				exit
			EndIf
		Next nFil
	EndIf
	If nNum > 0
		oReport := ReportDef()
		oReport:PrintDialog()
	Else
		MsgAlert(STR0076) //"No existe información con los parametros proporcionados"
		GPER046CHI()
	EndIf
EndIf
Return

/*ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funcion   ³ ReportDef  ³ Autor ³ Jesus Peñaloza        ³ Data ³26/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡ao ³ Definicion reporte INE                                       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ GPER046CHI                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function ReportDef()

Local 	oReport
Local cTitulo := STR0001//"INFORME PARA INE"
Local	oSection1
Local 	oSection2     
Local 	oSection3       
Local 	oSection4
Local oSection5
Local 	oSection6
Local oSection7
Local 	oSection8
Local oSection9
Local nX := 0

oReport:=TReport():New(cPerg,OemToAnsi(cTitulo), cPerg ,{|oReport| PrintReport(oReport)})
oReport:SetPortrait()
oReport:nColSpace	:= 1
oReport:nFontBody	:= 6
oReport:nLineHeight := 18
oReport:cFontBody	:= "COURIER NEW"
oReport:Setlandscape(.T.)
oReport:SetTotalInLine(.F.)

oSection1:= TRSection():New(oReport,oemtoansi(STR0002),,aOrd,/*Campos do SX3*/,/*Campos do SIX*/) //"Encabezado"
oSection1:SetHeaderPage(.T.)
oSection1:SetLineStyle(.T.)
oSection1:SetCharSeparator("")
oSection1:SetHeaderBreak(.T.)

TRCell():New(oSection1,"EMPRESA",,STR0003,,20,.T.,,"LEFT")
TRCell():New(oSection1,"SUCURSAL",,STR0004,,30,.T.,,"LEFT")
TRCell():New(oSection1,"ANIO",,STR0005,,20,.T.,,"LEFT")

oSection2:= TRSection():New(oReport,oemtoansi(STR0006),,aOrd,,) //"Seccion III y IV"
oSection2:SetTotalInLine(.f.)
oSection2:SetHeaderSection(.f.)
oSection2:SetHeaderPage(.f.)
oSection2:SetLineStyle(.T.)
oSection2:SetCharSeparator("")
oSection2:SetHeaderBreak(.T.)

oSection3:= TRSection():New(oReport,oemtoansi(STR0007),,aOrd,,) //"No. Trabajadores en el mes de referencia"
oSection3:SetTotalInLine(.f.)
oSection3:SetHeaderSection(.f.)
oSection3:SetHeaderPage(.f.)
oSection3:SetLineStyle(.T.)
oSection3:SetCharSeparator("")
oSection3:SetHeaderBreak(.T.)

TRCell():New(oSection3,"SECCANT",,"",,130,.T.,,"LEFT")
TRCell():New(oSection3,"SECCION",,"",,130,.T.,,"LEFT")

oSection4:= TRSection():New(oReport,oemtoansi(STR0008),,aOrd,,) //"Monto de las componentes"
oSection4:SetTotalInLine(.f.)
oSection4:SetHeaderSection(.f.)
oSection4:SetHeaderPage(.f.)
oSection4:SetLineStyle(.T.)
oSection4:SetCharSeparator("")
oSection4:SetHeaderBreak(.T.)

TRCell():New(oSection4,"TITULO",,"",,130,.T.,,"LEFT")

oSection5:= TRSection():New(oReport,oemtoansi(STR0009),,aOrd,,) //"Componentes"
oSection5:SetTotalInLine(.f.)
oSection5:SetHeaderSection(.f.)
oSection5:SetHeaderPage(.f.)
oSection5:SetLineStyle(.T.)
oSection5:SetCharSeparator("")
oSection5:SetHeaderBreak(.T.)

oSection6:= TRSection():New(oReport,oemtoansi(STR0010),,aOrd,,) //"Monto de las deducciones"
oSection6:SetTotalInLine(.f.)
oSection6:SetHeaderSection(.f.)	
oSection6:SetHeaderPage(.f.)
oSection6:SetLineStyle(.T.)
oSection6:SetCharSeparator("")
oSection6:SetHeaderBreak(.T.)

TRCell():New(oSection6,"TITULO",,"",,130,.T.,,"LEFT")

oSection7:= TRSection():New(oReport,oemtoansi(STR0011),,aOrd,,) //"Deducciones"
oSection7:SetTotalInLine(.f.)
oSection7:SetHeaderSection(.f.)
oSection7:SetHeaderPage(.f.)
oSection7:SetLineStyle(.T.)
oSection7:SetCharSeparator("")
oSection7:SetHeaderBreak(.T.)

TRCell():New(oSection7,"CONCEPTO",,"",,nTam+7,.T.,,"LEFT")

oSection8:= TRSection():New(oReport,oemtoansi(STR0012),,aOrd,,) //"Horas Pagadas"
oSection8:SetTotalInLine(.f.)
oSection8:SetHeaderSection(.f.)
oSection8:SetHeaderPage(.f.)
oSection8:SetLineStyle(.T.)
oSection8:SetCharSeparator("")
oSection8:SetHeaderBreak(.T.)

TRCell():New(oSection8,"TITULO",,"",,130,.T.,,"LEFT")

oSection9:= TRSection():New(oReport,oemtoansi(STR0013),,aOrd,,) //"Horas"
oSection9:SetTotalInLine(.f.)
oSection9:SetHeaderSection(.f.)	
oSection9:SetHeaderPage(.f.)
oSection9:SetLineStyle(.T.)
oSection9:SetCharSeparator("")
oSection9:SetHeaderBreak(.T.)

TRCell():New(oSection9,"CONCEPTO",,"",,nTam+7,.T.,,"LEFT")

OSECTION1:NLINESBEFORE:=0
OSECTION2:NLINESBEFORE:=0
OSECTION3:NLINESBEFORE:=0
OSECTION4:NLINESBEFORE:=0
OSECTION5:NLINESBEFORE:=0
OSECTION6:NLINESBEFORE:=0
OSECTION7:NLINESBEFORE:=0
OSECTION8:NLINESBEFORE:=0
OSECTION9:NLINESBEFORE:=0

Return(oReport)

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³PrintReport³ Autor ³ Jesus Peñaloza        ³ Data ³26/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Imprime el reporte                                          ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ PrintReport(oExp1)                                          ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ oExp1: Objeto oReport                                       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ ReportDef                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function PrintReport(oReport)
Local nX   := 0
Local nFil := 0
Local nNum := 0
Local cFil := ''
Private aGrupos    := GruposOcup()
Private oSection1  := oReport:Section(1)
Private oSection2  := oReport:Section(2)
Private oSection3  := oReport:Section(3)
Private oSection4  := oReport:Section(4)
Private oSection5  := oReport:Section(5)
Private oSection6  := oReport:Section(6)
Private oSection7  := oReport:Section(7)
Private oSection8  := oReport:Section(8)
Private oSection9  := oReport:Section(9)

Pergunte(cPerg, .F.)
MakeAdvplExpr(oReport:uParam)
aFiliales := Filiales(MV_PAR01)
If cTipo == '1'
	oReport:SetTitle(STR0001+"-"+STR0006)
	TRCell():New(oSection3,"TITANT",,"",,130,.T.,,"LEFT")
	TRCell():New(oSection3,"TITULO",,"",,130,.T.,,"LEFT")
	TRCell():New(oSection3,"CONCEPTO",,"",,nTam+7,.T.,,"LEFT")
	oSection3:Cell("SECCANT"):SetCellBreak(.T.)
	oSection3:Cell("SECCION"):SetCellBreak(.T.)
	oSection3:Cell("TITANT"):SetCellBreak(.T.)
	oSection3:Cell("TITULO"):SetCellBreak(.T.)
	TRCell():New(oSection5,"CONCEPTO",,"",,nTam+7,.T.,,"LEFT")
	For nX := 1 to len(aGrupos)
		TRCell():New(oSection3,"GRUPO"+Alltrim(str(nX)),,"",,nTam,.T.,,"RIGHT")
		TRCell():New(oSection5,"GRUPO"+Alltrim(str(nX)),,"",,nTam,.T.,,"RIGHT")
		TRCell():New(oSection7,"GRUPO"+Alltrim(str(nX)),,"",,nTam,.T.,,"RIGHT")
		TRCell():New(oSection9,"GRUPO"+Alltrim(str(nX)),,"",,nTam,.T.,,"RIGHT")
	Next nX
	TRCell():New(oSection2,"CONCEPTO",,"",,nTam+7,.T.,,"LEFT")
	TRCell():New(oSection2,"GRUPO1",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO2",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO3",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO4",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO5",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO6",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO7",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO8",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO9",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"TOTAL",,"",,nTam,.T.,,"RIGHT")
	
	TRCell():New(oSection2,"CONCEPTO1",,"",,nTam+7,.T.,,"LEFT")
	TRCell():New(oSection2,"GRUPO11",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO21",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO31",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO41",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO51",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO61",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO71",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO81",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO91",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"TOTAL1",,"",,nTam,.T.,,"RIGHT")
	
	TRCell():New(oSection2,"CONCEPTO2",,"",,nTam+7,.T.,,"LEFT")
	TRCell():New(oSection2,"GRUPO12",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO22",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO32",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO42",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO52",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO62",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO72",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO82",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO92",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"TOTAL2",,"",,nTam,.T.,,"RIGHT")
	
	TRCell():New(oSection2,"CONCEPTO3",,"",,nTam+7,.T.,,"LEFT")
	TRCell():New(oSection2,"GRUPO13",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO23",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO33",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO43",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO53",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO63",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO73",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO83",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"GRUPO93",,"",,nTam,.T.,,"CENTER")
	TRCell():New(oSection2,"TOTAL3",,"",,nTam,.T.,,"RIGHT")
	
	TRCell():New(oSection3,"TOTAL",,"",,nTam,.T.,,"RIGHT")
	oSection3:Cell("TOTAL"):SetCellBreak(.T.)
	TRCell():New(oSection3,"TOTAL2",,"",,nTam,.T.,,"RIGHT")
	TRCell():New(oSection5,"TOTAL",,"",,nTam,.T.,,"RIGHT")
	TRCell():New(oSection7,"TOTAL",,"",,nTam,.T.,,"RIGHT")
	TRCell():New(oSection9,"TOTAL",,"",,nTam,.T.,,"RIGHT")
	oSection2:Cell("TOTAL"):SetValue("TOTAL")
	For nFil := 1 to len (aFiliales)
		cFil := aFiliales[nFil]
		If HayTrabajadores(cFil)
			nNum++
			oSection1:Init()
			SM0->(dbSeek(SM0->M0_CODIGO+cFil))
			oSection1:Cell("EMPRESA"):SetValue(Alltrim(SM0->M0_CODIGO)+" "+Alltrim(SM0->M0_NOMECOM))
			oSection1:Cell("SUCURSAL"):SetValue(Alltrim(SM0->M0_CODFIL)+" "+Alltrim(SM0->M0_FILIAL))
			oSection1:Cell("ANIO"):SetValue(cAnio+"-"+DescriMes(cMes))
			oSection1:printline()
			oReport:Fatline()
			oSection1:Finish()
			
			oSection2:Init()
			oSection2:Cell("CONCEPTO"):SetValue(STR0033) //COMPONENTES DEL
			oSection2:Cell("GRUPO1"):SetValue("01")
			oSection2:Cell("GRUPO2"):SetValue("02")
			oSection2:Cell("GRUPO3"):SetValue("03")
			oSection2:Cell("GRUPO4"):SetValue("04")
			oSection2:Cell("GRUPO5"):SetValue("51")
			oSection2:Cell("GRUPO6"):SetValue("52")
			oSection2:Cell("GRUPO7"):SetValue("07")
			oSection2:Cell("GRUPO8"):SetValue("08")
			oSection2:Cell("GRUPO9"):SetValue("09")
			
			oSection2:Cell("CONCEPTO1"):SetValue(STR0034) //COSTO DE LA MANO DE OBRA Y DE
			oSection2:Cell("GRUPO11"):SetValue(STR0036) //Directores
			oSection2:Cell("GRUPO21"):SetValue(STR0038) //Profesionales
			oSection2:Cell("GRUPO31"):SetValue(STR0041) //Tecnicos
			oSection2:Cell("GRUPO41"):SetValue(STR0044) //Trabajadores
			oSection2:Cell("GRUPO51"):SetValue(STR0047) //Trab. de serv
			oSection2:Cell("GRUPO61"):SetValue(STR0050) //Vendedores
			oSection2:Cell("GRUPO71"):SetValue(STR0053) //Operarios
			oSection2:Cell("GRUPO81"):SetValue(STR0056) //Operadores y
			oSection2:Cell("GRUPO91"):SetValue(STR0059) //Trabajadores
			
			oSection2:Cell("CONCEPTO2"):SetValue(STR0035+" "+STR0063)
			oSection2:Cell("GRUPO12"):SetValue(STR0037) //y Gerentes
			oSection2:Cell("GRUPO22"):SetValue(STR0039) //(incluye Ejecutivo
			oSection2:Cell("GRUPO32"):SetValue(STR0042) //(incluye vendedor
			oSection2:Cell("GRUPO42"):SetValue(STR0045) //de apoyo
			oSection2:Cell("GRUPO52"):SetValue(STR0048) //person., protec
			oSection2:Cell("GRUPO62"):SetValue(STR0051) //Promotores
			oSection2:Cell("GRUPO72"):SetValue(STR0054) //manuales y
			oSection2:Cell("GRUPO82"):SetValue(STR0057) //montadores de
			oSection2:Cell("GRUPO92"):SetValue(STR0060) //no
			
			oSection2:Cell("CONCEPTO3"):SetValue("")
			oSection2:Cell("GRUPO13"):SetValue("")
			oSection2:Cell("GRUPO23"):SetValue(STR0040) //de ventas)
			oSection2:Cell("GRUPO33"):SetValue(STR0043) //tecnico)
			oSection2:Cell("GRUPO43"):SetValue(STR0046) //administrativo
			oSection2:Cell("GRUPO53"):SetValue(STR0049) //y seguridad
			oSection2:Cell("GRUPO63"):SetValue(STR0052) //y modelos
			oSection2:Cell("GRUPO73"):SetValue(STR0055) //artesanos
			oSection2:Cell("GRUPO83"):SetValue(STR0058) //instal. y maquinas
			oSection2:Cell("GRUPO93"):SetValue(STR0061) //especializados
			oSection2:Printline()
			oReport:FatLine()
			oSection2:Finish()
			
			oSection3:Init()
			oSection3:Cell("SECCION"):SetValue(STR0014) //"SECCIÓN III: MUJERES DIRECTAMENTE CONTRATADAS POR LA EMPRESA"
			oSection3:Cell("TITULO"):SetValue(STR0015) //"N Ú M E R O   D E   T R A B A J A D O R E S   E N   E L   M E S   D E   R E F E R E N C I A"
			NumeroTrab("F",cFil)
			
			oSection4:Init()
			oSection4:Cell("TITULO"):SetValue(STR0016) //"M O N T O  D E  L A S  C O M P O N E N T E S  E N  E L  M E S  D E  R E F E R E N C I A  (E N  P E S O S)"
			oSection4:PrintLine()
			oSection4:Finish()
			oSection5:Init()
			MontoPerce("F", "1", cFil, oReport)
			
			oSection6:Init()
			oSection6:Cell("TITULO"):SetValue(STR0017) //"M O N T O  D E  L A S  D E D U C C I O N E S  L E G A L E S  E N  E L  M E S  D E  R E F E R E N C I A  (E N  P E S O S)"
			oSection6:PrintLine()
			oSection6:Finish()
			oSection7:Init()
			MontoPerce("F", "2", cFil, oReport)
			
			oSection8:Init()
			oSection8:Cell("TITULO"):SetValue(STR0018) //"N Ú M E R O  D E  H O R A S  P A G A D A S  E N  E L  M E S  D E  R E F E R E N C I A"
			oSection8:PrintLine()
			oSection8:Finish()
			oSection9:Init()
			HorasPagad("F", "ORD", cFil)
			HorasPagad("F", "EXT", cFil)
			
			oReport:FatLine()
			
			oSection3:Init()
			oSection3:Cell("SECCION"):SetValue(STR0019) //"SECCIÓN IV: HOMBRES DIRECTAMENTE CONTRATADAS POR LA EMPRESA"
			oSection3:Cell("TITULO"):SetValue(STR0015) //"N Ú M E R O   D E   T R A B A J A D O R E S   E N   E L   M E S   D E   R E F E R E N C I A"
			NumeroTrab("M", cFil)
			
			oSection4:Init()
			oSection4:Cell("TITULO"):SetValue(STR0016) //"M O N T O  D E  L A S  C O M P O N E N T E S  E N  E L  M E S  D E  R E F E R E N C I A  (E N  P E S O S)"
			oSection4:PrintLine()
			oSection4:Finish()
			oSection5:Init()
			MontoPerce("M", "1", cFil, oReport)
			
			oSection6:Init()
			oSection6:Cell("TITULO"):SetValue(STR0017) //"M O N T O  D E  L A S  D E D U C C I O N E S  L E G A L E S  E N  E L  M E S  D E  R E F E R E N C I A  (E N  P E S O S)"
			oSection6:PrintLine()
			oSection6:Finish()
			oSection7:Init()
			MontoPerce("M", "2", cFil, oReport)
			
			oSection8:Init()
			oSection8:Cell("TITULO"):SetValue(STR0018) //"N Ú M E R O  D E  H O R A S  P A G A D A S  E N  E L  M E S  D E  R E F E R E N C I A"
			oSection8:PrintLine()
			oSection8:Finish()
			oSection9:Init()
			HorasPagad("M", "ORD", cFil)
			HorasPagad("M", "EXT", cFil)
			oReport:EndPage()
		EndIf
	Next nFil
	IF nNum < 1
		MsgAlert(STR0076) //"No existe información con los parametros proporcionados"
		oReport:EndReport()
		oReport:CancelPrint()
	EndIf
Else
	oReport:SetTitle(STR0001+"-"+STR0032)
	TRCell():New(oSection2,"CONCEPTO",,"",,20,.T.,,"LEFT")
	TRCell():New(oSection2,"CONTRATO",,"",,34,.T.,,"LEFT")
	TRCell():New(oSection2,"DESVINCU",,"",,34,.T.,,"LEFT")
	TRCell():New(oSection2,"LICENCIA",,"",,46,.T.,,"LEFT")
	TRCell():New(oSection2,"CONCEPTO1",,"",,20,.T.,,"LEFT")
	TRCell():New(oSection2,"CONTRATO2",,"",,34,.T.,,"LEFT")
	TRCell():New(oSection2,"DESVINCU2",,"",,34,.T.,,"LEFT")
	TRCell():New(oSection2,"LICENCIA2",,"",,46,.T.,,"LEFT")
	oSection2:Cell("LICENCIA"):SetCellBreak(.T.)
	oSection2:Cell("LICENCIA2"):SetCellBreak(.T.)
	TRCell():New(oSection2,"CONCEPTO2",,"",,17,.T.,,"RIGHT")
	TRCell():New(oSection2,"MUJERESD",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection2,"HOMBRESD",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection2,"TOTALD",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection2,"MUJERESC",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection2,"HOMBRESC",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection2,"TOTALC",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection2,"MUJERESL",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection2,"HOMBRESL",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection2,"TOTALL",,"",,10,.T.,,"RIGHT")
	
	TRCell():New(oSection5,"CONCEPTO",,"",,nTam,.T.,,"LEFT")
	TRCell():New(oSection5,"MUJERESD",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection5,"HOMBRESD",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection5,"TOTALD",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection5,"MUJERESC",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection5,"HOMBRESC",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection5,"TOTALC",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection5,"MUJERESL",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection5,"HOMBRESL",,"",,10,.T.,,"RIGHT")
	TRCell():New(oSection5,"TOTALL",,"",,10,.T.,,"RIGHT")
	For nFil := 1 to len (aFiliales)
		cFil := aFiliales[nFil]
		IF HayTrabV(cFil)
			nNum++
			oSection1:Init()
			SM0->(dbSeek(SM0->M0_CODIGO+cFil))
			oSection1:Cell("EMPRESA"):SetValue(Alltrim(SM0->M0_CODIGO)+" "+Alltrim(SM0->M0_NOMECOM))
			oSection1:Cell("SUCURSAL"):SetValue(Alltrim(SM0->M0_CODFIL)+" "+Alltrim(SM0->M0_FILIAL))
			oSection1:Cell("ANIO"):SetValue(cAnio+"-"+DescriMes(cMes))
			oSection1:printline()
			oReport:Fatline()
			oSection1:Finish()
			
			oSection2:Init()
			oSection2:Cell("CONCEPTO2"):SetValue(STR0020) //"GRUPO OCUPACIONAL"
			oSection2:Cell("CONTRATO"):SetValue("5.1 "+STR0021) //"5.1 Número de Trabajadores desvinculados de la empresa"
			oSection2:Cell("DESVINCU"):SetValue("5.2 "+STR0021) //"5.2 Número de Trabajadores con nuevo contrato en la empresa"
			oSection2:Cell("LICENCIA"):SetValue("5.3 "+STR0023) //"5.3 Número de Trabajadores con licencia médica"
			oSection2:Cell("CONTRATO2"):SetValue(STR0022) //"5.1 Número de Trabajadores desvinculados de la empresa"
			oSection2:Cell("DESVINCU2"):SetValue(STR0062) //"5.2 Número de Trabajadores con nuevo contrato en la empresa"
			oSection2:Cell("LICENCIA2"):SetValue("") //"5.3 Número de Trabajadores con licencia médica"
			oSection2:Cell("MUJERESD"):SetVAlue(STR0024) //"Mujeres"
			oSection2:Cell("HOMBRESD"):SetVAlue(STR0025) //"Hombres"
			oSection2:Cell("TOTALD"):SetVAlue(STR0026) //"Total"
			oSection2:Cell("MUJERESC"):SetVAlue(STR0024)
			oSection2:Cell("HOMBRESC"):SetVAlue(STR0025)
			oSection2:Cell("TOTALC"):SetVAlue(STR0026)
			oSection2:Cell("MUJERESL"):SetVAlue(STR0024)
			oSection2:Cell("HOMBRESL"):SetVAlue(STR0025)
			oSection2:Cell("TOTALL"):SetVAlue(STR0026)
			oSection2:PrintLine()
			oReport:FatLine()
			oSection2:Finish()
			
			oSection3:Init()
			oSection3:Cell("SECCION"):SetValue(STR0027) //"SECCIÓN V: NÚMERO DE TRABAJADORES SÓLO CON CONTRATO EN LA EMPRESA"
			oSection3:PrintLine()
			oSection3:Finish()
			
			oSection5:Init()
			SeccionV(cFil,oReport)
			oReport:EndPage()
		EndIf
	Next nFil
	IF nNum < 1
		MsgAlert(STR0076) //"No existe información con los parametros proporcionados"
		oReport:EndReport()
		oReport:CancelPrint()
	EndIf
EndIf
Return

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³GruposOcup³ Autor ³ Jesus Peñaloza        ³ Data ³26/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Obtiene la lista de grupos ocupacionales                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ GruposOcup()                                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function GruposOcup()
Local aGrupos:= {}
Local nX
Local cQuery := "SELECT DISTINCT RJ_CVEINE FROM "+RetSqlName("SRJ")+" WHERE RJ_FILIAL = '"+xFilial("SRJ")+"' AND D_E_L_E_T_ = ''"
Local cTempF := CriaTrab(Nil, .F.)

cQuery := ChangeQuery(cQuery)
dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cTempF,.T.,.T.)
(cTempF)->(dbGoTop())

For nX=1 to 9
	aAdd(aGrupos, '0' + alltrim(str(nX)))
next


(cTempF)->(dbCloseArea())
Return aGrupos

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³NumeroTrab³ Autor ³ Jesus Peñaloza        ³ Data ³26/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Obtiene el numero de trabajadores en relacion al año y mes ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ NumeroTrab(cExp1,cExp2)                                    ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ cExp1: Sexo a buscar (M=Masculino, F=Femenino)             ³±±
±±³          ³ oExp2: Numero de filial                                    ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function NumeroTrab(cSexo,cFil)
Local cTempF := CriaTrab(Nil, .F.)
Local cQuery := ''
Local nX := 0
Local cFunc := ''
Local cClave:= ''
Local nCont := 0
Local nTotal := 0
cQuery := "SELECT RD_FILIAL, RD_MAT, RJ_FUNCAO, RJ_CVEINE, RCH_DTINI "
cQuery += "FROM "+RetSqlName("RCH")+" RCH, "+RetSqlName("SRD")+" SRD, "+RetSqlName("SRA")+" SRA, "+RetSqlName("SRJ")+" SRJ "
cQuery += "WHERE RD_PERIODO+RD_SEMANA = RCH_PER+ RCH_NUMPAG "
cQuery += "AND RD_FILIAL='"+xFilial("SRD", cFil)+"' AND RA_FILIAL='"+xFilial("SRA", cFil)+"' "
cQuery += "AND RCH_FILIAL ='"+xFilial("RCH", cFil)+"' AND RJ_FILIAL = '"+xFilial("SRJ", cFil)+"' "
cQuery += "AND RD_MAT = RA_MAT "
cQuery += "AND RJ_CVEINE <> '' "
cQuery += "AND RCH.RCH_ANO = '"+cAnio+"' AND RCH.RCH_MES = '"+cMes+"' " 
cQuery += "AND SRA.RA_SEXO = '"+cSexo+"' "
cQuery += "AND RCH.RCH_ROTEIR = (SELECT RY_CALCULO FROM "+RetSqlName("SRY")+" WHERE RY_TIPO = '1' AND D_E_L_E_T_ = '') "
cQuery += "AND RCH.D_E_L_E_T_ = '' AND SRD.D_E_L_E_T_ = '' AND SRA.D_E_L_E_T_ = '' AND SRJ.D_E_L_E_T_ = '' " 
cQuery += "GROUP BY RJ_CVEINE, RD_FILIAL, RD_MAT, RJ_FUNCAO, RCH_DTINI "
cQuery += "ORDER BY RJ_CVEINE "
cQuery := ChangeQuery(cQuery)
dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cTempF,.T.,.T.)
(cTempF)->(dbGoTop())
oSection3:Cell("CONCEPTO"):SetValue("TOTAL")
While (!(cTempF)->(EOF()))
	cClave := (cTempF)->RJ_CVEINE
	nCont := 0
	While (!(cTempF)->(EOF()) .and. (cTempF)->RJ_CVEINE == cClave)
		cFunc := fBusHisFun((cTempF)->RD_FILIAL,(cTempF)->RD_MAT,STOD((cTempF)->RCH_DTINI),1,,.T.)
		If cFunc == Alltrim((cTempF)->RJ_FUNCAO)
			nCont++
		EndIf
		(cTempF)->(dbSkip())
	EndDo
	For nX := 1 to len(aGrupos)
		If aGrupos[nX] == cClave
			oSection3:Cell("GRUPO"+Alltrim(Str(nX))):SetValue(Alltrim(Str(nCont)))
			nTotal+=nCont
		ElseIf Empty(oSection3:Cell("GRUPO"+Alltrim(Str(nX))):GetValue())
			oSection3:Cell("GRUPO"+Alltrim(Str(nX))):SetValue("0")
		EndIf
	Next nX
EndDo
oSection3:Cell("TOTAL"):SetValue(Alltrim(Str(nTotal)))
oSection3:Printline()
/*For nX := 1 to len(aGrupos)
	oSection3:Cell("GRUPO"+Alltrim(Str(nX))):SetValue("")
Next nX
oSection3:Cell("TOTAL"):SetValue("")
(cTempF)->(dbCloseArea())
oSection3:Printline()*/
oSection3:Finish()
Return

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³MontoPerce³ Autor ³ Jesus Peñaloza        ³ Data ³26/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Obtiene las percepciones/deducciones del mes y año         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ MontoPerce(cExp1,cExp2,cExp3,oExp4)                        ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ cExp1: Sexo a buscar (M=Masculino, F=Femenino)             ³±±
±±³          ³ oExp2: Tipo (1=Percepciones, 2=Deducciones)                ³±±
±±³          ³ oExp3: Numero de filial                                    ³±±
±±³          ³ oExp4: Objeto oReport para incrementar barra de progreso   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function MontoPerce(cSexo,cTipo,cFil,oReport)
Local aArea
Local cTempF := CriaTrab(Nil, .F.)
Local cQuery := ''
Local cConcepto := ''
Local nX   := 0
Local nY   := 0
Local nAux := 0
Local lPerce := Iif(cTipo=='1',.T.,.F.)
Local aTotal := {}
Local cFunc := ''
Local cClave:= ''
Local nCont := 0
Local nTotal := 0
Local nCount := 0
Local cDescri := ''
Local	nk := 0
Local cConcp	:= ''
cQuery := "SELECT RD_FILIAL, RD_MAT, RD_VALOR, RA_CODFUNC, RJ_FUNCAO, RJ_CVEINE, RV_CVEINE, RCH_DTINI "
cQuery += "FROM "+RetSqlName("RCH")+" RCH, "+RetSqlName("SRD")+" SRD, "+RetSqlName("SRA")+" SRA, "+RetSqlName("SRJ")+" SRJ, "+RetSqlName("SRV")+" SRV "
cQuery += "WHERE RD_PERIODO+RD_SEMANA = RCH_PER+ RCH_NUMPAG "
cQuery += "AND RD_FILIAL = '"+xFilial("SRD", cFil)+"' AND RA_FILIAL = '"+xFilial("SRA", cFil)+"' AND RCH_FILIAL ='"+xFilial("RCH", cFil)+"' "
cQuery += "AND RJ_FILIAL = '"+xFilial("SRJ", cFil)+"' AND RV_FILIAL = '"+xFilial("SRV", cFil)+"' "
cQuery += "AND RD_MAT = RA_MAT "
cQuery += "AND RD_PD = RV_COD "
cQuery += "AND RV_TIPOCOD = '"+cTipo+"' "
cQuery += "AND RV_CVEINE <> '' AND RJ_CVEINE <> '' "
cQuery += "AND RCH.RCH_ANO = '"+cAnio+"' AND RCH.RCH_MES = '"+cMes+"' "
cQuery += "AND SRA.RA_SEXO = '"+cSexo+"' "
cQuery += "AND RCH.RCH_ROTEIR = (SELECT RY_CALCULO FROM "+RetSqlName("SRY")+" WHERE RY_TIPO = '1' AND D_E_L_E_T_ = '') "
cQuery += "AND RCH.D_E_L_E_T_ = '' AND SRD.D_E_L_E_T_ = '' AND SRA.D_E_L_E_T_ = '' "
cQuery += "AND SRJ.D_E_L_E_T_ = '' AND SRV.D_E_L_E_T_ = '' "
cQuery += "GROUP BY  RJ_CVEINE, RV_CVEINE, RD_FILIAL, RD_MAT, RD_VALOR, RA_CODFUNC, RJ_FUNCAO, RCH_DTINI "
cQuery += "ORDER BY RV_CVEINE "
cQuery := ChangeQuery(cQuery)
dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cTempF,.T.,.T.)
count to nCount
oReport:SetMeter(nCount)
(cTempF)->(dbGoTop())
While (!(cTempF)->(EOF()))
	cConcepto := (cTempF)->RV_CVEINE
	cDescri := ''
	cClave := (cTempF)->RJ_CVEINE
	nCont := 0
	//nTotal := 0
	dbSelectArea("SX5")
	SX5->(dbSetOrder(1))
	If SX5->(dbSeek(xFilial("SX5")+"UD"+cConcepto))
		cDescri := SX5->X5_DESCRI
	EndIf
	
		If lPerce
			oSection5:Cell("CONCEPTO"):SetValue(cConcepto+" "+cDescri)
		Else
			oSection7:Cell("CONCEPTO"):SetValue(cConcepto+" "+cDescri)
		EndIf

		While (!(cTempF)->(EOF())) .and. (cTempF)->RV_CVEINE == cConcepto .And. (cTempF)->RJ_CVEINE == cClave
			cFunc := fBusHisFun((cTempF)->RD_FILIAL,(cTempF)->RD_MAT,STOD((cTempF)->RCH_DTINI),1,,.T.)
			If cFunc == Alltrim((cTempF)->RJ_FUNCAO)
				nCont+= (cTempF)->RD_VALOR
			EndIf
			(cTempF)->(dbSkip())
			nk++
			oReport:IncMeter()
		EndDo
	
	For nX := 1 to len(aGrupos)
		If aGrupos[nX] == cClave
			If lPerce
				oSection5:Cell("GRUPO"+Alltrim(Str(nX))):SetValue(Transform(nCont, cPict))
				nTotal += nCont
			Else
				oSection7:Cell("GRUPO"+Alltrim(Str(nX))):SetValue(Transform(nCont, cPict))
				nTotal += nCont
			EndIf
			aAdd(aTotal, {aGrupos[nX], nCont})
		Else
			If lPerce
				If Empty(oSection5:Cell("GRUPO"+Alltrim(Str(nX))):GetValue())
					oSection5:Cell("GRUPO"+Alltrim(Str(nX))):SetValue("0.00")
				EndIf
			Else
				If Empty(oSection7:Cell("GRUPO"+Alltrim(Str(nX))):GetValue())
					oSection7:Cell("GRUPO"+Alltrim(Str(nX))):SetValue("0.00")
				EndIf
			EndIf
		EndIf
	Next nX
	nk:=0
	
	IF cConcepto != (cTempF)->RV_CVEINE
		nk++
		If lPerce
			oSection5:Cell("TOTAL"):SetValue(Transform(nTotal, cPict))
			oSection5:Printline()
		Else
			oSection7:Cell("TOTAL"):SetValue(Transform(nTotal, cPict))
			oSection7:Printline()
		EndIf
		nTotal := 0
	ENdif

EndDo


IF nk == 0
	If lPerce
				oSection5:Cell("TOTAL"):SetValue(Transform(nTotal, cPict))
				oSection5:Printline()
		Else
				oSection7:Cell("TOTAL"):SetValue(Transform(nTotal, cPict))
				oSection7:Printline()
	EndIf
EndIF

(cTempF)->(dbCloseArea())
nTotal := 0
If lPerce
	oSection5:Cell("CONCEPTO"):SetValue(STR0030) //"TOTAL"
Else
	oSection7:Cell("CONCEPTO"):SetValue(STR0030) //"TOTAL"
EndIf
For nX := 1 to len(aGrupos)
	nAux := 0
	For nY := 1 to len(aTotal)
		If nX == len(aGrupos)
			nTotal += aTotal[nY,2]
		EndIf
		If aGrupos[nX] == aTotal[nY,1]
			nAux += aTotal[nY,2]
		EndIf
	Next nY
	If lPerce
		oSection5:Cell("GRUPO"+Alltrim(Str(nX))):SetValue(Transform(nAux,cPict))
	Else
		oSection7:Cell("GRUPO"+Alltrim(Str(nX))):SetValue(Transform(nAux,cPict))
	EndIf
Next nX
If lPerce
	oSection5:Cell("TOTAL"):SetValue(Transform(nTotal, cPict))
	oSection5:Printline()
	oSection5:Cell("TOTAL"):SetValue("")
	oSection5:Cell("CONCEPTO"):SetValue("")
	For nX := 1 to len(aGrupos)
		oSection5:Cell("GRUPO"+Alltrim(Str(nX))):SetValue("")
	Next nX
	oSection5:Printline()
	oSection5:Finish()
Else
	oSection7:Cell("TOTAL"):SetValue(Transform(nTotal, cPict))
	oSection7:Printline()
	oSection7:Cell("TOTAL"):SetValue("")
	oSection7:Cell("CONCEPTO"):SetValue("")
	For nX := 1 to len(aGrupos)
		oSection7:Cell("GRUPO"+Alltrim(Str(nX))):SetValue("")
	Next nX
	oSection7:Printline()
	oSection7:Finish()
EndIf
Return


/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³HorasPagad³ Autor ³ Jesus Peñaloza        ³ Data ³26/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Obtiene las horas ordinarias y extraordinarias             ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ HorasPagad(cExp1,cExp2,cExp3)                              ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ cExp1: Sexo a buscar (M=Masculino, F=Femenino)             ³±±
±±³          ³ oExp2: Tipo de horas (ORD=Ordinarias, EXT=Extraordinarias) ³±±
±±³          ³ oExp3: Numero de filial                                    ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function HorasPagad(cSexo,cTipo,cFil)
Local cTempF := CriaTrab(Nil, .F.)
Local cQuery := ''
Local cConcepto := ''
Local nX := 0
Local nY   := 0
Local nAux := 0
Static aTotal := {}
Local cFunc := ''
Local cClave:= ''
Local nCont := 0
Local nTotal := 0
For nX := 1 to len(aGrupos)
	oSection9:Cell("GRUPO"+Alltrim(Str(nX))):SetValue("0.00")
Next nX
oSection9:Cell("TOTAL"):SetValue("0.00")
cQuery := "SELECT RD_FILIAL, RD_MAT, RD_HORAS, RJ_FUNCAO, RJ_CVEINE, RV_CVEINE, RCH_DTINI "
cQuery += "FROM "+RetSqlName("RCH")+" RCH, "+RetSqlName("SRD")+" SRD, "+RetSqlName("SRA")+" SRA, "+RetSqlName("SRJ")+" SRJ, "+RetSqlName("SRV")+" SRV "
cQuery += "WHERE RCH.RCH_ANO = '"+cAnio+"' AND RCH.RCH_MES = '"+cMes+"' "
cQuery += "AND RD_PERIODO+RD_SEMANA = RCH_PER+ RCH_NUMPAG "
cQuery += "AND RD_FILIAL = '"+xFilial("SRD", cFil)+"' AND RA_FILIAL = '"+xFilial("SRA", cFil)+"' AND RCH_FILIAL ='"+xFilial("RCH", cFil)+"' "
cQuery += "AND RJ_FILIAL = '"+xFilial("SRJ", cFil)+"' AND RV_FILIAL = '"+xFilial("SRV", cFil)+"' "
cQuery += "AND RD_MAT = RA_MAT "
cQuery += "AND RJ_CVEINE <> '' "
//cQuery += "AND RV_CVEINE <> '' AND RJ_CVEINE <> '' "
If cTipo == "ORD"
	cQuery += "AND RD_PD = '043' "
Else
	cQuery += "AND RD_PD IN('050','051','052','053') "
EndIf
cQuery += "AND SRA.RA_SEXO = '"+cSexo+"' "
cQuery += "AND RCH.RCH_ROTEIR = (SELECT RY_CALCULO FROM "+RetSqlName("SRY")+" WHERE RY_TIPO = '1' AND D_E_L_E_T_ = '') "
cQuery += "AND RCH.D_E_L_E_T_ = '' AND SRD.D_E_L_E_T_ = '' AND SRA.D_E_L_E_T_ = '' AND SRJ.D_E_L_E_T_ = '' AND SRV.D_E_L_E_T_ = '' "
cQuery += "GROUP BY RJ_CVEINE, RV_CVEINE, RD_FILIAL, RD_MAT, RD_HORAS, RJ_FUNCAO, RCH_DTINI "
//cQuery += "ORDER BY RJ_CVEINE "
cQuery += " ORDER BY RJ_CVEINE,RD_FILIAL, RD_MAT "
cQuery := ChangeQuery(cQuery)
dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cTempF,.T.,.T.)
(cTempF)->(dbGoTop())
If cTipo == 'ORD'
	oSection9:Cell("CONCEPTO"):SetValue(STR0028) //"ORDINARIAS"
Else
	oSection9:Cell("CONCEPTO"):SetValue(STR0029) //"EXTRAORDINARIAS"
EndIf
While (!(cTempF)->(EOF()))
	cConcepto := (cTempF)->RV_CVEINE
	cClave := (cTempF)->RJ_CVEINE
	nCont := 0
	//nTotal := 0
	While (!(cTempF)->(EOF())) .and.(cTempF)->RJ_CVEINE == cClave
		cFunc := fBusHisFun((cTempF)->RD_FILIAL,(cTempF)->RD_MAT,STOD((cTempF)->RCH_DTINI),1,,.T.)
		If cFunc == Alltrim((cTempF)->RJ_FUNCAO)
			nCont+= (cTempF)->RD_HORAS
		EndIf
		(cTempF)->(dbSkip())
	EndDo
	For nX := 1 to len(aGrupos)
		If aGrupos[nX] == cClave
			oSection9:Cell("GRUPO"+Alltrim(Str(nX))):SetValue(Transform(nCont, cPict))
			nTotal += nCont
			aAdd(aTotal, {aGrupos[nX], nCont})
		ElseIf Empty(oSection9:Cell("GRUPO"+Alltrim(Str(nX))):GetValue())
			oSection9:Cell("GRUPO"+Alltrim(Str(nX))):SetValue("0.00")
		EndIf
	Next nX
	
	
	If cClave != (cTempF)->RJ_CVEINE
		oSection9:Cell("TOTAL"):SetValue(Transform(nTotal, cPict))
		//nTotal := 0
	EndIf

	
EndDo

oSection9:Printline()




nTotal := 0
(cTempF)->(dbCloseArea())
If cTipo != "ORD"
	oSection9:Cell("CONCEPTO"):SetValue(STR0030) //"TOTAL"
	For nX := 1 to len(aGrupos)
		nAux := 0
		For nY := 1 to len(aTotal)
			If nX == len(aGrupos)
				nTotal += aTotal[nY,2]
			EndIf
			If aGrupos[nX] == aTotal[nY,1]
				nAux += aTotal[nY,2]
			EndIf
		Next nY
		oSection9:Cell("GRUPO"+Alltrim(Str(nX))):SetValue(Transform(nAux,cPict))
		oSection9:Cell("TOTAL"):SetValue(Transform(nTotal,cPict))
	Next nX
	oSection9:PrintLine()
	oSection9:Finish()
	aTotal := {}
EndIf
Return

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³ SeccionV ³ Autor ³ Jesus Peñaloza        ³ Data ³30/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Impresion de seccion V del Informe INE                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ SeccionV(cFil,oReport)                                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ cExp1: Numero de Filial                                    ³±±
±±³          ³ oExp2: Objeto oReport para incrementar la barra de progreso³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function SeccionV(cFil,oReport)
Local cTempF 		:= CriaTrab(Nil, .F.)
Local cQuery 		:= ''
Local cFunc 		:= ''
Local cFuncion 	:= ''
Local cBaja 		:= ''
Local cSexo 		:= ''
Local cAlta 		:= ''
Local cAltPro		:= ''
Local cClave		:= ''
Local cDescri 	:= ''
Local cMat 		:= ''
Local nMd 		:= 0
Local nHd 		:= 0
Local nMc 		:= 0
Local nHc 		:= 0
Local nMl 		:= 0
Local nHl 		:= 0
Local lLicM 		:= .F.
Local lLicH 		:= .F.
Local nTotal 		:= 0

cQuery := "SELECT RA_FILIAL RD_FILIAL, RA_MAT RD_MAT, '' RD_PD, RA_ADMISSA, RA_DEMISSA, RA_SEXO,  RA_CODFUNC,  RJ_CVEINE, '' RCH_DTINI, '' RA_DTCONIN "
cQuery += "FROM "+RetSqlName("SRA")+" SRA, "+RetSqlName("SRJ")+" SRJ "
cQuery += "WHERE RA_FILIAL = '"+xFilial("SRA",cFil)+"' AND RJ_FILIAL = '"+xFilial("SRJ", cFil)+"' "
cQuery += "AND RJ_CVEINE <> '' AND RA_CODFUNC = RJ_FUNCAO "
cQuery += "AND ( (RA_DEMISSA <> '' AND RA_DEMISSA like  '" + cAnio + cMes + "%' ) OR (RA_ADMISSA like  '" + cAnio + cMes + "%' )) "
cQuery += " AND SRA.D_E_L_E_T_ = ' '  AND SRJ.D_E_L_E_T_ = ' '   "
cQuery += "UNION "
cQuery += "SELECT RD_FILIAL, RD_MAT, RD_PD, RA_ADMISSA, RA_DEMISSA, RA_SEXO, RJ_FUNCAO, RJ_CVEINE, RCH_DTINI, RA_DTCONIN "
cQuery += "FROM "+RetSqlName("SRA")+" SRA, "+RetSqlName("SRD")+" SRD, "+RetSqlName("SRJ")+" SRJ, "+RetSqlName("RCH")+" RCH "
cQuery += "WHERE RA_MAT = RD_MAT "
cQuery += "AND RA_CODFUNC = RJ_FUNCAO "
cQuery += "AND RD_FILIAL = '"+xFilial("SRD", cFil)+"' AND RA_FILIAL = '"+xFilial("SRA",cFil)+"' AND RCH_FILIAL ='"+xFilial("RCH", cFil)+"' "
cQuery += "AND RJ_FILIAL = '"+xFilial("SRJ", cFil)+"' "
cQuery += "AND RD_PERIODO = RCH_PER AND RD_SEMANA=RCH_NUMPAG AND RJ_CVEINE <> ''"
cQuery += "AND RCH.RCH_ANO = '"+cAnio+"' AND RCH.RCH_MES = '"+cMes+"' "
cQuery += "AND RCH.RCH_ROTEIR = (SELECT RY_CALCULO FROM "+RetSqlName("SRY")+" WHERE RY_TIPO = '1' AND D_E_L_E_T_ = '') "
cQuery += "AND RD_PD IN (SELECT RCM_PD FROM "+RetSqlName("RCM")+" WHERE RCM_TPIMSS = '03' AND RCM_FILIAL = '" + xFilial("RCM") + "' AND D_E_L_E_T_ = '') "
cQuery += "AND SRA.D_E_L_E_T_ = '' AND SRD.D_E_L_E_T_ = '' AND SRJ.D_E_L_E_T_ = '' AND RCH.D_E_L_E_T_ = '' "
cQuery += "GROUP BY RJ_CVEINE, RD_FILIAL, RD_MAT, RD_PD, RA_ADMISSA, RA_DEMISSA, RA_SEXO, RJ_FUNCAO, RCH_DTINI, RA_DTCONIN "
cQuery += "ORDER BY  RJ_CVEINE,RD_MAT "
cQuery := ChangeQuery(cQuery)
dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cTempF,.T.,.T.)
count to nTotal
oReport:SetMeter(nTotal)
(cTempF)->(dbGoTop())
While (!(cTempF)->(EOF()))
	cClave := (cTempF)->RJ_CVEINE
	nMd := 0
	nHd := 0
	nMc := 0
	nHc := 0
	nMl := 0
	nHl := 0
	While (!(cTempF)->(EOF())) .and. (cTempF)->RJ_CVEINE == cClave
		cMat := (cTempF)->RD_MAT
		cFuncion := (cTempF)->RA_CODFUNC
		cBaja := (cTempF)->RA_DEMISSA
		cSexo := (cTempF)->RA_SEXO
		cAlta := (cTempF)->RA_ADMISSA
		cAltPro:= (cTempF)->RA_DTCONINI
		lLicM := .F.
		lLicH := .F.
		cFunc := fBusHisFun((cTempF)->RD_FILIAL,(cTempF)->RD_MAT,STOD((cTempF)->RCH_DTINI),1,,.T.)
	//	While (!(cTempF)->(EOF())) .and. (cTempF)->RJ_CVEINE == cClave 
			If (cFunc == Alltrim(cFuncion) .OR. empty(cFunc)) .AND. !EMPTY((cTempF)->RD_PD) 
				//If (cTempF)->RD_PD $ "601|602|603"
					If (cTempF)->RA_SEXO == 'F'
						lLicM := .T.
					Else
						lLicH := .T.
					EndIf
				//EndIf
			EndIf
			//(cTempF)->(dbSkip())
			oReport:IncMeter()
		//EndDo
		If cFunc == Alltrim(cFuncion) .OR. empty(cFunc) .AND. !EMPTY((cTempF)->RD_PD)
			If substr(cAlta,1,6) == cAnio+cMes .or. substr(cAltPro,1,6) == cAnio+cMes 
				If cSexo == 'F'
					nMc++
				Else
					nHc++
				EndIf
			EndIf
			If substr(cBaja,1,6) == cAnio+cMes .AND. EMPTY((cTempF)->RD_PD)
				If cSexo == 'F'
					nMd++
				Else
					nHd++
				EndIf
			EndIf
			If lLicM
				nMl++
			EndIf
			If lLicH
				nHl++
			EndIf
		EndIf
		(cTempF)->(dbSkip())
	EndDo
	If nMd > 0 .or. nHd > 0 .or. nMc > 0 .or. nHc > 0 .or. nMl > 0 .or. nHl > 0
		dbSelectArea("SX5")
		SX5->(dbSetOrder(1))
		//If SX5->(dbSeek(xFilial("SX5")+"ZW"+cClave))
		If SX5->(dbSeek(xFilial("SX5")+"VW"+cClave))
			cDescri := SX5->X5_DESCRI
		EndIf
		oSection5:Cell("CONCEPTO"):SetValue(cClave+" "+cDescri)
		oSection5:Cell("MUJERESD"):SetValue(Transform(nMd,cPict))
		oSection5:Cell("HOMBRESD"):SetValue(Transform(nHd,cPict))
		oSection5:Cell("TOTALD"):SetValue(Transform(nMd+nHd,cPict))
		oSection5:Cell("MUJERESC"):SetValue(Transform(nMc,cPict))
		oSection5:Cell("HOMBRESC"):SetValue(Transform(nHc,cPict))
		oSection5:Cell("TOTALC"):SetValue(Transform(nMc+nHc,cPict))
		oSection5:Cell("MUJERESL"):SetValue(Transform(nMl,cPict))
		oSection5:Cell("HOMBRESL"):SetValue(Transform(nHl,cPict))
		oSection5:Cell("TOTALL"):SetValue(Transform(nMl+nHl,cPict))
		oSection5:Printline()
	EndIf
EndDo
(cTempF)->(dbCloseArea())
oSection5:Finish()
Return

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³ Filiales ³ Autor ³ Jesus Peñaloza        ³ Data ³30/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Obtiene una lista de Filiales para imprimir el reporte     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ Filiales(cCond)                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ cExp1: expresion en formato SQL para buscar las filiales   ³±±
±±³          ³ disponibles                                                ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function Filiales(cCond)
Local aFiliales := {}
Local aArea := GetArea()
Local lTodasSuc := Empty(cCond) // cuando sea vacia, Todas las sucursales
Local nScan := 0

cCond := STRTRAN(cCond,'RA_FILIAL','M0_CODFIL')
dbSelectArea("SM0")
SM0->(dbGoTop())
If lTodasSuc
    While !SM0->(EOF())
        nScan := aScan(aFiliales, {|x| x == SM0->M0_CODFIL})
        If nScan == 0
            aAdd(aFiliales, SM0->M0_CODFIL)
        EndIf
        SM0->(dbSkip())
    EndDo
Else
    While (!SM0->(EOF()) .AND. &cCond)
    	nScan := aScan(aFiliales,SM0->M0_CODFIL )
    	If nScan == 0
    		aAdd(aFiliales,SM0->M0_CODFIL)
    	EndIf
    	SM0->(dbSkip())
    EndDo
EndIf
RestArea(aArea)
Return aFiliales

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³HayTrabaja³ Autor ³ Jesus Peñaloza        ³ Data ³30/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Retorna si hay datos a mostrar en el reporte seccion III IV³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ HayTrabajadores(cFil)                                      ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ cExp1: Numero de Filial                                    ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function HayTrabajadores(cFil)
Local nCount := 0
Local cTempF := CriaTrab(Nil, .F.)
Local cQuery := ''
Local cFunc := ''
Local lHay := .F.
cQuery := "SELECT RD_FILIAL, RD_MAT, RJ_FUNCAO, RJ_CVEINE, RCH_DTINI "
cQuery += "FROM "+RetSqlName("RCH")+" RCH, "+RetSqlName("SRD")+" SRD, "+RetSqlName("SRA")+" SRA, "+RetSqlName("SRJ")+" SRJ "
cQuery += "WHERE RD_PERIODO+RD_SEMANA = RCH_PER+ RCH_NUMPAG "
cQuery += "AND RD_FILIAL='"+xFilial("SRD", cFil)+"' AND RA_FILIAL='"+xFilial("SRA", cFil)+"' "
cQuery += "AND RCH_FILIAL ='"+xFilial("RCH", cFil)+"' AND RJ_FILIAL = '"+xFilial("SRJ", cFil)+"' "
cQuery += "AND RD_MAT = RA_MAT "
cQuery += "AND RJ_CVEINE <> '' "
cQuery += "AND RCH.RCH_ANO = '"+cAnio+"' AND RCH.RCH_MES = '"+cMes+"' " 
cQuery += "AND RCH.RCH_ROTEIR = (SELECT RY_CALCULO FROM "+RetSqlName("SRY")+" WHERE RY_TIPO = '1' AND D_E_L_E_T_ = '') "
cQuery += "AND RCH.D_E_L_E_T_ = '' AND SRD.D_E_L_E_T_ = '' AND SRA.D_E_L_E_T_ = '' AND SRJ.D_E_L_E_T_ = '' " 
cQuery += "GROUP BY RJ_CVEINE, RD_FILIAL, RD_MAT, RJ_FUNCAO, RCH_DTINI "
cQuery += "ORDER BY RJ_CVEINE "
cQuery := ChangeQuery(cQuery)
dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cTempF,.T.,.T.)
(cTempF)->(dbGoTop())
While (!(cTempF)->(EOF()))
	cClave := (cTempF)->RJ_CVEINE
	While (!(cTempF)->(EOF()) .and. (cTempF)->RJ_CVEINE == cClave)
		cFunc := fBusHisFun((cTempF)->RD_FILIAL,(cTempF)->RD_MAT,STOD((cTempF)->RCH_DTINI),1,,.T.)
		If cFunc == Alltrim((cTempF)->RJ_FUNCAO)
			nCount++
		EndIf
		(cTempF)->(dbSkip())
	EndDo
	If nCount > 0
		lHay := .T.
		exit
	EndIf
EndDo
(cTempF)->(dbCloseArea())
Return lHay

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³ HayTrabV ³ Autor ³ Jesus Peñaloza        ³ Data ³30/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Retorna si hay datos a mostrar en el reporte seccion V     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ HayTrabV(cFil)                                             ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ cExp1: Numero de Filial                                    ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function HayTrabV(cFil)
Local cTempF := CriaTrab(Nil, .F.)
Local cQuery := ''
Local cFunc 	:= ''
Local cFuncion := ''
Local cBaja 	:= ''
Local cSexo 	:= ''
Local cAlta 	:= ''
Local cAltPro	:= ''
Local cClave	:= ''
Local cMat 	:= ''
Local nMd 	:= 0
Local nHd 	:= 0
Local nMc 	:= 0
Local nHc 	:= 0
Local nMl 	:= 0
Local nHl 	:= 0
Local lLicM 	:= .F.
Local lLicH 	:= .F.
Local lHay 	:= .F.
cQuery := "SELECT RD_FILIAL, RD_MAT, RD_PD, RA_ADMISSA, RA_DEMISSA, RA_SEXO,RA_CODFUNC, RJ_FUNCAO, RJ_CVEINE, RCH_DTINI,RA_DTCONIN "
cQuery += "FROM "+RetSqlName("SRA")+" SRA, "+RetSqlName("SRD")+" SRD, "+RetSqlName("SRJ")+" SRJ, "+RetSqlName("RCH")+" RCH "
cQuery += "WHERE RA_MAT = RD_MAT "
cQuery += "AND RD_FILIAL = '"+xFilial("SRD", cFil)+"' AND RA_FILIAL = '"+xFilial("SRA",cFil)+"' AND RCH_FILIAL ='"+xFilial("RCH", cFil)+"' "
cQuery += "AND RJ_FILIAL = '"+xFilial("SRJ", cFil)+"' "
cQuery += "AND RD_PERIODO+RD_SEMANA = RCH_PER+ RCH_NUMPAG "
cQuery += "AND RCH.RCH_ANO = '"+cAnio+"' AND RCH.RCH_MES = '"+cMes+"' "
cQuery += "AND RCH.RCH_ROTEIR = (SELECT RY_CALCULO FROM "+RetSqlName("SRY")+" WHERE RY_TIPO = '1' AND D_E_L_E_T_ = '') "
cQuery += "AND RD_PD IN (SELECT RCM_PD FROM "+RetSqlName("RCM")+" WHERE RCM_TPIMSS = '03' AND RCM_FILIAL = '" + xFilial("RCM") + "' AND D_E_L_E_T_ = '') "
cQuery += "AND SRA.D_E_L_E_T_ = '' AND SRD.D_E_L_E_T_ = '' AND SRJ.D_E_L_E_T_ = '' AND RCH.D_E_L_E_T_ = '' "
cQuery += "AND RJ_CVEINE <> '' "
cQuery += "AND RA_CODFUNC = RJ_FUNCAO "
cQuery += "GROUP BY RJ_CVEINE, RD_FILIAL, RD_MAT, RD_PD, RA_ADMISSA, RA_DEMISSA, RA_SEXO,RA_CODFUNC, RJ_FUNCAO, RCH_DTINI,RA_DTCONIN"
cQuery := ChangeQuery(cQuery)
dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cTempF,.T.,.T.)
(cTempF)->(dbGoTop())
While (!(cTempF)->(EOF()))
	cClave := (cTempF)->RJ_CVEINE
	nMd := 0
	nHd := 0
	nMc := 0
	nHc := 0
	nMl := 0
	nHl := 0
	While (!(cTempF)->(EOF())) .and. (cTempF)->RJ_CVEINE == cClave
		cMat := (cTempF)->RD_MAT
		cFuncion := (cTempF)->RJ_FUNCAO
		cBaja := (cTempF)->RA_DEMISSA
		cSexo := (cTempF)->RA_SEXO
		cAlta := (cTempF)->RA_ADMISSA
		cAltPro:=(cTempF)->RA_DTCONINI
		lLicM := .F.
		lLicH := .F.
		cFunc := fBusHisFun((cTempF)->RD_FILIAL,(cTempF)->RD_MAT,STOD((cTempF)->RCH_DTINI),1,,.T.)
		While (!(cTempF)->(EOF())) .and. (cTempF)->RJ_CVEINE == cClave 
		
			If cFunc == Alltrim(cFuncion) .OR. empty(cFunc)
				//If (cTempF)->RD_PD $ "601|602|603"
					If (cTempF)->RA_SEXO == 'F'
						lLicM := .T.
					Else
						lLicH := .T.
					EndIf
				//EndIf
			EndIf
			(cTempF)->(dbSkip())
		EndDo
		If cFunc == Alltrim(cFuncion) .OR. empty(cFunc)
			If substr(cAlta,1,6) == cAnio+cMes .or. substr(cAltPro,1,6) == cAnio+cMes 
				If cSexo == 'F'
					nMc++
				Else
					nHc++
				EndIf
			EndIf
			If substr(cBaja,1,6) == cAnio+cMes
				If cSexo == 'F'
					nMd++
				Else
					nHd++
				EndIf
			EndIf
			If lLicM
				nMl++
			EndIf
			If lLicH
				nHl++
			EndIf
		EndIf
	EndDo
	If nMd > 0 .or. nHd > 0 .or. nMc > 0 .or. nHc > 0 .or. nMl > 0 .or. nHl > 0
		lHay := .T.
		exit
	EndIf
EndDo
(cTempF)->(dbCloseArea())
Return lHay

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡„o    ³ DescriMes³ Autor ³ Jesus Peñaloza        ³ Data ³30/09/2014³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡„o ³ Retorna la descripcion del numero de mes informado         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ DescriMes(cExp1)                                           ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ cExp1: Numero de Mes                                       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ PrintReport                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function DescriMes(cMes)
Local cDescri := ''
If cMes == '01'
	cDescri := STR0064 //Enero
ElseIf cMes == '02'
	cDescri := STR0065 //Febrero
ElseIf cMes == '03'
	cDescri := STR0066 //Marzo
ElseIf cMes == '04'
	cDescri := STR0067 //Abril
ElseIf cMes == '05'
	cDescri := STR0068 //Mayo
ElseIf cMes == '06'
	cDescri := STR0069 //Junio
ElseIf cMes == '07'
	cDescri := STR0070 //Julio
ElseIf cMes == '08'
	cDescri := STR0071 //Agosto
ElseIf cMes == '09'
	cDescri := STR0072 //Septiembre
ElseIf cMes == '10'
	cDescri := STR0073 //Octubre
ElseIf cMes == '11'
	cDescri := STR0074 //Noviembre
ElseIf cMes == '12'
	cDescri := STR0075 //Diciembre
EndIf
Return cDescri