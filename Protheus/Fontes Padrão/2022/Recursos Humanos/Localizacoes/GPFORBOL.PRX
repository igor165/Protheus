#INCLUDE "PROTHEUS.CH"

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³GpForBOL      ³Autor³ Gerado pelo sistema ³ Data ³19/08/2022³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Formulas padroes                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function GpForBOL()

Local aRC2Header  := {}
Local aRC3Header  := {}
Local aSYPHeader  := {}

Local bForm	    := NIL

Local cFormNum
Local cForm

Local lRet        := .T.
Local nItem       := 0

Private lFilRPO     := SuperGetMv('MV_RPOFIL',, .F.) .and. xFilial('SRY') <> xFilial('RC2')

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Cabecalho de RC2 e RC3 gerado pela formula padrao            ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
aAdd(aRC2Header, { 'Sucursal','RC2_FILIAL','',,'0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Origen','RC2_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','S_=Sistema;U_=Usuario                                                                                                           ','"U_"','','V','','','.T.' })
aAdd(aRC2Header, { 'Cod. Formula','RC2_CODIGO','@!','15','0','RC2CodigoVld()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','                                                                                                                                ','','','A','','','.T.' })
aAdd(aRC2Header, { 'Desc. Form.','RC2_DESC','@!','40','0','NaoVAzio()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.T.' })
aAdd(aRC2Header, { 'Retorno','RC2_RETURN','@!','10','0','Vazio() .or. ExistCpo("RCA")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','RCA01 ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Cod. Observ.','RC2_CODOBS','@!','6','0','NaoVazio()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Version Form','RC2_VERSAO','','3','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x   x   ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Recopilar','RC2_RECOMP','9','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Sí;2=No                                                                                                                       ','"1"','','V','','','.F.' })
aAdd(aRC2Header, { 'Mod.Planilla','RC2_MODELO','@!','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Planilla Modelo 1;2=Planilla Modelo 2                                                                                         ','fGetModFol()','','V','','','.F.' })

aAdd(aRC3Header, { 'Sucursal','RC3_FILIAL','',,'0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Origen','RC3_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','S_=Sistema;U_=Usuario                                                                                                           ','"U_"','','V','','','.F.' })
aAdd(aRC3Header, { 'Cod. Formula','RC3_CODIGO','@!','15','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','                                                                                                                                ','','','V','','','.T.' })
aAdd(aRC3Header, { 'Descripcion','RC3_DESCR','@!S31','60','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Sec.','RC3_SEQFOR','999999','6','0','NaoVazio() .and. Gpea290SeqFor( .T. )','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','Gpea290SeqFor()','SeqWhen()',' ','','','.F.' })
aAdd(aRC3Header, { 'Cod Sec. Pri','RC3_SEQPAI','999999','6','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Expr.','RC3_TIPO','@!','5','0','NaoVazio()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp1','RC3_TPRESU','@!','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','"2"','','V','','','.F.' })
aAdd(aRC3Header, { 'Resultado','RC3_RESULT','@!S25','250','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.1','RC3_OPERA1','@!','16','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp2','RC3_TPFM01','@!','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '1ª Expresion','RC3_FORM01','@!S25','250','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.2','RC3_OPERA2','@!','5','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp3','RC3_TPFM02','@!','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '2ª Expresion','RC3_FORM02','@!S25','250','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.3','RC3_OPERA3','@!','5','0','Gpea290Return()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','".END."','',' ','','','.F.' })
aAdd(aRC3Header, { 'Imagen 1','RC3_RESOU1','@!','20','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Imagen 2','RC3_RESOU2','@!','20','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })

aAdd(aSYPHeader, { 'Sucursal','YP_FILIAL','',,'0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Clave','YP_CHAVE','','6','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Secuencia','YP_SEQ','','3','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Linea','YP_TEXTO','','80','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Campo','YP_CAMPO','','10','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Só carrega se estiver utilizando modelo padrão do pais.       ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
If !(MV_MODFOL == "1")
	Return
EndIf

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Validar a Estrutura das Tabela RC2 e RC3 com a do Cliente     ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
lRet := fNewOldSx3(aRC2Header, aRC3Header, "RC2", "RC3",.F.)
lRet := If( lRet , fNewOldSx3(aSYPHeader, NIL, "SYP") , lRet)

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Executar gravacao da formula.                                 ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
If ( lRet )

	/*/
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Chamada da funcao de gravacao                                ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
	cFormNum := "0000"
	For nItem := 1 To 132
		cFormNum	:= __Soma1( cFormNum )
		cForm		:= ( "Add" + cPaisLoc + cFormNum )
		If IsFunction( cForm )
			bForm := __ExecMacro( '{ ||' +  cForm + '( aRc2Header , aRc3Header, aSYPHeader ) }' )
			CheckExecForm( bForm , .T. , 'ERRADDFRM' , cForm )
		EndIf
	Next nItem

EndIf

Return( NIL )


/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0001    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0001( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AVOS13','Nº AVOS DE DIREITO','','000321','010','2','1',} )

aAdd(aRc3Cols, { '','S_','AVOS13','fAvos13(@nAvos,dDataAte,nAvosFal13,0,if(cTipoRot = "5", "1",','000001','000000','.EXE.','5','fAvos13(@nAvos,dDataAte,nAvosFal13,0,if(cTipoRot = "5", "1", " ") , dDataRef )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0002    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0002( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEATVF','BASE H.ATIV. PROFESSOR (FIXAS)','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEATVF','SRA->RA_CATFUNC $ "I*J" .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"I*J"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','NBSHRSATIV := 0     .CNT.','000002','000001','.EXE.','5','NBSHRSATIV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','FO_GOTOP(@oSRO)     .CNT.','000003','000001','.EXE.','5','FO_GOTOP(@oSRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','!FO_EOF(@oSRO)   .END.','000004','000001','.ENQ.','5','','','5','!FO_EOF(@oSRO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','cVerba := FO_GETVAL(@oSRO,"RO_VERBA")     .CNT.','000005','000004','.EXE.','5','cVerba := FO_GETVAL(@oSRO,"RO_VERBA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','cTpVerba := FO_GETVAL(@oSRO,"RO_TIPO")     .CNT.','000006','000004','.EXE.','5','cTpVerba := FO_GETVAL(@oSRO,"RO_TIPO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','PosSrv(cVerba,SRA->RA_FILIAL,"RV_HRSATIV") == "S" .END.','000007','000004','.CON.','5','','','5','PosSrv(cVerba,SRA->RA_FILIAL,"RV_HRSATIV")  == "S" .And. cTpVerba == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','NBSHRSATIV += FO_GETVAL(@oSRO,"RO_VALTOT")   .END.','000008','000007','.EXE.','5','NBSHRSATIV','+=','5','FO_GETVAL(@oSRO,"RO_VALTOT")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','FO_SKIP(@oSRO)     .END.','000009','000004','.EXE.','5','FO_SKIP(@oSRO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEATVF','nBsHrsAtiv += IF(PosSrv(FGETCODFOL("033"),SRA->RA_FILIAL,"RV','000010','000001','.EXE.','5','nBsHrsAtiv += IF(PosSrv(FGETCODFOL("033"),SRA->RA_FILIAL,"RV_HRSATIV") = "S",(nBsHrsAtiv*aParProf[2] ),0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0003    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0003( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEDSRT','BASE DSR TAREFEIRO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEDSRT','SRA->RA_CATFUNC = "T"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC = "T"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','aDsrAux := {}     .CNT.','000002','000001','.EXE.','5','aDsrAux := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','FO_GOTOP(@oSRO)     .CNT.','000003','000001','.EXE.','5','FO_GOTOP(@oSRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','!FO_EOF(@oSro)   .END.','000004','000001','.ENQ.','5','','','5','!FO_EOF(@oSro)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nPos := Ascan( aDsrAux, { |X| X[2] == FO_GETVAL(@oSRO,"RO_CC','000005','000004','.EXE.','5','nPos := Ascan( aDsrAux, { |X| X[2] == FO_GETVAL(@oSRO,"RO_CC") .And. X[3] == FO_GETVAL(@oSRO,"RO_DATA") } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nPos > 0   .END.','000006','000004','.CON.','5','','','5','nPos > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','aDsrAux[nPos,1] += FO_GETVAL(@oSRO,"RO_VALTOT")     .END.','000007','000006','.EXE.','5','aDsrAux[nPos,1] += FO_GETVAL(@oSRO,"RO_VALTOT")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nPos = 0   .END.','000008','000004','.CON.','5','','','5','nPos = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','Aadd( aDsrAux, { FO_GETVAL(@oSRO,"RO_VALTOT"),  FO_GETVAL(@o','000009','000008','.EXE.','5','Aadd( aDsrAux, { FO_GETVAL(@oSRO,"RO_VALTOT"),  FO_GETVAL(@oSRO,"RO_CC"),FO_GETVAL(@oSRO,"RO_DATA")})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','FO_SKIP(@oSRO)     .END.','000010','000004','.EXE.','5','FO_SKIP(@oSRO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nCnt := 1     .CNT.','000011','000001','.EXE.','5','nCnt := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','cCcGerados  := ""     .CNT.','000012','000001','.EXE.','5','cCcGerados  := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nCnt <= Len(aDsrAux)   .END.','000013','000001','.ENQ.','5','','','5','nCnt <= Len(aDsrAux)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','!aDsrAux[nCnt,2] $ cCcGerados   .END.','000014','000013','.CON.','5','','','5','!aDsrAux[nCnt,2] $ cCcGerados','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nValdsr := nNroTar := 0     .CNT.','000015','000014','.EXE.','5','nValdsr := nNroTar := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','cCcGerados += aDsrAux[nCnt,2]+"*"     .CNT.','000016','000014','.EXE.','5','cCcGerados += aDsrAux[nCnt,2]+"*"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','Aeval( aDsrAux, {|X| If( X[2]==aDsrAux[nCnt,2], nValDsr  +=','000017','000014','.EXE.','5','Aeval( aDsrAux, {|X| If( X[2]==aDsrAux[nCnt,2], nValDsr  += X[1], "") } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','Aeval( aDsrAux, {|X| If( X[2]==aDsrAux[nCnt,2], nNroTar ++','000018','000014','.EXE.','5','Aeval( aDsrAux, {|X| If( X[2]==aDsrAux[nCnt,2], nNroTar ++     , "") } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','Aadd(  aDsrTarefa , { FGETCODFOL("033") , Round( nValDsr / n','000019','000014','.EXE.','5','Aadd(  aDsrTarefa , { FGETCODFOL("033") , Round( nValDsr / nNroTar, 2 ), nNroTar, aDsrAux[nCnt,2] } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEDSRT','nCnt ++     .END.','000020','000013','.EXE.','5','nCnt ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0004    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0004( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BSALLICE','BASE SAL.LICENCA MATERN. ENFERM. E SEGUR','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','BSALLICE','CCONDVRB:= "RV_TIPOCOD == '+"'"+'1'+"'"+' .AND. RV_APORPAT == '+"'"+'1'+"'"+'"     .','000001','000000','.EXE.','5','CCONDVRB:= "RV_TIPOCOD == '+"'"+'1'+"'"+' .AND. RV_APORPAT == '+"'"+'1'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','CVRBBSLIC := FGETCODFOL("1272")     .CNT.','000002','000000','.EXE.','5','CVRBBSLIC := FGETCODFOL("1272")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','DDTANTLIC := MONTHSUB( DDATAREF , 1 )     .CNT.','000003','000000','.EXE.','5','DDTANTLIC := MONTHSUB( DDATAREF , 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NVALSALLICE := 0     .CNT.','000004','000000','.EXE.','5','NVALSALLICE := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NSEQ := 0     .CNT.','000005','000000','.EXE.','5','NSEQ := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','A VERBA BASE SALARIO PARA LICENCAS DEVE ESTAR CADASTRADA','000006','000000','.MSG.','5','A VERBA BASE SALARIO PARA LICENCAS DEVE ESTAR CADASTRADA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','EMPTY(CVRBBSLIC)   .END.','000007','000000','.CON.','5','','','5','EMPTY(CVRBBSLIC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','CMSGLOG := FMSGFORM({19}) + "1272 - " + FDESC("RCN", "1274",','000008','000007','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "1272 - " + FDESC("RCN", "1274", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','S_MSGLOG()     .CNT.','000009','000007','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','FINALFUN()     .END.','000010','000007','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','PRIMEIRO PROCURA A VERBA BASE DE SALARIO LICENCA     .CNT.','000011','000000','.MSG.','5','PRIMEIRO PROCURA A VERBA BASE DE SALARIO LICENCA','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NVALSALLICE := FBUSCAACM( CVRBBSLIC, , DDTANTLIC, DDTANTLIC,','000012','000000','.EXE.','5','NVALSALLICE := FBUSCAACM( CVRBBSLIC, , DDTANTLIC, DDTANTLIC, "V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','SE NAO ENCONTRAR A VERBA BASE DE SALARIO LICENCA OBTEM CONFO','000013','000000','.MSG.','5','SE NAO ENCONTRAR A VERBA BASE DE SALARIO LICENCA OBTEM CONFORME AS INCIDENCIAS DO MES ANTERIOR','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NVALSALLICE <= 0   .END.','000014','000000','.CON.','5','','','5','NVALSALLICE <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NVALSALLICE := FBUSCAACM( , CCONDVRB, DDTANTLIC, DDTANTLIC,','000015','000014','.EXE.','5','NVALSALLICE := FBUSCAACM( , CCONDVRB, DDTANTLIC, DDTANTLIC, "V")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','EM ULTIMO CASO UTILIZA O VALOR DO SALARIO COMO BASE     .CNT','000016','000000','.MSG.','5','EM ULTIMO CASO UTILIZA O VALOR DO SALARIO COMO BASE','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NVALSALLICE <= 0   .END.','000017','000000','.CON.','5','','','5','NVALSALLICE <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','SRA->RA_CATFUNC == "M"   .END.','000018','000017','.CON.','5','','','5','SRA->RA_CATFUNC == "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NVALSALLICE := SRA->RA_SALARIO     .END.','000019','000018','.EXE.','5','NVALSALLICE := SRA->RA_SALARIO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','SRA->RA_CATFUNC # "M"   .END.','000020','000017','.CON.','5','','','5','SRA->RA_CATFUNC # "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','FTRABCALEND( CPERIODO, @DIASTRAB, , @DIASDSR , , , , @NHORAS','000021','000020','.EXE.','5','FTRABCALEND( CPERIODO, @DIASTRAB, , @DIASDSR , , , , @NHORASDSR , @NHORASTRAB , , , , CNUMPAG, .F., .F., , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','S_SALARIOM()     .CNT.','000022','000020','.EXE.','5','S_SALARIOM()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','S_SALARIOD()     .CNT.','000023','000020','.EXE.','5','S_SALARIOD()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','S_SALARIOH()     .CNT.','000024','000020','.EXE.','5','S_SALARIOH()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','S_SALARIOB()     .CNT.','000025','000020','.EXE.','5','S_SALARIOB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','DIASTRAB := 0     .CNT.','000026','000020','.EXE.','5','DIASTRAB := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','DIASDSR := 0     .CNT.','000027','000020','.EXE.','5','DIASDSR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NHORASTRAB := 0     .CNT.','000028','000020','.EXE.','5','NHORASTRAB := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NHORASDSR := 0     .CNT.','000029','000020','.EXE.','5','NHORASDSR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NVALSALLICE := SALMES     .END.','000030','000020','.EXE.','5','NVALSALLICE := SALMES','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NVALSALLICE > 0   .END.','000031','000000','.CON.','5','','','5','NVALSALLICE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','FO_SEEK(@&COBJETO, CCPOPD, CVRBBSLIC) .AND. !FO_DELETED(@&','000032','000031','.CON.','5','','','5','FO_SEEK(@&COBJETO, CCPOPD, CVRBBSLIC) .AND. !FO_DELETED(@&COBJETO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','FO_SETVAL(@&COBJETO, CCPOVALOR, NVALSALLICE)     .END.','000033','000032','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, NVALSALLICE)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','!FO_SEEK(@&COBJETO, CCPOPD, CVRBBSLIC)   .END.','000034','000031','.CON.','5','','','5','!FO_SEEK(@&COBJETO, CCPOPD, CVRBBSLIC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','NSEQ := FO_COUNT( @&COBJETO , CCPOPD , CVRBBSLIC ) + 1     .','000035','000034','.EXE.','5','NSEQ := FO_COUNT( @&COBJETO , CCPOPD , CVRBBSLIC ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSALLICE','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOVALOR, CCPOSEQ}','000036','000034','.EXE.','5','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOVALOR, CCPOSEQ} , {CVRBBSLIC, "V" , NVALSALLICE, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" )) },{CCPOPD, CCPOSEQ},{CVRBBSLIC, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" ))})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0005    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0005( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BSVALPRV','VALORES BASES PARA PROVISION','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','BSVALPRV','aTempServ := {}     .CNT.','000001','000000','.EXE.','5','aTempServ := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','DDATAF := IF(SRA->RA_SITFOLH == "D", (DDATAREF - 1) , dDataA','000002','000000','.EXE.','5','DDATAF := IF(SRA->RA_SITFOLH == "D", (DDATAREF - 1) , dDataAte)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aTempServ := DateDiffYMD(SRA->RA_ADMISSA, dDataF )     .CNT.','000003','000000','.EXE.','5','aTempServ := DateDiffYMD(SRA->RA_ADMISSA, dDataF )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nDiasInde := 0     .CNT.','000004','000000','.EXE.','5','nDiasInde := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes := 0     .CNT.','000005','000000','.EXE.','5','nBaseMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nHorasMes := 0     .CNT.','000006','000000','.EXE.','5','nHorasMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aDataInd := {}     .CNT.','000007','000000','.EXE.','5','aDataInd := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aPerFechado  := {}     .CNT.','000008','000000','.EXE.','5','aPerFechado  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aPerAberto := {}     .CNT.','000009','000000','.EXE.','5','aPerAberto := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aVerbasFunc := {}     .CNT.','000010','000000','.EXE.','5','aVerbasFunc := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseProv := 0     .CNT.','000011','000000','.EXE.','5','nBaseProv := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseQuiMes := 0     .CNT.','000012','000000','.EXE.','5','nBaseQuiMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes13 := 0     .CNT.','000013','000000','.EXE.','5','nBaseMes13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes14 := 0     .CNT.','000014','000000','.EXE.','5','nBaseMes14 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMesVac := 0     .CNT.','000015','000000','.EXE.','5','nBaseMesVac := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont := 0     .CNT.','000016','000000','.EXE.','5','nCont := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont1 := 0     .CNT.','000017','000000','.EXE.','5','nCont1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont2 := 0     .CNT.','000018','000000','.EXE.','5','nCont2 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont3 := 0     .CNT.','000019','000000','.EXE.','5','nCont3 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont4 := 0     .CNT.','000020','000000','.EXE.','5','nCont4 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont5 := 0     .CNT.','000021','000000','.EXE.','5','nCont5 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nContW := 0     .CNT.','000022','000000','.EXE.','5','nContW := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','lVbFer := .F.     .CNT.','000023','000000','.EXE.','5','lVbFer := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','Len(aTempServ ) > 0   .END.','000024','000000','.CON.','5','','','5','Len(aTempServ ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nAnos := aTempServ[1]     .CNT.','000025','000024','.EXE.','5','nAnos := aTempServ[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nMeses := aTempServ[2]     .CNT.','000026','000024','.EXE.','5','nMeses := aTempServ[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nDias := aTempServ[3]     .CNT.','000027','000024','.EXE.','5','nDias := aTempServ[3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','cMes := STRZero(Month(dDataF), 2 )     .CNT.','000028','000024','.EXE.','5','cMes := STRZero(Month(dDataF), 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','cAno := STRZero(Year(dDataF),4)     .CNT.','000029','000024','.EXE.','5','cAno := STRZero(Year(dDataF),4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','cDia := STRZero(Day( dDataF), 2 )     .CNT.','000030','000024','.EXE.','5','cDia := STRZero(Day( dDataF), 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NDIASINDE := DAY(DDATAF) -1     .CNT.','000031','000024','.EXE.','5','NDIASINDE := DAY(DDATAF) -1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nDiasInde > 0 .And. CTIPOROT == "A"   .END.','000032','000024','.CON.','5','','','5','nDiasInde > 0 .And. CTIPOROT == "A"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nDiasInde := 30     .CNT.','000033','000032','.EXE.','5','nDiasInde := 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','Aadd( aDataInd, { StrZero(Year(dDataF), 4 ) , StrZero( Month','000034','000032','.EXE.','5','Aadd( aDataInd, { StrZero(Year(dDataF), 4 ) , StrZero( Month( dDataF), 2 ), nDiasInde, 0 ,0 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','CTIPOROT $ "1|4|B"   .END.','000035','000024','.CON.','5','','','5','CTIPOROT $ "1|4|B"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nDiasInde := 0     .END.','000036','000035','.EXE.','5','nDiasInde := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nDiasInde <=  90 .And. (cAno+cMes) >= AnoMes(SRA->RA_ADMIS','000037','000024','.ENQ.','5','','','5','nDiasInde <=  90 .And. (cAno+cMes) >= AnoMes(SRA->RA_ADMISSA)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','lIf := (cMes == '+"'"+'01'+"'"+')   .END.','000038','000037','.CON.','5','','','5','lIf := (cMes == '+"'"+'01'+"'"+')','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','cMes 	:= '+"'"+'12'+"'"+'     .CNT.','000039','000038','.EXE.','5','cMes 	:= '+"'"+'12'+"'"+'','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','cAno := Tira1(cAno)     .END.','000040','000038','.EXE.','5','cAno := Tira1(cAno)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','!lIf   .END.','000041','000037','.CON.','5','','','5','!lIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','cMes	:= Tira1(cMes)     .END.','000042','000041','.EXE.','5','cMes	:= Tira1(cMes)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','(cAno+cMes) >= AnoMes(SRA->RA_ADMISSA )   .END.','000043','000037','.CON.','5','','','5','(cAno+cMes) >= AnoMes(SRA->RA_ADMISSA )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','SRA->RA_CATFUNC $ "M*C*P*A*E*I"   .END.','000044','000043','.CON.','5','','','5','SRA->RA_CATFUNC $ "M*C*P*A*E*I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nDiasInde += 30     .CNT.','000045','000044','.EXE.','5','nDiasInde += 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','Aadd( aDataInd , {cAno, cMes , If(nDiasInde < 90, 30, 30 - (','000046','000044','.EXE.','5','Aadd( aDataInd , {cAno, cMes , If(nDiasInde < 90, 30, 30 - (nDiasInde - 90) ),  0, 0 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','SRA->RA_CATFUNC $ "H*T*G*J*D"   .END.','000047','000043','.CON.','5','','','5','SRA->RA_CATFUNC $ "H*T*G*J*D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nUltDia := f_UltDia(ctod( "01/" +cmes+ "/" +cano ) )     .CN','000048','000047','.EXE.','5','nUltDia := f_UltDia(ctod( "01/" +cmes+ "/" +cano ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nDiasInde += nUltDia     .CNT.','000049','000047','.EXE.','5','nDiasInde += nUltDia','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','Aadd( aDataInd , {cAno, cMes , If(nDiasInde < 90, nUltDia, n','000050','000047','.EXE.','5','Aadd( aDataInd , {cAno, cMes , If(nDiasInde < 90, nUltDia, nUltDia - (nDiasInde - 90) ),  0, 0 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','Len(aDataInd) > 0   .END.','000051','000024','.CON.','5','','','5','Len(aDataInd) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aSort( aDataInd ,,, { |x,y| x[1]+x[2] < y[1]+y[2] } )     .C','000052','000051','.EXE.','5','aSort( aDataInd ,,, { |x,y| x[1]+x[2] < y[1]+y[2] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont := 1     .CNT.','000053','000051','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nAux := Len(aDataInd)     .CNT.','000054','000051','.EXE.','5','nAux := Len(aDataInd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont  <= nAux   .END.','000055','000051','.ENQ.','5','','','5','nCont  <= nAux','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aDataInd[nCont,3] > 0   .END.','000056','000055','.CON.','5','','','5','aDataInd[nCont,3] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aVerbasFunc := {}     .CNT.','000057','000056','.EXE.','5','aVerbasFunc := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','fRetPerComp( aDataInd[nCont,2], aDataInd[nCont,1] , Nil, Nil','000058','000056','.EXE.','5','fRetPerComp( aDataInd[nCont,2], aDataInd[nCont,1] , Nil, Nil, Nil, @aPerAberto, @aPerFechado)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aVerbasFunc := RetornaVerbasFunc(SRA->RA_FILIAL, SRA->RA_MAT','000059','000056','.EXE.','5','aVerbasFunc := RetornaVerbasFunc(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, APERABERTO, APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','Len(aVerbasFunc ) > 0   .END.','000060','000056','.CON.','5','','','5','Len(aVerbasFunc ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aSort( aVerbasFunc ,,, { |x,y| x[1] + x[2] + x[3] + x[15] <','000061','000060','.EXE.','5','aSort( aVerbasFunc ,,, { |x,y| x[1] + x[2] + x[3] + x[15] < y[1] + y[2] + y[3] + y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nContW := 1     .CNT.','000062','000060','.EXE.','5','nContW := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nContW <= Len(aVerbasFunc)   .END.','000063','000060','.ENQ.','5','','','5','nContW <= Len(aVerbasFunc)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NA FOLHA CONSIDERA A VERBA DE FERIAS PARA COMPOR A MEDIA SAL','000064','000063','.MSG.','5','NA FOLHA CONSIDERA A VERBA DE FERIAS PARA COMPOR A MEDIA SALARIAL','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','LVBFER := AVERBASFUNC[NCONTW][3] == FGETCODFOL("0072") .AND.','000065','000063','.EXE.','5','LVBFER := AVERBASFUNC[NCONTW][3] == FGETCODFOL("0072") .AND. CTIPOROT=="1"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','PosSrv(aVerbasFunc[nContW, 3],SRA->RA_FILIAL,"RV_INDEN") =','000066','000063','.CON.','5','','','5','PosSrv(aVerbasFunc[nContW, 3],SRA->RA_FILIAL,"RV_INDEN") == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes += aVerbasFunc[nContW, 7] * If(PosSrv(aVerbasFunc[n','000067','000066','.EXE.','5','nBaseMes += aVerbasFunc[nContW, 7] * If(PosSrv(aVerbasFunc[nContW, 3] , aVerbasFunc[nContW,1]  , "RV_TIPOCOD") == "1", 1, IF(PosSrv(aVerbasFunc[nContW, 3] , aVerbasFunc[nContW,1], "RV_TIPOCOD") == "2",-1,0 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nHorasMes += aVerbasFunc[nContW, 6] * If(PosSrv(aVerbasFunc[','000068','000066','.EXE.','5','nHorasMes += aVerbasFunc[nContW, 6] * If(PosSrv(aVerbasFunc[nContW, 3] , aVerbasFunc[nContW,1]  , "RV_TIPOCOD") == "1", 1, IF(PosSrv(aVerbasFunc[nContW, 3] , aVerbasFunc[nContW,1], "RV_TIPOCOD") == "2", -1, 0 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','POSSRV(AVERBASFUNC[NCONTW, 3], SRA->RA_FILIAL, "RV_ADICTS"','000069','000063','.CON.','5','','','5','POSSRV(AVERBASFUNC[NCONTW, 3], SRA->RA_FILIAL, "RV_ADICTS") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NBASEQUIMES += AVERBASFUNC[NCONTW, 7] * IF(POSSRV(AVERBASFUN','000070','000069','.EXE.','5','NBASEQUIMES += AVERBASFUNC[NCONTW, 7] * IF(POSSRV(AVERBASFUNC[NCONTW, 3] , AVERBASFUNC[NCONTW,1]  , "RV_TIPOCOD") == "1", 1, IF(POSSRV(AVERBASFUNC[NCONTW, 3] , AVERBASFUNC[NCONTW,1], "RV_TIPOCOD") == "2",-1,0 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','POSSRV(AVERBASFUNC[NCONTW, 3], SRA->RA_FILIAL, "RV_MED13")','000071','000063','.CON.','5','','','5','POSSRV(AVERBASFUNC[NCONTW, 3], SRA->RA_FILIAL, "RV_MED13") == "S "','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NBASEMES13 += AVERBASFUNC[NCONTW, 7] * IF(POSSRV(AVERBASFUNC','000072','000071','.EXE.','5','NBASEMES13 += AVERBASFUNC[NCONTW, 7] * IF(POSSRV(AVERBASFUNC[NCONTW, 3] , AVERBASFUNC[NCONTW,1]  , "RV_TIPOCOD") == "1", 1, IF(POSSRV(AVERBASFUNC[NCONTW, 3] , AVERBASFUNC[NCONTW,1], "RV_TIPOCOD") == "2",-1,0 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NBASEMES14 += AVERBASFUNC[NCONTW, 7] * IF(POSSRV(AVERBASFUNC','000073','000071','.EXE.','5','NBASEMES14 += AVERBASFUNC[NCONTW, 7] * IF(POSSRV(AVERBASFUNC[NCONTW, 3] , AVERBASFUNC[NCONTW,1]  , "RV_TIPOCOD") == "1", 1, IF(POSSRV(AVERBASFUNC[NCONTW, 3] , AVERBASFUNC[NCONTW,1], "RV_TIPOCOD") == "2",-1,0 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','POSSRV(AVERBASFUNC[NCONTW, 3], SRA->RA_FILIAL,"RV_MEDFER")','000074','000063','.CON.','5','','','5','POSSRV(AVERBASFUNC[NCONTW, 3], SRA->RA_FILIAL,"RV_MEDFER") == "S " .OR. LVBFER == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NBASEMESVAC += AVERBASFUNC[NCONTW, 7] * IF(POSSRV(AVERBASFUN','000075','000074','.EXE.','5','NBASEMESVAC += AVERBASFUNC[NCONTW, 7] * IF(POSSRV(AVERBASFUNC[NCONTW, 3] , AVERBASFUNC[NCONTW,1]  , "RV_TIPOCOD") == "1", 1, IF(POSSRV(AVERBASFUNC[NCONTW, 3] , AVERBASFUNC[NCONTW,1], "RV_TIPOCOD") == "2",-1,0 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nContW += 1     .END.','000076','000063','.EXE.','5','nContW += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aDataInd[nCont, 4] := nHorasMes     .CNT.','000077','000060','.EXE.','5','aDataInd[nCont, 4] := nHorasMes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','aDataInd[nCont, 5]  := (nBaseMes / 30 * aDataInd[nCont,3] )','000078','000060','.EXE.','5','aDataInd[nCont, 5]  := (nBaseMes / 30 * aDataInd[nCont,3] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseProv += (nBaseMes / 30  * aDataInd[nCont, 3 ] )     .CN','000079','000060','.EXE.','5','nBaseProv += (nBaseMes / 30  * aDataInd[nCont, 3 ] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NBSSALQUI += (NBASEQUIMES / 30 * ADATAIND[NCONT,3] )     .CN','000080','000060','.EXE.','5','NBSSALQUI += (NBASEQUIMES / 30 * ADATAIND[NCONT,3] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBasePro13 += (nBaseMes13 / 30 * aDataInd[nCont,3] )     .CN','000081','000060','.EXE.','5','nBasePro13 += (nBaseMes13 / 30 * aDataInd[nCont,3] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBasePro14 += (nBaseMes14 / 30 * aDataInd[nCont,3] )     .CN','000082','000060','.EXE.','5','nBasePro14 += (nBaseMes14 / 30 * aDataInd[nCont,3] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBasePrVac += (nBaseMesVac / 30 * aDataInd[nCont,3] )     .C','000083','000060','.EXE.','5','nBasePrVac += (nBaseMesVac / 30 * aDataInd[nCont,3] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes > 0   .END.','000084','000060','.CON.','5','','','5','nBaseMes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont1 += 1     .END.','000085','000084','.EXE.','5','nCont1 += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes13 > 0   .END.','000086','000060','.CON.','5','','','5','nBaseMes13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont2 += 1     .END.','000087','000086','.EXE.','5','nCont2 += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMesVac > 0   .END.','000088','000060','.CON.','5','','','5','nBaseMesVac > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont3 += 1     .END.','000089','000088','.EXE.','5','nCont3 += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NBASEQUIMES > 0   .END.','000090','000060','.CON.','5','','','5','NBASEQUIMES > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont4 += 1     .END.','000091','000090','.EXE.','5','nCont4 += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes14 > 0   .END.','000092','000060','.CON.','5','','','5','nBaseMes14 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont5 += 1     .END.','000093','000092','.EXE.','5','nCont5 += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nHorasMes := 0     .CNT.','000094','000060','.EXE.','5','nHorasMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseQuiMes := 0     .CNT.','000095','000060','.EXE.','5','nBaseQuiMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes13 := 0     .CNT.','000096','000060','.EXE.','5','nBaseMes13 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes14 := 0     .CNT.','000097','000060','.EXE.','5','nBaseMes14 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMesVac := 0     .CNT.','000098','000060','.EXE.','5','nBaseMesVac := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseMes := 0     .END.','000099','000060','.EXE.','5','nBaseMes := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont += 1     .END.','000100','000055','.EXE.','5','nCont += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont1 := If(nCont1 >= 3, 3 , nCont1 )     .CNT.','000101','000024','.EXE.','5','nCont1 := If(nCont1 >= 3, 3 , nCont1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont2 := If(nCont2 >= 3, 3 , nCont2 )     .CNT.','000102','000024','.EXE.','5','nCont2 := If(nCont2 >= 3, 3 , nCont2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont3 := If(nCont3 >= 3, 3 , nCont3 )     .CNT.','000103','000024','.EXE.','5','nCont3 := If(nCont3 >= 3, 3 , nCont3 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont4 := If(nCont4 >= 3, 3 , nCont4 )     .CNT.','000104','000024','.EXE.','5','nCont4 := If(nCont4 >= 3, 3 , nCont4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nCont5 := If(nCont5 >= 3, 3 , nCont4 )     .CNT.','000105','000024','.EXE.','5','nCont5 := If(nCont5 >= 3, 3 , nCont4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBaseProv := ROUND(nBaseProv / nCont1,2 )     .CNT.','000106','000024','.EXE.','5','nBaseProv := ROUND(nBaseProv / nCont1,2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBasePro13 := ROUND(nBasePro13 / nCont2, 2 )     .CNT.','000107','000024','.EXE.','5','nBasePro13 := ROUND(nBasePro13 / nCont2, 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBasePro14 := ROUND(nBasePro14 / nCont5, 2 )     .CNT.','000108','000024','.EXE.','5','nBasePro14 := ROUND(nBasePro14 / nCont5, 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','nBasePrVac := ROUND(nBasePrVac / nCont3,2 )     .END.','000109','000024','.EXE.','5','nBasePrVac := ROUND(nBasePrVac / nCont3,2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSVALPRV','NBSSALQUI := ROUND(NBSSALQUI / NCONT4, 2 )     .CNT.','000110','000024','.EXE.','5','NBSSALQUI := ROUND(NBSSALQUI / NCONT4, 2 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0006    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0006( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BUSCAMED','BUSCA MEDIA RESCISAO','','000292','004','2','1',} )

aAdd(aRc3Cols, { '','S_','BUSCAMED','BuscaMed(@nMedFerv,@nMedFerp,@nMed13o,@nMedAviso,@nDesc13,@n','000001','000000','.EXE.','5','BuscaMed(@nMedFerv,@nMedFerp,@nMed13o,@nMedAviso,@nDesc13,@nMedDobra)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0007    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0007( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPRVAGU','BAJA PROVISION AGUINALDO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPRVAGU','SRA->RA_SITFOLH == "D" .AND. MESANO(DDATAREF) = MESANO(SRA','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH == "D" .AND. MESANO(DDATAREF) = MESANO(SRA->RA_DEMISSA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NVALBXPRV := 0     .CNT.','000002','000001','.EXE.','5','NVALBXPRV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','nValMeses := 0     .CNT.','000003','000001','.EXE.','5','nValMeses := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','nValDias := 0     .CNT.','000004','000001','.EXE.','5','nValDias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','APERABERTO := {}     .CNT.','000005','000001','.EXE.','5','APERABERTO := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','APERFECHADO  := {}     .CNT.','000006','000001','.EXE.','5','APERFECHADO  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','AVERBASFUNC := {}     .CNT.','000007','000001','.EXE.','5','AVERBASFUNC := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000008','000001','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, NIL, NIL, @APERABERTO, @APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT','000009','000001','.EXE.','5','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, APERABERTO, APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','LEN(AVERBASFUNC ) > 0   .END.','000010','000001','.CON.','5','','','5','LEN(AVERBASFUNC ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] <','000011','000010','.EXE.','5','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] < Y[1] + Y[2] + Y[3] + Y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NCONTW := 1     .CNT.','000012','000010','.EXE.','5','NCONTW := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NCONTW <= LEN(AVERBASFUNC)   .END.','000013','000010','.ENQ.','5','','','5','NCONTW <= LEN(AVERBASFUNC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','FGETCODFOL("0762") == AVERBASFUNC[NCONTW, 3]   .END.','000014','000013','.CON.','5','','','5','FGETCODFOL("0762") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NVALMESES := AVERBASFUNC[NCONTW, 7]     .END.','000015','000014','.EXE.','5','NVALMESES := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','FGETCODFOL("0763") == AVERBASFUNC[NCONTW, 3]   .END.','000016','000013','.CON.','5','','','5','FGETCODFOL("0763") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NVALDIAS := AVERBASFUNC[NCONTW, 7]     .END.','000017','000016','.EXE.','5','NVALDIAS := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NCONTW += 1     .END.','000018','000013','.EXE.','5','NCONTW += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NVALBXPRV :=  NVALMESES + NVALDIAS     .CNT.','000019','000001','.EXE.','5','NVALBXPRV :=  NVALMESES + NVALDIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NVALBXPRV > 0   .END.','000020','000001','.CON.','5','','','5','NVALBXPRV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0274"),','000021','000020','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0274"),  (NVALBXPRV ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DE','000022','000000','.CON.','5','','','5','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DEMISSA) > MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NVALBXPRV := 0     .CNT.','000023','000022','.EXE.','5','NVALBXPRV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','nValAgui := 0     .CNT.','000024','000022','.EXE.','5','nValAgui := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','APERABERTO := {}     .CNT.','000025','000022','.EXE.','5','APERABERTO := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','APERFECHADO  := {}     .CNT.','000026','000022','.EXE.','5','APERFECHADO  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','AVERBASFUNC := {}     .CNT.','000027','000022','.EXE.','5','AVERBASFUNC := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000028','000022','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, NIL, NIL, @APERABERTO, @APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT','000029','000022','.EXE.','5','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, APERABERTO, APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','LEN(AVERBASFUNC ) > 0   .END.','000030','000022','.CON.','5','','','5','LEN(AVERBASFUNC ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] <','000031','000030','.EXE.','5','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] < Y[1] + Y[2] + Y[3] + Y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NCONTW := 1     .CNT.','000032','000030','.EXE.','5','NCONTW := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NCONTW <= LEN(AVERBASFUNC)   .END.','000033','000030','.ENQ.','5','','','5','NCONTW <= LEN(AVERBASFUNC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','FGETCODFOL("0024") == AVERBASFUNC[NCONTW, 3]   .END.','000034','000033','.CON.','5','','','5','FGETCODFOL("0024") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NVALAGUI := AVERBASFUNC[NCONTW, 7]     .END.','000035','000034','.EXE.','5','NVALAGUI := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NCONTW += 1     .END.','000036','000033','.EXE.','5','NCONTW += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','NVALAGUI > 0   .END.','000037','000022','.CON.','5','','','5','NVALAGUI > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVAGU','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0332"),','000038','000037','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0332"),  (NVALAGUI ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0008    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0008( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPRVDAG','BAJA PROVISION DOBLE AGUINALDO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPRVDAG','!Empty( aCodFol[142, 1] )   .END.','000001','000000','.CON.','5','','','5','!Empty( aCodFol[142, 1] )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DE','000002','000001','.CON.','5','','','5','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DEMISSA) > MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','NVALBXPRV := 0     .CNT.','000003','000002','.EXE.','5','NVALBXPRV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','nValDAgu := 0     .CNT.','000004','000002','.EXE.','5','nValDAgu := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','APERABERTO := {}     .CNT.','000005','000002','.EXE.','5','APERABERTO := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','APERFECHADO  := {}     .CNT.','000006','000002','.EXE.','5','APERFECHADO  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','AVERBASFUNC := {}     .CNT.','000007','000002','.EXE.','5','AVERBASFUNC := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000008','000002','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, NIL, NIL, @APERABERTO, @APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT','000009','000002','.EXE.','5','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, APERABERTO, APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','LEN(AVERBASFUNC ) > 0   .END.','000010','000002','.CON.','5','','','5','LEN(AVERBASFUNC ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] <','000011','000010','.EXE.','5','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] < Y[1] + Y[2] + Y[3] + Y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','NCONTW := 1     .CNT.','000012','000010','.EXE.','5','NCONTW := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','NCONTW <= LEN(AVERBASFUNC)   .END.','000013','000010','.ENQ.','5','','','5','NCONTW <= LEN(AVERBASFUNC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','FGETCODFOL("1728") == AVERBASFUNC[NCONTW, 3]   .END.','000014','000013','.CON.','5','','','5','FGETCODFOL("1728") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','NVALDAGU := AVERBASFUNC[NCONTW, 7]     .END.','000015','000014','.EXE.','5','NVALDAGU := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','NCONTW += 1     .END.','000016','000013','.EXE.','5','NCONTW += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','nValDAgu > 0   .END.','000017','000002','.CON.','5','','','5','nValDAgu > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVDAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1666"),','000018','000017','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1666"),  (nValDAgu ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0009    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0009( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPRVIND','BAJA PROVISION INDEMNIZACION','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPRVIND','SRA->RA_SITFOLH == "D" .AND. MESANO(DDATAREF) = MESANO(SRA','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH == "D" .AND. MESANO(DDATAREF) = MESANO(SRA->RA_DEMISSA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','dPerIni := dDataRef     .CNT.','000002','000001','.EXE.','5','dPerIni := dDataRef','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','dPerFim := dDataAte     .CNT.','000003','000001','.EXE.','5','dPerFim := dDataAte','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NVALBXPRV := 0     .CNT.','000004','000001','.EXE.','5','NVALBXPRV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nValAnos := 0     .CNT.','000005','000001','.EXE.','5','nValAnos := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nValMeses := 0     .CNT.','000006','000001','.EXE.','5','nValMeses := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nValDias := 0     .CNT.','000007','000001','.EXE.','5','nValDias := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','APERABERTO := {}     .CNT.','000008','000001','.EXE.','5','APERABERTO := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','APERFECHADO  := {}     .CNT.','000009','000001','.EXE.','5','APERFECHADO  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','AVERBASFUNC := {}     .CNT.','000010','000001','.EXE.','5','AVERBASFUNC := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','FRETPERCOMP( StrZero(month(dDataRef),2), StrZero(Year(dDataR','000011','000001','.EXE.','5','FRETPERCOMP( StrZero(month(dDataRef),2), StrZero(Year(dDataRef),4), NIL, NIL, NIL, @APERABERTO, @APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT','000012','000001','.EXE.','5','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, APERABERTO, APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','LEN(AVERBASFUNC ) > 0   .END.','000013','000001','.CON.','5','','','5','LEN(AVERBASFUNC ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] <','000014','000013','.EXE.','5','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] < Y[1] + Y[2] + Y[3] + Y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NCONTW := 1     .CNT.','000015','000013','.EXE.','5','NCONTW := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NCONTW <= LEN(AVERBASFUNC)   .END.','000016','000013','.ENQ.','5','','','5','NCONTW <= LEN(AVERBASFUNC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','FGETCODFOL("0757") == AVERBASFUNC[NCONTW, 3]   .END.','000017','000016','.CON.','5','','','5','FGETCODFOL("0757") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NVALANOS := AVERBASFUNC[NCONTW, 7]     .END.','000018','000017','.EXE.','5','NVALANOS := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','FGETCODFOL("0758") == AVERBASFUNC[NCONTW, 3]   .END.','000019','000016','.CON.','5','','','5','FGETCODFOL("0758") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NVALMESES := AVERBASFUNC[NCONTW, 7]     .END.','000020','000019','.EXE.','5','NVALMESES := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','FGETCODFOL("0759") == AVERBASFUNC[NCONTW, 3]   .END.','000021','000016','.CON.','5','','','5','FGETCODFOL("0759") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NVALDIAS := AVERBASFUNC[NCONTW, 7]     .END.','000022','000021','.EXE.','5','NVALDIAS := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NCONTW += 1     .END.','000023','000016','.EXE.','5','NCONTW += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NVALBXPRV := NVALANOS + NVALMESES + NVALDIAS     .CNT.','000024','000001','.EXE.','5','NVALBXPRV := NVALANOS + NVALMESES + NVALDIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','NVALBXPRV > 0   .END.','000025','000001','.CON.','5','','','5','NVALBXPRV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1238"),','000026','000025','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1238"),  (NVALBXPRV ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','SRA->RA_SITFOLH != "D"   .END.','000027','000000','.CON.','5','','','5','SRA->RA_SITFOLH != "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nValBxPrv := 0     .CNT.','000028','000027','.EXE.','5','nValBxPrv := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','aPerAberto := {}     .CNT.','000029','000027','.EXE.','5','aPerAberto := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','aPerFechado := {}     .CNT.','000030','000027','.EXE.','5','aPerFechado := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','aVerbasFunc := {}     .CNT.','000031','000027','.EXE.','5','aVerbasFunc := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataR','000032','000027','.EXE.','5','fRetPerComp( StrZero(Month(dDataRef),2), StrZero(Year(dDataRef),4), NIL, NIL, NIL, @aPerAberto, @aPerFechado)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','aVerbasFunc := RetornaVerbasFunc(SRA->RA_FILIAL, SRA->RA_MAT','000033','000027','.EXE.','5','aVerbasFunc := RetornaVerbasFunc(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "QUI", NIL, aPerAberto, aPerFechado)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','Len(aVerbasFunc ) > 0   .END.','000034','000027','.CON.','5','','','5','Len(aVerbasFunc ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','aSort( aVerbasFunc,,, { |X,Y| X[1] + X[2] + X[3] + X[15] < Y','000035','000034','.EXE.','5','aSort( aVerbasFunc,,, { |X,Y| X[1] + X[2] + X[3] + X[15] < Y[1] + Y[2] + Y[3] + Y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nCont := 1     .CNT.','000036','000034','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nCont <= Len(aVerbasFunc)   .END.','000037','000034','.ENQ.','5','','','5','nCont <= Len(aVerbasFunc)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','fGetCodFol("1274") == aVerbasFunc[nCont, 3]   .END.','000038','000037','.CON.','5','','','5','fGetCodFol("1274") == aVerbasFunc[nCont, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nValBxPrv := aVerbasFunc[nCont, 7]     .END.','000039','000038','.EXE.','5','nValBxPrv := aVerbasFunc[nCont, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nCont += 1     .END.','000040','000037','.EXE.','5','nCont += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','nValBxPrv > 0   .END.','000041','000027','.CON.','5','','','5','nValBxPrv > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVIND','FO_ADD(@&cObjeto, {cCpoPd,  cCpoValor}, {fGetCodFol("1886"),','000042','000041','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPd,  cCpoValor}, {fGetCodFol("1886"), (nValBxPrv) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0010    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0010( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BXPRVVAC','BAJA PROVISION VACACIONES','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','BXPRVVAC','P_PROVFER   .END.','000001','000000','.CON.','5','','','5','P_PROVFER','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','SRA->RA_SITFOLH == "D" .AND. MESANO(DDATAREF) = MESANO(SRA','000002','000001','.CON.','5','','','5','SRA->RA_SITFOLH == "D" .AND. MESANO(DDATAREF) = MESANO(SRA->RA_DEMISSA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NVALBXPRV := 0     .CNT.','000003','000002','.EXE.','5','NVALBXPRV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','nValVenc := 0     .CNT.','000004','000002','.EXE.','5','nValVenc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','nValProp := 0     .CNT.','000005','000002','.EXE.','5','nValProp := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','APERABERTO := {}     .CNT.','000006','000002','.EXE.','5','APERABERTO := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','APERFECHADO  := {}     .CNT.','000007','000002','.EXE.','5','APERFECHADO  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','AVERBASFUNC := {}     .CNT.','000008','000002','.EXE.','5','AVERBASFUNC := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000009','000002','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, NIL, NIL, @APERABERTO, @APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT','000010','000002','.EXE.','5','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, APERABERTO, APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','LEN(AVERBASFUNC ) > 0   .END.','000011','000002','.CON.','5','','','5','LEN(AVERBASFUNC ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] <','000012','000011','.EXE.','5','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] < Y[1] + Y[2] + Y[3] + Y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NCONTW := 1     .CNT.','000013','000011','.EXE.','5','NCONTW := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NCONTW <= LEN(AVERBASFUNC)   .END.','000014','000011','.ENQ.','5','','','5','NCONTW <= LEN(AVERBASFUNC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','FGETCODFOL("0086") == AVERBASFUNC[NCONTW, 3]   .END.','000015','000014','.CON.','5','','','5','FGETCODFOL("0086") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','nValVenc := AVERBASFUNC[NCONTW, 7]     .END.','000016','000015','.EXE.','5','nValVenc := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','FGETCODFOL("0087") == AVERBASFUNC[NCONTW, 3]   .END.','000017','000014','.CON.','5','','','5','FGETCODFOL("0087") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','nValProp := AVERBASFUNC[NCONTW, 7]     .END.','000018','000017','.EXE.','5','nValProp := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NCONTW += 1     .END.','000019','000014','.EXE.','5','NCONTW += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NVALBXPRV :=  nValVenc + nValProp     .CNT.','000020','000002','.EXE.','5','NVALBXPRV :=  nValVenc + nValProp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NVALBXPRV > 0   .END.','000021','000002','.CON.','5','','','5','NVALBXPRV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0262"),','000022','000021','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0262"),  (NVALBXPRV ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DE','000023','000001','.CON.','5','','','5','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DEMISSA) > MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NVALBXPRV := 0     .CNT.','000024','000023','.EXE.','5','NVALBXPRV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','nValAgui := 0     .CNT.','000025','000023','.EXE.','5','nValAgui := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','APERABERTO := {}     .CNT.','000026','000023','.EXE.','5','APERABERTO := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','APERFECHADO  := {}     .CNT.','000027','000023','.EXE.','5','APERFECHADO  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','AVERBASFUNC := {}     .CNT.','000028','000023','.EXE.','5','AVERBASFUNC := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAR','000029','000023','.EXE.','5','FRETPERCOMP( STRZERO(MONTH(DDATAREF),2), STRZERO(YEAR(DDATAREF),4), NIL, NIL, NIL, @APERABERTO, @APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT','000030','000023','.EXE.','5','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, APERABERTO, APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','LEN(AVERBASFUNC ) > 0   .END.','000031','000023','.CON.','5','','','5','LEN(AVERBASFUNC ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] <','000032','000031','.EXE.','5','ASORT( AVERBASFUNC ,,, { |X,Y| X[1] + X[2] + X[3] + X[15] < Y[1] + Y[2] + Y[3] + Y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NCONTW := 1     .CNT.','000033','000031','.EXE.','5','NCONTW := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NCONTW <= LEN(AVERBASFUNC)   .END.','000034','000031','.ENQ.','5','','','5','NCONTW <= LEN(AVERBASFUNC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','FGETCODFOL("0072") == AVERBASFUNC[NCONTW, 3]   .END.','000035','000034','.CON.','5','','','5','FGETCODFOL("0072") == AVERBASFUNC[NCONTW, 3]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','nValFer := AVERBASFUNC[NCONTW, 7]     .END.','000036','000035','.EXE.','5','nValFer := AVERBASFUNC[NCONTW, 7]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','NCONTW += 1     .END.','000037','000034','.EXE.','5','NCONTW += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','nValFer > 0   .END.','000038','000023','.CON.','5','','','5','nValFer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BXPRVVAC','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0332"),','000039','000038','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0233"),  (nValFer ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0011    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0011( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAAFPBOL','CALCULO DO AFP BOL','','000012','038','2','1',} )

aAdd(aRc3Cols, { '','S_','CAAFPBOL','NAFPVEJEZ := 0     .CNT.','000001','000000','.EXE.','5','NAFPVEJEZ := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NAFPRISCO := 0     .CNT.','000002','000000','.EXE.','5','NAFPRISCO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NAFPCOMIS := 0     .CNT.','000003','000000','.EXE.','5','NAFPCOMIS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NBASEAFPC := 0     .CNT.','000004','000000','.EXE.','5','NBASEAFPC := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NBASEAFPV := 0     .CNT.','000005','000000','.EXE.','5','NBASEAFPV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NBASEAFPR := 0     .CNT.','000006','000000','.EXE.','5','NBASEAFPR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NPERSOLI    := 0     .CNT.','000007','000000','.EXE.','5','NPERSOLI    := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NBAFPSOL  :=  0     .CNT.','000008','000000','.EXE.','5','NBAFPSOL  :=  0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NVAFPSOL   := 0     .END.','000009','000000','.EXE.','5','NVAFPSOL   := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nPerComis := If( FTABELA("S002",1,6,dDataRef) <> Nil, FTABEL','000010','000000','.EXE.','5','nPerComis := If( FTABELA("S002",1,6,dDataRef) <> Nil, FTABELA("S002",1,6,dDataRef), FTABELA("S002",1,6 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nPerVejez := If( FTABELA("S002",1,4,dDataRef) <> Nil, FTABEL','000011','000000','.EXE.','5','nPerVejez := If( FTABELA("S002",1,4,dDataRef) <> Nil, FTABELA("S002",1,4,dDataRef), FTABELA("S002",1,4 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nPerRisco := If( FTABELA("S002",1,5,dDataRef) <> Nil, FTABEL','000012','000000','.EXE.','5','nPerRisco := If( FTABELA("S002",1,5,dDataRef) <> Nil, FTABELA("S002",1,5,dDataRef), FTABELA("S002",1,5 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nTope := If( FTABELA("S002",1,6,dDataRef) <> Nil, FTABELA("S','000013','000000','.EXE.','5','nTope := If( FTABELA("S002",1,6,dDataRef) <> Nil, FTABELA("S002",1,7,dDataRef), FTABELA("S002",1,7 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nTope := If (nTope = Nil, 0, nTope)     .CNT.','000014','000000','.EXE.','5','nTope := If (nTope = Nil, 0, nTope)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nIdade := Calc_Idade( dDataBase , SRA->RA_NASC )     .CNT.','000015','000000','.EXE.','5','nIdade := Calc_Idade( dDataBase , SRA->RA_NASC )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nPerSoli := If( FTABELA("S002",1,8,dDataRef) <> Nil, FTABELA','000016','000000','.EXE.','5','NPERSOLI := If( FTABELA("S002",1,8,dDataRef) <> Nil, FTABELA("S002",1,8,dDataRef), FTABELA("S002",1,8 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','Type("nPerComis") == "U"   .END.','000017','000000','.CON.','5','','','5','Type("nPerComis") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nPerComis := 0     .END.','000018','000017','.EXE.','5','nPerComis := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','Type("nPerVejez") == "U"   .END.','000019','000000','.CON.','5','','','5','Type("nPerVejez") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nPerVejez := 0     .END.','000020','000019','.EXE.','5','nPerVejez := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','Type("nPerRisco") == "U"   .END.','000021','000000','.CON.','5','','','5','Type("nPerRisco") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nPerRisco := 0     .END.','000022','000021','.EXE.','5','nPerRisco := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','"1" $ (SRA->RA_AFPOPC)   .END.','000023','000000','.CON.','5','','','5','"1" $ (SRA->RA_AFPOPC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPC := FO_SOMAINCSRV(@&cObjeto, cCpoValor, {"RV_INSS"}','000024','000023','.EXE.','5','nBaseAFPC := FO_SOMAINCSRV(@&cObjeto, cCpoValor, {"RV_INSS"}, {"S"} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPC > 0   .END.','000025','000023','.CON.','5','','','5','nBaseAFPC > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','VAL_SALMIN > 0 .and. nTope > 0   .END.','000026','000025','.CON.','5','','','5','VAL_SALMIN > 0 .and. nTope > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPC > (nTope  * VAL_SALMIN)   .END.','000027','000026','.CON.','5','','','5','nBaseAFPC > (nTope  * VAL_SALMIN)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPC := (nTope * VAL_SALMIN)     .END.','000028','000027','.EXE.','5','nBaseAFPC := (nTope * VAL_SALMIN)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nAFPComis := (nBaseAFPC * nPerComis ) / 100     .END.','000029','000025','.EXE.','5','nAFPComis := (nBaseAFPC * nPerComis ) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','"2" $ (SRA->RA_AFPOPC)   .END.','000030','000000','.CON.','5','','','5','"2" $ (SRA->RA_AFPOPC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPV := FO_SOMAINCSRV(@&cObjeto, cCpoValor, {"RV_AFPVEJ','000031','000030','.EXE.','5','nBaseAFPV := FO_SOMAINCSRV(@&cObjeto, cCpoValor, {"RV_AFPVEJE"}, {"S"} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPV > 0   .END.','000032','000030','.CON.','5','','','5','nBaseAFPV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','VAL_SALMIN > 0 .and. nTope > 0   .END.','000033','000032','.CON.','5','','','5','VAL_SALMIN > 0 .and. nTope > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPV > (nTope  * VAL_SALMIN)   .END.','000034','000033','.CON.','5','','','5','nBaseAFPV > (nTope  * VAL_SALMIN)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPV := (nTope * VAL_SALMIN)     .END.','000035','000034','.EXE.','5','nBaseAFPV := (nTope * VAL_SALMIN)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nAFPVejez := (nBaseAFPV * nPerVejez ) / 100     .END.','000036','000032','.EXE.','5','nAFPVejez := (nBaseAFPV * nPerVejez ) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','"3" $ (SRA->RA_AFPOPC)   .END.','000037','000000','.CON.','5','','','5','"3" $ (SRA->RA_AFPOPC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPR := FO_SOMAINCSRV(@&cObjeto, cCpoValor, {"RV_AFPRIE','000038','000037','.EXE.','5','nBaseAFPR := FO_SOMAINCSRV(@&cObjeto, cCpoValor, {"RV_AFPRIES"}, {"S"} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPR > 0   .END.','000039','000037','.CON.','5','','','5','nBaseAFPR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','VAL_SALMIN > 0 .and. nTope > 0   .END.','000040','000039','.CON.','5','','','5','VAL_SALMIN > 0 .and. nTope > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPR > (nTope  * VAL_SALMIN)   .END.','000041','000040','.CON.','5','','','5','nBaseAFPR > (nTope  * VAL_SALMIN)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nBaseAFPR := (nTope * VAL_SALMIN)     .END.','000042','000041','.EXE.','5','nBaseAFPR := (nTope * VAL_SALMIN)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','nAFPRisco := (nBaseAFPR * nPerRisco ) / 100     .END.','000043','000039','.EXE.','5','nAFPRisco := (nBaseAFPR * nPerRisco ) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','"4" $ (SRA->RA_AFPOPC)   .END.','000044','000000','.CON.','5','','','5','"4" $ (SRA->RA_AFPOPC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NBAFPSOL := FO_SOMAINCSRV(@&cObjeto, cCpoValor, {"RV_AFPSOLI','000045','000044','.EXE.','5','NBAFPSOL := FO_SOMAINCSRV(@&cObjeto, cCpoValor, {"RV_AFPSOLI"}, {"1"} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NBAFPSOL > 0 .and. nTope > 0 .and. VAL_SALMIN > 0   .END.','000046','000044','.CON.','5','','','5','NBAFPSOL > 0 .and. nTope > 0 .and. VAL_SALMIN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NBAFPSOL > (nTope * VAL_SALMIN)   .END.','000047','000046','.CON.','5','','','5','NBAFPSOL > (nTope * VAL_SALMIN)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NBAFPSOL := (nTope * VAL_SALMIN)     .END.','000048','000047','.EXE.','5','NBAFPSOL := (nTope * VAL_SALMIN)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAAFPBOL','NVAFPSOL := (NBAFPSOL * nPerSoli) / 100     .END.','000049','000044','.EXE.','5','NVAFPSOL := (NBAFPSOL * nPerSoli) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0012    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0012( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CACHKINI','CAL. ADIANT. TESTE INICIAL','','282111','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CACHKINI','nInSal:= nAdtServ:= nPeric:= 0.00     .CNT.','000001','000000','.EXE.','5','nInSal:= nAdtServ:= nPeric:= 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CACHKINI','cCodIns:= cCodAdt:= Space(03)     .CNT.','000002','000000','.EXE.','5','cCodIns:= cCodAdt:= Space(03)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CACHKINI','dDtaAfas:= dDtaRet:= CToD("")     .CNT.','000003','000000','.EXE.','5','dDtaAfas:= dDtaRet:= CToD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CACHKINI','cTipAfas:= '+"'"+''+"'"+'     .CNT.','000004','000000','.EXE.','5','cTipAfas:= '+"'"+''+"'"+'','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CACHKINI','aTarefas:= {}     .CNT.','000005','000000','.EXE.','5','aTarefas:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CACHKINI','APARPROF := {}     .CNT.','000006','000000','.EXE.','5','APARPROF := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CACHKINI','P_ADCINTEG:= If(P_ADCINTEG==NIL,.F.,P_ADCINTEG)     .CNT.','000007','000000','.EXE.','5','P_ADCINTEG:= If(P_ADCINTEG==NIL,.F.,P_ADCINTEG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CACHKINI','(SRA->RA_PERCADT = 0) .Or. (SRA->RA_TIPOPGT = "S")   .END.','000008','000000','.CON.','5','','','5','(SRA->RA_PERCADT = 0) .Or. (SRA->RA_TIPOPGT = "S")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CACHKINI','FinalFun()     .END.','000009','000008','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0013    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0013( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALAPPAT','CALCULO APORTE PATRONAL','','','026','2','1',} )

aAdd(aRc3Cols, { '','S_','CALAPPAT','NBFONSOL := 0     .CNT.','000001','000000','.EXE.','5','NBFONSOL := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NPERVIVIEN := If( FTABELA("S004",1, 4, dDataRef ) <> Nil, FT','000002','000000','.EXE.','5','NPERVIVIEN := If( FTABELA("S004",1, 4, dDataRef ) <> Nil, FTABELA("S004", 1, 4, dDataRef ), FTABELA("S004", 1, 4 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NPERRISPRO := If( FTABELA("S004",1, 5, dDataRef ) <> Nil, FT','000003','000000','.EXE.','5','NPERRISPRO := If( FTABELA("S004",1, 5, dDataRef ) <> Nil, FTABELA("S004", 1, 5, dDataRef ), FTABELA("S004", 1, 5 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NPERCNS := If( FTABELA("S004",1, 6, dDataRef ) <> Nil, FTABE','000004','000000','.EXE.','5','NPERCNS := If( FTABELA("S004",1, 6, dDataRef ) <> Nil, FTABELA("S004", 1, 6, dDataRef ), FTABELA("S004", 1, 6 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NTOPE := If( FTABELA("S004",1, 7, dDataRef ) <> Nil, FTABELA','000005','000000','.EXE.','5','NTOPE := If( FTABELA("S004",1, 7, dDataRef ) <> Nil, FTABELA("S004", 1, 7, dDataRef ), FTABELA("S004", 1, 7 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NPERAPAC := If( FTABELA("S004",1, 8, dDataRef ) <> Nil, FTAB','000006','000000','.EXE.','5','NPERAPAC := If( FTABELA("S004",1, 8, dDataRef ) <> Nil, FTABELA("S004", 1, 8, dDataRef ), FTABELA("S004", 1, 8 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NBASEPATRO := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_APORPA','000007','000000','.EXE.','5','NBASEPATRO := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_APORPAT" , "1" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NVALCNS  := (NBASEPATRO * NPERCNS ) / 100     .CNT.','000008','000000','.EXE.','5','NVALCNS  := (NBASEPATRO * NPERCNS ) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NBASEPATRO > 0   .END.','000009','000000','.CON.','5','','','5','NBASEPATRO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','( VAL_SALMIN > 0 .AND. NTOPE > 0 )   .END.','000010','000009','.CON.','5','','','5','( VAL_SALMIN > 0 .AND. NTOPE > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','( NBASEPATRO > ( VAL_SALMIN * NTOPE) )   .END.','000011','000010','.CON.','5','','','5','( NBASEPATRO > ( VAL_SALMIN * NTOPE) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NBPATEXC    :=  NBASEPATRO - (VAL_SALMIN * NTOPE)     .CNT.','000012','000011','.EXE.','5','NBPATEXC    :=  NBASEPATRO - (VAL_SALMIN * NTOPE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NBASEPATRO  := (VAL_SALMIN * NTOPE)     .END.','000013','000011','.EXE.','5','NBASEPATRO  := (VAL_SALMIN * NTOPE)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','TYPE("SRA->RA_RIESPRO") <> "U" .AND. (SRA->RA_RIESPRO == "','000014','000009','.CON.','5','','','5','TYPE("SRA->RA_RIESPRO") <> "U" .AND. (SRA->RA_RIESPRO == "S" .OR. Empty(SRA->RA_RIESPRO) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NVALRPROF := (NBASEPATRO * NPERRISPRO ) / 100     .END.','000015','000014','.EXE.','5','NVALRPROF := (NBASEPATRO * NPERRISPRO ) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NVALVIV := (NBASEPATRO * NPERVIVIEN ) / 100     .CNT.','000016','000009','.EXE.','5','NVALVIV := (NBASEPATRO * NPERVIVIEN ) / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALAPPAT','NVALAPAD  := (NBASEPATRO * NPERAPAC ) / 100     .END.','000017','000009','.EXE.','5','NVALAPAD  := (NBASEPATRO * NPERAPAC ) / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0014    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0014( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCAGUI','CALCULO AGUINALDO','','','016','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCAGUI','aPerAberto := {}     .CNT.','000001','000000','.EXE.','5','aPerAberto := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','aPerFechado := {}     .CNT.','000002','000000','.EXE.','5','aPerFechado := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','aVerbasFunc := {}     .CNT.','000003','000000','.EXE.','5','aVerbasFunc := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','SRA->RA_ADMISSA > RCH->RCH_DTFIM   .END.','000004','000000','.CON.','5','','','5','SRA->RA_ADMISSA > RCH->RCH_DTFIM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','FinalFun()     .END.','000005','000004','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','cMeses := Posicione("RCJ", 1, xFilial("RCJ", SRA->RA_FILIAL)','000006','000000','.EXE.','5','cMeses := Posicione("RCJ", 1, xFilial("RCJ", SRA->RA_FILIAL) + cProcesso, "RCJ_MESPAG")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nMesesTrab := ((RCH->RCH_DTFIM  - SRA->RA_ADMISSA) + 1) / 30','000007','000000','.EXE.','5','nMesesTrab := ((RCH->RCH_DTFIM  - SRA->RA_ADMISSA) + 1) / 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nMesesTrab < 12   .END.','000008','000000','.CON.','5','','','5','nMesesTrab < 12','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nMesesTrab := ( Month(RCH->RCH_DTFIM) - Month(SRA->RA_ADMISS','000009','000008','.EXE.','5','nMesesTrab := ( Month(RCH->RCH_DTFIM) - Month(SRA->RA_ADMISSA) ) + ( ( 30 - Day(SRA->RA_ADMISSA)+1 ) / 30 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nAvos := Min(nMesesTrab, 12)     .CNT.','000010','000000','.EXE.','5','nAvos := Min(nMesesTrab, 12)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','cMaoObra := Posicione("SRJ", 1, xFilial("SRJ", SRA->RA_FILIA','000011','000000','.EXE.','5','cMaoObra := Posicione("SRJ", 1, xFilial("SRJ", SRA->RA_FILIAL) + SRA->RA_CODFUNC, "RJ_MAOBRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','cMaoObra == "I"   .END.','000012','000000','.CON.','5','','','5','cMaoObra == "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nMesesTrab < 3   .END.','000013','000012','.CON.','5','','','5','nMesesTrab < 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','FinalFun()     .END.','000014','000013','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','cMaoObra == "D"   .END.','000015','000000','.CON.','5','','','5','cMaoObra == "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nMesesTrab <= 1   .END.','000016','000015','.CON.','5','','','5','nMesesTrab <= 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','FinalFun()     .END.','000017','000016','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','!!Empty(cMeses)   .END.','000018','000000','.CON.','5','','','5','!!Empty(cMeses)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','cPerIni := AnoMes( MonthSub( sTod( cPeriodo + "01" ), Val(cM','000019','000018','.EXE.','5','cPerIni := AnoMes( MonthSub( sTod( cPeriodo + "01" ), Val(cMeses) ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','Val(cMeses) > 0 .And. cPerIni < cPeriodo .And. ( !fPosPeri','000020','000000','.ENQ.','5','','','5','Val(cMeses) > 0 .And. cPerIni < cPeriodo .And. ( !fPosPeriodo( xFilial("RCH", SRA->RA_FILIAL), cProcesso, cPerIni, Nil, "FOL", Nil, Nil, 4 ))','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','cMeses := Str( Val(cMeses) - 1 )     .CNT.','000021','000020','.EXE.','5','cMeses := Str( Val(cMeses) - 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','cPerIni := AnoMes( MonthSub( sTod( cPeriodo + "01" ), Val(cM','000022','000020','.EXE.','5','cPerIni := AnoMes( MonthSub( sTod( cPeriodo + "01" ), Val(cMeses) ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','RetPerAbertFech( cProcesso, "FOL", cPerIni, "99", cPeriodo,','000023','000000','.EXE.','5','RetPerAbertFech( cProcesso, "FOL", cPerIni, "99", cPeriodo, "99", @aPerAberto, @aPerFechado )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','aVerbasFunc := RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MA','000024','000000','.EXE.','5','aVerbasFunc := RetornaVerbasFunc( SRA->RA_FILIAL, SRA->RA_MAT, Nil, "FOL", Nil, aPerAberto, aPerFechado )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','Len(aVerbasFunc) > 0   .END.','000025','000000','.CON.','5','','','5','Len(aVerbasFunc) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','aSort( aVerbasFunc, Nil, Nil, { |x,y| x[1]+x[2]+x[3]+x[15] <','000026','000025','.EXE.','5','aSort( aVerbasFunc, Nil, Nil, { |x,y| x[1]+x[2]+x[3]+x[15] < y[1]+y[2]+y[3]+y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nCont2 := 1     .CNT.','000027','000025','.EXE.','5','nCont2 := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nCont2 <= Len(aVerbasFunc)   .END.','000028','000025','.ENQ.','5','','','5','nCont2 <= Len(aVerbasFunc)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','RetValSRV( aVerbasFunc[nCont2, 3], SRA->RA_FILIAL, "RV_MED','000029','000028','.CON.','5','','','5','RetValSRV( aVerbasFunc[nCont2, 3], SRA->RA_FILIAL, "RV_MED13" ) $ "S |SP|03"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nBaseMes += aVerbasFunc[nCont2, 7] * Iif( RetValSRV(aVerbasF','000030','000029','.EXE.','5','nBaseMes += aVerbasFunc[nCont2, 7] * Iif( RetValSRV(aVerbasFunc[nCont2, 3], SRA->RA_FILIAL , "RV_TIPOCOD") == "1", 1, Iif( RetValSRV(aVerbasFunc[nCont2, 3], SRA->RA_FILIAL, "RV_TIPOCOD") == "2", -1,0 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nCont2 += 1     .END.','000031','000028','.EXE.','5','nCont2 += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','P_PMEDAGUI   .END.','000032','000025','.CON.','5','','','5','P_PMEDAGUI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nBaseMes := nBaseMes / IIf(nMesesTrab > 3, 3 , Int(nMesesTra','000033','000032','.EXE.','5','nBaseMes := nBaseMes / IIf(nMesesTrab > 3, 3 , Int(nMesesTrab) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','!P_PMEDAGUI   .END.','000034','000025','.CON.','5','','','5','!P_PMEDAGUI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','nBaseMes := nBaseMes / 3     .END.','000035','000034','.EXE.','5','nBaseMes := nBaseMes / 3','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCAGUI','n13Sal := nBaseMes / 12 * nMesesTrab     .END.','000036','000000','.EXE.','5','n13Sal := nBaseMes / 12 * nMesesTrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0015    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0015( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCANTI','CALCULO DEL BONO ANTIGUEDAD','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCANTI','( SRA->RA_TIPOPGT == "S" .AND. LULTSEMANA ) .OR. SRA->RA_T','000001','000000','.CON.','5','','','5','( SRA->RA_TIPOPGT == "S" .AND. LULTSEMANA ) .OR. SRA->RA_TIPOPGT # "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','DDTBS_ATS := SRA->RA_ADMISSA     .CNT.','000002','000001','.EXE.','5','DDTBS_ATS := SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','DDTLIMITE := DDATAATE     .CNT.','000003','000001','.EXE.','5','DDTLIMITE := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','DDTLIMITE := IF(!EMPTY(SRA->RA_DEMISSA) .AND.(SRA->RA_DEMISS','000004','000001','.EXE.','5','DDTLIMITE := IF(!EMPTY(SRA->RA_DEMISSA) .AND.(SRA->RA_DEMISSA<DDTLIMITE),SRA->RA_DEMISSA,DDTLIMITE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','NANOF_ATS := INT(DateDiffYear( DDTBS_ATS, DDTLIMITE+1 ) )','000005','000001','.EXE.','5','NANOF_ATS := INT(DateDiffYear( DDTBS_ATS, DDTLIMITE+1 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','NPERANT := 0     .CNT.','000006','000001','.EXE.','5','NPERANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','NVLBONOANT := 0     .CNT.','000007','000001','.EXE.','5','NVLBONOANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','NANOF_ATS > 1   .END.','000008','000001','.CON.','5','','','5','NANOF_ATS > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','NAUX := FPOSTAB("S003", NANOF_ATS, ">=", 4, NANOF_ATS, "<=",','000009','000008','.EXE.','5','NAUX := FPOSTAB("S003", NANOF_ATS, ">=", 4, NANOF_ATS, "<=", 5 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','NAUX > 0   .END.','000010','000008','.CON.','5','','','5','NAUX > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','NPERANT :=  IF( FTABELA("S003", NAUX, 6, DDATAREF) <> NIL, F','000011','000010','.EXE.','5','NPERANT :=  IF( FTABELA("S003", NAUX, 6, DDATAREF) <> NIL, FTABELA("S003", NAUX, 6, DDATAREF),  FTABELA("S003", NAUX, 6 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','VAL_SALMIN > 0   .END.','000012','000010','.CON.','5','','','5','VAL_SALMIN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','nBaseBono := ( 3 * VAL_SALMIN)     .CNT.','000013','000012','.EXE.','5','nBaseBono := ( 3 * VAL_SALMIN)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANTI','NVLBONOANT := nBaseBono * NPERANT / 100     .END.','000014','000012','.EXE.','5','NVLBONOANT := nBaseBono * NPERANT / 100','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0016    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0016( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCDSR','Calculo DSR','','000261','052','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh := SRA->RA_SITFOLH     .CNT.','000001','000000','.EXE.','5','cSitFolh := SRA->RA_SITFOLH','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','LMESADM := IF( P_MESPARTI, (SRA->RA_ADMISSA>=DDATADE .AND. S','000002','000000','.EXE.','5','LMESADM := IF( P_MESPARTI, (SRA->RA_ADMISSA>=DDATADE .AND. SRA->RA_ADMISSA<= DDATAATE ), (MESANO(SRA->RA_ADMISSA) = CANOMES .OR. MESANO(SRA->RA_ADMISSA) == MESANO( DDATADE) ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh = " " .END.','000003','000000','.CON.','5','','','5','cSitFolh','=','5','" "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT = "M" .END.','000004','000003','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "M*C*A*P*E*1*2*3*4" .END.','000005','000004','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*A*P*E*1*2*3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Salmes     .CNT.','000006','000005','.EXE.','5','nSalPg     := Salmes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','LMESADM   .END.','000007','000005','.CON.','5','','','5','LMESADM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg := Round(SalMes / 30 * DiasTrab,2)     .END.','000008','000007','.EXE.','5','nSalPg := Round(SalMes / 30 * DiasTrab,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "H*G" .END.','000009','000004','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))     .','000010','000009','.EXE.','5','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))     .END.','000011','000009','.EXE.','5','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "D" .END.','000012','000004','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := SalDia * Diastrab     .END.','000013','000012','.EXE.','5','nSalPg     := SalDia * Diastrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT = "S" .END.','000014','000003','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','Type("NTOTDIAS") = "U" .END.','000015','000014','.CON.','5','','','5','Type("NTOTDIAS")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nTotDias := 7     .END.','000016','000015','.EXE.','5','nTotDias := 7','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','000017','000014','.EXE.','5','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','DiasDsr > 0 .END.','000018','000014','.CON.','5','','','5','DiasDsr','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nTotdias  := DiasTrab + DiasDsr     .CNT.','000019','000018','.EXE.','5','nTotdias  := DiasTrab + DiasDsr','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotD','000020','000018','.EXE.','5','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotDias-DiasTrab) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nHorasDsr  := nTotDias - DiasTrab     .END.','000021','000018','.EXE.','5','nHorasDsr  := nTotDias - DiasTrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh <> " " .AND. cSitFolh # "D"   .AND.','000022','000000','.CON.','5','','','5','cSitFolh <> " " .AND. cSitFolh # "D"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*1*2*3*4" .END.','000023','000000','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*D*S*A*P*E*1*2*3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))     .EN','000024','000023','.EXE.','5','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','(cSitFolh <> " ") .AND. (cSitFolh # "D") .AND. ! (SRA->RA_','000025','000000','.CON.','5','','','5','(cSitFolh <> " ") .AND. (cSitFolh # "D") .AND. ! (SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*1*2*3*4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','000026','000025','.EXE.','5','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))     .','000027','000025','.EXE.','5','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','cSitFolh = "A" .AND.','000028','000000','.CON.','5','','','5','cSitFolh','=','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','SRA->RA_TIPOPGT == "S" .END.','000029','000000','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))     .CNT','000030','000029','.EXE.','5','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCDSR','nHorasDsr  := DiasDsr     .END.','000031','000029','.EXE.','5','nHorasDsr  := DiasDsr','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0017    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0017( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCLIQ','CALCULO O LIQUIDO DO ADIANTAM.','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCLIQ','nLiqAdi := 0     .CNT.','000001','000000','.EXE.','5','nLiqAdi := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nProvAdi := 0   .CNT.','000002','000000','.EXE.','5','nProvAdi',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nDescAdi := 0   .CNT.','000003','000000','.EXE.','5','nDescAdi',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nVlrTot := 0     .CNT.','000004','000000','.EXE.','5','nVlrTot := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nArred := P_ARREDAD   .CNT.','000005','000000','.EXE.','5','nArred',':=','5','P_ARREDAD','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','Fo_Gotop(@&cObjeto)     .CNT.','000006','000000','.EXE.','5','Fo_Gotop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','!FO_Eof(@&cObjeto)   .END.','000007','000000','.ENQ.','5','','','5','!FO_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','FO_GETVAL(@&COBJETO,CCPOPD) <> FGETCODFOL("0006")   .AND.','000008','000007','.CON.','5','','','5','FO_GETVAL(@&COBJETO,CCPOPD) <> FGETCODFOL("0006")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','!FO_DELETED(@&COBJETO)   .AND.','000009','000007','.CON.','5','','','5','!FO_DELETED(@&COBJETO)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','PosSrv(Fo_GetVal(@&cObjeto,cCpoPD), SRA->RA_FILIAL, "RV_AD','000010','000007','.CON.','5','','','5','PosSrv(Fo_GetVal(@&cObjeto,cCpoPD), SRA->RA_FILIAL, "RV_ADIANTA")  == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','PosSrv(Fo_GetVal(@&cObjeto,cCpoPD),SRA->RA_FILIAL,"RV_TIPO','000011','000010','.CON.','5','','','5','PosSrv(Fo_GetVal(@&cObjeto,cCpoPD),SRA->RA_FILIAL,"RV_TIPOCOD")=="1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nProvAdi := Fo_GetVal(@&cObjeto,cCpoValor)   .CNT.','000012','000011','.EXE.','5','nProvAdi',':=','5','Fo_GetVal(@&cObjeto,cCpoValor)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nLiqAdi += nProvAdi   .END.','000013','000011','.EXE.','5','nLiqAdi','+=','5','nProvAdi','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','PosSrv(Fo_GetVal(@&cObjeto,cCpoPD),SRA->RA_FILIAL,"RV_TIPO','000014','000010','.CON.','5','','','5','PosSrv(Fo_GetVal(@&cObjeto,cCpoPD),SRA->RA_FILIAL,"RV_TIPOCOD")=="2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nDescAdi := Fo_GetVal(@&cObjeto,cCpoValor)   .CNT.','000015','000014','.EXE.','5','nDescAdi',':=','5','Fo_GetVal(@&cObjeto,cCpoValor)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nLiqAdi -= nDescAdi   .END.','000016','000014','.EXE.','5','nLiqAdi','-=','5','nDescAdi','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','Fo_Skip(@&cObjeto)     .END.','000017','000007','.EXE.','5','Fo_Skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nLiqAdi := nLiqAdi + VAL_ADTO     .CNT.','000018','000000','.EXE.','5','nLiqAdi := nLiqAdi + VAL_ADTO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCLIQ','nVlrTot := ( nLiqAdi - IR_CALC )     .END.','000019','000000','.EXE.','5','nVlrTot := ( nLiqAdi - IR_CALC )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0018    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0018( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCQUIN','CALCULO QUINQUENIO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCQUIN','nBaseQ := 0     .CNT.','000001','000000','.EXE.','5','nBaseQ := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','aPerAberto := {}     .CNT.','000002','000000','.EXE.','5','aPerAberto := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','aPerFechado := {}     .CNT.','000003','000000','.EXE.','5','aPerFechado := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','DDTLIMITE := If(cTipoRot == "4", dDataDem, dDataFim)     .CN','000004','000000','.EXE.','5','DDTLIMITE := If(cTipoRot == "4", dDataDem, dDataFim)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NANOT := INT(DATEDIFFYEAR( DDTLIMITE , SRA->RA_ADMISSA ) )','000005','000000','.EXE.','5','NANOT := INT(DATEDIFFYEAR( DDTLIMITE , SRA->RA_ADMISSA ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NANOT >= 5   .END.','000006','000000','.CON.','5','','','5','NANOT >= 5','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','( MOD( (YEAR(DDTLIMITE)- YEAR(SRA->RA_ADMISSA) ), 5 ) = 0','000007','000006','.CON.','5','','','5','( MOD( (YEAR(DDTLIMITE)- YEAR(SRA->RA_ADMISSA) ), 5 ) = 0 )  .AND. ( MONTH(DDTLIMITE) == MONTH(SRA->RA_ADMISSA) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','dDataAnt  := MonthSub(dDtLimite, 3 )     .CNT.','000008','000007','.EXE.','5','dDataAnt  := MonthSub(dDtLimite, 3 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','dDataAnt < dDtLimite   .END.','000009','000007','.ENQ.','5','','','5','dDataAnt < dDtLimite','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','FRETPERCOMP( Strzero(Month(dDataAnt),2) , Strzero(Year(dData','000010','000009','.EXE.','5','FRETPERCOMP( Strzero(Month(dDataAnt),2) , Strzero(Year(dDataAnt) , 4) , NIL, NIL, NIL, @APERABERTO, @APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT','000011','000009','.EXE.','5','AVERBASFUNC := RETORNAVERBASFUNC(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, , APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','LEN(AVERBASFUNC ) > 0   .END.','000012','000009','.CON.','5','','','5','LEN(AVERBASFUNC ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NCONT := 0     .CNT.','000013','000012','.EXE.','5','NCONT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NCONT <= LEN(AVERBASFUNC)   .END.','000014','000012','.ENQ.','5','','','5','NCONT <= LEN(AVERBASFUNC)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','POSSRV(AVERBASFUNC[NCONT, 3], SRA->RA_FILIAL, "RV_ADICTS")','000015','000014','.CON.','5','','','5','POSSRV(AVERBASFUNC[NCONT, 3], SRA->RA_FILIAL, "RV_ADICTS") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NBASEMES += AVERBASFUNC[NCONT, 7] * IF(POSSRV(AVERBASFUNC[NC','000016','000015','.EXE.','5','NBASEMES += AVERBASFUNC[NCONT, 7] * IF(POSSRV(AVERBASFUNC[NCONT, 3] , AVERBASFUNC[NCONT,1]  , "RV_TIPOCOD") == "1", 1, IF(POSSRV(AVERBASFUNC[NCONT, 3] , AVERBASFUNC[NCONT,1], "RV_TIPOCOD") == "2",-1,0 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NCONT += 1     .END.','000017','000014','.EXE.','5','NCONT += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NBASEQ += NBASEMES     .CNT.','000018','000012','.EXE.','5','NBASEQ += NBASEMES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NBASEMES > 0   .END.','000019','000012','.CON.','5','','','5','NBASEMES > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NCONT1 += 1     .END.','000020','000019','.EXE.','5','NCONT1 += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NBASEMES := 0     .END.','000021','000012','.EXE.','5','NBASEMES := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','MonthSum( dDataAnt , 1 )     .END.','000022','000009','.EXE.','5','MonthSum( dDataAnt , 1 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIN','NBASEQ := (NBASEQ / NCONT1 )     .END.','000023','000007','.EXE.','5','NBASEQ := (NBASEQ / NCONT1 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0019    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0019( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCQUIR','CALC.E GRAVA VALOR QUINQUENIO P/ ROTEIRO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTINI := SRA->RA_ADMISSA     .END.','000001','000000','.EXE.','5','DDTINI := SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','CVBQUISAL := FGETCODFOL("1273")     .CNT.','000002','000000','.EXE.','5','CVBQUISAL := FGETCODFOL("1273")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','CVBQUIVAL := FGETCODFOL("1274")     .CNT.','000003','000000','.EXE.','5','CVBQUIVAL := FGETCODFOL("1274")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','CVBQUIMUL := FGETCODFOL("1275")     .CNT.','000004','000000','.EXE.','5','CVBQUIMUL := FGETCODFOL("1275")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NQTDMAX := 5     .CNT.','000005','000000','.EXE.','5','NQTDMAX := 5','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','EMPTY( CVBQUIVAL )   .END.','000006','000000','.CON.','5','','','5','EMPTY( CVBQUIVAL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','CMSGLOG := FMSGFORM({19}) + "1274 - " + FDESC("RCN", "1274",','000007','000006','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "1274 - " + FDESC("RCN", "1274", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','S_MSGLOG()     .CNT.','000008','000006','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FINALFUN()     .END.','000009','000006','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','PELO ROTEIRO "QUI" APENAS FUNCIONARIOS COM SITUACAO NORMAL','000010','000000','.MSG.','5','PELO ROTEIRO "QUI" APENAS FUNCIONARIOS COM SITUACAO NORMAL','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','!EMPTY(SRA->RA_DEMISSA) .AND. CTIPOROT == "B"   .END.','000011','000000','.CON.','5','','','5','!EMPTY(SRA->RA_DEMISSA) .AND. CTIPOROT == "B"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FINALFUN()     .END.','000012','000011','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','LDEM := CTIPOROT == "4"   .END.','000013','000000','.CON.','5','','','5','LDEM := CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','ADIASQUINQ := DATEDIFFYMD(SRA->RA_ADMISSA, DDATADEM + 1 )','000014','000013','.EXE.','5','ADIASQUINQ := DATEDIFFYMD(SRA->RA_ADMISSA, DDATADEM + 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','S_BSVALPRV()     .CNT.','000015','000013','.EXE.','5','S_BSVALPRV()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTFIM := DDATADEM     .CNT.','000016','000013','.EXE.','5','DDTFIM := DDATADEM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDATAPG := DDATADEM     .CNT.','000017','000013','.EXE.','5','DDATAPG := DDATADEM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','ISINCALLSTACK("GPEM040")   .END.','000018','000013','.CON.','5','','','5','ISINCALLSTACK("GPEM040")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','TYPE("RG_DSOLQUI") == "U" .OR. ( TYPE("RG_DSOLQUI") # "U"','000019','000018','.CON.','5','','','5','TYPE("RG_DSOLQUI") == "U" .OR. ( TYPE("RG_DSOLQUI") # "U" .AND. EMPTY(GETMEMVAR("RG_DSOLQUI")) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTSOLIC := DDATAPG     .END.','000020','000019','.EXE.','5','DDTSOLIC := DDATAPG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','EMPTY( DDTSOLIC )   .END.','000021','000018','.CON.','5','','','5','EMPTY( DDTSOLIC )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTSOLIC := GETMEMVAR("RG_DSOLQUI")     .END.','000022','000021','.EXE.','5','DDTSOLIC := GETMEMVAR("RG_DSOLQUI")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','ISINCALLSTACK("GPEM630")   .END.','000023','000013','.CON.','5','','','5','ISINCALLSTACK("GPEM630")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','TYPE("DSQUIRECOL") == "U" .OR. ( TYPE("DSQUIRECOL") # "U"','000024','000023','.CON.','5','','','5','TYPE("DSQUIRECOL") == "U" .OR. ( TYPE("DSQUIRECOL") # "U" .AND. EMPTY(DSQUIRECOL) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTSOLIC := DDATAPG     .END.','000025','000024','.EXE.','5','DDTSOLIC := DDATAPG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','EMPTY( DDTSOLIC )   .END.','000026','000023','.CON.','5','','','5','EMPTY( DDTSOLIC )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTSOLIC := DSQUIRECOL     .END.','000027','000026','.EXE.','5','DDTSOLIC := DSQUIRECOL','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','!LDEM   .END.','000028','000000','.CON.','5','','','5','!LDEM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','ADIASQUINQ := DATEDIFFYMD(SRA->RA_ADMISSA, CTOD( STRZERO(F_U','000029','000028','.EXE.','5','ADIASQUINQ := DATEDIFFYMD(SRA->RA_ADMISSA, CTOD( STRZERO(F_ULTDIA(DDATAREF), 2) + SUBSTR(DTOC(DDATAREF), 3, 8)))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTFIM := DDATAREF     .CNT.','000030','000028','.EXE.','5','DDTFIM := DDATAREF','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDATAPG := DDATA_PGTO     .END.','000031','000028','.EXE.','5','DDATAPG := DDATA_PGTO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','LEN( ADIASQUINQ ) > 0   .END.','000032','000000','.CON.','5','','','5','LEN( ADIASQUINQ ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NANOQUI := ADIASQUINQ[1]     .CNT.','000033','000032','.EXE.','5','NANOQUI := ADIASQUINQ[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NMESQUI := ADIASQUINQ[2]     .CNT.','000034','000032','.EXE.','5','NMESQUI := ADIASQUINQ[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NDIAQUI := ADIASQUINQ[3]     .END.','000035','000032','.EXE.','5','NDIAQUI := ADIASQUINQ[3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','VERIFICA VALORES DE QUINQUENIOS JA PAGOS     .CNT.','000036','000000','.MSG.','5','VERIFICA VALORES DE QUINQUENIOS JA PAGOS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NQUINQPG := FBUSCAACM( CVBQUIVAL, , DDTINI, DDTFIM, "H")','000037','000000','.EXE.','5','NQUINQPG := FBUSCAACM( CVBQUIVAL, , DDTINI, DDTFIM, "H")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','SUBTRAI QUINQUENIOS JA PAGOS     .CNT.','000038','000000','.MSG.','5','SUBTRAI QUINQUENIOS JA PAGOS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','LPAG := ( NQUINQPG > 0 .AND. NQUINQPG >= NANOQUI )   .END.','000039','000000','.CON.','5','','','5','LPAG := ( NQUINQPG > 0 .AND. NQUINQPG >= NANOQUI )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NANOQUI := 0     .END.','000040','000039','.EXE.','5','NANOQUI := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','!LPAG .AND. NQUINQPG > 0   .END.','000041','000000','.CON.','5','','','5','!LPAG .AND. NQUINQPG > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NANOQUI -= NQUINQPG     .END.','000042','000041','.EXE.','5','NANOQUI -= NQUINQPG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','TYPE("APERGUNTE") <> "U" .AND. LEN(APERGUNTE) > 1 .AND. !L','000043','000000','.CON.','5','','','5','TYPE("APERGUNTE") <> "U" .AND. LEN(APERGUNTE) > 1 .AND. !LDEM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTSOLIC := APERGUNTE[1][3]     .CNT.','000044','000043','.EXE.','5','DDTSOLIC := APERGUNTE[1][3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NQTDMAX  := APERGUNTE[2][3]     .END.','000045','000043','.EXE.','5','NQTDMAX  := APERGUNTE[2][3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NANOQUI := IF( !LDEM .AND. NANOQUI >= NQTDMAX, NQTDMAX, NANO','000046','000000','.EXE.','5','NANOQUI := IF( !LDEM .AND. NANOQUI >= NQTDMAX, NQTDMAX, NANOQUI )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','CALCULA O VALOR DO QUINQUENIO     .CNT.','000047','000000','.MSG.','5','CALCULA O VALOR DO QUINQUENIO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NANOQUI > 0 .OR. ( LDEM .AND. NMESQUI >= 3 )   .END.','000048','000000','.CON.','5','','','5','NANOQUI > 0 .OR. ( LDEM .AND. NMESQUI >= 3 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALQUINQ := NBSSALQUI * NANOQUI     .CNT.','000049','000048','.EXE.','5','NVALQUINQ := NBSSALQUI * NANOQUI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','LDEM   .END.','000050','000048','.CON.','5','','','5','LDEM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALMESDEM := ( NBSSALQUI / 12 ) * NMESQUI     .CNT.','000051','000050','.EXE.','5','NVALMESDEM := ( NBSSALQUI / 12 ) * NMESQUI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALDIADEM := ( ( NBSSALQUI / 12 ) / 30 ) * NDIAQUI     .CNT','000052','000050','.EXE.','5','NVALDIADEM := ( ( NBSSALQUI / 12 ) / 30 ) * NDIAQUI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALQUINQ += ( NVALMESDEM + NVALDIADEM )     .END.','000053','000050','.EXE.','5','NVALQUINQ += ( NVALMESDEM + NVALDIADEM )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','CALCULA O VALOR DA MULTA E ATUALIZACAO     .CNT.','000054','000000','.MSG.','5','CALCULA O VALOR DA MULTA E ATUALIZACAO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','DDTSOLIC < DDATAPG   .END.','000055','000000','.CON.','5','','','5','DDTSOLIC < DDATAPG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NDIASREF := IF( LDEM, 15, 30 )     .CNT.','000056','000055','.EXE.','5','NDIASREF := IF( LDEM, 15, 30 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NDIASMULTA := ( DDATAPG - DDTSOLIC + 1 ) - NDIASREF     .CNT','000057','000055','.EXE.','5','NDIASMULTA := ( DDATAPG - DDTSOLIC + 1 ) - NDIASREF','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NDIASMULTA > 0   .END.','000058','000055','.CON.','5','','','5','NDIASMULTA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NUFVINI := FPOSTAB("S009", DDTSOLIC, "=", 4 )     .END.','000059','000058','.EXE.','5','NUFVINI := FPOSTAB("S009", DDTSOLIC, "=", 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NUFVFIM := FPOSTAB("S009", DDATAPG, "=", 4 )     .CNT.','000060','000058','.EXE.','5','NUFVFIM := FPOSTAB("S009", DDATAPG, "=", 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NUFVINI == 0 .OR. NUFVFIM == 0   .END.','000061','000058','.CON.','5','','','5','NUFVINI == 0 .OR. NUFVFIM == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','CMSGLOG := FMSGFORM({40}) + "  S009 - UNIDAD FOMENTO DE VIVI','000062','000061','.EXE.','5','CMSGLOG := FMSGFORM({40}) + "  S009 - UNIDAD FOMENTO DE VIVIENDA"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','S_MSGLOG()     .CNT.','000063','000061','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FINALCALC()     .END.','000064','000061','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NUFVINI > 0 .AND. NUFVFIM > 0   .END.','000065','000058','.CON.','5','','','5','NUFVINI > 0 .AND. NUFVFIM > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NFATOR := FTABELA("S009",NUFVFIM,5) / FTABELA("S009",NUFVINI','000066','000065','.EXE.','5','NFATOR := FTABELA("S009",NUFVFIM,5) / FTABELA("S009",NUFVINI,5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NFATOR > 0   .END.','000067','000065','.CON.','5','','','5','NFATOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALMULTA := NVALQUINQ     .CNT.','000068','000067','.EXE.','5','NVALMULTA := NVALQUINQ','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALMULTA *= NFATOR     .CNT.','000069','000067','.EXE.','5','NVALMULTA *= NFATOR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALMULTA *= 1.3     .CNT.','000070','000067','.EXE.','5','NVALMULTA *= 1.3','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALMULTA -= NVALQUINQ     .CNT.','000071','000067','.EXE.','5','NVALMULTA -= NVALQUINQ','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','GRAVA OS VALORES DE QUINQUENIOS     .CNT.','000072','000000','.MSG.','5','GRAVA OS VALORES DE QUINQUENIOS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALQUINQ > 0   .END.','000073','000000','.CON.','5','','','5','NVALQUINQ > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','VALOR DO SALARIO BASE DO QUINQUENIO     .CNT.','000074','000073','.MSG.','5','VALOR DO SALARIO BASE DO QUINQUENIO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_SEEK(@&COBJETO, CCPOPD, CVBQUISAL )   .END.','000075','000073','.CON.','5','','','5','FO_SEEK(@&COBJETO, CCPOPD, CVBQUISAL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_SETVAL(@&COBJETO, CCPOVALOR, ROUND(NBSSALQUI,MSDECIMAIS(1','000076','000075','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, ROUND(NBSSALQUI,MSDECIMAIS(1)) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','!FO_SEEK(@&COBJETO, CCPOPD, CVBQUISAL )   .END.','000077','000073','.CON.','5','','','5','!FO_SEEK(@&COBJETO, CCPOPD, CVBQUISAL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR},{ CVBQUISAL, ROUND( NBSS','000078','000077','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOVALOR},{ CVBQUISAL, ROUND( NBSSALQUI, MSDECIMAIS(1) )})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','VALOR DO QUINQUENIO     .CNT.','000079','000073','.MSG.','5','VALOR DO QUINQUENIO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_SEEK(@&COBJETO, CCPOPD, CVBQUIVAL )   .END.','000080','000073','.CON.','5','','','5','FO_SEEK(@&COBJETO, CCPOPD, CVBQUIVAL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_SETVAL(@&COBJETO, CCPOVALOR, ROUND(NVALQUINQ,MSDECIMAIS(1','000081','000080','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, ROUND(NVALQUINQ,MSDECIMAIS(1)) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_SETVAL(@&COBJETO, CCPOHORAS, ROUND(NANOQUI,MSDECIMAIS(1))','000082','000080','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOHORAS, ROUND(NANOQUI,MSDECIMAIS(1)) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','!FO_SEEK(@&COBJETO, CCPOPD, CVBQUIVAL )   .END.','000083','000073','.CON.','5','','','5','!FO_SEEK(@&COBJETO, CCPOPD, CVBQUIVAL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_ADD(@&COBJETO,{CCPOPD,CCPOHORAS,CCPOVALOR},{CVBQUIVAL, NA','000084','000083','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOHORAS,CCPOVALOR},{CVBQUIVAL, NANOQUI, ROUND( NVALQUINQ, MSDECIMAIS(1) )})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','VALOR DA MULTA E ACRESCIMOS     .CNT.','000085','000000','.MSG.','5','VALOR DA MULTA E ACRESCIMOS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','NVALMULTA > 0   .END.','000086','000000','.CON.','5','','','5','NVALMULTA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_SEEK(@&COBJETO, CCPOPD, CVBQUIMUL )   .END.','000087','000086','.CON.','5','','','5','FO_SEEK(@&COBJETO, CCPOPD, CVBQUIMUL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_SETVAL(@&COBJETO, CCPOVALOR, ROUND(NVALMULTA,MSDECIMAIS(1','000088','000087','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, ROUND(NVALMULTA,MSDECIMAIS(1)) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_SETVAL(@&COBJETO, CCPOHORAS, ROUND(NDIASMULTA,MSDECIMAIS(','000089','000087','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOHORAS, ROUND(NDIASMULTA,MSDECIMAIS(1)) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','!FO_SEEK(@&COBJETO, CCPOPD, CVBQUIMUL )   .END.','000090','000086','.CON.','5','','','5','!FO_SEEK(@&COBJETO, CCPOPD, CVBQUIMUL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIR','FO_ADD(@&COBJETO,{CCPOPD,CCPOHORAS,CCPOVALOR},{CVBQUIMUL, ND','000091','000090','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,CCPOHORAS,CCPOVALOR},{CVBQUIMUL, NDIASMULTA, ROUND( NVALMULTA, MSDECIMAIS(1) )})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0020    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0020( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALDIFFE','CALCULO DA DIFERENCA DE FERIAS','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALDIFFE','nSalMesf := SalMes     .CNT.','000001','000000','.EXE.','5','nSalMesf := SalMes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nFer := 0     .CNT.','000002','000000','.EXE.','5','nFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','cSeq := " "     .CNT.','000003','000000','.EXE.','5','cSeq := " "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','lFerDiaQb := If(type("lFerDiaQb") == "U",.F.,lFerDiaQb)','000004','000000','.EXE.','5','lFerDiaQb := If(type("lFerDiaQb") == "U",.F.,lFerDiaQb)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nFerDiaQb := If(type("nFerDiaQb") == "U",0  ,nFerDiaQb)','000005','000000','.EXE.','5','nFerDiaQb := If(type("nFerDiaQb") == "U",0  ,nFerDiaQb)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','aPdCopia := aClone(aPd)     .CNT.','000006','000000','.EXE.','5','aPdCopia := aClone(aPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','LiF := ( Empty(dDataDem)  )   .END.','000007','000000','.CON.','5','','','5','LiF := ( Empty(dDataDem)  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','dDataAux := dDataRef     .END.','000008','000007','.EXE.','5','dDataAux := dDataRef','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','!Lif   .END.','000009','000000','.CON.','5','','','5','!Lif','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','dDataAux := dDataDem     .END.','000010','000009','.EXE.','5','dDataAux := dDataDem','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','SRA->RA_CATFUNC = "H"   .END.','000011','000000','.CON.','5','','','5','SRA->RA_CATFUNC = "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nSalMesf := Round((SalMes / (Normal+Descanso)) * SRA->RA_HRS','000012','000011','.EXE.','5','nSalMesf := Round((SalMes / (Normal+Descanso)) * SRA->RA_HRSMES,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nCount := 1     .CNT.','000013','000000','.EXE.','5','nCount := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nCount <= Len(aDifFer)   .END.','000014','000013','.ENQ.','5','','','5','nCount <= Len(aDifFer)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','SRH->(DBGOTO(aDifFer[nCount,1] ))     .CNT.','000015','000014','.EXE.','5','SRH->(DBGOTO(aDifFer[nCount,1] ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','lMesOk := ( Mesano(SRH->RH_DATAINI) == Mesano(dDataAux) )','000016','000014','.CON.','5','','','5','lMesOk := ( Mesano(SRH->RH_DATAINI) == Mesano(dDataAux) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nDiasMes := aDifFer[nCount,2]     .CNT.','000017','000016','.EXE.','5','nDiasMes := aDifFer[nCount,2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nDiasMse := aDifFer[nCount,3]     .CNT.','000018','000016','.EXE.','5','nDiasMse := aDifFer[nCount,3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','cSeq := If (nCount = 1 , " " , Str(nCount-1,1) )     .END.','000019','000016','.EXE.','5','cSeq := If (nCount = 1 , " " , Str(nCount-1,1) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','SRH->RH_SALMES > 0   .END.','000020','000016','.CON.','5','','','5','SRH->RH_SALMES > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','Dif_fer(nSalMesf/SRH->RH_SALMES,2,Val_Salmin,SRH->RH_SALMIN,','000021','000020','.EXE.','5','Dif_fer(nSalMesf/SRH->RH_SALMES,2,Val_Salmin,SRH->RH_SALMIN,cSeq)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','SRH->RH_TIPCAL == "C" .Or. SRH->RH_DIALREM > 0   .END.','000022','000016','.CON.','5','','','5','SRH->RH_TIPCAL == "C" .Or. SRH->RH_DIALREM > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nDiasLRem := SRH->RH_DIALREM     .CNT.','000023','000022','.EXE.','5','nDiasLRem := SRH->RH_DIALREM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','lFerDiaQb   .END.','000024','000022','.CON.','5','','','5','lFerDiaQb','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nDiasLRem += nFerDiaQb     .END.','000025','000024','.EXE.','5','nDiasLRem += nFerDiaQb','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','!lMesOk .and. Mesano(SRH->RH_DATAFIM) == Mesano(dDataAux)','000026','000014','.CON.','5','','','5','!lMesOk .and. Mesano(SRH->RH_DATAFIM) == Mesano(dDataAux)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','LiF := ( SRH->RH_SALDIF > 0 )   .END.','000027','000026','.CON.','5','','','5','LiF := ( SRH->RH_SALDIF > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','Dif_fer(nSalMesf/SRH->RH_SALDIF,1,Val_Salmin,SRH->RH_SALMIND','000028','000027','.EXE.','5','Dif_fer(nSalMesf/SRH->RH_SALDIF,1,Val_Salmin,SRH->RH_SALMIND,cSeq)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','!LIF .and. SRH->RH_SALMES > 0   .END.','000029','000026','.CON.','5','','','5','!LIF .and. SRH->RH_SALMES > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','Dif_fer(nSalMesf/SRH->RH_SALMES,1,Val_Salmin,SRH->RH_SALMIN,','000030','000029','.EXE.','5','Dif_fer(nSalMesf/SRH->RH_SALMES,1,Val_Salmin,SRH->RH_SALMIN,cSeq)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','SRH->RH_TIPCAL == "C" .Or. SRH->RH_DIALRE1 > 0   .END.','000031','000026','.CON.','5','','','5','SRH->RH_TIPCAL == "C" .Or. SRH->RH_DIALRE1 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nDiasLRem := SRH->RH_DIALRE1     .END.','000032','000031','.EXE.','5','nDiasLRem := SRH->RH_DIALRE1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDIFFE','nCount ++     .END.','000033','000014','.EXE.','5','nCount ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0021    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0021( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALDSRHE','CALCULO DE DSR SOBRE HORAS EXT','','','039','2','1',} )

aAdd(aRc3Cols, { '','S_','CALDSRHE','nHrsTrab:=  If (Normal=0,1,Normal)     .CNT.','000001','000000','.EXE.','5','nHrsTrab:=  If (Normal=0,1,Normal)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHrsDesc:= If (Descanso=0,1,Descanso)     .CNT.','000002','000000','.EXE.','5','nHrsDesc:= If (Descanso=0,1,Descanso)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrn := nValDsrc := nDsrhex_B := nHorDsrn := nHorDsrc :=','000003','000000','.EXE.','5','nValDsrn := nValDsrc := nDsrhex_B := nHorDsrn := nHorDsrc := nHrTDsr := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C:= 0     .CNT.','000004','000000','.EXE.','5','nDsrhex_C:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lPos:= .F.     .CNT.','000005','000000','.EXE.','5','lPos:= .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0166"))   .END.','000006','000000','.CON.','5','','','5','!Empty(fGetCodFol("0166"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodSep:= Alltrim(fGetCodFol("0165")) + "/" + Alltrim(fGetCo','000007','000006','.EXE.','5','cCodSep:= Alltrim(fGetCodFol("0165")) + "/" + Alltrim(fGetCodFol("0347")) + "/"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0122"))   .END.','000008','000000','.CON.','5','','','5','!Empty(fGetCodFol("0122"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodSep+= Alltrim(fGetCodFol("0121"))     .END.','000009','000008','.EXE.','5','cCodSep+= Alltrim(fGetCodFol("0121"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0035"))   .END.','000010','000000','.CON.','5','','','5','!Empty(fGetCodFol("0035"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','FO_GOTOP(@&cObjeto)     .CNT.','000011','000010','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_B:= 0.00     .CNT.','000012','000010','.EXE.','5','nDsrhex_B:= 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!fo_Eof(@&cObjeto)   .END.','000013','000010','.ENQ.','5','','','5','!fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(! fo_Deleted(@&cObjeto))   .END.','000014','000013','.CON.','5','','','5','(! fo_Deleted(@&cObjeto))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodVerba:= fo_GetVal(@&cObjeto,cCpoPD)     .CNT.','000015','000014','.EXE.','5','cCodVerba:= fo_GetVal(@&cObjeto,cCpoPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(cTipoRot == "3") .AND. !(cCodverba $ cCodSep) .AND. PosSr','000016','000014','.CON.','5','','','5','(cTipoRot == "3") .AND. !(cCodverba $ cCodSep) .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_DSRHE")  == "S" .AND.  PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_REFFER") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_B+= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000017','000016','.EXE.','5','nDsrhex_B+= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(cTipoRot # "3") .AND. !(cCodVerba $ cCodSep) .AND. PosSrv','000018','000014','.CON.','5','','','5','(cTipoRot # "3") .AND. !(cCodVerba $ cCodSep) .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_DSRHE")=="S" .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_REFFER")=="N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_B+= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000019','000018','.EXE.','5','nDsrhex_B+= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_skip(@&cObjeto)     .END.','000020','000013','.EXE.','5','fo_skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0035") ) .AND. (','000021','000010','.EXE.','5','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0035") ) .AND. (! fo_Deleted(@&cObjeto))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','000022','000010','.CON.','5','','','5','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_B * fo_GetVal(@&cObjeto,cCpoValor)) / n','000023','000022','.EXE.','5','nValDsrvv:= (nDsrhex_B * fo_GetVal(@&cObjeto,cCpoValor)) / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000024','000022','.EXE.','5','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .F.)   .END.','000025','000010','.CON.','5','','','5','(lPos == .F.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_B * nHrsDesc) / nHrsTrab     .CNT.','000026','000025','.EXE.','5','nValDsrvv:= (nDsrhex_B * nHrsDesc) / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= If( Salhora > 0 , nValDsrvv / Salhora , 0 )','000027','000025','.EXE.','5','nHorDsrvv:= If( Salhora > 0 , nValDsrvv / Salhora , 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrn:= nValDsrvv     .CNT.','000028','000010','.EXE.','5','nValDsrn:= nValDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrn:= nHorDsrvv     .CNT.','000029','000010','.EXE.','5','nHorDsrn:= nHorDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHrtDsr  := ((nHrtDsr * nHrsDesc) / nHrsTrab )     .CNT.','000030','000010','.EXE.','5','nHrtDsr  := ((nHrtDsr * nHrsDesc) / nHrsTrab )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(nValDsrvv > 0)   .END.','000031','000010','.CON.','5','','','5','(nValDsrvv > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol(','000032','000031','.EXE.','5','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol("0035"), nHorDsrvv, nValDsrvv})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0166"))   .END.','000033','000000','.CON.','5','','','5','!Empty(fGetCodFol("0166"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_GoTop(@&cObjeto)     .CNT.','000034','000033','.EXE.','5','fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C:= 0.00     .CNT.','000035','000033','.EXE.','5','nDsrhex_C:= 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!fo_Eof(@&cObjeto)   .END.','000036','000033','.ENQ.','5','','','5','!fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(! fo_Deleted(@&cObjeto))   .END.','000037','000036','.CON.','5','','','5','(! fo_Deleted(@&cObjeto))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodVerba:= fo_GetVal(@&cObjeto,cCpoPD)     .CNT.','000038','000037','.EXE.','5','cCodVerba:= fo_GetVal(@&cObjeto,cCpoPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodVerba $ (fGetCodFol("0165")+"\"+fGetCodFol("0347")) .A','000039','000037','.CON.','5','','','5','cCodVerba $ (fGetCodFol("0165")+"\"+fGetCodFol("0347")) .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_DSRHE")  == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C+= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000040','000039','.EXE.','5','nDsrhex_C+= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_skip(@&cObjeto)     .END.','000041','000036','.EXE.','5','fo_skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0166") ) .AND. (','000042','000033','.EXE.','5','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0166") ) .AND. (! fo_Deleted(@&cObjeto))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','000043','000033','.CON.','5','','','5','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_C * fo_GetVal(@&cObjeto,cCpoValor) / nH','000044','000043','.EXE.','5','nValDsrvv:= (nDsrhex_C * fo_GetVal(@&cObjeto,cCpoValor) / nHrsTrab)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000045','000043','.EXE.','5','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .F.)   .END.','000046','000033','.CON.','5','','','5','(lPos == .F.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_C * nHrsDesc )  / nHrsTrab     .CNT.','000047','000046','.EXE.','5','nValDsrvv:= (nDsrhex_C * nHrsDesc )  / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= nHrsDesc     .END.','000048','000046','.EXE.','5','nHorDsrvv:= nHrsDesc','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrc:= nValDsrvv     .CNT.','000049','000033','.EXE.','5','nValDsrc:= nValDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrc := nHorDsrvv     .CNT.','000050','000033','.EXE.','5','nHorDsrc := nHorDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(nValDsrvv > 0)   .END.','000051','000033','.CON.','5','','','5','(nValDsrvv > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol(','000052','000051','.EXE.','5','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol("0166"), nHorDsrvv, nValDsrvv})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= nValDsrn + nValDsrc     .CNT.','000053','000000','.EXE.','5','nValDsrvv:= nValDsrn + nValDsrc','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= nHorDsrn + nHorDsrc     .CNT.','000054','000000','.EXE.','5','nHorDsrvv:= nHorDsrn + nHorDsrc','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!Empty(fGetCodFol("0122"))   .END.','000055','000000','.CON.','5','','','5','!Empty(fGetCodFol("0122"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_Gotop(@&cObjeto)     .CNT.','000056','000055','.EXE.','5','fo_Gotop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C := 0.00     .CNT.','000057','000055','.EXE.','5','nDsrhex_C := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','!fo_Eof(@&cObjeto)   .END.','000058','000055','.ENQ.','5','','','5','!fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(! fo_Deleted(@&cObjeto))   .END.','000059','000058','.CON.','5','','','5','(! fo_Deleted(@&cObjeto))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','cCodVerba := fo_GetVal(@&cObjeto,cCpoPD)   .CNT.','000060','000059','.EXE.','5','cCodVerba',':=','5','fo_GetVal(@&cObjeto,cCpoPD)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','( cCodVerba $ fGetCodFol("0121")) .AND. PosSrv(cCodVerba,S','000061','000059','.CON.','5','','','5','( cCodVerba $ fGetCodFol("0121")) .AND. PosSrv(cCodVerba,SRA->RA_FILIAL,"RV_DSRHE")  == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nDsrhex_C+= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000062','000061','.EXE.','5','nDsrhex_C+= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_skip(@&cObjeto)     .END.','000063','000058','.EXE.','5','fo_skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0122") ) .AND. (','000064','000055','.EXE.','5','lPos:= fo_seek(@&cObjeto,cCpoPD,fGetCodFol("0122") ) .AND. (! fo_Deleted(@&cObjeto))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','000065','000055','.CON.','5','','','5','(lPos == .T.) .AND. fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_C* fo_GetVal(@&cObjeto,cCpoValor)) / nH','000066','000065','.EXE.','5','nValDsrvv:= (nDsrhex_C* fo_GetVal(@&cObjeto,cCpoValor)) / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)     .END.','000067','000065','.EXE.','5','nHorDsrvv:= fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(lPos == .F.)   .END.','000068','000055','.CON.','5','','','5','(lPos == .F.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:= (nDsrhex_C * nHrsDesc )  / nHrsTrab     .CNT.','000069','000068','.EXE.','5','nValDsrvv:= (nDsrhex_C * nHrsDesc )  / nHrsTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:= nHrsDesc     .END.','000070','000068','.EXE.','5','nHorDsrvv:= nHrsDesc','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrC+= nValDsrvv     .CNT.','000071','000055','.EXE.','5','nValDsrC+= nValDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrC+= nHorDsrvv     .CNT.','000072','000055','.EXE.','5','nHorDsrC+= nHorDsrvv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','(nValDsrvv > 0)   .END.','000073','000055','.CON.','5','','','5','(nValDsrvv > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol(','000074','000073','.EXE.','5','fo_add(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor},{fGetCodFol("0122"), nHorDsrvv, nValDsrvv})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nValDsrvv:=   nValDsrN + nValDsrC     .CNT.','000075','000000','.EXE.','5','nValDsrvv:=   nValDsrN + nValDsrC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nHorDsrvv:=   nHorDsrN + nHorDsrC     .END.','000076','000000','.EXE.','5','nHorDsrvv:=   nHorDsrN + nHorDsrC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0022    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0022( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALPROVA','CALCULO DE PROVISAO FINIQUITO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIC := CTOD("")     .CNT.','000001','000000','.EXE.','5','DDATAINIC := CTOD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIP := CTOD("")     .CNT.','000002','000000','.EXE.','5','DDATAINIP := CTOD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAFIMP := CTOD("")     .CNT.','000003','000000','.EXE.','5','DDATAFIMP := CTOD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','NDIASVEN := 0     .CNT.','000004','000000','.EXE.','5','NDIASVEN := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','!EMPTY(SRA->RA_DTREC)   .END.','000005','000000','.CON.','5','','','5','!EMPTY(SRA->RA_DTREC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIC := SRA->RA_DTREC     .END.','000006','000005','.EXE.','5','DDATAINIC := SRA->RA_DTREC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','EMPTY(DDATAINIC)   .END.','000007','000000','.CON.','5','','','5','EMPTY(DDATAINIC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIC:=SRA->RA_ADMISSA     .END.','000008','000007','.EXE.','5','DDATAINIC:=SRA->RA_ADMISSA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIP:=CTOD( STRZERO( DAY( DDATAINIC ), 2 ) + "/" + STRZ','000009','000000','.EXE.','5','DDATAINIP:=CTOD( STRZERO( DAY( DDATAINIC ), 2 ) + "/" + STRZERO( MONTH( DDATAINIC ),2 ) + "/" + RCH->RCH_ANO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIP <= RCH->RCH_DTINI   .END.','000010','000000','.CON.','5','','','5','DDATAINIP <= RCH->RCH_DTINI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAFIMP := CTOD( STRZERO( DAY( DDATAINIC ),2 ) + "/" + STR','000011','000010','.EXE.','5','DDATAFIMP := CTOD( STRZERO( DAY( DDATAINIC ),2 ) + "/" + STRZERO( MONTH( DDATAINIC ) ,2 ) + "/" + STRZERO( VAL( RCH->RCH_ANO )  + 1, 4) ) -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIP  > RCH->RCH_DTINI   .END.','000012','000000','.CON.','5','','','5','DDATAINIP  > RCH->RCH_DTINI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIP:= CTOD( STRZERO( DAY( DDATAINIC) , 2 )  + "/" + ST','000013','000012','.EXE.','5','DDATAINIP:= CTOD( STRZERO( DAY( DDATAINIC) , 2 )  + "/" + STRZERO( MONTH( DDATAINIC ) ,  2 ) + "/" + STRZERO( VAL( RCH->RCH_ANO  ) -1,  4 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAFIMP := CTOD( STRZERO( DAY( DDATAINIC ), 2 ) + "/" + ST','000014','000012','.EXE.','5','DDATAFIMP := CTOD( STRZERO( DAY( DDATAINIC ), 2 ) + "/" + STRZERO( MONTH( DDATAINIC ),2  ) + "/" + RCH->RCH_ANO) -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','DDATAINIC > RCH->RCH_DTFIM   .END.','000015','000000','.CON.','5','','','5','DDATAINIC > RCH->RCH_DTFIM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','FINALFUN()     .END.','000016','000015','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','NANOSTRAB := ((DDATADEM  - DDATAINIC) + 1 ) / 365     .CNT.','000017','000000','.EXE.','5','NANOSTRAB := ((DDATADEM  - DDATAINIC) + 1 ) / 365','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','NX := FPOSTAB("S010", SRA->RA_PROCES, "=", 4 , NANOSTRAB , "','000018','000000','.EXE.','5','NX := FPOSTAB("S010", SRA->RA_PROCES, "=", 4 , NANOSTRAB , "<=" , 6 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','NDIASVAC := IF(NX > 0,  FTABELA("S010" , NX , 7 ) ,  0 )','000019','000000','.EXE.','5','NDIASVAC := IF(NX > 0,  FTABELA("S010" , NX , 7 ) ,  0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','NDIASPROP := NDIASVAC / 365  * (DDATADEM - DDATAINIP)     .C','000020','000000','.EXE.','5','NDIASPROP := NDIASVAC / 365  * (DDATADEM - DDATAINIP)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','NDIASPROP > NDIASVAC   .END.','000021','000000','.CON.','5','','','5','NDIASPROP > NDIASVAC','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','NDIASVEN :=  NDIASVAC     .CNT.','000022','000021','.EXE.','5','NDIASVEN :=  NDIASVAC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','NDIASPROP := 0     .END.','000023','000021','.EXE.','5','NDIASPROP := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPROVA','CKEY := XFILIAL("SRF") + SRA->RA_MAT + FGETCODFOL("0072") +','000024','000000','.EXE.','5','CKEY := XFILIAL("SRF") + SRA->RA_MAT + FGETCODFOL("0072") + DTOS(DDATAINIP)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0023    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0023( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALRCIVA','CALCULO DE RC-IVA','','','030','2','1',} )

aAdd(aRc3Cols, { '','S_','CALRCIVA','CCOD01:=FGETCODFOL("0066")     .CNT.','000001','000000','.EXE.','5','CCOD01:=FGETCODFOL("0066")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NBASEIVA := 0     .CNT.','000002','000000','.EXE.','5','NBASEIVA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NTOTIVA := 0     .CNT.','000003','000000','.EXE.','5','NTOTIVA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NQTDSALMIN := 0     .CNT.','000004','000000','.EXE.','5','NQTDSALMIN := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NPERRCIVA := 0     .CNT.','000005','000000','.EXE.','5','NPERRCIVA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NMININOIMP := 0     .CNT.','000006','000000','.EXE.','5','NMININOIMP := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nForm87 := 0     .CNT.','000007','000000','.EXE.','5','nForm87 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','!FO_SEEK(@&COBJETO,{ CCPOPD, CCPONPAGTO } , { CCOD01, CNUM','000008','000000','.CON.','5','','','5','!FO_SEEK(@&COBJETO,{ CCPOPD, CCPONPAGTO } , { CCOD01, CNUMPAG} )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nTOTIVA := FO_SomaIncSrv(@&cObjeto, cCpoValor, {"RV_IR", "RV','000009','000008','.EXE.','5','nTOTIVA := FO_SomaIncSrv(@&cObjeto, cCpoValor, {"RV_IR", "RV_TIPOCOD"}, { "S", "1" } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NBASEIVA := 0     .CNT.','000010','000008','.EXE.','5','NBASEIVA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nBASEIVA := FO_SomaIncSrv(@&cObjeto, cCpoValor, {"RV_IR" },','000011','000008','.EXE.','5','nBASEIVA := FO_SomaIncSrv(@&cObjeto, cCpoValor, {"RV_IR" }, {"S" } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NBASEIVA > 0   .END.','000012','000008','.CON.','5','','','5','NBASEIVA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NQTDSALMIN := IF( FTABELA("S001",1,5,DDATAREF) <> NIL, FTABE','000013','000012','.EXE.','5','NQTDSALMIN := IF( FTABELA("S001",1,5,DDATAREF) <> NIL, FTABELA("S001",1,5,DDATAREF), FTABELA("S001",1,5 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NPERRCIVA := IF( FTABELA("S001",1,4,DDATAREF) <> NIL, FTABEL','000014','000012','.EXE.','5','NPERRCIVA := IF( FTABELA("S001",1,4,DDATAREF) <> NIL, FTABELA("S001",1,4,DDATAREF), FTABELA("S001",1,4 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NPERSALMIN := IF( FTABELA("S001",1,6,DDATAREF) <> NIL, FTABE','000015','000012','.EXE.','5','NPERSALMIN := IF( FTABELA("S001",1,6,DDATAREF) <> NIL, FTABELA("S001",1,6,DDATAREF), FTABELA("S001",1,6 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','Empty(NQTDSALMIN)   .END.','000016','000012','.CON.','5','','','5','Empty(NQTDSALMIN)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NQTDSALMIN := 0     .END.','000017','000016','.EXE.','5','NQTDSALMIN := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','Empty(VAL_SALMIN)   .END.','000018','000012','.CON.','5','','','5','Empty(VAL_SALMIN)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NQTDSALMIN := 0     .END.','000019','000018','.EXE.','5','VAL_SALMIN := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nMiniNoImp := (nQtdSalMin * VAL_Salmin)     .CNT.','000020','000012','.EXE.','5','nMiniNoImp := (nQtdSalMin * VAL_Salmin)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nBaseIva < nMiniNoImp   .END.','000021','000012','.CON.','5','','','5','nBaseIva < nMiniNoImp','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nMiniNoImp := nBaseIva     .END.','000022','000021','.EXE.','5','nMiniNoImp := nBaseIva','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NVALIVA := ( (NBASEIVA -  nMiniNoImp ) * NPERRCIVA / 100 )','000023','000012','.EXE.','5','NVALIVA := ( (NBASEIVA -  nMiniNoImp ) * NPERRCIVA / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NVALIVA :=   Round( NVALIVA - (  nMiniNoImp * NPERRCIVA /100','000024','000012','.EXE.','5','NVALIVA :=   Round( NVALIVA - (  nMiniNoImp * NPERRCIVA /100), MsDecimais(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','Fo_Seek(@&cObjeto, {cCpoPd, cCPONPAGTO } , { FGETCODFOL("0','000025','000012','.CON.','5','','','5','Fo_Seek(@&cObjeto, {cCpoPd, cCPONPAGTO } , { FGETCODFOL("0773") , CNUMPAG } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NMONTFORM :=FO_GETVAL(@&COBJETO, CCPOVALOR )     .END.','000026','000025','.EXE.','5','NMONTFORM :=FO_GETVAL(@&COBJETO, CCPOVALOR )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','Fo_Seek(@&cObjeto, {cCpoPd, cCPONPAGTO } , { FGETCODFOL("0','000027','000012','.CON.','5','','','5','Fo_Seek(@&cObjeto, {cCpoPd, cCPONPAGTO } , { POSSRV(FGETCODFOL("0733"),SRA->RA_FILIAL,"RV_CODMSEG") , CNUMPAG } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nFormAcum  := FO_GETVAL(@&COBJETO, CCPOVALOR )     .END.','000028','000027','.EXE.','5','nFormAcum  := FO_GETVAL(@&COBJETO, CCPOVALOR )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nFormAcum > 0   .END.','000029','000012','.CON.','5','','','5','nFormAcum > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nFatUFV > 0   .END.','000030','000029','.CON.','5','','','5','nFatUFV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nFormAcum := nFormAcum * nFatUFV     .END.','000031','000030','.EXE.','5','nFormAcum := nFormAcum * nFatUFV','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NVALIVA > 0   .END.','000032','000012','.CON.','5','','','5','NVALIVA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nForm87 :=  (nMontForm * 13 / 100 )     .CNT.','000033','000032','.EXE.','5','nForm87 :=  (nMontForm * 13 / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nForm87 > 0   .Or. nFormAcum > 0   .END.','000034','000032','.CON.','5','','','5','nForm87 > 0   .Or. nFormAcum > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','(nForm87+nFormAcum) > nValIva   .END.','000035','000034','.CON.','5','','','5','(nForm87+nFormAcum) > nValIva','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nFormMSeg := (nForm87+nFormAcum) - nValIva     .CNT.','000036','000035','.EXE.','5','nFormMSeg := (nForm87+nFormAcum) - nValIva','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NVALIVA := 0     .END.','000037','000035','.EXE.','5','NVALIVA := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','(nForm87+nFormAcum) <=  nValIva   .END.','000038','000034','.CON.','5','','','5','(nForm87+nFormAcum) <=  nValIva','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nValIva :=  nValIva - (nForm87+nFormAcum)     .END.','000039','000038','.EXE.','5','nValIva :=  nValIva - (nForm87+nFormAcum)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NVALIVA < 0   .END.','000040','000012','.CON.','5','','','5','NVALIVA < 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','nForm87 := (nMontForm * 13 / 100 )   .CNT.','000041','000040','.EXE.','5','nForm87',':=','5','(nMontForm * 13 / 100 )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','(nForm87 + NFORMACUM ) > 0   .END.','000042','000040','.CON.','5','','','5','(nForm87 + NFORMACUM ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NFORMMSEG := (nForm87 + nFormAcum)     .CNT.','000043','000042','.EXE.','5','NFORMMSEG := (nForm87 + nFormAcum)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NVALIVA := 0     .END.','000044','000042','.EXE.','5','NVALIVA := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','SRA->RA_TIPOPGT = "S"   .END.','000045','000012','.CON.','5','','','5','SRA->RA_TIPOPGT = "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','FO_GOTOP(@&COBJETO)     .CNT.','000046','000045','.EXE.','5','FO_GOTOP(@&COBJETO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','!FO_EOF(@&COBJETO)   .END.','000047','000045','.ENQ.','5','','','5','!FO_EOF(@&COBJETO)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','CVERBA02 := FO_GETVAL(@&COBJETO, CCPOPD)     .CNT.','000048','000047','.EXE.','5','CVERBA02 := FO_GETVAL(@&COBJETO, CCPOPD)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','CSEMSRC := FO_GETVAL(@&COBJETO, CCPONPAGTO)     .CNT.','000049','000047','.EXE.','5','CSEMSRC := FO_GETVAL(@&COBJETO, CCPONPAGTO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','( CSEMSRC < CNUMPAG ) .AND. ( !FO_DELETED(@&COBJETO )  )','000050','000047','.CON.','5','','','5','( CSEMSRC < CNUMPAG ) .AND. ( !FO_DELETED(@&COBJETO )  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','CVERBA02 == FGETCODFOL("0015")   .END.','000051','000050','.CON.','5','','','5','CVERBA02 == FGETCODFOL("0015")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NBIVAANT += FO_GETVAL(@&COBJETO, CCPOVALOR)     .END.','000052','000051','.EXE.','5','NBIVAANT += FO_GETVAL(@&COBJETO, CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','CVERBA02 == FGETCODFOL("0747")   .END.','000053','000050','.CON.','5','','','5','CVERBA02 == FGETCODFOL("0747")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NTIVAANT+=FO_GETVAL(@&COBJETO, CCPOVALOR)     .END.','000054','000053','.EXE.','5','NTIVAANT+=FO_GETVAL(@&COBJETO, CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','CVERBA02 == FGETCODFOL("0066")   .END.','000055','000050','.CON.','5','','','5','CVERBA02 == FGETCODFOL("0066")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','NVALIVAANT+=FO_GETVAL(@&COBJETO, CCPOVALOR)     .END.','000056','000055','.EXE.','5','NVALIVAANT+=FO_GETVAL(@&COBJETO, CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALRCIVA','FO_SKIP(@&COBJETO)     .END.','000057','000047','.EXE.','5','FO_SKIP(@&COBJETO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0024    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0024( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGAPAR','CARREGA PARAMETROS 13º SALARIO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGAPAR','cSitFolh:=SRA->RA_SITFOLH     .CNT.','000001','000000','.EXE.','5','cSitFolh:=SRA->RA_SITFOLH','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAPAR','dDataRef:= if(cTipoRot = "5", aPergunte[6,3],  aPergunte[1,3','000002','000000','.EXE.','5','dDataRef:= if(cTipoRot = "5", aPergunte[6,3],  aPergunte[1,3])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAPAR','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPG13", 1)     .END.','000003','000000','.EXE.','5','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPG13", 1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0025    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0025( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCF','Carrega Periodos','','001046','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCF','lRotBlank := .F.     .CNT.','000001','000000','.EXE.','5','lRotBlank := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','nIndRCF := 3     .CNT.','000002','000000','.EXE.','5','nIndRCF := 3','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cRetOrder := "RCF_FILIAL+RCF_PROCES+RCF_PER+RCF_SEMANA+RCF_R','000003','000000','.EXE.','5','cRetOrder := "RCF_FILIAL+RCF_PROCES+RCF_PER+RCF_SEMANA+RCF_ROTEIR+RCF_TNOTRA"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cKey :=  xFilial( "RCH" ) + cProcesso + cPeriodo + cNumPag +','000004','000000','.EXE.','5','cKey :=  xFilial( "RCH" ) + cProcesso + cPeriodo + cNumPag + c__roteiro','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','fPosPeriodo( xFilial( "RCH" ), cProcesso, cPeriodo, cNumPa','000005','000000','.CON.','5','','','5','fPosPeriodo( xFilial( "RCH" ), cProcesso, cPeriodo, cNumPag, c__roteiro, , @lRotBlank, 1 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','cKey := xFilial("RCF") + cProcesso + cPeriodo + cNumPag + If','000006','000005','.EXE.','5','cKey := xFilial("RCF") + cProcesso + cPeriodo + cNumPag + If( lRotBlank, Space(3),  c__Roteiro )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','nIndRCF :=  RetOrder( "RCF" , cRetOrder , .T. )     .CNT.','000007','000000','.EXE.','5','nIndRCF :=  RetOrder( "RCF" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCF','fo_New( @oRCF , "RCF" , nIndRCF , cKey )     .END.','000008','000000','.EXE.','5','fo_New( @oRCF , "RCF" , nIndRCF , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0026    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0026( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCH','Carrega Periodos de Calculo','','001047','032','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCH','cPeriodo := GetPeriodCalc()   .CNT.','000001','000000','.EXE.','5','cPeriodo',':=','5','GetPeriodCalc()','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cNumPag := GetNumPgCalc()   .CNT.','000002','000000','.EXE.','5','cNumPag',':=','5','GetNumPgCalc()','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cProcesso := SRA->RA_PROCES   .CNT.','000003','000000','.EXE.','5','cProcesso',':=','5','SRA->RA_PROCES','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", 1, xFilial("RCH") + cProcesso + cPeriod','000004','000000','.EXE.','5','fo_New(@oRCH, "RCH", 1, xFilial("RCH") + cProcesso + cPeriodo + cNumPag + c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_Eof(@oRCH)   .END.','000005','000000','.CON.','5','','','5','fo_Eof(@oRCH)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", 1, xFilial("RCH") + cProcesso + cPeriod','000006','000005','.EXE.','5','fo_New(@oRCH, "RCH", 1, xFilial("RCH") + cProcesso + cPeriodo + cNumPag + "   ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_Eof(@oRCH) .And. cTipoRot == "9"   .END.','000007','000000','.CON.','5','','','5','fo_Eof(@oRCH) .And. cTipoRot == "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fo_New(@oRCH, "RCH", 1, xFilial("RCH") + cProcesso + cPeriod','000008','000007','.EXE.','5','fo_New(@oRCH, "RCH", 1, xFilial("RCH") + cProcesso + cPeriodo +  "  " + "   ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataDe := fo_GetVal(@oRCH, "RCH_DTINI", 1)   .CNT.','000009','000000','.EXE.','5','dDataDe',':=','5','fo_GetVal(@oRCH, "RCH_DTINI", 1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataAte := fo_GetVal(@oRCH, "RCH_DTFIM", 1)   .CNT.','000010','000000','.EXE.','5','dDataAte',':=','5','fo_GetVal(@oRCH, "RCH_DTFIM", 1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cAnoMes  := fo_GetVal(@oRCH, "RCH_ANO", 1) + fo_GetVal(@oRCH','000011','000000','.EXE.','5','cAnoMes  := fo_GetVal(@oRCH, "RCH_ANO", 1) + fo_GetVal(@oRCH, "RCH_MES",1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPAGO", 1)     .CNT.','000012','000000','.EXE.','5','dData_Pgto := fo_GetVal(@oRCH, "RCH_DTPAGO", 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','dDataref := CTOD("01/" + fo_getVal(@oRCH, "RCH_MES", 1) + "/','000013','000000','.EXE.','5','dDataref',':=','5','CTOD("01/" + fo_getVal(@oRCH, "RCH_MES", 1) + "/" + fo_getVal(@oRCH, "RCH_ANO", 1))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fPosReg("SRY", 1, xFIlial("SRY") + c__Roteiro)     .CNT.','000014','000000','.EXE.','5','fPosReg("SRY", 1, xFIlial("SRY") + c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cTipoRot := SRY->RY_TIPO   .END.','000015','000000','.EXE.','5','cTipoRot',':=','5','SRY->RY_TIPO','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0027    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0027( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCM','Carrega Tipo de Ausencia','','001048','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCM','fo_New(@oRCM, "RCM", 1, xFIlial("RCM"))     .END.','000001','000000','.EXE.','5','fo_New(@oRCM, "RCM", 1, xFIlial("RCM"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0028    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0028( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARG1','CARGA RG1','','','032','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARG1','cRetOrder := "RG1_FILIAL+RG1_MAT+RG1_ORDEM+RG1_PD+DTOS(RG1_D','000001','000000','.EXE.','5','cRetOrder := "RG1_FILIAL+RG1_MAT+RG1_ORDEM+RG1_PD+DTOS(RG1_DINIPG)"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','nRG1Order := RetOrder( "RG1" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nRG1Order := RetOrder( "RG1" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','LSQLWHERE := .T.     .CNT.','000004','000000','.EXE.','5','LSQLWHERE := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','LTOPFILTER := .T.     .CNT.','000005','000000','.EXE.','5','LTOPFILTER := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cTipoRot = "3"   .END.','000006','000000','.CON.','5','','','5','cTipoRot = "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cAnoMes := MesAno(GetMemVar("RH_DATAINI") )     .END.','000007','000006','.EXE.','5','cAnoMes := MesAno(GetMemVar("RH_DATAINI") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','( LTOP := IFDEFTOP() )   .END.','000008','000000','.CON.','5','','','5','( LTOP := IFDEFTOP() )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere := "RG1_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " +','000009','000008','.EXE.','5','cQueryWhere := "RG1_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "RG1_MAT='+"'"+'" + SRA->RA_MAT + "'+"'"+' AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "  RG1_DINIPG<= '+"'"+'" + CANOMES +  StrZero(f_Ult','000010','000008','.EXE.','5','cQueryWhere += "  RG1_DINIPG<= '+"'"+'" + CANOMES +  StrZero(f_Ultdia(dDataRef),2) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " AND "     .CNT.','000011','000008','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "( RG1_DFIMPG =  '+"'"+'        '+"'"+' "+ " or " + "RG1_','000012','000008','.EXE.','5','cQueryWhere','+=','5','"( RG1_DFIMPG =  '+"'"+'        '+"'"+' "+ " or " + "RG1_DFIMPG >= '+"'"+'" + CANOMES + '+"'"+'01'+"'"+' + "'+"'"+'  ) "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " AND "     .CNT.','000013','000008','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += "D_E_L_E_T_<> '+"'"+'*'+"'"+' "     .END.','000014','000008','.EXE.','5','cQueryWhere += "D_E_L_E_T_<> '+"'"+'*'+"'"+' "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','!LTOP   .END.','000015','000000','.CON.','5','','','5','!LTOP','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere := "  DTOS(RG1_DINIPG) <= '+"'"+'" + CANOMES +  StrZer','000016','000015','.EXE.','5','cQueryWhere := "  DTOS(RG1_DINIPG) <= '+"'"+'" + CANOMES +  StrZero(f_Ultdia(dDataRef),2) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " .AND. "     .CNT.','000017','000015','.EXE.','5','cQueryWhere += " .AND. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','cQueryWhere += " (DTOS(RG1_DFIMPG) == '+"'"+'        '+"'"+'  .OR. DTOS(','000018','000015','.EXE.','5','cQueryWhere += " (DTOS(RG1_DFIMPG) == '+"'"+'        '+"'"+'  .OR. DTOS(RG1_DFIMPG)  >='+"'"+'" + CANOMES +'+"'"+'01'+"'"+'+"'+"'"+' ) "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARG1','FO_NEW(@oRG1 , "RG1",nRG1Order , cKey , cQueryWhere, @lSqlWh','000019','000000','.EXE.','5','FO_NEW(@oRG1 , "RG1",nRG1Order , cKey , cQueryWhere, @lSqlWhere , @lTopFilter)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0029    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0029( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARGB','CARGA TABELA RGB','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARGB','GETRGB()','000001','000000','.EXE.','5','GetRgb()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0030    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0030( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASR8','Carrega Ausencias','','001049','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASR8','GetSr8()     .END.','000001','000000','.EXE.','5','GetSr8()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0031    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0031( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRB','CARGA SRB','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRB','cRetOrder := "RB_FILIAL+RB_MAT"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RB_FILIAL+RB_MAT"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','nSrbOrder := RetOrder( "SRB" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSrbOrder := RetOrder( "SRB" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRB','FO_NEW(@oSRB , "SRB",nSrbOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oSRB , "SRB",nSrbOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0032    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0032( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRC','CARREGA LANCAMENTOS','','001050','010','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRC','GetSrc()     .END.','000001','000000','.EXE.','5','GetSrc()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0033    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0033( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRF','CARREGA SRF','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRF','cRetOrder := "RF_FILIAL+RF_MAT+DTOS(RF_DATABAS)"     .CNT.','000001','000000','.EXE.','5','cRetOrder := "RF_FILIAL+RF_MAT+DTOS(RF_DATABAS)"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','nSRFOrder := RetOrder( "SRF" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSRFOrder := RetOrder( "SRF" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRF','FO_NEW(@oSRF , "SRF",nSRFOrder , cKey )     .END.','000004','000000','.EXE.','5','FO_NEW(@oSRF , "SRF",nSRFOrder , cKey )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0034    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0034( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRK','CARREGA VALORES FUTUROS','','001051','009','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRK','GetSrk()     .END.','000001','000000','.EXE.','5','GetSrk()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0035    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0035( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRO','CARGA SRO','','','024','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRO','cRetOrder := "RO_FILIAL+RO_MAT+DTOS(RO_DATA)+RO_CODTAR"','000001','000000','.EXE.','5','cRetOrder := "RO_FILIAL+RO_MAT+DTOS(RO_DATA)+RO_CODTAR"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','nSroOrder := RetOrder( "SRO" , cRetOrder , .T. )     .CNT.','000002','000000','.EXE.','5','nSroOrder := RetOrder( "SRO" , cRetOrder , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cKey := SRA->( RA_FILIAL + RA_MAT )     .CNT.','000003','000000','.EXE.','5','cKey := SRA->( RA_FILIAL + RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','LSQLWHERE := .T.     .CNT.','000004','000000','.EXE.','5','LSQLWHERE := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','LTOPFILTER := .T.     .CNT.','000005','000000','.EXE.','5','LTOPFILTER := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','LTOP := IFDEFTOP()   .END.','000006','000000','.CON.','5','','','5','LTOP := IFDEFTOP()','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere := "RO_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "','000007','000006','.EXE.','5','cQueryWhere := "RO_FILIAL='+"'"+'" + SRA->RA_FILIAL + "'+"'"+' AND " + "RO_MAT='+"'"+'" + SRA->RA_MAT + "'+"'"+' AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " ( (RO_TIPO = '+"'"+'1'+"'"+' "+ "AND" + " RO_DATA<='+"'"+'" +','000008','000006','.EXE.','5','cQueryWhere += " ( (RO_TIPO = '+"'"+'1'+"'"+' "+ "AND" + " RO_DATA<='+"'"+'" + cAnoMes +'+"'"+'31'+"'"+'+ "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " AND "     .CNT.','000009','000006','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( RO_DATAATE = '+"'"+'        '+"'"+'  "+" OR "+ "RO_DAT','000010','000006','.EXE.','5','cQueryWhere += "( RO_DATAATE = '+"'"+'        '+"'"+'  "+" OR "+ "RO_DATAATE >='+"'"+'" + cAnoMes + '+"'"+'01'+"'"+' + "'+"'"+' ) ) "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " OR "     .CNT.','000011','000006','.EXE.','5','cQueryWhere += " OR "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( RO_TIPO = '+"'"+'2'+"'"+'   " + " AND "+  "RO_DATA   <','000012','000006','.EXE.','5','cQueryWhere += "( RO_TIPO = '+"'"+'2'+"'"+'   " + " AND "+  "RO_DATA   <=  '+"'"+'"              +DTOS(dDataAte) + "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " AND "     .CNT.','000013','000006','.EXE.','5','cQueryWhere += " AND "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( RO_DATAATE = '+"'"+'        '+"'"+'   "+ "OR '+"'"+'" + Dtos','000014','000006','.EXE.','5','cQueryWhere += "( RO_DATAATE = '+"'"+'        '+"'"+'   "+ "OR '+"'"+'" + Dtos(dDataAte)+"'+"'"+' >= '+"'"+'" + Dtos(dDataDe) + "'+"'"+') ) )"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','!LTOP   .END.','000015','000000','.CON.','5','','','5','!LTOP','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere := " ( (RO_TIPO ==  '+"'"+'1'+"'"+' .AND.  DTOS(RO_DATA) <=','000016','000015','.EXE.','5','cQueryWhere := " ( (RO_TIPO ==  '+"'"+'1'+"'"+' .AND.  DTOS(RO_DATA) <= '+"'"+'" +CANOMES +'+"'"+'31'+"'"+'+ "'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " .AND. "     .CNT.','000017','000015','.EXE.','5','cQueryWhere += " .AND. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( DTOS(RO_DATAATE)  == '+"'"+'        '+"'"+'  .OR. DTOS','000018','000015','.EXE.','5','cQueryWhere += "( DTOS(RO_DATAATE)  == '+"'"+'        '+"'"+'  .OR. DTOS(RO_DATAATE) >= '+"'"+'" + cAnoMes + '+"'"+'01'+"'"+'+"'+"'"+' ) )"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " .OR. "     .CNT.','000019','000015','.EXE.','5','cQueryWhere += " .OR. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "(RO_TIPO  == '+"'"+'2'+"'"+' .AND. DTOS(RO_DATA) <='+"'"+'" +','000020','000015','.EXE.','5','cQueryWhere += "(RO_TIPO  == '+"'"+'2'+"'"+' .AND. DTOS(RO_DATA) <='+"'"+'" + Dtos(dDataAte) +"'+"'"+'"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += " .AND. "     .CNT.','000021','000015','.EXE.','5','cQueryWhere += " .AND. "','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','cQueryWhere += "( DTOS(RO_DATAATE) == '+"'"+'        '+"'"+'   .OR. '+"'"+'" +','000022','000015','.EXE.','5','cQueryWhere += "( DTOS(RO_DATAATE) == '+"'"+'        '+"'"+'   .OR. '+"'"+'" +Dtos(dDataAte)+"'+"'"+' >='+"'"+'" + Dtos(dDataDe) + "'+"'"+' ) ) ) "','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGASRO','FO_NEW(@oSRO , "SRO",nSroOrder , cKey , cQueryWhere, @LSQLWH','000023','000000','.EXE.','5','FO_NEW(@oSRO , "SRO",nSroOrder , cKey , cQueryWhere, @LSQLWHERE , @LTOPFILTER)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0036    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0036( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASRV','Carrega Verbas','','000253','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASRV','fo_New(@oSRV, "SRV", 1, xFilial("SRV"))     .END.','000001','000000','.EXE.','5','fo_New(@oSRV, "SRV", 1, xFilial("SRV"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0037    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0037( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGATAB','CARREGA INFORMACOES DA TABELA','','000320','007','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGATAB','cTipoRot $ "3*4" .END.','000001','000000','.CON.','5','','','5','cTipoRot','$','5','"3*4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cObjeto := "oSRR"   .CNT.','000002','000001','.EXE.','5','cObjeto',':=','5','"oSRR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoCC := "RR_CC"   .CNT.','000003','000001','.EXE.','5','cCpoCC',':=','5','"RR_CC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoData := "RR_DATA"   .CNT.','000004','000001','.EXE.','5','cCpoData',':=','5','"RR_DATA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHoras := "RR_HORAS"   .CNT.','000005','000001','.EXE.','5','cCpoHoras',':=','5','"RR_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHorInf := "RR_HORINFO"   .CNT.','000006','000001','.EXE.','5','cCpoHorInf',':=','5','"RR_HORINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNPagto := "RR_SEMANA"   .CNT.','000007','000001','.EXE.','5','cCpoNPagto',':=','5','"RR_SEMANA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNumID := "RR_NUMID"   .CNT.','000008','000001','.EXE.','5','cCpoNumID',':=','5','"RR_NUMID"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPD := "RR_PD"   .CNT.','000009','000001','.EXE.','5','cCpoPD',':=','5','"RR_PD"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoSeq := "RR_SEQ"   .CNT.','000010','000001','.EXE.','5','cCpoSeq',':=','5','"RR_SEQ"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo1 := "RR_TIPO1"   .CNT.','000011','000001','.EXE.','5','cCpoTipo1',':=','5','"RR_TIPO1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo2 := "RR_TIPO2"   .CNT.','000012','000001','.EXE.','5','cCpoTipo2',':=','5','"RR_TIPO2"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValor := "RR_VALOR"   .CNT.','000013','000001','.EXE.','5','cCpoValor',':=','5','"RR_VALOR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValInf := "RR_VALINFO"   .CNT.','000014','000001','.EXE.','5','cCpoValInf',':=','5','"RR_VALINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoVNaoApl := "RR_VNAOAPL"   .CNT.','000015','000001','.EXE.','5','cCpoVNaoApl',':=','5','"RR_VNAOAPL"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMat := "RR_MAT"   .CNT.','000016','000001','.EXE.','5','cCpoMat',':=','5','"RR_MAT"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoRot := "RR_ROTEIR"   .CNT.','000017','000001','.EXE.','5','cCpoRot',':=','5','"RR_ROTEIR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPer := "RR_PERIODO"   .CNT.','000018','000001','.EXE.','5','cCpoPer',':=','5','"RR_PERIODO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMesMed := "RR_MESMED"   .END.','000019','000001','.EXE.','5','cCpoMesMed',':=','5','"RR_MESMED"','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','!(cTipoRot $ "3*4")   .END.','000020','000000','.CON.','5','','','5','!(cTipoRot $ "3*4")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cObjeto := "oSRC"   .CNT.','000021','000020','.EXE.','5','cObjeto',':=','5','"oSRC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoCC := "RC_CC"   .CNT.','000022','000020','.EXE.','5','cCpoCC',':=','5','"RC_CC"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoData := "RC_DATA"   .CNT.','000023','000020','.EXE.','5','cCpoData',':=','5','"RC_DATA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHoras := "RC_HORAS"   .CNT.','000024','000020','.EXE.','5','cCpoHoras',':=','5','"RC_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoHorInf := "RC_HORINFO"   .CNT.','000025','000020','.EXE.','5','cCpoHorInf',':=','5','"RC_HORINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNPagto := "RC_SEMANA"   .CNT.','000026','000020','.EXE.','5','cCpoNPagto',':=','5','"RC_SEMANA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoNumID := "RC_NUMID"   .CNT.','000027','000020','.EXE.','5','cCpoNumID',':=','5','"RC_NUMID"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPD := "RC_PD"   .CNT.','000028','000020','.EXE.','5','cCpoPD',':=','5','"RC_PD"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoQtdSem := "RC_QTDSEM"   .CNT.','000029','000020','.EXE.','5','cCpoQtdSem',':=','5','"RC_QTDSEM"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoSeq := "RC_SEQ"   .CNT.','000030','000020','.EXE.','5','cCpoSeq',':=','5','"RC_SEQ"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo1 := "RC_TIPO1"   .CNT.','000031','000020','.EXE.','5','cCpoTipo1',':=','5','"RC_TIPO1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoTipo2 := "RC_TIPO2"   .CNT.','000032','000020','.EXE.','5','cCpoTipo2',':=','5','"RC_TIPO2"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValInf := "RC_VALINFO"   .CNT.','000033','000020','.EXE.','5','cCpoValInf',':=','5','"RC_VALINFO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoValor := "RC_VALOR"   .CNT.','000034','000020','.EXE.','5','cCpoValor',':=','5','"RC_VALOR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoVNaoApl := "RC_VNAOAPL"   .CNT.','000035','000020','.EXE.','5','cCpoVNaoApl',':=','5','"RC_VNAOAPL"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoMat := "RC_MAT"   .CNT.','000036','000020','.EXE.','5','cCpoMat',':=','5','"RC_MAT"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoParcel := "RC_PARCELA"   .CNT.','000037','000020','.EXE.','5','cCpoParcel',':=','5','"RC_PARCELA"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoRot := "RC_ROTEIR"   .CNT.','000038','000020','.EXE.','5','cCpoRot',':=','5','"RC_ROTEIR"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoPer := "RC_PERIODO"   .CNT.','000039','000020','.EXE.','5','cCpoPer',':=','5','"RC_PERIODO"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGATAB','cCpoDtRef := "RC_DTREF"   .END.','000040','000020','.EXE.','5','cCpoDtRef',':=','5','"RC_DTREF"','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0038    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0038( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CHKADMIS','VERIFICA FECHA DE ADMISSION','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CHKADMIS','P_MESPARTI == .T.   .END.','000001','000000','.CON.','5','','','5','P_MESPARTI == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKADMIS','SRA->RA_ADMISSA > DDATAATE   .END.','000002','000001','.CON.','5','','','5','SRA->RA_ADMISSA > DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKADMIS','FINALFUN()     .END.','000003','000002','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CHKADMIS','P_MESPARTI == .F.   .END.','000004','000000','.CON.','5','','','5','P_MESPARTI == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKADMIS','MESANO(SRA->RA_ADMISSA) > CANOMES .END.','000005','000004','.CON.','5','','','5','MESANO(SRA->RA_ADMISSA)','>','5','CANOMES','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CHKADMIS','FINALFUN()     .END.','000006','000005','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0039    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0039( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DELETADI','DELETA VERBAS NO ADIANTAM.','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','DELETADI','FO_DEL(@&COBJETO,{CCPOTIPO2},{"A"})     .END.','000001','000000','.EXE.','5','FO_DEL(@&COBJETO,{CCPOTIPO2},{"A"})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0040    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0040( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DIASTRAB','DIAS/HOR TRAB E DIAS/HOR DSR','','000830','089','2','1',} )

aAdd(aRc3Cols, { '','S_','DIASTRAB','!fo_Seek(@oRCF, "RCF_TNOTRA", SRA->RA_TNOTRAB)   .END.','000001','000000','.CON.','5','','','5','!fo_Seek(@oRCF, "RCF_TNOTRA", SRA->RA_TNOTRAB)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fo_Seek(@oRCF, "RCF_TNOTRA",  "@@@")     .END.','000002','000001','.EXE.','5','fo_Seek(@oRCF, "RCF_TNOTRA",  "@@@")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','NORMAL :=  fo_GetVal(@oRCF , "RCF_HRSTRA")     .CNT.','000003','000000','.EXE.','5','NORMAL :=  fo_GetVal(@oRCF , "RCF_HRSTRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DESCANSO := fo_GetVal(@oRCF , "RCF_HRSDSR")     .CNT.','000004','000000','.EXE.','5','DESCANSO := fo_GetVal(@oRCF , "RCF_HRSDSR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DTRABPER := fo_GetVal(@oRCF , "RCF_DIATRA")     .CNT.','000005','000000','.EXE.','5','DTRABPER := fo_GetVal(@oRCF , "RCF_DIATRA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*P*A*E*I*1*2*3*4*5*6"','000006','000000','.EXE.','5','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*P*A*E*I*1*2*3*4*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lMesAdm := IF( P_MESPARTI, (SRA->RA_ADMISSA>=DDATADE .AND. S','000007','000000','.EXE.','5','lMesAdm := IF( P_MESPARTI, (SRA->RA_ADMISSA>=DDATADE .AND. SRA->RA_ADMISSA<= DDATAATE ), (MesAno(SRA->RA_ADMISSA) >= MesAno(dDataDe) ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lPropHor := If( SRA->RA_CATFUNC=="H", .F., .T. )     .END.','000008','000000','.EXE.','5','lPropHor := If( SRA->RA_CATFUNC=="H", .F., .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_SITFOLH == " "  .and. !LMESADM   .END.','000009','000000','.CON.','5','','','5','SRA->RA_SITFOLH == " "  .and. !LMESADM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasDSR := fo_GetVal(@oRCF, "RCF_DIADSR")     .CNT.','000010','000009','.EXE.','5','DiasDSR := fo_GetVal(@oRCF, "RCF_DIADSR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasDSR := DESCANSO     .CNT.','000011','000009','.EXE.','5','nHorasDSR := DESCANSO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasTrab := NORMAL     .CNT.','000012','000009','.EXE.','5','nHorasTrab := NORMAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "M" .END.','000013','000009','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .T.   .END.','000014','000013','.CON.','5','','','5','lCatMensal == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM")     .END.','000015','000014','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal .And. lMesAdm .And. Day(SRA->RA_ADMISSA) # Day(','000016','000013','.CON.','5','','','5','lCatMensal .And. lMesAdm .And. Day(SRA->RA_ADMISSA) # Day(dDataDe)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas     .','000017','000016','.EXE.','5','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .F.   .END.','000018','000013','.CON.','5','','','5','lCatMensal == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA") + fo_GetVal(@oRCF','000019','000018','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA") + fo_GetVal(@oRCF, "RCF_DIADSR") + fo_GetVal(@oRCF, "RCF_DNTRAB")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "S" .END.','000020','000009','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA")     .END.','000021','000020','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DIATRA")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_CATFUNC=="H" .And. lMesAdm .And. Day(SRA->RA_ADMIS','000022','000009','.CON.','5','','','5','SRA->RA_CATFUNC=="H" .And. lMesAdm .And. Day(SRA->RA_ADMISSA) # Day(dDataDe)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DIASTRAB := 0     .CNT.','000023','000022','.EXE.','5','DIASTRAB := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DIASDSR := 0     .CNT.','000024','000022','.EXE.','5','DIASDSR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','NHORASTRAB := 0     .CNT.','000025','000022','.EXE.','5','NHORASTRAB := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','NHORASDSR := 0     .CNT.','000026','000022','.EXE.','5','NHORASDSR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHoras','000027','000022','.EXE.','5','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHorasDSR , @nHorasTrab , , , , cNumPag, lPropHor, , , c__Roteiro)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_SITFOLH <> " " .or. LMESADM   .END.','000028','000000','.CON.','5','','','5','SRA->RA_SITFOLH <> " " .or. LMESADM','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHoras','000029','000028','.EXE.','5','fTrabCalend( cPeriodo, @DiasTrab, , @DiasDSR , , , , @nHorasDSR , @nHorasTrab , , , , cNumPag, lPropHor, , , c__Roteiro)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','lCatMensal == .T.   .AND.','000030','000028','.CON.','5','','','5','lCatMensal == .T.','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_TIPOPGT == "M" .END.','000031','000028','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM") - nDiasAfas     .','000032','000031','.EXE.','5','DiasTrab := fo_GetVal(@oRCF, "RCF_DCALCM") - nDiasAfas','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','LMESADM .and. Day(SRA->RA_ADMISSA) # Day(dDataDe)   .END.','000033','000031','.CON.','5','','','5','LMESADM .and. Day(SRA->RA_ADMISSA) # Day(dDataDe)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas     .','000034','000033','.EXE.','5','DiasTrab := dDataAte - SRA->RA_ADMISSA + 1 - nDiasAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes := fo_getVal(@ORCH, "RCH_MES",  1)   .CNT.','000035','000031','.EXE.','5','cMes',':=','5','fo_getVal(@ORCH, "RCH_MES",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cAno := fo_getVal(@ORCH, "RCH_ANO",  1)   .CNT.','000036','000031','.EXE.','5','cAno',':=','5','fo_getVal(@ORCH, "RCH_ANO",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR.','000037','000031','.CON.','5','','','5','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR. (cMes $ "04*06*09*11" .AND. nDiasAfas == 30)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000038','000037','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas ==','000039','000031','.CON.','5','','','5','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas == 28) .OR.  (VAL(cAno) % 4 == 0 .AND. nDiasAfas == 29) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000040','000039','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','SRA->RA_CATFUNC == "H" .END.','000041','000028','.CON.','5','','','5','SRA->RA_CATFUNC','==','5','"H"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes := fo_getVal(@ORCH, "RCH_MES",  1)   .CNT.','000042','000041','.EXE.','5','cMes',':=','5','fo_getVal(@ORCH, "RCH_MES",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cAno := fo_getVal(@ORCH, "RCH_ANO",  1)   .CNT.','000043','000041','.EXE.','5','cAno',':=','5','fo_getVal(@ORCH, "RCH_ANO",  1)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','Horista considera o periodo integral caso não seja mes da ad','000044','000041','.MSG.','5','Horista considera o periodo integral caso nao seja mes da admissao','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','!lMesAdm .Or. ( lMesAdm .And. Day(SRA->RA_ADMISSA) == Day(','000045','000041','.CON.','5','','','5','!lMesAdm .Or. ( lMesAdm .And. Day(SRA->RA_ADMISSA) == Day(dDataDe) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasDSR := DESCANSO     .END.','000046','000045','.EXE.','5','nHorasDSR := DESCANSO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','nHorasTrab := NORMAL     .END.','000047','000045','.EXE.','5','nHorasTrab := NORMAL','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR.','000048','000041','.CON.','5','','','5','(cMes $ "01*03*05*07*08*10*12" .AND. nDiasAfas == 31).OR. (cMes $ "04*06*09*11" .AND. nDiasAfas == 30)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000049','000048','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas ==','000050','000041','.CON.','5','','','5','cMes == "02" .AND. ( (VAL(cAno) % 4 > 0 .AND. nDiasAfas == 28) .OR.  (VAL(cAno) % 4 == 0 .AND. nDiasAfas == 29) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DIASTRAB','DiasTrab := 0     .END.','000051','000050','.EXE.','5','DiasTrab := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0041    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0041( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','DTRABRES','DIAS TRABALHADOS RESCISAO','','000290','009','2','1',} )

aAdd(aRc3Cols, { '','S_','DTRABRES','LCATMENSAL := ( SRA->RA_CATFUNC  == "M" )     .CNT.','000001','000000','.EXE.','5','LCATMENSAL := ( SRA->RA_CATFUNC  == "M" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DADM := SRA->RA_ADMISSA     .CNT.','000002','000000','.EXE.','5','DADM := SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','! P_MESPARTI .AND. (SRA->RA_CATFUNC$ "M*C" .And. (Day(dDat','000003','000000','.CON.','5','','','5','! P_MESPARTI .AND. (SRA->RA_CATFUNC$ "M*C" .And. (Day(dDatadem) > 30 .Or. (Month(dDataDem)=2 .And. Day(dDataDem)=28)))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DiasTrab := 30     .END.','000004','000003','.EXE.','5','DiasTrab := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','! LCATMENSAL   .END.','000005','000000','.CON.','5','','','5','! LCATMENSAL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB := FO_GETVAL(@ORCF, "RCF_DIATRA") + FO_GETVAL(@ORCF','000006','000005','.EXE.','5','DIASTRAB := FO_GETVAL(@ORCF, "RCF_DIATRA") + FO_GETVAL(@ORCF, "RCF_DIADSR") + FO_GETVAL(@ORCF, "RCF_DNTRAB")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','LMES31 := ( Day( DDATAATE ) > 30 )     .END.','000007','000005','.EXE.','5','LMES31 := ( Day( DDATAATE ) > 30 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','LCATMENSAL   .END.','000008','000000','.CON.','5','','','5','LCATMENSAL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB := FO_GETVAL(@ORCF, "RCF_DCALCM")     .CNT.','000009','000008','.EXE.','5','DIASTRAB := FO_GETVAL(@ORCF, "RCF_DCALCM")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','LMES31 := ( Day( DDATAATE ) > 30 )     .END.','000010','000008','.EXE.','5','LMES31 := ( Day( DDATAATE ) > 30 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DADM > DDATADE .AND. DADM < DDATAATE   .END.','000011','000000','.CON.','5','','','5','DADM > DDATADE .AND. DADM < DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB -= (DADM - DDATADE)     .END.','000012','000011','.EXE.','5','DIASTRAB -= (DADM - DDATADE)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DDATADEM < DDATAATE   .END.','000013','000000','.CON.','5','','','5','DDATADEM < DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB -= (DDATAATE - DDATADEM)     .CNT.','000014','000013','.EXE.','5','DIASTRAB -= (DDATAATE - DDATADEM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DIASTRAB += IF( LMES31, 1, 0 )     .END.','000015','000013','.EXE.','5','DIASTRAB += IF( LMES31, 1, 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','DTRABRES','DiasTrab := Max(Diastrab-nDiasAfas,0)     .END.','000016','000000','.EXE.','5','DiasTrab := Max(Diastrab-nDiasAfas,0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0042    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0042( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FALTASAV','FALTAS SIN AVISO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','FALTASAV','nDiasFaltas := 0     .CNT.','000001','000000','.EXE.','5','nDiasFaltas := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FALTASAV','FO_SEEK(@&COBJETO, {CCPOPD} , {FGETCODFOL("0748")} )   .EN','000002','000000','.CON.','5','','','5','FO_SEEK(@&COBJETO, {CCPOPD} , {FGETCODFOL("0748")} )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FALTASAV','nDiasFaltas :=   FO_GETVAL(@&cObjeto , cCpoHoras )     .CNT.','000003','000002','.EXE.','5','nDiasFaltas :=   FO_GETVAL(@&cObjeto , cCpoHoras )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FALTASAV','FO_ADD(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoHoras} , {FGETCODF','000004','000002','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoHoras} , {FGETCODFOL("0749") ,  "D", (nDiasFaltas *3)  } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0043    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0043( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FATUFV','FATOR ACTUALIZACION UFV','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','FATUFV','lContinua := .T.     .CNT.','000001','000000','.EXE.','5','lContinua := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NFATUFV := 0     .CNT.','000002','000000','.EXE.','5','NFATUFV := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','nAux := 0     .CNT.','000003','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','nMes := Month(dDataRef)     .CNT.','000004','000000','.EXE.','5','nMes := Month(dDataRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','nAno := Year(dDataRef)     .CNT.','000005','000000','.EXE.','5','nAno := Year(dDataRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','dDataAtu := Ctod(StrZero(F_ULTDIA(dDataRef),2)+"/"+Strzero(M','000006','000000','.EXE.','5','dDataAtu := Ctod(StrZero(F_ULTDIA(dDataRef),2)+"/"+Strzero(Month(dDataRef),2)+"/"+right(str(Year(dDataRef)),4),"ddmmyyyy")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua   .END.','000007','000000','.ENQ.','5','','','5','lContinua','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NAUX := FPOSTAB("S009", DDATAATU, "=", 4 )     .CNT.','000008','000007','.EXE.','5','NAUX := FPOSTAB("S009", DDATAATU, "=", 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NAUX > 0   .END.','000009','000007','.CON.','5','','','5','NAUX > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NUFVATU := FTABELA("S009", NAUX, 5)     .CNT.','000010','000009','.EXE.','5','NUFVATU := FTABELA("S009", NAUX, 5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua := .F.     .END.','000011','000009','.EXE.','5','lContinua := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua   .END.','000012','000007','.CON.','5','','','5','lContinua','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FATUFV','dDataAtu := dDataAtu - 1     .CNT.','000013','000012','.EXE.','5','dDataAtu := dDataAtu - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua := MesAno( dDataAtu ) == MesAno( dDataRef )     .E','000014','000012','.EXE.','5','lContinua := MesAno( dDataAtu ) == MesAno( dDataRef )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua := .T.     .CNT.','000015','000000','.EXE.','5','lContinua := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','dDataAnt := MonthSub( dDataRef, 1 )     .CNT.','000016','000000','.EXE.','5','dDataAnt := MonthSub( dDataRef, 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','dDataAnt := Ctod(StrZero(F_ULTDIA(dDataAnt) ,2 ) +"/"+Strzer','000017','000000','.EXE.','5','dDataAnt := Ctod(StrZero(F_ULTDIA(dDataAnt) ,2 ) +"/"+Strzero( Month( dDataAnt ), 2 ) +"/"+ right( Str( Year( dDataAnt ) ), 4 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua   .END.','000018','000000','.ENQ.','5','','','5','lContinua','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NAUX2 := FPOSTAB("S009", dDataAnt, "=", 4 )     .CNT.','000019','000018','.EXE.','5','NAUX2 := FPOSTAB("S009", dDataAnt, "=", 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NAUX2 > 0   .END.','000020','000018','.CON.','5','','','5','NAUX2 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NUFVANT := FTABELA("S009", NAUX2, 5)     .CNT.','000021','000020','.EXE.','5','NUFVANT := FTABELA("S009", NAUX2, 5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua := .F.     .END.','000022','000020','.EXE.','5','lContinua := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua   .END.','000023','000018','.CON.','5','','','5','lContinua','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FATUFV','dDataAnt  := dDataAnt  - 1     .CNT.','000024','000023','.EXE.','5','dDataAnt  := dDataAnt  - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','lContinua := MesAno( dDataAnt  ) == MesAno( MonthSub( dDataR','000025','000023','.EXE.','5','lContinua := MesAno( dDataAnt  ) == MesAno( MonthSub( dDataRef, 1 )  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NUFVATU > 0 .AND.  NUFVANT > 0   .END.','000026','000000','.CON.','5','','','5','NUFVATU > 0 .AND.  NUFVANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FATUFV','NFATUFV := NUFVATU / NUFVANT     .END.','000027','000026','.EXE.','5','NFATUFV := NUFVATU / NUFVANT','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0044    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0044( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FBASEINI','CALCULA BASE INICIAL.','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','FBASEINI','Base_Ini := 0   .CNT.','000001','000000','.EXE.','5','Base_Ini',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','LENT1 := .F.   .CNT.','000002','000000','.EXE.','5','LENT1',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','PosSrv(fGetCodfol("0006"),SRA->Ra_filial,"RV_IR") == "S"','000003','000000','.CON.','5','','','5','PosSrv(fGetCodfol("0006"),SRA->Ra_filial,"RV_IR") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','Base_Ini := Val_Adto     .CNT.','000004','000003','.EXE.','5','Base_Ini := Val_Adto','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','fo_Gotop(@&cObjeto)     .CNT.','000005','000003','.EXE.','5','fo_Gotop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','!Fo_Eof(@&cObjeto)   .END.','000006','000003','.ENQ.','5','','','5','!Fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','Fo_GetVal(@&cObjeto,cCpoPD) == FGetCodFol("0106") .AND.','000007','000006','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoPD)','==','5','FGetCodFol("0106")','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','!Fo_Deleted(@&cObjeto)   .AND.','000008','000006','.CON.','5','','','5','!Fo_Deleted(@&cObjeto)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','( MesAno(dData_Adto) == MesAno(Fo_GetVal(@&cObjeto,cCpoDat','000009','000006','.CON.','5','','','5','( MesAno(dData_Adto) == MesAno(Fo_GetVal(@&cObjeto,cCpoData)) .OR. Empty(Fo_GetVal(@&cObjeto,cCpoData)) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','Base_Ini += Round(Fo_GetVal(@&cObjeto,cCpoValor),2)   .CNT.','000010','000009','.EXE.','5','Base_Ini','+=','5','Round(Fo_GetVal(@&cObjeto,cCpoValor),2)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','LENT1 := .T.   .END.','000011','000009','.EXE.','5','LENT1',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','Fo_Skip(@&cObjeto)     .END.','000012','000006','.EXE.','5','Fo_Skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','!LENT1   .END.','000013','000000','.CON.','5','','','5','!LENT1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','Base_Ini := Val_Adto     .END.','000014','000013','.EXE.','5','Base_Ini := Val_Adto','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FBASEINI','LENT := .F.   .END.','000015','000000','.EXE.','5','LENT',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0045    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0045( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FCALARRE','CALCULA ARREDONDAMENTO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','FCALARRE','nResto := Mod(nVlrTot , nArred)   .CNT.','000001','000000','.EXE.','5','nResto',':=','5','Mod(nVlrTot , nArred)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','Round(nResto,2) > 0 .END.','000002','000000','.CON.','5','','','5','Round(nResto,2)','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrArre := (nArred - nResto )   .CNT.','000003','000002','.EXE.','5','nVlrArre',':=','5','(nArred - nResto )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrTot := (nVlrTot + nVlrArre )   .END.','000004','000002','.EXE.','5','nVlrTot',':=','5','(nVlrTot + nVlrArre )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','Round(nResto,2) <= 0 .END.','000005','000000','.CON.','5','','','5','Round(nResto,2)','<=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FCALARRE','nVlrArre := 0   .END.','000006','000005','.EXE.','5','nVlrArre',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0046    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0046( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FDIASADI','RETORNA OS DIAS TRABALHADOS','','','020','2','1',} )

aAdd(aRc3Cols, { '','S_','FDIASADI','dDtaAfas:= dDtaRet:= Ctod('+"'"+'//'+"'"+')     .CNT.','000001','000000','.EXE.','5','dDtaAfas:= dDtaRet:= Ctod('+"'"+'//'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','cTipAfas := ""   .CNT.','000002','000000','.EXE.','5','cTipAfas',':=','5','""','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','fChkAfas(SRA->RA_FILIAL,SRA->RA_MAT,dDataRef,@dDtaAfas,@dD','000003','000000','.CON.','5','','','5','fChkAfas(SRA->RA_FILIAL,SRA->RA_MAT,dDataRef,@dDtaAfas,@dDtaRet,@cTipAfas)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','cTipAfas == "Q" .END.','000004','000003','.CON.','5','','','5','cTipAfas=="Q"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','dDtAfMat:= dDtaAfas     .END.','000005','000004','.EXE.','5','dDtAfMat:= dDtaAfas','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','S_PROCSR8()     .CNT.','000006','000000','.EXE.','5','S_PROCSR8()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','S_DIASTRAB()     .CNT.','000007','000000','.EXE.','4','S_DIASTRAB()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','DiasTb := DIASTRAB   .CNT.','000008','000000','.EXE.','5','DiasTb:= DiasTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','DiasTb:= Max( ( DiasTb   + nDiasMat ) , 0 )     .CNT.','000009','000000','.EXE.','5','DiasTb:= Max( ( DiasTb   + nDiasMat ) , 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','nDiasAfas:= Max( ( nDiasAfas - nDiasMat ) , 0 )     .CNT.','000010','000000','.EXE.','5','nDiasAfas:= Max( ( nDiasAfas - nDiasMat ) , 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','( SRA->RA_SITFOLH = "A" ) .And. ( cPgSalMat = "S" )   .END','000011','000000','.CON.','5','','','5','( SRA->RA_SITFOLH = "A" ) .And. ( cPgSalMat = "S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','DiasTb := 30     .END.','000012','000011','.EXE.','5','DiasTb := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','( SRA->RA_SITFOLH == "D" ) .Or. ( CADTOPRO == "N" .And. SR','000013','000000','.CON.','5','','','5','( SRA->RA_SITFOLH == "D" ) .Or. ( CADTOPRO == "N" .And. SRA->RA_ADMISSA > DDATAREF .And. DiasTb < 15 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','FINALFUN()     .END.','000014','000013','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FDIASADI','cTip:= Iif((cCompMes=="S") .AND. (SRA->CATFUNC=="H"), "B", "','000015','000000','.EXE.','5','cTip:= Iif((cCompMes=="S") .AND. (SRA->CATFUNC=="H"), "B", "A")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0047    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0047( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FGERAADI','GERA ADIANTAMENTO.','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','FGERAADI','VAL_ADTO <> 0   .END.','000001','000000','.CON.','5','','','5','VAL_ADTO <> 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FGERAADI','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras,cCpoNPagto,cCpo','000002','000001','.EXE.','5','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras,cCpoNPagto,cCpoTipo1,cCpoTipo2,cCpoData},{fGetCodFol("0006"),Val_adto,0,cNumPag,"V","A",RCH->RCH_DTPGAD})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0048    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0048( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FGERAARR','GERA ARREDONDAMENTO.','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','FGERAARR','nVlrArre <> 0   .END.','000001','000000','.CON.','5','','','5','nVlrArre <> 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FGERAARR','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras,cCpoNPagto,cCpo','000002','000001','.EXE.','5','Fo_Add(@&cObjeto,{cCpoPD,cCpoValor,cCpoHoras,cCpoNPagto,cCpoTipo1,cCpoTipo2,cCpoData},{fGetCodFol("0713"),nVlrArre,0,cNumPag,"V","A",RCH->RCH_DTPGAD})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0049    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0049( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FGERADDS','GERACAO DSR TAREFAS.','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','FGERADDS','!(SRA->RA_CATFUNC $ "I*J")   .END.','000001','000000','.CON.','5','','','5','!(SRA->RA_CATFUNC $ "I*J")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FGERADDS','S_BASEDSRT()     .END.','000002','000001','.EXE.','5','S_BASEDSRT()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0050    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0050( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FGERALIQ','GERA LIQUIDO ADIANTAMENTO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','FGERALIQ','NVLRTOT > 0   .END.','000001','000000','.CON.','5','','','5','NVLRTOT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FGERALIQ','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS, CCPONPAGTO,','000002','000001','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS, CCPONPAGTO, CCPOTIPO1, CCPOTIPO2, CCPODATA},{FGETCODFOL("0546"),NVLRTOT,0,CNUMPAG,"V","A",RCH->RCH_DTPGAD})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0051    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0051( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FLIQUIDO','GERA VALOR LIQUIDO','','','039','2','1',} )

aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot $ "1|9" .END.','000001','000000','.CON.','5','','','5','cTipoRot','$','5','"1|9"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0047")   .CNT.','000002','000001','.EXE.','5','cCodliq',':=','5','fGetCodFol("0047")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := P_ARREDFO   .CNT.','000003','000001','.EXE.','5','nArred',':=','5','P_ARREDFO','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := fGetCodFol("0043")   .CNT.','000004','000001','.EXE.','5','cCodArred',':=','5','fGetCodFol("0043")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .T.   .CNT.','000005','000001','.EXE.','5','lIns',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := If(cPaisLoc <> "URU", fGetCodFol("0045"), Space(3','000006','000001','.EXE.','5','cCodIns',':=','5','If(cPaisLoc <> "URU", fGetCodFol("0045"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := If(cPaisLoc <> "PAR", .T. , .F. )   .CNT.','000007','000001','.EXE.','5','lObrigat',':=','5','If(cPaisLoc <> "PAR", .T. , .F. )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000008','000001','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "6" .END.','000009','000000','.CON.','5','','','5','cTipoRot','==','5','"6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','LDOBLE := FO_SEEK(@&COBJETO, CCPOPD, FGETCODFOL("1728"))','000010','000009','.EXE.','5','lDoble',':=','5','FO_SEEK(@&COBJETO, "RC_PD", fGetCodFol("1728"))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CCODLIQ := IF(LDOBLE,FGETCODFOL("1729"),FGETCODFOL("0021"))','000011','000009','.EXE.','5','cCodLiq',':=','5','If(lDoble,fGetCodFol("1729"),fGetCodFol("0021"))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := If(cPaisLoc  $ "ARG|CHI|DOM" , 0, P_ARRED13)   .CN','000012','000009','.EXE.','5','nArred',':=','5','If(cPaisLoc  $ "ARG|CHI|DOM" , 0, P_ARRED13)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := If(cPaisLoc $ "BRA|ARG", fGetCodFol("0026") , S','000013','000009','.EXE.','5','cCodArred',':=','5','If(cPaisLoc $ "BRA|ARG", fGetCodFol("0026") , Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := If(cPaisLoc == "BRA", .T. , .F. )   .CNT.','000014','000009','.EXE.','5','lIns',':=','5','If(cPaisLoc == "BRA", .T. , .F. )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CCODINS := FGETCODFOL("0030") .CNT.','000015','000009','.EXE.','5','cCodIns',':=','5','FGETCODFOL("0030")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .F.   .CNT.','000016','000009','.EXE.','5','lObrigat',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000017','000009','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "5" .END.','000018','000000','.CON.','5','','','5','cTipoRot','==','5','"5"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodLiq := If(cPaisLoc $ "ARG|URU|DOM" , fGetCodFol("0021"),','000019','000018','.EXE.','5','cCodLiq',':=','5','If(cPaisLoc $ "ARG|URU|DOM" , fGetCodFol("0021"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := If(cPaisLoc $ "ARG|DOM", 0, If(lArredonda,P_ARRED1','000020','000018','.EXE.','5','nArred',':=','5','If(cPaisLoc $ "ARG|DOM", 0, If(lArredonda,P_ARRED13,0) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := If(cPaisLoc == "URU", fGetCodFol("0026"), Space','000021','000018','.EXE.','5','cCodArred',':=','5','If(cPaisLoc == "URU", fGetCodFol("0026"), Space(3) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .F.   .CNT.','000022','000018','.EXE.','5','lIns',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lCodIns := Space(4)   .CNT.','000023','000018','.EXE.','5','lCodIns',':=','5','Space(4)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .CNT.','000024','000018','.EXE.','5','lDemiss',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .F.   .END.','000025','000018','.EXE.','5','lObrigat',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cTipoRot == "4" .END.','000026','000000','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodliq := fGetCodFol("0126")   .CNT.','000027','000026','.EXE.','5','cCodliq',':=','5','fGetCodFol("0126")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := 0   .CNT.','000028','000026','.EXE.','5','nArred',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodArred := Space(3)   .CNT.','000029','000026','.EXE.','5','cCodArred',':=','5','Space(3)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns := .T.   .CNT.','000030','000026','.EXE.','5','lIns',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cCodIns := fGetCodFol("0045")   .CNT.','000031','000026','.EXE.','5','cCodIns',':=','5','fGetCodFol("0045")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat := .T.   .CNT.','000032','000026','.EXE.','5','lObrigat',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lDemiss := .F.   .END.','000033','000026','.EXE.','5','lDemiss',':=','5','.F.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat := 0   .CNT.','000034','000000','.EXE.','5','nObrigat',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cProxNum := "  "   .CNT.','000035','000000','.EXE.','5','cProxNum',':=','5','"  "','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000036','000000','.EXE.','5','cSitFolh',':=','5','If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := 0   .CNT.','000037','000000','.EXE.','5','nLiquido',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000038','000000','.EXE.','5','nLiquido',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "1" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := Round( nLiquido, MsDecimais(2) )   .CNT.','000039','000000','.EXE.','5','nLiquido',':=','5','Round( nLiquido, MsDecimais(2) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido += FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD"','000040','000000','.EXE.','5','nLiquido','+=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD" , "2" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat == .T. .END.','000041','000000','.CON.','5','','','5','lObrigat','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_GOTOP(@&cObjeto)     .CNT.','000042','000041','.EXE.','5','FO_GOTOP(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_EOF(@&cObjeto)   .END.','000043','000041','.ENQ.','5','','','5','!FO_EOF(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_GETVAL(@&cObjeto, cCpoNPagto) == cNumPag .AND.','000044','000043','.CON.','5','','','5','FO_GETVAL(@&cObjeto, cCpoNPagto)','==','5','cNumPag','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_DELETED(@&cObjeto)   .AND.','000045','000043','.CON.','5','','','5','!FO_DELETED(@&cObjeto)','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','POSSRV(FO_GETVAL(@&cObjeto, cCpoPd) , SRA->RA_FILIAL, "RV_','000046','000043','.CON.','5','','','5','POSSRV(FO_GETVAL(@&cObjeto, cCpoPd) , SRA->RA_FILIAL, "RV_OBRIGAT" )','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat += FO_GETVAL(@&cObjeto, cCpoValor )   .END.','000047','000046','.EXE.','5','nObrigat','+=','5','FO_GETVAL(@&cObjeto, cCpoValor )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','FO_SKIP(@&cObjeto)     .END.','000048','000043','.EXE.','5','FO_SKIP(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Type("P_CALCINF") != "U" .and. P_CALCINF == "S"   .END.','000049','000000','.CON.','5','','','5','Type("P_CALCINF") != "U" .and. P_CALCINF == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nObrigat := 0   .END.','000050','000049','.EXE.','5','nObrigat',':=','5','0','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVAL_ARRE := NVLR_INS := 0.00     .CNT.','000051','000000','.EXE.','5','nVAL_ARRE := NVLR_INS := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( nLiquido < 0  .Or.  ( lObrigat .and. nliquido < nObrigat','000052','000000','.CON.','5','','','5','( nLiquido < 0  .Or.  ( lObrigat .and. nliquido < nObrigat) )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lIns == .T. .END.','000053','000000','.CON.','5','','','5','lIns','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := 0   .CNT.','000054','000053','.EXE.','5','nVlr_ins',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!( cSitFolh $ "D*E" )   .OR.','000055','000053','.CON.','5','','','5','!( cSitFolh $ "D*E" )','','5','','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( cSitFolh == "D" .and. lDemiss== .T. )   .END.','000056','000053','.CON.','5','','','5','( cSitFolh == "D" .and. lDemiss== .T. )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) < 0 .OR.','000057','000056','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','<','5','0','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','( lObrigat == .T.  .And. Round(nLiquido, MsDecimais(1) ) <','000058','000056','.CON.','5','','','5','( lObrigat == .T.  .And. Round(nLiquido, MsDecimais(1) ) < nObrigat )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) < 0 .END.','000059','000058','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := (nLiquido * -1) + nObrigat   .CNT.','000060','000059','.EXE.','5','nVlr_ins',':=','5','(nLiquido * -1) + nObrigat','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := nObrigat   .END.','000061','000059','.EXE.','5','nLiquido',':=','5','nObrigat','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round(nLiquido, MsDecimais(1) ) > 0 .AND.','000062','000058','.CON.','5','','','5','Round(nLiquido, MsDecimais(1) )','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','lObrigat == .T. .END.','000063','000058','.CON.','5','','','5','lObrigat','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := nObrigat - nLiquido   .CNT.','000064','000063','.EXE.','5','nVlr_ins',':=','5','nObrigat - nLiquido','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := nObrigat   .END.','000065','000063','.EXE.','5','nLiquido',':=','5','nObrigat','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','! ( !( cSitFolh $ "D*E" ) .or. ( cSitFolh == "D" .and. lDe','000066','000053','.CON.','5','','','5','! ( !( cSitFolh $ "D*E" ) .or. ( cSitFolh == "D" .and. lDemiss )  )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','Round( nLiquido , MsDecimais(1) ) < 0 .END.','000067','000053','.CON.','5','','','5','Round( nLiquido , MsDecimais(1) )','<','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlr_ins := ( nLiquido * -1 )   .END.','000068','000067','.EXE.','5','nVlr_ins',':=','5','( nLiquido * -1 )','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred > 0 .AND.','000069','000000','.CON.','5','','','5','nArred','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido > 0 .END.','000070','000000','.CON.','5','','','5','nLiquido','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLiquido := Round( nLiquido, MsDecimais(1) )   .CNT.','000071','000070','.EXE.','5','nLiquido',':=','5','Round( nLiquido, MsDecimais(1) )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','CCODARRED <> SPACE(4) .AND.','000072','000070','.CON.','5','','','2','CCODARRED','<>','5','SPACE(4)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','!FO_SEEK(@&cObjeto, {cCpoPd, cCpoNPagto } , { cCodArred, c','000073','000070','.CON.','5','','','5','!FO_SEEK(@&cObjeto, {cCpoPd, cCpoNPagto } , { cCodArred, cNumPag }  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nSALV_ARR := nArred   .CNT.','000074','000073','.EXE.','5','nSALV_ARR',':=','5','nArred','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVlrTot := nLiquido   .CNT.','000075','000073','.EXE.','5','nVlrTot',':=','5','nLiquido','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','S_FCALARRE()     .CNT.','000076','000073','.EXE.','4','S_FCALARRE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nArred := nSALV_ARR   .CNT.','000077','000073','.EXE.','5','nArred',':=','5','nSALV_ARR','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nLIQUIDO := nVlrTot   .CNT.','000078','000073','.EXE.','5','nLIQUIDO',':=','5','nVlrTot','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FLIQUIDO','nVal_Arre := nVlrArre   .END.','000079','000073','.EXE.','5','nVal_Arre',':=','5','nVlrArre','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0052    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0052( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FMONTSB','MONTAGEM DO SALARIO BASE.','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','FMONTSB','SRA->RA_CATFUNC <> "T" .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC','<>','5','"T"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMONTSB','S_SALARIOB()     .END.','000002','000001','.EXE.','5','S_SALARIOB()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0053    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0053( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FMONTSD','MONTAGEM DO SALARIO DIA.','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','FMONTSD','SRA->RA_CATFUNC <> "T" .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC','<>','5','"T"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMONTSD','S_SALARIOD()     .END.','000002','000001','.EXE.','5','S_SALARIOD()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0054    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0054( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FMONTSH','MONTAGEM SALARIO HORA.','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','FMONTSH','SRA->RA_CATFUNC <> "T" .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC','<>','5','"T"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMONTSH','S_SALARIOH()     .END.','000002','000001','.EXE.','5','S_SALARIOH()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0055    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0055( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FMONTSM','MONTAGEM SALARIO MENSAL.','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','FMONTSM','SRA->RA_CATFUNC <> "T" .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC','<>','5','"T"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FMONTSM','S_SALARIOM()     .END.','000002','000001','.EXE.','5','S_SALARIOM()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0056    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0056( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FONDOSOL','CALCULO DO FONDO SOLIDARIO PARTE LABORAL','','','020','2','1',} )

aAdd(aRc3Cols, { '','S_','FONDOSOL','NVALFAI1 := 0     .CNT.','000001','000000','.EXE.','5','NVALFAI1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVALFAI2 := 0     .CNT.','000002','000000','.EXE.','5','NVALFAI2 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVALFAI3 := 0     .CNT.','000003','000000','.EXE.','5','NVALFAI3 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVDESAP1 := 0     .CNT.','000004','000000','.EXE.','5','NVDESAP1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVDESAP2 := 0     .CNT.','000005','000000','.EXE.','5','NVDESAP2 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NDESAP3 := 0     .CNT.','000006','000000','.EXE.','5','NVDESAP3 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP1  := If( FTABELA("S011",1,5,dDataRef) <> Nil, FTABELA','000007','000000','.EXE.','5','NPERAP1  := If( FTABELA("S011",1,5,dDataRef) <> Nil, FTABELA("S011",1,5,dDataRef), FTABELA("S011",1,5 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP2  := If( FTABELA("S011",2,5,dDataRef) <> Nil, FTABELA','000008','000000','.EXE.','5','NPERAP2  := If( FTABELA("S011",2,5,dDataRef) <> Nil, FTABELA("S011",2,5,dDataRef), FTABELA("S011",2,5 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP3 := If( FTABELA("S011",3,5,dDataRef) <> Nil, FTABELA(','000009','000000','.EXE.','5','NPERAP3 := If( FTABELA("S011",3,5,dDataRef) <> Nil, FTABELA("S011",3,5,dDataRef), FTABELA("S011",3,5 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVDESAP1 := If( FTABELA("S011",1,6,dDataRef) <> Nil, FTABELA','000010','000000','.EXE.','5','NVDESAP1 := If( FTABELA("S011",1,6,dDataRef) <> Nil, FTABELA("S011",1,6,dDataRef), FTABELA("S011",1,6 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVDESAP2 := If( FTABELA("S011",2,6,dDataRef) <> Nil, FTABELA','000011','000000','.EXE.','5','NVDESAP2 := If( FTABELA("S011",2,6,dDataRef) <> Nil, FTABELA("S011",2,6,dDataRef), FTABELA("S011",2,6 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVDESAP3 := If( FTABELA("S011",3,6,dDataRef) <> Nil, FTABELA','000012','000000','.EXE.','5','NVDESAP3 := If( FTABELA("S011",3,6,dDataRef) <> Nil, FTABELA("S011",3,6,dDataRef), FTABELA("S011",3,6 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NCODVER1 := If( FTABELA("S011",1,7,dDataRef) <> Nil,FTABELA(','000013','000000','.EXE.','5','NCODVER1 := If( FTABELA("S011",1,7,dDataRef) <> Nil,FTABELA("S011",1,7,dDataRef), FTABELA("S011",1,7 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NCODVER2 := If( FTABELA("S011",2,7,dDataRef) <> Nil, FTABELA','000014','000000','.EXE.','5','NCODVER2 := If( FTABELA("S011",2,7,dDataRef) <> Nil, FTABELA("S011",2,7,dDataRef), FTABELA("S011",2,7 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NCODVER3 := If( FTABELA("S011",3,7,dDataRef) <> Nil, FTABELA','000015','000000','.EXE.','5','NCODVER3 := If( FTABELA("S011",3,7,dDataRef) <> Nil, FTABELA("S011",3,7,dDataRef), FTABELA("S011",3,7 ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','Type("NPERAP1") == "U"   .END.','000016','000000','.CON.','5','','','5','Type("NPERAP1") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP1 := 0     .END.','000017','000016','.EXE.','5','NPERAP1 := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','Type("NPERAP2") == "U"   .END.','000018','000000','.CON.','5','','','5','Type("NPERAP2") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP2 := 0     .END.','000019','000018','.EXE.','5','NPERAP2 := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','Type("NPERAP3") == "U"   .END.','000020','000000','.CON.','5','','','5','Type("NPERAP3") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP3 := 0     .END.','000021','000020','.EXE.','5','NPERAP3 := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','Type("NVDESAP1") == "U"   .END.','000022','000000','.CON.','5','','','5','Type("NVDESAP1") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVDESAP1 := 0     .END.','000023','000022','.EXE.','5','NVDESAP1 := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','Type("NVDESAP2") == "U"   .END.','000024','000000','.CON.','5','','','5','Type("NVDESAP2") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVDESAP2 := 0     .END.','000025','000024','.EXE.','5','NVDESAP2 := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','Type("NVDESAP3") == "U"   .END.','000026','000000','.CON.','5','','','5','Type("NVDESAP3") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVDESAP3 := 0     .END.','000027','000026','.EXE.','5','NVDESAP3 := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NBFONSOL := (NBAFPSOL + NBPATEXC)     .CNT.','000028','000000','.EXE.','5','NBFONSOL := (NBAFPSOL + NBPATEXC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NBFONSOL > 0   .END.','000029','000000','.CON.','5','','','5','NBFONSOL > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP1 > 0 .AND. NVDESAP1 > 0 .AND. (NBFONSOL > NVDESAP1)','000030','000029','.CON.','5','','','5','NPERAP1 > 0 .AND. NVDESAP1 > 0 .AND. (NBFONSOL > NVDESAP1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVALFAI1 := (((NBFONSOL - NVDESAP1) * NPERAP1) / 100)     .C','000031','000030','.EXE.','5','NVALFAI1 := (((NBFONSOL - NVDESAP1) * NPERAP1) / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {NCODVER1, NVALFAI1})','000032','000030','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {NCODVER1, NVALFAI1})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP2 > 0 .AND. NVDESAP2 > 0  .AND. (NBFONSOL > NVDESAP2','000033','000029','.CON.','5','','','5','NPERAP2 > 0 .AND. NVDESAP2 > 0  .AND. (NBFONSOL > NVDESAP2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVALFAI2 := (((NBFONSOL - NVDESAP2) * NPERAP2) / 100)     .C','000034','000033','.EXE.','5','NVALFAI2 := (((NBFONSOL - NVDESAP2) * NPERAP2) / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {NCODVER2, NVALFAI2})','000035','000033','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {NCODVER2, NVALFAI2})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NPERAP3 > 0 .AND. NVDESAP3 > 0 .AND. (NBFONSOL > NVDESAP3)','000036','000029','.CON.','5','','','5','NPERAP3 > 0 .AND. NVDESAP3 > 0 .AND. (NBFONSOL > NVDESAP3)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','NVALFAI3 := (((NBFONSOL - NVDESAP3) * NPERAP3) / 100)     .C','000037','000036','.EXE.','5','NVALFAI3 := (((NBFONSOL - NVDESAP3) * NPERAP3) / 100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FONDOSOL','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {NCODVER3, NVALFAI3})','000038','000036','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR}, {NCODVER3, NVALFAI3})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0057    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0057( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FSOMAADI','SOMA CODIGOS ADIANT.','','','025','2','1',} )

aAdd(aRc3Cols, { '','S_','FSOMAADI','nPos := 0   .CNT.','000001','000000','.EXE.','5','nPos',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nPos2 := 0   .CNT.','000002','000000','.EXE.','5','nPos2',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nElementos := 0   .CNT.','000003','000000','.EXE.','5','nElementos',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nValr := 0   .CNT.','000004','000000','.EXE.','5','nValr',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','cPdPensao := ""   .CNT.','000005','000000','.EXE.','5','cPdPensao',':=','5','""','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','aCodBenef := {}   .CNT.','000006','000000','.EXE.','5','aCodBenef',':=','5','{}','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nCont := 1   .CNT.','000007','000000','.EXE.','5','nCont',':=','5','1','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Msvadto := Val_Adto     .CNT.','000008','000000','.EXE.','5','Msvadto := Val_Adto','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','fBusCadBenef( @aCodBenef, "ADI" )     .CNT.','000009','000000','.EXE.','5','fBusCadBenef( @aCodBenef, "ADI" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','!Empty(aCodBenef)   .END.','000010','000000','.CON.','5','','','5','!Empty(aCodBenef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nCont<=Len(aCodBenef)   .END.','000011','000010','.ENQ.','5','','','5','nCont<=Len(aCodBenef)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','cPdPensao+= aCodBenef[nCont,1]+","     .CNT.','000012','000011','.EXE.','5','cPdPensao+= aCodBenef[nCont,1]+","','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nCont += 1   .END.','000013','000011','.EXE.','5','nCont','+=','5','1','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nCont := 1   .CNT.','000014','000000','.EXE.','5','nCont',':=','5','1','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Fo_Gotop(@&cObjeto)     .CNT.','000015','000000','.EXE.','5','Fo_Gotop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','!Fo_Eof(@&cObjeto)   .END.','000016','000000','.ENQ.','5','','','5','!Fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','PosSrv(Fo_GetVal(@&cObjeto,cCpoPD),SRA->RA_FILIAL)     .CNT.','000017','000016','.EXE.','5','PosSrv(Fo_GetVal(@&cObjeto,cCpoPD),SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','!( Fo_Eof(@&cObjeto) ) .And. !( Fo_Deleted(@&cObjeto) ) .A','000018','000016','.CON.','5','','','5','!( Fo_Eof(@&cObjeto) ) .And. !( Fo_Deleted(@&cObjeto) ) .And. !( Fo_GetVal(@&cObjeto,cCpoPd) == FGETCODFOL("0006") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Fo_GetVal(@&cObjeto,cCpoNPagto)  == cNumPag   .AND.','000019','000018','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoNPagto)  == cNumPag','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','SRV->RV_ADIANTA == "S"   .END.','000020','000018','.CON.','5','','','5','SRV->RV_ADIANTA == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Perc_Adi :=  SRV->RV_PERC     .CNT.','000021','000020','.EXE.','5','Perc_Adi :=  SRV->RV_PERC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Perc_Adi := IIF(Perc_Adi > 0,Perc_Adi,100)     .CNT.','000022','000020','.EXE.','5','Perc_Adi := IIF(Perc_Adi > 0,Perc_Adi,100)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Fo_GetVal(@&cObjeto,cCpoTipo1) == "H"   .END.','000023','000020','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo1) == "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nValr := ( (Fo_GetVal(@&cObjeto,cCpoValor) * Salhora) * Perc','000024','000023','.EXE.','5','nValr',':=','5','( (Fo_GetVal(@&cObjeto,cCpoValor) * Salhora) * Perc_Adi / 100)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Fo_Add(@&cObjeto,{cCpoValor},{nValr})     .END.','000025','000023','.EXE.','5','Fo_Add(@&cObjeto,{cCpoValor},{nValr})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Fo_GetVal(@&cObjeto,cCpoTipo1) == "D" .END.','000026','000020','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo1)','==','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nValr := ((Fo_GetVal(@&cObjeto,cCpoValor ) * SalDia) * Perc_','000027','000026','.EXE.','5','nValr',':=','5','((Fo_GetVal(@&cObjeto,cCpoValor ) * SalDia) * Perc_Adi / 100)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','SRV->RV_TIPOCOD == "1"   .END.','000028','000020','.CON.','5','','','5','SRV->RV_TIPOCOD == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','SRV->RV_IR == "S"   .AND.','000029','000028','.CON.','5','','','5','SRV->RV_IR == "S"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','!(Fo_GetVal(@&cObjeto,cCpoPd) $ fGetCodFol("0058")+"/"+fGe','000030','000028','.CON.','5','','','5','!(Fo_GetVal(@&cObjeto,cCpoPd) $ fGetCodFol("0058")+"/"+fGetCodFol("0151")+"/"+cPdPensao)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini += NoRound(Fo_GetVal(@&cObjeto,cCpoValor))   .END.','000031','000030','.EXE.','5','Base_Ini','+=','5','NoRound(Fo_GetVal(@&cObjeto,cCpoValor))','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nValOutros+=If( fGetCodFol("0008") <> Fo_GetVal(@&cObjeto,cC','000032','000028','.EXE.','5','nValOutros+=If( fGetCodFol("0008") <> Fo_GetVal(@&cObjeto,cCpoPD),Fo_GetVal(@&cObjeto,cCpoValor),0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nValOutros := NoRound( nValOutros )     .END.','000033','000028','.EXE.','5','nValOutros := NoRound( nValOutros )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','SRV->RV_TIPOCOD == "2"   .END.','000034','000020','.CON.','5','','','5','SRV->RV_TIPOCOD == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','SRV->RV_IR == "S"   .AND.','000035','000034','.CON.','5','','','5','SRV->RV_IR == "S"','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','!(Fo_GetVal(@&cObjeto,cCpoPD) $ fGetCodFol("0058")+"/"+fGe','000036','000034','.CON.','5','','','5','!(Fo_GetVal(@&cObjeto,cCpoPD) $ fGetCodFol("0058")+"/"+fGetCodFol("0151")+"/"+cPdPensao)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini -= Fo_GetVal(@&cObjeto,cCpoValor)   .CNT.','000037','000036','.EXE.','5','Base_Ini','-=','5','Fo_GetVal(@&cObjeto,cCpoValor)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini := NoRound( Base_Ini )     .END.','000038','000036','.EXE.','5','Base_Ini := NoRound( Base_Ini )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nValOutros-=If( fGetCodFol("0008") <> Fo_GetVal(@&cObjeto,cC','000039','000034','.EXE.','5','nValOutros-=If( fGetCodFol("0008") <> Fo_GetVal(@&cObjeto,cCpoPD),Fo_GetVal(@&cObjeto,cCpoValor),0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','nValOutros := NoRound( nValOutros )     .END.','000040','000034','.EXE.','5','nValOutros := NoRound( nValOutros )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Fo_GetVal(@&cObjeto,cCpoNPagto) < cNumPag .And. SRV->RV_IR','000041','000018','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoNPagto) < cNumPag .And. SRV->RV_IR == "S" .And. SRV->RV_ADIANTA == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','SRV->RV_TIPOCOD == "1"   .END.','000042','000041','.CON.','5','','','5','SRV->RV_TIPOCOD == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini += If(!(Fo_GetVal(@&cObjeto,cCpoPD) $ fGetCodFol("0','000043','000042','.EXE.','5','Base_Ini += If(!(Fo_GetVal(@&cObjeto,cCpoPD) $ fGetCodFol("0058")+"/"+cPdPensao), Fo_GetVal(@&cObjeto,cCpoValor), 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini := NoRound( Base_Ini )     .END.','000044','000042','.EXE.','5','Base_Ini := NoRound( Base_Ini )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','SRV->RV_TIPOCOD == "2"   .END.','000045','000041','.CON.','5','','','5','SRV->RV_TIPOCOD == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini -= If(!(Fo_GetVal(@&cObjeto,cCpoPD) $ fGetCodFol("0','000046','000045','.EXE.','5','Base_Ini -= If(!(Fo_GetVal(@&cObjeto,cCpoPD) $ fGetCodFol("0058")+"/"+cPdPensao), Fo_GetVal(@&cObjeto,cCpoValor), 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini := NoRound( Base_Ini )     .END.','000047','000045','.EXE.','5','Base_Ini := NoRound( Base_Ini )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Fo_GetVal(@&cObjeto,cCpoPD) == fGetCodFol("0006").And. SRV','000048','000018','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoPD) == fGetCodFol("0006").And. SRV->RV_IR == "S" .And. Fo_GetVal(@&cObjeto,cCpoNPagto) < cNumPag','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini += If(!(Fo_GetVal(@&cObjeto,cCpoPD) $ fGetCodFol("0','000049','000048','.EXE.','5','Base_Ini += If(!(Fo_GetVal(@&cObjeto,cCpoPD) $ fGetCodFol("0058")+"/"+cPdPensao), Fo_GetVal(@&cObjeto,cCpoValor), 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Base_Ini := NoRound( Base_Ini )     .END.','000050','000048','.EXE.','5','Base_Ini := NoRound( Base_Ini )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FSOMAADI','Fo_Skip(@&cObjeto)     .END.','000051','000016','.EXE.','5','Fo_Skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0058    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0058( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','FVERADIA','ADIANT INFORMADO','','','022','2','1',} )

aAdd(aRc3Cols, { '','S_','FVERADIA','nVerAdt  := 0.00     .CNT.','000001','000000','.EXE.','5','nVerAdt  := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Informado := .F.     .CNT.','000002','000000','.EXE.','5','Informado := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','lEnt1 := .f.   .CNT.','000003','000000','.EXE.','5','lEnt1',':=','5','.f.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','lEnt2 := .f.   .CNT.','000004','000000','.EXE.','5','lEnt2',':=','5','.f.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','lEnt3 := .F.   .CNT.','000005','000000','.EXE.','5','lEnt3',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','lEnt4 := .F.   .CNT.','000006','000000','.EXE.','5','lEnt4',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','DIASTB := DIASTRAB   .CNT.','000007','000000','.EXE.','5','DIASTB',':=','5','DIASTRAB','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Fo_Gotop(@&cObjeto)     .CNT.','000008','000000','.EXE.','5','Fo_Gotop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Lnops := Fo_Seek(@&cObjeto,{cCpoPD,cCpoNPagto},{fGetCodFol("','000009','000000','.EXE.','5','Lnops',':=','5','Fo_Seek(@&cObjeto,{cCpoPD,cCpoNPagto},{fGetCodFol("0006"),cNumPag} ).And. !Fo_Deleted(@&cObjeto)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','nPosNat := Fo_Nat(@&cObjeto)   .CNT.','000010','000000','.EXE.','5','nPosNat',':=','5','Fo_Nat(@&cObjeto)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','P_nTipcal == 1 .END.','000011','000000','.CON.','5','','','5','P_nTipcal','==','5','1','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','nVerAdt := 0   .CNT.','000012','000011','.EXE.','5','nVerAdt',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','!Fo_Eof(@&cObjeto)   .END.','000013','000011','.ENQ.','5','','','5','!Fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Fo_GetVal(@&cObjeto,cCpoTipo2) == "I" .AND.','000014','000013','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo2)','==','5','"I"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','PosSrv(Fo_GetVal(@cCpoTipo2,cCpoPD),SRA->Ra_filial,"RV_ADI','000015','000013','.CON.','5','','','5','PosSrv(Fo_GetVal(@cCpoTipo2,cCpoPD),SRA->Ra_filial,"RV_ADIANTA")','==','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Fo_GetVal(@&cObjeto,cCpoNPagto) == cNumPag .END.','000016','000013','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoNPagto)','==','5','cNumPag','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','nVerAdt += 1   .END.','000017','000016','.EXE.','5','nVerAdt','+=','5','1','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Fo_Skip(@&cObjeto)     .END.','000018','000013','.EXE.','5','Fo_Skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Fo_Gotop(@&cObjeto,nPosNat)     .CNT.','000019','000011','.EXE.','5','Fo_Gotop(@&cObjeto,nPosNat)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Lnops   .AND.','000020','000011','.CON.','5','','','5','Lnops','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Fo_GetVal(@&cObjeto,cCpoTipo2) == "I" .END.','000021','000011','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo2)','==','5','"I"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := Round(Fo_GetVal(@&cObjeto,cCpoValor),2)   .CNT.','000022','000021','.EXE.','5','Val_Adto',':=','5','Round(Fo_GetVal(@&cObjeto,cCpoValor),2)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Informado := .T.     .END.','000023','000021','.EXE.','5','Informado := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','nVerAdt == 0   .END.','000024','000011','.CON.','5','','','5','nVerAdt == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','FINALFUN()     .END.','000025','000024','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','P_nTipCal == 2 .Or. P_nTipCal == 3   .END.','000026','000000','.CON.','5','','','5','P_nTipCal == 2 .Or. P_nTipCal == 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','( P_nTipCal == 2 ) .And. ( Lnops ) .And. ( Fo_GetVal(@&cOb','000027','000026','.CON.','5','','','5','( P_nTipCal == 2 ) .And. ( Lnops ) .And. ( Fo_GetVal(@&cObjeto, cCpoTipo2) <> "A" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','FINALFUN()     .CNT.','000028','000027','.EXE.','5','FINALFUN()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','lEnt1 := .T.   .END.','000029','000027','.EXE.','5','lEnt1',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','( P_nTipCal == 3 ) .And. ( lnops ) .And. ( !lEnt1 ) .And.','000030','000026','.CON.','5','','','5','( P_nTipCal == 3 ) .And. ( lnops ) .And. ( !lEnt1 ) .And. ( Fo_GetVal(@&cObjeto,cCpoTipo2) == "I" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := Round(Fo_GetVal(@&cObjeto,cCpoValor),2)   .CNT.','000031','000030','.EXE.','5','Val_Adto',':=','5','Round(Fo_GetVal(@&cObjeto,cCpoValor),2)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','lEnt2 := .T.   .END.','000032','000030','.EXE.','5','lEnt2',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','!LEnt1.And. !LEnt2   .END.','000033','000026','.CON.','5','','','5','!LEnt1.And. !LEnt2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','cPaisLoc <> '+"'"+'CHI'+"'"+' .Or. SRA->RA_ANTICI == 0   .END.','000034','000033','.CON.','5','','','5','cPaisLoc <> '+"'"+'CHI'+"'"+' .Or. SRA->RA_ANTICI == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','LENT4 := .T.   .CNT.','000035','000034','.EXE.','5','LENT4',':=','5','.T.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','cPaisLoc == "CHI" .And. SRA->RA_ANTLIQ == "1"   .END.','000036','000034','.CON.','5','','','5','cPaisLoc == "CHI" .And. SRA->RA_ANTLIQ == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := LOCLiqSal() * ( SRA->RA_PERCADT / 100 )     .CN','000037','000036','.EXE.','5','Val_Adto := LOCLiqSal() * ( SRA->RA_PERCADT / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','lEnt3 := .T.   .END.','000038','000036','.EXE.','5','lEnt3',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','!LEnt3 .AND.  SRA->RA_CATFUNC == "M"   .END.','000039','000034','.CON.','5','','','5','!LEnt3 .AND.  SRA->RA_CATFUNC == "M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := SalMes * ( SRA->RA_PERCADT / 100 )     .END.','000040','000039','.EXE.','5','Val_Adto := SalMes * ( SRA->RA_PERCADT / 100 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','!LENT4   .END.','000041','000033','.CON.','5','','','5','!LENT4','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := "SRA->RA_ANTICI"     .END.','000042','000041','.EXE.','5','Val_Adto := "SRA->RA_ANTICI"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','LIF := ( cAdtoPro == "S" .and. Mesano(SRA->RA_ADMISSA) ==','000043','000033','.CON.','5','','','5','LIF := ( cAdtoPro == "S" .and. Mesano(SRA->RA_ADMISSA) == Mesano(dData_Pgto) .and. !Informado )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := ( Val_Adto * ( nUlt_Dia  -  Day(SRA->RA_ADMISSA)','000044','000043','.EXE.','5','Val_Adto := ( Val_Adto * ( nUlt_Dia  -  Day(SRA->RA_ADMISSA) + 1)) / nUlt_Dia','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','( !LIF ) .AND. ( LIF := ( (cAdtoPro == "S" .and. DiasTb <','000045','000033','.CON.','5','','','5','( !LIF ) .AND. ( LIF := ( (cAdtoPro == "S" .and. DiasTb < 30 .and. !Informado) .AND. SRA->RA_TIPOPGT <> "S" ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := ( Val_Adto * DiasTb ) / If(SRA->RA_CATFUNC == "H','000046','000045','.EXE.','5','Val_Adto := ( Val_Adto * DiasTb ) / If(SRA->RA_CATFUNC == "H",nUlt_Dia,30)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','( !LIF ) .AND. ( cAdtoPro =='+"'"+'N'+"'"+' .And. DiasTb <= 0 )   .END','000047','000033','.CON.','5','','','5','( !LIF ) .AND. ( cAdtoPro =='+"'"+'N'+"'"+' .And. DiasTb <= 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := 0.00     .END.','000048','000047','.EXE.','5','Val_Adto := 0.00','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','FVERADIA','Val_Adto := NoRound( Val_Adto,2 )     .END.','000049','000033','.EXE.','5','Val_Adto := NoRound( Val_Adto,2 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0059    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0059( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GARANTCO','CALCULO GARANTIA DE COMISSAO','','','017','2','1',} )

aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := 0   .CNT.','000001','000000','.EXE.','5','nTotComis',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nVlGComis := 0   .CNT.','000002','000000','.EXE.','5','nVlGComis',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := 0   .CNT.','000003','000000','.EXE.','5','NVLCOMISSA',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','SRA->RA_CATFUNC == "C" .AND.','000004','000000','.CON.','2','','','5','SRA->RA_CATFUNC','==','5','"C"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','FPOSREG("RCE",1,XFILIAL("RCE")+SRA->RA_SINDICA) == .T. .AN','000005','000000','.CON.','5','','','5','FPOSREG("RCE",1,XFILIAL("RCE")+SRA->RA_SINDICA)','==','5','.T.','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','RCE->RCE_GCOMIS > 0 .END.','000006','000000','.CON.','5','','','5','RCE->RCE_GCOMIS','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "3" .END.','000007','000006','.CON.','5','','','5','cTipoRot','==','5','"3"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fG','000008','000007','.EXE.','5','nTotComis',':=','5','fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fGetCodfol("0072") )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis += fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fG','000009','000007','.EXE.','5','nTotComis','+=','5','fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fGetCodfol("0082") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis += fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoValor,','000010','000007','.EXE.','5','nTotComis','+=','5','fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoValor, fGetCodfol("0075") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis += fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fG','000011','000007','.EXE.','5','nTotComis','+=','5','fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fGetCodfol("0343") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nVlGComis := ROUND( RCE->RCE_GCOMIS / GETMEMVAR("RH_DFERVEN"','000012','000007','.EXE.','5','nVlGComis',':=','3','ROUND( RCE->RCE_GCOMIS / GETMEMVAR("RH_DFERVEN") * GETMEMVAR("RH_DFERIAS"),2)','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < nVlGComis .END.','000013','000007','.CON.','5','','','5','nTotComis','<','5','nVlGComis','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := nVlGComis - nTotComis   .END.','000014','000013','.EXE.','5','NVLCOMISSA',':=','5','nVlGComis - nTotComis','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "4" .END.','000015','000006','.CON.','5','','','5','cTipoRot','==','5','"4"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := ( SalMes + nAdtServ + nPeric + nInsalub + nMedF','000016','000015','.EXE.','5','nTotComis',':=','5','( SalMes + nAdtServ + nPeric + nInsalub + nMedFerp )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','lMedDir == .T. .END.','000017','000015','.CON.','5','','','5','lMedDir','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nVlGComis := RCE->RCE_GCOMIS   .END.','000018','000017','.EXE.','5','nVlGComis',':=','5','RCE->RCE_GCOMIS','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','lMedDir == .F. .END.','000019','000015','.CON.','5','','','5','lMedDir','==','5','.F.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nVlGComis := RCE->RCE_GCOMIS * GETMEMVAR("RG_DFERPRO")  /  a','000020','000019','.EXE.','5','nVlGComis',':=','5','RCE->RCE_GCOMIS * GETMEMVAR("RG_DFERPRO")  /  aTabFer[3]','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < nVlGComis .END.','000021','000015','.CON.','5','','','5','nTotComis','<','5','nVlGComis','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NGCOMISFP := nVlGComis - nTotComis   .END.','000022','000021','.EXE.','5','NGCOMISFP',':=','5','nVlGComis - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := ( SalMes + nAdtServ + nPeric + nInsalub + nMedF','000023','000015','.EXE.','5','nTotComis',':=','5','( SalMes + nAdtServ + nPeric + nInsalub + nMedFerv )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000024','000015','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NGCOMISFV := RCE->RCE_GCOMIS - nTotComis   .END.','000025','000024','.EXE.','5','NGCOMISFV',':=','5','RCE->RCE_GCOMIS - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := ( SalMes + nAdtServ + nPeric + nInsalub + nMed1','000026','000015','.EXE.','5','nTotComis',':=','5','( SalMes + nAdtServ + nPeric + nInsalub + nMed13o )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000027','000015','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NGCOMIS13 := RCE->RCE_GCOMIS - nTotComis   .END.','000028','000027','.EXE.','5','NGCOMIS13',':=','5','RCE->RCE_GCOMIS - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := ( SalMes + nAdtServ + nPeric + nInsalub + nMedA','000029','000015','.EXE.','5','nTotComis',':=','5','( SalMes + nAdtServ + nPeric + nInsalub + nMedAviso )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000030','000015','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NGCOMISAV := RCE->RCE_GCOMIS - nTotComis   .END.','000031','000030','.EXE.','5','NGCOMISAV',':=','5','RCE->RCE_GCOMIS - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "5" .AND.','000032','000006','.CON.','5','','','5','cTipoRot','==','5','"5"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nAvos > 0 .END.','000033','000006','.CON.','5','','','2','nAvos','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := Fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fG','000034','000033','.EXE.','5','nTotComis',':=','5','Fo_SomaAllRegs(@&cObjeto, cCpoValor, cCpoPD, fGetCodFol("0022") )','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < ROUND( RCE->RCE_GCOMIS * NPERCENTUA, 2 ) .END.','000035','000033','.CON.','5','','','5','nTotComis','<','5','ROUND( RCE->RCE_GCOMIS * NPERCENTUA, 2 )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := ROUND(RCE->RCE_GCOMIS * NPERCENTUA ,2 )   .END','000036','000035','.EXE.','5','NVLCOMISSA',':=','5','ROUND(RCE->RCE_GCOMIS * NPERCENTUA ,2 )','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "6" .AND.','000037','000006','.CON.','5','','','5','cTipoRot','==','5','"6"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nAvos > 0 .END.','000038','000006','.CON.','5','','','2','nAvos','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := 0   .CNT.','000039','000038','.EXE.','2','nTotComis',':=','5','0','','1','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD','000040','000038','.EXE.','5','nTotComis',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD", "1" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000041','000038','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := RCE->RCE_GCOMIS - nTotComis   .END.','000042','000041','.EXE.','5','NVLCOMISSA',':=','5','RCE->RCE_GCOMIS - nTotComis','','1','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "2" .AND.','000043','000006','.CON.','5','','','5','cTipoRot','==','5','"2"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','CALCULE == "S" .END.','000044','000006','.CON.','5','','','5','CALCULE','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComiss := FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCO','000045','000044','.EXE.','5','nTotComiss',':=','5','FO_SOMAINCSRV(@&cObjeto, cCpoValor, "RV_TIPOCOD", "1")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < ROUND(RCE->RCE_GCOMIS*SRA->RA_PERCADT/100,2 )','000046','000044','.CON.','5','','','5','nTotComis','<','5','ROUND(RCE->RCE_GCOMIS*SRA->RA_PERCADT/100,2 )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','Val_Adto := ROUND(RCE->RCE_GCOMIS*SRA->RA_PERCADT/100,2)-nTo','000047','000046','.EXE.','5','Val_Adto',':=','5','ROUND(RCE->RCE_GCOMIS*SRA->RA_PERCADT/100,2)-nTotComis','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','cTipoRot == "1" .AND.','000048','000006','.CON.','5','','','5','cTipoRot','==','5','"1"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','DiasTrab > 0 .END.','000049','000006','.CON.','5','','','5','DiasTrab','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis := FO_SOMAALLREGS(@&cObjeto, cCpoValor, cCpoPD, FG','000050','000049','.EXE.','5','nTotComis',':=','5','FO_SOMAALLREGS(@&cObjeto, cCpoValor, cCpoPD, FGETCODFOL("0165") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis += FO_SOMAALLREGS(@&cObjeto, cCpoValor, cCpoPD, FG','000051','000049','.EXE.','5','nTotComis','+=','5','FO_SOMAALLREGS(@&cObjeto, cCpoValor, cCpoPD, FGETCODFOL("0166") )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','nTotComis < RCE->RCE_GCOMIS .END.','000052','000049','.CON.','5','','','5','nTotComis','<','5','RCE->RCE_GCOMIS','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GARANTCO','NVLCOMISSA := RCE->RCE_GCOMIS - nTotComis   .END.','000053','000052','.EXE.','5','NVLCOMISSA',':=','5','RCE->RCE_GCOMIS - nTotComis','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0060    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0060( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAADI','GERACAO DE ADIANTAMENTO','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAADI','CTIPOROT <> "4"   .END.','000001','000000','.CON.','5','','','5','CTIPOROT <> "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cRot := Fo_GetVal(@&cObjeto,cCpoRot)     .CNT.','000002','000001','.EXE.','5','cRot := Fo_GetVal(@&cObjeto,cCpoRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','oSrcBkp := Fo_Clone(@&cObjeto)     .CNT.','000003','000001','.EXE.','5','oSrcBkp := Fo_Clone(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','&cObjeto := NIL     .CNT.','000004','000001','.EXE.','5','&cObjeto := NIL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','GetSrcAdi()     .CNT.','000005','000001','.EXE.','5','GetSrcAdi()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','oSrcAdi := Fo_Clone(@&cObjeto)     .CNT.','000006','000001','.EXE.','5','oSrcAdi := Fo_Clone(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','&cObjeto := Fo_Clone(@oSrcBkp)     .CNT.','000007','000001','.EXE.','5','&cObjeto := Fo_Clone(@oSrcBkp)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Len(oSrcAdi:aCols) > 0   .END.','000008','000001','.CON.','5','','','5','Len(oSrcAdi:aCols) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0006")})   .END.','000009','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0006")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0007"))     .CNT.','000010','000009','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000011','000009','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000012','000009','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0713")})   .END.','000013','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0713")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0008"))     .CNT.','000014','000013','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0008"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000015','000013','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000016','000013','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0010")})   .END.','000017','000008','.CON.','5','','','5','Fo_Seek(@oSrcAdi,{cCpoPd},{FGETCODFOL("0010")})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0012"))     .CNT.','000018','000017','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoPd,FGETCODFOL("0012"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)     .CNT.','000019','000017','.EXE.','5','Fo_SetVal(@oSrcAdi,cCpoRot,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))     .END.','000020','000017','.EXE.','5','Fo_CloneLine(oSrcAdi,@&cObjeto,Fo_Nat(@oSrcAdi))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','CTIPOROT == "4"   .END.','000021','000000','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GoTop(@&cObjeto)     .CNT.','000022','000021','.EXE.','5','Fo_GoTop(@&cObjeto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!Fo_Eof(@&cObjeto)   .END.','000023','000021','.ENQ.','5','','','5','!Fo_Eof(@&cObjeto)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_GetVal(@&cObjeto,cCpoTipo2) == "A"   .END.','000024','000023','.CON.','5','','','5','Fo_GetVal(@&cObjeto,cCpoTipo2) == "A"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)     .CNT.','000025','000024','.EXE.','5','cVerba := Fo_GetVal(@&cObjeto,cCpoPd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','LIF := ( cVerba == FGETCODFOL("0006") )   .END.','000026','000024','.CON.','5','','','5','LIF := ( cVerba == FGETCODFOL("0006") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))     .END.','000027','000026','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0007"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0713") ) )   .','000028','000024','.CON.','5','','','5','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0713") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0008"))     .END.','000029','000028','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0008"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0010") ) )   .','000030','000024','.CON.','5','','','5','!LIF .And. ( LIF := ( cVerba == FGETCODFOL("0010") ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0012"))     .END.','000031','000030','.EXE.','5','Fo_SetVal(@&cObjeto,cCpoPd,FGETCODFOL("0012"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','!LIF   .END.','000032','000024','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Delete(@&cObjeto)     .END.','000033','000032','.EXE.','5','Fo_Delete(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAADI','Fo_Skip(@&cObjeto)     .END.','000034','000023','.EXE.','5','Fo_Skip(@&cObjeto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0061    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0061( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAFER','GERA FERIAS NA FOLHA','','','019','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAFER','cAchou := "N"     .CNT.','000001','000000','.EXE.','5','cAchou := "N"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nOutAdic := 0.00     .CNT.','000002','000000','.EXE.','5','nOutAdic := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAux1:= 0     .CNT.','000003','000000','.EXE.','5','nValAux1:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAux2:= 0     .CNT.','000004','000000','.EXE.','5','nValAux2:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValAux3:= 0     .CNT.','000005','000000','.EXE.','5','nValAux3:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValDes13 := 0.00     .CNT.','000006','000000','.EXE.','5','nValDes13 := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFer := 0.00     .CNT.','000007','000000','.EXE.','5','nValFer := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiaFer := 0     .CNT.','000008','000000','.EXE.','5','nDiaFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','aFerAux := {}     .CNT.','000009','000000','.EXE.','5','aFerAux := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nVezFer := 0     .CNT.','000010','000000','.EXE.','5','nVezFer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValPriMes := 0     .CNT.','000011','000000','.EXE.','5','nValPriMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDataRef := If (dDataRef == Nil, dDataBase,dDataRef)     .CN','000012','000000','.EXE.','5','dDataRef := If (dDataRef == Nil, dDataBase,dDataRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lFerTri   := .F.     .CNT.','000013','000000','.EXE.','5','lFerTri   := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nValFerMs:= 0     .CNT.','000014','000000','.EXE.','5','nValFerMs:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','aCodFolTra:= {}     .CNT.','000015','000000','.EXE.','5','aCodFolTra:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cPerFeAc := If(type("cPerFeAc") == "U",P_FERPAC,cPerFeAc)','000016','000000','.EXE.','5','cPerFeAc := If(type("cPerFeAc") == "U",P_FERPAC,cPerFeAc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','FPOSREG("SRH", 1 , SRA->RA_FILIAL+SRA->RA_MAT )     .CNT.','000017','000000','.EXE.','5','FPOSREG("SRH", 1 , SRA->RA_FILIAL+SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->RH_DATAFIM) =','000018','000000','.CON.','5','','','5','Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->RH_DATAFIM) == 3  .And.  Month(dDataRef) ==  3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','fCargaTrans(@aCodFolTra,aCodFol)     .END.','000019','000018','.EXE.','5','fCargaTrans(@aCodFolTra,aCodFol)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!SRH->(Eof()) .And. SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_','000020','000000','.ENQ.','5','','','5','!SRH->(Eof()) .And. SRH->RH_FILIAL+SRH->RH_MAT == SRA->RA_FILIAL+SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou  := "N"     .CNT.','000021','000020','.EXE.','5','cAchou  := "N"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer := "N"     .CNT.','000022','000020','.EXE.','5','cDifFer := "N"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LMesOk := ( MesAno(SRH->RH_DATAINI)==MesAno(dDataRef) )','000023','000020','.CON.','5','','','5','LMesOk := ( MesAno(SRH->RH_DATAINI)==MesAno(dDataRef) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( SRA->RA_CATFUNC ="S" .Or. (SRA->RA_CATFUNC = "H"','000024','000023','.CON.','5','','','5','LIF := ( SRA->RA_CATFUNC ="S" .Or. (SRA->RA_CATFUNC = "H" .AND. SRA->RA_TIPOPGT ="S") .And. nPosSem > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->RH_DATAINI >= aPeriodo[nPosSem,3] .And. SRH->RH_DATAI','000025','000024','.CON.','5','','','5','SRH->RH_DATAINI >= aPeriodo[nPosSem,3] .And. SRH->RH_DATAINI <= aPeriodo[ nPosSem,4]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou := "S"     .END.','000026','000025','.EXE.','5','cAchou := "S"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','(lUltSemana .and. !lDissidio) .or. (lDissidio .And. cAchou','000027','000024','.CON.','5','','','5','(lUltSemana .and. !lDissidio) .or. (lDissidio .And. cAchou = "S")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer := "S"     .END.','000028','000027','.EXE.','5','cDifFer := "S"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LiF   .END.','000029','000023','.CON.','5','','','5','!LiF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou := "S"     .CNT.','000030','000029','.EXE.','5','cAchou := "S"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer := "S"     .END.','000031','000029','.EXE.','5','cDifFer := "S"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. MesAno(SRH->RH_DATAFIM)==MesAno(dDataRef)','000032','000020','.CON.','5','','','5','!lMesOk .and. MesAno(SRH->RH_DATAFIM)==MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer  := "S"     .CNT.','000033','000032','.EXE.','5','cDifFer  := "S"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','Month(dDataRef) == 3 .And.     MesAno(SRH->RH_DATAINI)==St','000034','000032','.CON.','5','','','5','Month(dDataRef) == 3 .And.     MesAno(SRH->RH_DATAINI)==StrZero(Year(SRH->RH_DATAINI),4)+"01"   .and.      MesAno(SRH->RH_DATAFIM)==StrZero(Year(SRH->RH_DATAINI),4)+"03"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou := "S"     .END.','000035','000034','.EXE.','5','cAchou := "S"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lFerTri  := .F.     .CNT.','000036','000020','.EXE.','5','lFerTri  := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou == "S" .or. cDifFer == "S"   .END.','000037','000020','.CON.','5','','','5','cAchou == "S" .or. cDifFer == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lMesOk := ( Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->R','000038','000037','.CON.','5','','','5','lMesOk := ( Month(SRH->RH_DATAINI) == 1 .And. Month(SRH->RH_DATAFIM) == 3  .And.  Month(dDataRef) ==  3 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := Day(SRH->RH_DATAFIM)     .CNT.','000039','000038','.EXE.','5','nDiasMes := Day(SRH->RH_DATAFIM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := 0     .CNT.','000040','000038','.EXE.','5','nDiasMse := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lFerTri  := .T.     .END.','000041','000038','.EXE.','5','lFerTri  := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI)==MesAn','000042','000037','.CON.','5','','','5','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI)==MesAno(SRH->RH_DATAFIM)  )  )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := ( Day(SRH->RH_DATAFIM) - Day(SRH->RH_DATAINI) -','000043','000042','.EXE.','5','nDiasMes := ( Day(SRH->RH_DATAFIM) - Day(SRH->RH_DATAINI) - SRH->RH_DIALREM ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := 0     .CNT.','000044','000042','.EXE.','5','nDiasMse := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','( nDiasMes + SRH->RH_DIALREM ) > 30   .END.','000045','000042','.CON.','5','','','5','( nDiasMes + SRH->RH_DIALREM ) > 30','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := 30 - SRH->RH_DIALREM     .END.','000046','000045','.EXE.','5','nDiasMes := 30 - SRH->RH_DIALREM','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. MesAno(SRH->RH_DATAINI) == MesAno(dDataRef)','000047','000037','.CON.','5','','','5','!lMesOk .and. MesAno(SRH->RH_DATAINI) == MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := ( nUlt_Dia - Day(SRH->RH_DATAINI) - SRH->RH_DIAL','000048','000047','.EXE.','5','nDiasMes := ( nUlt_Dia - Day(SRH->RH_DATAINI) - SRH->RH_DIALREM ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( Month(ddataRef) < 12 )   .END.','000049','000047','.CON.','5','','','5','LIF := ( Month(ddataRef) < 12 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtMesSeg  := Ctod("01/"+StrZero(Month(dDataRef)+1,2)+"/"+St','000050','000049','.EXE.','5','dDtMesSeg  := Ctod("01/"+StrZero(Month(dDataRef)+1,2)+"/"+StrZero(Year(dDataRef),4),"DDMMYY")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIF   .END.','000051','000047','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtMesSeg := Ctod("01/01/"+StrZero(Year(dDataRef)+1,4),"DDMM','000052','000051','.EXE.','5','dDtMesSeg := Ctod("01/01/"+StrZero(Year(dDataRef)+1,4),"DDMMYY")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( MesAno(SRH->RH_DATAFIM) > MesAno(dDtMesSeg) )   .','000053','000047','.CON.','5','','','5','LIF := ( MesAno(SRH->RH_DATAFIM) > MesAno(dDtMesSeg) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := f_ultDia(dDtMesSeg)     .END.','000054','000053','.EXE.','5','nDiasMse := f_ultDia(dDtMesSeg)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIF   .END.','000055','000047','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := Day(SRH->RH_DATAFIM) - SRH->RH_DIALRE1     .END.','000056','000055','.EXE.','5','nDiasMse := Day(SRH->RH_DATAFIM) - SRH->RH_DIALRE1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cPerFeAc == "S"   .END.','000057','000037','.CON.','5','','','5','cPerFeAc == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( ( SRH->RH_DFERIAS - NoRound(SRH->RH_DFERIAS,0) )','000058','000057','.CON.','5','','','5','LIF := ( ( SRH->RH_DFERIAS - NoRound(SRH->RH_DFERIAS,0) ) > 0 .And. nDiasMse > 0 .And. nDiasMes > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes :=nDiasMes+ If(nFerDiaQb > 0,+nFerDiaQb,- 0.5)','000059','000058','.EXE.','5','nDiasMes :=nDiasMes+ If(nFerDiaQb > 0,+nFerDiaQb,- 0.5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nFerDiaQb := nFerDiaQb+ If(nFerDiaQb > 0 , -0.5 , +0.5 )','000060','000058','.EXE.','5','nFerDiaQb := nFerDiaQb+ If(nFerDiaQb > 0 , -0.5 , +0.5 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIF .AND. ( SRH->RH_DFERIAS - NoRound(SRH->RH_DFERIAS,0)','000061','000057','.CON.','5','','','5','!LIF .AND. ( SRH->RH_DFERIAS - NoRound(SRH->RH_DFERIAS,0) ) > 0 .And. nDiasMse == 0 .And. nDiasMes > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := SRH->RH_DFERIAS     .CNT.','000062','000061','.EXE.','5','nDiasMes := SRH->RH_DFERIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nFerDiaQb += 0.5     .END.','000063','000061','.EXE.','5','nFerDiaQb += 0.5','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','MesAno(SRH->RH_DATAINI) == MesAno(SRH->RH_DATAFIM) .And. S','000064','000057','.CON.','5','','','5','MesAno(SRH->RH_DATAINI) == MesAno(SRH->RH_DATAFIM) .And. SRH->(RH_DATAFIM - RH_DATAINI + 1) <> SRH->RH_DFERIAS','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','aAdd(aFerAux,{SRH->(RH_DATAFIM - RH_DATAINI + 1),SRH->RH_DFE','000065','000064','.EXE.','5','aAdd(aFerAux,{SRH->(RH_DATAFIM - RH_DATAINI + 1),SRH->RH_DFERIAS})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDMesFAC += nDiasMes     .CNT.','000066','000057','.EXE.','5','nDMesFAC += nDiasMes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDMseFAC += nDiasMse     .END.','000067','000057','.EXE.','5','nDMseFAC += nDiasMse','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->RH_DABONPE > 0   .END.','000068','000037','.CON.','5','','','5','SRH->RH_DABONPE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','Lif := ( !empty(SRH->RH_ABOPEC) )   .END.','000069','000068','.CON.','5','','','5','Lif := ( !empty(SRH->RH_ABOPEC) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAboAnt :=SRH->RH_ABOPEC     .END.','000070','000069','.EXE.','5','cAboAnt :=SRH->RH_ABOPEC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIf   .END.','000071','000068','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAboAnt :=P_ABOPEC     .CNT.','000072','000071','.EXE.','5','cAboAnt :=P_ABOPEC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAboAnt := if(cAboAnt=="S","1","2")     .END.','000073','000071','.EXE.','5','cAboAnt := if(cAboAnt=="S","1","2")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIf := ( cAboAnt == "1" )   .END.','000074','000068','.CON.','5','','','5','LIf := ( cAboAnt == "1" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtIAb := SRH->RH_DATAINI - SRH->RH_DABONPE     .CNT.','000075','000074','.EXE.','5','dDtIAb := SRH->RH_DATAINI - SRH->RH_DABONPE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtFAb := SRH->RH_DATAINI -1     .END.','000076','000074','.EXE.','5','dDtFAb := SRH->RH_DATAINI -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIf   .END.','000077','000068','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtIAb := SRH->RH_DATAFIM + 1     .CNT.','000078','000077','.EXE.','5','dDtIAb := SRH->RH_DATAFIM + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','dDtFAb := SRH->RH_DATAFIM + SRH->RH_DABONPE     .END.','000079','000077','.EXE.','5','dDtFAb := SRH->RH_DATAFIM + SRH->RH_DABONPE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lMesOk := ( MesAno(dDtIAb) == MesAno(dDataRef)  .And. MesA','000080','000068','.CON.','5','','','5','lMesOk := ( MesAno(dDtIAb) == MesAno(dDataRef)  .And. MesAno(dDtFAb) # MesAno(dDataRef) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := (nUlt_Dia - Day(dDtIAb)) + 1     .CNT.','000081','000080','.EXE.','5','nDAbMes := (nUlt_Dia - Day(dDtIAb)) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := Day(dDtFAb)     .END.','000082','000080','.EXE.','5','nDAbMse := Day(dDtFAb)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','! lMesOk .and. ( lmesOk := ( MesAno(SRH->RH_DATAINI) # Mes','000083','000068','.CON.','5','','','5','! lMesOk .and. ( lmesOk := ( MesAno(SRH->RH_DATAINI) # MesAno(dDataRef) .And. MesAno(dDtIAb) >= MesAno(dDataRef) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := 0     .CNT.','000084','000083','.EXE.','5','nDAbMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := SRH->RH_DABONPE     .END.','000085','000083','.EXE.','5','nDAbMse := SRH->RH_DABONPE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI) == Mes','000086','000068','.CON.','5','','','5','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI) == MesAno(dDataRef) .And. MesAno(dDtIAb) > MesAno(dDataRef) ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := 0     .CNT.','000087','000086','.EXE.','5','nDAbMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := SRH->RH_DABONPE     .END.','000088','000086','.EXE.','5','nDAbMse := SRH->RH_DABONPE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI) == Mes','000089','000068','.CON.','5','','','5','!lMesOk .and. ( lMesOk := ( MesAno(SRH->RH_DATAINI) == MesAno(dDataRef) .And. MesAno(dDtFAb) == MesAno(dDataRef) .And. MesAno(dDtIAb) < MesAno(dDataRef) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := Day(dDtFAb)     .CNT.','000090','000089','.EXE.','5','nDAbMes := Day(dDtFAb)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := 0     .END.','000091','000089','.EXE.','5','nDAbMse := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!lMesOk   .END.','000092','000068','.CON.','5','','','5','!lMesOk','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMes := SRH->RH_DABONPE     .CNT.','000093','000092','.EXE.','5','nDAbMes := SRH->RH_DABONPE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDAbMse := 0     .END.','000094','000092','.EXE.','5','nDAbMse := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cAchou == "S"   .END.','000095','000020','.CON.','5','','','5','cAchou == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','S_GERAITFE()     .END.','000096','000095','.EXE.','5','S_GERAITFE()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer = "S" .And. cAchou = "N"   .END.','000097','000020','.CON.','5','','','5','cDifFer = "S" .And. cAchou = "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMes := 0     .CNT.','000098','000097','.EXE.','5','nDiasMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nDiasMse := Day(SRH->RH_DATAFIM) - SRH->RH_DIALRE1     .END.','000099','000097','.EXE.','5','nDiasMse := Day(SRH->RH_DATAFIM) - SRH->RH_DIALRE1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cDifFer == "S"   .END.','000100','000020','.CON.','5','','','5','cDifFer == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','Aadd(aDifFer,{ SRH->(Recno()) , nDiasMes , nDiasMse })     .','000101','000100','.EXE.','5','Aadd(aDifFer,{ SRH->(Recno()) , nDiasMes , nDiasMse })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','SRH->(DbSkip())     .END.','000102','000020','.EXE.','5','SRH->(DbSkip())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','cPerFeAc == "S"   .END.','000103','000000','.CON.','5','','','5','cPerFeAc == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','aEval(aFerAux,{|X| nValAux1 += x[1], nValAux2 += x[2], nValA','000104','000103','.EXE.','5','aEval(aFerAux,{|X| nValAux1 += x[1], nValAux2 += x[2], nValAux3 += If(x[1] < x[2],1,0) })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lDiaQbSegFer := nValAux1 <> nValAux2 .And.      ( nValAux2 -','000105','000103','.EXE.','5','lDiaQbSegFer := nValAux1 <> nValAux2 .And.      ( nValAux2 - NoRound(nValAux2,0) > 0 ) .And.     nValAux3 > 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','LIF := ( nFerDiaQb > 0 .And. ( nDMseFAC > 0 .Or.   ( nDMes','000106','000103','.CON.','5','','','5','LIF := ( nFerDiaQb > 0 .And. ( nDMseFAC > 0 .Or.   ( nDMesFAC - NoRound(nDMesFAC,0) > 0 .And. nDMseFAC == 0 ) .Or. lDiaQbSegFer ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lFerDiaQb := .T.     .END.','000107','000106','.EXE.','5','lFerDiaQb := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','!LIF   .END.','000108','000103','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAFER','nFerDiaQb:= 0     .CNT.','000109','000108','.EXE.','5','nFerDiaQb:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAFER','lDiaQbSegFer:= .F.     .END.','000110','000108','.EXE.','5','lDiaQbSegFer:= .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0062    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0062( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERAITFE','GENERA ITEN DE VACACIONES','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GERAITFE','DDTBUSFER := FDTBUSFER()     .CNT.','000001','000000','.EXE.','5','DDTBUSFER := FDTBUSFER()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','FPOSREG("SRR",1,SRA->RA_FILIAL+SRA->RA_MAT+"F"+DTOS(DDTBUSFE','000002','000000','.EXE.','5','FPOSREG("SRR",1,SRA->RA_FILIAL+SRA->RA_MAT+"F"+DTOS(DDTBUSFER) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!SRR->(EOF()) .AND. !SRR->(DELETED()) .AND. SRA->RA_FILIAL','000003','000000','.ENQ.','5','','','5','!SRR->(EOF()) .AND. !SRR->(DELETED()) .AND. SRA->RA_FILIAL+SRA->RA_MAT == SRR->RR_FILIAL+SRR->RR_MAT .AND. DDTBUSFER == SRR->RR_DATA .AND. SRR->RR_TIPO3 == '+"'"+'F'+"'"+'','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','LIF := (SRR->RR_PD == FGETCODFOL("0102"))   .END.','000004','000003','.CON.','5','','','5','LIF := (SRR->RR_PD == FGETCODFOL("0102"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','AVRBFER := {FGETCODFOL("1003"), SRR->RR_VALOR, SRR->RR_HOR','000005','000004','.EXE.','5','AVRBFER := {FGETCODFOL("1003"), SRR->RR_VALOR, SRR->RR_HORAS, SRH->RH_DTRECIB}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000006','000004','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','CTIPOROT <> '+"'"+'4'+"'"+'   .END.','000007','000003','.CON.','5','','','5','CTIPOROT <> '+"'"+'4'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','!LIF .AND. POSSRV(SRR->RR_PD,SRA->RA_FILIAL,"RV_TIPOCOD")','000008','000007','.CON.','5','','','5','!LIF .AND. POSSRV(SRR->RR_PD,SRA->RA_FILIAL,"RV_TIPOCOD") $ "1*2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','AVRBFER := {SRR->RR_PD, SRR->RR_VALOR, SRR->RR_HORAS, SRH->R','000009','000008','.EXE.','5','AVRBFER := {SRR->RR_PD, SRR->RR_VALOR, SRR->RR_HORAS, SRH->RH_DTRECIB}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','S_GRAVAFER()     .END.','000010','000008','.EXE.','5','S_GRAVAFER()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERAITFE','SRR->(DBSKIP())     .END.','000011','000003','.EXE.','5','SRR->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0063    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0063( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GERARES','GERA RESCISAO NA FOLHA','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','GERARES','SRA->RA_SITFOLH = "D" .and. cTipoRot = "1"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH = "D" .and. cTipoRot = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aRecnos := {}     .CNT.','000002','000001','.EXE.','5','aRecnos := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCCusFun := SRA->RA_CC     .CNT.','000003','000001','.EXE.','5','cCCusFun := SRA->RA_CC','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lDeleta := .F.     .CNT.','000004','000001','.EXE.','5','lDeleta := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nPosPdCc := 0.00     .CNT.','000005','000001','.EXE.','5','nPosPdCc := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nRecno := 0.00     .CNT.','000006','000001','.EXE.','5','nRecno := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nRecnos := 0.00     .CNT.','000007','000001','.EXE.','5','nRecnos := 0.00','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLenSeq := Len( SRC->RC_SEQ )     .CNT.','000008','000001','.EXE.','5','nLenSeq := Len( SRC->RC_SEQ )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := .F.     .CNT.','000009','000001','.EXE.','5','lGerRes := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','fPosReg("SRG",1,SRA->( RA_FILIAL + RA_MAT ))     .CNT.','000010','000001','.EXE.','5','fPosReg("SRG",1,SRA->( RA_FILIAL + RA_MAT ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) == RG_FILI','000011','000001','.ENQ.','5','','','5','SRG->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) == RG_FILIAL + RG_MAT )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( ( MesAno( RG_DTGERAR ) == cAnoMes ) .and. RG_EFETIV','000012','000011','.CON.','5','','','5','SRG->( ( MesAno( RG_DTGERAR ) == cAnoMes ) .and. RG_EFETIVA $ " S" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes := .T.     .CNT.','000013','000012','.EXE.','5','lGerRes := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','LIF := ( SRG->( MesAno( RG_DATADEM ) == MesAno( RG_DTGERAR','000014','000012','.CON.','5','','','5','LIF := ( SRG->( MesAno( RG_DATADEM ) == MesAno( RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','LIF2 := ( Empty( aRecnos ) )   .END.','000015','000014','.CON.','5','','','5','LIF2 := ( Empty( aRecnos ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aAdd( aRecnos , SRG->( Recno() ) )     .END.','000016','000015','.EXE.','5','aAdd( aRecnos , SRG->( Recno() ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!LIF2   .END.','000017','000014','.CON.','5','','','5','!LIF2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aRecnos[ Len( aRecnos ) ] := SRG->( Recno() )     .END.','000018','000017','.EXE.','5','aRecnos[ Len( aRecnos ) ] := SRG->( Recno() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!LIF   .END.','000019','000012','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','aAdd( aRecnos , SRG->( Recno() ) )     .END.','000020','000019','.EXE.','5','aAdd( aRecnos , SRG->( Recno() ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( dbSkip() )     .END.','000021','000011','.EXE.','5','SRG->( dbSkip() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha := 1     .CNT.','000022','000001','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','( nRecnos := Len( aRecnos ) ) > 0.00   .END.','000023','000001','.CON.','5','','','5','( nRecnos := Len( aRecnos ) ) > 0.00','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SR','000024','000024','.CON.','5','','','5','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SRG->RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == R','000025','000024','.ENQ.','5','','','5','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == RR_FILIAL + RR_MAT + RR_TIPO3 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGER','000026','000025','.CON.','5','','','5','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGERAR .and. !Empty( RR_VALOR ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','000027','000026','.EXE.','5','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR-','000028','000026','.EXE.','5','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR->RR_DATAPAG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpo','000029','000026','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpoCc,cCpoTipo1,cCpoTipo2,cCpoData},{SRR->RR_PD,SRR->RR_VALOR,SRR->RR_HORAS,SRR->RR_SEMANA,cCCAux,SRR->RR_TIPO1,SRR->RR_TIPO2,dDataPgt})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->(DBSKIP())     .END.','000030','000025','.EXE.','5','SRR->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha ++     .END.','000031','000024','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','!Empty(CNUMPAG)   .END.','000032','000023','.CON.','5','','','5','!Empty(CNUMPAG)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','CSEMANA := CNUMPAG     .END.','000033','000032','.EXE.','5','CSEMANA := CNUMPAG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha <= nRecnos   .END.','000034','000023','.ENQ.','5','','','5','nLinha <= nRecnos','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRG->( dbGoto( aRecnos[ nLinha ] ) )     .CNT.','000035','000034','.EXE.','5','SRG->( dbGoto( aRecnos[ nLinha ] ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SR','000036','000034','.CON.','5','','','5','SRR->( dbSeek( SRA->( RA_FILIAL + RA_MAT ) + "R" + Dtos(SRG->RG_DTGERAR) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == R','000037','000036','.ENQ.','5','','','5','SRR->( !Eof() .and. SRA->( RA_FILIAL + RA_MAT ) + "R" == RR_FILIAL + RR_MAT + RR_TIPO3 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGER','000038','000037','.CON.','5','','','5','SRR->( RR_SEMANA == cSemana .and. RR_DATA == SRG->RG_DTGERAR .and. !Empty( RR_VALOR ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','000039','000038','.EXE.','5','cCcAux := IF( Empty(SRR->RR_CC ),cCCusFun ,SRR->RR_CC )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR-','000040','000038','.EXE.','5','dDataPgt := IF( Empty(SRR->RR_DATAPAG ) ,SRR->RR_DATA , SRR->RR_DATAPAG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpo','000041','000038','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoNPagto,cCpoCc,cCpoTipo1,cCpoTipo2,cCpoData,cCpoSeq},{SRR->RR_PD,SRR->RR_VALOR,SRR->RR_HORAS,SRR->RR_SEMANA,cCCAux,SRR->RR_TIPO1,SRR->RR_TIPO2,dDataPgt,SRR->RR_SEQ})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','SRR->(DBSKIP())     .END.','000042','000037','.EXE.','5','SRR->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','nLinha ++     .END.','000043','000034','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','lGerRes   .END.','000044','000001','.CON.','5','','','5','lGerRes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GERARES','S_GRAVASRC()     .END.','000045','000044','.EXE.','5','S_GRAVASRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GERARES','FINALFUN()     .END.','000046','000001','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0064    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0064( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GPEXMED','CALCULO DE MEDIAS','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GPEXMED','S_SALMIN()     .CNT.','000001','000000','.EXE.','5','S_SALMIN()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GPEXMED','S_SALMED()     .CNT.','000002','000000','.EXE.','5','S_SALMED()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GPEXMED','GPEXMED(dDt1,dDt2,dDt3,dDt4,dDt5,SalHora,Val_SalMin,aCodFol,','000003','000000','.EXE.','5','GPEXMED(dDt1,dDt2,dDt3,dDt4,dDt5,SalHora,Val_SalMin,aCodFol,P_LMESATU,lMovto,lFaltas)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0065    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0065( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAAFP','GRAVACAO AFP','','000013','012','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAAFP','nBaseAFPC > 0   .END.','000001','000000','.CON.','5','','','5','nBaseAFPC > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("731"),nBase','000002','000001','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("731"),nBaseAFPC})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','nBaseAFPV > 0   .END.','000003','000000','.CON.','5','','','5','nBaseAFPV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("833"),nBase','000004','000003','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("833"),nBaseAFPV})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','nBaseAFPR > 0   .END.','000005','000000','.CON.','5','','','5','nBaseAFPR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("834"),nBase','000006','000005','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("834"),nBaseAFPR})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','NBAFPSOL > 0   .END.','000007','000000','.CON.','5','','','5','NBAFPSOL > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("1227"),NBAF','000008','000007','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("1227"),NBAFPSOL})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','nAFPVejez > 0   .END.','000009','000000','.CON.','5','','','5','nAFPVejez > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("7','000010','000009','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("728"),nPerVejez, nAFPVejez})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','nAFPComis > 0   .END.','000011','000000','.CON.','5','','','5','nAFPComis > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("7','000012','000011','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("730"),nPerComis,nAFPComis})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','nAFPRisco > 0   .END.','000013','000000','.CON.','5','','','5','nAFPRisco > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("7','000014','000013','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("729"),nperRisco,nAFPRisco})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','NVAFPSOL > 0   .END.','000015','000000','.CON.','5','','','5','NVAFPSOL > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("1','000016','000015','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("1228"),NPERSOLI,NVAFPSOL})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','P_AFPTOTAL == .T.   .END.','000017','000000','.CON.','5','','','5','P_AFPTOTAL == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAAFP','FO_ADD(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor },{FGETCODFOL','000018','000017','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor },{FGETCODFOL("769"), (nPerRisco+nPerComis+nPerVejez+nPerSoli) , ( nAFPVejez+nAFPComis+nAFPRisco+NVAFPSOL ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0066    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0066( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAAGU','GRAVA AGUINALDO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAAGU','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS, CCPODATA},','000001','000000','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS, CCPODATA}, {FGETCODFOL("0024"),N13SAL,NAVOS, DDATA_PGTO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0067    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0067( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVADAG','GRAVA DOBLE AGUINALDO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVADAG','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS, CCPODATA},','000001','000000','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS, CCPODATA}, {FGETCODFOL("01728"),N13SAL,NAVOS, DDATA_PGTO})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0068    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0068( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAFER','GRABA VACACIONES','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAFER','NSEQ := FO_COUNT(@&COBJETO,CCPOPD,AVRBFER[1])     .CNT.','000001','000000','.EXE.','5','NSEQ := FO_COUNT(@&COBJETO,CCPOPD,AVRBFER[1])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','LIF := FO_SEEK(@&COBJETO,{CCPOPD,CCPOTIPO2},{AVRBFER[1],"I','000002','000000','.CON.','5','','','5','LIF := FO_SEEK(@&COBJETO,{CCPOPD,CCPOTIPO2},{AVRBFER[1],"I"})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','LIF := FO_SEEK(@&COBJETO,{CCPOPD,CCPOTIPO2},{AVRBFER[1],"I"}','000003','000002','.EXE.','5','LIF := FO_SEEK(@&COBJETO,{CCPOPD,CCPOTIPO2},{AVRBFER[1],"I"})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','!LIF   .END.','000004','000000','.CON.','5','','','5','!LIF','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAFER','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS, CCPODATA, C','000005','000004','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS, CCPODATA, CCPOSEQ},{AVRBFER[1], AVRBFER[2], AVRBFER[3], AVRBFER[4], STRZERO(NSEQ,2)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0069    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0069( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAIND','GRAVACION DE INDENIZACION','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAIND','aIncRes[04] == "S"   .END.','000001','000000','.CON.','5','','','5','aIncRes[04] == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','LEN(ADATAIND) > 0 .AND. ADATAIND[1,5] > 0   .END.','000002','000001','.CON.','5','','','5','LEN(ADATAIND) > 0 .AND. ADATAIND[1,5] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR, CCPOMESMED}','000003','000002','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR, CCPOMESMED}, {FGETCODFOL("754"), ADATAIND[1,3], ADATAIND[1,5], ADATAIND[1,1]+ADATAIND[1,2] } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','LEN(ADATAIND) > 1 .AND. ADATAIND[2,5] > 0   .END.','000004','000001','.CON.','5','','','5','LEN(ADATAIND) > 1 .AND. ADATAIND[2,5] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR, CCPOMESMED}','000005','000004','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR, CCPOMESMED}, {FGETCODFOL("755"), ADATAIND[2,3], ADATAIND[2,5], ADATAIND[2,1]+ADATAIND[2,2] } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','LEN(ADATAIND) > 2 .AND. ADATAIND[3,5] > 0   .END.','000006','000001','.CON.','5','','','5','LEN(ADATAIND) > 2 .AND. ADATAIND[3,5] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR, CCPOMESMED}','000007','000006','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR, CCPOMESMED}, {FGETCODFOL("756"), ADATAIND[3,3], ADATAIND[3,5], ADATAIND[3,1]+ADATAIND[3,2] } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','LEN(ADATAIND) > 3 .AND. ADATAIND[4,5] > 0   .END.','000008','000001','.CON.','5','','','5','LEN(ADATAIND) > 3 .AND. ADATAIND[4,5] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR, CCPOMESMED}','000009','000008','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOHORAS, CCPOVALOR, CCPOMESMED}, {FGETCODFOL("760"), ADATAIND[4,3], ADATAIND[4,5], ADATAIND[4,1]+ADATAIND[4,2] } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','NBASEINDE > 0   .END.','000010','000001','.CON.','5','','','5','NBASEINDE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','FO_ADD(@&COBJETO,{CCPOPD,  CCPOVALOR},{FGETCODFOL("761"),  N','000011','000010','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,  CCPOVALOR},{FGETCODFOL("761"),  NBASEINDE } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','NINDANO := ROUND(NBASEINDE * NANOS, MSDECIMAIS(1) )     .CNT','000012','000010','.EXE.','5','NINDANO := ROUND(NBASEINDE * NANOS, MSDECIMAIS(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000013','000010','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("757"),  NANOS, NINDANO } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','NINDMES := ROUND(NBASEINDE / 12 * NMESES, MSDECIMAIS(1) )','000014','000010','.EXE.','5','NINDMES := ROUND(NBASEINDE / 12 * NMESES, MSDECIMAIS(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000015','000010','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("758"),  NMESES, NINDMES } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','NINDDIAS := ROUND(NBASEINDE / 360 * NDIAS, MSDECIMAIS(1) )','000016','000010','.EXE.','5','NINDDIAS := ROUND(NBASEINDE / 360 * NDIAS, MSDECIMAIS(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIND','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000017','000010','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("759"),  NDIAS, NINDDIAS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0070    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0070( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVAIVA','GRAVAR RC-IVA','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVAIVA','nBaseIVA > 0   .END.','000001','000000','.CON.','5','','','5','nBaseIVA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("0015"), Rou','000002','000001','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor},{FGETCODFOL("0015"), Round(nBaseIVA,MsDecimais(1) ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','NVALIVA > 0   .END.','000003','000000','.CON.','5','','','5','NVALIVA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','FO_ADD(@&cObjeto,{ cCpoPd, cCpoHoras, cCpoValor },{FGETCODFO','000004','000003','.EXE.','5','FO_ADD(@&cObjeto,{ cCpoPd, cCpoHoras, cCpoValor },{FGETCODFOL("0066"), nPerRcIva, Round(nValIva, MsDecimais(1)) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','nFormMSeg > 0   .END.','000005','000000','.CON.','5','','','5','nFormMSeg > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','LTT:= ( FO_SEEK(@&COBJETO, {CCPOPD, CCPONPAGTO } , {FGETCO','000006','000005','.CON.','5','','','5','LTT:= ( FO_SEEK(@&COBJETO, {CCPOPD, CCPONPAGTO } , {FGETCODFOL("733"), CNUMPAG} ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','FO_SETVAL(@&COBJETO,CCPOPD,FGETCODFOL("733"))     .END.','000007','000006','.EXE.','5','FO_SETVAL(@&COBJETO,CCPOPD,FGETCODFOL("733"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','!LTT   .END.','000008','000005','.CON.','5','','','5','!LTT','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','FO_ADD(@&cObjeto,{cCpoPd, cCpoValor, cCpoVNaoApl},{FGETCODFO','000009','000008','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd, cCpoValor, cCpoVNaoApl},{FGETCODFOL("733"), Round (( (nMontForm * 13 /100 ) +nFORMACUM) - nFormMSeg, MsDecimais(1) ) , nFormMSeg }, cCpoPd, fGetCodFol("733") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','nTotIva > 0   .END.','000010','000000','.CON.','5','','','5','nTotIva > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','FO_ADD(@&cObjeto, { cCpoPd, cCpoValor} , {fGetCodFol("0747")','000011','000010','.EXE.','5','FO_ADD(@&cObjeto, { cCpoPd, cCpoValor} , {fGetCodFol("0747"), nTotIva} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','nMiniNoImp > 0   .END.','000012','000000','.CON.','5','','','5','nMiniNoImp > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor}, {fGetCodFol("0746"),','000013','000012','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor}, {fGetCodFol("0746"), nMiniNoImp} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','nForm87 > 0   .END.','000014','000000','.CON.','5','','','5','nForm87 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVAIVA','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor}, {fGetCodFol("0732"),','000015','000014','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor}, {fGetCodFol("0732"), nForm87} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0071    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0071( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASAL','Grava Salario','','000262','053','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASAL','lDiaHora :=GetNewPar('+"'"+'MV_DIAHOR'+"'"+',.T.)     .CNT.','000001','000000','.EXE.','5','lDiaHora :=GetNewPar('+"'"+'MV_DIAHOR'+"'"+',.T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFo','000002','000000','.EXE.','5','cSitFolh := If( type("cSitFolh")=="U",SRA->RA_SITFOLH,cSitFolh)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','Salario > 0 .AND.','000003','000000','.CON.','5','','','5','Salario','>','5','0','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','cSitFolh # "D" .END.','000004','000000','.CON.','5','','','5','cSitFolh','#','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','P_CALCINF # "S" .END.','000005','000004','.CON.','5','','','5','P_CALCINF','#','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "M*C*D" .AND.','000006','000005','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"M*C*D"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000007','000005','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000008','000005','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0031") , cNumpag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000009','000008','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0031"), "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "P" .AND.','000010','000005','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"P"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000011','000005','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0217") # Space(3) .AND.','000012','000005','.CON.','5','','','5','fGetCodFol("0217")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000013','000005','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0217") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000014','000013','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0217") , "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "A" .AND.','000015','000005','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000016','000005','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0218") # Space(3) .AND.','000017','000005','.CON.','5','','','5','fGetCodFol("0218")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000018','000005','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0218") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000019','000018','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodfol("0218") , "V" , nSalPg, Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "E" .AND.','000020','000005','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"E"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000021','000005','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0219") # Space(3) .AND.','000022','000005','.CON.','5','','','5','fGetCodFol("0219")','#','5','Space(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("02','000023','000005','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0219") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000024','000023','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0219") , "V" , nSalPg , Diastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "H" .AND.','000025','000005','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000026','000005','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0032") # SPACE(3) .AND.','000027','000005','.CON.','5','','','5','fGetCodFol("0032")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0033") = SPACE(3) .AND.','000028','000005','.CON.','5','','','5','fGetCodFol("0033")','=','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032")}, .T.)','000029','000005','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000030','000029','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg+nDsr , nHorastrab+nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "G" .AND.','000031','000005','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"G"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000032','000005','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0220") # SPACE(3) .AND.','000033','000005','.CON.','5','','','5','fGetCodFol("0220")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0220")}, .T.)','000034','000005','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0220")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000035','000034','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0220") , "V" , nSalPg+nDsr , nHorastrab+nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_CATFUNC $ "H" .AND.','000036','000005','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "M" .AND.','000037','000005','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0032") # SPACE(3) .AND.','000038','000005','.CON.','5','','','5','fGetCodFol("0032")','#','5','SPACE(3)','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fGetCodFol("0033") # SPACE(3) .END.','000039','000005','.CON.','5','','','5','fGetCodFol("0033")','#','5','SPACE(3)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032") }, .T.)','000040','000039','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0032") }, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000041','000040','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg, nHorastrab })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0033")}, .T.)','000042','000039','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD} , {fGetCodfol("0033")}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000043','000042','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0033") , "V" , nDsr, nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','SRA->RA_TIPOPGT = "S" .AND.','000044','000005','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000045','000005','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0032") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000046','000045','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0032") , "V" , nSalPg, Diastrab })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("00','000047','000045','.CON.','5','','','5','!fo_Seek(@&cObjeto, {cCpoPD, cCpoNPagto} , {fGetCodfol("0033") , cNumPag}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASAL','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras','000048','000047','.EXE.','5','fo_Add( @&cObjeto , {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras} , {fGetCodFol("0033") , "V" , nDsr, nHorasDsr })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0072    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0072( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASRC','GRAVA ASIENTOS','','000014','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASRC','!lDissidio   .END.','000001','000000','.CON.','5','','','5','!lDissidio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVASRC','PUTSRC()     .END.','000002','000001','.EXE.','5','PUTSRC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0073    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0073( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVASRF','GRAVA OBJETO SRF','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVASRF','FO_PUT(@oSRF)     .END.','000001','000000','.EXE.','5','FO_PUT(@oSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0074    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0074( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVLIQU','GRAVACAO DO LIQUIDO','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT $ "1|9"   .END.','000001','000000','.CON.','5','','','5','CTIPOROT $ "1|9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODLIQ :=FGETCODFOL("0047")     .END.','000002','000001','.EXE.','5','CCODLIQ :=FGETCODFOL("0047")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODARRED :=FGETCODFOL("0043")     .CNT.','000003','000001','.EXE.','5','CCODARRED :=FGETCODFOL("0043")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODINS := FGETCODFOL("0045")     .CNT.','000004','000001','.EXE.','5','CCODINS := FGETCODFOL("0045")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT == "6"   .END.','000005','000000','.CON.','5','','','5','CTIPOROT == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','LDOBLE:=FO_SEEK(@&COBJETO, "RC_PD", FGETCODFOL("1728")) .CNT','000006','000005','.EXE.','5','LDOBLE',':=','5','FO_SEEK(@&COBJETO, "RC_PD", FGETCODFOL("1728"))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODLIQ := IF(LDOBLE,FGETCODFOL("1729"),FGETCODFOL("0021"))','000007','000005','.EXE.','5','CCODLIQ',':=','5','IF(LDOBLE,FGETCODFOL("1729"),FGETCODFOL("0021"))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODARRED := SPACE(3)     .CNT.','000008','000005','.EXE.','5','CCODARRED := SPACE(3)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODINS := FGETCODFOL("0030") .END.','000009','000005','.EXE.','5','CCODINS',':=','5','FGETCODFOL("0030")','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT == "5"   .END.','000010','000000','.CON.','5','','','5','CTIPOROT == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODLIQ := SPACE(3)     .CNT.','000011','000010','.EXE.','5','CCODLIQ := SPACE(3)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODARRED := SPACE(3)     .CNT.','000012','000010','.EXE.','5','CCODARRED := SPACE(3)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODINS := SPACE(3)     .END.','000013','000010','.EXE.','5','CCODINS := SPACE(3)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT == "4"   .END.','000014','000000','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODLIQ :=FGETCODFOL("0126")     .CNT.','000015','000014','.EXE.','5','CCODLIQ :=FGETCODFOL("0126")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODARRED := SPACE(3)     .CNT.','000016','000014','.EXE.','5','CCODARRED := SPACE(3)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CCODINS := FGETCODFOL("0045")     .CNT.','000017','000014','.EXE.','5','CCODINS := FGETCODFOL("0045")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','nVlr_ins > 0 .END.','000018','000000','.CON.','5','','','5','nVlr_ins','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor } , { cCodIns , nVlr_in','000019','000018','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor } , { cCodIns , nVlr_ins } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','nVal_Arre > 0 .END.','000020','000000','.CON.','5','','','5','nVal_Arre','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {cCodArred , nVal_Arr','000021','000020','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {cCodArred , nVal_Arre} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','! FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto } , { cCodLiq, cN','000022','000000','.CON.','5','','','5','! FO_SEEK(@&cObjeto, {cCpoPD, cCpoNPagto } , { cCodLiq, cNumpag } )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','cPaisLoc == "BRA"   .END.','000023','000022','.CON.','5','','','5','cPaisLoc == "BRA"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT <> "9"   .END.','000024','000023','.CON.','5','','','5','CTIPOROT <> "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor} , { cCodLiq , nLiquido','000025','000024','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor} , { cCodLiq , nLiquido} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','CTIPOROT == "9"   .END.','000026','000023','.CON.','5','','','5','CTIPOROT == "9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor,cCpoData, cCpoDtRef} ,','000027','000026','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor,cCpoData, cCpoDtRef} , {cCodLiq , nLiquido, dData_Pgto, dData_Pgto} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','cPaisLoc <>  "BRA"   .END.','000028','000022','.CON.','5','','','5','cPaisLoc <>  "BRA"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVLIQU','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor, cCpoData } , { cCodLiq','000029','000028','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPd, cCpoValor, cCpoData } , { cCodLiq, nLiquido, dData_Pgto } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0075    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0075( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRAVSIND','GRAVA CONTRIBUICAO SINDICAL','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRAVSIND','lDescSin == .T. .END.','000001','000000','.CON.','5','','','5','lDescSin','==','5','.T.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRAVSIND','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor} , { FGETCODFOL("0068")','000002','000001','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor} , { FGETCODFOL("0068") , nContri } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0076    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0076( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRGARACO','GRAVA GARANTIA DE COMISSAO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','GRGARACO','NVLCOMISSA > 0 .END.','000001','000000','.CON.','5','','','5','NVLCOMISSA','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','cTipoRot == "1" .END.','000002','000001','.CON.','5','','','5','cTipoRot','==','5','"1"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {FGETCODFOL("0347"),','000003','000002','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD, cCpoValor}, {FGETCODFOL("0347"), NVLCOMISSA } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','cTipoRot  == "3" .and. !FO_SEEK(@&cObjeto, {cCpoPD, cCpoTi','000004','000001','.CON.','5','','','5','cTipoRot  == "3" .and. !FO_SEEK(@&cObjeto, {cCpoPD, cCpoTipo2}, {FGETCODFOL("0072"), "I"})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0072"','000005','000004','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0072") , NVLCOMISSA} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','cTipoRot == "5" .END.','000006','000001','.CON.','5','','','5','cTipoRot','==','5','"5"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0022"','000007','000006','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0022") , NVLCOMISSA} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','cTipoRot == "6" .END.','000008','000001','.CON.','5','','','5','cTipoRot','==','5','"6"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRGARACO','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0024"','000009','000008','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD , cCpoValor } , {FGETCODFOL("0024") , NVLCOMISSA } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0077    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0077( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRPRIFIN','GRAVA PRIMA ANUAL FINIQUITO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRPRIFIN','AINCRES[05] == "S"   .END.','000001','000000','.CON.','5','','','5','AINCRES[05] == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRPRIFIN','NBASEINDE > 0   .END.','000002','000001','.CON.','5','','','5','NBASEINDE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRPRIFIN','NPRIMES := ROUND(NBASEINDE / 12 * NMESESPRIM, MSDECIMAIS(1)','000003','000002','.EXE.','5','NPRIMES := ROUND(NBASEINDE / 12 * NMESESPRIM, MSDECIMAIS(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRPRIFIN','NPRIDIAS := ROUND(NBASEINDE / 360 * NDIASPRIMA , MSDECIMAIS(','000004','000002','.EXE.','5','NPRIDIAS := ROUND(NBASEINDE / 360 * NDIASPRIMA , MSDECIMAIS(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRPRIFIN','NPRIMES > 0   .END.','000005','000002','.CON.','5','','','5','NPRIMES > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRPRIFIN','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000006','000005','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("766"),  NMESESPRIMI, NPRIMES } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRPRIFIN','NPRIDIAS > 0   .END.','000007','000002','.CON.','5','','','5','NPRIDIAS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRPRIFIN','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000008','000007','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("767"),  NDIASPRIMA, NPRIDIAS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0078    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0078( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVACFIN','GRAVA VACACIONES FINIQUITO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVACFIN','aIncRes[02] == '+"'"+'S'+"'"+'   .END.','000001','000000','.CON.','5','','','5','aIncRes[02] == '+"'"+'S'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVACFIN','NDFERIND > 0   .END.','000002','000001','.CON.','5','','','5','NDFERIND > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVACFIN','FO_ADD(@&cObjeto, { cCpoPd, cCpoHoras, cCpoValor } ,{FGETCOD','000003','000002','.EXE.','5','FO_ADD(@&cObjeto, { cCpoPd, cCpoHoras, cCpoValor } ,{FGETCODFOL("086"), nDFerInd, NVLVACVEN } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVACFIN','NDFERAVE > 0   .END.','000004','000001','.CON.','5','','','5','NDFERAVE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVACFIN','FO_ADD(@&cObjeto, { cCpoPd, cCpoHoras, cCpoValor } ,{FGETCOD','000005','000004','.EXE.','5','FO_ADD(@&cObjeto, { cCpoPd, cCpoHoras, cCpoValor } ,{FGETCODFOL("087"), nDFerAve, NVLVACPR } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVACFIN','nDFerAux > 0 .And. Len(aCodFol) >= 1885   .END.','000006','000001','.CON.','5','','','5','nDFerAux > 0 .And. Len(aCodFol) >= 1885','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVACFIN','FO_ADD(@&COBJETO, { CCPOPD, CCPOHORAS, CCPOVALOR } ,{FGETCOD','000007','000006','.EXE.','5','fo_Add(@&cObjeto, { cCpoPd, cCpoHoras, cCpoValor } ,{fGetCodFol("1885"), nDFerAux, Round((nBaseInde / 30 ) * nDFerAux, 2) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0079    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0079( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVAGNAV','GRAVA AGUINALDO NAVIDAD','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVAGNAV','aIncRes[01] == "S"   .END.','000001','000000','.CON.','5','','','5','aIncRes[01] == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','nBaseInde > 0   .END.','000002','000001','.CON.','5','','','5','nBaseInde > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','NINDMES := ROUND(NBASEINDE / 12 * NMESESAGUI, MSDECIMAIS(1)','000003','000002','.EXE.','5','NINDMES := ROUND(NBASEINDE / 12 * NMESESAGUI, MSDECIMAIS(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000004','000002','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("762"),  NMESESAGUI, NINDMES } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','( SRA->RA_CATFUNC $ "M*C*P*A*E*I" )   .END.','000005','000002','.CON.','5','','','5','( SRA->RA_CATFUNC $ "M*C*P*A*E*I" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','NINDDIAS := ROUND(NBASEINDE / 360 * NDIASAGUI, MSDECIMAIS(1)','000006','000005','.EXE.','5','NINDDIAS := ROUND(NBASEINDE / 360 * NDIASAGUI, MSDECIMAIS(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000007','000005','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("763"),  NDIASAGUI, NINDDIAS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','( SRA->RA_CATFUNC $ "H*T*G*J*D" )   .END.','000008','000002','.CON.','5','','','5','( SRA->RA_CATFUNC $ "H*T*G*J*D" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','NINDDIAS := ROUND(NBASEINDE / 365 * NDIASAGUI, MSDECIMAIS(1)','000009','000008','.EXE.','5','NINDDIAS := ROUND(NBASEINDE / 365 * NDIASAGUI, MSDECIMAIS(1) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAGNAV','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL(','000010','000008','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOHORAS, CCPOVALOR},{FGETCODFOL("763"),  NDIASAGUI, NINDDIAS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0080    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0080( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVANTIG','GRAVA BONO ANTIGUEDAD','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVANTIG','NVLBONOANT > 0   .END.','000001','000000','.CON.','5','','','5','NVLBONOANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVANTIG','FO_ADD(@&COBJETO, { CCPOPD, cCpoHoras, CCPOVALOR}, {FGETCODF','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, { CCPOPD, cCpoHoras, CCPOVALOR}, {FGETCODFOL("0671"), NPERANT, NVLBONOANT } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0081    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0081( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVAPPAT','GRAVA APORTE PATRONAL','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVAPPAT','nBasePatro > 0   .END.','000001','000000','.CON.','5','','','5','nBasePatro > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','FO_ADD(@&cObjeto,{cCpoPd, cCpoValor }, {FGETCODFOL("737"), n','000002','000001','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd, cCpoValor }, {FGETCODFOL("737"), nBasePatro } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','nValViv > 0   .END.','000003','000000','.CON.','5','','','5','nValViv > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','FO_ADD(@&cObjeto,{ cCpoPd, cCpoHoras, cCpoValor},{FGETCODFOL','000004','000003','.EXE.','5','FO_ADD(@&cObjeto,{ cCpoPd, cCpoHoras, cCpoValor},{FGETCODFOL("734"), nPerVivien , nValViv } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','nValRProf > 0   .END.','000005','000000','.CON.','5','','','5','nValRProf > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("7','000006','000005','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("735"), nPerRisPro, nValRProf } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','nValCNS > 0   .END.','000007','000000','.CON.','5','','','5','nValCNS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','FO_ADD(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor },{FGETCODFOL','000008','000007','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor },{FGETCODFOL("736"), nPerCNS, nValCNS } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','nBPatExc > 0   .END.','000009','000000','.CON.','5','','','5','nBPatExc > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','FO_ADD(@&cObjeto,{cCpoPd, cCpoValor }, {FGETCODFOL("1210"),','000010','000009','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd, cCpoValor }, {FGETCODFOL("1210"), nBPatExc } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','nValApAd > 0   .END.','000011','000000','.CON.','5','','','5','nValApAd > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVAPPAT','FO_ADD(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor },{FGETCODFOL','000012','000011','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd, cCpoHoras, cCpoValor },{FGETCODFOL("1211"), nPerApAd, nValApAd } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0082    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0082( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVATVPF','GRAVA H. ATIV. PROFESSOR FIXA','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVATVPF','(SRA->RA_CATFUNC $ "I*J") .And.  nBsHrsAtiv > 0   .END.','000001','000000','.CON.','','','','5','(SRA->RA_CATFUNC $ "I*J") .And.  nBsHrsAtiv > 0','','','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVATVPF','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("3','000002','000001','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor},{FGETCODFOL("317"), aParProf[3]*100,nBsHrsAtiv*aParProf[3]})','','','','','','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0083    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0083( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVDESAH','GRAVA DESAHUCIO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVDESAH','aIncRes[03] == "S"   .END.','000001','000000','.CON.','5','','','5','aIncRes[03] == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDESAH','NBASEINDE > 0   .END.','000002','000001','.CON.','5','','','5','NBASEINDE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDESAH','FO_ADD(@&COBJETO,{CCPOPD,  CCPOVALOR},{FGETCODFOL("768"),  (','000003','000002','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD,  CCPOVALOR},{FGETCODFOL("768"),  (NBASEINDE * 3)  } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0084    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0084( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVDISS','GRAVACAO DO DISSIDIO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVDISS','lDissidio   .END.','000001','000000','.CON.','5','','','5','lDissidio','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDISS','aPD:= aClone( oSRC:aCols)     .CNT.','000002','000001','.EXE.','5','aPD:= aClone( oSRC:aCols)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDISS','ATOTREGS:= ARRAY(19)     .CNT.','000003','000001','.EXE.','5','ATOTREGS:= ARRAY(19)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDISS','AFILL(ATOTREGS,0)     .CNT.','000004','000001','.EXE.','5','AFILL(ATOTREGS,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDISS','GravaDissidio(aPD,aPDOld)     .END.','000005','000001','.EXE.','5','GravaDissidio(aPD,aPDOld)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0085    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0085( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVDOMPA','GRAVA DOMINGO PAGO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVDOMPA','NVLDOMIN > 0   .END.','000001','000000','.CON.','5','','','5','NVLDOMIN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDOMPA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOHORAS, CCPOVALOR}, {FGETCODF','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOHORAS, CCPOVALOR}, {FGETCODFOL("0779"),  NDOMINGOS, NVLDOMIN }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDOMPA','NVLFALTA  > 0   .END.','000003','000000','.CON.','5','','','5','NVLFALTA  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDOMPA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOHORAS, CCPOVALOR}, {FGETCODF','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOHORAS, CCPOVALOR}, {FGETCODFOL("0054"),  NTOTFALTAS, NVLFALTA }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDOMPA','NVLFALDOM >0   .END.','000005','000000','.CON.','5','','','5','NVLFALDOM >0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDOMPA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOHORAS, CCPOVALOR}, {FGETCODF','000006','000005','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOHORAS, CCPOVALOR}, {FGETCODFOL("1237"), ( NTOTDOM-NDOMINGOS), NVLFALDOM }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0086    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0086( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVDSRTA','GRAVA DSR TAREFEIRO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVDSRTA','LEN(aDsrTarefa) > 0   .END.','000001','000000','.CON.','5','','','5','LEN(aDsrTarefa) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVDSRTA','nLinha := 1     .CNT.','000002','000001','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDSRTA','nLinha <= Len(aDsrTarefa)   .END.','000003','000001','.ENQ.','5','','','5','nLinha <= Len(aDsrTarefa)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GRVDSRTA','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoCC},{ADSRTA','000004','000003','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoValor,cCpoHoras,cCpoCC},{ADSRTAREFA[nLinha,1], ADSRTAREFA[nLinha,2],ADSRTAREFA[nLinha,3],ADSRTAREFA[nLinha,4]})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVDSRTA','nLinha ++     .END.','000005','000003','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0087    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0087( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVPRIMA','GRAVA PRIMA ANUAL','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVPRIMA','nBasePrima > 0   .END.','000001','000000','.CON.','5','','','5','nBasePrima > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRIMA','FO_ADD(@&COBJETO, { CCPOPD, CCPOHORAS, CCPOVALOR}, {FGETCODF','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, { CCPOPD, CCPOHORAS, CCPOVALOR}, {FGETCODFOL("0775") , NALIQPRIMA, NBASEPRIMA } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0088    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0088( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVPROVA','GRAVA PROVISION VACACIONES','','','024','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVPROVA','P_PROVFER   .END.','000001','000000','.CON.','5','','','5','P_PROVFER','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','SRA->RA_SITFOLH == "D"    .AND. mesano(SRA->RA_DEMISSA)  =','000002','000001','.CON.','5','','','5','SRA->RA_SITFOLH == "D"    .AND. mesano(SRA->RA_DEMISSA)  == MESANO(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','NPRVVACANT > 0   .END.','000003','000002','.CON.','5','','','5','NPRVVACANT > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt < nBasePrVac   .END.','000004','000003','.CON.','5','','','5','nPrvVacAnt < nBasePrVac','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),','000005','000004','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),  ( nPrvVacAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0130"),','000006','000004','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0130"),  ( nBasePrVac - nPrvVacAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt > nBasePrVac   .END.','000007','000003','.CON.','5','','','5','nPrvVacAnt > nBasePrVac','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0130"),','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0130"),  (nPrvVacAnt - nBasePrVac) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),','000009','000007','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),  ( nPrvVacAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt = nBasePrVac   .END.','000010','000003','.CON.','5','','','5','nPrvVacAnt = nBasePrVac','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),','000011','000010','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),  ( nPrvVacAnt) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt = 0   .END.','000012','000002','.CON.','5','','','5','nPrvVacAnt = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nBasePrVac > 0   .END.','000013','000012','.CON.','5','','','5','nBasePrVac > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, { cCpoPd,  cCpoValor }, { FGETCODFOL("0130','000014','000013','.EXE.','5','FO_ADD(@&COBJETO, { cCpoPd,  cCpoValor }, { FGETCODFOL("0130") ,  nBasePrVac  }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DE','000015','000001','.CON.','5','','','5','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DEMISSA) > MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt > 0   .END.','000016','000015','.CON.','5','','','5','nPrvVacAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt < nBasePrVac   .END.','000017','000016','.CON.','5','','','5','nPrvVacAnt < nBasePrVac','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),','000018','000017','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),  ( nPrvVacAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0130"),','000019','000017','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0130"),  ( nBasePrVac - nPrvVacAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt > nBasePrVac   .END.','000020','000016','.CON.','5','','','5','nPrvVacAnt > nBasePrVac','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0130"),','000021','000020','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0130"),  (nPrvVacAnt - nBasePrVac) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),','000022','000020','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),  ( nPrvVacAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt = nBasePrVac   .END.','000023','000016','.CON.','5','','','5','nPrvVacAnt = nBasePrVac','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),','000024','000023','.EXE.','5','FO_ADD(@&COBJETO, {cCpoPd,  cCpoValor}, {FGETCODFOL("0776"),  ( nPrvVacAnt) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nPrvVacAnt = 0   .END.','000025','000015','.CON.','5','','','5','nPrvVacAnt = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','nBasePrVac > 0   .END.','000026','000025','.CON.','5','','','5','nBasePrVac > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPROVA','FO_ADD(@&COBJETO, { cCpoPd,  cCpoValor }, { FGETCODFOL("0130','000027','000026','.EXE.','5','FO_ADD(@&COBJETO, { cCpoPd,  cCpoValor }, { FGETCODFOL("0130") ,  nBasePrVac  }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0089    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0089( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVPRVAG','GRABA PROVISION AGUINALDO','','','010','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVPRVAG','SRA->RA_SITFOLH == "D"    .AND. mesano(SRA->RA_DEMISSA)  =','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH == "D"    .AND. mesano(SRA->RA_DEMISSA)  == MESANO(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','nPrvAgAnt > 0   .END.','000002','000001','.CON.','5','','','5','nPrvAgAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','nPrvAgAnt < NBASEPRO13   .END.','000003','000002','.CON.','5','','','5','nPrvAgAnt < NBASEPRO13','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0777"),','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0777"),  (nPrvAgAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0136"),','000005','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0136"),  (NBASEPRO13 - nPrvAgAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','nPrvAgAnt > NBASEPRO13   .END.','000006','000002','.CON.','5','','','5','nPrvAgAnt > NBASEPRO13','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0136"),','000007','000006','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0136"),  ( NBASEPRO13 - nPrvAgAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0777"),','000008','000006','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0777"),  ( nPrvAgAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','nPrvAgAnt = 0   .END.','000009','000001','.CON.','5','','','5','nPrvAgAnt = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','NBASEPRO13 > 0   .END.','000010','000009','.CON.','5','','','5','NBASEPRO13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, { CCPOPD,  CCPOVALOR }, { FGETCODFOL("0136','000011','000010','.EXE.','5','FO_ADD(@&COBJETO, { CCPOPD,  CCPOVALOR }, { FGETCODFOL("0136") ,  NBASEPRO13  }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DE','000012','000000','.CON.','5','','','5','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DEMISSA) > MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','NPRVAGANT  > 0   .END.','000013','000012','.CON.','5','','','5','NPRVAGANT  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','nPrvAgAnt < NBASEPRO13   .END.','000014','000013','.CON.','5','','','5','nPrvAgAnt < NBASEPRO13','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0777"),','000015','000014','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0777"),  (nPrvAgAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0136"),','000016','000014','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0136"),  (NBASEPRO13 - nPrvAgAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','nPrvAgAnt > NBASEPRO13   .END.','000017','000013','.CON.','5','','','5','nPrvAgAnt > NBASEPRO13','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0136"),','000018','000017','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0136"),  ( NBASEPRO13 - nPrvAgAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0777"),','000019','000017','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0777"),  ( nPrvAgAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','nPrvAgAnt = 0   .END.','000020','000012','.CON.','5','','','5','nPrvAgAnt = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','NBASEPRO13 > 0   .END.','000021','000020','.CON.','5','','','5','NBASEPRO13 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVAG','FO_ADD(@&COBJETO, { CCPOPD,  CCPOVALOR }, { FGETCODFOL("0136','000022','000021','.EXE.','5','FO_ADD(@&COBJETO, { CCPOPD,  CCPOVALOR }, { FGETCODFOL("0136") ,  NBASEPRO13  }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0090    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0090( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVPRVDA','GRABA PROVISION DOBLE AGUINALDO','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVPRVDA','!Empty( aCodFol[142, 1] )   .END.','000001','000000','.CON.','5','','','5','!Empty( aCodFol[142, 1] )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','SRA->RA_SITFOLH == "D"    .AND. mesano(SRA->RA_DEMISSA)  =','000002','000001','.CON.','5','','','5','SRA->RA_SITFOLH == "D"    .AND. mesano(SRA->RA_DEMISSA)  == MESANO(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','nPrvDAAnt > 0   .END.','000003','000002','.CON.','5','','','5','nPrvDAAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','nPrvDAAnt < NBASEPRO14   .END.','000004','000003','.CON.','5','','','5','nPrvDAAnt < NBASEPRO14','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1895"),','000005','000004','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1895"),  (nPrvDAAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0142"),','000006','000004','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0142"),  (NBASEPRO14 - nPrvDAAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','nPrvDAAnt > NBASEPRO14   .END.','000007','000003','.CON.','5','','','5','nPrvDAAnt > NBASEPRO14','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0142"),','000008','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0142"),  ( NBASEPRO14 - nPrvDAAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1895"),','000009','000007','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1895"),  ( nPrvDAAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','nPrvDAAnt == 0   .END.','000010','000002','.CON.','5','','','5','nPrvDAAnt == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','NBASEPRO14 > 0   .END.','000011','000010','.CON.','5','','','5','NBASEPRO14 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, { CCPOPD,  CCPOVALOR }, { FGETCODFOL("0142','000012','000011','.EXE.','5','FO_ADD(@&COBJETO, { CCPOPD,  CCPOVALOR }, { FGETCODFOL("0142") ,  NBASEPRO14  }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DE','000013','000001','.CON.','5','','','5','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DEMISSA) > MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','nPrvDAAnt  > 0   .END.','000014','000013','.CON.','5','','','5','nPrvDAAnt  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','nPrvDAAnt < NBASEPRO14   .END.','000015','000014','.CON.','5','','','5','nPrvDAAnt < NBASEPRO14','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1895"),','000016','000015','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1895"),  (nPrvDAAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0142"),','000017','000015','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0142"),  (NBASEPRO14 - nPrvDAAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','nPrvDAAnt > NBASEPRO14   .END.','000018','000014','.CON.','5','','','5','nPrvDAAnt > NBASEPRO14','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0142"),','000019','000018','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0142"),  ( NBASEPRO14 - nPrvDAAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1895"),','000020','000018','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("1895"),  ( nPrvDAAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','nPrvDAAnt == 0   .END.','000021','000013','.CON.','5','','','5','nPrvDAAnt == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','NBASEPRO14 > 0   .END.','000022','000021','.CON.','5','','','5','NBASEPRO14 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVDA','FO_ADD(@&COBJETO, { CCPOPD,  CCPOVALOR }, { FGETCODFOL("0142','000023','000022','.EXE.','5','FO_ADD(@&COBJETO, { CCPOPD,  CCPOVALOR }, { FGETCODFOL("0142") ,  NBASEPRO14  }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0091    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0091( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVPRVIN','GRABA PROVISION INDEMNIZACION','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVPRVIN','SRA->RA_SITFOLH == "D"    .AND. mesano(SRA->RA_DEMISSA)  =','000001','000000','.CON.','5','','','5','SRA->RA_SITFOLH == "D"    .AND. mesano(SRA->RA_DEMISSA)  == MESANO(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','nPrvIndAnt > 0   .END.','000002','000001','.CON.','5','','','5','nPrvIndAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','nPrvIndAnt <  nBaseProv   .END.','000003','000002','.CON.','5','','','5','nPrvIndAnt <  nBaseProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),','000004','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),  ( nPrvIndAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),','000005','000003','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),  ( nBaseProv - nPrvIndAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','nPrvIndAnt > nBaseProv   .END.','000006','000002','.CON.','5','','','5','nPrvIndAnt > nBaseProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),','000007','000006','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),  (  nBaseProv - nPrvIndAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),','000008','000006','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),  (nPrvIndAnt) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','nPrvIndAnt = 0   .END.','000009','000001','.CON.','5','','','5','nPrvIndAnt = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@OSRC, {"RC_PD",  "RC_VALOR"}, { FGETCODFOL("0774"),','000010','000009','.EXE.','5','FO_ADD(@OSRC, {"RC_PD",  "RC_VALOR"}, { FGETCODFOL("0774"), nBaseProv } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DE','000011','000000','.CON.','5','','','5','MesAno(SRA->RA_DEMISSA) = SPACE(6)  .OR. MesAno(SRA->RA_DEMISSA) > MesAno(dDataRef)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','nPrvIndAnt > 0   .END.','000012','000011','.CON.','5','','','5','nPrvIndAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','nPrvIndAnt <  nBaseProv   .END.','000013','000012','.CON.','5','','','5','nPrvIndAnt <  nBaseProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),','000014','000013','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),  ( nPrvIndAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),','000015','000013','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),  ( nBaseProv - nPrvIndAnt ) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','nPrvIndAnt > nBaseProv   .END.','000016','000012','.CON.','5','','','5','nPrvIndAnt > nBaseProv','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),','000017','000016','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0774"),  (  nBaseProv - nPrvIndAnt ) }  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),','000018','000016','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD,  CCPOVALOR}, {FGETCODFOL("0778"),  (nPrvIndAnt) }  )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','nPrvIndAnt = 0   .END.','000019','000011','.CON.','5','','','5','nPrvIndAnt = 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVPRVIN','FO_ADD(@OSRC, {"RC_PD",  "RC_VALOR"}, { FGETCODFOL("0774"),','000020','000019','.EXE.','5','FO_ADD(@OSRC, {"RC_PD",  "RC_VALOR"}, { FGETCODFOL("0774"), nBaseProv } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0092    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0092( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVQUINQ','GRAVA QUINQUENIO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVQUINQ','nBaseQ > 0   .END.','000001','000000','.CON.','5','','','5','nBaseQ > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVQUINQ','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , {FGETCODF','000002','000001','.EXE.','5','FO_ADD(@&COBJETO, {CCPOPD, CCPOVALOR, CCPOHORAS} , {FGETCODFOL("0781"), nBaseQ * 5 , 5 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0093    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0093( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVSALME','GRAVA SALARIO MENSAL','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVSALME','FO_ADD(@&cObjeto, {cCpoPD,cCpoValor} , {FGETCODFOL("0318"),','000001','000000','.EXE.','5','FO_ADD(@&cObjeto, {cCpoPD,cCpoValor} , {FGETCODFOL("0318"), SALMES} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0094    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0094( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','GRVTAREF','GRAVA TAREFAS DO SRO','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','GRVTAREF','nLinha := 1     .CNT.','000001','000000','.EXE.','5','nLinha := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVTAREF','nLinha <= Len(aTarefas)   .END.','000002','000000','.ENQ.','5','','','5','nLinha <= Len(aTarefas)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','GRVTAREF','aTarefas[nLinha,8] == "SRO"   .END.','000003','000002','.CON.','5','','','5','aTarefas[nLinha,8] == "SRO"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','GRVTAREF','FO_ADD(@&cObjeto,{cCpoPd,cCpoQtdSem,cCpoHoras,cCpoValor,cCpo','000004','000003','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoQtdSem,cCpoHoras,cCpoValor,cCpoCC},{aTarefas[nLinha,1],aTarefas[nLinha,3],aTarefas[nLinha,4],aTarefas[nLinha,2],aTarefas[nLinha,5]})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','GRVTAREF','nLinha ++     .END.','000005','000002','.EXE.','5','nLinha ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0095    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0095( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','INFOCAL','CALCULO INFOCAL','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','INFOCAL','nVlInfoCal := 0     .CNT.','000001','000000','.EXE.','5','nVlInfoCal := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INFOCAL','SRA->RA_CATFUNC $ "H|D"   .END.','000002','000000','.CON.','5','','','5','SRA->RA_CATFUNC $ "H|D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INFOCAL','FO_SEEK(@&cObjeto, cCpoPD, FGETCODFOL("0032") )   .END.','000003','000002','.CON.','5','','','5','FO_SEEK(@&cObjeto, cCpoPD, FGETCODFOL("0032") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INFOCAL','nVlInfoCal := fo_GetVal(@&cObjeto,cCpoValor)     .END.','000004','000003','.EXE.','5','nVlInfoCal := fo_GetVal(@&cObjeto,cCpoValor)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','INFOCAL','nVlInfoCal > 0   .END.','000005','000002','.CON.','5','','','5','nVlInfoCal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','INFOCAL','Fo_Add(@&cObjeto,{ cCpoPd, cCpoValor},{ fGetCodFol("780"),','000006','000005','.EXE.','5','Fo_Add(@&cObjeto,{ cCpoPd, cCpoValor},{ fGetCodFol("780"),   (nVlInfoCal * 1 / 100 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0096    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0096( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LOCAGNAV','CALCULO AGUINALDO NAVIDAD','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','LOCAGNAV','ATEMPAGUI := {}     .CNT.','000001','000000','.EXE.','5','ATEMPAGUI := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','lok := YEAR(SRA->RA_ADMISSA) == YEAR(DDATADEM)   .END.','000002','000000','.CON.','5','','','5','lok := YEAR(SRA->RA_ADMISSA) == YEAR(DDATADEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','ATEMPAGUI := DATEDIFFYMD( SRA->RA_ADMISSA, DDATADEM + 1)','000003','000002','.EXE.','5','ATEMPAGUI := DATEDIFFYMD( SRA->RA_ADMISSA, DDATADEM + 1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','!LOK   .END.','000004','000000','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','ATEMPAGUI := DATEDIFFYMD( CTOD( "01/01/"+ StrZERO(Year(dData','000005','000004','.EXE.','5','ATEMPAGUI := DATEDIFFYMD( CTOD( "01/01/"+ StrZERO(Year(dDataDem), 4 ) ), DDATADEM + 1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','LEN(ATEMPAGUI) > 0   .END.','000006','000000','.CON.','5','','','5','LEN(ATEMPAGUI) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','nMesesAgui := ATEMPAGUI[2]     .CNT.','000007','000006','.EXE.','5','nMesesAgui := ATEMPAGUI[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','P_MESPARTI   .END.','000008','000006','.CON.','5','','','5','P_MESPARTI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','LOK .AND. ATEMPAGUI[3] <> 0   .END.','000009','000008','.CON.','5','','','5','LOK .AND. ATEMPAGUI[3] <> 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','NDIASAGUI := DIASTRAB     .END.','000010','000009','.EXE.','5','NDIASAGUI := DIASTRAB','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','!LOK   .END.','000011','000008','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','NDIASAGUI := ATEMPAGUI[3]     .END.','000012','000011','.EXE.','5','NDIASAGUI := ATEMPAGUI[3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','!P_MESPARTI   .END.','000013','000006','.CON.','5','','','5','!P_MESPARTI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAGNAV','nDiasAgui := ATEMPAGUI[3]     .END.','000014','000013','.EXE.','5','nDiasAgui := ATEMPAGUI[3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0097    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0097( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LOCAUSEN','PROC. AUSENCIAS LOCALIZADAS','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','LOCAUSEN','nValorSal := 0     .CNT.','000001','000000','.EXE.','5','nValorSal := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','fo_seek(@&cObjeto, cCpoPD, fGetCodFol("0040") )   .END.','000002','000000','.CON.','5','','','5','fo_seek(@&cObjeto, cCpoPD, fGetCodFol("0040") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nValorSal := fo_GetVal(@&cObjeto, cCpoValor)     .CNT.','000003','000002','.EXE.','5','nValorSal := fo_GetVal(@&cObjeto, cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nQtdDia := FO_GETVAL(@&COBJETO, CCPOHORAS)     .CNT.','000004','000002','.EXE.','5','nQtdDia := FO_GETVAL(@&COBJETO, CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nValorSal > 0   .END.','000005','000002','.CON.','5','','','5','nValorSal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','fo_SetVal(@&cObjeto, cCpoValor, (nValorSal * 10 ) / 100 )','000006','000005','.EXE.','5','fo_SetVal(@&cObjeto, cCpoValor, (nValorSal * 10 ) / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','fo_ADD(@&cObjeto, {cCpoPd, cCpoHoras, cCpoValor } , { fGetCo','000007','000005','.EXE.','5','fo_ADD(@&cObjeto, {cCpoPd, cCpoHoras, cCpoValor } , { fGetCodFol("0750"), nQtdDia, (nValorSal * 90 ) / 100 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','Fo_Seek(@&cObjeto,  cCpoPd,  fGetCodFol("0041" ) )   .END.','000008','000000','.CON.','5','','','5','Fo_Seek(@&cObjeto,  cCpoPd,  fGetCodFol("0041" ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nValorSal := fo_GetVal(@&cObjeto, cCpoValor)     .CNT.','000009','000008','.EXE.','5','nValorSal := fo_GetVal(@&cObjeto, cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nQtdDia := FO_GETVAL(@&COBJETO, CCPOHORAS)     .CNT.','000010','000008','.EXE.','5','nQtdDia := FO_GETVAL(@&COBJETO, CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nValorSal > 0   .END.','000011','000008','.CON.','5','','','5','nValorSal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','fo_SetVal(@&cObjeto, cCpoValor, (nValorSal * 25 ) / 100 )','000012','000011','.EXE.','5','fo_SetVal(@&cObjeto, cCpoValor, (nValorSal * 25 ) / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','fo_ADD(@&cObjeto, {cCpoPd, cCpoHoras, cCpoValor } , { fGetCo','000013','000011','.EXE.','5','fo_ADD(@&cObjeto, {cCpoPd, cCpoHoras, cCpoValor } , { fGetCodFol("0751"), nQtdDia, (nValorSal * 75 ) / 100 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','Fo_Seek(@&cObjeto,  cCpoPd,  fGetCodFol("0042" ) )   .END.','000014','000000','.CON.','5','','','5','Fo_Seek(@&cObjeto,  cCpoPd,  fGetCodFol("0042" ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nValorSal := fo_GetVal(@&cObjeto, cCpoValor)     .CNT.','000015','000014','.EXE.','5','nValorSal := fo_GetVal(@&cObjeto, cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nQtdDia := FO_GETVAL(@&COBJETO, CCPOHORAS)     .CNT.','000016','000014','.EXE.','5','nQtdDia := FO_GETVAL(@&COBJETO, CCPOHORAS)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','nValorSal > 0   .END.','000017','000014','.CON.','5','','','5','nValorSal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','fo_SetVal(@&cObjeto, cCpoValor, (nValorSal * 10 ) / 100 )','000018','000017','.EXE.','5','fo_SetVal(@&cObjeto, cCpoValor, (nValorSal * 10 ) / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCAUSEN','fo_ADD(@&cObjeto, {cCpoPd, cCpoHoras, cCpoValor } , { fGetCo','000019','000017','.EXE.','5','fo_ADD(@&cObjeto, {cCpoPd, cCpoHoras, cCpoValor } , { fGetCodFol("0752"), nQtdDia, (nValorSal * 90 ) / 100 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0098    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0098( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LOCDIASV','CALCULO DIAS VACACIONES','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','LOCDIASV','aIncRes[2] == "S"   .END.','000001','000000','.CON.','5','','','5','aIncRes[2] == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','cVerb := FGETCODFOL("0072")     .CNT.','000002','000001','.EXE.','5','cVerb := FGETCODFOL("0072")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDFerAve := 0     .CNT.','000003','000001','.EXE.','5','nDFerAve := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDFerVen := 0     .CNT.','000004','000001','.EXE.','5','nDFerVen := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nFator := 0     .CNT.','000005','000001','.EXE.','5','nFator := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','FO_NEW(@OSRF , "SRF" , 2 , SRA->RA_FILIAL + SRA->RA_MAT + cV','000006','000001','.EXE.','5','FO_NEW(@OSRF , "SRF" , 2 , SRA->RA_FILIAL + SRA->RA_MAT + cVerb, "SRF->RF_STATUS = '+"'"+'1'+"'"+'" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','!FO_EOF(@OSRF)   .END.','000007','000001','.ENQ.','5','','','5','!FO_EOF(@OSRF)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','NDFERVEN := IF (VALTYPE(FO_GETVAL(@OSRF, "RF_DFERVAT")) = "U','000008','000007','.EXE.','5','NDFERVEN := IF (VALTYPE(FO_GETVAL(@OSRF, "RF_DFERVAT")) = "U", 0, FO_GETVAL(@OSRF, "RF_DFERVAT")) +NDFERVEN','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','NDFERAVE :=IF (VALTYPE( FO_GETVAL(@OSRF , "RF_DFERAAT" ) ) =','000009','000007','.EXE.','5','NDFERAVE :=IF (VALTYPE( FO_GETVAL(@OSRF , "RF_DFERAAT" ) ) = "U", 0, FO_GETVAL(@OSRF, "RF_DFERAAT") ) + nDFerAve','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDiasAnt := IF (VALTYPE(FO_GETVAL(@OSRF,"RF_DFERANT")) = "U"','000010','000007','.EXE.','5','nDiasAnt := IF (VALTYPE(FO_GETVAL(@OSRF,"RF_DFERANT")) = "U",  0 , FO_GETVAL(@OSRF, "RF_DFERANT")) + nDiasAnt','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nFator := IF (VALTYPE(FO_GETVAL(@OSRF, "RF_DIASDIR" ) ) = "U','000011','000007','.EXE.','5','nFator := IF (VALTYPE(FO_GETVAL(@OSRF, "RF_DIASDIR" ) ) = "U", 0, FO_GETVAL(@OSRF, "RF_DIASDIR" ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','FO_SKIP(@OSRF)     .END.','000012','000007','.EXE.','5','FO_SKIP(@OSRF)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDiasAnt > 0   .END.','000013','000001','.CON.','5','','','5','nDiasAnt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDFerVen >= nDiasAnt   .END.','000014','000013','.CON.','5','','','5','nDFerVen >= nDiasAnt','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDferven := nDferven - nDiasAnt     .END.','000015','000014','.EXE.','5','nDferven := nDferven - nDiasAnt','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','NBASEINDE > 0   .END.','000016','000001','.CON.','5','','','5','NBASEINDE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','NDFERIND := nDFerVen / nFator     .CNT.','000017','000016','.EXE.','5','NDFERIND := nDFerVen / nFator','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDFerAve > 0   .END.','000018','000016','.CON.','5','','','5','nDFerAve > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nMesInt := Int(nDFerAve / nFator)     .CNT.','000019','000018','.EXE.','5','nMesInt := Int(nDFerAve / nFator)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nMesInt > 0   .END.','000020','000018','.CON.','5','','','5','nMesInt > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDFerInd := nDFerInd + nMesInt     .END.','000021','000020','.EXE.','5','nDFerInd := nDFerInd + nMesInt','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','(nDFerAve / Fator) > Int(nDFerAve / Fator)   .END.','000022','000018','.CON.','5','','','5','(nDFerAve / Fator) > Int(nDFerAve / Fator)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCDIASV','nDFerIndPro := Round((nDFerAve / Fator) - Int(nDFerAve/Fator','000023','000022','.EXE.','5','nDFerIndPro := Round((nDFerAve / Fator) - Int(nDFerAve/Fator) * 30 , 0 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0099    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0099( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LOCFATVA','FACTOR DE DIAS VACACIONES','NFATOR','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','LOCFATVA','nAnosTrab := 0     .CNT.','000001','000000','.EXE.','5','nAnosTrab := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCFATVA','nAux := 0     .CNT.','000002','000000','.EXE.','5','nAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCFATVA','nFator := 0     .CNT.','000003','000000','.EXE.','5','nFator := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCFATVA','nAnosTrab := DateDiffYear( SRA->RA_ADMISSA, dDatadem)     .C','000004','000000','.EXE.','5','nAnosTrab := DateDiffYear( SRA->RA_ADMISSA, dDatadem)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCFATVA','SRA->RA_MESESAN > 0   .END.','000005','000000','.CON.','5','','','5','SRA->RA_MESESAN > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCFATVA','nAnosTrab += SRA->RA_MESESAN /12     .END.','000006','000005','.EXE.','5','nAnosTrab += SRA->RA_MESESAN /12','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCFATVA','nAnosTrab := NoRound( nAnosTrab, 0)     .CNT.','000007','000000','.EXE.','5','nAnosTrab := NoRound( nAnosTrab, 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCFATVA','nAUX := FPOSTAB("S006", nAnosTrab ,"<=", 5 )     .CNT.','000008','000000','.EXE.','5','nAUX := FPOSTAB("S006", nAnosTrab ,"<=", 5 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCFATVA','fTabela("S006", nAux ,  7 )     .END.','000009','000000','.EXE.','5','fTabela("S006", nAux ,  7 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0100    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0100( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LOCINDEN','CALCULO INDENIZACION LOCALIZAD','','','056','2','1',} )

aAdd(aRc3Cols, { '','S_','LOCINDEN','aTempServ := {}     .CNT.','000001','000000','.EXE.','5','aTempServ := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aTempServ := DateDiffYMD(SRA->RA_ADMISSA, dDataDem + 1)','000002','000000','.EXE.','5','aTempServ := DateDiffYMD(SRA->RA_ADMISSA, dDataDem + 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nDiasInde := 0     .CNT.','000003','000000','.EXE.','5','nDiasInde := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseMes := 0     .CNT.','000004','000000','.EXE.','5','nBaseMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nHorasMes := 0     .CNT.','000005','000000','.EXE.','5','nHorasMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aDataInd := {}     .CNT.','000006','000000','.EXE.','5','aDataInd := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aPerFechado  := {}     .CNT.','000007','000000','.EXE.','5','aPerFechado  := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aPerAberto := {}     .CNT.','000008','000000','.EXE.','5','aPerAberto := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aVerbasFunc := {}     .CNT.','000009','000000','.EXE.','5','aVerbasFunc := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseInde := 0     .CNT.','000010','000000','.EXE.','5','nBaseInde := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','NULTDIA := 0     .END.','000011','000000','.EXE.','5','NULTDIA := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','Len(aTempServ ) > 0   .END.','000012','000000','.CON.','5','','','5','Len(aTempServ ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nAnos := aTempServ[1]     .CNT.','000013','000012','.EXE.','5','nAnos := aTempServ[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nMeses := aTempServ[2]     .CNT.','000014','000012','.EXE.','5','nMeses := aTempServ[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','P_MESPARTI   .END.','000015','000012','.CON.','5','','','5','P_MESPARTI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','LOK := (NANOS = 0 .AND. NDIAS = 0)   .END.','000016','000015','.CON.','5','','','5','LOK := (NANOS = 0 .AND. NDIAS = 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','NDIAS := DIASTRAB     .END.','000017','000016','.EXE.','5','NDIAS := DIASTRAB','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','!LOK   .END.','000018','000015','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','NDIAS := ATEMPSERV[3]     .END.','000019','000018','.EXE.','5','NDIAS := ATEMPSERV[3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','!P_MESPARTI   .END.','000020','000012','.CON.','5','','','5','!P_MESPARTI','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','NDIAS := ATEMPSERV[3]     .END.','000021','000020','.EXE.','5','NDIAS := ATEMPSERV[3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','Month(dDataAte) == Month(dDatadem)   .END.','000022','000012','.CON.','5','','','5','Month(dDataAte) == Month(dDatadem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cMes :=   STRZero(Month(dDataDem),2)     .CNT.','000023','000022','.EXE.','5','cMes :=   STRZero(Month(dDataDem),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cAno := STRZero(Year(dDataDem),4)     .CNT.','000024','000022','.EXE.','5','cAno := STRZero(Year(dDataDem),4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nDiasInde :=  (dDataDem - dDataIni)     .END.','000025','000022','.EXE.','5','nDiasInde :=  (dDataDem - dDataIni)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','Month(dDataAte) <> Month(dDataDem)   .END.','000026','000012','.CON.','5','','','5','Month(dDataAte) <> Month(dDataDem)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cMes := STRZero(Month(dDataAte),2)     .CNT.','000027','000026','.EXE.','5','cMes := STRZero(Month(dDataAte),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cAno := STRZero(Year(dDataAte),4)     .CNT.','000028','000026','.EXE.','5','cAno := STRZero(Year(dDataAte),4)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nDiasInde := (dDataDem - dDataDe)     .END.','000029','000026','.EXE.','5','nDiasInde := (dDataDem - dDataDe)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cDia := STRZero(Day( dDataDem), 2 )     .CNT.','000030','000012','.EXE.','5','cDia := STRZero(Day( dDataDem), 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nDiasInde > 0   .END.','000031','000012','.CON.','5','','','5','nDiasInde > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','Aadd( aDataInd, { StrZero(Year(dDataAte), 4 ) , StrZero( Mon','000032','000031','.EXE.','5','Aadd( aDataInd, { StrZero(Year(dDataAte), 4 ) , StrZero( Month( dDataAte), 2 ), nDiasInde, 0 ,0 } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nDiasInde := 30     .CNT.','000033','000012','.EXE.','5','nDiasInde := 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','lMes := .t.     .CNT.','000034','000012','.EXE.','5','lMes := .t.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nDiasInde <=  90 .And. (cAno+cMes) >= AnoMes(SRA->RA_ADMIS','000035','000012','.ENQ.','5','','','5','nDiasInde <=  90 .And. (cAno+cMes) >= AnoMes(SRA->RA_ADMISSA)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cMes == '+"'"+'01'+"'"+'   .END.','000036','000035','.CON.','5','','','5','cMes == '+"'"+'01'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cMes 	:= '+"'"+'12'+"'"+'     .CNT.','000037','000036','.EXE.','5','cMes 	:= '+"'"+'12'+"'"+'','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','lMes := .f.     .CNT.','000038','000036','.EXE.','5','lMes := .f.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cAno := Tira1(cAno)     .END.','000039','000036','.EXE.','5','cAno := Tira1(cAno)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cMes <> '+"'"+'01'+"'"+'   .and. lMes   .END.','000040','000035','.CON.','5','','','5','cMes <> '+"'"+'01'+"'"+'   .and. lMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','cMes	:= Tira1(cMes)     .END.','000041','000040','.EXE.','5','cMes	:= Tira1(cMes)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nDiasInde += 30     .CNT.','000042','000035','.EXE.','5','nDiasInde += 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','Aadd( aDataInd , {cAno, cMes , If(nDiasInde < 90, 30, 30 - (','000043','000035','.EXE.','5','Aadd( aDataInd , {cAno, cMes , If(nDiasInde <= 90, 30,  (nDiasInde - 90) ),  0, 0 } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','lMes := .t.     .END.','000044','000035','.EXE.','5','lMes := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','Len(aDataInd) > 0   .END.','000045','000012','.CON.','5','','','5','Len(aDataInd) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aSort( aDataInd ,,, { |x,y| x[1]+x[2] < y[1]+y[2] } )     .C','000046','000045','.EXE.','5','aSort( aDataInd ,,, { |x,y| x[1]+x[2] < y[1]+y[2] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nCont := 1     .CNT.','000047','000045','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nAux := Len(aDataInd)     .CNT.','000048','000045','.EXE.','5','nAux := Len(aDataInd)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nCont  <= nAux   .END.','000049','000045','.ENQ.','5','','','5','nCont  <= nAux','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aVerbasFunc := {}     .CNT.','000050','000049','.EXE.','5','aVerbasFunc := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','fRetPerComp( aDataInd[nCont,2], aDataInd[nCont,1] , Nil, Nil','000051','000049','.EXE.','5','fRetPerComp( aDataInd[nCont,2], aDataInd[nCont,1] , Nil, Nil, Nil, @aPerAberto, @aPerFechado)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aVerbasFunc := RetornaVerbasFunc(SRA->RA_FILIAL, SRA->RA_MAT','000052','000049','.EXE.','5','aVerbasFunc := RetornaVerbasFunc(SRA->RA_FILIAL, SRA->RA_MAT, NIL, "FOL", NIL, APERABERTO, APERFECHADO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','LEN(AVERBASFUNC ) > 0 .AND.  ADATAIND[NCONT,2] <>STRZERO(M','000053','000049','.CON.','5','','','5','LEN(AVERBASFUNC ) > 0 .AND.  ADATAIND[NCONT,2] <>STRZERO(MONTH(DDATAAte),2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aSort( aVerbasFunc ,,, { |x,y| x[1] + x[2] + x[3] + x[15] <','000054','000053','.EXE.','5','aSort( aVerbasFunc ,,, { |x,y| x[1] + x[2] + x[3] + x[15] < y[1] + y[2] + y[3] + y[15] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nCont2 := 1     .CNT.','000055','000053','.EXE.','5','nCont2 := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nCont2 <= Len(aVerbasFunc)   .END.','000056','000053','.ENQ.','5','','','5','nCont2 <= Len(aVerbasFunc)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','PosSrv(aVerbasFunc[nCont2, 3],SRA->RA_FILIAL,"RV_INDEN") =','000057','000056','.CON.','5','','','5','PosSrv(aVerbasFunc[nCont2, 3],SRA->RA_FILIAL,"RV_INDEN") == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseMes += aVerbasFunc[nCont2, 7] * If(PosSrv(aVerbasFunc[n','000058','000057','.EXE.','5','nBaseMes += aVerbasFunc[nCont2, 7] * If(PosSrv(aVerbasFunc[nCont2, 3] , aVerbasFunc[nCont2,1]  , "RV_TIPOCOD") == "1", 1, IF(PosSrv(aVerbasFunc[nCont2, 3] , aVerbasFunc[nCont2,1], "RV_TIPOCOD") == "2",-1,0 ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nHorasMes += aVerbasFunc[nCont2, 6] * If(PosSrv(aVerbasFunc[','000059','000057','.EXE.','5','nHorasMes += aVerbasFunc[nCont2, 6] * If(PosSrv(aVerbasFunc[nCont2, 3] , aVerbasFunc[nCont2,1]  , "RV_TIPOCOD") == "1", 1, IF(PosSrv(aVerbasFunc[nCont2, 3] , aVerbasFunc[nCont2,1], "RV_TIPOCOD") == "2", -1, 0 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nCont2 += 1     .END.','000060','000056','.EXE.','5','nCont2 += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aDataInd[nCont, 4] := nHorasMes     .CNT.','000061','000053','.EXE.','5','aDataInd[nCont, 4] := nHorasMes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aDataInd[nCont, 5]  := (nBaseMes / 30 * aDataInd[nCont,3] )','000062','000053','.EXE.','5','aDataInd[nCont, 5]  := (nBaseMes / 30 * aDataInd[nCont,3] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseInde += (nBaseMes / 30  * aDataInd[nCont, 3 ] )     .CN','000063','000053','.EXE.','5','nBaseInde += (nBaseMes / 30  * aDataInd[nCont, 3 ] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nHorasMes := 0     .CNT.','000064','000053','.EXE.','5','nHorasMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseMes := 0     .END.','000065','000053','.EXE.','5','nBaseMes := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nCont == nAux .And. Len(aPerAberto) > 0 .AND.  ADATAIND[NC','000066','000049','.CON.','5','','','5','nCont == nAux .And. Len(aPerAberto) > 0 .AND.  ADATAIND[NCONT,2] <>STRZERO(MONTH(DDATADEM),2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseMes := fo_SomaIncSrv(@&cObjeto, cCpoValor, "RV_INDEN" ,','000067','000066','.EXE.','5','nBaseMes := fo_SomaIncSrv(@&cObjeto, cCpoValor, "RV_INDEN" , "1" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nHorasMes := fo_SomaIncSrv(@&cObjeto, cCpoHoras,  "RV_INDEN"','000068','000066','.EXE.','5','nHorasMes := fo_SomaIncSrv(@&cObjeto, cCpoHoras,  "RV_INDEN", "1" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aDataInd[nCont, 4] := nHorasMes     .CNT.','000069','000066','.EXE.','5','aDataInd[nCont, 4] := nHorasMes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','aDataInd[nCont, 5]  := nBaseMes     .CNT.','000070','000066','.EXE.','5','aDataInd[nCont, 5]  := nBaseMes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseInde += (nBaseMes / 30  * aDataInd[nCont, 3 ] )     .CN','000071','000066','.EXE.','5','nBaseInde += (nBaseMes / 30  * aDataInd[nCont, 3 ] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nHorasMes := 0     .CNT.','000072','000066','.EXE.','5','nHorasMes := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseMes := 0     .END.','000073','000066','.EXE.','5','nBaseMes := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nCont += 1     .END.','000074','000049','.EXE.','5','nCont += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCINDEN','nBaseInde := nBaseInde / 3     .END.','000075','000012','.EXE.','5','nBaseInde := nBaseInde / 3','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0101    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0101( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LOCPREAV','PRE AVISO LOCALIZADO','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','LOCPREAV','NMESES := 0     .CNT.','000001','000000','.EXE.','5','NMESES := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','nDiasAv := 0     .CNT.','000002','000000','.EXE.','5','nDiasAv := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','NMESES := ( YEAR(DDATADEM) - YEAR(SRA->RA_ADMISSA) ) * 12','000003','000000','.EXE.','5','NMESES := ( YEAR(DDATADEM) - YEAR(SRA->RA_ADMISSA) ) * 12','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','NMESES += ( MONTH(DDATADEM) - MONTH(SRA->RA_ADMISSA) )     .','000004','000000','.EXE.','5','NMESES += ( MONTH(DDATADEM) - MONTH(SRA->RA_ADMISSA) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','nMeses <= 3   .END.','000005','000000','.CON.','5','','','5','nMeses <= 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','nDiasAv := 30     .END.','000006','000005','.EXE.','5','nDiasAv := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','nMeses > 3   .END.','000007','000000','.CON.','5','','','5','nMeses > 3','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','nDiasAv := 90     .END.','000008','000007','.EXE.','5','nDiasAv := 90','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','FGETCODFOL("111")  <>  "   "  .AND.  NDIASAV > 0   .END.','000009','000000','.CON.','5','','','5','FGETCODFOL("111")  <>  "   "  .AND.  NDIASAV > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','NVALAV := SALMES  /  30  *  NDIASAV     .END.','000010','000009','.EXE.','5','NVALAV := SALMES  /  30  *  NDIASAV','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','! FO_SEEK(@&COBJETO,CCPOPD,FGETCODFOL("0111"))   .END.','000011','000000','.CON.','5','','','5','! FO_SEEK(@&COBJETO,CCPOPD,FGETCODFOL("0111"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCPREAV','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS },{FGETCODFOL','000012','000011','.EXE.','5','FO_ADD(@&COBJETO,{CCPOPD, CCPOVALOR, CCPOHORAS },{FGETCODFOL("0111"), ROUND(NVALAV, MSDECIMAIS(1) ), NDIASAV } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0102    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0102( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','LOCVACFI','CALCULO VACACIONES FINIQUITO','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','LOCVACFI','aIncRes[02] == '+"'"+'S'+"'"+'   .END.','000001','000000','.CON.','5','','','5','aIncRes[02] == '+"'"+'S'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCVACFI','GetMemVar( "RG_DFERVEN" ) > 0   .END.','000002','000001','.CON.','5','','','5','GetMemVar( "RG_DFERVEN" ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCVACFI','NDFERIND := GETMEMVAR("RG_DFERVEN")     .CNT.','000003','000002','.EXE.','5','NDFERIND := GETMEMVAR("RG_DFERVEN")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCVACFI','NVLVACVEN := round((NBASEINDE / 30 ) * NDFERIND , 2)     .EN','000004','000002','.EXE.','5','NVLVACVEN := round((NBASEINDE / 30 ) * NDFERIND , 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCVACFI','GETMEMVAR("RG_DFERPRO")  > 0   .END.','000005','000001','.CON.','5','','','5','GETMEMVAR("RG_DFERPRO")  > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','LOCVACFI','NDFERAVE := GETMEMVAR("RG_DFERPRO")     .CNT.','000006','000005','.EXE.','5','NDFERAVE := GETMEMVAR("RG_DFERPRO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','LOCVACFI','NVLVACPR :=  round ((NBASEINDE / 30 ) * NDFERAVE , 2)     .E','000007','000005','.EXE.','5','NVLVACPR :=  round ((NBASEINDE / 30 ) * NDFERAVE , 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0103    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0103( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','MEDCOMIS','CALCULA MEDIA DE COMISSAO','','001063','035','2','1',} )

aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := 0     .CNT.','000001','000000','.EXE.','5','nValor := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','Type("nMesMedDoe") = "U" .OR.','000002','000000','.CON.','5','','','5','Type("nMesMedDoe")','=','5','"U"','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','Type("nMesMedAci") = "U" .OR.','000003','000000','.CON.','5','','','5','Type("nMesMedAci")','=','5','"U"','.OR.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','Type("nMesMedMat") = "U" .END.','000004','000000','.CON.','5','','','5','Type("nMesMedMat")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMesMedDoe := nMesMedAci := nMesMedMat := 0     .END.','000005','000004','.EXE.','5','nMesMedDoe := nMesMedAci := nMesMedMat := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nDiasAfas > 0 .END.','000006','000000','.CON.','5','','','5','nDiasAfas','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMesMedDoe > 0 .END.','000007','000006','.CON.','5','','','5','nMesMedDoe','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fCMComiss(,@nMedComiss,nMesMedDoe)     .CNT.','000008','000007','.EXE.','5','fCMComiss(,@nMedComiss,nMesMedDoe)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := (nMedComiss / 30 * nDiasAfas)     .CNT.','000009','000007','.EXE.','5','nValor := (nMedComiss / 30 * nDiasAfas)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor>0   .END.','000010','000007','.CON.','5','','','5','nValor>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras},','000011','000010','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras}, {fGetCodFol("0407"), "V", nValor, nDiasAfas})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMesMedAci > 0 .END.','000012','000006','.CON.','5','','','5','nMesMedAci','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fCMComiss(,@nMedComiss,nMesMedAci)     .CNT.','000013','000012','.EXE.','5','fCMComiss(,@nMedComiss,nMesMedAci)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := nValor + (nMedComiss / 30 * nDiasAfas)   .CNT.','000014','000012','.EXE.','5','nValor',':=','5','nValor + (nMedComiss / 30 * nDiasAfas)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor>0   .END.','000015','000012','.CON.','5','','','5','nValor>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras},','000016','000015','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras}, {fGetCodFol("0407"), "V", nValor, nDiasAfas})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','(nMesMedMat > 0) .And. ( SRA->RA_CATFUNC $ "C*T" )   .END.','000017','000006','.CON.','5','','','5','(nMesMedMat > 0) .And. ( SRA->RA_CATFUNC $ "C*T" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fCMComiss(,@nMedComiss,nMesMedMat)     .CNT.','000018','000017','.EXE.','5','fCMComiss(,@nMedComiss,nMesMedMat)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := nValor + (nMedComiss / 30 * nDiasAfas)   .CNT.','000019','000017','.EXE.','5','nValor',':=','5','nValor + (nMedComiss / 30 * nDiasAfas)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor>0   .END.','000020','000017','.CON.','5','','','5','nValor>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras},','000021','000020','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras}, {fGetCodFol("0407"), "V", nValor, nDiasAfas})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Seek(@&cObjeto, cCpoPD, fGetCodFol("0040"))   .AND.','000022','000006','.CON.','5','','','5','fo_Seek(@&cObjeto, cCpoPD, fGetCodFol("0040"))','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','!( SRA->RA_CATFUNC $ "C*T" )   .AND.','000023','000006','.CON.','5','','','5','!( SRA->RA_CATFUNC $ "C*T" )','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','!fo_Seek(@&cObjeto, cCpoPD, fGetCodFol("0407"))   .END.','000024','000006','.CON.','5','','','5','!fo_Seek(@&cObjeto, cCpoPD, fGetCodFol("0407"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fCMComiss(,@nMedComiss,If(nMesMedMat==0,6,nMesMedMat), { ||','000025','000024','.EXE.','5','fCMComiss(,@nMedComiss,If(nMesMedMat==0,6,nMesMedMat), { || "S" $ RV_MEDFER .Or. Val(RV_MEDFER) > 0 })','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor := nValor + (nMedComiss / 30 * nDiasAfas)   .CNT.','000026','000024','.EXE.','5','nValor',':=','5','nValor + (nMedComiss / 30 * nDiasAfas)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nValor>0   .END.','000027','000024','.CON.','5','','','5','nValor>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras},','000028','000027','.EXE.','5','fo_Add(@&cObjeto, {cCpoPD, cCpoTipo1, cCpoValor, cCpoHoras}, {fGetCodFol("0407"), "V", nValor, nDiasAfas})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nDiasFgts > 0 .END.','000029','000000','.CON.','5','','','5','nDiasFgts','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nAfasFgts := SalDia * nDiasFgts   .CNT.','000030','000029','.EXE.','5','nAfasFgts',':=','5','SalDia * nDiasFgts','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','SRA->RA_CATFUNC == "C" .END.','000031','000029','.CON.','5','','','5','SRA->RA_CATFUNC','==','5','"C"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','(nDiasAfas - nDiasFgts) > 0 .END.','000032','000031','.CON.','5','','','5','(nDiasAfas - nDiasFgts)','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMedComiss += nMedComiss / 30 * ( nDiasAfas - nDiasFgts)   .','000033','000032','.EXE.','5','nMedComiss','+=','5','nMedComiss / 30 * ( nDiasAfas - nDiasFgts)','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','!((nDiasAfas - nDiasFgts) > 0)   .END.','000034','000031','.CON.','5','','','5','!((nDiasAfas - nDiasFgts) > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nMedComiss += nMedComiss / 30 * nDiasFgts   .END.','000035','000034','.EXE.','5','nMedComiss','+=','5','nMedComiss / 30 * nDiasFgts','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDCOMIS','nAfasFgts += nMedComiss   .END.','000036','000031','.EXE.','5','nAfasFgts','+=','5','nMedComiss','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0104    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0104( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','MEDIAS13','CALCULO DA MEDIA 13º','','','050','2','1',} )

aAdd(aRc3Cols, { '','S_','MEDIAS13','nMedia := 0     .CNT.','000001','000000','.EXE.','5','nMedia := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nPerc13 := if(cTipoRot = "6", 1, (aPergunte[1,3]/100))     .','000002','000000','.EXE.','5','nPerc13 := if(cTipoRot = "6", 1, (aPergunte[1,3]/100))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','GPEXMED("","",dDataRef,"",dDataRef,SalHora,Val_Salmin,aCod','000003','000000','.CON.','5','','','5','GPEXMED("","",dDataRef,"",dDataRef,SalHora,Val_Salmin,aCodfol, .T. )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','(cTipoRot = "5" .and. aPergunte[2, 3] == 2) .or. cTipoRot','000004','000003','.CON.','5','','','5','(cTipoRot = "5" .and. aPergunte[2, 3] == 2) .or. cTipoRot = "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"998"+"9998','000005','000004','.CON.','5','','','5','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"998"+"9998")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cCampo := "TRP->RP_HORAS"   .CNT.','000006','000005','.EXE.','5','cCampo',':=','5','"TRP->RP_HORAS"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nAvosFal13 := &cCampo   .END.','000007','000005','.EXE.','5','nAvosFal13',':=','5','&cCampo','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','S_AVOS13()     .CNT.','000008','000004','.EXE.','5','S_AVOS13()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cCondicao := "!Empty(fGetCodFol('+"'"+'0123'+"'"+')) " + if(cTipoRot = "','000009','000004','.EXE.','5','cCondicao := "!Empty(fGetCodFol('+"'"+'0123'+"'"+')) " + if(cTipoRot = "6", ".And. !Empty(fGetCodFol('+"'"+'0124'+"'"+'))", "")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nMedia += nMedPer     .END.','000010','000009','.EXE.','5','nMedia += nMedPer','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','&cCondicao   .END.','000011','000004','.CON.','5','','','5','&cCondicao','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cCampo := "TRP->RP_VALATU"   .CNT.','000012','000011','.EXE.','5','cCampo',':=','5','"TRP->RP_VALATU"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','P_MEDDIRE = "N"   .END.','000013','000011','.CON.','5','','','5','P_MEDDIRE = "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+ if(c','000014','000013','.CON.','5','','','5','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+ if(cTipoRot = "5", "9999", "9799"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Add(@&cObjeto, {cCpoPd, cCpovalor}, {fGetCodFol("0123"),','000015','000014','.EXE.','5','fo_Add(@&cObjeto, {cCpoPd, cCpovalor}, {fGetCodFol("0123"), round(((&cCampo * nAvos/12) * nPerc13),2)}, cCpoPd, fGetCodFol("0123"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nMedia += round(((&cCampo * nAvos/12) * nPerc13),2)     .END','000016','000014','.EXE.','5','nMedia += round(((&cCampo * nAvos/12) * nPerc13),2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cTipoRot = "6"   .END.','000017','000013','.CON.','5','','','5','cTipoRot = "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"9899','000018','000017','.CON.','5','','','5','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"9899")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Add(@&cObjeto, {cCpoPd, cCpovalor}, {fGetCodFol("0124"),','000019','000018','.EXE.','5','fo_Add(@&cObjeto, {cCpoPd, cCpovalor}, {fGetCodFol("0124"), round(((&cCampo * nAvos/12) * nPerc13),2)}, cCpoPd, fGetCodFol("0124"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nMedia += round(((&cCampo * nAvos/12) * nPerc13),2)     .END','000020','000018','.EXE.','5','nMedia += round(((&cCampo * nAvos/12) * nPerc13),2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','P_MEDDIRE <> "N"   .END.','000021','000011','.CON.','5','','','5','P_MEDDIRE <> "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+if(cT','000022','000021','.CON.','5','','','5','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+if(cTipoRot= "5", "99MD", "97MD"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Add(@&cObjeto, {cCpoPd, cCpovalor}, {fGetCodFol("0123"),','000023','000022','.EXE.','5','fo_Add(@&cObjeto, {cCpoPd, cCpovalor}, {fGetCodFol("0123"), round(&cCampo * nPerc13 ,2)}, cCpoPd, fGetCodFol("0123"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nMedia += round(&cCampo * nPerc13 ,2)     .END.','000024','000022','.EXE.','5','nMedia += round(&cCampo * nPerc13 ,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cTipoRot = "6"   .END.','000025','000021','.CON.','5','','','5','cTipoRot = "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"98MD','000026','000025','.CON.','5','','','5','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"999"+"98MD")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Add(@&cObjeto, {cCpoPd, cCpovalor}, {fGetCodFol("0124"),','000027','000026','.EXE.','5','fo_Add(@&cObjeto, {cCpoPd, cCpovalor}, {fGetCodFol("0124"), round(&cCampo * nPerc13 ,2)}, cCpoPd, fGetCodFol("0124"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nMedia += round(&cCampo * nPerc13 ,2)     .END.','000028','000026','.EXE.','5','nMedia += round(&cCampo * nPerc13 ,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','!&cCondicao   .END.','000029','000004','.CON.','5','','','5','!&cCondicao','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cAlias := "TRP"   .CNT.','000030','000029','.EXE.','5','cAlias',':=','5','"TRP"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cChave := "TRP->RP_FILIAL+TRP->RP_MAT"     .CNT.','000031','000029','.EXE.','5','cChave := "TRP->RP_FILIAL+TRP->RP_MAT"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cDtArqCpo := "TRP->RP_DATARQ"     .CNT.','000032','000029','.EXE.','5','cDtArqCpo := "TRP->RP_DATARQ"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cPdCpo := "TRP->RP_PD"     .CNT.','000033','000029','.EXE.','5','cPdCpo := "TRP->RP_PD"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cTipoCpo := "TRP->RP_TIPO"     .CNT.','000034','000029','.EXE.','5','cTipoCpo := "TRP->RP_TIPO"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cCampo := "TRP->RP_VALATU"   .CNT.','000035','000029','.EXE.','5','cCampo',':=','5','"TRP->RP_VALATU"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cCpoHor1 := "TRP->RP_HORAS"     .CNT.','000036','000029','.EXE.','5','cCpoHor1 := "TRP->RP_HORAS"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3")   .END.','000037','000029','.CON.','5','','','5','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','! &(cAlias + "->(Eof())") .And. SRA->RA_FILIAL+SRA->RA_MAT','000038','000037','.ENQ.','5','','','5','! &(cAlias + "->(Eof())") .And. SRA->RA_FILIAL+SRA->RA_MAT = &cChave','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','!(&cPdCpo = "999" .OR. &cTipoCpo # "3" .OR. !&cDtArqCpo $','000039','000038','.CON.','5','','','5','!(&cPdCpo = "999" .OR. &cTipoCpo # "3" .OR. !&cDtArqCpo $ "9999  ")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','P_MEDDIRE = "N"   .END.','000040','000039','.CON.','5','','','5','P_MEDDIRE = "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Add(@&cObjeto, {cCpoPd,cCpoHoras,cCpovalor}, {&cPdCpo,&cC','000041','000040','.EXE.','5','fo_Add(@&cObjeto, {cCpoPd,cCpoHoras,cCpovalor}, {&cPdCpo,&cCpoHor1, round((&cCampo * nAvos/12) * nPerc13 ,2)}, cCpoPd, fGetCodFol("0123"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nMedia += round((&cCampo * nAvos/12) * nPerc13 ,2)     .END.','000042','000040','.EXE.','5','nMedia += round((&cCampo * nAvos/12) * nPerc13 ,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','P_MEDDIRE <> "N"   .END.','000043','000039','.CON.','5','','','5','P_MEDDIRE <> "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Add(@&cObjeto, {cCpoPd,cCpoHoras, cCpovalor}, {&cPdCpo,&c','000044','000043','.EXE.','5','fo_Add(@&cObjeto, {cCpoPd,cCpoHoras, cCpovalor}, {&cPdCpo,&cCpoHor1, round(&cCampo * nPerc13 ,2)}, cCpoPd, fGetCodFol("0123"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nMedia += round(&cCampo * nPerc13 ,2)     .END.','000045','000043','.EXE.','5','nMedia += round(&cCampo * nPerc13 ,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','&(cAlias + "->(dbSkip())")     .END.','000046','000038','.EXE.','5','&(cAlias + "->(dbSkip())")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"997"+"9598','000047','000003','.CON.','5','','','5','fPosReg("TRP",1,SRA->RA_FILIAL+SRA->RA_MAT+"3"+"997"+"9598")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cCampo := "TRP->RP_VALATU"     .CNT.','000048','000047','.EXE.','5','cCampo := "TRP->RP_VALATU"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nAntec13 := &cCampo   .CNT.','000049','000047','.EXE.','5','nAntec13',':=','5','&cCampo','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','cTipoRot = "6"   .END.','000050','000047','.CON.','5','','','5','cTipoRot = "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Add(@&cObjeto, {cCpoPd, cCpoValor} , { fGetCodFol("0183")','000051','000050','.EXE.','5','fo_Add(@&cObjeto, {cCpoPd, cCpoValor} , { fGetCodFol("0183"),nAntec13 })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_New(@oSRR, "SRR", 1, SRA->RA_FILIAL+SRA->RA_MAT)     .CNT','000052','000052','.EXE.','5','fo_New(@oSRR, "SRR", 1, SRA->RA_FILIAL+SRA->RA_MAT)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','!fo_Eof(@oSRH)   .END.','000053','000052','.ENQ.','5','','','5','!fo_Eof(@oSRH)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','MesAno(fo_GetVal(@oSRH, "RH_DATAINI"))== cAnoMes   .END.','000054','000053','.CON.','5','','','5','MesAno(fo_GetVal(@oSRH, "RH_DATAINI"))== cAnoMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','dDtBusFer := fo_GetVal(@oSRH, "RH_DTRECIB")     .CNT.','000055','000054','.EXE.','5','dDtBusFer := fo_GetVal(@oSRH, "RH_DTRECIB")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_GoTop(@oSRR)     .CNT.','000056','000054','.EXE.','5','fo_GoTop(@oSRR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Seek(@oSRR, {"RR_TIPO3", "RR_DATA"}, {"F", dDtBusFer})','000057','000054','.CON.','5','','','5','fo_Seek(@oSRR, {"RR_TIPO3", "RR_DATA"}, {"F", dDtBusFer})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','!fo_Eof(@oSRR)   .END.','000058','000057','.ENQ.','5','','','5','!fo_Eof(@oSRR)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_GetVal(@oSRR, "RR_TIPO3") == "F" .And. fo_GetVal(@oSRR,','000059','000058','.CON.','5','','','5','fo_GetVal(@oSRR, "RR_TIPO3") == "F" .And. fo_GetVal(@oSRR, "RR_DATA") == dDtBusFer .And. fo_GetVal(@oSRR, "RR_PD") == fGetCodfol("0022")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','nAntec13 += fo_GetVal(@oSRR, "RR_VALOR")     .END.','000060','000059','.EXE.','5','nAntec13 += fo_GetVal(@oSRR, "RR_VALOR")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Skip(@oSRR)     .END.','000061','000058','.EXE.','5','fo_Skip(@oSRR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MEDIAS13','fo_Skip(@oSRH)     .END.','000062','000053','.EXE.','5','fo_Skip(@oSRH)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0105    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0105( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','MSGLOG','EXIBIR MSGS DE ERROS NA EXECUCAO DO CALC','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','MSGLOG','!EMPTY(CMSGLOG)   .END.','000001','000000','.CON.','5','','','5','!EMPTY(CMSGLOG)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','NPOS := ASCAN(AMSGLOG,{|X| X == CMSGLOG})     .CNT.','000002','000001','.EXE.','5','NPOS := ASCAN(AMSGLOG,{|X| X == CMSGLOG})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','EMPTY(NPOS)   .END.','000003','000001','.CON.','5','','','5','EMPTY(NPOS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','AADD(AMSGLOG,CMSGLOG)     .CNT.','000004','000003','.EXE.','5','AADD(AMSGLOG,CMSGLOG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','MSGLOG','ADDLOGEXECROT(CMSGLOG)     .END.','000005','000003','.EXE.','5','ADDLOGEXECROT(CMSGLOG)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0106    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0106( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PAGODOMI','PAGO DOMINICAL','','','036','2','1',} )

aAdd(aRc3Cols, { '','S_','PAGODOMI','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*D*P*A*E*I*1*2*3*4*5*','000001','000000','.EXE.','5','lCatMensal := ( SRA->RA_CATFUNC  $ "M*C*D*P*A*E*I*1*2*3*4*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nVlSalBas := 0     .CNT.','000002','000000','.EXE.','5','nVlSalBas := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nDiasTr := 0     .CNT.','000003','000000','.EXE.','5','nDiasTr := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','aAfast := {}     .CNT.','000004','000000','.EXE.','5','aAfast := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','dData := dDataDe     .CNT.','000005','000000','.EXE.','5','dData := dDataDe','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','dDataFim := dDataAte     .CNT.','000006','000000','.EXE.','5','DDATAFIM := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nDomingos := 0     .CNT.','000007','000000','.EXE.','5','nDomingos := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nx := 0     .CNT.','000008','000000','.EXE.','5','nx := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','lFalta:= .F.     .CNT.','000009','000000','.EXE.','5','lFalta:= .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nTotFaltas := 0     .CNT.','000010','000000','.EXE.','5','nTotFaltas := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nTotDom := 0     .CNT.','000011','000000','.EXE.','5','nTotDom := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','LMESADM := IF( P_MESPARTI, (SRA->RA_ADMISSA>=DDATADE .AND. S','000012','000000','.EXE.','5','LMESADM := IF( P_MESPARTI, (SRA->RA_ADMISSA>=DDATADE .AND. SRA->RA_ADMISSA<= DDATAATE ), (MESANO(SRA->RA_ADMISSA) >= MESANO(DDATADE) ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','FTRABCALEND( CPERIODO, @NDIASTR, ,  , , , , , , , , , CNUMPA','000013','000000','.EXE.','5','FTRABCALEND( CPERIODO, @NDIASTR, ,  , , , , , , , , , CNUMPAG, .F.,LMESADM , , C__ROTEIRO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NHORASDIA := FO_GETVAL(@ORCF, "RCF_HRSDIA")     .CNT.','000014','000000','.EXE.','5','NHORASDIA := FO_GETVAL(@ORCF, "RCF_HRSDIA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','dDatade <= SRA->RA_ADMISSA   .END.','000015','000000','.CON.','5','','','5','dDatade <= SRA->RA_ADMISSA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','dData := SRA->RA_ADMISSA     .END.','000016','000015','.EXE.','5','dData := SRA->RA_ADMISSA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','cTipoRot =="4"   .END.','000017','000000','.CON.','5','','','5','cTipoRot =="4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','dDataFim := DDATADEM     .END.','000018','000017','.EXE.','5','dDataFim := DDATADEM','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','Dow(dData) <>  2   .END.','000019','000000','.CON.','5','','','5','Dow(dData) <>  2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','Dow(dData ) <> 2   .END.','000020','000019','.ENQ.','5','','','5','Dow(dData ) <> 2','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','dDAta -= 1     .END.','000021','000020','.EXE.','5','dDAta -= 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','fRetAfas(dDatade, dDataAte , , , , , @aAfast )     .CNT.','000022','000000','.EXE.','5','fRetAfas(dDatade, dDataAte , , , , , @aAfast )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','AEVAL( AAFAST, {|X| IF( X[12]==FGETCODFOL("054"), NTOTFALTAS','000023','000000','.EXE.','5','AEVAL( AAFAST, {|X| IF( X[12]==FGETCODFOL("054"), NTOTFALTAS  += X[2] , 0) } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NTOTFALTAS < 0   .END.','000024','000000','.CON.','5','','','5','nTotFaltas < 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NTOTFALTAS := 0     .END.','000025','000024','.EXE.','5','nTotFaltas := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','dData <= dDatafim   .END.','000026','000000','.ENQ.','5','','','5','DDATA <= DDATAFIM','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nPos1 := ascan(aAfast,{|x| dData >= x[3] .and. dData <= x[4]','000027','000026','.EXE.','5','nPos1 := ascan(aAfast,{|x| dData >= x[3] .and. dData <= x[4] .and. fGetCodFol("054") == x[12]}  )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nPos1 > 0   .END.','000028','000026','.CON.','5','','','5','nPos1 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','lFalta := .T.     .END.','000029','000028','.EXE.','5','lFalta := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','Dow(  dData )  == 1   .END.','000030','000026','.CON.','5','','','5','Dow(  dData )  == 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','lFalta == .F.   .END.','000031','000030','.CON.','5','','','5','lFalta == .F.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nDomingos += 1     .END.','000032','000031','.EXE.','5','nDomingos += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','lFalta := .F.     .CNT.','000033','000030','.EXE.','5','lFalta := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nTotDom += 1     .END.','000034','000030','.EXE.','5','nTotDom += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','dData += 1     .END.','000035','000026','.EXE.','5','dData += 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLSALBAS := SRA->RA_SALARIO     .CNT.','000036','000000','.EXE.','5','NVLSALBAS := SRA->RA_SALARIO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','SRA->RA_PAGODOM = "1"   .END.','000037','000000','.CON.','5','','','5','SRA->RA_PAGODOM = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','nVlSalBas > 0 .And. nDomingos > 0   .END.','000038','000037','.CON.','5','','','5','nVlSalBas > 0 .And. nDomingos > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','cTipoRot =="4"   .END.','000039','000038','.CON.','5','','','5','cTipoRot =="4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','DTRABPER := NDIASTR     .END.','000040','000039','.EXE.','5','DTRABPER := NDIASTR','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','lCatMensal   .END.','000041','000038','.CON.','5','','','5','lCatMensal','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLDOMIN := nVlSalBas / DTRABPER * nDomingos     .END.','000042','000041','.EXE.','5','NVLDOMIN := nVlSalBas / DTRABPER * nDomingos','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','!lCatMensal   .END.','000043','000038','.CON.','5','','','5','!lCatMensal','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLDOMIN := (NVLSALBAS * 240) / DTRABPER * nDomingos     .EN','000044','000043','.EXE.','5','NVLDOMIN := (NVLSALBAS * 240) / DTRABPER * nDomingos','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NTOTFALDOM := nTotDom - nDomingos     .END.','000045','000037','.EXE.','5','NTOTFALDOM := nTotDom - nDomingos','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','LCATMENSAL   .END.','000046','000000','.CON.','5','','','5','LCATMENSAL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','CTIPOROT <> "4"   .END.','000047','000046','.CON.','5','','','5','CTIPOROT <> "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','FO_SEEK(@&COBJETO, {CCPOPD, CCPONPAGTO} , {FGETCODFOL("003','000048','000047','.CON.','5','','','5','FO_SEEK(@&COBJETO, {CCPOPD, CCPONPAGTO} , {FGETCODFOL("0031") , CNUMPAG}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLSALBAS := FO_GETVAL(@&COBJETO, CCPOVALOR)     .END.','000049','000048','.EXE.','5','NVLSALBAS := FO_GETVAL(@&COBJETO, CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','CTIPOROT == "4"   .END.','000050','000046','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','FO_SEEK(@&COBJETO, {CCPOPD, CCPONPAGTO} , {FGETCODFOL("004','000051','000050','.CON.','5','','','5','FO_SEEK(@&COBJETO, {CCPOPD, CCPONPAGTO} , {FGETCODFOL("0048") , CNUMPAG}, .T.)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLSALBAS := FO_GETVAL(@&COBJETO, CCPOVALOR)     .END.','000052','000051','.EXE.','5','NVLSALBAS := FO_GETVAL(@&COBJETO, CCPOVALOR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLFALDOM := NVLSALBAS / DIASTRAB * NTOTFALDOM     .CNT.','000053','000000','.EXE.','5','NVLFALDOM := NVLSALBAS / DIASTRAB * NTOTFALDOM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLFALTA := NVLSALBAS / DIASTRAB * NTOTFALTAS     .CNT.','000054','000000','.EXE.','5','NVLFALTA := NVLSALBAS / DIASTRAB * NTOTFALTAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','SRA->RA_CATFUNC=="H"   .END.','000055','000000','.CON.','5','','','5','SRA->RA_CATFUNC=="H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLFALDOM := SRA->RA_SALARIO* NHORASDIA * NTOTFALDOM     .CN','000056','000055','.EXE.','5','NVLFALDOM := SRA->RA_SALARIO* NHORASDIA * NTOTFALDOM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PAGODOMI','NVLFALTA := SRA->RA_SALARIO* NHORASDIA * NTOTFALTAS     .END','000057','000055','.EXE.','5','NVLFALTA := SRA->RA_SALARIO* NHORASDIA * NTOTFALTAS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0107    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0107( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PRIMAANU','CALCULO PRIMA ANUAL','','','020','2','1',} )

aAdd(aRc3Cols, { '','S_','PRIMAANU','nMesesTrab := 0     .CNT.','000001','000000','.EXE.','5','nMesesTrab := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','NBASEPRIMA := 0     .CNT.','000002','000000','.EXE.','5','NBASEPRIMA := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nProp := 1     .CNT.','000003','000000','.EXE.','5','nProp := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nPos := 0     .CNT.','000004','000000','.EXE.','5','nPos := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','CPERINI := ""      .CNT.','000005','000000','.EXE.','5','cPerIni := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nPos := FPOSTAB("S008" , MesAno(dDataRef) , "=" ,  6 )	','000006','000000','.EXE.','5','nPos := FPOSTAB("S008" , MesAno(dDataRef) , "=" ,  6 )	','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nPos > 0   .END.','000007','000000','.CON.','5','','','5','nPos > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','cDtPag := FTABELA("S008" , nPos , 6 )     .CNT.','000008','000007','.EXE.','5','cDtPag := FTABELA("S008" , nPos , 6 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','cDtIni := FTABELA("S008", nPos, 4 )     .CNT.','000009','000007','.EXE.','5','cDtIni := FTABELA("S008", nPos, 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','cDtFim := FTABELA("S008", nPos, 5 )     .CNT.','000010','000007','.EXE.','5','cDtFim := FTABELA("S008", nPos, 5 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nALiqPrima := FTABELA("S008", nPos, 7 )     .CNT.','000011','000007','.EXE.','5','nALiqPrima := FTABELA("S008", nPos, 7 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','dDtIniPri := SRA->RA_ADMISSA     .CNT.','000012','000007','.EXE.','5','dDtIniPri := SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','cDtIni <> Nil .And. cDtFim <> Nil   .END.','000013','000007','.CON.','5','','','5','cDtIni <> Nil .And. cDtFim <> Nil','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nMesesTrab := DateDiffMonth( SRA->RA_ADMISSA , dDataRef )','000014','000013','.EXE.','5','nMesesTrab := DateDiffMonth( SRA->RA_ADMISSA , dDataRef )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','(SRA->RA_CATFUNC $ "M*C*P*A*E*I" .And. nMesesTrab >= 3 ) .','000015','000013','.CON.','5','','','5','(SRA->RA_CATFUNC $ "M*C*P*A*E*I" .And. nMesesTrab >= 3 ) .or. (SRA->RA_CATFUNC $ "H*T*G*J*D"  .And. nMesesTrab >= 1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','( SRA->RA_ADMISSA < CTOD("01/"+SUBSTR(CDTINI, 5, 2) + "/"','000016','000015','.CON.','5','','','5','( SRA->RA_ADMISSA < CTOD("01/"+SUBSTR(CDTINI, 5, 2) + "/" +SUBSTR(CDTINI, 1 , 4 ) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','DDTINIPRI := CTOD("01/ " +SUBSTR(CDTINI, 5, 2) + "/" + SUBST','000017','000016','.EXE.','5','DDTINIPRI := CTOD("01/ " +SUBSTR(CDTINI, 5, 2) + "/" + SUBSTR(CDTINI, 1 , 4 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nMesesTrab := DateDiffMonth( dDtIniPri , dDataRef )     .CNT','000018','000015','.EXE.','5','nMesesTrab := DateDiffMonth( dDtIniPri , dDataRef )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','CPERINI := SUBMESANO( SUBMESANO( CDTFIM ) )     .CNT.','000019','000015','.EXE.','5','cPerIni := subMesAno( subMesAno( cDtFim ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','NBASEPRIMA := FBUSCAACM( NIL, '+"'"+'SRV->RV_PRIMA == "1"'+"'"+', STOD(','000020','000015','.EXE.','5','nBasePrima := FBUSCAACM( Nil, '+"'"+'SRV->RV_PRIMA == "1"'+"'"+', sTod( cPerIni+"01" ), sToD( cDtFim+"01" ), "V", Nil, Nil, Nil, Nil, Nil, Nil, .T.) / 3','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nMesesTrab < 12   .END.','000021','000015','.CON.','5','','','5','nMesesTrab < 12','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nProp :=  nMesesTrab / 12     .END.','000022','000021','.EXE.','5','nProp :=  nMesesTrab / 12','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nBasePrima > 0   .END.','000023','000015','.CON.','5','','','5','nBasePrima > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAANU','nBasePrima := (nBasePrima * nAliqPrima / 100) * nProp     .E','000024','000023','.EXE.','5','nBasePrima := (nBasePrima * nAliqPrima / 100) * nProp','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0108    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0108( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PRIMAFIN','CALCULO PRIMA ANUAL FINIQUITO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','PRIMAFIN','ATEMPRIMA:= {}     .CNT.','000001','000000','.EXE.','5','ATEMPRIMA:= {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','NPOS := 0     .CNT.','000002','000000','.EXE.','5','NPOS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','NPOS := FPOSTAB("S008" , MESANO(DDATADEM) , "=" ,  6 )	','000003','000000','.EXE.','5','NPOS := FPOSTAB("S008" , MESANO(DDATADEM) , "=" ,  6 )	','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','nPos == 0   .END.','000004','000000','.CON.','5','','','5','nPos == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','nPos := FPOSTAB("S008", MESANO(DDATADEM), ">",  4 ,  MESANO(','000005','000004','.EXE.','5','nPos := FPOSTAB("S008", MESANO(DDATADEM), ">",  4 ,  MESANO(DDATADEM) , "<", 5 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','nPos > 0  .And. AINCRES[05] == "S"   .END.','000006','000000','.CON.','5','','','5','nPos > 0  .And. AINCRES[05] == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','CDTINI := FTABELA("S008", NPOS, 4 )     .CNT.','000007','000006','.EXE.','5','CDTINI := FTABELA("S008", NPOS, 4 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','CDTFIM := FTABELA("S008", NPOS, 5 )     .CNT.','000008','000006','.EXE.','5','CDTFIM := FTABELA("S008", NPOS, 5 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','NALIQPRIMA := FTABELA("S008", NPOS, 7 )     .CNT.','000009','000006','.EXE.','5','NALIQPRIMA := FTABELA("S008", NPOS, 7 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','DDTINIPRI := SRA->RA_ADMISSA     .CNT.','000010','000006','.EXE.','5','DDTINIPRI := SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','CDTINI <> NIL .AND. CDTFIM <> NIL   .END.','000011','000006','.CON.','5','','','5','CDTINI <> NIL .AND. CDTFIM <> NIL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','SRA->RA_ADMISSA < CTOD("01/"+SUBSTR(CDTINI, 5,2) + "/" +SU','000012','000011','.CON.','5','','','5','SRA->RA_ADMISSA < CTOD("01/"+SUBSTR(CDTINI, 5,2) + "/" +SUBSTR(CDTINI, 1 , 4 ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','DDTINIPRI := CTOD("01/ " +SUBSTR(CDTINI, 5, 2) + "/" + SUBST','000013','000012','.EXE.','5','DDTINIPRI := CTOD("01/ " +SUBSTR(CDTINI, 5, 2) + "/" + SUBSTR(CDTINI, 1 , 4 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','NMESESTRAB := DATEDIFFMONTH( DDTINIPRI , DDATADEM )     .CNT','000014','000011','.EXE.','5','NMESESTRAB := DATEDIFFMONTH( DDTINIPRI , DDATADEM )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','ATEMPRIMA := DATEDIFFYMD( DDTINIPRI, DDATADEM + 1 )     .CNT','000015','000011','.EXE.','5','ATEMPRIMA := DATEDIFFYMD( DDTINIPRI, DDATADEM + 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','LEN(ATEMPRIMA ) > 0   .END.','000016','000011','.CON.','5','','','5','LEN(ATEMPRIMA ) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','NMESESPRIM := ATEMPRIMA[2]     .CNT.','000017','000016','.EXE.','5','NMESESPRIM := ATEMPRIMA[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','NDIASPRIMA := ATEMPRIMA[3]     .CNT.','000018','000016','.EXE.','5','NDIASPRIMA := ATEMPRIMA[3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','( SRA->RA_CATFUNC $ "M*C*P*A*E*I" .And. NMESESTRAB < 3 ) .','000019','000016','.CON.','5','','','5','( SRA->RA_CATFUNC $ "M*C*P*A*E*I" .And. NMESESTRAB < 3 ) .Or. ( SRA->RA_CATFUNC $ "H*T*G*J*D" .And. NMESESTRAB < 1 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','NMESESPRIM := 0     .CNT.','000020','000019','.EXE.','5','NMESESPRIM := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PRIMAFIN','NDIASPRIMA := 0     .END.','000021','000019','.EXE.','5','NDIASPRIMA := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0109    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0109( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCLIC','GERACAO DE LICENCIAS','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCLIC','FO_GOTOP( @OSR8)     .CNT.','000001','000000','.EXE.','5','FO_GOTOP( @OSR8)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','!fo_Eof(@oSR8)   .END.','000002','000000','.CON.','5','','','5','!fo_Eof(@oSR8)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','dFimPer := dDataAte   .CNT.','000003','000002','.EXE.','5','dFimPer',':=','5','dDataAte','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','dDtIniFer := dDtFimFer := CTOD("")     .CNT.','000004','000002','.EXE.','5','dDtIniFer := dDtFimFer := CTOD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiasLic := 0     .CNT.','000005','000002','.EXE.','5','nDiasLic := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nLinha := 0     .CNT.','000006','000002','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIASPAGO := 0     .CNT.','000007','000002','.EXE.','5','NDIASPAGO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LHABILES := .F.     .CNT.','000008','000002','.EXE.','5','LHABILES := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LFIRST := .T.     .CNT.','000009','000002','.EXE.','5','LFIRST := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LMESINT := .F.     .CNT.','000010','000002','.EXE.','5','LMESINT := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nSeq := 0     .CNT.','000011','000002','.EXE.','5','nSeq := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','!fo_Eof( @oSR8)   .END.','000012','000002','.ENQ.','5','','','5','!fo_Eof( @oSR8)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nLinha ++     .CNT.','000013','000012','.EXE.','5','nLinha ++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )     .CNT.','000014','000012','.EXE.','5','cAfaPer := fo_GetVal( @oSR8 , "R8_PER" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','CNUMID := FO_GETVAL( @OSR8 , "R8_NUMID" , NLINHA )     .CNT.','000015','000012','.EXE.','5','CNUMID := FO_GETVAL( @OSR8 , "R8_NUMID" , NLINHA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )     .','000016','000012','.EXE.','5','cAfaNPag := fo_GetVal( @oSR8 , "R8_NUMPAGO" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDPAGAR := FO_GETVAL ( @OSR8 , "R8_DPAGAR" , NLINHA )     .C','000017','000012','.EXE.','5','NDPAGAR := FO_GETVAL ( @OSR8 , "R8_DPAGAR" , NLINHA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NSDOPAGAR := FO_GETVAL ( @OSR8 , "R8_SDPAGAR" , NLINHA )','000018','000012','.EXE.','5','NSDOPAGAR := FO_GETVAL ( @OSR8 , "R8_SDPAGAR" , NLINHA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", n','000019','000012','.EXE.','5','cTipoAfa := PosAlias("RCM", fo_GetVal(@oSR8, "R8_TIPOAFA", nLinha), SRA->RA_FILIAL, "RCM_TIPOAF")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )     .CNT','000020','000012','.EXE.','5','dDtIni := fo_GetVal( @oSR8 , "R8_DATAINI", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )     .CN','000021','000012','.EXE.','5','dDtFim := fo_GetVal ( @oSR8 , "R8_DATAFIM", nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIASPAGO := FO_GETVAL(@OSR8, "R8_DPAGOS", NLINHA)     .CNT.','000022','000012','.EXE.','5','NDIASPAGO := FO_GETVAL(@OSR8, "R8_DPAGOS", NLINHA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cEmpPg := FO_GETVAL(@OSR8, "R8_EMPPG", NLINHA)     .CNT.','000023','000012','.EXE.','5','cEmpPg := FO_GETVAL(@OSR8, "R8_EMPPG", NLINHA)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LHABILES := .F.     .CNT.','000024','000012','.EXE.','5','LHABILES := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','CTIPODIA := ""     .CNT.','000025','000012','.EXE.','5','CTIPODIA := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','CTIPODIA := POSALIAS("RCE", SRA->RA_SINDICA, SRA->RA_FILIAL,','000026','000012','.EXE.','5','CTIPODIA := POSALIAS("RCE", SRA->RA_SINDICA, SRA->RA_FILIAL, "RCE_HABCOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LOK := EMPTY(CTIPODIA)   .END.','000027','000012','.CON.','5','','','5','LOK := EMPTY(CTIPODIA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LHABILES := POSALIAS("RCM", FO_GETVAL(@OSR8, "R8_TIPOAFA", N','000028','000027','.EXE.','5','LHABILES := POSALIAS("RCM", FO_GETVAL(@OSR8, "R8_TIPOAFA", NLINHA), SRA->RA_FILIAL, "RCM_TIPODI") == "1"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','!LOK   .END.','000029','000012','.CON.','5','','','5','!LOK','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LHABILES := (CTIPODIA  =="'+"'"+'1")     .END.','000030','000029','.EXE.','5','LHABILES := (CTIPODIA  =="'+"'"+'1")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIASEMP := 3     .CNT.','000031','000012','.EXE.','5','NDIASEMP := 3','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )     .CNT.','000032','000012','.EXE.','5','cVerba := fo_GetVal( @oSR8 , "R8_PD" , nLinha )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','POSSRV(CVERBA,SRA->RA_FILIAL)     .CNT.','000033','000012','.EXE.','5','POSSRV(CVERBA,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LFALTALIC := IF ( SRV->RV_CODFOL $ "0040|0041|0042", .T., .F','000034','000012','.EXE.','5','LFALTALIC := IF ( SRV->RV_CODFOL $ "0040|0041|0042", .T., .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','(LFALTALIC .AND. NSDOPAGAR > 0) .AND. ( CAFAPER <= CPERIOD','000035','000012','.CON.','5','','','5','(LFALTALIC .AND. NSDOPAGAR > 0) .AND. ( CAFAPER <= CPERIODO .AND. CAFANPAG <= CNUMPAG ).AND. ( DDTINI <= DDATAATE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LFIRST == .T.   .END.','000036','000035','.CON.','5','','','5','LFIRST == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTINIM := DDTINI     .CNT.','000037','000036','.EXE.','5','DDTINIM := DDTINI','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTFIMM := DDTFIM     .CNT.','000038','000036','.EXE.','5','DDTFIMM := DDTFIM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LFIRST := .F.     .END.','000039','000036','.EXE.','5','LFIRST := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTFIMM < ( DDTINI -1)   .END.','000040','000035','.CON.','5','','','5','DDTFIMM < ( DDTINI -1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTINIM := DDTINI     .END.','000041','000040','.EXE.','5','DDTINIM := DDTINI','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTFIMM := DDTFIM     .CNT.','000042','000035','.EXE.','5','DDTFIMM := DDTFIM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTINIM <= DDATADE  .AND. DDTFIMM >= DDATAATE   .END.','000043','000035','.CON.','5','','','5','DDTINIM <= DDATADE  .AND. DDTFIMM >= DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LMESINT := .T.     .END.','000044','000043','.EXE.','5','LMESINT := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTINI < DDATADE   .END.','000045','000035','.CON.','5','','','5','DDTINI < DDATADE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTINI := DDATADE     .CNT.','000046','000045','.EXE.','5','DDTINI := DDATADE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIASEMP := 0     .END.','000047','000045','.EXE.','5','NDIASEMP := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTFIM > DDATAATE   .END.','000048','000035','.CON.','5','','','5','DDTFIM > DDATAATE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','DDTFIM := DDATAATE     .END.','000049','000048','.EXE.','5','DDTFIM := DDATAATE','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','Empty(dDtFim)   .END.','000050','000035','.CON.','5','','','5','Empty(dDtFim)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','dDtFim := dFimPer     .END.','000051','000050','.EXE.','5','dDtFim := dFimPer','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiaIni:= 0     .CNT.','000052','000035','.EXE.','5','nDiaIni:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cAnoMes == MesAno( dDtIni ) .END.','000053','000035','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtIni )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiaIni := Day( dDtIni )     .END.','000054','000053','.EXE.','5','nDiaIni := Day( dDtIni )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cAnoMes > MesAno(dDtIni) .END.','000055','000035','.CON.','5','','','5','cAnoMes','>','5','MesAno(dDtIni)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiaIni := 1     .END.','000056','000055','.EXE.','5','nDiaIni := 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiaFim:= 0     .CNT.','000057','000035','.EXE.','5','nDiaFim:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cAnoMes == MesAno( dDtFim ) .END.','000058','000035','.CON.','5','','','5','cAnoMes','==','5','MesAno( dDtFim )','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiaFim := Day( dDtFim )     .END.','000059','000058','.EXE.','5','nDiaFim := Day( dDtFim )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','cAnoMes < MesAno(dDtFim) .END.','000060','000035','.CON.','5','','','5','cAnoMes','<','5','MesAno(dDtFim)','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiaFim := Day(dFimPer)     .END.','000061','000060','.EXE.','5','nDiaFim := Day(dFimPer)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000062','000035','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .and. P_DIASMES <> "S" )) .and. (nDiaFim > 30)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiaFim := 30     .END.','000063','000062','.EXE.','5','nDiaFim := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIn','000064','000035','.EXE.','5','nDias := If( (nDiaFim - nDiaIni + 1) > 0 , (nDiaFim - nDiaIni + 1), 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LHABILES   .END.','000065','000035','.CON.','5','','','5','LHABILES','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIAS -= DATENOWORKDAY(DDTINI, DDTFIM)     .END.','000066','000065','.EXE.','5','NDIAS -= DATENOWORKDAY(DDTINI, DDTFIM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','CVERBA == FGETCODFOL("0041")   .END.','000067','000035','.CON.','5','','','5','CVERBA == FGETCODFOL("0041")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','CNS SO COBRE AUSENCIAS MAIORES QUE 3 DIAS     .CNT.','000068','000067','.MSG.','5','CNS SO COBRE AUSENCIAS MAIORES QUE 3 DIAS','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIAS <= 3 .AND. NDIASEMP > 0   .END.','000069','000067','.CON.','5','','','5','NDIAS <= 3 .AND. NDIASEMP > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LFALTALIC := .F.     .END.','000070','000069','.EXE.','5','LFALTALIC := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','CNS COBRE A PARTIR DO 4. DIA DO AFASTAMENTO     .CNT.','000071','000067','.MSG.','5','CNS COBRE A PARTIR DO 4. DIA DO AFASTAMENTO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIAS > 3 .AND. NDIASEMP > 0   .END.','000072','000067','.CON.','5','','','5','NDIAS > 3 .AND. NDIASEMP > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIAS -= NDIASEMP     .CNT.','000073','000072','.EXE.','5','NDIAS -= NDIASEMP','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','ATUALIZA O AFASTAMENTO PARA COMPENSAR OS DIAS DEDUZIDOS E NA','000074','000072','.MSG.','5','ATUALIZA O AFASTAMENTO PARA COMPENSAR OS DIAS DEDUZIDOS E NAO GERAR DIVERGENCIA NO FECHAMENTO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','EMPTY( CEMPPG )   .END.','000075','000072','.CON.','5','','','5','EMPTY( CEMPPG )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','CKEY := SRA->RA_FILIAL + CNUMID     .CNT.','000076','000075','.EXE.','5','CKEY := SRA->RA_FILIAL + CNUMID','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NORDSR8 := RETORDER( "SR8", "R8_FILIAL+R8_NUMID", .T. )','000077','000075','.EXE.','5','NORDSR8 := RETORDER( "SR8", "R8_FILIAL+R8_NUMID", .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LREG := FPOSREG("SR8", NORDSR8, CKEY, .F. )     .CNT.','000078','000075','.EXE.','5','LREG := FPOSREG("SR8", NORDSR8, CKEY, .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LREG   .END.','000079','000075','.CON.','5','','','5','LREG','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','FGRAVAFOR( "SR8", NORDSR8, CKEY, {"R8_EMPPG", "R8_SDPAGAR",','000080','000079','.EXE.','5','FGRAVAFOR( "SR8", NORDSR8, CKEY, {"R8_EMPPG", "R8_SDPAGAR", "R8_DPAGOS"}, {"S", NDPAGAR-(NDIASEMP+NDIASPAGO), NDIASEMP+NDIASPAGO} , , .F. , .F. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','FPOSREG("SR8", 1, SRA->RA_FILIAL+SRA->RA_MAT, .F. )     .END','000081','000079','.EXE.','5','FPOSREG("SR8", 1, SRA->RA_FILIAL+SRA->RA_MAT, .F. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NDIASLIC += NDIAS     .CNT.','000082','000035','.EXE.','5','NDIASLIC += NDIAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0   .END.','000083','000035','.CON.','5','','','5','fo_GetVal(@oSR8, "R8_DNAPLIC", nLinha)>0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)     .CN','000084','000083','.EXE.','5','dDtFimAnt:= fo_GetVal(@oSR8, "R8_DATAFIM", nLinha-1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','MesAno(dDtFimAnt) > MesAno(dDtIni)   .END.','000085','000083','.CON.','5','','','5','MesAno(dDtFimAnt) > MesAno(dDtIni)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LIf:= (Month(dDtIni) = 2)   .END.','000086','000085','.CON.','5','','','5','LIf:= (Month(dDtIni) = 2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2     .END.','000087','000086','.EXE.','5','dDtFimAnt:= CToD("28/02/"+Year2Str(dDtFimAnt))+2','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','!LIf   .END.','000088','000085','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni','000089','000088','.EXE.','5','dDtFimAnt:= CToD("30/"+Month2Str(dDtIni)+"/"+Year2Str(dDtIni))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIn','000090','000083','.EXE.','5','nDiasNaoAplic:= Iif(cAnoMes==MesAno(DDTINI), dDtFimAnt-dDtIni+1,0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDiasLic -= nDiasNaoAplic     .CNT.','000091','000083','.EXE.','5','nDiasLic -= nDiasNaoAplic','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LIf:= (cAnoMes==MesAno(DDTINI))   .END.','000092','000083','.CON.','5','','','5','LIf:= (cAnoMes==MesAno(DDTINI))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nPagarMes:= Max(nDiasLic-fo_GetVal( @oSR8, "R8_DURACAO", nLi','000093','000092','.EXE.','5','nPagarMes:= Max(nDiasLic-fo_GetVal( @oSR8, "R8_DURACAO", nLinha-1),0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','!LIf   .END.','000094','000083','.CON.','5','','','5','!LIf','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nPagarMes:= nDiasLic     .END.','000095','000094','.EXE.','5','nPagarMes:= nDiasLic','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','000096','000083','.EXE.','5','nSdoPagar:= Iif(nPagarMes>nSdoPagar,nSdoPagar, nPagarMes )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDias <= nSdoPagar .END.','000097','000035','.CON.','5','','','5','nDias','<=','5','nSdoPagar','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDPagarPer := nDias     .END.','000098','000097','.EXE.','5','nDPagarPer := nDias','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDias > nSdoPagar .END.','000099','000035','.CON.','5','','','5','nDias','>','5','nSdoPagar','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','nDPagarPer := nSdoPagar     .END.','000100','000099','.EXE.','5','nDPagarPer := nSdoPagar','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','LICENCA POR MATERNIDADE ENFERMIDADE OU SEGURO     .CNT.','000101','000035','.MSG.','5','LICENCA POR MATERNIDADE ENFERMIDADE OU SEGURO','','5','','','5','','.CNT.','PMSTASK2','PMSTASK2',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','S_BSALLICE()     .CNT.','000102','000035','.EXE.','5','S_BSALLICE()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NVALLICE := ROUND( (NVALSALLICE / 30 * NDPAGARPER), 2 )','000103','000035','.EXE.','5','NVALLICE := ROUND( (NVALSALLICE / 30 * NDPAGARPER), 2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NVALLICE > 0   .END.','000104','000035','.CON.','5','','','5','NVALLICE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','FO_SEEK(@&COBJETO, CCPOPD, CVERBA) .AND. !FO_DELETED(@&COB','000105','000104','.CON.','5','','','5','FO_SEEK(@&COBJETO, CCPOPD, CVERBA) .AND. !FO_DELETED(@&COBJETO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','FO_SETVAL(@&COBJETO, CCPOVALOR, NVALLICE )     .END.','000106','000105','.EXE.','5','FO_SETVAL(@&COBJETO, CCPOVALOR, NVALLICE )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','!FO_SEEK(@&COBJETO, CCPOPD, CVERBA)   .END.','000107','000104','.CON.','5','','','5','!FO_SEEK(@&COBJETO, CCPOPD, CVERBA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','NSEQ := FO_COUNT( @&COBJETO , CCPOPD , CVERBA ) + 1     .CNT','000108','000107','.EXE.','5','NSEQ := FO_COUNT( @&COBJETO , CCPOPD , CVERBA ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR','000109','000107','.EXE.','5','FO_ADD( @&COBJETO , {CCPOPD, CCPOTIPO1, CCPOHORAS, CCPOVALOR, CCPOSEQ} , {CVERBA, "V" , NDPAGARPER, NVALLICE, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" )) },{CCPOPD, CCPOSEQ},{CVERBA, STR(NSEQ, GETSX3CACHE( CCPOSEQ , "X3_TAMANHO" ))})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCLIC','fo_Skip ( @oSR8 )     .END.','000110','000012','.EXE.','5','fo_Skip ( @oSR8 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBOL0110    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBOL0110( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','PROCRG1','PROCESSAR RG1','','','069','2','1',} )

aAdd(aRc3Cols, { '','S_','PROCRG1','CPDACFIXOS := ""     .CNT.','000001','000000','.EXE.','5','CPDACFIXOS := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','CVERBADIC := FGETCODFOL("001")+"*"+FGETCODFOL("002")+"*"+FGE','000002','000000','.EXE.','5','CVERBADIC := FGETCODFOL("001")+"*"+FGETCODFOL("002")+"*"+FGETCODFOL("003")+"*"+FGETCODFOL("004")+"*"+FGETCODFOL("005")+"*"+FGETCODFOL("036")+"*"+FGETCODFOL("037")+"*"+FGETCODFOL("038")+"*"+FGETCODFOL("039")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPg:= CToD("")     .CNT.','000003','000000','.EXE.','5','dDtFimPg:= CToD("")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaIniRG1 := 0     .CNT.','000004','000000','.EXE.','5','nDiaIniRG1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := 0     .CNT.','000005','000000','.EXE.','5','nDiaFimRG1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','fo_GoTop( @ORG1)     .CNT.','000006','000000','.EXE.','5','fo_GoTop( @ORG1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!fo_Eof( @ORG1 )   .END.','000007','000000','.ENQ.','5','','','5','!fo_Eof( @ORG1 )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_GETVAL(@oRG1,"RG1_AUTOM") = "1"   .END.','000008','000007','.CON.','5','','','5','FO_GETVAL(@oRG1,"RG1_AUTOM") = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','DDTLIB := IF(CPAISLOC == "BOL",FO_GETVAL(@ORG1,"RG1_DINIPG")','000009','000008','.EXE.','5','dDtLib := If(cPaisLoc == "BOL",FO_GETVAL(@ORG1,"RG1_DINIPG"),FO_GETVAL(@ORG1,"RG1_LIBPAG"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPg:= fo_GetVal(@oRG1, "RG1_DFIMPG")     .CNT.','000010','000008','.EXE.','5','dDtFimPg:= fo_GetVal(@oRG1, "RG1_DFIMPG")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!EMPTY(dDtLIb) .And. cAnoMes >= MesAno(dDtLib)   .END.','000011','000008','.CON.','5','','','5','!EMPTY(dDtLIb) .And. cAnoMes >= MesAno(dDtLib)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cVerba := fo_GetVal( @ORG1 , "RG1_PD")     .CNT.','000012','000011','.EXE.','5','cVerba := fo_GetVal( @ORG1 , "RG1_PD")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc := fo_GetVal( @ORG1 , "RG1_TPCALC")     .CNT.','000013','000011','.EXE.','5','cTpcalc := fo_GetVal( @ORG1 , "RG1_TPCALC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nRef := fo_GetVal( @ORG1 , "RG1_REFER")     .CNT.','000014','000011','.EXE.','5','nRef := fo_GetVal( @ORG1 , "RG1_REFER")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','PosSrv(cVerba,SRA->RA_FILIAL)     .CNT.','000015','000011','.EXE.','5','PosSrv(cVerba,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nPercVrb := If (SRV->RV_PERC=0,100,SRV->RV_PERC)     .CNT.','000016','000011','.EXE.','5','nPercVrb := If (SRV->RV_PERC=0,100,SRV->RV_PERC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cCodCor := SRV->RV_CODCORR     .CNT.','000017','000011','.EXE.','5','cCodCor := SRV->RV_CODCORR','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','Lincorp := IF ( SRV->RV_INCORP ="S",.T.,.F.)     .CNT.','000018','000011','.EXE.','5','Lincorp := IF ( SRV->RV_INCORP ="S",.T.,.F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp := FO_GETVAL(@ORG1,"RG1_PROP")     .CNT.','000019','000011','.EXE.','5','cProp := FO_GETVAL(@ORG1,"RG1_PROP")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp := IF( ( cProp == "1" .And. ( !lIncorp .Or. DiasTrab >','000020','000011','.EXE.','5','cProp := IF( ( cProp == "1" .And. ( !lIncorp .Or. DiasTrab >= 30 ) .And. !( cVerba $ cVerbAdic ) ) .OR. ( cProp == "2" .And. cAfaPagto == "S" ) ,"S","N")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .f.     .CNT.','000021','000011','.EXE.','5','lGravaRg1 := .f.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cCc := FO_GETVAL(@oRG1,"RG1_CC")     .CNT.','000022','000011','.EXE.','5','cCc := FO_GETVAL(@oRG1,"RG1_CC")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValTab := 0     .CNT.','000023','000011','.EXE.','5','nValTab := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "1"   .END.','000024','000011','.CON.','5','','','5','cTpcalc == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := FO_GETVAL(@ORG1,"RG1_VALOR")     .CNT.','000025','000024','.EXE.','5','nValor := FO_GETVAL(@ORG1,"RG1_VALOR")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000026','000024','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "2"   .END.','000027','000011','.CON.','5','','','5','cTpcalc == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * Saldia / 100 * nPercVrb     .CNT.','000028','000027','.EXE.','5','nValor := nRef * Saldia / 100 * nPercVrb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000029','000027','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "3"   .END.','000030','000011','.CON.','5','','','5','cTpcalc == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * SalHora / 100 * nPercVrb     .CNT.','000031','000030','.EXE.','5','nValor := nRef * SalHora / 100 * nPercVrb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000032','000030','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "4"   .END.','000033','000011','.CON.','5','','','5','cTpcalc == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTab := FO_GETVAL(@ORG1,"RG1_CODTAB")     .CNT.','000034','000033','.EXE.','5','cTab := FO_GETVAL(@ORG1,"RG1_CODTAB")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nLin :=FO_GETVAL(@ORG1,"RG1_LINHA")     .CNT.','000035','000033','.EXE.','5','nLin :=FO_GETVAL(@ORG1,"RG1_LINHA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nCol :=FO_GETVAL(@ORG1,"RG1_COLUNA")     .CNT.','000036','000033','.EXE.','5','nCol :=FO_GETVAL(@ORG1,"RG1_COLUNA")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValTab := fTabela(cTab,nLin,nCol)     .CNT.','000037','000033','.EXE.','5','nValTab := fTabela(cTab,nLin,nCol)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nRef := If ( nRef = 0,nPercVrb,nRef)     .CNT.','000038','000033','.EXE.','5','nRef := If ( nRef = 0,nPercVrb,nRef)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','ValType(nValTab) <> "U"   .END.','000039','000033','.CON.','5','','','5','ValType(nValTab) <> "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * nValTab / 100     .CNT.','000040','000039','.EXE.','5','nValor := nRef * nValTab / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000041','000039','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "5"   .END.','000042','000011','.CON.','5','','','5','cTpcalc == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','CPDACFIXOS += fo_GetVal( @ORG1 , "RG1_PD") + "-"     .CNT.','000043','000042','.EXE.','5','CPDACFIXOS += fo_GetVal( @ORG1 , "RG1_PD") + "-"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000044','000042','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "6"   .END.','000045','000011','.CON.','5','','','5','cTpcalc == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * SalMes / 100     .CNT.','000046','000045','.EXE.','5','nValor := nRef * SalMes / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000047','000045','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cTpcalc == "7"   .END.','000048','000011','.CON.','5','','','5','cTpcalc == "7"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValor := nRef * VAL_SALMIN / 100     .CNT.','000049','000048','.EXE.','5','nValor := nRef * VAL_SALMIN / 100','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1 := .t.     .END.','000050','000048','.EXE.','5','lGravaRg1 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nTotAdic += nValor     .CNT.','000051','000011','.EXE.','5','nTotAdic += nValor','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','cProp == "S"   .END.','000052','000011','.CON.','5','','','5','cProp == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto  := DDATADE     .CNT.','000053','000052','.EXE.','5','dDtIniPgto  := DDATADE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := DDATAATE     .CNT.','000054','000052','.EXE.','5','dDtFimPagto := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtaDem := If( c__roteiro == "RES", GETMEMVAR("RG_DATADEM"),','000055','000052','.EXE.','5','dDtaDem := If( c__roteiro == "RES", GETMEMVAR("RG_DATADEM"), SRA->RA_DEMISSA )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( LAdm := ( CANOMES == MesAno(SRA->RA_ADMISSA) ) )   .END.','000056','000052','.CON.','5','','','5','( LAdm := ( CANOMES == MesAno(SRA->RA_ADMISSA) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto := SRA->RA_ADMISSA     .END.','000057','000056','.EXE.','5','dDtIniPgto := SRA->RA_ADMISSA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( CANOMES == MesAno(DDTLIB) )   .END.','000058','000052','.CON.','5','','','5','( CANOMES == MesAno(DDTLIB) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( !LAdm .Or. ( LAdm .And. DDTLIB > SRA->RA_ADMISSA ) )   .','000059','000058','.CON.','5','','','5','( !LAdm .Or. ( LAdm .And. DDTLIB > SRA->RA_ADMISSA ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtIniPgto := DDTLIB     .END.','000060','000059','.EXE.','5','dDtIniPgto := DDTLIB','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( LDem := ( CANOMES == MesAno(dDtaDem) ) )   .END.','000061','000052','.CON.','5','','','5','( LDem := ( CANOMES == MesAno(dDtaDem) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := dDtaDem     .END.','000062','000061','.EXE.','5','dDtFimPagto := dDtaDem','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( CANOMES == MesAno(DDTFIMPG) )   .END.','000063','000052','.CON.','5','','','5','( CANOMES == MesAno(DDTFIMPG) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','( !LDem .Or. ( LDem .And. DDTFIMPG < dDtaDem ) )   .END.','000064','000063','.CON.','5','','','5','( !LDem .Or. ( LDem .And. DDTFIMPG < dDtaDem ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','dDtFimPagto := DDTFIMPG     .END.','000065','000064','.EXE.','5','dDtFimPagto := DDTFIMPG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaIniRG1 := DAY(dDtIniPgto)     .CNT.','000066','000052','.EXE.','5','nDiaIniRG1 := DAY(dDtIniPgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := DAY(dDtFimPagto)     .CNT.','000067','000052','.EXE.','5','nDiaFimRG1 := DAY(dDtFimPagto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .Or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D','000068','000052','.CON.','5','','','5','((!SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+') .Or. (SRA->RA_CATFUNC$ '+"'"+'H*T*D'+"'"+' .And. P_DIASMES <> "S" )) .And. (nDiaFimRG1 > 30) .And. cVerba # FGETCODFOL("0072")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nDiaFimRG1 := 30     .END.','000069','000068','.EXE.','5','nDiaFimRG1 := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','NREF:= ( nDiaFimRG1 - nDiaIniRG1 + 1 ) - NDIASAFAS     .CNT.','000070','000052','.EXE.','5','NREF:= ( nDiaFimRG1 - nDiaIniRG1 + 1 ) - NDIASAFAS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','NVALOR := NVALOR / 30 * MIN(NREF,30)     .END.','000071','000052','.EXE.','5','NVALOR := NVALOR / 30 * MIN(NREF,30)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','lGravaRg1   .END.','000072','000011','.CON.','5','','','5','lGravaRg1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc}) .AND. FO_G','000073','000072','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc}) .AND. FO_GETVAL(@&cObjeto,cCpoTipo2) # "I"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC $ " *1"   .END.','000074','000073','.CON.','5','','','5','SRV->RV_QTDLANC $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)     .CNT.','000075','000074','.EXE.','5','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)     .CNT.','000076','000074','.EXE.','5','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)     .CNT.','000077','000074','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))     .','000078','000074','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC > "1" .AND. NVALOR > 0   .END.','000079','000073','.CON.','5','','','5','SRV->RV_QTDLANC > "1" .AND. NVALOR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nSeq := fo_count( @&cObjeto ,cCpoPd , cVerba ) + 1     .CNT.','000080','000079','.EXE.','5','nSeq := fo_count( @&cObjeto ,cCpoPd , cVerba ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cVerb','000081','000079','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cVerba,nRef,Round(nValor,2),Str(nSeq,1)},{cCpoPd,cCpoSeq},{cVerba,Str(nSeq,1)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc})  .and. SR','000082','000072','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cVerba,cCc})  .and. SRV->RV_QTDLANC <> "0" .and. (nValor > 0 .or. cTpcalc == "5")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cVerba','000083','000082','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cVerba,nRef,Round(nValor,2),cCc})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!Empty(cCodCor)   .END.','000084','000072','.CON.','5','','','5','!Empty(cCodCor)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','PosSrv(cCodCor,SRA->RA_FILIAL)     .CNT.','000085','000084','.EXE.','5','PosSrv(cCodCor,SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})   .END.','000086','000084','.CON.','5','','','5','FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC $ " *1"   .END.','000087','000086','.CON.','5','','','5','SRV->RV_QTDLANC $ " *1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)     .CNT.','000088','000087','.EXE.','5','nValSRc := FO_GETVAL(@&cObjeto,cCpoValor)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)     .CNT.','000089','000087','.EXE.','5','nHorasSrc := FO_GETVAL(@&cObjeto,cCpoHoras)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)     .CNT.','000090','000087','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoHoras,nRef+nHorasSRc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))     .','000091','000087','.EXE.','5','FO_SETVAL(@&cObjeto,cCpoValor,Round(nValor+nValSRC,2))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','SRV->RV_QTDLANC > "1" .And. nValor > 0   .END.','000092','000086','.CON.','5','','','5','SRV->RV_QTDLANC > "1" .And. nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','nSeq := fo_count( @&cObjeto ,cCpoPd , cCodCor ) + 1     .CNT','000093','000092','.EXE.','5','nSeq := fo_count( @&cObjeto ,cCpoPd , cCodCor ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cCodC','000094','000092','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoSeq},{cCodCor,nRef,Round(nValor,2),Str(nSeq,1)},{cCpoPd,cCpoSeq},{cCodCor,Str(nSeq,1)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})  .and. S','000095','000084','.CON.','5','','','5','!FO_SEEK(@&cObjeto,{cCpoPd,cCpoCC},{cCodCor,cCc})  .and. SRV->RV_QTDLANC <> "0" .and. nValor > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cCodCo','000096','000095','.EXE.','5','FO_ADD(@&cObjeto,{cCpoPd,cCpoHoras,cCpoValor,cCpoCc},{cCodCor,nRef,Round(nValor,2),cCc})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','PROCRG1','fo_Skip( @ORG1 )     .END.','000097','000007','.EXE.','5','fo_Skip( @ORG1 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

