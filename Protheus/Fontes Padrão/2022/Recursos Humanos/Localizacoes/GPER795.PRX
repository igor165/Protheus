#Include "PROTHEUS.CH"
#INCLUDE "GPER795.CH"            
#define  CRLF chr(13)+chr(10)
/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ GPER795  ³ Autor ³ R.H. - ABEL RIBEIRO   ³ Data ³ 19.09.08  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ iMPRESSAO DA DECLARACAO DE IRS                              ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ GPER795(void)                                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                             ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³         ATUALIZACOES SOFRIDAS DESDE A CONSTRU€AO INICIAL.              ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Programador ³ Data   ³ BOPS ³  Motivo da Alteracao                      ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
Function GPER795(lTerminal, cFilTerminal, cMatTerminal, cAnoTerminal)
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Variaveis Locais (Basicas)                            ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Local cDesc1  	:= STR0001            //"Declaração de IRS"
Local cDesc2  	:= STR0002           //"Ser  impresso de acordo com os parametros solicitados pelo"
Local cDesc3  	:= STR0003           //"usuario."
Local cString 	:= "RGO"             // alias do arquivo principal (Base)
Local aOrd    	:= {STR0004,STR0005} //"Matricula"###"Nr. Contribuinte###
Local aRegs	  	:= {}
Local aArea		:= GetArea()	

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Variaveis Private(Basicas)                            ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

Private aReturn 	:= { STR0006 , 1, STR0007, 2, 2, 1, "",1 } //"Branco"###"Administra‡„o"
Private nomeprog	:= "GPER795"
Private aLinha  	:= { }
Private nLastKey	:= 0
Private cPerg		:= "GPR795"

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Variaveis Private(Programa)                           ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Private nOrdem
Private aInfo	:={}
Private aRImpRet:={}
Private cAno        
Private cHtml 	:= ""
Private cFileFaz	:= ""
Private cDesEmp		:="",cDesEnd	:="",cDesCid	:="",cUf		:="",cNifRep	:="",cTpInsc	:="",cTelef		:=""
Private cDesCep 	:="",cDesBai    :="",cDesMun    :="",cDesRen	:="" 
Private cMatEmpr	:="",cNomEmpr	:="",cNifEmpr   :="",cComEmpr   :="",cEndEmpr	:="",cBaiEmpr	:="",cMunEmpr   :=""
Private cTpRen		:=""
Private cResponsa   :="",cCategoria :="",cSituacao 	:=""
Private nTotRetido  :=0
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis Utilizadas na funcao IMPR                          ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Private Titulo   := STR0008 //" DECLARAÇÃO DE RENDIMENTOS - IRS " 
Private AT_PRG   := "GPEM580"
Private COLUNAS  := 80
Private nTamanho := "P"

//Objetos p/ Impresssao Grafica 
Private oFont07
Private oFont08
Private oFont10
Private oFont14
Private oFont15
Private oFont10n
Private oFont21
Private oFont12
Private oFont16
Private oPrint
Private lFirst	:= .F. 
Private aVerba	:= {}

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Verifica se o programa foi chamado do terminal - TCF         ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
lTerminal := If( lTerminal == Nil, .F., lTerminal )

oFont07	:= TFont():New("Arial",07,07,,.F.,,,,.T.,.F.)
oFont08	:= TFont():New("Arial",08,08,,.T.,,,,.T.,.F.)		//negrito 
oFont10	:= TFont():New("Arial",10,10,,.F.,,,,.T.,.F.)
oFont10n:= TFont():New("Arial",10,10,,.T.,,,,.T.,.F.)
oFont12	:= TFont():New("MonoAs",12,12,,.F.,,,,.T.,.F.)	//Normal s/negrito
oFont12n:= TFont():New("Arial",12,12,,.T.,,,,.T.,.F.)		//Negrito
oFont13n:= TFont():New("Arial",13,13,,.T.,,,,.T.,.F.)		//Negrito
oFont13 := TFont():New("Arial",13,13,,.F.,,,,.T.,.F.)	
oFont14	:= TFont():New("Courier New",10,10,,.F.,,,,.T.,.F.)
oFont15	:= TFont():New("Arial",15,15,,.F.,,,,.T.,.F.)
oFont21 := TFont():New("Arial",21,21,,.T.,,,,.T.,.T.)
oFont16	:= TFont():New("Arial",16,16,,.T.,,,,.T.,.F.)

pergunte("GPR795",.F.)
                     
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis utilizadas para parametros                          ³
//³ mv_par01        //  Filial  De                                ³
//³ mv_par02        //  Filial  Ate                               ³
//³ mv_par03        //  Matricula De                              ³
//³ mv_par04        //  Matricula Ate                             ³
//³ mv_par05        //  C.Custo De                                ³
//³ mv_par06        //  C.Custo Ate                               ³
//³ mv_par07        //  NIF De                                    ³
//³ mv_par08        //  NIF Ate                                   ³
//³ mv_par09        //  Ano Base                                  ³
//³ mv_par10        //  Nome Responsavel                          ³
//³ mv_par11        //  Categoria                                 ³
//³ mv_par12        //  Situacao                                  ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Envia controle para a funcao SETPRINT                        ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
wnrel:="GPER795"            //Nome Default do relatorio em Disco
IF !( lTerminal )
	wnrel:=SetPrint(cString,wnrel,cPerg,@Titulo,cDesc1,cDesc2,cDesc3,.F.,aOrd,,nTamanho)

	If nLastKey == 27
		Return
	Endif

	SetDefault(aReturn,cString)

	If nLastKey == 27
		Return
	Endif
EndIf                                        

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Carregando variaveis mv_par?? para Variaveis do Sistema.     ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
cFilDe		:= IF( !( lTerminal ), mv_par01, cFilTerminal )            // Filial De
cFilAte  	:= IF( !( lTerminal ), mv_par02, cFilTerminal )            // Filial Ate
cMatDe		:= IF( !( lTerminal ), mv_par03, cMatTerminal )
cMatAte		:= IF( !( lTerminal ), mv_par04, cMatTerminal )
cCCDe		:= IF( !( lTerminal ), mv_par05, SRA->RA_CC  )	           //C.Custo De
cCCAte		:= IF( !( lTerminal ), mv_par06, SRA->RA_CC  )	           //C.Custo Ate
cNIFDe		:= IF( !( lTerminal ), mv_par07, SRA->RA_CIC  )	           //NIF De
cNIFAte		:= IF( !( lTerminal ), mv_par08, SRA->RA_CIC  )	           //NIF Ate
cAno 		:= If( !( lTerminal ), mv_par09, cAnoTerminal )
cNomeResp 	:= If( !( lTerminal ), mv_par10, cNomeResp )
cCategoria	:= IF( !( lTerminal ), mv_par11, fCategoria( NIL , .F. ))	//Categorias a Imprimir
cSituacao	:= IF( !( lTerminal ), mv_par12, fSituacao( NIL , .F. ) )	//Situacoes a Imprimir
IF !( lTerminal )
	If !lFirst
		lFirst	:= .T.
		oPrint 	:= TMSPrinter():New(STR0001) //"DECLARAÇÃO PARA EFEITO DO IMPOSTO SOBRE O RENDIMENTO DAS PESSOAS SINGULARES "
		oPrint	:SetPortrait()
	Endif
	
	RptStatus({|lEnd| GM795Imp(@lEnd,wnRel,cString,lTerminal)},Titulo)
	
	
Else                  
	cHtml:=GM795Imp(,,, lTerminal)
Endif
RestArea( aArea )
Return( IF( lTerminal , cHtml , NIL ) )

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ GM795IMP ³ Autor ³ R.H. - Abel Ribeiro   ³ Data ³ 19.09.08 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Relatorio do IRS                                           ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ GM795IMP(lEnd,WnRel,cString)                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ lEnd        - A‡Æo do Codelock                             ³±±
l±±³          ³ wnRel       - T¡tulo do relat¢rio                          ³±±
±±³Parametros³ cString     - Mensagem                                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±                                                                      1
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function GM795Imp(lEnd,WnRel,cString, lTerminal)
Local cHtml 	:= ""     
Local lQuery 	:= .F.
Local cChave	:= ""
Local aStruSRC  := {}
Local cQuery	:= ""   
Local nX
Local lAs400	:= ( TcSrvType() == "AS/400" )		//-- Retiramos a execucao da query para servidores AS/400.
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis de Acesso do Usuario                               ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

Private cAcessaRGO	:= &( " { || " + ChkRH( "GPER795" , "RGO" , "2" ) + " } " )

Private lIndRGO := .F.

nOrdem 		:= aReturn[8]

cAlias      := ""

	dbSelectArea("RGO")
	#IFDEF TOP
		IF  TcSrvType()<>"AS/400"
			lQuery 	:= .T.
			cAlias 	:= "INFREN"
			aStru 	:= RGO->(dbStruct())
                      
            cQUERY := "SELECT DISTINCT RA_FILIAL,RA_MAT,RA_CIC,RA_CATFUNC,RA_CC,RA_NOME,RA_CEP,RA_ENDEREC,RA_COMPLEM,RA_BAIRRO,RA_MUNICIP,RA_CEP,RGO_NIF,RGO_TIPREN,RGO_VLRREN,RGO_VLRRET,RGO_DESOBR,RGO_QUOTSI,RGO_VLISEN "
           	cQUERY += " FROM " + RetSqlName("RGO") + " RGO "
			cQUERY += " INNER JOIN " + RetSqlName("SRA") + " SRA ON "
			cQUERY += " RGO_FILIAL=RA_FILIAL " 
			cQUERY += " AND RGO_MAT=RA_MAT "
			cQUERY += " AND RGO_ANO='"+cANO+"'" 
			cQuery += " AND RA_FILIAL BETWEEN '"+cFilDe+"' AND '"+cFilAte+"' " 
			cQUERY += " AND RA_CC  BETWEEN '"+cCCDe+"' AND '"+cCCAte+"' " 
			cQuery += " AND RA_MAT BETWEEN '"+cMatDe+"' AND '"+cMatAte+"' " 
		    cQuery += " AND RA_CIC BETWEEN '"+cNIFDe+"' AND '"+cNIFAte+"' " 
			cQUERY += " AND SRA.D_E_L_E_T_='' "
			cQUERY += " WHERE RGO.D_E_L_E_T_='' "
			cQuery += "	ORDER BY RA_FILIAL,RA_MAT "

            cQuery := ChangeQuery(cQuery)
			dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cAlias,.T.,.T.)

			For nX := 1 To len(aStru)
				If aStru[nX][2] <> "C" .And. FieldPos(aStru[nX][1])<>0
					TcSetField(cAlias,aStru[nX][1],aStru[nX][2],aStru[nX][3],aStru[nX][4])
				EndIf
			Next nX
			dbSelectArea(cAlias)	
		Else
	#ENDIF
		(cAlias)->(MsSeek(RGO->RGO_FILIAL+RGO_ANO+RGO->RGO_MAT,.T.))
	#IFDEF TOP
		EndIf
	#ENDIF
    
	//GPProcRegua((cAlias)->(RecCount()))

    lProcessou := .F.
If (cAlias)->(!Eof()) 
   
   While (cAlias)->(!Eof()) 

	  fInfo(@aInfo,(cAlias)->RA_FILIAL)

	
	  IF !(ChkSituacao(.F.,,cSituacao)) .Or. !((cAlias)->RA_CATFUNC $ cCategoria)
	   	 dbSelectArea ( (cALIAs) )
		 (cALIAs)->(dbSkip())
		 Loop
	  EndIf	
 
	  cDesEmp 	:= aInfo[3]
      cDesEnd 	:= aInfo[4]
      cDesCid 	:= aInfo[5]
      cUf	  	:= aInfo[6]    
      cNIFRep   := aInfo[8]
      cTpInsc 	:= Str(aInfo[15],1)
      cTelef  	:= aInfo[10]
      cDesCep 	:= ainfo[7]                  
      cDesRen   := fDescRcc("S026",(cALIAs)->RGO_TIPREN,1,3,4,100)  //Busca Descrição Tipo de Rendimentos
     
      GpeR795SRD()        //VERIFICA ACUMULADO DE INFORMAÇOES COMPLEMENTARES
     
	  IF !( lTerminal )
	      fIrsGraf()      //FAZ A IMPRESSÃO DO RELATORIO  
	  Else    
	  
	  	 cMatEmpr:=(cALIAs)->RA_MAT
		 cNomEmpr:=(cALIAs)->RA_NOME
		 cNifEmpr:=(cALIAs)->RGO_NIF
	     cEndEmpr:=ALLTRIM((cALIAs)->RA_ENDEREC)
		 cComEmpr:=ALLTRIM((cALIAs)->RA_COMPLEM)
	     cBaiEmpr:=ALLTRIM(POSICIONE("SCF",1,(cALIAs)->RA_FILIAL+(cALIAs)->RA_BAIRRO,"CF_BAIRRO"))
	     cMunEmpr:=ALLTRIM(POSICIONE("CC2",3,(cALIAs)->RA_FILIAL+(cALIAs)->RA_MUNICIP,"CC2_MUN" ))
	     
		 aAdd(aRImpRet,{(cALIAs)->RGO_TIPREN,cDesRen,STR0027,(cALIAs)->RGO_VLRREN,STR0028,(cALIAs)->RGO_VLRRET,STR0029,(cALIAs)->RGO_DESOBR,STR0030,(cALIAs)->RGO_QUOTSI})
			    
      Endif
	  dbSelectArea ( (cALIAs) )
	
	  (cALIAs)->(dbSkip())
   Enddo
Endif
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Termino do relatorio                                         ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
IF ( lTerminal )       
   cHtml:=ImpRhHtm()
Else
	oPrint:Preview()  		// Visualiza impressao grafica antes de imprimir
EndIf                                                                            
DbSelectArea ( (cALIAs) )
(cAlias)->(DbCloseArea())

Return ( IF( lTerminal , cHtml , "" ) )



/*

LAY-OUT MODELO DA DECLARAÇÃO IRS
|---------------------------------------------------------------------------------| 
|                 NOME DA EMPRESA                                                 |
|                 RUA XXXXXXXXXXXXXXX                                             |
| LOGO EMPRESA    ANADIA                                                          |
|---------------------------------------------------------------------------------|

|---------------------------------------------------------------------------------|
| DECLARACAO PARA EFEITO DO IMPOSTO SOBRE O RENDIMENTO DAS PESSOAS SINGULARES     |
|                            (ANO CALENDARIO - 9999)                              |
|                       Periodo: JANEIRO    -    DEZEMBRO                         |  
|---------------------------------------------------------------------------------| 
| Declara-se para os Efeitos do disposto na alinea b) do Artigo 119 do  código    | 
| do imposto de Rendimento das pessoas singulares, que o contribuinte  abaixo,    |
| na qualidade de empregado desta empresa, durante o ano indicado,auferiu   as    |
| seguintes remunerações.                                                         |
|---------------------------------------------------------------------------------| 

|---------------------------------------------------------------------------------| 
| 1 - IDENTIFICAÇÃO DA ENTIDADE PAGADORA                                          |
----------------------------------------------------------------------------------|
| Nome: Marsilop - Sociedade de EMpreitadas - SA                                  |
| Nr. de Contribuinte: 500073090                                                  |
| Morada da Sede: Rua da Bela Vista - Anadia - Aveiro                             |
|                 3781-001 - ANADIA                                               |
|---------------------------------------------------------------------------------|

|---------------------------------------------------------------------------------| 
| 2 - IDENTIFICAÇÃO DO TITULAR DOS RENDIMENTOS                                    |
|---------------------------------------------------------------------------------|
| Nr. de Empregado: 00409                                                         |
| Nome: Acacio Amaro                                                              |
| Nr. de Contribuinte: 100086209                                                  |
| Morada: R. Padre Acúrcio, 361 - Anadia - Aveiro                                 |
|         3780-132 - SANGALHOS                                                    |
|---------------------------------------------------------------------------------| 
| TIPOS DE RENDIMENTOS: A - Trabalho Dependente                                   |
|---------------------------------------------------------------------------------|

|---------------------------------------------------------------------------------| 
| 3 - RENDIMENTOS E IMPOSTOS RETIDOS                                              |
|---------------------------------------------------------------------------------|
| 01 - Total de Rendimentos Postos a Disposição e Sujeitos a I.R.S    9,999,999.99|
| 02 - Total de I.R.S Retido..........................................9,999,999.99|
| 03 - Total das Contribuições para a Segurança Social................9,999,999.99|        
| 04 - Total das Quotizações Sindicais ...............................9,999,999.99|
|---------------------------------------------------------------------------------|

|---------------------------------------------------------------------------------| 
| 4 - REMUNERAÇÕES NÃO SUJEITAS A IRS                                             |
|---------------------------------------------------------------------------------|
| Total de Remunerações não sujeitas a IRS                            9,999.999.99|
|---------------------------------------------------------------------------------|


|---------------------------------------------------------------------------------| 
| 5 - RESPONSÀVEL PELAS INFORMAÇÔES                                               |
|---------------------------------------------------------------------------------|
| Nome                          | Nr.Contribuinte | Data | Assinatura             |
|                               |     			  |		 |		                  |
|---------------------------------------------------------------------------------|  

*/

Return(nil)       
/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³Gper795SRD      ³Autor³ Abel Ap. Ribeiro    ³Data³22/08/2008³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Inicializa o array de Verbas   								³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³<Vide Parametros Formais>									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>									³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function GpeR795SRD()
Local  NX := 0  
cFil := (cAlias)->RA_FILIAL
cMat := (cAlias)->RA_MAT
SRA->(dbSeek(cFil+cMat))
aAreaRGO := GetArea()
dbSelectArea("SRD")
#IFDEF TOP
	lQuery 		:= .T.
	cAliasTRB 	:= "qrySRD"
	aStru  		:= SRD->(dbStruct())
	cQuery 		:= "SELECT DISTINCT RA_FILIAL,RA_MAT,RGF_CODIGO,RGF_DESCRI,RGF_IRS,SUM(RD_VALOR) AS VLROUTROS "
	cQuery 		+= " FROM "+RetSqlName("SRD")+ " SRD "
	cQuery 		+= " INNER JOIN "+RetSqlName("SRA")+ " SRA ON "
	cQuery 		+= " RA_MAT='" + cMat+ "'" 
	cQuery 		+= " AND RA_FILIAL ='" + cFil + "'" 
	cQuery 		+= " AND SRA.D_E_L_E_T_='' 
	cQuery 		+= " INNER JOIN "+RetSqlName("SRV")+ " SRV ON "
	cQuery 		+= " RV_COD = RD_PD "
	cQuery 		+= " AND RV_CODGRU <> '' "
	cQuery 		+= " AND SRV.D_E_L_E_T_='' "
	cQuery 		+= " INNER JOIN "+RetSqlName("RGF")+ " RGF ON "
	cQuery 		+= " RGF_CODIGO = RV_CODGRU "
	cQuery 		+= " AND RGF_IRS='S' "	
	cQuery 		+= " AND RGF.D_E_L_E_T_='' " 
	cQuery 		+= " WHERE SRD.D_E_L_E_T_='' " 
	cQuery 		+= " AND SUBSTRING(RD_DATARQ,1,4)= '"+ cAno+"' "
	cQuery 		+= " AND RD_FILIAL  = '" + cFil + "' "
	cQuery 		+= " AND RD_MAT = '" + cMat+ "' " 
	cQuery 		+= " GROUP BY RA_FILIAL,RA_MAT,RGF_CODIGO,RGF_DESCRI,RGF_IRS "
	cQuery 		+= " ORDER BY RA_FILIAL,RA_MAT,RGF_CODIGO "
	
	cQuery := ChangeQuery(cQuery)

	dbUseArea(.T.,"TOPCONN",TcGenQry(,,cQuery),cAliasTRB,.T.,.T.)
	For nX := 1 To len(aStru)
		If aStru[nX][2] <> "C" .And. FieldPos(aStru[nX][1])<>0
			TcSetField(cAliasTRB,aStru[nX][1],aStru[nX][2],aStru[nX][3],aStru[nX][4])
		EndIf                                   
	Next nX
	dbSelectArea(cAliasTRB)	
#ELSE                                        
	cAliasTRB 	:= "SRD"                                              
	(cAliasTRB)->(MsSeek(cFIL+cMAT+cANO,.T.))
#ENDIF

DbSelectArea(cAliasTRB)	
dbGoTop()
aVerba:={}
WHILE !EOF() .and. (cAliasTRB)->RA_FILIAL+(cAliasTRB)->RA_MAT == cFIL+cMAT
      AaDD(aVerba,{(cAliasTRB)->RA_MAT,(cAliasTRB)->RGF_DESCRI,(cAliasTRB)->VLROUTROS})
      //1-MATRICULA 2=DESCRICAO DO GRUPAMENTO 3-VALOR
      (cAliasTRB)->(dbSkip() )
ENDDO      
(cAliasTRB)->(dbCloseArea() )
RETURN

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fIrpfGraf ºAutor  ³Microsiga           º Data ³  02/05/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Impressao Comprovante de rendimentos e retencao do Imp.Rendaº±±
±±º          ³Fonte - Formulario Grafico                                  º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ Especifico                                                 º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function  fIrsGraf()
Local cStartPath:= GetSrvProfString("Startpath","")
Local I
oPrint:StartPage() 			// Inicia uma nova pagina

/*ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  ³Cabecalho  Logo                                              ³
  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/

cFileFaz 	:= cStartPath+ "LGRL"+SM0->M0_CODIGO + ".BMP" 		// Empresa+Filial

nLin := 030
nLinI:= 030
//ÚÄÄÄÄÄÄÄÄÄ¿
//³Cabecalho³
//ÀÄÄÄÄÄÄÄÄÄÙ
nLin +=20 
oPrint:Box( nLinI,0030,nLin+200,2300)  				// box Cabecalho Empresa

If File(cFileFaz)
	oPrint:SayBitmap(nLinI+10,050, cFileFaz,235,195) // Tem que estar abaixo do RootPath
Endif

nLin +=20                         

oPrint:say(nLin,400 ,PADR(cDesEmp,100),oFont13n)	// Nome da Empresa 
nLin +=50
oPrint:Say(nLin,400 ,PADR(cDesEnd,100),oFont13n)	// Endereço da Empresa
nLin +=50
oPrint:Say(nLin,400,PADR(cDesCid,100),oFont13n)  	// Cidade da Empresa
 
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³1. Fonte pagadora³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
nLin +=100
nLin +=60
nLinI:=nLin -15
oPrint:Box(nLinI ,0030,nLin + 360,2300)				//box
oPrint:Say(nLin-15,400,STR0012,oFont12n)        		 	                //DECLARACAO PARA EFEITO DO IMPOSTO SOBRE O RENDIMENTO DAS PESSOAS SINGULARES "
nLin+=35 
oPrint:Say(nLin,100,PADC(STR0013+cANO+") ",200),oFont12n)         			//"(ANO CALENDARIO - 9999)"
nLin+=40 
oPrint:Say(nLin,100,PADC(STR0014+STR0041,200),oFont12n)     	            //"Periodo: "###JANEIRO - DEZEMBRO"
nLin+=50 
oPrint:Line(nLin,30,nLin,2300)
nLin+=40
oPrint:Say(nLIn,050,STR0015,ofont15) 				//"Declara-se para os Efeitos do disposto na alinea b) do Artigo 119 do  código do imposto de rendimento das pessoas"
nLin+=50 
oPrint:Say(nLIn,050,STR0016,oFont15) 	            //" singulares, que o contribuinte abaixo, na qualidade de empregado desta empresa, durante o ano indicado,auferiu   as"			 
nLin+=50 
oPrint:Say(nLIn,050,STR0017,ofont15) 				//"seguintes remunerações.  "

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³1. IDENTIFICACAO DA ENTIDADE PAGADORA³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
nLin +=100
nLin +=60  

oPrint:Box(nLin,030,nLin+340,2300)			    		  	            
nLin +=15
oPrint:Say(nLin,050,STR0018,oFont12n)                    // "1 - IDENTIFICAÇÃO DA ENTIDADE PAGADORA "
nLin +=45
oPrint:Line(nLin,030,nLin,2300)					    	 // Linha horizontal
nLin +=30
oPrint:Say(nLin,050,STR0019+cDESEMP,oFont13)             // "NOME: "
nLin +=50
oPrint:Say(nLin,050,STR0020	+cNIFREP,oFont13)            // " Nr. de Contribuinte: "
nLin +=50
oPrint:Say(nLin,050,STR0021+AllTrim(cDesEnd)+" - "+Alltrim(cDesCID)+" - "+Alltrim(cDesCid),oFont13) //" Morada da Sede: "
nLin +=50                                                                                                                       
oPrint:Say(nLin,310,AllTrim(cDesCEP)+" - "+POSICIONE("SCG",1,(cAlias)->RA_FILIAL+cDesCEP,"CG_DESCEP"),oFont13)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³2. IDENTIFICACAO DO TITULAR DOS RENDIMENTOS³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
nLin +=100
nLin +=60  
oPrint:Box(nLin,030,nLin+420,2300)			    		  	            
nLin +=15
oPrint:Say(nLin,050,STR0022,oFont12n)                     //"2 - IDENTIFICACAO DO TITULAR DOS RENDIMENTOS "
nLin +=45
oPrint:Line(nLin,030,nLin,2300)							  //Linha horizontal
nLin +=30
oPrint:Say(nLin,050,STR0023+(cAlias)->RA_MAT,oFont13)     //" Nr. de Empregado: "
nLin +=50
oPrint:Say(nLin,050,STR0019+(cAlias)->RA_NOME,oFont13)    //" Nome: "
nLin +=50                  
oPrint:Say(nLin,050,STR0020+(cAlias)->RGO_NIF,oFont13)    //" Nr. de Contribuinte: "
nLin +=50
oPrint:Say(nLin,050,STR0024+ALLTRIM((cAlias)->RA_ENDEREC)+" "+ALLTRIM((cAlias)->RA_COMPLEM)+" - "+Alltrim(cDesBai)+" - "+ALLTRIM(cDesMun),oFont13) //"MORADA
nLin +=50                  
oPrint:Say(nLin,230,(cAlias)->RA_CEP+" - "+POSICIONE("SCG",1,(cAlias)->RA_FILIAL+(cAlias)->RA_CEP,"CG_DESCEP"),oFont13)
nLin +=75                  
oPrint:Line(nLin,30,nLin,2300)
oPrint:Say(nLin,100,STR0025 + " "+(cAlias)->RGO_TIPREN + " - " + cDesRen,oFont12n)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³3. RENDIMENTOS E IMPOSTOS RETIDOS        ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
nLin +=100
nLin +=60  
oPrint:Box(nLin,030,nLin+60,2300)			    		  	            
nLin +=15                             
oPrint:Say(nLin,050,STR0026,oFont12n)                        //"3 - RENDIMENTOS E IMPOSTOS RETIDOS "
nLin +=40
oPrint:Say(nLin,027,"| ",oFont13) 
oPrint:Say(nLin,2297,"| ",oFont13) 

//oPrint:Line(nLin,030,nLin,2300)					  		     //Linha horizontal
nLin +=30

oPrint:Say(nLin,028,"| ",oFont13) 
oPrint:Say(nLin,052,STR0027,oFont13)                                                //"01 - Total de Rendimentos Postos a Disposição e Sujeitos a I.R.S"
oPrint:Say(nLin,IIF((cAlias)->RGO_VLRREN > 0,2060,2140),TRANSFORM((cAlias)->RGO_VLRREN,"@R ###,###,##9.99"),oFont12n)  
oPrint:Say(nLin,2297,"| ",oFont13)

nLin +=35
oPrint:Say(nLin,028,"| ",oFont13) 
oPrint:Say(nLin,052,STR0028,oFont13)                                                //"02 - Total de I.R.S Retido.........................................."
oPrint:Say(nLin,IIF((cAlias)->RGO_VLRRET > 0,2050,2140),TRANSFORM((cAlias)->RGO_VLRRET,"@B 999,999,999.99"),oFont12n) 
oPrint:Say(nLin,2297,"| ",oFont13)

nLin +=35                  
oPrint:Say(nLin,028,"| ",oFont13) 
oPrint:Say(nLin,052,STR0029,oFont13) 											    //"03 - Total das Contribuições para a Segurança Social................"


oPrint:Say(nLin,IIF((cAlias)->RGO_DESOBR > 0,2050,2140),TRANSFORM((cAlias)->RGO_DESOBR,"@E 999,999,999.99"),oFont12n) 

oPrint:Say(nLin,2297,"| ",oFont13)

nLin +=35
oPrint:Say(nLin,028,"| ",oFont13) 
oPrint:Say(nLin,052,STR0030,oFont13)   												//"04 - Total das Quotizações Sindicais ..............................."
oPrint:Say(nLin,IIF((cAlias)->RGO_QUOTSI > 0,2050,2140),TRANSFORM((cAlias)->RGO_QUOTSI,"@E 999,999,999.99"),oFont12n) 
oPrint:Say(nLin,2297,"| ",oFont13)
//-------------------------------------------------------------------------//
//Imprime Valores Complementares definidos pelo Usuário no grupo de verbas //
//-------------------------------------------------------------------------//
nItem := 5
IF Len(aVerba) > 0																	
   FOR I = 1 TO Len(aVerba)
       nLin +=35
       oPrint:Say(nLin,028,"| ",oFont13) 
       oPrint:Say(nLin,052,STRZERO(nITEM,2)+" - ",oFont13)
       oPrint:Say(nLin,125,aVERBA[I,2],oFont13) 
       oPrint:Say(nLin,IIF(aVerba[I,3] > 0,2050,2140),TRANSFORM(aVerba[I,3],"@E 999,999,999.99"),oFont12n) 
       oPrint:Say(nLin,2297,"| ",oFont13)
       nITEM ++ 
   NEXT
ENDIF       
nLin +=35
oPrint:Say(nLin,028,"| ",oFont13) 
oPrint:Say(nLin,2297,"| ",oFont13)
nLin +=45
oPrint:Line(nLin,028,nLin,2300)					  		     //Linha horizontal

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³4. REMUNERAÇÃO NÃO SUJEITAS A IRS        ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
nLin +=100
nLin +=60  
oPrint:Box(nLin,030,nLin+240,2300)			    		  	            
nLin +=15
oPrint:Say(nLin,050,STR0036,oFont12n)                        //4. REMUNERAÇÃO NÃO SUJEITAS A IRS 
nLin +=45
oPrint:Line(nLin,030,nLin,2300)					  		     //Linha horizontal
nLin +=30
oPrint:Say(nLin,050,STR0037,oFont13)                         //"01 - Total de Remuneração não sujeitas a IRS"
oPrint:Say(nLin,IIF((cAlias)->RGO_VLISEN > 0,2050,2140),TRANSFORM((cAlias)->RGO_VLISEN,"@E 999,999,999.99"),oFont12n) 
                                                                            
nLin +=50
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³5. RESPONSÁVEL PELAS INFORMAÇÕES         ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
nLin +=100
nLin +=60  
nLinI:=nLin

oPrint:Box(nLinI,030,nLin+180,2300)	
nLin +=15
oPrint:Say(nLin,050,STR0033,oFont12n)                            //"5 - RESPONSÀVEL PELAS INFORMAÇÔES"
nLin +=45
oPrint:Line(nLin,030,nLin,2300)					  		         //Linha horizontal

oPrint:Line(nLin,1200,nLin+120,1200)
oPrint:Line(nLin,1540,nLin+120,1540)
oPrint:Line(nLin,1740,nLin+120,1740)

nLin +=20
oPrint:Say(nLin,050,STR0039,oFont10)
oPrint:Say(nLin,1220,STR0038,oFont10) 
oPrint:Say(nLin,1560,STR0035,oFont10) 
oPrint:Say(nLin,1760,STR0040,oFont10) 
nLin +=40
oPrint:Say(nLin,050,MV_par10,oFont13) 
oPrint:Say(nLin,1220,cNIFREP,oFont13) 
oPrint:Say(nLin,1560,dtoc(dDataBase),oFont13) 

oPrint:EndPage() 		// Finaliza a pagina

Return


Static Function ImpRhHtm()
Local cHtml:=""  
Local nqTD    := 0
Local n    := 0

Local nTam := 0
cFileFaz 	:= TcfRetDirImg() +"/receita.gif"
cHtml :=	'<html>' 
cHtml +=	 '<head>' 
cHtml +=	' <title>' + "Informe de Rendimento" + '</title>' 
cHtml +=	'  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">' 
cHtml +=	'  <link rel="stylesheet" href="css/rhonline.css" type="text/css">' 



If cFrame = "1"               
	cHtml +=	'<script language="JavaScript">' + CRLF
	cHtml +=		'<!--' + CRLF
	cHtml +=			'function Imprimir()' + CRLF
	cHtml +=			'{' + CRLF
	cHtml +=				'var val_body1	= parent.mainFrame.document.body.innerHTML;' + CRLF
	cHtml +=				'var val_body2	= parent.bottomFrame.document.body.innerHTML;' + CRLF
	cHtml +=				'parent.mainFrame.document.body.innerHTML = val_body2;' + CRLF
	cHtml +=				'parent.mainFrame.print();' + CRLF
	cHtml +=				'parent.mainFrame.document.body.innerHTML = val_body1;' + CRLF
	cHtml +=			'}' + CRLF
	cHtml +=		' -->' + CRLF
	cHtml +=	'</script>' + CRLF
EndIf                       

cHtml +=	'</head>' 
cHtml +=	'<body bgcolor="#FFFFFF" text="#000000">' 
For n:=1 To Len(aRImpRet)
	If cFrame = "1"               
		cHtml +=	'  <Table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">' 
	Else
		cHtml +=	'  <Table width="90%" border="0" cellspacing="0" cellpadding="0" align="center">' 
	EndIf
	
	CabHtmPtg(@cHtml)
	ntam:=14
	cHtml +=	'	<TR><TD colspan="2" height="30"></TD></TR>' 
	cHtml +=	'	<TR><TD colspan="2">' 
	cHtml +=	'		<table width="100%"  border="1" cellspacing="0" cellpadding="0">' 
	cHtml +=	'			<TR>
	cHtml +=	'				<TD colspan="2">' 
	cHtml +=	'					<b><span class="menu_titulo">' + STR0018 + '</span></b>' //"1 - IDENTIFICAÇÃO DA ENTIDADE PAGADORA "
	cHtml +=	'				</TD>' 
	cHtml +=	'			</TR>'                                         
	cHtml +=	'			<TR>' 
	cHtml +=	'				<TD><BR><span class="dados">&nbsp;&nbsp;&nbsp;' +STR0019+cDESEMP+'</span></BR></TD>'//" Nome: " 
	cHtml +=	'			</TR>'
	cHtml +=	'			<TR>' 
	cHtml +=	'				<TD><BR><span class="dados">&nbsp;&nbsp;&nbsp;' +STR0020+cNIFREP+'</span></BR></TD>'//" Nr. de Contribuinte: " 
	cHtml +=	'			</TR>'
	cHtml +=	'			<TR>'  
	cHtml +=	'				<TD><BR><span class="dados">&nbsp;&nbsp;&nbsp;' +STR0021+AllTrim(cDesEnd)+" - "+Alltrim(cDesCID)+" - "+Alltrim(cDesCid)+'</span></BR></TD>'//" Morada da Sede: " 
	cHtml +=	'			</TR>' 
	cHtml +=	'		</table>' 
	cHtml +=	'	</TD></TR>' 
	cHtml +=	'	<TR><TD colspan="2" height="30"></TD></TR>' 
	cHtml +=	'	<TR><TD colspan="2">' 
	cHtml +=	'		<table width="100%"  border="1" cellspacing="0" cellpadding="0">' 
	cHtml +=	'			<TR>
	cHtml +=	'				<TD colspan="2">' 
	cHtml +=	'					<b><span class="menu_titulo">' + STR0022 + '</span></b>'//"2 - IDENTIFICACAO DO TITULAR DOS RENDIMENTOS " 
	cHtml +=	'				</TD>' 
	cHtml +=	'			</TR>' 
	cHtml +=	'			<TR>'    
	cHtml +=	'				<TD><BR><span class="dados">&nbsp;&nbsp;&nbsp;' +STR0023+cMatEmpr+'</span></BR></TD>'//" Nr. de Empregado: " 
	cHtml +=	'			</TR>'
	cHtml +=	'			<TR>'  
	cHtml +=	'				<TD><BR><span class="dados">&nbsp;&nbsp;&nbsp;' +STR0019+cNomEmpr+'</span></BR></TD>'//" Nome: " 
	cHtml +=	'			</TR>'
	cHtml +=	'			<TR>'  
	cHtml +=	'				<TD><BR><span class="dados">&nbsp;&nbsp;&nbsp;' +STR0020+cNifEmpr+'</span></BR></TD>'//" Nr. de Contribuinte: " 
	cHtml +=	'			</TR>'
	cHtml +=	'			<TR>'  
	cHtml +=	'				<TD><BR><span class="dados">&nbsp;&nbsp;&nbsp;' +STR0024+cEndEmpr+" "+cComEmpr+" - "+cBaiEmpr+" - "+cMunEmpr+'</span></BR></TD>'//" Morada: " 
	cHtml +=	'			</TR>'          
	cHtml +=	'			<TR>
	cHtml +=	'				<TD colspan="2">' 
	cHtml +=	'					<b><span class="menu_titulo">' + STR0025 +Alltrim(aRImpRet[n][1])+"-"+Alltrim(aRImpRet[n][2])+'</span></b>'//"TIPOS DE RENDIMENTOS: " 
	cHtml +=	'				</TD>' 
	cHtml +=	'			</TR>' 
	cHtml +=	'		</table>' 
	cHtml +=	'	</TD></TR>'      
	cHtml +=	'	<TR><TD colspan="2" height="30"></TD></TR>' 
	cHtml +=	'	<TR><TD colspan="2">' 
	cHtml +=	'		<table width="100%"  border="1" cellspacing="0" cellpadding="2">' 
	cHtml +=	'			<TR>
	cHtml +=	'				<TD colspan="2">' 
	cHtml +=	'					<b><span class="menu_titulo">' +STR0026 + '</span></b>'//"3 - RENDIMENTOS E IMPOSTOS RETIDOS " 
	cHtml +=	'				</TD>' 
	cHtml +=	'			</TR>'
	cHtml +=	'			<tr>'
	cHtml +=	'				<td width="60%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + Alltrim(aRImpRet[n][3]) + '</span></TD>' //"01 - Total de Remuneração não sujeitas a IRS"
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>'     
	cHtml +=	'				</td>'
	cHtml +=	'				<td width="40%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'				            <TD align="right"><span class="dados">' + Transform(aRImpRet[n][4],"@E 999,999,999.99") + '</span></TD>' 
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>'
	cHtml +=	'			</tr>'  
	cHtml +=	'			<tr>'
	cHtml +=	'				<td width="60%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + Alltrim(aRImpRet[n][5]) + '</span></TD>' //"02 - Total de I.R.S. Retido
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>'     
	cHtml +=	'				</td>'
	cHtml +=	'				<td width="40%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'				            <TD align="right"><span class="dados">' + Transform(aRImpRet[n][6],"@E 999,999,999.99") + '</span></TD>' 
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>'
	cHtml +=	'			</tr>'  
	cHtml +=	'			<tr>'
	cHtml +=	'				<td width="60%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + Alltrim(aRImpRet[n][7]) + '</span></TD>' //"03 - Total das Contribuicoes para a Seguranca Social
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>'     
	cHtml +=	'				</td>'
	cHtml +=	'				<td width="40%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'				            <TD align="right"><span class="dados">' + Transform(aRImpRet[n][8],"@E 999,999,999.99") + '</span></TD>' 
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>'
	cHtml +=	'			</tr>'  
	cHtml +=	'			<tr>'
	cHtml +=	'				<td width="60%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + Alltrim(aRImpRet[n][9]) + '</span></TD>' //"04 - Total das Quotizacoes Sindicais
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>'     
	cHtml +=	'				</td>'
	cHtml +=	'				<td width="40%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'				            <TD align="right"><span class="dados">' + Transform(aRImpRet[n][10],"@E 999,999,999.99") + '</span></TD>' 
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>'
	cHtml +=	'			</tr>'  
	For nQtd:=1  To Len(aVerba)
		cHtml +=	'			<tr>'
		cHtml +=	'				<td width="60%">' 
		cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
		cHtml +=	'						<TR>' 
		cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + StrZero(4+nQtd,2)+"-"+Alltrim(aVerba[nQtd][2]) + '</span></TD>' //"04 - Total das Quotizacoes Sindicais
		cHtml +=	'						</TR>' 
		cHtml +=	'					</table>'     
		cHtml +=	'				</td>'
		cHtml +=	'				<td width="40%">' 
		cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
		cHtml +=	'						<TR>' 
		cHtml +=	'				            <TD align="right"><span class="dados">' + Transform(aVerba[nQtd][3],"@E 999,999,999.99") + '</span></TD>' 
		cHtml +=	'						</TR>' 
		cHtml +=	'					</table>' 
		cHtml +=	'				</td>'
		cHtml +=	'			</tr>'  
	Next
	cHtml +=	'		</table>' 
	cHtml +=	'	</TD></TR>' 
	cHtml +=	'	<TR><TD colspan="2" height="10"></TD></TR>' 
	cHtml +=	'	<TR><TD colspan="2">' 
	cHtml +=	'		<table width="100%"  border="1" cellspacing="0" cellpadding="0">' 
	cHtml +=	'			<TR>'
	cHtml +=	'				<TD width="100%">' 
	cHtml +=	'					<b><span class="menu_titulo">' + STR0031 + '</span></b>'//"4 - REMUNERAÇÕES NÃO SUJEITAS A IRS"  
	cHtml +=	'				</TD>' 
	cHtml +=	'			</TR>' 
	cHtml +=	'			<tr>'
	cHtml +=	'				<td width="60%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + STR0037 + '</span></TD>' //"01 - Total de Remuneração não sujeitas a IRS"
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>'     
	cHtml +=	'				</td>'      
	cHtml +=	'				<td width="40%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'				            <TD align="right"><span class="dados">' + Transform(aRImpRet[n][4],"@E 999,999,999.99") + '</span></TD>' 
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>'
	cHtml +=	'			</tr>'  
	cHtml +=	'		</table>' 
	cHtml +=	'	</TD></TR>' 
	cHtml +=	'	<TR><TD colspan="2" height="30"></TD></TR>' 	
	cHtml +=	'	<TR><TD colspan="2">' 
	cHtml +=	'		<table width="100%"  border="1" cellspacing="0" cellpadding="0">' 
	cHtml +=	'			<TR>'
	cHtml +=	'				<TD width="80%">' 
	cHtml +=	'					<b><span class="menu_titulo">' + STR0033 + '</span></b>'//"5 - RESPONSÀVEL PELAS INFORMAÇÔES" 
	cHtml +=	'				</TD>' 
	cHtml +=	'			</TR>' 
	cHtml +=	'			<tr>'
	cHtml +=	'				<td width="45%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="etiquetas_2">' + STR0039 + '</span></TD>'//"Nome"
	cHtml +=	'						</TR>' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + cNomeResp + '</span></TD>' 
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>' 
	cHtml +=	'				<td width="20%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="etiquetas_2">' + STR0038 + '</span></TD>'//" Nr. de Contribuinte" 
	cHtml +=	'						</TR>' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + cNIFREP + '</span></TD>'
	cHtml +=	'						</TR>'                                                    
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>'
	cHtml +=	'				<td width="15%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="etiquetas_2">' + STR0035 + '</span></TD>'//"Data"  
	cHtml +=	'						</TR>' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="dados">&nbsp;&nbsp;&nbsp;' + dtoc(dDataBase) + '</span></TD>'
	cHtml +=	'						</TR>'                                                    
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>' 
	cHtml +=	'				<td width="20%">' 
	cHtml +=	'					<table border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span class="etiquetas_2">' + STR0040 + '</span></TD>'//"Assinatura	" 
	cHtml +=	'						</TR>' 
	cHtml +=	'						<TR>' 
	cHtml +=	'							<TD><span>&nbsp;&nbsp;&nbsp;</span></TD>' 
	cHtml +=	'						</TR>' 
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>'
	cHtml +=	'			</tr>'
	cHtml +=	'		</table>' 
	cHtml +=	'	</TD></TR>'              
	cHtml +=	'	<TR><TD colspan="2" height="5"></TD></TR>' 
	cHtml +=	' </Table>'   
Next
If cFrame = "1"
	cHtml += '<p align="right"><a href="javascript:Imprimir();"><img src="imagens/imprimir.gif" width="90" height="28" hspace="20" border="0"></a></p>' 
EndIf
cHtml +=	'</body>' 
cHtml +=	'</html>' 

Return cHtml    
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³CabecHtml ºAutor  ³Tatiane V. Matias   º Data ³  23/01/06   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Impressao do cabecalho do Informe de Rendimento - HTML      º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ Especifico                                                 º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function CabHtmPtg(cHtml)
	cHtml +=	'	<TR>' 
	cHtml +=	'		<TD  colspan="2">' 
	cHtml +=	'			<table width="100%"  border="1" cellspacing="0" cellpadding="0">' 
	cHtml +=	'			  <tr>' 
	cHtml +=	'				<td>' 
	cHtml +=	'					<table width="100%"  border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'					  <tr align="center">' 
	cHtml +=	'						<td width="10%" rowspan="2" height="10%"><img src="' + cFileFaz + '" width="70" height="70" align=left></td>' 
	cHtml +=	'					  </tr>' 
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>' 
	cHtml +=	'					<td>' 
	cHtml +=	'						<table width="100%"  border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'					  		<tr align="center">' 
	cHtml +=	'								<td align="center"><b><span class="menu_titulo_2">' + PADR(cDesEmp,100) + '</span></b></td>'	// Nome da Empresa 	 
	cHtml +=	'					  		</tr>' 
	cHtml +=	'					  		<tr align="center">' 
	cHtml +=	'								<td><span class="menu_titulo_2">' +PADR(cDesEnd,100)+ '</span></td>'// Endereço da Empresa 
	cHtml +=	'					    	</tr>' 
	cHtml +=	'					  		<tr align="center">' 
	cHtml +=	'								<td><span class="menu_titulo_2">' + PADR(cDesCid,100) + '</span></td>'// Cidade da Empresa 
	cHtml +=	'					  		</tr>' 
	cHtml +=	'				  		</table>' 
	cHtml +=	'					</td>' 
	cHtml +=	'			 	</tr>' 
	cHtml +=	'			</table>' 
	cHtml +=	'		<TD>' 
	cHtml +=	'	</TR>'                        
	cHtml +=	'	<TR>' 
	cHtml +=	'		<TD  colspan="2">' 
	cHtml +=	'			<table width="100%"  border="1" cellspacing="0" cellpadding="0">' 
	cHtml +=	'			  <tr>' 
	cHtml +=	'				<td>' 
	cHtml +=	'					<table width="100%"  border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'					  <TR><TD colspan="2" height="40"></TD></TR>' 	
	cHtml +=	'					  <tr align="center">' 
	cHtml +=	'						<td><span class="titulo_opcao">' + STR0012 + '</span></td>' 
	cHtml +=	'					  </tr>' 
	cHtml +=	'					  <tr align="center">' 
	cHtml +=	'						<td><span class="titulo_opcao">' + STR0013+cAno+")" + '</span></td>' 
	cHtml +=	'					  </tr>' 
	cHtml +=	'					  <tr align="center">' 
	cHtml +=	'						<td><span class="titulo_opcao">' + STR0014 +STR0041+ '</span></td>' 
	cHtml +=	'					  </tr>'        
	cHtml +=	'					  <TR><TD colspan="2" height="40"></TD></TR>' 	
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>' 
	cHtml +=	'			 </tr>' 
	cHtml +=	'			</table>' 	
	cHtml +=	'			<table width="100%"  border="1" cellspacing="0" cellpadding="0">' 
	cHtml +=	'			  <tr>' 
	cHtml +=	'				<td>' 
	cHtml +=	'					<table width="100%"  border="0" cellspacing="0" cellpadding="0">' 
	cHtml +=	'					  <TR><TD colspan="2" height="40"></TD></TR>' 		
	cHtml +=	'					  <tr align="left">' 
	cHtml +=	'						<td><span class="texto_2">' + STR0015+STR0016+STR0017+ '</span></td>' 
	cHtml +=	'					  </tr>'                                                                  
	cHtml +=	'					  <TR><TD colspan="2" height="40"></TD></TR>' 	
	cHtml +=	'					</table>' 
	cHtml +=	'				</td>' 
	cHtml +=	'			 </tr>' 
	cHtml +=	'			</table>' 	
	cHtml +=	'		<TD>' 
	cHtml +=	'	</TR>' 
Return cHtml

