#INCLUDE "PROTHEUS.CH"

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³GpForBRA      ³Autor³ Gerado pelo sistema ³ Data ³04/10/2022³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Formulas padroes                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³                                                            ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³ Uso      ³Generico                                                    ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function GpForBRA()

Local aRC2Header  := {}
Local aRC3Header  := {}
Local aSYPHeader  := {}

Local bForm	    := NIL

Local cFormNum
Local cForm

Local lRet        := .T.
Local nItem       := 0

Private lFilRPO     := SuperGetMv('MV_RPOFIL',, .F.) .and. xFilial('SRY') <> xFilial('RC2')

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Cabecalho de RC2 e RC3 gerado pela formula padrao            ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
aAdd(aRC2Header, { 'Filial','RC2_FILIAL','',,'0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Origem','RC2_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','S_=Sistema;U_=Usuario                                                                                                           ','"U_"','','V','','','.T.' })
aAdd(aRC2Header, { 'Cod. Formula','RC2_CODIGO','@!','15','0','RC2CodigoVld()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','                                                                                                                                ','','','A','','','.T.' })
aAdd(aRC2Header, { 'Desc.Formula','RC2_DESC','@!','40','0','NaoVAzio()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.T.' })
aAdd(aRC2Header, { 'Retorno','RC2_RETURN','@!','10','0','Vazio() .or. ExistCpo("RCA")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','RCA01 ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC2Header, { 'Cod. Observ.','RC2_CODOBS','@!','6','0','NaoVazio()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Versao Form.','RC2_VERSAO','','3','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x   x   ','C','      ','R','                                                                                                                                ','','','V','','','.F.' })
aAdd(aRC2Header, { 'Recompilar','RC2_RECOMP','9','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Sim;2=Nao                                                                                                                     ','"1"','','V','','','.F.' })
aAdd(aRC2Header, { 'Modelo Folha','RC2_MODELO','@!','1','0','Pertence("12")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ','R','1=Folha Modelo 1;2=Folha Modelo 2                                                                                               ','fGetModFol()','','V','','','.F.' })

aAdd(aRC3Header, { 'Filial','RC3_FILIAL','',,'0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Origem','RC3_ORIGEM','@!','2','0','NaoVazio() .and. Pertence("S_U_")','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','S_=Sistema;U_=Usuario                                                                                                           ','"U_"','','V','','','.F.' })
aAdd(aRC3Header, { 'Cod. Formula','RC3_CODIGO','@!','15','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x xx    ','C','      ','R','                                                                                                                                ','','','V','','','.T.' })
aAdd(aRC3Header, { 'Descricao','RC3_DESCR','@!S31','60','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Seq.','RC3_SEQFOR','999999','6','0','NaoVazio() .and. Gpea290SeqFor( .T. )','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','Gpea290SeqFor()','SeqWhen()',' ','','','.F.' })
aAdd(aRC3Header, { 'Cod Seq. Pai','RC3_SEQPAI','999999','6','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Expr.','RC3_TIPO','@!','5','0','NaoVazio()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp1','RC3_TPRESU','@!','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','"2"','','V','','','.F.' })
aAdd(aRC3Header, { 'Resultado','RC3_RESULT','@!S25','250','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.1','RC3_OPERA1','@!','16','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp2','RC3_TPFM01','@!','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '1a.Expressao','RC3_FORM01','@!S25','250','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.2','RC3_OPERA2','@!','5','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Tp3','RC3_TPFM02','@!','1','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','"1"','','V','','','.F.' })
aAdd(aRC3Header, { '2a.Expressao','RC3_FORM02','@!S25','250','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aRC3Header, { 'Op.3','RC3_OPERA3','@!','5','0','Gpea290Return()','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','".END."','',' ','','','.F.' })
aAdd(aRC3Header, { 'Imagem 1','RC3_RESOU1','@!','20','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })
aAdd(aRC3Header, { 'Imagem 2','RC3_RESOU2','@!','20','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ','R','                                                                                                                                ','','','A','','','.F.' })

aAdd(aSYPHeader, { 'Filial','YP_FILIAL','',,'0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x       ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Chave','YP_CHAVE','','6','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Sequencia','YP_SEQ','','3','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Linha','YP_TEXTO','','80','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })
aAdd(aSYPHeader, { 'Campo','YP_CAMPO','','10','0','','x       x       x       x       x       x       x       x       x       x       x       x       x       x       x x     ','C','      ',' ','                                                                                                                                ','','',' ','','','.F.' })

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Só carrega se estiver utilizando modelo padrão do pais.       ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
If !(MV_MODFOL == "1")
	Return
EndIf

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Validar a Estrutura das Tabela RC2 e RC3 com a do Cliente     ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
lRet := fNewOldSx3(aRC2Header, aRC3Header, "RC2", "RC3",.F.)
lRet := If( lRet , fNewOldSx3(aSYPHeader, NIL, "SYP") , lRet)

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Executar gravacao da formula.                                 ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
If ( lRet )

	/*/
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Chamada da funcao de gravacao                                ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
	cFormNum := "0000"
	For nItem := 1 To 397
		cFormNum	:= __Soma1( cFormNum )
		cForm		:= ( "Add" + cPaisLoc + cFormNum )
		If IsFunction( cForm )
			bForm := __ExecMacro( '{ ||' +  cForm + '( aRc2Header , aRc3Header, aSYPHeader ) }' )
			CheckExecForm( bForm , .T. , 'ERRADDFRM' , cForm )
		EndIf
	Next nItem

EndIf

Return( NIL )


/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0001    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0001( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','13CNTVA','13 CONTRATO VERDE/AMARELO','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','13CNTVA','NCONT := 1','000001','000000','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','SRA->RA_CATEFD $ '+"'"+'107/108'+"'"+'','000002','000000','.CON.','5','','','5','SRA->RA_CATEFD $ '+"'"+'107/108'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NSAL := SALARIO','000003','000002','.EXE.','5','NSAL := SALARIO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','RETVALSRV(ACODFOL[0024,1], SRA->RA_FILIAL, "RV_BASCAL") == "','000004','000002','.CON.','5','','','5','RETVALSRV(ACODFOL[0024,1], SRA->RA_FILIAL, "RV_BASCAL") == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NSAL := SALMES','000005','000004','.EXE.','5','NSAL := SALMES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NADCCONF > 0 .AND. RETVALSRV(CCODCONF, SRA->RA_FILIAL, "RV_I','000006','000004','.CON.','5','','','5','nAdcConf > 0 .And. RetValSRV(cCodConf, SRA->RA_FILIAL, "RV_INCORP") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NSAL -= NADCCONF','000007','000006','.EXE.','5','nSal -= nAdcConf','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NADCTRF > 0 .AND. RETVALSRV(CCODTRF, SRA->RA_FILIAL, "RV_INC','000008','000004','.CON.','5','','','5','nAdcTrf > 0 .And. RetValSRV(cCodTrf, SRA->RA_FILIAL, "RV_INCORP") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NSAL -= NADCTRF','000009','000008','.EXE.','5','nSal -= nAdcTrf','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NCONT <= LEN(AADTSERV)','000010','000004','.ENQ.','5','','','5','nCont <= Len(aAdtServ)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','RETVALSRV(AADTSERV[NCONT][1], SRA->RA_FILIAL, "RV_INCORP") =','000011','000010','.CON.','5','','','5','RetValSRV(aAdtServ[nCont][1], SRA->RA_FILIAL, "RV_INCORP") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NSAL -= AADTSERV[NCONT][3]','000012','000011','.EXE.','5','nSal -= aAdtServ[nCont][3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NCONT++','000013','000010','.EXE.','5','nCont++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NPERIC > 0 .AND. RETVALSRV(CCODPER, SRA->RA_FILIAL, "RV_INCO','000014','000004','.CON.','5','','','5','nPeric > 0 .And. RetValSRV(cCodPer, SRA->RA_FILIAL, "RV_INCORP") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NSAL -= NPERIC','000015','000014','.EXE.','5','nSal -= nPeric','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NINSALUB > 0 .AND. RETVALSRV(CCODINS, SRA->RA_FILIAL, "RV_IN','000016','000004','.CON.','5','','','5','nInsalub > 0 .And. RetValSRV(cCodIns, SRA->RA_FILIAL, "RV_INCORP") == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NSAL -= NINSALUB','000017','000016','.EXE.','5','nSal -= nInsalub','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','N13INT := NSAL / 12 / 30 * DIASTRAB','000018','000002','.EXE.','5','N13INT := NSAL / 12 / 30 * DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','FGERAVERBA(FGETCODFOL("0024"),N13INT)','000019','000002','.EXE.','5','FGERAVERBA(FGETCODFOL("0024"),N13INT)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NADCCONF > 0','000020','000002','.CON.','5','','','5','nAdcConf > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NCONF := NADCCONF / 12 / 30 * DIASTRAB','000021','000020','.EXE.','5','nConf := nAdcConf / 12 / 30 * DiasTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','FGERAVERBA(FGETCODFOL("1294"), NCONF)','000022','000020','.EXE.','5','fGeraVerba(fGetCodFol("1294"), nConf)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NADCTRF > 0','000023','000002','.CON.','5','','','5','nAdcTrf > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NTRF := NADCTRF / 12 / 30 * DIASTRAB','000024','000023','.EXE.','5','nTrf := nAdcTrf / 12 / 30 * DiasTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','FGERAVERBA(FGETCODFOL("1295"), NTRF)','000025','000023','.EXE.','5','fGeraVerba(fGetCodFol("1295"), nTrf)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NADTSERV > 0','000026','000002','.CON.','5','','','5','nAdtServ > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NADT := NADTSERV / 12 / 30 * DIASTRAB','000027','000026','.EXE.','5','nAdt := nAdtServ / 12 / 30 * DiasTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','FGERAVERBA( IIF( CBCALATS != "2", FGETCODFOL("1288"), FGETCO','000028','000026','.EXE.','5','fGeraVerba( Iif( cBCalAts != "2", fGetCodFol("1288"), fGetCodFol("1289")), nAdt)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NPERIC > 0','000029','000002','.CON.','5','','','5','nPeric > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NPER := NPERIC / 12 / 30 * DIASTRAB','000030','000029','.EXE.','5','nPer := nPeric / 12 / 30 * DiasTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','FGERAVERBA( IIF( CBCALPER  $ "1/3/4/5", FGETCODFOL("1290"),','000031','000029','.EXE.','5','fGeraVerba( Iif( cBCalPer  $ "1/3/4/5", fGetCodFol("1290"), fGetCodFol("1291")), nPer)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NINSALUB > 0','000032','000002','.CON.','5','','','5','nInsalub > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','NINS := NINSALUB / 12 / 30 * DIASTRAB','000033','000032','.EXE.','5','nIns := nInsalub / 12 / 30 * DiasTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13CNTVA','fGeraVerba( Iif( fBuscaRG4("RCE_BCALIN",dDataAte,.T.,.T.) $','000034','000032','.EXE.','5','fGeraVerba( Iif( fBuscaRG4("RCE_BCALIN",dDataAte,.T.,.T.) $ "1256", fGetCodFol("1292"), fGetCodFol("1293")), nIns)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0002    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0002( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','13INTERM','13 CONTRATO INTERMITENTE','','','011','2','1',} )

aAdd(aRc3Cols, { '','S_','13INTERM','SRA->RA_TPCONTR == "3"','000001','000000','.CON.','5','','','5','SRA->RA_TPCONTR == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13INTERM','CTIPOROT != "4"','000002','000001','.CON.','5','','','5','CTIPOROT != "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13INTERM','NDIASAFAS  > 15','000003','000002','.CON.','5','','','5','NDIASAFAS  > 15','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13INTERM','N13INT := ( ( NSALPG + NDSRINT + (SALMES - ( NSALPG','000004','000003','.EXE.','5','N13INT := ( ( NSALPG + NDSRINT + MAX((SALMES+(NSALPG + NDSRINT) - SALARIO) - ( NSALPG + NDSRINT ), 0)) / 12 / MAX( ACONVOCACAO[7] * MAX(NDIASC,ACONVOCACAO[5]) , (NHORASTRAB + NHORASDSR))) * (NHORASTRAB + NHORASDSR)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13INTERM','NDIASAFAS  <= 15','000005','000002','.CON.','5','','','5','NDIASAFAS  <= 15','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13INTERM','N13INT := ( ( NSALPG + NDSRINT + ((SALMES+(NSALPG + NDSRINT)','000006','000005','.EXE.','5','N13INT := ( ( NSALPG + NDSRINT + MAX((SALMES+(NSALPG + NDSRINT) - SALARIO) - ( NSALPG + NDSRINT ), 0)) / 12 / MAX( ACONVOCACAO[7] * MAX(NDIASC,ACONVOCACAO[5]) , (NORMAL+DESCANSO))) * (NORMAL+DESCANSO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13INTERM','CTIPOROT == "4"','000007','000001','.CON.','5','','','5','CTIPOROT == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','13INTERM','CALCCONVOC(@N13INT, @NHRSCAL)','000008','000007','.EXE.','5','CALCCONVOC(@N13INT, @NHRSCAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13INTERM','N13INT := (N13INT / 12 / ( ACONVOCACAO[5] * NDIASC)) * NHRSC','000009','000007','.EXE.','5','N13INT := (N13INT / 12 / ( ACONVOCACAO[5] * NDIASC)) * NHRSCAL','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','13INTERM','FGERAVERBA(FGETCODFOL("0022"),N13INT)','000010','000001','.EXE.','5','FGERAVERBA(FGETCODFOL("0024"),N13INT)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0003    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0003( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ABAFADIR','ABATE AVOS DE AFASTAMENTO','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','ABAFADIR','NAVOS := MAX(NAVOS - NAVOSAF, 0)','000001','000000','.EXE.','5','nAvos := Max(nAvos - nAvosAf, 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABAFADIR','!LVB13MAT','000002','000000','.CON.','5','','','5','!LVB13MAT','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABAFADIR','NAVOS += NAVOSMAT','000003','000002','.EXE.','5','nAvos += nAvosMat','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABAFADIR','NAVOSMAT := 0','000004','000002','.EXE.','5','nAvosMat := 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0004    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0004( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ABATINTE','ABATE FERIAS PAGAS INTERMITENTE','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','ABATINTE','FABATINTERM()','000001','000000','.EXE.','5','fAbatInterm()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0005    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0005( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ABATPAGO','ABATER VALORES PAGOS NA RESCISAO','','002184','007','2','1',} )

aAdd(aRc3Cols, { '','S_','ABATPAGO','FABATINTERM()','000001','000000','.EXE.','5','fAbatInterm()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABATPAGO','CCOMPL == "S" .AND. LPROXMES','000002','000000','.CON.','5','','','5','cCompl == "S" .and. lProxMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABATPAGO','FABATPAGO()','000003','000002','.EXE.','5','fAbatPago()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABATPAGO','FGLIQRESCA()','000004','000002','.EXE.','5','FGLIQRESCA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABATPAGO','CCOMPL == "S" .AND. !LPROXMES','000005','000000','.CON.','5','','','5','cCompl == "S" .and. !lProxMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABATPAGO','FGLIQRESCA()','000006','000005','.EXE.','5','fGLiqRescA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0006    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0006( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ABFDIRFP','ABATE AVOS AFAS. AVOS DIREITO - GFP','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','ABFDIRFP','(nAvos - nAvosAf ) >= 0 .END.','000001','000000','.CON.','5','','','5','(nAvos - nAvosAf )','>=','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABFDIRFP','nAvos := Max(nAvos - nAvosAf,0)   .END.','000002','000001','.EXE.','5','nAvos',':=','5','Max(nAvos - nAvosAf,0)','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0007    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0007( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ABONOPPE','CALCULA O ABONO DO PPE','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','ABONOPPE','lPPEFunc := If(Type("lPPEFunc") == "U", .F., lPPEFunc)     .','000001','000000','.EXE.','5','lPPEFunc := If(Type("lPPEFunc") == "U", .F., lPPEFunc)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABONOPPE','lPPEFunc .And. FindFunction("fCalcAbo")   .END.','000002','000000','.CON.','5','','','5','lPPEFunc .And. FindFunction("fCalcAbo")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABONOPPE','fCalcAbo(@nValRed)     .END.','000003','000002','.EXE.','5','fCalcAbo(@nValRed)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0008    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0008( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ABOPERMA','ABONO PERMANENCIA - GFP','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','ABOPERMA','SRA->RA_CATFUNC $ "0*1*2*3*5"   .END.','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC $ "0*1*2*3*5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','aRet := FABOPERMA()     .CNT.','000002','000001','.EXE.','5','aRet := FABOPERMA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','Len(aRet) > 0   .END.','000003','000001','.CON.','5','','','5','Len(aRet) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','nAPValor := aRet[1]     .CNT.','000004','000003','.EXE.','5','nAPValor := aRet[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','nAPDias := aRet[2]     .CNT.','000005','000003','.EXE.','5','nAPDias := aRet[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','dRetroDt := aRet[3]     .CNT.','000006','000003','.EXE.','5','dRetroDt := aRet[3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','nRetroVlr := aRet[4]     .CNT.','000007','000003','.EXE.','5','nRetroVlr := aRet[4]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','nRetroParc := aRet[5]     .END.','000008','000003','.EXE.','5','nRetroParc := aRet[5]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','( NINSS > 0 .AND. ( ASCAN(APD, {|X| X[1] == FGETCODFOL("13','000009','000003','.CON.','5','','','5','( NINSS > 0 .AND. ( ASCAN(APD, {|X| X[1] == FGETCODFOL("1372") .AND. X[7] == "I"}) == 0) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','FGeraVerba(FGETCODFOL("1372"),ROUND(NAPVALOR, MSDECIMAIS(1))','000010','000009','.EXE.','5','FGeraVerba(FGETCODFOL("1372"),ROUND(NAPVALOR, MSDECIMAIS(1)),,,,"V",,,,,,,,,,,,,,,,)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','nRetroVlr > 0 .And. !( CTIPOROT $ "5*6" )   .END.','000011','000003','.CON.','5','','','5','nRetroVlr > 0 .And. !( CTIPOROT $ "5*6" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','dAteData := MonthSum(dRetroDt, (nRetroParc-1))     .CNT.','000012','000011','.EXE.','5','dAteData := MonthSum(dRetroDt, (nRetroParc-1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','nVlrParc := Round((nRetroVlr / nRetroParc), MSDECIMAIS(1))','000013','000011','.EXE.','5','nVlrParc := Round((nRetroVlr / nRetroParc), MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','dAteData >= dDataDe   .END.','000014','000011','.CON.','5','','','5','dAteData >= dDataDe','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','( ( ASCAN(APD, {|X| X[1] == FGETCODFOL("1381") .AND. X[7]','000015','000014','.CON.','5','','','5','( ( ASCAN(APD, {|X| X[1] == FGETCODFOL("1381") .AND. X[7] == "I"}) == 0) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ABOPERMA','FGeraVerba(FGETCODFOL("1381"),NVLRPARC,,,,"V",,,,,,,,,,,,,,,','000016','000015','.EXE.','5','FGeraVerba(FGETCODFOL("1381"),NVLRPARC,,,,"V",,,,,,,,,,,,,,,, )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0009    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0009( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ACONFMES','GERA CONFIANCA MENSAL','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','ACONFMES','CVERBAROT := FGETCODFOL("1421")','000001','000000','.EXE.','5','cVerbaRot := fGetCodFol("1421")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ACONFMES','!EMPTY(CVERBAROT) .AND. NADCCONF > 0 .AND. LULTSEMANA','000002','000000','.CON.','5','','','5','!Empty(cVerbaRot) .And. nAdcConf > 0 .And. lUltSemana','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ACONFMES','FGERAVERBA(CVERBAROT,NADCCONF)','000003','000002','.EXE.','5','fGeraVerba(cVerbaRot,nAdcConf)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0010    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0010( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ADICAFAS','AJUSTA ADICIONAIS SE EXISTIR AFASTAMENTO','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','ADICAFAS','RCM->( COLUMNPOS("RCM_PDSUP") ) > 0 .AND. LEN(ACODFOL) >= 18','000001','000000','.CON.','5','','','5','RCM->( ColumnPos("RCM_PDSUP") ) > 0 .And. Len(aCodFol) >= 1877 .And. ( nPeric + nInsalub + nAdtServ + nAdcTrf + nAdcConf ) > 0 .And. Len(aDetAfas) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AAREARCM := RCM->(GETAREA())','000002','000001','.EXE.','5','aAreaRCM := RCM->(GetArea())','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AAREASR8 := SR8->(GETAREA())','000003','000001','.EXE.','5','aAreaSR8 := SR8->(GetArea())','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','RCM->( DBSETORDER(RETORDER("RCM", "RCM_FILIAL+RCM_TIPO','000004','000001','.EXE.','5','RCM->( dbSetOrder(RetOrder("RCM", "RCM_FILIAL+RCM_TIPO                                                                                                                                             ")) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','SR8->( DBSETORDER(RETORDER("SR8", "R8_FILIAL+R8_NUMID")) )','000005','000001','.EXE.','5','SR8->( dbSetOrder(RetOrder("SR8", "R8_FILIAL+R8_NUMID")) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NCONT := 1','000006','000001','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NCONT <= LEN(ADETAFAS)','000007','000001','.ENQ.','5','','','5','nCont','<=','5','Len(aDetAfas)','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','RETVALSRV(ADETAFAS[NCONT,1], SRA->RA_FILIAL,"RV_INSS") <> "S','000008','000007','.CON.','5','','','5','RetValSrv(aDetAfas[nCont,1], SRA->RA_FILIAL,"RV_INSS") <> "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','!EMPTY(ADETAFAS[NCONT,1]) .AND. RCM->(DBSEEK(XFILIAL("RCM",S','000009','000008','.CON.','5','','','5','!Empty(aDetAfas[nCont,1]) .And. RCM->(DbSeek(xFilial("RCM",SRA->RA_FILIAL) + aDetAfas[nCont,18]) .And. RCM->RCM_PDSUP == aDetAfas[nCont,1]) .And. SR8->(DbSeek(SRA->RA_FILIAL + aDetAfas[nCont,3]))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','SR8->R8_PROADIC <> '+"'"+'1'+"'"+'','000010','000009','.CON.','5','','','5','SR8->R8_PROADIC <> '+"'"+'1'+"'"+'','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NDIASAUX += ADETAFAS[NCONT,2]','000011','000010','.EXE.','5','nDiasAux += aDetAfas[nCont,2]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NCONT++','000012','000007','.EXE.','5','nCont++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NDIASAUX > 0','000013','000001','.CON.','5','','','5','nDiasAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NINTPERCUL > 0','000014','000013','.CON.','5','','','5','nIntPercul > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','!EMPTY(ACODFOL[1873,1])','000015','000014','.CON.','5','','','5','!Empty(aCodFol[1873,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := 0','000016','000015','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ ACODFOL[0036,1] + "/" + ACODFOL[128','000017','000015','.EXE.','5','aEval(aPd,{|x| If(x[1] $ aCodFol[0036,1] + "/" + aCodFol[1281,1] .and. x[9] <> '+"'"+'D'+"'"+', nHorAux += x[4],Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := NHORAUX / ( DIASTRAB + NDIASPG - NDIASMAT - NDPRG','000018','000015','.EXE.','5','nHorAux := nHorAux / ( DiasTrab + nDiasPg - nDiasMat - nDPrgSalMa ) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NVALAUX := NINTPERCUL / ( NDIASC - NDIASMAT) * NDIASAUX','000019','000015','.EXE.','5','nValAux := nIntPercul / ( nDiasC - nDiasMat) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FGERAVERBA(ACODFOL[1873,1],NVALAUX, NDIASAUX)','000020','000015','.EXE.','5','fGeraVerba(aCodFol[1873,1],nValAux, nDiasAux)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ ACODFOL[0036,1] + "/" + ACODFOL[128','000021','000015','.EXE.','5','aEval(aPd,{|x| If(x[1] $ aCodFol[0036,1] + "/" + aCodFol[1281,1] .and. x[9] <> '+"'"+'D'+"'"+', x[4] -= nHorAux,Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ ACODFOL[0036,1] + "/" + ACODFOL[128','000022','000015','.EXE.','5','aEval(aPd,{|x| If(x[1] $ aCodFol[0036,1] + "/" + aCodFol[1281,1] .and. x[9] <> '+"'"+'D'+"'"+', x[5] -= nValAux,Nil)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','EMPTY(ACODFOL[1873,1])','000023','000014','.CON.','5','','','5','Empty(aCodFol[1873,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "NÃO HÁ CADASTRO DE VERBA PARA O ID 1873 PARA','000024','000023','.EXE.','5','AddLogExecRot( "Não há cadastro de verba para o ID 1873 para a separação da geração do adicional." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "VERIFIQUE A DOCUMENTAÇÃO NO TDN DISPONÍVEL E','000025','000023','.EXE.','5','AddLogExecRot( "Verifique a documentação no TDN disponível em https://tdn.totvs.com/x/o71tJg para mais informações." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "OBS.: O CÁLCULO NÃO SERÁ REALIZADO ATÉ QUE S','000026','000023','.EXE.','5','AddLogExecRot( "Obs.: o cálculo não será realizado até que seja efetuado o cadastro da verba de ID 1873." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FINALFUN()','000027','000023','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NINTINSAL > 0','000028','000013','.CON.','5','','','5','nIntInsal > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','!EMPTY(ACODFOL[1874,1])','000029','000028','.CON.','5','','','5','!Empty(aCodFol[1874,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := 0','000030','000029','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ ACODFOL[0037,1] + "/" + ACODFOL[003','000031','000029','.EXE.','5','aEval(aPd,{|x| If(x[1] $ aCodFol[0037,1] + "/" + aCodFol[0038,1] + "/" + aCodFol[0039,1] + "/" + aCodFol[1282,1] .and. x[9] <> '+"'"+'D'+"'"+', nHorAux += x[4],Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := NHORAUX / NDIASC * (NDIASAUX + (NDIASC - NDIASAUX','000032','000029','.EXE.','5','nHorAux := nHorAux / nDiasC * (nDiasAux + (nDiasC - nDiasAux - DiasTrab))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NVALAUX := NINTINSAL / ( NDIASC - NDIASMAT) * NDIASAUX','000033','000029','.EXE.','5','nValAux := nIntInsal / ( nDiasC - nDiasMat) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FGERAVERBA(ACODFOL[1874,1],NVALAUX, NDIASAUX)','000034','000029','.EXE.','5','fGeraVerba(aCodFol[1874,1],nValAux, nDiasAux)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ ACODFOL[0037,1] + "/" + ACODFOL[003','000035','000029','.EXE.','5','aEval(aPd,{|x| If(x[1] $ aCodFol[0037,1] + "/" + aCodFol[0038,1] + "/" + aCodFol[0039,1] + "/" + aCodFol[1282,1] .and. x[9] <> '+"'"+'D'+"'"+', x[4] -= nHorAux,Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ ACODFOL[0037,1] + "/" + ACODFOL[003','000036','000029','.EXE.','5','aEval(aPd,{|x| If(x[1] $ aCodFol[0037,1] + "/" + aCodFol[0038,1] + "/" + aCodFol[0039,1] + "/" + aCodFol[1282,1] .and. x[9] <> '+"'"+'D'+"'"+', x[5] -= nValAux,Nil)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','EMPTY(ACODFOL[1874,1])','000037','000028','.CON.','5','','','5','Empty(aCodFol[1874,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "NÃO HÁ CADASTRO DE VERBA PARA O ID 1874 PARA','000038','000037','.EXE.','5','AddLogExecRot( "Não há cadastro de verba para o ID 1874 para a separação da geração do adicional." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "VERIFIQUE A DOCUMENTAÇÃO NO TDN DISPONÍVEL E','000039','000037','.EXE.','5','AddLogExecRot( "Verifique a documentação no TDN disponível em https://tdn.totvs.com/x/o71tJg para mais informações." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "OBS.: O CÁLCULO NÃO SERÁ REALIZADO ATÉ QUE S','000040','000037','.EXE.','5','AddLogExecRot( "Obs.: o cálculo não será realizado até que seja efetuado o cadastro da verba de ID 1874." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FINALFUN()','000041','000037','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NADTSERV > 0','000042','000013','.CON.','5','','','5','nAdtServ > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','!EMPTY(ACODFOL[1875,1])','000043','000042','.CON.','5','','','5','!Empty(aCodFol[1875,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','CCDATS := ACODFOL[1,1] + "/" + ACODFOL[2,1] + "/" + ACODFOL[','000044','000043','.EXE.','5','cCdAts := aCodFol[1,1] + "/" + aCodFol[2,1] + "/" + aCodFol[3,1] + "/" + aCodFol[4,1] + "/" + aCodFol[5,1] + "/" + aCodFol[1283,1] + "/" + aCodFol[1284,1] + "/" + aCodFol[1285,1] + "/" + aCodFol[1286,1] + "/" + aCodFol[1287,1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := 0','000045','000043','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ CCDATS .AND. X[9] <> '+"'"+'D'+"'"+', NHORAUX +','000046','000043','.EXE.','5','aEval(aPd,{|x| If(x[1] $ cCdAts .and. x[9] <> '+"'"+'D'+"'"+', nHorAux += x[4],Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := NHORAUX / ( DIASTRAB + NDIASPG - NDIASMAT - NDPRG','000047','000043','.EXE.','5','nHorAux := nHorAux / ( DiasTrab + nDiasPg - nDiasMat - nDPrgSalMa ) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NVALAUX := NADTSERV / ( NDIASC - NDIASMAT) * NDIASAUX','000048','000043','.EXE.','5','nValAux := nAdtServ / ( nDiasC - nDiasMat) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FGERAVERBA(ACODFOL[1875,1],NVALAUX, NDIASAUX)','000049','000043','.EXE.','5','fGeraVerba(aCodFol[1875,1],nValAux, nDiasAux)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ CCDATS .AND. X[9] <> '+"'"+'D'+"'"+', X[4] -= N','000050','000043','.EXE.','5','aEval(aPd,{|x| If(x[1] $ cCdAts .and. x[9] <> '+"'"+'D'+"'"+', x[4] -= nHorAux,Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] $ CCDATS .AND. X[9] <> '+"'"+'D'+"'"+', X[5] :=','000051','000043','.EXE.','5','aEval(aPd,{|x| If(x[1] $ cCdAts .and. x[9] <> '+"'"+'D'+"'"+', x[5] :=  Round(x[5] / (x[4] + nDiasAux) * x[4], 2) ,Nil)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','EMPTY(ACODFOL[1875,1])','000052','000042','.CON.','5','','','5','Empty(aCodFol[1875,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "NÃO HÁ CADASTRO DE VERBA PARA O ID 1875 PARA','000053','000052','.EXE.','5','AddLogExecRot( "Não há cadastro de verba para o ID 1875 para a separação da geração do adicional." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "VERIFIQUE A DOCUMENTAÇÃO NO TDN DISPONÍVEL E','000054','000052','.EXE.','5','AddLogExecRot( "Verifique a documentação no TDN disponível em https://tdn.totvs.com/x/o71tJg para mais informações." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "OBS.: O CÁLCULO NÃO SERÁ REALIZADO ATÉ QUE S','000055','000052','.EXE.','5','AddLogExecRot( "Obs.: o cálculo não será realizado até que seja efetuado o cadastro da verba de ID 1875." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FINALFUN()','000056','000052','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NADCTRF > 0','000057','000013','.CON.','5','','','5','nAdcTrf > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','!EMPTY(ACODFOL[1876,1])','000058','000057','.CON.','5','','','5','!Empty(aCodFol[1876,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := 0','000059','000058','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] == ACODFOL[988,1] .AND. X[9] <> '+"'"+'D'+"'"+',','000060','000058','.EXE.','5','aEval(aPd,{|x| If(x[1] == aCodFol[988,1] .and. x[9] <> '+"'"+'D'+"'"+', nHorAux += x[4],Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := NHORAUX / ( DIASTRAB + NDIASPG - NDIASMAT - NDPRG','000061','000058','.EXE.','5','nHorAux := nHorAux / ( DiasTrab + nDiasPg - nDiasMat - nDPrgSalMa ) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NVALAUX := NADCTRF / ( NDIASC - NDIASMAT) * NDIASAUX','000062','000058','.EXE.','5','nValAux := nAdcTrf / ( nDiasC - nDiasMat) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FGERAVERBA(ACODFOL[1876,1],NVALAUX, NDIASAUX)','000063','000058','.EXE.','5','fGeraVerba(aCodFol[1876,1],nValAux, nDiasAux)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] == ACODFOL[988,1] .AND. X[9] <> '+"'"+'D'+"'"+',','000064','000058','.EXE.','5','aEval(aPd,{|x| If(x[1] == aCodFol[988,1] .and. x[9] <> '+"'"+'D'+"'"+', x[4] -= nHorAux,Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] == ACODFOL[988,1] .AND. X[9] <> '+"'"+'D'+"'"+',','000065','000058','.EXE.','5','aEval(aPd,{|x| If(x[1] == aCodFol[988,1] .and. x[9] <> '+"'"+'D'+"'"+', x[5] -= nValAux,Nil)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','EMPTY(ACODFOL[1876,1])','000066','000057','.CON.','5','','','5','Empty(aCodFol[1876,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "NÃO HÁ CADASTRO DE VERBA PARA O ID 1876 PARA','000067','000066','.EXE.','5','AddLogExecRot( "Não há cadastro de verba para o ID 1876 para a separação da geração do adicional." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "VERIFIQUE A DOCUMENTAÇÃO NO TDN DISPONÍVEL E','000068','000066','.EXE.','5','AddLogExecRot( "Verifique a documentação no TDN disponível em https://tdn.totvs.com/x/o71tJg para mais informações." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "OBS.: O CÁLCULO NÃO SERÁ REALIZADO ATÉ QUE S','000069','000066','.EXE.','5','AddLogExecRot( "Obs.: o cálculo não será realizado até que seja efetuado o cadastro da verba de ID 1876." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FINALFUN()','000070','000066','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NADCCONF > 0','000071','000013','.CON.','5','','','5','nAdcConf > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','!EMPTY(ACODFOL[1877,1])','000072','000071','.CON.','5','','','5','!Empty(aCodFol[1877,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := 0','000073','000072','.EXE.','5','nHorAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] == ACODFOL[984,1] .AND. X[9] <> '+"'"+'D'+"'"+',','000074','000072','.EXE.','5','aEval(aPd,{|x| If(x[1] == aCodFol[984,1] .and. x[9] <> '+"'"+'D'+"'"+', nHorAux += x[4],Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NHORAUX := NHORAUX / ( DIASTRAB + NDIASPG - NDIASMAT - NDPRG','000075','000072','.EXE.','5','nHorAux := nHorAux / ( DiasTrab + nDiasPg - nDiasMat - nDPrgSalMa ) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','NVALAUX := NADCCONF / ( NDIASC - NDIASMAT) * NDIASAUX','000076','000072','.EXE.','5','nValAux := nAdcConf / ( nDiasC - nDiasMat) * nDiasAux','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FGERAVERBA(ACODFOL[1877,1],NVALAUX, NDIASAUX)','000077','000072','.EXE.','5','fGeraVerba(aCodFol[1877,1],nValAux, nDiasAux)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] == ACODFOL[984,1] .AND. X[9] <> '+"'"+'D'+"'"+',','000078','000072','.EXE.','5','aEval(aPd,{|x| If(x[1] == aCodFol[984,1] .and. x[9] <> '+"'"+'D'+"'"+', x[4] -= nHorAux,Nil)})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','AEVAL(APD,{|X| IF(X[1] == ACODFOL[984,1] .AND. X[9] <> '+"'"+'D'+"'"+',','000079','000072','.EXE.','5','aEval(aPd,{|x| If(x[1] == aCodFol[984,1] .and. x[9] <> '+"'"+'D'+"'"+', x[5] -= nValAux,Nil)})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','EMPTY(ACODFOL[1877,1])','000080','000071','.CON.','5','','','5','Empty(aCodFol[1877,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "NÃO HÁ CADASTRO DE VERBA PARA O ID 1877 PARA','000081','000080','.EXE.','5','AddLogExecRot( "Não há cadastro de verba para o ID 1877 para a separação da geração do adicional." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "VERIFIQUE A DOCUMENTAÇÃO NO TDN DISPONÍVEL E','000082','000080','.EXE.','5','AddLogExecRot( "Verifique a documentação no TDN disponível em https://tdn.totvs.com/x/o71tJg para mais informações." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','ADDLOGEXECROT( "OBS.: O CÁLCULO NÃO SERÁ REALIZADO ATÉ QUE S','000083','000080','.EXE.','5','AddLogExecRot( "Obs.: o cálculo não será realizado até que seja efetuado o cadastro da verba de ID 1877." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','FINALFUN()','000084','000080','.EXE.','5','FinalFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','RESTAREA(AAREARCM)','000085','000001','.EXE.','5','RestArea(aAreaRCM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADICAFAS','RESTAREA(AAREASR8)','000086','000001','.EXE.','5','RestArea(aAreaSR8)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0011    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0011( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ADILIQ','GERA LIQUIDO E ARREDONDAMENTO','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','ADILIQ','VAL_ADTO > 0','000001','000000','.CON.','5','','','5','VAl_ADTO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADILIQ','FLIQUIDO(ACODFOL,ACODFOL[546,1],NVALARRAD,ACODFOL[1329,1],.T','000002','000001','.EXE.','5','fLiquido(aCodfol,aCodfol[546,1],nValArrAd,aCodfol[1329,1],.T.,aCodfol[45,1],,.T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0012    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0012( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ADT13PGT','VALIDA O PAGAMENTO DE ADIANTAMENTO 13O','','','009','2','1',} )

aAdd(aRc3Cols, { '','S_','ADT13PGT','LCOMPL1PARC := APERGUNTE[5,3] == 2','000001','000000','.EXE.','5','lCompl1Parc := aPergunte[5,3] == 2','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ADT13PGT','NANTEC13 > 0 .AND. !LCOMPL1PARC','000002','000000','.CON.','5','','','5','nAntec13 > 0 .AND. !lCompl1Parc','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ADT13PGT','FINALFUN()     .END.','000003','000002','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0013    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0013( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ADTINF','Adiant Informado','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','ADTINF','LINFORMADO := FVERADIANT()','000001','000000','.EXE.','6','lInformado := FVerAdiant()','','','','','','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0014    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0014( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','APD','CARREGA MOVIMENT.DO FUNCIONARIO NO MES','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','APD','!(LSALINCO := IF(TYPE('+"'"+'LSALINCO'+"'"+')<>'+"'"+'U'+"'"+',LSALINCO,.F.))  .EN','000001','000000','.CON.','5','','','5','!(lSalInco := If(Type('+"'"+'lSalInco'+"'"+')<>'+"'"+'U'+"'"+',lSalInco,.F.))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','APD','FCARMVTO(SRA->RA_FILIAL,SRA->RA_MAT,CSEMANA)    .END.','000002','000001','.EXE.','5','fCarMvto(SRA->RA_FILIAL,SRA->RA_MAT,cSemana)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0015    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0015( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ATRFMES','GERA TRANSFERENCIA MENSAL','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','ATRFMES','CVERBAROT := FGETCODFOL("1422)','000001','000000','.EXE.','5','cVerbaRot := fGetCodFol("1422")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATRFMES','!EMPTY(CVERBAROT) .AND. NADCTRF > 0 .AND. LULTSEMANA','000002','000000','.CON.','5','','','5','!Empty(cVerbaRot) .And. nAdcTrf > 0 .And. lUltSemana','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATRFMES','FGERAVERBA(CVERBAROT,NADCTRF)','000003','000002','.EXE.','5','fGeraVerba(cVerbaRot,nAdcTrf)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0016    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0016( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ATSMAT','GRAVA AD.TPO.SERV.MATERNIDADE','','002185','007','2','1',} )

aAdd(aRc3Cols, { '','S_','ATSMAT','NADTSERV > 0 .AND. ( NDIASMAT > 0 .OR. NDPRGSALMA  > 0 )','000001','000000','.CON.','5','','','5','nAdtServ > 0 .and. ( nDiasMat > 0 .or. nDPrgSalMa  > 0 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','cVerbaRot := fGetCodFol("1338")     .CNT.','000002','000001','.EXE.','5','cVerbaRot := fGetCodFol("1338")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','NDIASMAT  > 0 .AND. !EMPTY(CVERBAROT)','000003','000001','.CON.','5','','','5','nDiasMat  > 0 .and. !Empty(cVerbaRot)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','FGERAVERBA(CVERBAROT,ROUND((NADTSERV / NDIASC) * NDIASMAT,2)','000004','000003','.EXE.','5','fGeraVerba(cVerbaRot,Round((nAdtServ / nDiasC) * nDiasMat,2), nDiasMat,,,,,,,,,,,,,.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','NDIASMAT  > 0 .AND. EMPTY(CVERBAROT)','000005','000001','.CON.','5','','','5','nDiasMat  > 0 .and. Empty(cVerbaRot)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','CMSGLOG := FMSGFORM({19}) + " -> 1338 - " + ACODFOL[1338,2]','000006','000005','.EXE.','5','CMSGLOG := FMSGFORM({19}) + " -> 1338 - " + aCodFol[1338,2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','ADDLOGEXECROT( CMSGLOG )','000007','000005','.EXE.','5','ADDLOGEXECROT( CMSGLOG )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','FINALCALC()','000008','000005','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','CVERBAROT := FGETCODFOL("1351")','000009','000001','.EXE.','5','cVerbaRot := fGetCodFol("1351")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','NDPRGSALMA  > 0 .AND. !EMPTY(CVERBAROT)','000010','000001','.CON.','5','','','5','nDPrgSalMa  > 0 .and. !Empty(cVerbaRot)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','FGERAVERBA(CVERBAROT,ROUND((NADTSERV / NDIASC) * NDPRGSALMA,','000011','000010','.EXE.','5','fGeraVerba(cVerbaRot,Round((nAdtServ / nDiasC) * nDPrgSalMa,2), nDPrgSalMa,,,,,,,,,,,,,.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','NDPRGSALMA  > 0 .AND. EMPTY(CVERBAROT)','000012','000001','.CON.','5','','','5','nDPrgSalMa  > 0 .and. Empty(cVerbaRot)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','CMSGLOG := FMSGFORM({19}) + " -> 1351 - " + ACODFOL[1351,2]','000013','000012','.EXE.','5','CMSGLOG := FMSGFORM({19}) + " -> 1351 - " + aCodFol[1351,2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','ADDLOGEXECROT( CMSGLOG )','000014','000012','.EXE.','5','ADDLOGEXECROT( CMSGLOG )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMAT','FINALCALC()','000015','000012','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0017    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0017( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ATSMES','GERA AD.TPO.SERV.MENSAL','','002186','007','2','1',} )

aAdd(aRc3Cols, { '','S_','ATSMES','EMPTY(CVERBAROT)','000001','000000','.CON.','5','','','5','Empty(cVerbaRot)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATSMES','CVERBAROT := FGETCODFOL("0671")','000002','000001','.EXE.','5','cVerbaRot := fGetCodFol("0671")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMES','NADTSERV > 0 .AND. !EMPTY(CVERBAROT) .AND. ((!EMPTY(CSEMANA)','000003','000000','.CON.','5','','','5','nAdtServ > 0 .And. !Empty(cVerbaRot) .And. ((!Empty(cSemana) .And. lUltSemana))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATSMES','FGERAVERBA(CVERBAROT, NADTSERV,,CSEMANA,,,,,,,,,,,,.F.)','000004','000003','.EXE.','5','fGeraVerba(cVerbaRot, nAdtServ,,cSemana,,,,,,,,,,,,.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','ATSMES','TYPE("CCODADT") != "C"','000005','000000','.CON.','5','','','5','Type("cCodAdt") != "C"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATSMES','CCODADT := ""','000006','000005','.EXE.','5','cCodAdt := ""','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0018    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0018( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','ATULDISS','VAR.P/CALC.DISSIDIO','','002187','003','2','1',} )

aAdd(aRc3Cols, { '','S_','ATULDISS','TYPE("LDISSIDIO") == "U"','000001','000000','.CON.','5','','','5','TYPE("LDISSIDIO") == "U"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','ATULDISS','LDISSIDIO := .F.','000002','000001','.EXE.','5','lDissidio := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0019    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0019( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AUXCRECH','CALCULO AUXILIO CRECHE','','002188','003','2','1',} )

aAdd(aRc3Cols, { '','S_','AUXCRECH','EMPTY(CVERBAROT)','000001','000000','.CON.','5','','','5','Empty(cVerbaRot)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AUXCRECH','CVERBAROT := FGETCODFOL("0721")','000002','000001','.EXE.','5','cVerbaRot := fGetCodFol("0721")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AUXCRECH','FAUXCRE(ACODFOL,CVERBAROT)','000003','000000','.EXE.','5','fAuxCre(aCodfol,cVerbaRot)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0020    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0020( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AVAF13FP','CALCULO AVOS DOS AFAST. DO ANO - GFP','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','AVAF13FP','!( SRA->RA_CATFUNC $ "4/7/8/9" )   .END.','000001','000000','.CON.','5','','','5','!( SRA->RA_CATFUNC $ "4/7/8/9" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVAF13FP','S_DINIAF13()     .CNT.','000002','000001','.EXE.','4','S_DINIAF13()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVAF13FP','S_VERAVAFA()     .CNT.','000003','000001','.EXE.','4','S_VERAVAFA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVAF13FP','S_MESESTRA()     .CNT.','000004','000001','.EXE.','4','S_MESESTRA()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVAF13FP','S_ABFDIRFP()     .END.','000005','000001','.EXE.','4','S_ABFDIRFP()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0021    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0021( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AVOS13','NR AVOS DE DIREITO - GFP','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','AVOS13','!( SRA->RA_CATFUNC == "4" )   .END.','000001','000000','.CON.','5','','','5','!( SRA->RA_CATFUNC == "4" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOS13','dLimData13 := CTOD("31/12/"+ ALLTRIM(STR(YEAR(dDataAte))))','000002','000001','.EXE.','5','dLimData13 := CTOD("31/12/"+ ALLTRIM(STR(YEAR(dDataAte))))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOS13','fAvos13(@nAvos, dLimData13, nAvosFal13, 0, Iif(cTipoRot = "5','000003','000001','.EXE.','5','fAvos13(@nAvos, dLimData13, nAvosFal13, 0, Iif(cTipoRot = "5", "1", " "))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0022    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0022( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AVOSAF13','AVOS AFASTAMENTO 13. SALARIO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','AVOSAF13','( CTIPOROT == "3" .AND. GETMEMVAR("RH_PERC13S") > 0 ) .OR. N','000001','000000','.CON.','5','','','5','( cTipoRot == "3" .and. GetMemVar("RH_PERC13S") > 0 ) .or. nAvos > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','NAVOSAF := 0','000002','000001','.EXE.','5','nAvosAf := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','DDTPESQ1:= SRA->RA_ADMISSA','000003','000001','.EXE.','5','dDtPesq1:= SRA->RA_ADMISSA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','CTIPOROT == "3" .AND. MESANO(GETMEMVAR("RH_DATAINI")) # MESA','000004','000001','.CON.','5','','','5','cTipoRot == "3" .and. MesAno(GetMemVar("RH_DATAINI")) # MesAno(SRA->RA_ADMISSA)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','DDTPESQ1:= CTOD("01/01/"+SUBSTR(DTOS(GETMEMVAR("RH_DATAINI")','000005','000004','.EXE.','5','dDtPesq1:= CtoD("01/01/"+SubStr(DtoS(GetMemVar("RH_DATAINI") ),1,4),"DDMMYY")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','CTIPOROT == "3"','000006','000001','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','FRETAFAS(DDTPESQ1,CTOD("31/12/"+SUBSTR(DTOS(DDTPESQ1),1,4),','000007','000006','.EXE.','5','fRetAfas(dDtPesq1,CtoD("31/12/"+SubStr(DtoS(dDtPesq1),1,4), "DDMMYY"), "13",@nAvosAf,,,@aAfast)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','CTIPOROT $ "5*6"','000008','000001','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','dDtPesq1 := Max( SRA->RA_ADMISSA, Ctod("01/01/"+SubStr(DtoS(','000009','000008','.EXE.','5','dDtPesq1 := Max( SRA->RA_ADMISSA, Ctod("01/01/"+SubStr(DtoS(dDataRef),1,4), "DDMMYY") )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSAF13','FRETAFAS(DDTPESQ1,IIF( CTIPOROT == "5",APERGUNTE[6,3],APERGU','000010','000008','.EXE.','5','fRetAfas(dDtPesq1,IIf( cTipoRot == "5",aPergunte[6,3],aPergunte[2,3] ),"13",@nAvosAf,,,@aAfast)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0023    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0023( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AVOSAPLR','CARREGA AVOS AFASTADOS PARA PLR','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','AVOSAPLR','DDATAAUX := STOD(ASIND[1,8]+"0101")','000001','000000','.EXE.','5','dDataAux := StoD(aSind[1,8]+"0101")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSAPLR','DDATAAUX < SRA->RA_ADMISSA','000002','000000','.CON.','5','','','5','dDataAux < SRA->RA_ADMISSA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSAPLR','DDATAAUX := SRA->RA_ADMISSA','000003','000002','.EXE.','5','dDataAux := SRA->RA_ADMISSA','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSAPLR','FRETAFAS(DDATAAUX,STOD(ASIND[1,8]+"1231"),"PLR",@NAVOSAF)','000004','000000','.EXE.','5','fRetAfas(dDataAux,StoD(aSind[1,8]+"1231"),"PLR",@nAvosAf)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0024    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0024( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AVOSMAT','CALCULA AVOS AFASTADO MATERN. - GFP','','','022','2','1',} )

aAdd(aRc3Cols, { '','S_','AVOSMAT','nAvosMat := 0     .CNT.','000001','000000','.EXE.','5','nAvosMat := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','aComPag := {}     .CNT.','000002','000000','.EXE.','5','aComPag := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','nCont := 1     .CNT.','000003','000000','.EXE.','5','nCont := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','NAFASQTD := 0     .CNT.','000004','000000','.EXE.','5','NAFASQTD := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','SRA->RA_SEXO="F" .And. cPgSalMat = "N"   .END.','000005','000000','.CON.','5','','','5','SRA->RA_SEXO="F" .And. cPgSalMat = "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','FBUSCAAFAST(DDTPESQ1,CTOD("31/12/"+STRZERO(YEAR(DDATAREF),4)','000006','000005','.EXE.','5','FBUSCAAFAST(DDTPESQ1,CTOD("31/12/"+STRZERO(YEAR(DDATAREF),4)),ACOMPAG,,"2")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','NAFASQTD := LEN(ACOMPAG)     .CNT.','000007','000005','.EXE.','5','NAFASQTD := LEN(ACOMPAG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','NCONT <= NAFASQTD   .END.','000008','000005','.ENQ.','5','','','5','NCONT <= NAFASQTD','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','ACOMPAG[NCONT][12] = FGETCODFOL("0040")   .END.','000009','000008','.CON.','5','','','5','ACOMPAG[NCONT][12] = FGETCODFOL("0040")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','dDataIni:= If ( ACOMPAG[NCONT,1] < CTOD("01/01/"+STRZERO(YEA','000010','000009','.EXE.','5','dDataIni:= If ( ACOMPAG[NCONT,1] < CTOD("01/01/"+STRZERO(YEAR(DDATAREF),4)),CTOD("01/01/"+STRZERO(YEAR(DDATAREF),4)),ACOMPAG[NCONT,1])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','dDataFim := If ( ACOMPAG[NCONT,2]  > CTOD("31/12/"+STRZERO(Y','000011','000009','.EXE.','5','dDataFim := If ( ACOMPAG[NCONT,2]  > CTOD("31/12/"+STRZERO(YEAR(DDATAREF),4)),CTOD("31/12/"+STRZERO(YEAR(DDATAREF),4)),ACOMPAG[NCONT,2])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','NAVOSMAT := ( MONTH(dDataFim) - MONTH(dDataIni) + 1 )     .C','000012','000009','.EXE.','5','NAVOSMAT := ( MONTH(dDataFim) - MONTH(dDataIni) + 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','NDIASM13+= ( dDataFim - dDataIni ) + 1     .CNT.','000013','000009','.EXE.','5','NDIASM13+= ( dDataFim - dDataIni ) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','( F_ULTDIA(dDataIni) - DAY(dDataIni) + 1 ) < 15   .END.','000014','000009','.CON.','5','','','5','( F_ULTDIA(dDataIni) - DAY(dDataIni) + 1 ) < 15','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','NAVOSMAT --     .END.','000015','000014','.EXE.','5','NAVOSMAT --','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','( F_ULTDIA(dDataFim) - DAY(dDataFim) + 1 ) > 15   .END.','000016','000009','.CON.','5','','','5','( F_ULTDIA(dDataFim) - DAY(dDataFim) + 1 ) > 15','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','NAVOSMAT --     .END.','000017','000016','.EXE.','5','NAVOSMAT --','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSMAT','NCONT ++     .END.','000018','000008','.EXE.','5','NCONT ++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0025    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0025( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AVOSPLR','CARREGA AVOS DE DIREITO PARA PLR','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','AVOSPLR','NAVOSTOT := 0','000001','000000','.EXE.','5','nAvosTot := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSPLR','FAVOSPLR(@NAVOS,STOD(ASIND[1,8]+"1231"))','000002','000000','.EXE.','5','fAvosPLR(@nAvos,StoD(aSind[1,8]+"1231"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AVOSPLR','NAVOSTOT := MAX(NAVOS - NAVOSAF,0)','000003','000000','.EXE.','5','nAvosTot := Max(nAvos - nAvosAf,0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0026    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0026( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','AXCRECH2','AUXILIO CRECHE - GFP','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','AXCRECH2','OSRB1 := ""     .CNT.','000001','000000','.EXE.','5','OSRB1 := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','aTabS015 := {}     .CNT.','000002','000000','.EXE.','5','aTabS015 := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nVlTot := 0     .CNT.','000003','000000','.EXE.','5','nVlTot := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','SubStr(cSuplem,1,1)=="2"   .END.','000004','000000','.CON.','5','','','5','SubStr(cSuplem,1,1)=="2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','fCarrTab(@aTabS015,"S109" , dDataAte , .T. )     .CNT.','000005','000004','.EXE.','5','fCarrTab(@aTabS015,"S109" , dDataAte , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','x := 1     .CNT.','000006','000004','.EXE.','5','x := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','x <= Len(aTabS015)   .END.','000007','000004','.ENQ.','5','','','5','x <= Len(aTabS015)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','"S109" == aTabS015[x][1]   .END.','000008','000007','.CON.','5','','','5','"S109" == aTabS015[x][1]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','SRA->RA_CATFUNC $ aTabS015[x][8] .AND. ( SRA->RA_REGIME ==','000009','000008','.CON.','5','','','5','SRA->RA_CATFUNC $ aTabS015[x][8] .AND. ( SRA->RA_REGIME == aTabS015[x][9] .OR. aTabS015[x][9] == "3" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','cAfasts := aTabS015[x][10]     .CNT.','000010','000009','.EXE.','5','cAfasts := aTabS015[x][10]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','cPropIni := aTabS015[x][11]     .CNT.','000011','000009','.EXE.','5','cPropIni := aTabS015[x][11]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','cPropFim := aTabS015[x][12]     .CNT.','000012','000009','.EXE.','5','cPropFim := aTabS015[x][12]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nVlLimite := aTabS015[x][13]     .CNT.','000013','000009','.EXE.','5','nVlLimite := aTabS015[x][13]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','cPgDiasEmp := aTabS015[x][14]     .CNT.','000014','000009','.EXE.','5','cPgDiasEmp := aTabS015[x][14]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nMesLim := aTabS015[x][6]     .CNT.','000015','000009','.EXE.','5','nMesLim := aTabS015[x][6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nVlACTab := aTabS015[x][7]     .CNT.','000016','000009','.EXE.','5','nVlACTab := aTabS015[x][7]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','x := Len(aTabS015) + 1     .END.','000017','000009','.EXE.','5','x := Len(aTabS015) + 1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','X++     .END.','000018','000007','.EXE.','5','X++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','ASRB := {}     .CNT.','000019','000004','.EXE.','5','ASRB := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','fCarregSRB (@aSRB, SRA->RA_FILIAL , SRA->RA_MAT )      .CNT','000020','000004','.EXE.','5','fCarregSRB (@aSRB, SRA->RA_FILIAL , SRA->RA_MAT )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NSRB := 1     .CNT.','000021','000004','.EXE.','5','NSRB := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NSRB <= LEN(ASRB)   .END.','000022','000004','.ENQ.','5','','','5','NSRB <= LEN(ASRB)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','ASRB[NSRB][3] == "1" .AND. EMPTY(ASRB[NSRB][4])   .END.','000023','000022','.CON.','5','','','5','ASRB[NSRB][3] == "1" .AND. EMPTY(ASRB[NSRB][4])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DINICALC := IF( EMPTY(ASRB[NSRB][5]) , ASRB[NSRB][6] , ASRB[','000024','000023','.EXE.','5','DINICALC := IF( EMPTY(ASRB[NSRB][5]) , ASRB[NSRB][6] , ASRB[NSRB][5] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DINICALC := IIF(VALTYPE(DINICALC) <> '+"'"+'D'+"'"+', STOD(DINICALC), DI','000025','000023','.EXE.','5','DINICALC := IIF(VALTYPE(DINICALC) <> '+"'"+'D'+"'"+', STOD(DINICALC), DINICALC)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DNASC := ASRB[NSRB][6]     .CNT.','000026','000023','.EXE.','5','DNASC := ASRB[NSRB][6]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DNASC := IIF(VALTYPE(DNASC) <> '+"'"+'D'+"'"+', STOD(DNASC), DNASC)','000027','000023','.EXE.','5','DNASC := IIF(VALTYPE(DNASC) <> '+"'"+'D'+"'"+', STOD(DNASC), DNASC)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DFIMCALC := MONTHSUM( DNASC , NMESLIM ) - 1','000028','000023','.EXE.','5','dFimCalc := MonthSum( dNasc , nMesLim ) - 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DateDiffMonth( dIniCalc , dDataAte ) <= nMesLim   .END.','000029','000023','.CON.','5','','','5','DateDiffMonth( dIniCalc , dDataAte ) <= nMesLim','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NVLCRECHE := IF( ASRB[NSRB][7] > 0 , ASRB[NSRB][7] , NVLACTA','000030','000029','.EXE.','5','NVLCRECHE := IF( ASRB[NSRB][7] > 0 , ASRB[NSRB][7] , NVLACTAB )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NVLCRECHE := IF( CPROPINI == "1" ,  IF( MESANO(DINICALC) ==','000031','000029','.EXE.','5','NVLCRECHE := IF( CPROPINI == "1" ,  IF( MESANO(DINICALC) == MESANO(DDATAATE), (NVLCRECHE / 30 ) * (DDATAATE - DINICALC + 1) , NVLCRECHE ) , NVLCRECHE )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NVLCRECHE := IF( CPROPFIM == "1" , IF( MESANO(DFIMCALC) == M','000032','000029','.EXE.','5','NVLCRECHE := IF( CPROPFIM == "1" , IF( MESANO(DFIMCALC) == MESANO(DDATAATE), (NVLCRECHE / 30 ) * (DFIMCALC - DDATADE + 1) , NVLCRECHE ) , NVLCRECHE )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nVlTot += nVlCreche     .END.','000033','000029','.EXE.','5','nVlTot += nVlCreche','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NSRB++     .END.','000034','000022','.EXE.','5','NSRB++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nVlTot > 0   .END.','000035','000004','.CON.','5','','','5','nVlTot > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','CTXT := "VERIFICA OS AFASTAMENTOS"     .CNT.','000036','000035','.EXE.','5','CTXT := "VERIFICA OS AFASTAMENTOS"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','dDataIni := If( DADMISSAO > dDataDe , DADMISSAO , DDATADE )','000037','000035','.EXE.','5','dDataIni := If( DADMISSAO > dDataDe , DADMISSAO , DDATADE )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DDATAFIM := IF( C__ROTEIRO == "RES", GETMEMVAR("RG_DATADEM")','000038','000035','.EXE.','5','DDATAFIM := IF( C__ROTEIRO == "RES", GETMEMVAR("RG_DATADEM"), dDataAte )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nDDir := IIF( ((DDATAFIM - DDATAINI) +1) < 30, ((DDATAFIM -','000039','000035','.EXE.','5','nDDir := IIF( ((DDATAFIM - DDATAINI) +1) < 30, ((DDATAFIM - DDATAINI) +1), 30 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NDDIR := IIF( MONTH(DDATAFIM)==2 .and. NDDIR == F_ULTDIA(DDA','000040','000035','.EXE.','5','NDDIR := IIF( MONTH(DDATAFIM)==2 .and. NDDIR == F_ULTDIA(DDATAFIM), 30, NDDIR)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','ASR8 := FVERSR8( SRA->RA_FILIAL , SRA->RA_MAT, DDATADE , DDA','000041','000035','.EXE.','5','ASR8 := FVERSR8( SRA->RA_FILIAL , SRA->RA_MAT, DDATADE , DDATAATE , .F. , .F., .F. , , IF(ALLTRIM(CAFASTS) == "*","",ALLTRIM(CAFASTS)), "/" , .T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','Z := 1     .CNT.','000042','000035','.EXE.','5','Z := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','Z <= LEN(ASR8)   .END.','000043','000035','.ENQ.','5','','','5','Z <= LEN(ASR8)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NDEMP := IF( ASR8[Z][6] > 0 ,FDPAGMES( ASR8[Z][3] , ASR8[Z][','000044','000043','.EXE.','5','NDEMP := IF( ASR8[Z][6] > 0 ,FDPAGMES( ASR8[Z][3] , ASR8[Z][4] , ASR8[Z][6] , CANOMES) , 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DINIAFAST := IF( ASR8[Z][3] < DDATADE, DDATADE, ASR8[Z][3] )','000045','000043','.EXE.','5','DINIAFAST := IF( ASR8[Z][3] < DDATADE, DDATADE, ASR8[Z][3] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','DFIMAFAST := IF( Empty(ASR8[Z][4]) .OR. ASR8[Z][4] > DDATAAT','000046','000043','.EXE.','5','DFIMAFAST := IF( Empty(ASR8[Z][4]) .OR. ASR8[Z][4] > DDATAATE, DDATAATE, ASR8[Z][4] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NDAFAST := (DFIMAFAST - DINIAFAST) + 1     .CNT.','000047','000043','.EXE.','5','NDAFAST := (DFIMAFAST - DINIAFAST) + 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','NDDIR := NDDIR - IF( CPGDIASEMP == "1" , NDAFAST , 0)     .C','000048','000043','.EXE.','5','NDDIR := NDDIR - IF( CPGDIASEMP == "1" , NDAFAST , 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','Z++     .END.','000049','000043','.EXE.','5','Z++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','ASCAN(APD, {|X| X[1] == "0721" .AND. X[7] == "I"}) == 0','000050','000035','.CON.','5','','','5','ASCAN(APD, {|X| X[1] == "0721" .AND. X[7] == "I"}) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nVlTot := IF( (NVLTOT > NVLLIMITE) .AND. (NVLLIMITE > 0) , N','000051','000050','.EXE.','5','nVlTot := IF( (NVLTOT > NVLLIMITE) .AND. (NVLLIMITE > 0) , NVLLIMITE , NVLTOT)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','nVlTot := ROUND((nVlTot / 30 * nDDir), MSDECIMAIS(1))     .C','000052','000050','.EXE.','5','nVlTot := ROUND((nVlTot / 30 * nDDir), MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','AXCRECH2','FGeraVerba(FGETCODFOL("0721"),NVLTOT,,,,,,,,,,,,,,,,,,,,)','000053','000050','.EXE.','5','FGeraVerba(FGETCODFOL("0721"),NVLTOT,,,,,,,,,,,,,,,,,,,,)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0027    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0027( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEADT','MONTA BASE DE CALCULO DO ADIANTAMENTO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEADT','nBaseAdt := Salario + (nAdtServ +  nAdcConf + nAdcTrf + nPer','000001','000000','.EXE.','5','nBaseAdt := Salario + (nAdtServ +  nAdcConf + nAdcTrf + nPeric + nInsalub)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BASEADT','POSSRV(ACODFOL[6,1],SRA->RA_FILIAL,"RV_BASCAL") == "1"','000002','000000','.CON.','5','','','5','PosSrv(aCodFol[6,1],SRA->RA_FILIAL,"RV_BASCAL") == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEADT','NBASEADT := SALARIO','000003','000002','.EXE.','5','nBaseAdt := Salario','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0028    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0028( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BASEIR','Gera Base IR','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','BASEIR','BASE_INI # 0','000001','000000','.CON.','','','','6','BASE_INI # 0','','','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEIR','CTIPOROT == "2"','000002','000001','.CON.','5','','','5','cTipoRot == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BASEIR','FGERAVERBA(ACODFOL[10,1],BASE_INI,0.00,CSEMANA , ,"V","A")','000003','000002','.EXE.','5','FGeraVerba(AcODFOL[10,1],BASE_INI,0.00,CSEMANA , ,"V","A")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0029    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0029( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BCONTSIN','BASE C.SINDICAL COMISS./TAREFEIRO','','002189','007','2','1',} )

aAdd(aRc3Cols, { '','S_','BCONTSIN','NBASESIND := 0','000001','000000','.EXE.','5','nBaseSind := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BCONTSIN','DDTMESANT  := MONTHSUB( STOD(MESANO(DDATAATE)+"01") , 1 )','000002','000000','.EXE.','5','dDtMesAnt  := MonthSub( StoD(MesAno(dDataAte)+"01") , 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BCONTSIN','SRA->RA_CATFUNC $ "C*T" .AND. SRA->RA_PGCTSIN $ "S*T*D"','000003','000000','.CON.','5','','','5','SRA->RA_CATFUNC $ "C*T" .AND. SRA->RA_PGCTSIN $ "S*T*D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BCONTSIN','SRA->RA_CATFUNC == "T"','000004','000003','.CON.','5','','','5','SRA->RA_CATFUNC == "T"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BCONTSIN','NBASESIND := FBUSCAACM (ACODFOL[165,1]+"/"+ ACODFOL[166,1],{','000005','000004','.EXE.','5','nBaseSind := fBuscaAcm (aCodFol[165,1]+"/"+ aCodFol[166,1],{ || !(Empty(RV_TAREFA)).AND. RV_SINDICA=="S" },dDtMesAnt, dDtMesAnt)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BCONTSIN','SRA->RA_CATFUNC == "C"','000006','000003','.CON.','5','','','5','SRA->RA_CATFUNC == "C"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BCONTSIN','NBASESIND := FBUSCAACM (ACODFOL[165,1]+"/"+ ACODFOL[166,1],{','000007','000006','.EXE.','5','nBaseSind := fBuscaAcm (aCodFol[165,1]+"/"+ aCodFol[166,1],{ ||  RV_SINDICA=="S" },dDtMesAnt, dDtMesAnt)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0030    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0030( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BINSSCI','BASE INSS CONTRIB. INDIVIDUAL','','002190','004','2','1',} )

aAdd(aRc3Cols, { '','S_','BINSSCI','SRA->RA_CATFUNC $ "A*P"','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC $ "A*P"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BINSSCI','SRA->RA_CATEG $ "17|18"   .END.','000002','000001','.CON.','5','','','5','SRA->RA_CATEG $ "17|18"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BINSSCI','EMPTY(CVERBAROT)','000003','000002','.CON.','5','','','5','Empty(cVerbaRot)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BINSSCI','cVerbaRot := fGetCodFol("1384")     .END.','000004','000003','.EXE.','5','cVerbaRot := fGetCodFol("1384")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BINSSCI','fGeraVerba(cVerbaRot,nSalC_c)     .END.','000005','000002','.EXE.','5','fGeraVerba(cVerbaRot,nSalC_c)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BINSSCI','!(SRA->RA_CATEG $ "17|18")   .END.','000006','000001','.CON.','5','','','5','!(SRA->RA_CATEG $ "17|18")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BINSSCI','EMPTY(CVERBAROT)','000007','000006','.CON.','5','','','5','Empty(cVerbaRot)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BINSSCI','CVERBAROT := FGETCODFOL("0221")','000008','000007','.EXE.','5','cVerbaRot := fGetCodFol("0221")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BINSSCI','FGERAVERBA(CVERBAROT,NSALC_B)','000009','000006','.EXE.','5','fGeraVerba(cVerbaRot,nSalC_b)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0031    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0031( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BINSSOE','BASE/ VALOR INSS OUTRAS EMPRESAS','','002191','006','2','1',} )

aAdd(aRc3Cols, { '','S_','BINSSOE','SRA->RA_CATFUNC $ "P*A"','000001','000000','.CON.','5','','','5','SRA->RA_CATFUNC $ "P*A"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BINSSOE','!EMPTY( ACODFOL[288,1] )','000002','000001','.CON.','5','','','5','!Empty( aCodFol[288,1] )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BINSSOE','AEVAL( APD , { |X| NVLBSOUT += IF( X[1] == ACODFOL[288,1] .A','000003','000002','.EXE.','5','aEval( aPD , { |x| nVlBsOut += IF( x[1] == aCodFol[288,1] .and. X[3] <= cSemana .and. x[9] # "D" , x[5] , 0.00 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BINSSOE','!EMPTY( ACODFOL[289,1] )','000004','000001','.CON.','5','','','5','!Empty( aCodFol[289,1] )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BINSSOE','AEVAL( APD , { |X| NVINSSOUT += IF( X[1] == ACODFOL[289,1] .','000005','000004','.EXE.','5','aEval( aPD , { |x| nVInssOut += IF( x[1] == aCodFol[289,1] .and. X[3] <= cSemana .and. x[9] # "D" , x[5] , 0.00 ) } )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0032    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0032( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BMEDFER','BUSCA MEDIAS CALCULADAS PARA FERIAS','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','BMEDFER','fMedFer(@nMediaOut,@nMediaHrs,@nMedia13s,@nAntec13o)     .EN','000001','000000','.EXE.','5','fMedFer(@nMediaOut,@nMediaHrs,@nMedia13s,@nAntec13o)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0033    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0033( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BSHRATIV','MONTA BASE HRS. ATIVIDADE','','002192','005','2','1',} )

aAdd(aRc3Cols, { '','S_','BSHRATIV','(SRA->RA_CATFUNC $ "I*J")','000001','000000','.CON.','','','','6','(SRA->RA_CATFUNC $ "I*J")','','','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','BSHRATIV','NBSHRSATIV := 0.00','000002','000001','.EXE.','6','nBsHrsAtiv := 0.00','','','','','','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','BSHRATIV','AEVAL( APD ,{ |X|  SOMAINC(X,30,@NBSHRSATIV,,,,,,,ACODFOL) }','000003','000001','.EXE.','5','Aeval( aPd ,{ |X|  SomaInc(X,30,@nBsHrsAtiv,,,,,,,aCodFol) })','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0034    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0034( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BUSCAMED','BUSCA MEDIA RESCISAO - GFP','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','BUSCAMED','BuscaMed(@nMedFerv,@nMedFerp,@nMed13o,@nMedAviso,@nDesc13,@n','000001','000000','.EXE.','5','BuscaMed(@nMedFerv,@nMedFerp,@nMed13o,@nMedAviso,@nDesc13,@nMedDobra)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0035    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0035( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','BUSMEDF','BUSCA MEDIA FERIAS','','002193','003','2','1',} )

aAdd(aRc3Cols, { '','S_','BUSMEDF','BUSCAMED(@NMEDFERV,@NMEDFERP,@NMED13O,@NMEDAVISO,@NDESC13,@N','000001','000000','.EXE.','5','BuscaMed(@nMedFerv,@nMedFerp,@nMed13o,@nMedAviso,@nDesc13,@nMedDobra)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0036    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0036( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','C13SRES','CALCULO 13. SALARIO RESCISAO','','002194','003','2','1',} )

aAdd(aRc3Cols, { '','S_','C13SRES','FCAL13O(APD,ACODFOL,NMED13O)','000001','000000','.EXE.','5','fCal13o(aPd,aCodfol,nMed13o)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0037    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0037( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CADIFFER','CALCULA DIFERENCA FERIAS','','002195','007','2','1',} )

aAdd(aRc3Cols, { '','S_','CADIFFER','CTIPOROT # "4" .OR. ( SRA->RA_SITFOLH == "F" .OR. CCOMPL ==','000001','000000','.CON.','5','','','5','cTipoRot # "4" .or. ( SRA->RA_SITFOLH == "F" .or. cCompl == "S" .or. lRecRes .Or. P_LMEDMP927 .Or. P_LMEDMP1046 )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CADIFFER','FCDIFFERIAS()','000002','000001','.EXE.','5','fCDifFerias()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0038    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0038( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAINSAL','CALCULO INSALUBRIDADE','','','015','2','1',} )

aAdd(aRc3Cols, { '','S_','CAINSAL','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. ( CTIPOROT # "2"','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. ( cTipoRot # "2" ) ) .and. cTipoIns <> "1" .AND. cBCalIns $ "1256"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CCODINS := CVERBAROT','000002','000001','.EXE.','5','cCodIns := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','LPROPDIA := !(CTIPOROT $ "3*5*6")','000003','000001','.EXE.','5','lPropDia := !(cTipoRot $ "3*5*6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','EMPTY(CCODINS)','000004','000001','.CON.','5','','','5','Empty(cCodIns)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CTIPOROT == "3"','000005','000004','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CCODINS := FGETCODFOL('+"'"+'1304'+"'"+')','000006','000005','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'1304'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CTIPOROT $ "5*6"','000007','000004','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CTIPOROT == "5"','000008','000007','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CCODINS := FGETCODFOL('+"'"+'1634'+"'"+')','000009','000008','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'1634'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','LVB13MAT2','000010','000008','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CCODINSM := FGETCODFOL('+"'"+'1645'+"'"+')','000011','000010','.EXE.','5','cCodInsM := FGETCODFOL('+"'"+'1645'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','!LVB13MAT2','000012','000008','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CCODINSM := FGETCODFOL('+"'"+'1442'+"'"+')','000013','000012','.EXE.','5','cCodInsM := FGETCODFOL('+"'"+'1442'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CTIPOROT == "6"','000014','000007','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CCODINS := FGETCODFOL('+"'"+'1292'+"'"+')','000015','000014','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'1292'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','CCODINSM := FGETCODFOL('+"'"+'1442'+"'"+')','000016','000014','.EXE.','5','cCodInsM := FGETCODFOL('+"'"+'1442'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSAL','INSALUB(ACODFOL, VAL_SALMIN, @NINSALUB, "S",  SALHORA, .T.,','000017','000001','.EXE.','5','Insalub(aCodfol, VAL_SALMIN, @nInsalub, "S",  SalHora, .T., cCodIns, nHrsInsal, cBCalIns, nPerc_Ins,cTipoIns,@nHoraInsa, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0039    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0039( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAINSALV','CALCULO INSALUBRIDADE SOBRE VERBAS','','','015','2','1',} )

aAdd(aRc3Cols, { '','S_','CAINSALV','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. ( CTIPOROT # "2"','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. ( cTipoRot # "2" ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CTIPOINS <> "1" .AND. CBCALINS $ "3*4*7*8"','000002','000001','.CON.','5','','','5','cTipoIns <> "1" .and. cBCalIns $ "3*4*7*8"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CCODINS := CVERBAROT','000003','000002','.EXE.','5','cCodIns := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','EMPTY(CCODINS)','000004','000002','.CON.','5','','','5','Empty(cCodIns)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CTIPOROT $ "1*2*4"','000005','000004','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CCODINS := FGETCODFOL('+"'"+'1282'+"'"+')','000006','000005','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'1282'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CTIPOROT == "3"','000007','000004','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CCODINS := FGETCODFOL('+"'"+'1306'+"'"+')','000008','000007','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'1306'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CTIPOROT $ "5*6"','000009','000004','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CTIPOROT == "5"','000010','000009','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CCODINS := FGETCODFOL('+"'"+'1635'+"'"+')','000011','000010','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'1635'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','LVB13MAT2','000012','000010','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CCODINSM := FGETCODFOL('+"'"+'1646'+"'"+')','000013','000012','.EXE.','5','cCodInsM := FGETCODFOL('+"'"+'1646'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','!LVB13MAT2','000014','000010','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CCODINSM := FGETCODFOL('+"'"+'1443'+"'"+')','000015','000014','.EXE.','5','cCodInsM := FGETCODFOL('+"'"+'1443'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CTIPOROT == "6"','000016','000009','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CCODINS := FGETCODFOL('+"'"+'1293'+"'"+')','000017','000016','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'1293'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','CCODINSM := FGETCODFOL('+"'"+'1443'+"'"+')','000018','000016','.EXE.','5','cCodInsM := FGETCODFOL('+"'"+'1443'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSALV','INSALUB(ACODFOL, VAL_SALMIN, @NINSALUB, "S",  SALHORA, .T.,','000019','000002','.EXE.','5','Insalub(aCodfol, VAL_SALMIN, @nInsalub, "S",  SalHora, .T., cCodIns, nHrsInsal, cBCalIns, nPerc_Ins,cTipoIns,@nHoraInsa)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0040    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0040( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAINSMA','CALCULA INSALUBRIDADE MAXIMA','','002196','011','2','1',} )

aAdd(aRc3Cols, { '','S_','CAINSMA','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSMA','CTIPOINS == "4" .AND. CBCALINS $ "1256"','000002','000001','.CON.','5','','','5','cTipoIns == "4" .AND. cBCalIns $ "1256"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSMA','CCODINS := CVERBAROT','000003','000002','.EXE.','5','cCodIns := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSMA','EMPTY(CCODINS)','000004','000002','.CON.','5','','','5','Empty(cCodIns)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSMA','CTIPOROT $ "1*2*4"','000005','000004','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSMA','CCODINS := FGETCODFOL('+"'"+'0039'+"'"+')','000006','000005','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'0039'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSMA','INSALUB(ACODFOL, VAL_SALMIN, @NINSALUB, "S",  SALHORA, .T.,','000007','000002','.EXE.','5','Insalub(aCodfol, VAL_SALMIN, @nInsalub, "S",  SalHora, .T., cCodIns, nHrsInsal, cBCalIns, nPerc_Ins,cTipoIns,@nHoraInsa)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0041    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0041( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAINSME','CALCULA INSALUBRIDADE MEDIA','','002197','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CAINSME','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSME','CTIPOINS == "3" .AND. CBCALINS $ "1256"','000002','000001','.CON.','5','','','5','cTipoIns == "3" .AND. cBCalIns $ "1256"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSME','CCODINS := CVERBAROT','000003','000002','.EXE.','5','cCodIns := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSME','EMPTY(CCODINS)','000004','000002','.CON.','5','','','5','Empty(cCodIns)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSME','CTIPOROT $ "1*2*4"','000005','000004','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSME','CCODINS := FGETCODFOL('+"'"+'0038'+"'"+')','000006','000005','.EXE.','5','cCodIns := FGETCODFOL('+"'"+'0038'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSME','INSALUB(ACODFOL, VAL_SALMIN, @NINSALUB, "S",  SALHORA, .T.,','000007','000002','.EXE.','5','Insalub(aCodfol, VAL_SALMIN, @nInsalub, "S",  SalHora, .T., cCodIns, nHrsInsal, cBCalIns, nPerc_Ins,cTipoIns,@nHoraInsa)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0042    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0042( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAINSMI','CALCULA INSALUBRIDADE MINIMA','','002198','018','2','1',} )

aAdd(aRc3Cols, { '','S_','CAINSMI','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSMI','CTIPOINS == "2" .AND. CBCALINS $ "1256"','000002','000001','.CON.','5','','','5','cTipoIns == "2" .AND. cBCalIns $ "1256"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSMI','CCODINS := CVERBAROT','000003','000002','.EXE.','5','CCODINS := CVERBAROT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSMI','EMPTY(CCODINS)','000004','000002','.CON.','5','','','5','Empty(CCODINS)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSMI','CTIPOROT $ "1*2*4"','000005','000004','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAINSMI','CCODINS := FGETCODFOL('+"'"+'0037'+"'"+')','000006','000005','.EXE.','5','CCODINS := FGETCODFOL('+"'"+'0037'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAINSMI','INSALUB(ACODFOL, VAL_SALMIN, @NINSALUB, "S",  SALHORA, .T.,','000007','000002','.EXE.','5','Insalub(aCodfol, VAL_SALMIN, @nInsalub, "S",  SalHora, .T., CCODINS, nHrsInsal, cBCalIns, nPerc_Ins,cTipoIns,@nHoraInsa)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0043    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0043( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAIRFFER','CALCULA IR DE FERIAS','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','CAIRFFER','CTIPOROT == "1"','000001','000000','.CON.','5','','','5','cTipoRot == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAIRFFER','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND','000002','000001','.CON.','5','','','5','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND. ACONVOCACAO[6])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAIRFFER','FCIRFER(ACODFOL,ATABIR,.T.,DDATA_PGTO)','000003','000002','.EXE.','5','fCIrfer(aCodfol,aTabir,.T.,dData_pgto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAIRFFER','cTipoRot $ "3*L*M"','000004','000000','.CON.','5','','','5','cTipoRot $ "3*L*M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAIRFFER','FCIRFER(ACODFOL,ATABIR,,,.T.,"F")','000005','000004','.EXE.','5','fcIrFer(aCodfol,aTabIr,,,.T.,"F")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAIRFFER','CTIPOROT == "4"','000006','000000','.CON.','5','','','5','cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAIRFFER','FCIRFER(ACODFOL,ATABIR,.T.,GETMEMVAR("RG_DATAHOM"))','000007','000006','.EXE.','5','fCIrfer(aCodfol,aTabir,.T.,GetMemVar("RG_DATAHOM"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0044    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0044( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAL113FP','CALCULO 1A. PARCELA 13.SALARIO - GFP','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CAL113FP','NVLBSTETO := 0     .CNT.','000001','000000','.EXE.','5','NVLBSTETO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','CVRB0022 := FGETCODFOL("0022")     .CNT.','000002','000000','.EXE.','5','CVRB0022 := FGETCODFOL("0022")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','lRecalc13 := .f.     .CNT.','000003','000000','.EXE.','5','lRecalc13 := .f.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','NPOS1 := aScan(APD, {|x| x[1] == FGETCODFOL("1382")})     .C','000004','000000','.EXE.','5','NPOS1 := aScan(APD, {|x| x[1] == FGETCODFOL("1382")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','NPOS2 := aScan(APD, {|x| x[1] == FGETCODFOL("0070")})     .C','000005','000000','.EXE.','5','NPOS2 := aScan(APD, {|x| x[1] == FGETCODFOL("0070")})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','(NPOS1 > 0  .AND. APD[NPOS1][9] <> "D")  .OR. (NPOS2 > 0','000006','000000','.CON.','5','','','5','(NPOS1 > 0  .AND. APD[NPOS1][9] <> "D")  .OR. (NPOS2 > 0  .AND. APD[NPOS2][9] <> "D")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','lRecalc13 := .t.     .END.','000007','000006','.EXE.','5','lRecalc13 := .t.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','!( SRA->RA_CATFUNC == "4" )   .END.','000008','000000','.CON.','5','','','5','!( SRA->RA_CATFUNC == "4" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','nAntec13 <= 0   .END.','000009','000008','.CON.','5','','','5','nAntec13 <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','dAnoDtini := CTOD("01/01/"+ALLTRIM(STR(YEAR(DDATAREF))))','000010','000009','.EXE.','5','dAnoDtini := CTOD("01/01/"+ALLTRIM(STR(YEAR(DDATAREF))))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','dAnoDtfim := CTOD("31/12/"+ ALLTRIM(STR(YEAR(DDATAATE))))','000011','000009','.EXE.','5','dAnoDtfim := CTOD("31/12/"+ ALLTRIM(STR(YEAR(DDATAATE))))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','nAntec13 := FBUSCAACM(FGETCODFOL("0022"),, dAnoDtini, dAnoDt','000012','000009','.EXE.','5','nAntec13 := FBUSCAACM(FGETCODFOL("0022"),, dAnoDtini, dAnoDtfim, "V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','nAntec13 += FBUSCAACM(FGETCODFOL("0028"),, dAnoDtini, dAnoDt','000013','000009','.EXE.','5','nAntec13 += FBUSCAACM(FGETCODFOL("0028"),, dAnoDtini, dAnoDtfim, "V")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','nAntec13 > 0 .AND. !(aPergunte[02,3] = 2)   .END.','000014','000008','.CON.','5','','','5','nAntec13 > 0 .AND. !(aPergunte[02,3] = 2)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','FINALFUN()     .END.','000015','000014','.EXE.','5','FINALFUN()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','NCOUNT := 1     .CNT.','000016','000008','.EXE.','5','NCOUNT := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','NCOUNT <= LEN(APD)   .END.','000017','000008','.ENQ.','5','','','5','NCOUNT <= LEN(APD)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','APD[NCOUNT][9] <> "D"   .END.','000018','000017','.CON.','5','','','5','APD[NCOUNT][9] <> "D"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','("001S" $ POSICIONE("SRV",1,XFILIAL("SRV") + APD[NCOUNT][1','000019','000018','.CON.','5','','','5','("001S" $ POSICIONE("SRV",1,XFILIAL("SRV") + APD[NCOUNT][1] , "RV_ACUMAUX" ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','NVLBSTETO := IF( SRV->RV_TIPOCOD $ "1*3",  NVLBSTETO + APD[N','000020','000019','.EXE.','5','NVLBSTETO := IF( SRV->RV_TIPOCOD $ "1*3",  NVLBSTETO + APD[NCOUNT][5] , NVLBSTETO - APD[NCOUNT][5] )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','"003" $ SRV->RV_ACUMAUX   .END.','000021','000018','.CON.','5','','','5','"003" $ SRV->RV_ACUMAUX','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','N13SAL := IIF( SRV->RV_TIPOCOD $ "1*3", (N13SAL + APD[NCOUNT','000022','000021','.EXE.','5','N13SAL := IIF( SRV->RV_TIPOCOD $ "1*3", (N13SAL + APD[NCOUNT][5] ), (N13SAL - APD[NCOUNT][5] ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','!(SRV->RV_TIPOCOD $ '+"'"+'3/4'+"'"+')   .END.','000023','000021','.CON.','5','','','5','!(SRV->RV_TIPOCOD $ '+"'"+'3/4'+"'"+')','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','APD[NCOUNT][9] := "D"     .END.','000024','000023','.EXE.','5','APD[NCOUNT][9] := "D"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','!LRECALC13 .and. !("003" $ SRV->RV_ACUMAUX)   .END.','000025','000018','.CON.','5','','','5','!LRECALC13 .and. !("003" $ SRV->RV_ACUMAUX)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','!(APD[NCOUNT][7] $ "I/G")   .END.','000026','000025','.CON.','5','','','5','!(APD[NCOUNT][7] $ "I/G")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','APD[NCOUNT][5] := ROUND(APD[NCOUNT][5]*(APERGUNTE[01,3]/100)','000027','000026','.EXE.','5','APD[NCOUNT][5] := ROUND(APD[NCOUNT][5]*(APERGUNTE[01,3]/100), 2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','NCOUNT++     .END.','000028','000017','.EXE.','5','NCOUNT++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13SalMed := FBUSCAACM(NIL, " '+"'"+'002S'+"'"+' $ RV_ACUMAUX ", dAnoDti','000029','000008','.EXE.','5','n13SalMed := FBUSCAACM(NIL, " '+"'"+'002S'+"'"+' $ RV_ACUMAUX ", dAnoDtini, dAnoDtfim, "V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','(NVLBSTETO > P_LIMTETO)   .END.','000030','000008','.CON.','5','','','5','(NVLBSTETO > P_LIMTETO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13Sal := IIF(n13Sal>P_LIMTETO, P_LIMTETO, n13Sal)     .CNT.','000031','000030','.EXE.','5','n13Sal := IIF(n13Sal>P_LIMTETO, P_LIMTETO, n13Sal)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13SalMed := IIF(n13SalMed>P_LIMTETO, P_LIMTETO, n13SalMed)','000032','000030','.EXE.','5','n13SalMed := IIF(n13SalMed>P_LIMTETO, P_LIMTETO, n13SalMed)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13Sal := ( n13Sal / 12 * nAvos)     .CNT.','000033','000008','.EXE.','5','n13Sal := ( n13Sal / 12 * nAvos)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13SalMed := ( n13SalMed / 12 * nAvos)     .CNT.','000034','000008','.EXE.','5','n13SalMed := ( n13SalMed / 12 * nAvos)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13SalMed > n13Sal   .END.','000035','000008','.CON.','5','','','5','n13SalMed > n13Sal','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13Sal := n13SalMed     .END.','000036','000035','.EXE.','5','n13Sal := n13SalMed','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13Sal := ROUND( n13Sal * (aPergunte[01,3]/100), 2)     .CNT','000037','000008','.EXE.','5','n13Sal := ROUND( n13Sal * (aPergunte[01,3]/100), 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13Sal := n13Sal - nAntec13     .CNT.','000038','000008','.EXE.','5','n13Sal := n13Sal - nAntec13','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13Sal <= 0 .And. SRA->RA_AFASFGT # "O"   .END.','000039','000008','.CON.','5','','','5','n13Sal <= 0 .And. SRA->RA_AFASFGT # "O"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','FIMFORMULA()     .END.','000040','000039','.EXE.','3','FIMFORMULA()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','n13Sal := Round(n13Sal, 2)     .CNT.','000041','000008','.EXE.','5','n13Sal := Round(n13Sal, 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','N13SAL > 0 .AND. aScan(APD, {|x| x[1] == CVRB0022 .AND. x[','000042','000008','.CON.','5','','','5','N13SAL > 0 .AND. aScan(APD, {|x| x[1] == CVRB0022 .AND. x[7] == "I" }) <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL113FP','FGeraVerba(CVRB0022,N13SAL,(NAVOS * (APERGUNTE[01,3]/100)),,','000043','000042','.EXE.','5','FGeraVerba(CVRB0022,N13SAL,(NAVOS * (APERGUNTE[01,3]/100)),,,,,,,,,,,,,,,,DDATA_PGTO,,, )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0045    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0045( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAL213FP','CALCULO 2. PARCELA 13. SALARIO - GFP','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CAL213FP','!( SRA->RA_CATFUNC == "4" )   .END.','000001','000000','.CON.','5','','','5','!( SRA->RA_CATFUNC == "4" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','!(CTIPOROT == "4") .OR. (CTIPOROT == "4" .AND. SUBSTR(CSUP','000002','000001','.CON.','5','','','5','!(CTIPOROT == "4") .OR. (CTIPOROT == "4" .AND. SUBSTR(CSUPLEM,1,1) == "2")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NANTEC13 <= 0   .END.','000003','000002','.CON.','5','','','5','NANTEC13 <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','DANODTINI := CTOD("01/01/" +ALLTRIM(STR(YEAR(DDATAREF))))','000004','000003','.EXE.','5','DANODTINI := CTOD("01/01/" +ALLTRIM(STR(YEAR(DDATAREF))))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','DANODTFIM := DDATAATE     .CNT.','000005','000003','.EXE.','5','DANODTFIM := DDATAATE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NANTEC13 := FBUSCAACM(FGETCODFOL("0022"),, DANODTINI, DANODT','000006','000003','.EXE.','5','NANTEC13 := FBUSCAACM(FGETCODFOL("0022"),, DANODTINI, DANODTFIM, "V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NANTEC13 += FBUSCAACM(FGETCODFOL("0028"),, DANODTINI, DANODT','000007','000003','.EXE.','5','NANTEC13 += FBUSCAACM(FGETCODFOL("0028"),, DANODTINI, DANODTFIM, "V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NANTEC13 += FBUSCAACM(FGETCODFOL("0123"),, DANODTINI, DANODT','000008','000003','.EXE.','5','NANTEC13 += FBUSCAACM(FGETCODFOL("0123"),, DANODTINI, DANODTFIM, "V")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','N13SALMED := FBUSCAACM(NIL, " '+"'"+'002S'+"'"+' $ RV_ACUMAUX ", DANODTI','000009','000002','.EXE.','5','N13SALMED := FBUSCAACM(NIL, " '+"'"+'002S'+"'"+' $ RV_ACUMAUX ", DANODTINI, DANODTFIM, "V")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','N13SALMED := ROUND(( N13SALMED / 12 * NAVOS), 2)     .CNT.','000010','000002','.EXE.','5','N13SALMED := ROUND(( N13SALMED / 12 * NAVOS), 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','ARET := FRILRET( DDATADE, IF(CTIPOROT == "4" , STOD("9999123','000011','000002','.EXE.','5','ARET := FRILRET( DDATADE, IF(CTIPOROT == "4" , STOD("99991231"), DDATAATE) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','len(aRet) > 0   .END.','000012','000002','.CON.','5','','','5','len(aRet) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','ATABS116 := {}     .CNT.','000013','000012','.EXE.','5','ATABS116 := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','FRETTAB( @ATABS116, "S116", , , DDATAREF, , .T.)     .CNT.','000014','000012','.EXE.','5','FRETTAB( @ATABS116, "S116", , , DDATAREF, , .T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','W := 1     .CNT.','000015','000012','.EXE.','5','W := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','W <= LEN(ARET)   .END.','000016','000012','.ENQ.','5','','','5','W <= LEN(ARET)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NAUX := FPOSTAB("S116", ARET[W,01], "==", 4, CROT, "$",','000017','000016','.EXE.','5','NAUX := FPOSTAB("S116", ARET[W,01], "==", 4, CROT, "$", 9 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NAUX > 0   .END.','000018','000016','.CON.','5','','','5','NAUX > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','CVBDESIG += FTABELA("S116", NAUX, 8, DDATAREF ) + '+"'"+'/'+"'"+'     .E','000019','000018','.EXE.','5','CVBDESIG += FTABELA("S116", NAUX, 8, DDATAREF ) + '+"'"+'/'+"'"+'','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','W++     .END.','000020','000016','.EXE.','5','W++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NCOUNT := 1     .CNT.','000021','000002','.EXE.','5','NCOUNT := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NCOUNT <= LEN(APD)   .END.','000022','000002','.ENQ.','5','','','5','NCOUNT <= LEN(APD)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','("003S" $ POSICIONE("SRV",1,XFILIAL("SRV") + APD[NCOUNT][1','000023','000022','.CON.','5','','','5','("003S" $ POSICIONE("SRV",1,XFILIAL("SRV") + APD[NCOUNT][1], "RV_ACUMAUX" )) .AND. APD[NCOUNT][9] <> "D" .AND. ( SRV->RV_COD != FGETCODFOL("1371") .or. (CTIPOROT $ "6" .and. SRA->RA_CATFUNC == '+"'"+'6'+"'"+'))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','N13SAL := IIF( SRV->RV_TIPOCOD $ "1*3", (N13SAL + APD[NCOUNT','000024','000023','.EXE.','5','N13SAL := IIF( SRV->RV_TIPOCOD $ "1*3", (N13SAL + APD[NCOUNT][5]), (N13SAL - APD[NCOUNT][5]) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','APD[NCOUNT][1] $ CVBDESIG .and. ("003S" $ SRV->RV_ACUMAUX','000025','000022','.CON.','5','','','5','APD[NCOUNT][1] $ CVBDESIG .and. ("003S" $ SRV->RV_ACUMAUX .or. "002S" $ SRV->RV_ACUMAUX )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','APD[NCOUNT][9] := "D"     .END.','000026','000025','.EXE.','5','APD[NCOUNT][9] := "D"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','NCOUNT++     .END.','000027','000022','.EXE.','5','NCOUNT++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','n13Sal := Round(( N13SAL / 12 * nAvos), 2)     .CNT.','000028','000002','.EXE.','5','n13Sal := Round(( N13SAL / 12 * nAvos), 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','N13SALMED > N13SAL   .END.','000029','000002','.CON.','5','','','5','N13SALMED > N13SAL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAL213FP','N13SAL := N13SALMED     .END.','000030','000029','.EXE.','5','N13SAL := N13SALMED','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0046    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0046( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALACONF','CALCULO ADICIONAL CARGO CONFIANCA','','','023','2','1',} )

aAdd(aRc3Cols, { '','S_','CALACONF','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','SRA->RA_ADCCONF > 0','000002','000001','.CON.','5','','','5','SRA->RA_ADCCONF > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CCODCONF := CVERBAROT','000003','000002','.EXE.','5','cCodConf := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','NPERCONF := SRA->RA_ADCCONF','000004','000002','.EXE.','5','nPerConf := SRA->RA_ADCCONF','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','EMPTY(CCODCONF)','000005','000002','.CON.','5','','','5','Empty(cCodConf)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CTIPOROT $ "1*2*4"','000006','000005','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CCODCONF := FGETCODFOL("0984")','000007','000006','.EXE.','5','cCodConf := FGETCODFOL("0984")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CTIPOROT == "3"','000008','000005','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CCODCONF := FGETCODFOL("1308")','000009','000008','.EXE.','5','cCodConf := FGETCODFOL("1308")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CTIPOROT $ "5*6"','000010','000005','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CTIPOROT == "5"','000011','000010','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CCODCONF := FGETCODFOL("1636")','000012','000011','.EXE.','5','cCodConf := FGETCODFOL("1636")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','LVB13MAT2','000013','000011','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CCODCONFM := FGETCODFOL("1647")','000014','000013','.EXE.','5','cCodConfM := FGETCODFOL("1647")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','!LVB13MAT2','000015','000011','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CCODCONFM := FGETCODFOL("1444")','000016','000015','.EXE.','5','cCodConfM := FGETCODFOL("1444")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CTIPOROT == "6"','000017','000010','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CCODCONF := FGETCODFOL("1294")','000018','000017','.EXE.','5','cCodConf := FGETCODFOL("1294")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','CCODCONFM := FGETCODFOL("1444")','000019','000017','.EXE.','5','cCodConfM := FGETCODFOL("1444")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','ldissidio   .END.','000020','000002','.CON.','5','','','5','ldissidio .and. NDIASPG > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALACONF','ndiaspg:=diastrab -1     .END.','000021','000020','.EXE.','5','ndiaspg:=diastrab -1','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALACONF','FCADCONF (ACODFOL, "S",SALMES,, , CCODCONF, NPERCONF,@NADCCO','000022','000002','.EXE.','5','fCAdConf (aCodfol, "S",SalMes,, , cCodConf, nPerConf,@nAdcConf)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0047    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0047( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALADTRF','CALCULO ADICIONAL TRANSFERENCIA','','','018','2','1',} )

aAdd(aRc3Cols, { '','S_','CALADTRF','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','LDISSIDIO := IF(TYPE("LDISSIDIO")=="U",.F.,LDISSIDIO)','000002','000001','.EXE.','5','LDISSIDIO := IF(TYPE("LDISSIDIO")=="U",.F.,LDISSIDIO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','SRA->RA_ADCTRF > 0 .OR. LDISSIDIO','000003','000001','.CON.','5','','','5','SRA->RA_ADCTRF > 0 .OR. LDISSIDIO','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CCODTRF  := CVERBAROT','000004','000003','.EXE.','5','cCodTrf  := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','NPERADTRF  := SRA-> RA_ADCTRF','000005','000003','.EXE.','5','nPerAdTrf  := SRA-> RA_ADCTRF','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','EMPTY(CCODTRF)','000006','000003','.CON.','5','','','5','Empty(cCodTrf)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CTIPOROT $ "1*2*4"','000007','000006','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CCODTRF := FGETCODFOL("0988")','000008','000007','.EXE.','5','cCodTrf := FGETCODFOL("0988")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CTIPOROT == "3"','000009','000006','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CCODTRF := FGETCODFOL("1310")','000010','000009','.EXE.','5','cCodTrf := FGETCODFOL("1310")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CTIPOROT $ "5*6"','000011','000006','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CTIPOROT == "5"','000012','000011','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CCODTRF := FGETCODFOL("1637")','000013','000012','.EXE.','5','cCodTrf := FGETCODFOL("1637")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','LVB13MAT2','000014','000012','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CCODTRFM := FGETCODFOL("1648")','000015','000014','.EXE.','5','cCodTrfM := FGETCODFOL("1648")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','!LVB13MAT2','000016','000012','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CCODTRFM := FGETCODFOL("1445")','000017','000016','.EXE.','5','cCodTrfM := FGETCODFOL("1445")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CTIPOROT == "6"','000018','000011','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CCODTRF := FGETCODFOL("1295")','000019','000018','.EXE.','5','cCodTrf := FGETCODFOL("1295")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','CCODTRFM := FGETCODFOL("1445")','000020','000018','.EXE.','5','cCodTrfM := FGETCODFOL("1445")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALADTRF','FCADTRF(ACODFOL,"S",SALMES, , , CCODTRF, NPERADTRF ,@NADCTRF','000021','000003','.EXE.','5','fCAdTrf(aCodfol,"S",SalMes, , , cCodTrf, nPerAdTrf ,@nAdcTrf)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0048    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0048( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALAFAS','CALCULO AFASTADOS','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CALAFAS','FAFASTADOS(ACODFOL)','000001','000000','.EXE.','5','fAfastados(aCodFol)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0049    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0049( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALC131','CALCULO PRIMEIRA PARCELA DE 13º SALARIO','','','028','2','1',} )

aAdd(aRc3Cols, { '','S_','CALC131','LCOMPL13 := CTIPOROT == "5" .AND. APERGUNTE[5,3] == 2','000001','000000','.EXE.','5','lCompl13 := cTipoRot == "5" .And. aPergunte[5,3] == 2','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','nAvosTot := nAvos + nAvosMat     .CNT.','000002','000000','.EXE.','5','nAvosTot := nAvos + nAvosMat','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','NDMATERN := FDIASSM13(SUBSTR(CPERIODO,1,4),,,,APERGUNTE[6,3]','000003','000000','.EXE.','5','nDMatern := fDiasSm13(SubStr(cPeriodo,1,4),,,,APERGUNTE[6,3])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','LADC131 := LCOMPL13 .AND. !FQUEBAD131()','000004','000000','.EXE.','5','lAdc131 := lCompl13 .And. !fQuebAd131()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','N13SAL :=  ( (  SALARIO / 12 )  * NAVOSTOT ) * NPERCENTUA','000005','000000','.EXE.','5','n13Sal :=  ( (  Salario / 12 )  * nAvosTot ) * nPercentua','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','N13SALM :=  ( (  SALARIO / 12 ) / 30 * NDMATERN ) * NPERCENT','000006','000000','.EXE.','5','n13SalM :=  ( (  Salario / 12 ) / 30 * NDMATERN ) * nPercentua','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','N13SAL := ( N13SAL  - NANT13SAL)','000007','000000','.EXE.','5','n13Sal := ( n13Sal  - NANT13SAL )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','NDIF13SAL :=  ( ( ( SALARIO + NMEDIA + FSOMAADIC() ) / 12 *','000008','000000','.EXE.','5','nDif13Sal :=  ( ( ( Salario + nMedia + FSOMAADIC() ) / 12 * (nAvos+nAvosMat)  ) ) * nPercentua','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','NDIF13SAL := ( NDIF13SAL  - NANTEC13)','000009','000000','.EXE.','5','nDif13Sal := ( nDif13Sal  - nAntec13)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','LADC131','000010','000000','.CON.','5','','','5','lAdc131','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC131','NDIF13SAL := ROUND( ( ( ( ( SALARIO + NMEDIA  + NSOMAADIC) /','000011','000010','.EXE.','5','nDif13Sal := Round( ( ( ( ( Salario + nMedia  + nSomaAdic) / 12 * (nAvos+nAvosMat)  ) ) * nPercentua ), 2) - NANTEC13','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','N13SAL := NDIF13SAL - ( FBUSCAPD( ACODFOL[1628,1]','000012','000010','.EXE.','5','n13Sal := nDif13Sal - ( fBuscaPD( aCodFol[1628,1] ) + fBuscaPD( aCodFol[1629,1] ) + fBuscaPD( aCodFol[1639,1] ) + fBuscaPD( aCodFol[1640,1] ))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','NDIF13SAL <= 0 .AND. SRA->RA_CATFUNC <> "C" .AND. SRA->RA_AF','000013','000000','.CON.','5','','','5','nDif13Sal <= 0 .and. SRA->RA_CATFUNC <> "C" .and. SRA->RA_AFASFGT <> "O1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC131','NAVOFGTS == 0','000014','000013','.CON.','5','','','5','nAvoFGTS == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC131','FINALFUN()','000015','000014','.EXE.','5','FINALFUN()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','ADDLOGEXECROT("FUNCIONÁRIO " + SRA->RA_FILIAL + "/" + SRA->R','000016','000014','.EXE.','5','ADDLOGEXECROT("FUNCIONÁRIO " + SRA->RA_FILIAL + "/" + SRA->RA_MAT + " JÁ POSSUI ROTEIRO 131 CALCULADO EM PERIODOS ANTERIORES.")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC131','NAVOFGTS > 0','000017','000013','.CON.','5','','','5','nAvoFGTS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC131','APD := {}','000018','000017','.EXE.','5','aPd := {}','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0050    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0050( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALC132','CALCULO SEGUNDA PARCELA DE 13º INTEGRAL','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','CALC132','NPOS24 := FLOCALIAPD( ACODFOL[24,1] )','000001','000000','.EXE.','5','NPOS24 := FLOCALIAPD( ACODFOL[24,1] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC132','nAvosTot  := nAvos + nAvosMat     .CNT.','000002','000000','.EXE.','5','nAvosTot  := nAvos + nAvosMat','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC132','nDMatern  := fDiasSm13(SubStr(cPeriodo,1,4))     .CNT.','000003','000000','.EXE.','5','nDMatern  := fDiasSm13(SubStr(cPeriodo,1,4))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC132','NPOS24 > 0','000004','000000','.CON.','5','','','5','nPos24 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC132','N13SAL += FBUSCAPD( ACODFOL[24,1] )','000005','000004','.EXE.','5','n13Sal += FBUSCAPD( ACODFOL[24,1] )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC132','NPOS24 == 0','000006','000000','.CON.','5','','','5','nPos24 == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC132','N13SAL :=   (  SALARIO / 12 )  * (NAVOS+NAVOSMAT)','000007','000006','.EXE.','5','n13Sal :=   (  Salario / 12 )  * nAvosTot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC132','N13SALM :=  ( (  SALARIO / 12 ) / 30) * NDMATERN','000008','000006','.EXE.','5','n13SalM :=  ( (  Salario / 12 ) / 30) * nDMatern','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0051    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0051( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCADTS','CALCULA AD.TEMPO SERVICO','','','025','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCADTS','!( "N" $ CTIPOATS )','000001','000000','.CON.','5','','','5','!( "N" $ cTipoAts )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','"A" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFAN) .OR. RCE->RCE_DT','000002','000001','.CON.','5','','','5','"A" $ cTipoAts .And. (Empty(RCE->RCE_DTFAN) .Or. RCE->RCE_DTFAN > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CADTPOSER := "A"','000003','000002','.EXE.','5','cAdtPoSer := "A"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LPROPDIA := !( CTIPOROT $ "3*5*6" )','000004','000002','.EXE.','5','lPropDia := !( cTipoRot $ "3*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTPCAATS $ "1*2*3"','000005','000002','.CON.','5','','','5','cTpCaAts $ "1*2*3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CBCALATS # "2"','000006','000005','.CON.','5','','','5','cBCalATS # "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := CVERBAROT','000007','000006','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','EMPTY(CCODADT)','000008','000006','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT $ "5*6"','000009','000008','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "5"','000010','000009','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1630'+"'"+')','000011','000010','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1630'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LVB13MAT2','000012','000010','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1641'+"'"+')','000013','000012','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1641'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','!LVB13MAT2','000014','000010','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000015','000014','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "6"','000016','000009','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1288'+"'"+')','000017','000016','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1288'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000018','000016','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "3"','000019','000008','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1296'+"'"+')','000020','000019','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1296'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000021','000006','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','"B" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFBI) .OR. RCE->RCE_DT','000022','000001','.CON.','5','','','5','"B" $ cTipoAts .And. (Empty(RCE->RCE_DTFBI) .Or. RCE->RCE_DTFBI > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CADTPOSER := "B"','000023','000022','.EXE.','5','cAdtPoSer := "B"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LPROPDIA := !( CTIPOROT $ "3*5*6" )','000024','000022','.EXE.','5','lPropDia := !( cTipoRot $ "3*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTPCAATS $ "1*2*3"','000025','000022','.CON.','5','','','5','cTpCaAts $ "1*2*3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CBCALATS # "2"','000026','000025','.CON.','5','','','5','cBCalATS # "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := CVERBAROT','000027','000026','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','EMPTY(CCODADT)','000028','000026','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT $ "5*6"','000029','000028','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "5"','000030','000029','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1630'+"'"+')','000031','000030','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1630'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LVB13MAT2','000032','000030','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1641'+"'"+')','000033','000032','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1641'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','!LVB13MAT2','000034','000030','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000035','000034','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "6"','000036','000029','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1288'+"'"+')','000037','000036','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1288'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000038','000036','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "3"','000039','000028','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1296'+"'"+')','000040','000039','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1296'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000041','000026','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','"T" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFTR) .OR. RCE->RCE_DT','000042','000001','.CON.','5','','','5','"T" $ cTipoAts .And. (Empty(RCE->RCE_DTFTR) .Or. RCE->RCE_DTFTR > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CADTPOSER := "T"','000043','000042','.EXE.','5','cAdtPoSer := "T"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LPROPDIA := !( CTIPOROT $ "3*5*6" )','000044','000042','.EXE.','5','lPropDia := !( cTipoRot $ "3*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTPCAATS $ "1*2*3"','000045','000042','.CON.','5','','','5','cTpCaAts $ "1*2*3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CBCALATS # "2"','000046','000045','.CON.','5','','','5','cBCalATS # "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := CVERBAROT','000047','000046','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','EMPTY(CCODADT)','000048','000046','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT $ "5*6"','000049','000048','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "5"','000050','000049','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1630'+"'"+')','000051','000050','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1630'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LVB13MAT2','000052','000050','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1641'+"'"+')','000053','000052','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1641'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','!LVB13MAT2','000054','000050','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000055','000054','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "6"','000056','000049','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1288'+"'"+')','000057','000056','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1288'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000058','000056','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "3"','000059','000048','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1296'+"'"+')','000060','000059','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1296'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000061','000046','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','"D" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFQR) .OR. RCE->RCE_DT','000062','000001','.CON.','5','','','5','"D" $ cTipoAts .And. (Empty(RCE->RCE_DTFQR) .Or. RCE->RCE_DTFQR > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CADTPOSER := "D"','000063','000062','.EXE.','5','cAdtPoSer := "D"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LPROPDIA := !( CTIPOROT $ "3*5*6" )','000064','000062','.EXE.','5','lPropDia := !( cTipoRot $ "3*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTPCAATS $ "1*2*3"','000065','000062','.CON.','5','','','5','cTpCaAts $ "1*2*3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CBCALATS # "2"','000066','000065','.CON.','5','','','5','cBCalATS # "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := CVERBAROT','000067','000066','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','EMPTY(CCODADT)','000068','000066','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT $ "5*6"','000069','000068','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "5"','000070','000069','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1630'+"'"+')','000071','000070','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1630'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LVB13MAT2','000072','000070','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1641'+"'"+')','000073','000072','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1641'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','!LVB13MAT2','000074','000070','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000075','000074','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "6"','000076','000069','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1288'+"'"+')','000077','000076','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1288'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000078','000076','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "3"','000079','000068','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1296'+"'"+')','000080','000079','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1296'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000081','000066','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','"Q" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFQN) .OR. RCE->RCE_DT','000082','000001','.CON.','5','','','5','"Q" $ cTipoAts .And. (Empty(RCE->RCE_DTFQN) .Or. RCE->RCE_DTFQN > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CADTPOSER := "Q"','000083','000082','.EXE.','5','cAdtPoSer := "Q"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LPROPDIA := !( CTIPOROT $ "3*5*6" )','000084','000082','.EXE.','5','lPropDia := !( cTipoRot $ "3*5*6" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTPCAATS $ "1*2*3"','000085','000082','.CON.','5','','','5','cTpCaAts $ "1*2*3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CBCALATS # "2"','000086','000085','.CON.','5','','','5','cBCalATS # "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := CVERBAROT','000087','000086','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','EMPTY(CCODADT)','000088','000086','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT $ "5*6"','000089','000088','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "5"','000090','000089','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1630'+"'"+')','000091','000090','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1630'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','LVB13MAT2','000092','000090','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1641'+"'"+')','000093','000092','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1641'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','!LVB13MAT2','000094','000090','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000095','000094','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "6"','000096','000089','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1288'+"'"+')','000097','000096','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1288'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADTM := FGETCODFOL('+"'"+'1438'+"'"+')','000098','000096','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1438'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CTIPOROT == "3"','000099','000088','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CCODADT := FGETCODFOL('+"'"+'1296'+"'"+')','000100','000099','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1296'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000101','000086','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CADTPOSER := CTIPOATS','000102','000001','.EXE.','5','cAdtPoSer := cTipoAts','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTS','CADTPOSER := STRTRAN(CADTPOSER,"*","")','000103','000001','.EXE.','5','cAdtPoSer := StrTran(cAdtPoSer,"*","")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0052    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0052( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCADTV','CALCULA AD.TEMPO SERVICO VERBAS','','','017','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCADTV','!( "N" $ CTIPOATS )','000001','000000','.CON.','5','','','5','!( "N" $ cTipoAts )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','"A" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFAN) .OR. RCE->RCE_DT','000002','000001','.CON.','5','','','5','"A" $ cTipoAts .And. (Empty(RCE->RCE_DTFAN) .Or. RCE->RCE_DTFAN > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cAdtPoSer := "A"     .CNT.','000003','000002','.EXE.','5','cAdtPoSer := "A"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LPROPDIA := !(CTIPOROT $ "3*5*6")','000004','000002','.EXE.','5','lPropDia := !(cTipoRot $ "3*5*6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTPCAATS == "1" .OR. CTPCAATS == "2"','000005','000002','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CBCALATS == "2"','000006','000005','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := CVERBAROT','000007','000006','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','EMPTY(CCODADT)','000008','000006','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT $ "5*6"','000009','000008','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "5"','000010','000009','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1631'+"'"+')','000011','000010','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1631'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LVB13MAT2','000012','000010','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1642'+"'"+')','000013','000012','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1642'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','!LVB13MAT2','000014','000010','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000015','000014','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "6"','000016','000009','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1289'+"'"+')','000017','000016','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1289'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000018','000016','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "3"','000019','000008','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1298'+"'"+')','000020','000019','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1298'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000021','000006','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','"B" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFBI) .OR. RCE->RCE_DT','000022','000001','.CON.','5','','','5','"B" $ cTipoAts .And. (Empty(RCE->RCE_DTFBI) .Or. RCE->RCE_DTFBI > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cAdtPoSer := "B"     .CNT.','000023','000022','.EXE.','5','cAdtPoSer := "B"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LPROPDIA := !(CTIPOROT $ "3*5*6")','000024','000022','.EXE.','5','lPropDia := !(cTipoRot $ "3*5*6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTPCAATS == "1" .OR. CTPCAATS == "2"','000025','000022','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CBCALATS == "2"','000026','000025','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := CVERBAROT','000027','000026','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','EMPTY(CCODADT)','000028','000026','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT $ "5*6"','000029','000028','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "5"','000030','000029','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1631'+"'"+')','000031','000030','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1631'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LVB13MAT2','000032','000030','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1642'+"'"+')','000033','000032','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1642'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','!LVB13MAT2','000034','000030','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000035','000034','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cTipoRot == "6"   .END.','000036','000029','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1289'+"'"+')','000037','000036','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1289'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000038','000036','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "3"','000039','000028','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1298'+"'"+')','000040','000039','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1298'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000041','000026','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','"T" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFTR) .OR. RCE->RCE_DT','000042','000001','.CON.','5','','','5','"T" $ cTipoAts .And. (Empty(RCE->RCE_DTFTR) .Or. RCE->RCE_DTFTR > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cAdtPoSer := "T"     .CNT.','000043','000042','.EXE.','5','cAdtPoSer := "T"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LPROPDIA := !(CTIPOROT $ "3*5*6")','000044','000042','.EXE.','5','lPropDia := !(cTipoRot $ "3*5*6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTPCAATS == "1" .OR. CTPCAATS == "2"','000045','000042','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CBCALATS == "2"','000046','000045','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := CVERBAROT','000047','000046','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','EMPTY(CCODADT)','000048','000046','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT $ "5*6"','000049','000048','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "5"','000050','000049','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1631'+"'"+')','000051','000050','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1631'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LVB13MAT2','000052','000050','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1642'+"'"+')','000053','000052','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1642'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','!LVB13MAT2','000054','000050','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000055','000054','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cTipoRot == "6"   .END.','000056','000049','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1289'+"'"+')','000057','000056','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1289'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000058','000056','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "3"','000059','000048','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1298'+"'"+')','000060','000059','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1298'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000061','000046','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','(("D" $ CTIPOATS) .AND. (EMPTY(RCE->RCE_DTFQR) .OR. RCE->RCE','000062','000001','.CON.','5','','','5','"D" $ cTipoAts .And. (Empty(RCE->RCE_DTFQR) .Or. RCE->RCE_DTFQR > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cAdtPoSer := "D"     .CNT.','000063','000062','.EXE.','5','cAdtPoSer := "D"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LPROPDIA := !(CTIPOROT $ "3*5*6")','000064','000062','.EXE.','5','lPropDia := !(cTipoRot $ "3*5*6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTPCAATS == "1" .OR. CTPCAATS == "2"','000065','000062','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CBCALATS == "2"','000066','000065','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := CVERBAROT','000067','000066','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','EMPTY(CCODADT)','000068','000066','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT $ "5*6"','000069','000068','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "5"','000070','000069','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1631'+"'"+')','000071','000070','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1631'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LVB13MAT2','000072','000070','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1642'+"'"+')','000073','000072','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1642'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','!LVB13MAT2','000074','000070','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000075','000074','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cTipoRot == "6"   .END.','000076','000069','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1289'+"'"+')','000077','000076','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1289'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000078','000076','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "3"','000079','000068','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1298'+"'"+')','000080','000079','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1298'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000081','000066','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','"Q" $ CTIPOATS .AND. (EMPTY(RCE->RCE_DTFQN) .OR. RCE->RCE_DT','000082','000001','.CON.','5','','','5','"Q" $ cTipoAts .And. (Empty(RCE->RCE_DTFQN) .Or. RCE->RCE_DTFQN > DDATADE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cAdtPoSer := "Q"     .CNT.','000083','000082','.EXE.','5','cAdtPoSer := "Q"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LPROPDIA := !(CTIPOROT $ "3*5*6")','000084','000082','.EXE.','5','lPropDia := !(cTipoRot $ "3*5*6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTPCAATS == "1" .OR. CTPCAATS == "2"','000085','000082','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CBCALATS == "2"','000086','000085','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := CVERBAROT','000087','000086','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','EMPTY(CCODADT)','000088','000086','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT $ "5*6"','000089','000088','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "5"','000090','000089','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1631'+"'"+')','000091','000090','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1631'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','LVB13MAT2','000092','000090','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1642'+"'"+')','000093','000092','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1642'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','!LVB13MAT2','000094','000090','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000095','000094','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','cTipoRot == "6"   .END.','000096','000089','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1289'+"'"+')','000097','000096','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1289'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADTM := FGETCODFOL('+"'"+'1439'+"'"+')','000098','000096','.EXE.','5','cCodAdtM := FGETCODFOL('+"'"+'1439'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CTIPOROT == "3"','000099','000088','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','CCODADT := FGETCODFOL('+"'"+'1298'+"'"+')','000100','000099','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1298'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCADTV','FCALADT(ACODFOL,@NADTSERV,"N",SALMES,,P_ADCINTEG, CCODADT, C','000101','000086','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"N",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia, .T. )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0053    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0053( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCANU','CALCULO ANUENIO','','','033','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCANU','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANU','CCODADT := CVERBAROT','000002','000001','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANU','!( "N" $ CTIPOATS ) .AND. "A" $ CTIPOATS .AND. ( EMPTY(RCE->','000003','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "A" $ cTipoAts .and. ( Empty(RCE->RCE_DTFAN) .or. RCE->RCE_DTFAN > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANU','CADTPOSER := "A"','000004','000003','.EXE.','5','cAdtPoSer := "A"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANU','EMPTY(CCODADT)','000005','000003','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANU','CTIPOROT $ "1*2*4"','000006','000005','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANU','CCODADT := FGETCODFOL('+"'"+'0001'+"'"+')','000007','000006','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'0001'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANU','CTPCAATS == "1" .OR. CTPCAATS == "2"','000008','000003','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANU','CBCALATS <> "2"','000009','000008','.CON.','5','','','5','cBCalATS <> "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANU','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000010','000009','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANU','CTPCAATS == "3"','000011','000003','.CON.','5','','','5','cTpCaAts == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANU','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000012','000011','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0054    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0054( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCANUV','CALCULO ANUENIO SOBRE VERBAS','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCANUV','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','!( "N" $ cTipoAts ) .and. "A" $ cTipoAts .AND. ( EMPTY(RCE','000002','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "A" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFAN) .OR. RCE->RCE_DTFAN > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','cAdtPoSer := "A"     .CNT.','000003','000002','.EXE.','5','cAdtPoSer := "A"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','!( CTIPOROT $ "3*5*6" )','000004','000002','.CON.','5','','','5','!( cTipoRot $ "3*5*6" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','lPropDia := .T.     .END.','000005','000004','.EXE.','5','lPropDia := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','cTpCaAts == "1" .OR. cTpCaAts == "2"   .END.','000006','000002','.CON.','5','','','5','cTpCaAts == "1" .OR. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','cBCalATS == "2"   .END.','000007','000006','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','cCodAdt := cVerbaRot     .CNT.','000008','000007','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','Empty(cCodAdt)   .END.','000009','000007','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','CTIPOROT $ "1*2*4"','000010','000009','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','CCODADT := FGETCODFOL('+"'"+'1283'+"'"+')','000011','000010','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1283'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, c','000012','000007','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")','000013','000006','.CON.','5','','','5','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")) > 0 .AND. SRA->RA_HOJORVA = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','CBCALATS == "1"   .END.','000014','000013','.CON.','5','','','5','CBCALATS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','CCODADT := FGETCODFOL('+"'"+'0001'+"'"+')     .CNT.','000015','000014','.EXE.','5','CCODADT := FGETCODFOL('+"'"+'0001'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCANUV','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT','000016','000014','.EXE.','5','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT, CADTPOSER, CTPCAATS, CBCALATS, LPROPDIA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0055    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0055( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCARRE','Arredondamento','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCARRE','NVALARRAD > 0','000001','000000','.CON.','','','','6','nValArrAd > 0','','','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCARRE','CALC_ARRE(@VAL_LIQ,@NVALARRAD,@VAL_ARRE)','000002','000001','.EXE.','6','CALC_ARRE(@VAL_LIQ,@nValArrAd,@VAL_ARRE)','','','','','','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0056    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0056( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCBIE','CALCULO BIENIO','','','015','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCBIE','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','CCODADT := CVERBAROT','000002','000001','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','!( "N" $ CTIPOATS ) .AND. "B" $ CTIPOATS .AND. ( EMPTY(RCE','000003','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "B" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFBI) .OR. RCE->RCE_DTFBI > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','CADTPOSER := "B"','000004','000003','.EXE.','5','cAdtPoSer := "B"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','EMPTY(CCODADT)','000005','000003','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','CTIPOROT $ "1*2*4"','000006','000005','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','CCODADT := FGETCODFOL('+"'"+'0002'+"'"+')','000007','000006','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'0002'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','CTPCAATS == "1" .OR. CTPCAATS == "2"','000008','000003','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','CBCALATS <> "2"','000009','000008','.CON.','5','','','5','cBCalATS <> "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000010','000009','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','CTPCAATS == "3"','000011','000003','.CON.','5','','','5','cTpCaAts == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIE','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000012','000011','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0057    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0057( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCBIEV','CALCULO BIENIO SOBRE VERBAS','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCBIEV','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','!( "N" $ cTipoAts ) .and. "B" $ cTipoAts .AND. ( EMPTY(RCE','000002','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "B" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFBI) .OR. RCE->RCE_DTFBI > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','cAdtPoSer := "B"     .CNT.','000003','000002','.EXE.','5','cAdtPoSer := "B"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','!( CTIPOROT $ "3*5*6" )','000004','000002','.CON.','5','','','5','!( cTipoRot $ "3*5*6" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','lPropDia := .T.     .END.','000005','000004','.EXE.','5','lPropDia := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','cTpCaAts == "1" .OR. cTpCaAts == "2"   .END.','000006','000002','.CON.','5','','','5','cTpCaAts == "1" .OR. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','cBCalATS == "2"   .END.','000007','000006','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','cCodAdt := cVerbaRot     .CNT.','000008','000007','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','Empty(cCodAdt)   .END.','000009','000007','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','CTIPOROT $ "1*2*4"','000010','000009','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','CCODADT := FGETCODFOL('+"'"+'1284'+"'"+')','000011','000010','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1284'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, c','000012','000007','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")','000013','000006','.CON.','5','','','5','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")) > 0 .AND. SRA->RA_HOJORVA = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','CBCALATS == "1"   .END.','000014','000013','.CON.','5','','','5','CBCALATS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','CCODADT := FGETCODFOL('+"'"+'0002'+"'"+')     .CNT.','000015','000014','.EXE.','5','CCODADT := FGETCODFOL('+"'"+'0002'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCBIEV','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT','000016','000014','.EXE.','5','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT, CADTPOSER, CTPCAATS, CBCALATS, LPROPDIA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0058    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0058( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCCNE','CALCULO CNE - CARGO NAT. ESPEC - GFP','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCCNE','x := 0     .CNT.','000001','000000','.EXE.','5','x := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nAPDCount := 0     .CNT.','000002','000000','.EXE.','5','nAPDCount := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aRetCNE := PerComis(SRA->RA_FILIAL, SRA->RA_MAT, dDataDe, dD','000003','000000','.EXE.','5','aRetCNE := PerComis(SRA->RA_FILIAL, SRA->RA_MAT, dDataDe, dDataAte, dDataAte, , If(SRA->RA_CATFUNC=="6","'+"'"+'001'+"'"+','+"'"+'004'+"'"+'",NIL))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nDiasAfast := 30 - DiasTrab     .CNT.','000004','000000','.EXE.','5','nDiasAfast := 30 - DiasTrab','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','NDIASAFAST > 0 .AND. LEN(ARETCNE) == 1 .AND. CROT <> FGETCAL','000005','000000','.CON.','5','','','5','NDIASAFAST > 0 .AND. LEN(ARETCNE) == 1 .AND. cRot <> fGetCalcRot("L")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aRetCNE[1][9] -= nDiasAfast     .END.','000006','000005','.EXE.','5','aRetCNE[1][9] -= nDiasAfast','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nDiasAfast > 0 .AND. Len(aRetCNE) > 1   .END.','000007','000000','.CON.','5','','','5','nDiasAfast > 0 .AND. Len(aRetCNE) > 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','X := Len(aRetCNE)     .CNT.','000008','000007','.EXE.','5','X := Len(aRetCNE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','x > Val("0") /* FOI NECESSARIO DAR O VAL POIS A FORMULA NA','000009','000007','.ENQ.','5','','','5','x > Val("0") /* FOI NECESSARIO DAR O VAL POIS A FORMULA NAO ACEITA ZERO */ .AND. (nDiasAfast > 0)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nDProp := If( nDiasAfast >  aRetCNE[x][9] ,  aRetCNE[x][9] ,','000010','000009','.EXE.','5','nDProp := If( nDiasAfast >  aRetCNE[x][9] ,  aRetCNE[x][9] , nDiasAfast )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nDiasAfast := nDiasAfast - nDProp     .CNT.','000011','000009','.EXE.','5','nDiasAfast := nDiasAfast - nDProp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aRetCNE[x][9] := aRetCNE[x][9] - nDProp     .CNT.','000012','000009','.EXE.','5','aRetCNE[x][9] := aRetCNE[x][9] - nDProp','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','x--     .END.','000013','000009','.EXE.','5','x--','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aTabS114 := {}     .CNT.','000014','000000','.EXE.','5','aTabS114 := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVb30 := cVb35 := cVbVal := cBaseVb := ""     .CNT.','000015','000000','.EXE.','5','cVb30 := cVb35 := cVbVal := cBaseVb := ""','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','fCarrTab(@aTabS114,"S114", DDATAATE , .T. )     .CNT.','000016','000000','.EXE.','5','fCarrTab(@aTabS114,"S114", DDATAATE , .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','Len(aRetCNE) > 0   .END.','000017','000000','.CON.','5','','','5','Len(aRetCNE) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','x := 1     .CNT.','000018','000017','.EXE.','5','x := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','x <= Len(aRetCNE)   .END.','000019','000017','.ENQ.','5','','','5','x <= Len(aRetCNE)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','CTXT := "CALCULO DO CNE PARA CATEGORIA 2 PARA 3 OU VICE-E-VE','000020','000019','.EXE.','5','CTXT := "CALCULO DO CNE PARA CATEGORIA 2 PARA 3 OU VICE-E-VERSA"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aRetCNE[x][9] > 0   .END.','000021','000019','.CON.','5','','','5','aRetCNE[x][9] > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aRetCNE[x][2]  == "NOM" .AND. aRetCNE[x][7] $ "3*2" /* EM','000022','000021','.CON.','5','','','5','aRetCNE[x][2]  == "NOM" .AND. aRetCNE[x][7] $ "3*2" /* EM COMISSIONAMENTO */','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','y := 1     .CNT.','000023','000022','.EXE.','5','y := 1','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','y <= Len(aTabS114)   .END.','000024','000022','.ENQ.','5','','','5','y <= Len(aTabS114)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aTabS114[y][1] = "S114"   .END.','000025','000024','.CON.','5','','','5','aTabS114[y][1] = "S114"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aTabS114[y][5] == "C" .AND. aTabS114[y][9] == aRetCNE[x][1','000026','000025','.CON.','5','','','5','aTabS114[y][5] == "C" .AND. aTabS114[y][9] == aRetCNE[x][14] .AND. aTabS114[y][10] == aRetCNE[x][15]  /* Tipo / Tabela / Nivel */','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','lCont := aRetCNE[x][11] == "1" /* DIFERENCA DE SUBSIDIO */','000027','000026','.CON.','5','','','5','lCont := aRetCNE[x][11] == "1" /* DIFERENCA DE SUBSIDIO */','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cBaseVb := aTabS114[y][06]     .CNT.','000028','000027','.EXE.','5','cBaseVb := aTabS114[y][06]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVbVal := aTabS114[y][11]     .CNT.','000029','000027','.EXE.','5','cVbVal := aTabS114[y][11]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVb30 := aTabS114[y][12]     .CNT.','000030','000027','.EXE.','5','cVb30 := aTabS114[y][12]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVb35 := aTabS114[y][13]     .CNT.','000031','000027','.EXE.','5','cVb35 := aTabS114[y][13]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := (( ((aRetCNE[x][10]-NRJORN2SAL) - (aRetCNE[x][3]-','000032','000027','.EXE.','5','nVlCalc := (( ((aRetCNE[x][10]-NRJORN2SAL) - (aRetCNE[x][3]-NRJORN1SAL)) / 30 ) * aRetCNE[x][9] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := MAX(nVlCalc, 0)     .END.','000033','000027','.EXE.','5','nVlCalc := MAX(nVlCalc, 0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','!(lCont)   .END.','000034','000026','.CON.','5','','','5','!(lCont)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cBaseVb := aTabS114[y][06]     .CNT.','000035','000034','.EXE.','5','cBaseVb := aTabS114[y][06]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVbVal := aTabS114[y][14]     .CNT.','000036','000034','.EXE.','5','cVbVal := aTabS114[y][14]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVb30 := aTabS114[y][15]     .CNT.','000037','000034','.EXE.','5','cVb30 := aTabS114[y][15]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVb35 := aTabS114[y][16]     .CNT.','000038','000034','.EXE.','5','cVb35 := aTabS114[y][16]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := TabSalIni(aRetCNE[x][14], If(dDataDe>ARETCNE[X][1','000039','000034','.EXE.','5','nVlCalc := TabSalIni(aRetCNE[x][14], If(dDataDe>ARETCNE[X][1], dDataDe, (ARETCNE[X][1]) + aRetCNE[x][9] - 1), .F., aRetCNE[x][15], aRetCNE[x][16] ) /* VERIFICA VALOR TABELA SALARIAL */','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := nVlCalc - NRJORN2SAL     .CNT.','000040','000034','.EXE.','5','nVlCalc := nVlCalc - NRJORN2SAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := nVlCalc * ( aRetCNE[x][12] / 100) /* CALCULA O PE','000041','000034','.EXE.','5','nVlCalc := nVlCalc * ( aRetCNE[x][12] / 100) /* CALCULA O PERCENTUAL */','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := ( (nVlCalc / 30 ) * aRetCNE[x][9] ) /* PROPORCION','000042','000034','.EXE.','5','nVlCalc := ( (nVlCalc / 30 ) * aRetCNE[x][9] ) /* PROPORCIONALIZA */','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := MAX(nVlCalc, 0)     .END.','000043','000034','.EXE.','5','nVlCalc := MAX(nVlCalc, 0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','Y++     .END.','000044','000024','.EXE.','5','Y++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVbGer := If( LREDUJOR30 , cVb30 , If( LREDUJOR35 , cVb35 ,','000045','000022','.EXE.','5','cVbGer := If( LREDUJOR30 , cVb30 , If( LREDUJOR35 , cVb35 , cVbVal ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVbGer := If( CTIPOROT $ "5", cBaseVb, cVbGer )     .CNT.','000046','000022','.EXE.','5','cVbGer := If( CTIPOROT $ "5", cBaseVb, cVbGer )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','( (NVLCALC > 0) .AND. !(EMPTY(CVBGER)) .AND. ASCAN(APD,{|X|','000047','000022','.CON.','5','','','5','( (NVLCALC > 0) .AND. !(EMPTY(CVBGER)) .AND. ASCAN(APD,{|X| X[1] == CVBGER .AND. X[7] == "I" .AND. X[9] <> "D"}) == 0 ) .AND. cRot <> fGetCalcRot("L")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','AEval(aPD, { | x | IIf( x[1] == CVBGER .AND. x[9] <> "D", nA','000048','000047','.EXE.','5','AEval(aPD, { | x | IIf( x[1] == CVBGER .AND. x[9] <> "D", nApdCount++, )})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','CSEQ := iif(nApdCount > 0, STR(nApdCount)," ")     .CNT.','000049','000047','.EXE.','5','CSEQ := iif(nApdCount > 0, STR(nApdCount)," ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','FGeraVerba(cVbGer,nVlCalc,aRetCne[x][9],,,,,,,,,,,cSeq)','000050','000047','.EXE.','5','FGeraVerba(cVbGer,nVlCalc,aRetCne[x][9],,,,,,,,,,,cSeq)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','CTIPOROT == "z4z"   .END.','000051','000047','.CON.','5','','','5','CTIPOROT == "z4z"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVbGer := cBaseVb     .CNT.','000052','000051','.EXE.','5','cVbGer := cBaseVb','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nAPDCount := 0     .CNT.','000053','000051','.EXE.','5','nAPDCount := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','AEval(aPD, { | x | IIf( x[1] == CVBGER .AND. x[9] <> "D", nA','000054','000051','.EXE.','5','AEval(aPD, { | x | IIf( x[1] == CVBGER .AND. x[9] <> "D", nApdCount++, )})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','CSEQ := iif(nApdCount > 0, STR(nApdCount)," ")     .CNT.','000055','000051','.EXE.','5','CSEQ := iif(nApdCount > 0, STR(nApdCount)," ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','FGeraVerba(cVbGer,nVlCalc,aRetCne[x][9],,,,,,,,,,,cSeq)','000056','000051','.EXE.','5','FGeraVerba(cVbGer,nVlCalc,aRetCne[x][9],,,,,,,,,,,cSeq)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aRetCNE[x][7] == "6" /* COMISSIONADO PURO */ .AND.  (Len(a','000057','000021','.CON.','5','','','5','aRetCNE[x][7] == "6" /* COMISSIONADO PURO */ .AND.  (Len(aRetCNE) > 1) /* COM ALTERACAO NO PERIODO */ .AND. (aRetCNE[x][9] > 0)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVb0644 := fGetCodFol("644")     .CNT.','000058','000057','.EXE.','5','cVb0644 := fGetCodFol("644")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','cVb1375 := fGetCodFol("1375")     .CNT.','000059','000057','.EXE.','5','cVb1375 := fGetCodFol("1375")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','lCont := (x == 1) /* PRIMEIRO REGISTRO TEM QUE AJUSTAR A V','000060','000057','.CON.','5','','','5','lCont := (x == 1) /* PRIMEIRO REGISTRO TEM QUE AJUSTAR A VERBA DO ID 0644 */','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','aScan(aPd,{|X| x[1] == cVb0644 .and. x[7] == "I" .and. x[9','000061','000060','.CON.','5','','','5','aScan(aPd,{|X| x[1] == cVb0644 .and. x[7] == "I" .and. x[9] <> "D"}) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nPos := aScan(aPd,{|X| x[1] == cVb0644 .and. x[9] <> "D"})','000062','000061','.EXE.','5','nPos := aScan(aPd,{|X| x[1] == cVb0644 .and. x[9] <> "D"})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','APD[NPOS,9] := '+"'"+'D'+"'"+'','000063','000061','.EXE.','5','aPD[nPos,9] := '+"'"+'D'+"'"+'','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := ROUND((ARETCNE[x][3] / 30 * ARETCNE[x][9]), MSDEC','000064','000061','.EXE.','5','nVlCalc := ROUND((ARETCNE[x][3] / 30 * ARETCNE[x][9]), MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','(NVLCALC > 0) .AND. CROT <> FGETCALCROT("L")','000065','000061','.CON.','5','','','5','(nVlCalc > 0) .And. cRot <> fGetCalcRot("L")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','FGeraVerba(cVb0644,nVlCalc,aRetCne[x][9])     .END.','000066','000065','.EXE.','5','FGeraVerba(cVb0644,nVlCalc,aRetCne[x][9])','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','!lCont   .END.','000067','000057','.CON.','5','','','5','!lCont','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nApdCount := 0     .CNT.','000068','000067','.EXE.','5','nApdCount := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','AEval(aPD, { | x | IIf( x[1] == CVB1375 .AND. x[9] <> "D", n','000069','000067','.EXE.','5','AEval(aPD, { | x | IIf( x[1] == CVB1375 .AND. x[9] <> "D", nApdCount++, )})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','CSEQ := iif(nApdCount > 0, STR(nApdCount)," ")     .CNT.','000070','000067','.EXE.','5','CSEQ := iif(nApdCount > 0, STR(nApdCount)," ")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','nVlCalc := ROUND((ARETCNE[x][3] / 30 * ARETCNE[x][9]), MSDEC','000071','000067','.EXE.','5','nVlCalc := ROUND((ARETCNE[x][3] / 30 * ARETCNE[x][9]), MSDECIMAIS(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','(NVLCALC > 0) .AND. ASCAN(APD,{|X| X[1] == CVBGER .AND. X[7]','000072','000067','.CON.','5','','','5','(nVlCalc > 0) .AND. aScan(aPd,{|X| x[1] == cVbGer .and. x[7] == "I" .and. x[9] <> "D"}) == 0 .AND. cRot <> fGetCalcRot("L")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','FGeraVerba(cVb1375,nVlCalc,aRetCne[x][9],,,,,,,,,,,cSeq)','000073','000072','.EXE.','5','FGeraVerba(cVb1375,nVlCalc,aRetCne[x][9],,,,,,,,,,,cSeq)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','X++     .END.','000074','000019','.EXE.','5','X++','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','CROT == FGETCALCROT("L")','000075','000000','.CON.','5','','','5','cRot == fGetCalcRot("L")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCNE','NDIFCNEFER := NVLCALC','000076','000075','.EXE.','5','NDIFCNEFER := NVLCALC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0059    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0059( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCCOMP','CALCULA FOLHA COMPLEMENTAR','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCCOMP','SRA->RA_TIPOPGT # "S" .AND. LCALCCOMPL','000001','000000','.CON.','5','','','5','SRA->RA_TIPOPGT # "S" .and. LCALCCOMPL','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCCOMP','FCALCOMPL()','000002','000001','.EXE.','5','fCalCompl()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0060    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0060( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCDSR','CALCULA DSR','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCDSR','FCALCDSR(@NDSR,LADMISSAO,@NHORASTRAB,@NHORASDSR)','000001','000000','.EXE.','5','FCalcDSR(@nDsr,lAdmissao,@nHorasTrab,@nHorasDsr)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0061    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0061( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIR','Calcula I.R.?','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIR','FM010INCIR()','000001','000000','.EXE.','6','FM010IncIR()','','','','','','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0062    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0062( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCIR13','CALCULO DO IRF 13.SALARIO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCIR13','CTIPOROT == "1"','000001','000000','.CON.','5','','','5','cTipoRot == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIR13','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND','000002','000001','.CON.','5','','','5','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND. ACONVOCACAO[6])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIR13','FCIR13O(ACODFOL,ATABIR)','000003','000002','.EXE.','5','fCIr13o(aCodfol,aTabir)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIR13','CTIPOROT == "4"','000004','000000','.CON.','5','','','5','cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIR13','FCIR13O(ACODFOL,ATABIR,,,NIR13P)','000005','000004','.EXE.','5','fCIr13o(aCodfol,aTabir,,,nIr13P)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCIR13','CTIPOROT == "6"','000006','000000','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCIR13','FCIR13O(ACODFOL,ATABIR13,,.F.)','000007','000006','.EXE.','5','fCIr13o(aCodfol,aTabIr13,,.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0063    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0063( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCONV','CALCULA CONVENCAO COLETIVA','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCONV','(!EMPTY(ACODFOL[159,1]) .AND. CTIPOROT <> "4" ) .OR. (!EMPTY','000001','000000','.CON.','5','','','5','(!Empty(aCodFol[159,1]) .and. cTipoRot <> "4" ) .or. (!Empty(aCodFol[158,1]) .and. cTipoRot == "4" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCONV','CTIPOROT # "4"','000002','000001','.CON.','5','','','5','cTipoRot # "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCONV','CALC_CONV(NBASECALC, ACONVENCAO, ACODFOL, "F", GETMEMVAR("RH','000003','000002','.EXE.','5','Calc_Conv(nBaseCalc, aConvencao, aCodFol, "F", GetMemVar("RH_DFERIAS"), GetMemVar("RH_DABONPE"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCONV','CTIPOROT == "4" .AND. ( CCOMPL # "S" .OR. ( CCOMPL == "S" .A','000004','000001','.CON.','5','','','5','cTipoRot == "4" .and. ( cCompl # "S" .or. ( cCompl == "S" .and. MesAno(GetMemVar("RG_DATADEM")) == MesAno(GetMemVar("RG_DTGERAR")) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCONV','NBASECALC := SALARIO + NADTSERV + NPERIC + NINSALUB + NADCCO','000005','000004','.EXE.','5','nBaseCalc := Salario + nAdtServ + nPeric + nInsalub + nAdcConf + nAdcTrf','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCONV','CALC_CONV((NBASECALC / NDIASC) * (GETMEMVAR("RG_DFERVEN")+','000006','000004','.EXE.','5','Calc_Conv((nBaseCalc / nDiasC) * (GetMemVar("RG_DFERVEN") + GetMemVar("RG_DFERPRO")), aConvencao,aCodFol,"R")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0064    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0064( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCOTB','CALCULA OUTROS BENEFICIOS','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCOTB','FOTBCALC()','000001','000000','.EXE.','5','fOtbCalc()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0065    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0065( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCP13','CALCULO 1A.PARC 13.SALARIO (P) - GFP','','','002','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCP13','N13SAL := 0     .CNT.','000001','000000','.EXE.','5','N13SAL := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCP13','NVLBSTETO := 0     .CNT.','000002','000000','.EXE.','5','NVLBSTETO := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCP13','S_DESIGNAC()   /* Calcula novamente pois a designacao por es','000003','000000','.EXE.','5','S_DESIGNAC()   /* Calcula novamente pois a designacao por estar incorporada pelo acumulador auxiliar */','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCP13','S_CAL113FP()  /* Calcula novamente devido a nova base de cal','000004','000000','.EXE.','5','S_CAL113FP()  /* Calcula novamente devido a nova base de calculo considerando abono permanencia e redutor de teto */','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0066    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0066( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCPENS','Calc. Pensao Alim.','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCPENS','CTIPOROT $ "1*9*O"','000001','000000','.CON.','5','','','5','cTipoRot $ "1*9*O"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','FCALCPENSAO(ACODFOL[64,1],ACODFOL[66,1],,0,DDATA_PGTO)','000002','000001','.EXE.','5','FCalcPensao(aCodFol[64,1],aCodFol[66,1],,0,dData_Pgto)','','','','','','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','SRA->RA_TPCONTR == "3"','000003','000001','.CON.','5','','','5','SRA->RA_TPCONTR == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','FCALCPENSAO(ACODFOL[65,1], ACODFOL[67,1],, 0, DDATA_PGTO, "F','000004','000003','.EXE.','5','FCalcPensao(aCodFol[65,1], aCodFol[67,1],, 0, dData_Pgto, "FER")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','FCALCPENSAO(ACODFOL[70,1], ACODFOL[71,1],, 0, DDATA_PGTO, "1','000005','000003','.EXE.','5','FCalcPensao(aCodFol[70,1], aCodFol[71,1],, 0, dData_Pgto, "13O")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','CTIPOROT $ "2*5"','000006','000000','.CON.','5','','','5','cTipoRot $ "2*5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','FCALCPENSAO("XXX",ACODFOL[9,1],,0,DDATA_PGTO)','000007','000006','.EXE.','5','FCalcPensao("XXX",aCodFol[9,1],,0,dData_Pgto)','','','','','','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','CTIPOROT == "3"','000008','000000','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','FCALCPENSAO(ACODFOL[65,1], ACODFOL[67,1],, 0, GETMEMVAR("RH_','000009','000008','.EXE.','5','FCalcPensao(aCodFol[65,1], aCodFol[67,1],, 0, GetMemVar("RH_DTRECIB"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','CTIPOROT == "4"','000010','000000','.CON.','5','','','5','cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','FCALCPENSAO(ACODFOL[64,1] , ACODFOL[66,1] , ACODFOL[56,1] ,','000011','000010','.EXE.','5','fCalcPensao(aCodfol[64,1] , aCodFol[66,1] , aCodFol[56,1] , 0 , GetMemVar("RG_DATAHOM") ," ")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','CTIPOROT == "6"','000012','000000','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPENS','FCALCPENSAO(ACODFOL[70,1], ACODFOL[71,1], , 0, DDATA_PGTO)','000013','000012','.EXE.','5','FCalcPensao(aCodFol[70,1], aCodFol[71,1], , 0, dData_Pgto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0067    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0067( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCPERI','CALCULA PERICULOSIDADE','','','037','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCPERI','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','NPERIC := 0','000002','000001','.EXE.','5','nPeric := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CBCALPER := FBUSCARG4("RCE_BCALPE",DDATAATE,.T.,.T.)','000003','000001','.EXE.','5','cBCalPer := FBUSCARG4("RCE_BCALPE",DDATAATE,.T.,.T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','SRA->RA_ADCPERI == "2" .OR. LDISSIDIO','000004','000001','.CON.','5','','','5','SRA->RA_ADCPERI == "2" .OR. LDISSIDIO','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','LTEMPERI := IF(SRA->RA_ADCPERI == "2", .T., !EMPTY(GPRETSR9(','000005','000004','.EXE.','5','lTemPeri := If(SRA->RA_ADCPERI == "2", .T., !Empty(GPRETSR9( "SRA", dDataAte, "RA_PERICUL" )))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CBCALPER  $ "1/3/4/5" .AND. LTEMPERI','000006','000004','.CON.','5','','','5','cBCalPer  $ "1/3/4/5" .and. lTemPeri','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CCODPER := CVERBAROT','000007','000006','.EXE.','5','cCodPer := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','NHRSPERI := SRA->RA_PERICUL','000008','000006','.EXE.','5','nHrsPeri := SRA->RA_PERICUL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','NPERC_PERI := RCE->RCE_PERPE','000009','000006','.EXE.','5','nPerc_Peri := RCE->RCE_PERPE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','EMPTY(CCODPER)','000010','000006','.CON.','5','','','5','Empty(cCodPer)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CTIPOROT $ "1*2*4"','000011','000010','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CCODPER := FGETCODFOL('+"'"+'0036'+"'"+')','000012','000011','.EXE.','5','cCodPer := FGETCODFOL('+"'"+'0036'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CTIPOROT == "3"','000013','000010','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CCODPER := FGETCODFOL('+"'"+'1300'+"'"+')','000014','000013','.EXE.','5','cCodPer := FGETCODFOL('+"'"+'1300'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CTIPOROT $ "5*6"','000015','000010','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CTIPOROT == "5"','000016','000015','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CCODPER := FGETCODFOL('+"'"+'1632'+"'"+')','000017','000016','.EXE.','5','cCodPer := FGETCODFOL('+"'"+'1632'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','LVB13MAT2','000018','000016','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CCODPERM := FGETCODFOL('+"'"+'1643'+"'"+')','000019','000018','.EXE.','5','cCodPerM := FGETCODFOL('+"'"+'1643'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','!LVB13MAT2','000020','000016','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CCODPERM := FGETCODFOL('+"'"+'1440'+"'"+')','000021','000020','.EXE.','5','cCodPerM := FGETCODFOL('+"'"+'1440'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CTIPOROT == "6"','000022','000015','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','cCodPer := FGETCODFOL('+"'"+'1290'+"'"+')     .END.','000023','000022','.EXE.','5','cCodPer := FGETCODFOL('+"'"+'1290'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','CCODPERM := FGETCODFOL('+"'"+'1440'+"'"+')','000024','000022','.EXE.','5','cCodPerM := FGETCODFOL('+"'"+'1440'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERI','PERICUL(ACODFOL,@NPERIC,SALMES,SALHORA,"S",.F.,@NHORAPER,CCO','000025','000006','.EXE.','5','Pericul(aCodfol,@nPeric,SalMes,SalHora,"S",.F.,@nHoraPer,cCodPer,nHrsPeri,cBCalPer,nPerc_Peri,)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0068    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0068( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCPERV','CALCULA PERICULOSIDADE SOBRE VERBAS','','','024','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCPERV','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','SRA->RA_ADCPERI == "2" .OR. LDISSIDIO','000002','000001','.CON.','5','','','5','SRA->RA_ADCPERI == "2" .OR. LDISSIDIO','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CBCALPER := FBUSCARG4("RCE_BCALPE",DDATAATE,.T.,.T.)','000003','000002','.EXE.','5','cBCalPer := FBUSCARG4("RCE_BCALPE",DDATAATE,.T.,.T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','LTEMPERI := IF(SRA->RA_ADCPERI == "2", .T., !EMPTY(GPRETSR9(','000004','000002','.EXE.','5','lTemPeri := If(SRA->RA_ADCPERI == "2", .T., !Empty(GPRETSR9( "SRA", dDataAte, "RA_PERICUL" )))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CBCALPER $ "2/6/7/8" .AND. LTEMPERI','000005','000002','.CON.','5','','','5','CBCALPER $ "2/6/7/8" .and. lTemPeri','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CCODPER := CVERBAROT','000006','000005','.EXE.','5','cCodPer := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','NHRSPERI := SRA->RA_PERICUL','000007','000005','.EXE.','5','nHrsPeri := SRA->RA_PERICUL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','NPERC_PERI := RCE->RCE_PERPE','000008','000005','.EXE.','5','nPerc_Peri := RCE->RCE_PERPE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','LPROPDIA := !(CTIPOROT $ "3*5*6")','000009','000005','.EXE.','5','lPropDia := !(cTipoRot $ "3*5*6")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','EMPTY(CCODPER)','000010','000005','.CON.','5','','','5','Empty(cCodPer)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CTIPOROT $ "1*2*4"','000011','000010','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CCODPER := FGETCODFOL('+"'"+'1281'+"'"+')','000012','000011','.EXE.','5','cCodPer := FGETCODFOL('+"'"+'1281'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CTIPOROT == "3"','000013','000010','.CON.','5','','','5','cTipoRot == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CCODPER := FGETCODFOL('+"'"+'1302'+"'"+')','000014','000013','.EXE.','5','cCodPer := FGETCODFOL('+"'"+'1302'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CTIPOROT $ "5*6"','000015','000010','.CON.','5','','','5','cTipoRot $ "5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CTIPOROT == "5"','000016','000015','.CON.','5','','','5','cTipoRot == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CCODPER := FGETCODFOL('+"'"+'1633'+"'"+')','000017','000016','.EXE.','5','cCodPer := FGETCODFOL('+"'"+'1633'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','LVB13MAT2','000018','000016','.CON.','5','','','5','lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CCODPERM := FGETCODFOL('+"'"+'1644'+"'"+')','000019','000018','.EXE.','5','cCodPerM := FGETCODFOL('+"'"+'1644'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','!LVB13MAT2','000020','000016','.CON.','5','','','5','!lVb13Mat2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CCODPERM := FGETCODFOL('+"'"+'1441'+"'"+')','000021','000020','.EXE.','5','cCodPerM := FGETCODFOL('+"'"+'1441'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CTIPOROT == "6"','000022','000015','.CON.','5','','','5','cTipoRot == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CCODPER := FGETCODFOL('+"'"+'1291'+"'"+')','000023','000022','.EXE.','5','cCodPer := FGETCODFOL('+"'"+'1291'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','CCODPERM := FGETCODFOL('+"'"+'1441'+"'"+')','000024','000022','.EXE.','5','cCodPerM := FGETCODFOL('+"'"+'1441'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPERV','PERICUL(ACODFOL,@NPERIC,SALMES,SALHORA,"S",.F.,@NHORAPER,CCO','000025','000005','.EXE.','5','Pericul(aCodfol,@nPeric,SalMes,SalHora,"S",.F.,@nHoraPer,cCodPer,nHrsPeri,cBCalPer,nPerc_Peri,)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0069    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0069( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCPLAN','CALCULA PLANO DE SAUDE','','','019','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCPLAN','AAREA := GETAREA()','000001','000000','.EXE.','5','aArea := GetArea()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','ATABS148 := {}','000002','000000','.EXE.','5','aTabS148 := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LCAMPOS := .F.','000003','000000','.EXE.','5','lCampos := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NLINHA := 0','000004','000000','.EXE.','5','nLinha := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NLINTAB := 0','000005','000000','.EXE.','5','nLinTab := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTAMSIND := TAMSX3("RA_SINDICA")[1]','000006','000000','.EXE.','5','nTamSind := TamSX3("RA_SINDICA")[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTOTSALDO := 0','000007','000000','.EXE.','5','nTotSaldo	:= 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','P_SALINC','000008','000000','.CON.','5','','','5','P_SALINC','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FSALINC(@NSALARIO,@NSALMES,@SALHORA,@SALDIA)','000009','000008','.EXE.','5','fSalInc(@nSalario,@nSalMes,@SalHora,@SalDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','!P_SALINC','000010','000000','.CON.','5','','','5','!P_SALINC','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FSALARIO(@NSALARIO,@SALHORA,@SALDIA,@NSALMES,"A")','000011','000010','.EXE.','5','fSalario(@nSalario,@SalHora,@SalDia,@nSalMes,"A")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','DBSELECTAREA("RCE")','000012','000000','.EXE.','5','dbSelectArea("RCE")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','DBSELECTAREA("RHO")','000013','000000','.EXE.','5','dbSelectArea("RHO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LGERA := .T.','000014','000000','.EXE.','5','lGera := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LPERORI := RHO->( COLUMNPOS( "RHO_PERORI" ) ) > 0','000015','000000','.EXE.','5','lPerOri := RHO->( ColumnPos( "RHO_PERORI" ) ) > 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LSALDO := RHO->( COLUMNPOS( "RHO_SALDO" ) ) > 0','000016','000000','.EXE.','5','lSaldo := RHO->( ColumnPos( "RHO_SALDO" ) ) > 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LTETCOP := RCE->( COLUMNPOS( "RCE_TETCOP" ) ) > 0','000017','000000','.EXE.','5','lTetCop := RCE->( ColumnPos( "RCE_TETCOP" ) ) > 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LCAMPOS := (LPERORI .AND. LSALDO .AND. LTETCOP)','000018','000000','.EXE.','5','lCampos := (lPerOri .And. lSaldo .And. lTetCop)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTETCOP := IIF( LCAMPOS, FDESC("RCE", SRA->RA_SINDICA, "RCE_','000019','000000','.EXE.','5','nTetCop := Iif( lCampos, fDesc("RCE", SRA->RA_SINDICA, "RCE_TETCOP", Nil, SRA->RA_FILIAL), 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LTEMTET := (LCAMPOS .AND. NTETCOP > 0)','000020','000000','.EXE.','5','lTemTet := (lCampos .And. nTetCop > 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LCAMPOS .AND. NTETCOP == 0','000021','000000','.CON.','5','','','5','lCampos .And. nTetCop == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->( DBSEEK( SRA->RA_FILIAL + SRA->RA_MAT ) )','000022','000021','.CON.','5','','','5','RHO->( DbSeek( SRA->RA_FILIAL + SRA->RA_MAT ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->( !EOF() ) .AND. RHO->RHO_FILIAL + RHO->RHO_MAT == SRA-','000023','000022','.ENQ.','5','','','5','RHO->( !Eof() ) .And. RHO->RHO_FILIAL + RHO->RHO_MAT == SRA->RA_FILIAL + SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->RHO_COMPPG == CANOMES .OR. (LPERORI .AND. RHO->RHO_PERO','000024','000023','.CON.','5','','','5','RHO->RHO_COMPPG == cAnoMes .Or. (lPerOri .And. RHO->RHO_PERORI == "2")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->RHO_TPLAN == "1" .AND. LCAMPOS .AND. !EMPTY(RHO->RHO_SA','000025','000024','.CON.','5','','','5','RHO->RHO_TPLAN == "1" .And. lCampos .And. !Empty(RHO->RHO_SALDO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTOTSALDO += RHO->RHO_SALDO','000026','000025','.EXE.','5','nTotSaldo += RHO->RHO_SALDO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->( DBSKIP() )','000027','000023','.EXE.','5','RHO->( DbSkip() )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTOTSALDO > 0','000028','000000','.CON.','5','','','5','nTotSaldo > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NLINHA := FPOSTAB( "S148", SRA->RA_SINDICA, "=", 4, NTOTSALD','000029','000028','.EXE.','5','nLinha := fPosTab( "S148", SRA->RA_SINDICA, "=", 4, nTotSaldo, "<=", 5, Nil, Nil, @nLinTab, .T., SRA->RA_FILIAL, Nil, Nil, Nil, Nil, {1, 2, 3, 4, 5} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NLINHA == 0','000030','000028','.CON.','5','','','5','nLinha == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NLINHA := FPOSTAB( "S148", SPACE(NTAMSIND), "=", 4, NTOTSALD','000031','000030','.EXE.','5','nLinha := fPosTab( "S148", Space(nTamSind), "=", 4, nTotSaldo, "<=", 5, Nil, Nil, @nLinTab, .T., SRA->RA_FILIAL, Nil, Nil, Nil, Nil, {1, 2, 3, 4, 5} )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NLINHA > 0','000032','000028','.CON.','5','','','5','nLinha > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTETCOP := FTABELA("S148", NLINHA, 6, NIL, SRA->RA_FILIAL)','000033','000032','.EXE.','5','nTetCop := fTabela("S148", nLinha, 6, Nil, SRA->RA_FILIAL)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LTEMTET := (LCAMPOS .AND. NTETCOP > 0)','000034','000032','.EXE.','5','lTemTet := (lCampos .And. nTetCop > 0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTOTDESC := 0','000035','000000','.EXE.','5','nTotDesc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHK->(DBGOTOP())','000036','000000','.EXE.','5','RHK->(dbGoTop())','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHK->(DbSeek( SRA->RA_FILIAL + SRA->RA_MAT, .F. ))     .CNT.','000037','000000','.EXE.','5','RHK->(DbSeek( SRA->RA_FILIAL + SRA->RA_MAT, .F. ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CCODFORANT := ""','000038','000000','.EXE.','5','cCodForAnt',':=','5','""','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CTPFORNANT := ""','000039','000000','.EXE.','5','cTpFornAnt',':=','5','""','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CTPPLANO := ""','000040','000000','.EXE.','5','cTpPlano',':=','5','""','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CCODPLANO := ""','000041','000000','.EXE.','5','cCodPlano',':=','5','""','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','ALOG := {}','000042','000000','.EXE.','5','ALOG',':=','5','{}','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','APLANDEP := {}','000043','000000','.EXE.','5','APLANDEP',':=','5','{}','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NCNT := 0','000044','000000','.EXE.','5','nCnt',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LAUX1 := .F.','000045','000000','.EXE.','5','lAux1',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LAUX2:= .F.','000046','000000','.EXE.','5','lAux2',':=','5','.F.','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG, {} )','000047','000000','.EXE.','5','Aadd( aLog, {} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG, {} )','000048','000000','.EXE.','5','Aadd( aLog, {} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG, {} )','000049','000000','.EXE.','5','Aadd( aLog, {} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG, {} )','000050','000000','.EXE.','5','Aadd( aLog, {} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG, {} )','000051','000000','.EXE.','5','Aadd( aLog, {} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG, {} )','000052','000000','.EXE.','5','Aadd( aLog, {} )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AOFUSCA := {}','000053','000000','.EXE.','5','AOFUSCA := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AOFUSCA := IF(FINDFUNCTION('+"'"+'CHKOFUSCA'+"'"+'), CHKOFUSCA(), {.T. ,','000054','000000','.EXE.','5','aOfusca	:= If(FindFunction('+"'"+'ChkOfusca'+"'"+'), ChkOfusca(), {.T. , .F.})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LOFUSCANOM := .F.','000055','000000','.EXE.','5','lOfuscaNom	:= .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AOFUSCA[2]','000056','000000','.CON.','5','','','5','aOfusca[2]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AFLDOFUSCA := CHKUSERACESS(.T.,{"RA_NOME"})','000057','000056','.EXE.','5','AFLDOFUSCA := CHKUSERACESS(.T.,{"RA_NOME"})','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LOFUSCANOM := CHKFIELD(AFLDOFUSCA, {"RA_NOME"})','000058','000056','.EXE.','5','LOFUSCANOM := CHKFIELD(AFLDOFUSCA, {"RA_NOME"})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHK->( !Eof() ) .and. RHK->RHK_FILIAL + RHK->RHK_MAT == SR','000059','000000','.ENQ.','5','','','5','RHK->( !Eof() ) .and. RHK->RHK_FILIAL + RHK->RHK_MAT == SRA->RA_FILIAL + SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','cAnoMesInT := Substr(RHK->RHK_PERINI,3,4) + Substr(RHK->RHK','000060','000059','.EXE.','5','cAnoMesInT',':=','5','Substr(RHK->RHK_PERINI,3,4) + Substr(RHK->RHK_PERINI,1,2)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','cAnoMesFiT := Substr(RHK->RHK_PERFIM,3,4) + Substr(RHK->RHK_','000061','000059','.EXE.','5','cAnoMesFiT',':=','5','Substr(RHK->RHK_PERFIM,3,4) + Substr(RHK->RHK_PERFIM,1,2)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHK->RHK_TPFORN == cTpFornAnt .and. RHK->RHK_CODFOR == cCo','000062','000059','.CON.','5','','','5','RHK->RHK_TPFORN == cTpFornAnt .and. RHK->RHK_CODFOR == cCodForAnt .and. RHK->RHK_TPPLAN == cTpPlano .AND. RHK->RHK_PLANO == cCodPlano','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','Len( aLog[3] ) == 0 .or. Ascan( aLog[3], { |x| x == Substr','000063','000062','.CON.','5','','','5','Len( aLog[3] ) == 0 .or. Ascan( aLog[3], { |x| x == Substr( SRA->RA_FILIAL + "  " + SRA->RA_MAT + " - " + SRA->RA_NOME, 1, 45 ) } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG[3], SUBSTR( SRA->RA_FILIAL + "  " + SRA->RA_MAT +','000064','000063','.EXE.','5','aAdd( aLog[3], Substr( SRA->RA_FILIAL + "  " + SRA->RA_MAT + " - " + If(lOfuscaNom, Replicate('+"'"+'*'+"'"+',15),SRA->RA_NOME), 1, 45 ) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','!(RHK->RHK_TPFORN==cTpFornAnt .and. RHK->RHK_CODFOR==cCodF','000065','000059','.CON.','5','','','5','!(RHK->RHK_TPFORN==cTpFornAnt .and. RHK->RHK_CODFOR==cCodForAnt .and. RHK->RHK_TPPLAN==cTpPlano .AND. RHK->RHK_PLANO==cCodPlano                                                                                                                     )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CCODFORANT := RHK->RHK_CODFOR','000066','000065','.EXE.','5','cCodForAnt',':=','5','RHK->RHK_CODFOR','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CTPFORNANT	:= RHK->RHK_TPFORN','000067','000065','.EXE.','5','cTpFornAnt',':=','5','RHK->RHK_TPFORN','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CTPPLANO 	:= RHK->RHK_TPPLAN','000068','000065','.EXE.','5','cTpPlano',':=','5','RHK->RHK_TPPLAN','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CCODPLANO	:= RHK->RHK_PLANO','000069','000065','.EXE.','5','cCodPlano',':=','5','RHK->RHK_PLANO','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','(( cAnoMesInT > cAnoMes ) .or. ( cAnoMesInT <= cAnoMes .an','000070','000059','.CON.','5','','','5','(( cAnoMesInT > cAnoMes ) .or. ( cAnoMesInT <= cAnoMes .and. ! Empty( cAnoMesFiT ) .and. cAnoMesFiT < cAnoMes ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHK->(DBSKIP())','000071','000070','.EXE.','5','RHK->(DBSKIP())','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RETORNEENQ()','000072','000070','.EXE.','5','RETORNEENQ()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNC := 0','000073','000059','.EXE.','5','nVlrFunc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPR := 0','000074','000059','.EXE.','5','nVlrEmpr := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNDIF := 0','000075','000059','.EXE.','5','NVLRFUNDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPDIF := 0','000076','000059','.EXE.','5','NVLREMPDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRDIF := 0','000077','000059','.EXE.','5','NVLRDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','DDTFINAL := IF(RHK->(COLUMNPOS("RHK_DATFIM")) > 0, RHK->RHK_','000078','000059','.EXE.','5','DDTFINAL := IF(RHK->(COLUMNPOS("RHK_DATFIM")) > 0, RHK->RHK_DATFIM, CTOD("//"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FCALCPLANO(1, RHK->RHK_TPFORN, RHK->RHK_CODFOR, RHK->RHK_TPP','000079','000059','.CON.','5','','','5','fCalcPlano(1, RHK->RHK_TPFORN, RHK->RHK_CODFOR, RHK->RHK_TPPLAN, RHK->RHK_PLANO, dDataRef, SRA->RA_NASC, @nVlrFunc, @nVlrEmpr, SRA->RA_FILIAL )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','fGravaCalc("1", Space(GetSx3Cache("RHR_CODIGO", "X3_TAMANHO"','000080','000079','.EXE.','5','fGravaCalc("1", Space(GetSx3Cache("RHR_CODIGO", "X3_TAMANHO")), "1", RHK->RHK_TPFORN, RHK->RHK_CODFOR, RHK->RHK_TPPLAN, RHK->RHK_PLANO, RHK->RHK_PD, nVlrFunc, nVlrEmpr )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','!EMPTY(DDTFINAL) .AND. CANOMES == ANOMES(DDTFINAL)','000081','000079','.CON.','5','','','5','!EMPTY(DDTFINAL) .AND. CANOMES == ANOMES(DDTFINAL)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNDIF := ROUND( (NVLRFUNC / DAY(LASTDAY(DDTFINAL))) * D','000082','000081','.EXE.','5','nVlrFunDif := Round( (nVlrFunc / Day(LastDay(dDtFinal))) * DateDiffDay(dDtFinal, LastDay(dDtFinal)),2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRDIF := ((NVLRFUNC + NVLREMPR) / DAY(LASTDAY(DDTFINAL)))','000083','000081','.EXE.','5','NVLRDIF := ((NVLRFUNC + NVLREMPR) / Day(LastDay(dDtFinal))) * DateDiffDay(dDtFinal, LastDay(dDtFinal))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPDIF := NVLRDIF - NVLRFUNDIF','000084','000081','.EXE.','5','nVlrEmpDif := nVlrDif - nVlrFunDif','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FGRAVACALC("1", SPACE(GETSX3CACHE("RHR_CODIGO", "X3_TAMANHO"','000085','000081','.EXE.','5','fGravaCalc("1", Space(GetSx3Cache("RHR_CODIGO", "X3_TAMANHO")), "1", RHK->RHK_TPFORN, RHK->RHK_CODFOR, RHK->RHK_TPPLAN, RHK->RHK_PLANO, RHK->RHK_PDDIFT, nVlrFunDif, nVlrEmpDif )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CPDDAGR := RHK->RHK_PDDAGR','000086','000059','.EXE.','5','cPDDAgr',':=','5','RHK->RHK_PDDAGR','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','CPDDIFD := IF(RHK->(COLUMNPOS("RHK_PDDIFD")) > 0, RHK->RHK_P','000087','000059','.EXE.','5','cPdDifD := IF(RHK->(COLUMNPOS("RHK_PDDIFD")) > 0, RHK->RHK_PDDIFD, "")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','SRB->(DBSETORDER( RETORDEM( "SRB", "RB_FILIAL+RB_MAT" ) ))','000088','000059','.EXE.','5','SRB->(DBSETORDER( RETORDEM( "SRB", "RB_FILIAL+RB_MAT" ) ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','SRB->(DBSEEK( SRA->RA_FILIAL + SRA->RA_MAT, .F. )	)','000089','000059','.CON.','5','','','5','SRB->(DbSeek( SRA->RA_FILIAL + SRA->RA_MAT, .F. )	)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','SRB->( !EOF() ) .AND. SRB->RB_FILIAL + SRB->RB_MAT  == SRA->','000090','000089','.ENQ.','5','','','5','SRB->( !Eof() ) .and. SRB->RB_FILIAL + SRB->RB_MAT  == SRA->RA_FILIAL + SRA->RA_MAT','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LRBPLSAUDE :=  SRB->RB_PLSAUDE == "1"','000091','000090','.EXE.','5','lRbPlSaude',':=','5','SRB->RB_PLSAUDE == "1" .and. RHK->RHK_TPFORN == "1"','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','APLANDEP:=FBUSPLDEP(SRA->RA_MAT,RHK->RHK_TPFORN,RHK->RHK_COD','000092','000090','.EXE.','5','APLANDEP:=FBUSPLDEP(SRA->RA_MAT,RHK->RHK_TPFORN,RHK->RHK_CODFOR,SRB->RB_COD,CCODPLANO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LEN(APLANDEP) > 0','000093','000090','.CON.','5','','','5','Len(aPlanDep) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NCNT := 1','000094','000093','.EXE.','5','nCnt',':=','5','1','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NCNT <= LEN(APLANDEP)','000095','000093','.ENQ.','5','','','5','nCnt <= Len(aPlanDep)','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LAUX1:=(CANOMES >= SUBSTR(APLANDEP[NCNT,7],3,4)+SUBSTR(APLAN','000096','000095','.EXE.','5','LAUX1',':=','5','(CANOMES >= SUBSTR(APLANDEP[nCnt,7],3,4)+SUBSTR(APLANDEP[nCnt,7],1,2)) .AND. EMPTY( APLANDEP[nCnt,8])','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LAUX2:=(CANOMES >= SUBSTR(APLANDEP[NCNT,7],3,4)+SUBSTR(APLAN','000097','000095','.EXE.','5','LAUX2',':=','5','(CANOMES >= SUBSTR(APLANDEP[nCnt,7],3,4)+SUBSTR(APLANDEP[nCnt,7],1,2)) .AND. (CANOMES <=  SUBSTR(APLANDEP[nCnt,8],3,4)+SUBSTR(APLANDEP[nCnt,8],1,2))','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','lAux1 .OR. lAux2   .END.','000098','000095','.CON.','5','','','5','lAux1 .OR. lAux2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNC := 0','000099','000098','.EXE.','5','nVlrFunc',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPR := 0','000100','000098','.EXE.','5','nVlrEmpr',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNDIF := 0','000101','000098','.EXE.','5','NVLRFUNDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPDIF := 0','000102','000098','.EXE.','5','NVLREMPDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRDIF := 0','000103','000098','.EXE.','5','NVLRDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','DDTFINAL := IF(RHL->(COLUMNPOS("RHL_DATFIM")) > 0, APLANDEP[','000104','000098','.EXE.','5','DDTFINAL := IF(RHL->(COLUMNPOS("RHL_DATFIM")) > 0, APLANDEP[nCnt,9] , CTOD("//"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LRET := FCALCPLANO(2, APLANDEP[NCNT][1], APLANDEP[NCNT][2],','000105','000098','.EXE.','5','LRET',':=','5','FCALCPLANO(2, aPlanDep[nCnt][1], aPlanDep[nCnt][2], aPlanDep[nCnt][5], aPlanDep[nCnt][6], DDATAREF, SRB->RB_DTNASC, @NVLRFUNC, @NVLREMPR, SRA->RA_FILIAL)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LRET .AND. ROUND(NVLRFUNC,2) > 0 .OR. ROUND(NVLREMPR,2) > 0','000106','000098','.CON.','5','','','5','LRET .AND. ROUND(NVLRFUNC,2) > 0 .OR. ROUND(NVLREMPR,2) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FGRAVACALC("2", APLANDEP[NCNT][3], "1", APLANDEP[NCNT][1], A','000107','000106','.EXE.','5','FGRAVACALC("2", aPlanDep[nCnt][3], "1", aPlanDep[nCnt][1], aPlanDep[nCnt][2], aPlanDep[nCnt][5], aPlanDep[nCnt][6], CPDDAGR, NVLRFUNC, NVLREMPR )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','!EMPTY(DDTFINAL) .AND. CANOMES == ANOMES(DDTFINAL)','000108','000106','.CON.','5','','','5','!EMPTY(DDTFINAL) .AND. CANOMES == ANOMES(DDTFINAL)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNDIF := ROUND( (NVLRFUNC / DAY(LASTDAY(DDTFINAL))) * D','000109','000108','.EXE.','5','nVlrFunDif := Round( (nVlrFunc / Day(LastDay(dDtFinal))) * DateDiffDay(dDtFinal, LastDay(dDtFinal)),2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRDIF := ((NVLRFUNC + NVLREMPR) / DAY(LASTDAY(DDTFINAL)))','000110','000108','.EXE.','5','NVLRDIF := ((NVLRFUNC + NVLREMPR) / Day(LastDay(dDtFinal))) * DateDiffDay(dDtFinal, LastDay(dDtFinal))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPDIF := NVLRDIF - NVLRFUNDIF','000111','000108','.EXE.','5','nVlrEmpDif := nVlrDif - nVlrFunDif','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FGRAVACALC("2", APLANDEP[NCNT][3], "1", APLANDEP[NCNT][1], A','000112','000108','.EXE.','5','FGRAVACALC("2", aPlanDep[nCnt][3], "1", aPlanDep[nCnt][1], aPlanDep[nCnt][2], aPlanDep[nCnt][5], aPlanDep[nCnt][6], cPdDifD, nVlrFunDif, nVlrEmpDif )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LRET .AND. ROUND(NVLRFUNC,2) <= 0 .AND. ROUND(NVLREMPR,2) <=','000113','000098','.CON.','5','','','5','LRET .AND. ROUND(NVLRFUNC,2) <= 0 .AND. ROUND(NVLREMPR,2) <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG[2], SUBSTR(SRA->RA_FILIAL + "  " + SRA->RA_MAT +','000114','000113','.EXE.','5','AADD( ALOG[2], SUBSTR(SRA->RA_FILIAL + "  " + SRA->RA_MAT + "-" + SRA->RA_NOME,1,45) + " -  CÓDIGO  - " + aPlanDep[nCnt][3] )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NCNT++','000115','000095','.EXE.','5','nCnt',':=','5','nCnt + 1','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LEN(APLANDEP) == 0 .AND.  LRBPLSAUDE','000116','000090','.CON.','5','','','5','Len(aPlanDep) == 0 .and. LRBPLSAUDE','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','AADD( ALOG[2], SUBSTR(SRA->RA_FILIAL + "  " + SRA->RA_MAT +','000117','000116','.EXE.','5','AADD( ALOG[2], SUBSTR(SRA->RA_FILIAL + "  " + SRA->RA_MAT + "-" + If(lOfuscaNom, Replicate('+"'"+'*'+"'"+',15),SRA->RA_NOME),1,45) + " - CADASTRO DE DEPENDENTES COM INFORMAÇÃO DE QUE POSSUI PLANO DE SAÚDE, PORÉM NÃO EXISTE PLANO ATIVO." )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','APLANDEP := {}','000118','000090','.EXE.','5','APLANDEP',':=','5','{}','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','SRB->(DBSKIP())','000119','000090','.EXE.','5','SRB->(DBSKIP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHM->(DBSETORDER( RETORDEM( "RHM", "RHM_FILIAL+RHM_MAT+RHM_T','000120','000059','.EXE.','5','RHM->(DbSetorder( RetOrdem( "RHM", "RHM_FILIAL+RHM_MAT+RHM_TPFORN+RHM_CODFOR+RHM_CODIGO" ) ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHM->(DbSeek( SRA->RA_FILIAL + SRA->RA_MAT + RHK->RHK_TPFO','000121','000059','.CON.','5','','','5','RHM->(DbSeek( SRA->RA_FILIAL + SRA->RA_MAT + RHK->RHK_TPFORN + RHK->RHK_CODFOR, .F. ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHM->( !Eof() ) .and. RHM->RHM_FILIAL + RHM->RHM_MAT + RHM','000122','000121','.ENQ.','5','','','5','RHM->( !Eof() ) .and. RHM->RHM_FILIAL + RHM->RHM_MAT + RHM->RHM_TPFORN + RHM->RHM_CODFOR == SRA->RA_FILIAL + SRA->RA_MAT + RHK->RHK_TPFORN + RHK->RHK_CODFOR','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','((cAnoMes >= Substr(RHM->RHM_PERINI,3,4)+Substr(RHM->RHM_P','000123','000122','.CON.','5','','','5','((cAnoMes >= Substr(RHM->RHM_PERINI,3,4)+Substr(RHM->RHM_PERINI,1,2)) .and. Empty( RHM->RHM_PERFIM) .or. (cAnoMes >= Substr(RHM->RHM_PERINI,3,4)+Substr(RHM->RHM_PERINI,1,2)) .and. (cAnoMes <=  Substr(RHM->RHM_PERFIM,3,4)+Substr(RHM->RHM_PERFIM,1,2)))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNC := 0','000124','000123','.EXE.','5','nVlrFunc',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPR := 0','000125','000123','.EXE.','5','nVlrEmpr',':=','5','0','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNDIF := 0','000126','000123','.EXE.','5','NVLRFUNDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPDIF := 0','000127','000123','.EXE.','5','NVLREMPDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRDIF := 0','000128','000123','.EXE.','5','NVLRDIF := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','DDTFINAL := IF(RHM->(COLUMNPOS("RHM_DATFIM")) > 0, RHM->RHM_','000129','000123','.EXE.','5','DDTFINAL := IF(RHM->(COLUMNPOS("RHM_DATFIM")) > 0, RHM->RHM_DATFIM, CTOD("//"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','lRet := fCalcPlano(3, RHM->RHM_TPFORN, RHM->RHM_CODFOR, RHM','000130','000123','.EXE.','5','lRet',':=','5','fCalcPlano(3, RHM->RHM_TPFORN, RHM->RHM_CODFOR, RHM->RHM_TPPLAN, RHM->RHM_PLANO, dDataRef, RHM->RHM_DTNASC, @nVlrFunc, @nVlrEmpr, SRA->RA_FILIAL  )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','lRet .and. Round(nVlrFunc,2) > 0 .or. Round(nVlrEmpr,2) >','000131','000123','.CON.','5','','','5','lRet .and. Round(nVlrFunc,2) > 0 .or. Round(nVlrEmpr,2) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','fGravaCalc("3", RHM->RHM_CODIGO, "1", RHM->RHM_TPFORN, RHM->','000132','000131','.EXE.','5','fGravaCalc("3", RHM->RHM_CODIGO, "1", RHM->RHM_TPFORN, RHM->RHM_CODFOR, RHM->RHM_TPPLAN, RHM->RHM_PLANO, cPDDAgr, nVlrFunc, nVlrEmpr )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','!EMPTY(DDTFINAL) .AND. CANOMES == ANOMES(DDTFINAL)','000133','000131','.CON.','5','','','5','!EMPTY(DDTFINAL) .AND. CANOMES == ANOMES(DDTFINAL)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNDIF := ROUND( (NVLRFUNC / DAY(LASTDAY(DDTFINAL))) * D','000134','000133','.EXE.','5','nVlrFunDif := Round( (nVlrFunc / Day(LastDay(dDtFinal))) * DateDiffDay(dDtFinal, LastDay(dDtFinal)),2 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRDIF := ((NVLRFUNC + NVLREMPR) / DAY(LASTDAY(DDTFINAL)))','000135','000133','.EXE.','5','NVLRDIF := ((NVLRFUNC + NVLREMPR) / Day(LastDay(dDtFinal))) * DateDiffDay(dDtFinal, LastDay(dDtFinal))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLREMPDIF := NVLRDIF - NVLRFUNDIF','000136','000133','.EXE.','5','nVlrEmpDif := nVlrDif - nVlrFunDif','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FGRAVACALC("3", RHM->RHM_CODIGO, "1", RHM->RHM_TPFORN, RHM->','000137','000133','.EXE.','5','fGravaCalc("3", RHM->RHM_CODIGO, "1", RHM->RHM_TPFORN, RHM->RHM_CODFOR, RHM->RHM_TPPLAN, RHM->RHM_PLANO, cPdDifD, nVlrFunDif, nVlrEmpDif )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','lRet .and. Round(nVlrFunc,2) <= 0 .and. Round(nVlrEmpr,2)','000138','000123','.CON.','5','','','5','lRet .and. Round(nVlrFunc,2) <= 0 .and. Round(nVlrEmpr,2) <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','aAdd( aLog[2], Substr(SRA->RA_FILIAL + "  " + SRA->RA_MAT +','000139','000138','.EXE.','5','aAdd( aLog[2], Substr(SRA->RA_FILIAL + "  " + SRA->RA_MAT + "-" + If(lOfuscaNom, Replicate('+"'"+'*'+"'"+',15),SRA->RA_NOME),1,45) + " - Código - " + RHM->RHM_CODIGO )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHM->(DBSKIP())','000140','000122','.EXE.','5','RHM->(DbSkip())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHK->(DBSKIP())','000141','000059','.EXE.','5','RHK->(dbSkip())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->(DbSetorder( RetOrdem( "RHO", "RHO_FILIAL+RHO_MAT+RHO_C','000142','000000','.EXE.','5','RHO->(DbSetorder( RetOrdem( "RHO", "RHO_FILIAL+RHO_MAT+RHO_COMPPG" ) ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->(DBSEEK( SRA->RA_FILIAL + SRA->RA_MAT, .F. ))','000143','000000','.CON.','5','','','5','RHO->(DbSeek( SRA->RA_FILIAL + SRA->RA_MAT, .F. ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->( !EOF() ) .AND. RHO->( RHO_FILIAL + RHO_MAT ) == SRA->','000144','000143','.ENQ.','5','','','5','RHO->( !Eof() ) .And. RHO->( RHO_FILIAL + RHO_MAT ) == SRA->( RA_FILIAL + RA_MAT )','','5','','.END.','PMSTASK3','PMSTASK3',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->RHO_COMPPG == CANOMES .OR. (LPERORI .AND. RHO->RHO_PERO','000145','000144','.CON.','5','','','5','RHO->RHO_COMPPG == cAnoMes .Or. (lPerOri .And. RHO->RHO_PERORI == "2")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNC := RHO->RHO_VLRFUN','000146','000145','.EXE.','5','nVlrFunc := RHO->RHO_VLRFUN','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->RHO_TPLAN == "1" .AND. LTEMTET .AND. NTETCOP > 0','000147','000145','.CON.','5','','','5','RHO->RHO_TPLAN == "1" .And. lTemTet .And. nTetCop > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','EMPTY(RHO->RHO_SALDO)','000148','000147','.CON.','5','','','5','Empty(RHO->RHO_SALDO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FATURHOTET()','000149','000148','.EXE.','5','fAtuRHOTet()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNC := RHO->RHO_SALDO','000150','000147','.EXE.','5','nVlrFunc := RHO->RHO_SALDO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTOTDESC >= NTETCOP','000151','000147','.CON.','5','','','5','nTotDesc >= nTetCop','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LGERA := .F.','000152','000151','.EXE.','5','lGera := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LGERA .AND. NTOTDESC + RHO->RHO_SALDO > NTETCOP','000153','000147','.CON.','5','','','5','lGera .And. nTotDesc + RHO->RHO_SALDO > nTetCop','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NVLRFUNC := MIN( NTETCOP - NTOTDESC, RHO->RHO_SALDO )','000154','000153','.EXE.','5','nVlrFunc := Min( nTetCop - nTotDesc, RHO->RHO_SALDO )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','NTOTDESC += NVLRFUNC','000155','000147','.EXE.','5','nTotDesc += nVlrFunc','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','cTpLan := If( RHO->RHO_TPLAN == "1", "2", "3")   .CNT.','000156','000145','.EXE.','5','cTpLan',':=','5','If( RHO->RHO_TPLAN == "1", "2", "3")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LGERA .OR. RHO->RHO_TPLAN == "2"','000157','000145','.CON.','5','','','5','lGera .Or. RHO->RHO_TPLAN == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','fGravaCalc(RHO->RHO_ORIGEM, RHO->RHO_CODIGO, cTpLan, RHO->RH','000158','000157','.EXE.','5','fGravaCalc(RHO->RHO_ORIGEM, RHO->RHO_CODIGO, cTpLan, RHO->RHO_TPFORN, RHO->RHO_CODFOR, Space(GetSx3Cache("RHK_TPPLAN", "X3_TAMANHO")), Space(GetSx3Cache("RHK_PLANO", "X3_TAMANHO")), RHO->RHO_PD, nVlrFunc, RHO->RHO_VLREMP, .T. )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','LPLANOATIV == .F. .END.','000159','000157','.CON.','5','','','5','LPLANOATIV','==','5','.F.','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','Len( aLog[6] ) == 0 .OR. Ascan( aLog[6], { |x| x == Substr','000160','000159','.CON.','5','','','5','Len( aLog[6] ) == 0 .OR. Ascan( aLog[6], { |x| x == Substr( SRA->RA_FILIAL + "  " + SRA->RA_MAT + " - " + SRA->RA_NOME, 1, 45 ) } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','aAdd( aLog[6], 	Substr( SRA->RA_FILIAL + "  " + SRA->RA_MAT','000161','000160','.EXE.','5','aAdd( aLog[6], Substr( SRA->RA_FILIAL+ "  " + SRA->RA_MAT + " - " + If(lOfuscaNom, Replicate('+"'"+'*'+"'"+',15),SRA->RA_NOME),1,45) + "Fornecedor: "+ RHO->RHO_CODFOR +" Data de Ocorrencia: "+ DTOC(RHO->RHO_DTOCOR)+" Observação: " + Substr(RHO->RHO_OBSERV,1,45))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RHO->(DbSkip())     .END.','000162','000144','.EXE.','5','RHO->(DbSkip())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','FLOGPLS(ALOG)','000163','000000','.EXE.','5','fLogPLS(aLog)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLAN','RESTAREA( AAREA )','000164','000000','.EXE.','5','RestArea( aArea )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0070    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0070( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCPLR','CALCULO DA PLR','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCPLR','NVALPLR := MAX( ( NSALANT / 12 ) * NAVOSTOT , 0 )','000001','000000','.EXE.','5','nValPLR := Max( ( nSalAnt / 12 ) * nAvosTot , 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','VALPLRANT := 0     .CNT.','000002','000000','.EXE.','5','VALPLRANT := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','EMPTY(APDACUM)   .END.','000003','000000','.CON.','5','','','5','EMPTY(APDACUM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','APDACUM := {}     .END.','000004','000003','.EXE.','5','APDACUM := {}','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','!EMPTY(ASIND[1,5]) .AND. ASIND[1,5] > NVALPLR .AND. NVALPLR','000005','000000','.CON.','5','','','5','!Empty(aSind[1,5]) .and. aSind[1,5] > nValPLR .and. nValPLR > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','NVALPLR := ASIND[1,5]','000006','000005','.EXE.','5','nValPLR := aSind[1,5]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','!EMPTY(ASIND[1,6]) .AND. ASIND[1,6] < NVALPLR','000007','000000','.CON.','5','','','5','!Empty(aSind[1,6]) .and. aSind[1,6] < nValPLR','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','NVALPLR := ASIND[1,6]','000008','000007','.EXE.','5','nValPLR := aSind[1,6]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','ASIND[1,11] == "2"','000009','000000','.CON.','5','','','5','aSind[1,11] == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','NPERCPLR := ASIND[1,12]','000010','000009','.EXE.','5','nPercPLR := aSind[1,12]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','FCHKPLRANT(@VALPLRANT, APDACUM)     .CNT.','000011','000009','.EXE.','5','FCHKPLRANT(@VALPLRANT, APDACUM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','VALPLRANT <= 0','000012','000009','.CON.','5','','','5','VALPLRANT <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','NVALPLR := NVALPLR * ( NPERCPLR / 100 )','000013','000012','.EXE.','5','NVALPLR := NVALPLR * ( NPERCPLR / 100 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCPLR','NAVOSTOT := NAVOSTOT * (NPERCPLR / 100)','000014','000012','.EXE.','5','nAvosTot := nAvosTot * (nPercPLR / 100)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0071    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0071( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCPROP','Adm. ou Propor.','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCPROP','CADTOPRO = "S" .AND. SRA->RA_SITFOLH # "D" .AND. MESANO(SRA-','000001','000000','.CON.','','','','5','cAdtoPro = "S" .And. SRA->RA_SITFOLH # "D" .And. MesAno(SRA->RA_ADMISSA) <= MesAno( IF(EMPTY(APERIODO),DDATABASE,APERIODO[1,4]) )','','','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCPROP','CALCULE := "S"','000002','000001','.EXE.','6','Calcule := "S"','','','','','','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0072    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0072( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCQUA','CALCULO QUADRIENIO','','','014','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCQUA','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','CCODADT := CVERBAROT','000002','000001','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','!( "N" $ CTIPOATS ) .AND. "D" $ CTIPOATS .AND. ( EMPTY(RCE','000003','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "D" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFQR) .OR. RCE->RCE_DTFQR > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','CADTPOSER := "D"','000004','000003','.EXE.','5','cAdtPoSer := "D"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','EMPTY(CCODADT)','000005','000003','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','CTIPOROT $ "1*2*4"','000006','000005','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','CCODADT := FGETCODFOL('+"'"+'0004'+"'"+')','000007','000006','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'0004'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','CTPCAATS == "1" .OR. CTPCAATS == "2"','000008','000003','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','CBCALATS <> "2"','000009','000008','.CON.','5','','','5','cBCalATS <> "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000010','000009','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','CTPCAATS == "3"','000011','000003','.CON.','5','','','5','cTpCaAts == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUA','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000012','000011','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0073    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0073( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCQUAV','CALCULO QUADRIENIO SOBRE VERBAS','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCQUAV','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','!( "N" $ cTipoAts ) .and. "D" $ cTipoAts .AND. ( EMPTY(RCE','000002','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "D" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFQR) .OR. RCE->RCE_DTFQR > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','cAdtPoSer := "D"     .CNT.','000003','000002','.EXE.','5','cAdtPoSer := "D"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','!( CTIPOROT $ "3*5*6" )','000004','000002','.CON.','5','','','5','!( cTipoRot $ "3*5*6" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','lPropDia := .T.     .END.','000005','000004','.EXE.','5','lPropDia := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','cTpCaAts == "1" .OR. cTpCaAts == "2"   .END.','000006','000002','.CON.','5','','','5','cTpCaAts == "1" .OR. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','cBCalATS == "2"   .END.','000007','000006','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','cCodAdt := cVerbaRot     .CNT.','000008','000007','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','Empty(cCodAdt)   .END.','000009','000007','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','CTIPOROT $ "1*2*4"','000010','000009','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','CCODADT := FGETCODFOL('+"'"+'1286'+"'"+')','000011','000010','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1286'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, c','000012','000007','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")','000013','000006','.CON.','5','','','5','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")) > 0 .AND. SRA->RA_HOJORVA = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','CBCALATS == "1"   .END.','000014','000013','.CON.','5','','','5','CBCALATS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','CCODADT := FGETCODFOL('+"'"+'0004'+"'"+')     .CNT.','000015','000014','.EXE.','5','CCODADT := FGETCODFOL('+"'"+'0004'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUAV','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT','000016','000014','.EXE.','5','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT, CADTPOSER, CTPCAATS, CBCALATS, LPROPDIA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0074    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0074( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCQUI','CALCULO QUINQUENIO','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCQUI','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','CCODADT := CVERBAROT','000002','000001','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','!( "N" $ CTIPOATS ) .AND. "Q" $ CTIPOATS .AND. ( EMPTY(RCE','000003','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "Q" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFQN) .OR. RCE->RCE_DTFQN > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','CADTPOSER := "Q"','000004','000003','.EXE.','5','cAdtPoSer := "Q"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','EMPTY(CCODADT)','000005','000003','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','CTIPOROT $ "1*2*4"','000006','000005','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','CCODADT := FGETCODFOL('+"'"+'0005'+"'"+')','000007','000006','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'0005'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','CTPCAATS == "1" .OR. CTPCAATS == "2"','000008','000003','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','CBCALATS <> "2"','000009','000008','.CON.','5','','','5','cBCalATS <> "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000010','000009','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','CTPCAATS == "3"','000011','000003','.CON.','5','','','5','cTpCaAts == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUI','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000012','000011','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0075    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0075( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCQUIV','CALCULO QUINQUENIO SOBRE VERBAS','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCQUIV','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','!( "N" $ cTipoAts ) .and. "Q" $ cTipoAts .AND. ( EMPTY(RCE','000002','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "Q" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFQN) .OR. RCE->RCE_DTFQN > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','cAdtPoSer := "Q"     .CNT.','000003','000002','.EXE.','5','cAdtPoSer := "Q"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','!( CTIPOROT $ "3*5*6" )','000004','000002','.CON.','5','','','5','!( cTipoRot $ "3*5*6" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','lPropDia := .T.     .END.','000005','000004','.EXE.','5','lPropDia := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','cTpCaAts == "1" .OR. cTpCaAts == "2"   .END.','000006','000002','.CON.','5','','','5','cTpCaAts == "1" .OR. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','cBCalATS == "2"   .END.','000007','000006','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','cCodAdt := cVerbaRot     .CNT.','000008','000007','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','Empty(cCodAdt)   .END.','000009','000007','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','CTIPOROT $ "1*2*4"','000010','000009','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','CCODADT := FGETCODFOL('+"'"+'1287'+"'"+')','000011','000010','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1287'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, c','000012','000007','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")','000013','000006','.CON.','5','','','5','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")) > 0 .AND. SRA->RA_HOJORVA = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','CBCALATS == "1"   .END.','000014','000013','.CON.','5','','','5','CBCALATS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','CCODADT := FGETCODFOL('+"'"+'0005'+"'"+')     .CNT.','000015','000014','.EXE.','5','CCODADT := FGETCODFOL('+"'"+'0005'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCQUIV','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT','000016','000014','.EXE.','5','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT, CADTPOSER, CTPCAATS, CBCALATS, LPROPDIA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0076    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0076( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCTRI','CALCULO TRIENIO','','','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCTRI','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT <> "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot <> "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','CCODADT := CVERBAROT','000002','000001','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','!( "N" $ CTIPOATS ) .AND. "T" $ CTIPOATS .AND. ( EMPTY(RCE','000003','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "T" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFTR) .OR. RCE->RCE_DTFTR > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','CADTPOSER := "T"','000004','000003','.EXE.','5','cAdtPoSer := "T"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','EMPTY(CCODADT)','000005','000003','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','CTIPOROT $ "1*2*4"','000006','000005','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','CCODADT := FGETCODFOL('+"'"+'0003'+"'"+')','000007','000006','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'0003'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','CTPCAATS == "1" .OR. CTPCAATS == "2"','000008','000003','.CON.','5','','','5','cTpCaAts == "1" .or. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','CBCALATS <> "2"','000009','000008','.CON.','5','','','5','cBCalATS <> "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000010','000009','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','CTPCAATS == "3"','000011','000003','.CON.','5','','','5','cTpCaAts == "3"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRI','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,,P_ADCINTEG, CCODADT, C','000012','000011','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0077    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0077( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCTRIV','CALCULO TRIENIO SOBRE VERBAS','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCTRIV','( ( CTIPOROT == "2" .AND. P_SOMAINC ) .OR. (CTIPOROT # "2")','000001','000000','.CON.','5','','','5','( ( cTipoRot == "2" .and. P_SOMAINC ) .or. (cTipoRot # "2") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','!( "N" $ cTipoAts ) .and. "T" $ cTipoAts .AND. ( EMPTY(RCE','000002','000001','.CON.','5','','','5','!( "N" $ cTipoAts ) .and. "T" $ cTipoAts .AND. ( EMPTY(RCE->RCE_DTFTR) .OR. RCE->RCE_DTFTR > DDATADE )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','cAdtPoSer := "T"     .CNT.','000003','000002','.EXE.','5','cAdtPoSer := "T"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','!( CTIPOROT $ "3*5*6" )','000004','000002','.CON.','5','','','5','!( cTipoRot $ "3*5*6" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','lPropDia := .T.     .END.','000005','000004','.EXE.','5','lPropDia := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','cTpCaAts == "1" .OR. cTpCaAts == "2"   .END.','000006','000002','.CON.','5','','','5','cTpCaAts == "1" .OR. cTpCaAts == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','cBCalATS == "2"   .END.','000007','000006','.CON.','5','','','5','cBCalATS == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','cCodAdt := cVerbaRot     .CNT.','000008','000007','.EXE.','5','cCodAdt := cVerbaRot','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','Empty(cCodAdt)   .END.','000009','000007','.CON.','5','','','5','Empty(cCodAdt)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','CTIPOROT $ "1*2*4"','000010','000009','.CON.','5','','','5','cTipoRot $ "1*2*4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','CCODADT := FGETCODFOL('+"'"+'1285'+"'"+')','000011','000010','.EXE.','5','cCodAdt := FGETCODFOL('+"'"+'1285'+"'"+')','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, c','000012','000007','.EXE.','5','fCalAdt(aCodfol,@nAdtServ,"S",SalMes,,P_ADCINTEG, cCodAdt, cAdtPoSer, cTpCaAts, cBCalATS, lPropDia)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")','000013','000006','.CON.','5','','','5','SRA->RA_CATFUNC = "H" .AND. SRA->(COLUMNPOS( "RA_HOJORVA")) > 0 .AND. SRA->RA_HOJORVA = "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','CBCALATS == "1"   .END.','000014','000013','.CON.','5','','','5','CBCALATS == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','CCODADT := FGETCODFOL('+"'"+'0003'+"'"+')     .CNT.','000015','000014','.EXE.','5','CCODADT := FGETCODFOL('+"'"+'0003'+"'"+')','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCTRIV','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT','000016','000014','.EXE.','5','FCALADT(ACODFOL,@NADTSERV,"S",SALMES,.T.,P_ADCINTEG, CCODADT, CADTPOSER, CTPCAATS, CBCALATS, LPROPDIA)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0078    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0078( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCVAL','CALCULA VALE ALIMENTACAO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCVAL','LNOVOCALCB','000001','000000','.CON.','5','','','5','LNOVOCALCB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCVAL','FVALCALCN(@AVACALC)','000002','000001','.EXE.','5','FVALCALCN(@AVACALC)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCVAL','!LNOVOCALCB','000003','000000','.CON.','5','','','5','!LNOVOCALCB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCVAL','FVALCALC(@AVACALC)','000004','000003','.EXE.','5','fVALCalc(@aVACalc)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0079    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0079( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCVALO','CALCULA O VALOR DAS VERBAS EM HORAS/DIAS','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCVALO','FATUCALC(APD,ACODFOL,@SALMES,@SALDIA,@SALHORA,.T.)','000001','000000','.EXE.','5','fAtuCalc(aPd,aCodfol,@SalMes,@Saldia,@SalHora,.T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0080    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0080( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCVRF','CALCULA VALE REFEICAO','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCVRF','LNOVOCALCB','000001','000000','.CON.','5','','','5','LNOVOCALCB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCVRF','FVRFCALCN(@AVRCALC)','000002','000001','.EXE.','5','FVRFCALCN(@AVRCALC)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCVRF','!LNOVOCALCB','000003','000000','.CON.','5','','','5','!LNOVOCALCB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCVRF','FVRFCALC(@AVRCALC)','000004','000003','.EXE.','5','fVRFCalc(@aVRCalc)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0081    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0081( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALCVTR','CALCULO DO VALE TRANSPORTE','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALCVTR','LNOVOCALCB','000001','000000','.CON.','5','','','5','LNOVOCALCB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCVTR','FVTRCALCN(@AVTCALC)','000002','000001','.EXE.','5','FVTRCALCN(@AVTCALC)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALCVTR','!LNOVOCALCB','000003','000000','.CON.','5','','','5','!LNOVOCALCB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALCVTR','FVTRCALC(@AVTCALC)','000004','000003','.EXE.','5','fVTRCalc(@aVTCalc)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0082    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0082( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALC_INS','CALCULO DE INSS - GFP','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseAc := 0     .CNT.','000001','000000','.EXE.','5','nBaseAc := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseAt := 0     .CNT.','000002','000000','.EXE.','5','nBaseAt := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAliqInss := 0     .CNT.','000003','000000','.EXE.','5','nAliqInss := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nPDedBsIR := 0     .CNT.','000004','000000','.EXE.','5','nPDedBsIR := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nInss := 0     .CNT.','000005','000000','.EXE.','5','nInss := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nInss1 := 0     .CNT.','000006','000000','.EXE.','5','nInss1 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','aTabS001 := {}     .CNT.','000007','000000','.EXE.','5','aTabS001 := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','lTrunca := IF(P_ARREINSS == .T., .F., .T.)     .CNT.','000008','000000','.EXE.','5','lTrunca := IF(P_ARREINSS == .T., .F., .T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','NBASE1 := NBASEINSS     .CNT.','000009','000000','.EXE.','5','NBASE1 := NBASEINSS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseOut := IF( nBaseOut == NIL .or. ValType( nBaseOut ) !=','000010','000000','.EXE.','5','nBaseOut := IF( nBaseOut == NIL .or. ValType( nBaseOut ) != "N" , 0.00 , nBaseOut )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','dDataRef := dDataAte /* Ctod( "01/"+RCH->RCH_MES+"/"+RCH->RC','000011','000000','.EXE.','5','dDataRef := dDataAte /* Ctod( "01/"+RCH->RCH_MES+"/"+RCH->RCH_ANO )  */','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','fRetTab( @aTabS001, "S001", , , dDataRef, , .T.)     .CNT.','000012','000000','.EXE.','5','fRetTab( @aTabS001, "S001", , , dDataRef, , .T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','(nBase1 > 0) .AND. (SRA->RA_TPPREVI $ "1* ") /* RGPS - REG','000013','000000','.CON.','5','','','5','(nBase1 > 0) .AND. (SRA->RA_TPPREVI $ "1* ") /* RGPS - REGIME GERAL DA PREVIDENCIA SOCIAL */','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','NAUX := FPOSTAB("S001", NBASE1, "<=", 6 )     .CNT.','000014','000013','.EXE.','5','NAUX := FPOSTAB("S001", NBASE1, "<=", 6 , ANOMES(DDATAREF), "<=", 5)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAux > 0   .END.','000015','000013','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAliqInss := Round(FTABELA("S001", NAUX, 7,dDataRef ) , 2)','000016','000015','.EXE.','5','nAliqInss := Round(FTABELA("S001", NAUX, 7,dDataRef ) , 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nPDedBsIR := Round(FTABELA("S001", NAUX, 8, dDataRef ) , 2)','000017','000015','.EXE.','5','nPDedBsIR := Round(FTABELA("S001", NAUX, 8, dDataRef ) , 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nInss := If(lTrunca, NoRound(nBase1 * (nAliqINSS / 100 ) , 2','000018','000015','.EXE.','5','nInss := If(lTrunca, NoRound(nBase1 * (nAliqINSS / 100 ) , 2), Round(nBase1 *  ( nAliqINSS / 100) , 2) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nInss1 := If(lTrunca, NoRound(nBase1 * ( nPDedBsIR / 100 ) ,','000019','000015','.EXE.','5','nInss1 := If(lTrunca, NoRound(nBase1 * ( nPDedBsIR / 100 ) , 2) , Round(nBase1 *  ( nPDedBsIR / 100 ), 2) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseAt := (nBase1 - nBaseOut)     .END.','000020','000015','.EXE.','5','nBaseAt := (nBase1 - nBaseOut)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAux == 0   .END.','000021','000013','.CON.','5','','','5','nAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAux := LEN(aTabS001)     .CNT.','000022','000021','.EXE.','5','nAux := LEN(aTabS001)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAux == 0   .END.','000023','000021','.CON.','5','','','5','nAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','CMSGLOG := "TABELA DO INSS NÃO ENCONTRADA"     .CNT.','000024','000023','.EXE.','5','CMSGLOG := "TABELA DO INSS NÃO ENCONTRADA"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','S_MSGLOGFP()     .CNT.','000025','000023','.EXE.','5','S_MSGLOGFP()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','ENDCALC()  /* FINALCALC() */     .END.','000026','000023','.EXE.','5','ENDCALC()  /* FINALCALC() */','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAux > 0   .END.','000027','000021','.CON.','5','','','5','nAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAliqInss := Round(FTABELA("S001", NAUX, 7,dDataRef )  , 2)','000028','000027','.EXE.','5','nAliqInss := Round(FTABELA("S001", NAUX, 7,dDataRef )  , 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nPDedBsIR := Round(FTABELA("S001", NAUX, 8,dDataRef ) , 2)','000029','000027','.EXE.','5','nPDedBsIR := Round(FTABELA("S001", NAUX, 8,dDataRef ) , 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseCalc := If ( nBase1 < fTabela( "S001", nAux, 6,dDataRef','000030','000027','.EXE.','5','nBaseCalc := If ( nBase1 < fTabela( "S001", nAux, 6,dDataRef ),nBase1,fTabela("S001", nAux,6,dDataRef ) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nInss := If( lTrunca , NoRound( nBaseCalc * (nAliqINSS / 100','000031','000027','.EXE.','5','nInss := If( lTrunca , NoRound( nBaseCalc * (nAliqINSS / 100) , 2) , Round( nBaseCalc * (nAliqINSS /  100) , 2) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nInss1 := If(lTrunca, NoRound(nBaseCalc *  ( nPDedBsIR / 100','000032','000027','.EXE.','5','nInss1 := If(lTrunca, NoRound(nBaseCalc *  ( nPDedBsIR / 100 ) , 2) ,Round(nBaseCalc * ( nPDedBsIR / 100 ) , 2) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseAt := Max(nBaseCalc - nBaseOut , 0 )     .CNT.','000033','000027','.EXE.','5','nBaseAt := Max(nBaseCalc - nBaseOut , 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseAc := nBase1 - nBaseOut - nBaseAt     .END.','000034','000027','.EXE.','5','nBaseAc := nBase1 - nBaseOut - nBaseAt','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','(nBase1 > 0) .AND. (SRA->RA_TPPREVI == "2") /* RPPS - REGI','000035','000000','.CON.','5','','','5','(nBase1 > 0) .AND. (SRA->RA_TPPREVI == "2") /* RPPS - REGIME PROPRIO DA PREVIDENCIA SOCIAL */','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nAliqINSS := P_PERCRPPS /* MNEMONICO COM O VALOR DO DESCONTO','000036','000035','.EXE.','5','nAliqINSS := P_PERCRPPS /* MNEMONICO COM O VALOR DO DESCONTO DA PREV. PROPRIA */','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nInss := If(lTrunca, NoRound(nBase1 * ( nAliqINSS / 100 ) ,','000037','000035','.EXE.','5','nInss := If(lTrunca, NoRound(nBase1 * ( nAliqINSS / 100 ) , 2), Round(nBase1 *  ( nAliqINSS / 100) , 2) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','NINSS1 := NINSS     .CNT.','000038','000035','.EXE.','5','NINSS1 := NINSS','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseAt  := nBase1 - nBaseOut     .CNT.','000039','000035','.EXE.','5','nBaseAt  := nBase1 - nBaseOut','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALC_INS','nBaseAc := nBase1 - nBaseOut - nBaseAt     .END.','000040','000035','.EXE.','5','nBaseAc := nBase1 - nBaseOut - nBaseAt','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0083    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0083( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALDSRFP','Calculo DSR - GFP','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CALDSRFP','cSitFolh := SRA->RA_SITFOLH     .CNT.','000001','000000','.EXE.','5','cSitFolh := SRA->RA_SITFOLH','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','cSitFolh = " " .END.','000002','000000','.CON.','5','','','5','cSitFolh','=','5','" "','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','SRA->RA_TIPOPGT = "M" .END.','000003','000002','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"M"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','SRA->RA_CATFUNC $ "M*C*A*P*E*0*1*2*3*4*5*6*7*8*9"   .END.','000004','000003','.CON.','5','','','5','SRA->RA_CATFUNC $ "M*C*A*P*E*0*1*2*3*4*5*6*7*8*9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nSalPg     := Salmes     .CNT.','000005','000004','.EXE.','5','nSalPg     := Salmes','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nSalPg := Round(SalMes / 30 * DiasTrab,2)     .END.','000006','000004','.EXE.','5','nSalPg := Round(SalMes / 30 * DiasTrab,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','SRA->RA_CATFUNC $ "H*G" .END.','000007','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"H*G"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))     .','000008','000007','.EXE.','5','nSalPg  := Round(Salhora * nHorasTrab , MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))     .END.','000009','000007','.EXE.','5','nDsr := Round(Salhora * nHorasDsr , MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','SRA->RA_CATFUNC $ "D" .END.','000010','000003','.CON.','5','','','5','SRA->RA_CATFUNC','$','5','"D"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nSalPg     := SalDia * Diastrab     .END.','000011','000010','.EXE.','5','nSalPg     := SalDia * Diastrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','SRA->RA_TIPOPGT = "S" .END.','000012','000002','.CON.','5','','','5','SRA->RA_TIPOPGT','=','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','Type("NTOTDIAS") = "U" .END.','000013','000012','.CON.','5','','','5','Type("NTOTDIAS")','=','5','"U"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nTotDias := 7     .END.','000014','000013','.EXE.','5','nTotDias := 7','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','000015','000012','.EXE.','5','nSalPg         := Round(Saldia * DiasTrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','DiasDsr > 0 .END.','000016','000012','.CON.','5','','','5','DiasDsr','>','5','0','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nTotdias  := DiasTrab + DiasDsr     .CNT.','000017','000016','.EXE.','5','nTotdias  := DiasTrab + DiasDsr','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotD','000018','000016','.EXE.','5','nDsr       := If( nTotDias=7,(SalDia*7)-nSalPg,SalDia*(nTotDias-DiasTrab) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nHorasDsr  := nTotDias - DiasTrab     .END.','000019','000016','.EXE.','5','nHorasDsr  := nTotDias - DiasTrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','!(cSitFolh == " ") .AND. !(cSitFolh == "D")   .AND.','000020','000000','.CON.','5','','','5','!(cSitFolh == " ") .AND. !(cSitFolh == "D")','','5','','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*0*1*2*3*4*5*6*7*8*9"   .E','000021','000000','.CON.','5','','','5','SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*0*1*2*3*4*5*6*7*8*9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))     .EN','000022','000021','.EXE.','5','nSalPg     := Round(SalDia * Diastrab,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','!(Empty(cSitFolh)) .AND. !(cSitFolh == "D") .AND. !(SRA->R','000023','000000','.CON.','5','','','5','!(Empty(cSitFolh)) .AND. !(cSitFolh == "D") .AND. !(SRA->RA_CATFUNC $ "M*C*D*S*A*P*E*0*1*2*3*4*5*6*7*8*9")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','000024','000023','.EXE.','5','nSalPg     := Round(SalHora * nHorastrab,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))     .','000025','000023','.EXE.','5','nDsr       := Round(SalHora * nHorasDsr,MsDecimais(1))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','cSitFolh = "A" .AND.','000026','000000','.CON.','5','','','5','cSitFolh','=','5','"A"','.AND.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','SRA->RA_TIPOPGT == "S" .END.','000027','000000','.CON.','5','','','5','SRA->RA_TIPOPGT','==','5','"S"','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))     .CNT','000028','000027','.EXE.','5','nDsr       := Round(Saldia * DiasDsr,MsDecimais(1))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRFP','nHorasDsr  := DiasDsr     .END.','000029','000027','.EXE.','5','nHorasDsr  := DiasDsr','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0084    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0084( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALDSRHE','CALCULA OUTRAS DSR','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','CALDSRHE','NOPCDSRCAL++','000001','000000','.EXE.','5','NOPCDSRCAL++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','CROT := IF(EMPTY(CROT),GETROTEXEC(),CROT)     .CNT.','000002','000000','.EXE.','5','CROT := IF(EMPTY(CROT),GETROTEXEC(),CROT)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','CROT = "RES"   .END.','000003','000000','.CON.','5','','','5','CROT = "RES"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','LTEMCOMIS := ( ASCAN(APD,{ |X| X[1] $ ACODFOL[121,1] + "/" +','000004','000003','.EXE.','5','LTEMCOMIS := ( ASCAN(APD,{ |X| X[1] $ ACODFOL[121,1] + "/" + ACODFOL[165,1] .AND. X[3] = CSEMANA .AND. X[9] # "D"}) ) > 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','CROT <> "RES"   .END.','000005','000000','.CON.','5','','','5','CROT <> "RES"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','LTEMCOMIS := ( ASCAN(APD,{ |X| X[1] = ACODFOL[165,1] .AND. X','000006','000005','.EXE.','5','LTEMCOMIS := ( ASCAN(APD,{ |X| X[1] = ACODFOL[165,1] .AND. X[3] = CSEMANA .AND. X[9] # "D"}) ) > 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','lTemComis   .END.','000007','000000','.CON.','5','','','5','lTemComis','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','nOpcDSRCal := 2     .END.','000008','000007','.EXE.','5','nOpcDSRCal := 2','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALDSRHE','CALDSRHEX(ACODFOL,@DSR_HREX,@DSR_HHEX,"S",,,,NOPCDSRCAL)','000009','000000','.EXE.','5','CalDsrHex(aCodfol,@DSr_HrEx,@Dsr_HhEx,"S",,,,nOpcDSRCal)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0085    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0085( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALFGTS','CALCULO FGTS','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','CALFGTS','!(SRA->RA_CATFUNC $ "A*E*G" )','000001','000000','.CON.','5','','','5','!(SRA->RA_CATFUNC $ "A*E*G" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFGTS','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND','000002','000001','.CON.','5','','','5','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND. ACONVOCACAO[6])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFGTS','FCFGTS(ACODFOL,,"S",NAFASFGTS,,.F.)','000003','000002','.EXE.','5','fCFgts(aCodfol,,"S",nAfasFgts,,.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0086    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0086( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALFGTSR','CALCULO FGTS RETIFICADORA','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CALFGTSR','!(SRA->RA_CATFUNC $ "A*E*G" )','000001','000000','.CON.','5','','','5','!(SRA->RA_CATFUNC $ "A*E*G" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALFGTSR','FCFGTSRTF(ACODFOL,,"S",NAFASFGTS,,.F.)','000002','000001','.EXE.','5','fCfgtsRtf(aCodfol,,"S",nAfasFgts,,.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0087    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0087( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALIQ131','CALCULA LIQUIDO E ARREDON. 1ª PARC 13°','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','CALIQ131','cCodliq := FGETCODFOL("0678")     .CNT.','000001','000000','.EXE.','5','cCodliq := FGETCODFOL("0678")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQ131','Empty(cCodliq)   .END.','000002','000000','.CON.','5','','','5','Empty(cCodliq)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIQ131','CMSGLOG := FMSGFORM({19}) + "0678 - " + FDESC("RCN", "0678",','000003','000002','.EXE.','5','CMSGLOG := FMSGFORM({19}) + "0678 - " + FDESC("RCN", "0678", "RCN_DESCRI")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQ131','S_MSGLOG()     .CNT.','000004','000002','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQ131','FINALCALC()     .END.','000005','000002','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQ131','!Empty(cCodliq)   .END.','000006','000000','.CON.','5','','','5','!Empty(cCodliq)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIQ131','FLIQUIDO(ACODFOL,CCODLIQ,NVALARR13,ACODFOL[26,1],.T. ,ACODFO','000007','000006','.EXE.','5','fLiquido(aCodfol,cCodliq,nValArr13,aCodfol[26,1],.T. ,aCodfol[30,1],.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0088    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0088( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALIQ132','LIQUIDO / ARRED / INS.SALDO 13º SALARIO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CALIQ132','fLiquido(aCodfol,aCodfol[21,1],NVALARR13,aCodfol[26,1],.T.,a','000001','000000','.EXE.','5','fLiquido(aCodfol,aCodfol[21,1],NVALARR13,aCodfol[26,1],.T.,aCodfol[30,1],.F.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0089    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0089( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALIQFOL','CALCULO LIQUIDO E ARREDONDA. FOLHA','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CALIQFOL','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND.','000001','000000','.CON.','5','','','5','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND. ACONVOCACAO[6])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIQFOL','FLIQUIDO(ACODFOL,ACODFOL[47,1],NVALARRED,ACODFOL[43,1],.T.,A','000002','000001','.EXE.','5','fLiquido(aCodfol,aCodfol[47,1],nValArred,aCodfol[43,1],.T.,aCodFol[45,1],.T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0090    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0090( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALIQRES','CALCULA LIQUIDO RESCISAO','','','007','2','1',} )

aAdd(aRc3Cols, { '','S_','CALIQRES','LTEMVER := ( LEN(ACODFOL) >= 1880 .AND. !EMPTY(ACODFOL[1880,','000001','000000','.EXE.','5','lTemVer := ( Len(aCodFol) >= 1880 .And. !Empty(aCodFol[1880,1]) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','LCOMPL1880 := ( CCOMPL == "S" .AND. ASCAN(APDRESC,{ |X| X[1]','000002','000000','.EXE.','5','lCompl1880 := ( cCompl == "S" .And. aScan(aPdResc,{ |x| x[1] == aCodFol[1880,1] .and. x[9] # "D" }) > 0 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','FLIQUIDO(ACODFOL,ACODFOL[126,1],0,"",.T.,ACODFOL[45,1],.T.,.','000003','000000','.EXE.','5','fLiquido(aCodfol,aCodfol[126,1],0,"",.T.,aCodFol[45,1],.T.,.T.,.T.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','LCOMPL1880 .AND. SRA->RA_TPCONTR == "2" .AND. (CAFASFGTS ==','000004','000000','.CON.','5','','','5','lCompl1880 .And. SRA->RA_TPCONTR == "2" .And. (cAfasfgts == "I1" .Or. cAfasfgts == "I3") .And. SRA->RA_CATEFD == "106"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','LTEMVER','000005','000004','.CON.','5','','','5','lTemVer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','NPOSLIQ := ASCAN( APD, { |X| X[1] == ACODFOL[126,1] .AND. X[','000006','000005','.EXE.','5','nPosLiq := aScan( aPd, { |x| x[1] == aCodFol[126,1] .And. x[9] != "D" } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','NPOSLIQ > 0','000007','000005','.CON.','5','','','5','nPosLiq > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','FMATRIZ(ACODFOL[1880,1], (APD[NPOSLIQ, 5]/12), 1.12,,,,,,,DD','000008','000007','.EXE.','5','fMatriz(aCodFol[1880,1], (aPd[nPosliq, 5]/12), 1.12,,,,,,,dData_Pgto)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','AEVAL( APD, { |X| IIF(X[1] $ (ACODFOL[45,1]+"/"+ACODFOL[126,','000009','000007','.EXE.','5','aEval( aPd, { |x| Iif(x[1] $ (aCodFol[45,1]+"/"+aCodFol[126,1]), x[9] := "D", Nil) } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','FLIQUIDO(ACODFOL,ACODFOL[126,1],0,"",.T.,ACODFOL[45,1],.T.,.','000010','000007','.EXE.','5','fLiquido(aCodfol,aCodfol[126,1],0,"",.T.,aCodFol[45,1],.T.,.T.,.T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','!LTEMVER','000011','000004','.CON.','5','','','5','!lTemVer','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','ADDLOGEXECROT( "NÃO HÁ CADASTRO DE VERBA PARA O ID 1880 PARA','000012','000011','.EXE.','5','AddLogExecRot( "Não há cadastro de verba para o ID 1880 para a geração da indenização de 1/12 avos para trabalhador temporário conforme Lei 6.019 de 1974." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','ADDLOGEXECROT( "VERIFIQUE A DOCUMENTAÇÃO NO TDN DISPONÍVEL E','000013','000011','.EXE.','5','AddLogExecRot( "Verifique a documentação no TDN disponível em https://tdn.totvs.com/x/ZxyXJg para mais informações." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','ADDLOGEXECROT( "OBS.: O CÁLCULO NÃO SERÁ REALIZADO ATÉ QUE S','000014','000011','.EXE.','5','AddLogExecRot( "Obs.: o cálculo não será realizado até que seja efetuado o cadastro da verba de ID 1880." )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIQRES','FINALCALC()','000015','000011','.EXE.','5','FinalCalc()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0091    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0091( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALIQVEX','CALCULO LIQUIDO VALORES EXTRAS','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CALIQVEX','FLIQUIDO(ACODFOL,ACODFOL[1411,1],0,"",.F.,"",.T.,.T.,.T.)','000001','000000','.EXE.','5','FLIQUIDO(ACODFOL,ACODFOL[1411,1],0,"",.F.,"",.T.,.T.,.T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0092    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0092( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALIR','CALCULO IMPOSTO DE RENDA','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','CALIR','CTIPOROT # "4"','000001','000000','.CON.','5','','','5','cTipoRot # "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIR','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND','000002','000001','.CON.','5','','','5','(SRA->RA_TPCONTR <> "3" ) .OR. (SRA->RA_TPCONTR == "3" .AND. ACONVOCACAO[6])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIR','FCIR(ACODFOL,ATABIR,,DDATA_PGTO)','000003','000002','.EXE.','5','fCIr(aCodfol,aTabir,,dData_Pgto)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALIR','CTIPOROT == "4"','000004','000000','.CON.','5','','','5','cTipoRot == "4"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALIR','FCIR(ACODFOL , ATABIR , "R" , GETMEMVAR("RG_DATAHOM"))','000005','000004','.EXE.','5','fCIr(aCodfol , aTabir , "R" , GetMemVar("RG_DATAHOM"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0093    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0093( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALPENFP','CALCULO PENSAO - GFP','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','CALPENFP','CTIPOROT $ "1*7*9"   .END.','000001','000000','.CON.','5','','','5','CTIPOROT $ "1*7*9"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPENFP','FCALCPENSAO(ACODFOL[64,1],ACODFOL[66,1],,0,DDATA_PGTO)     .','000002','000001','.EXE.','5','FCALCPENSAO(ACODFOL[64,1],ACODFOL[66,1],,0,DDATA_PGTO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPENFP','CTIPOROT == "5"   .END.','000003','000000','.CON.','5','','','5','CTIPOROT == "5"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPENFP','FCALCPENSAO("XXX",ACODFOL[9,1],,0,DDATA_PGTO)     .END.','000004','000003','.EXE.','5','FCALCPENSAO("XXX",ACODFOL[9,1],,0,DDATA_PGTO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPENFP','CTIPOROT $ "3*L*M"   .END.','000005','000000','.CON.','5','','','5','CTIPOROT $ "3*L*M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPENFP','RegToMemory("SRH",.F.)     .END.','000006','000005','.EXE.','5','RegToMemory("SRH",.F.)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPENFP','FCALCPENSAO(ACODFOL[65,1], ACODFOL[67,1],, 0, GETMEMVAR("RH_','000007','000005','.EXE.','5','FCALCPENSAO(ACODFOL[65,1], ACODFOL[67,1],, 0, GETMEMVAR("RH_DTRECIB"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPENFP','CTIPOROT == "6"   .END.','000008','000000','.CON.','5','','','5','CTIPOROT == "6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPENFP','FCALCPENSAO(ACODFOL[70,1], ACODFOL[71,1], , 0, DDATA_PGTO)','000009','000008','.EXE.','5','FCALCPENSAO(ACODFOL[70,1], ACODFOL[71,1], , 0, DDATA_PGTO)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0094    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0094( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALPRVGP','CALCULA A PREVIDENCIA - GFP','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','CALPRVGP','lCalcINSS := ( SRA->RA_TPPREVI $ "1*2" )   .CNT.','000001','000000','.EXE.','5','lCalcINSS',':=','5','( SRA->RA_TPPREVI $ "1*2" )','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','cFiltroPrev := ""   .CNT.','000002','000000','.EXE.','5','cFiltroPrev',':=','5','""','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','SRA->RA_TPPREVI $"1* "','000003','000000','.CON.','5','','','5','SRA->RA_TPPREVI$"1* "','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','CVRBINSS := IIF(CTIPOROT $ "3*L*M" , ACODFOL[65,1] , IIF(CTI','000004','000003','.EXE.','5','CVRBINSS := IIF(CTIPOROT $ "3*L*M" , ACODFOL[65,1] , IIF(CTIPOROT$"5*6" , ACODFOL[70,1] , ACODFOL[64,1]) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','CVRBBATELIM := IIF(CTIPOROT $ "1*3*7*L*M", ACODFOL[13,1], AC','000005','000003','.EXE.','5','CVRBBATELIM := IIF(CTIPOROT $ "1*3*7*L*M", ACODFOL[13,1], ACODFOL[0019,1])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','CVRBBACILIM := IIF(CTIPOROT $ "1*3*7*L*M", ACODFOL[14,1], AC','000006','000003','.EXE.','5','CVRBBACILIM := IIF(CTIPOROT $ "1*3*7*L*M", ACODFOL[14,1], ACODFOL[0020,1])','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','SRA->RA_TPPREVI=="2"','000007','000000','.CON.','5','','','5','SRA->RA_TPPREVI=="2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','CVRBINSS := IIF(CTIPOROT $ "3*L*M" , ACODFOL[1665,1] , IIF(C','000008','000007','.EXE.','5','CVRBINSS := IIF(CTIPOROT $ "3*L*M" , ACODFOL[1665,1] , IIF(CTIPOROT$"5*6" , ACODFOL[1382,1] , ACODFOL[1374,1]) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','CVRBBATELIM := IIF(CTIPOROT $ "3*L*M" , ACODFOL[1664,1] , II','000009','000007','.EXE.','5','CVRBBATELIM := IIF(CTIPOROT $ "3*L*M" , ACODFOL[1664,1] , IIF(CTIPOROT$"5*6" , ACODFOL[1663,1] , ACODFOL[1662,1]) )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','cVrbVlrINSS:= Iif( cTipoRot $ "3*L*M", aCodFol[0168,1], Iif(','000010','000000','.EXE.','5','cVrbVlrINSS:= Iif( cTipoRot $ "3*L*M", aCodFol[0168,1], Iif( cTipoRot$"5*6", aCodFol[0169,1], aCodFol[0167,1]))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','cVrbFAPSDesc:= Iif( cTipoRot $ "1*7", aCodFol[616,1], Iif( c','000011','000000','.EXE.','5','cVrbFAPSDesc:= Iif( cTipoRot $ "1*7", aCodFol[616,1], Iif( cTipoRot == "3", aCodFol[665,1], aCodFol[658,1]))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','cVrbBsFAPS:= Iif( cTipoRot $ "1*7", aCodFol[615,1], Iif( cTi','000012','000000','.EXE.','5','cVrbBsFAPS:= Iif( cTipoRot $ "1*7", aCodFol[615,1], Iif( cTipoRot == "3", aCodFol[664,1],aCodFol[657,1]))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','lGerouInss:= (nPosInss := Ascan(aPd,{|x| x[1] == cVrbINSS .a','000013','000000','.EXE.','5','lGerouInss:= (nPosInss := Ascan(aPd,{|x| x[1] == cVrbINSS .and. x[3] == CNUMPAG .and. x[9] <> "D"})) > 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','cTipoRot $ "1*7" .And. !lGerouInss   .END.','000014','000000','.CON.','5','','','5','cTipoRot $ "1*7" .And. !lGerouInss','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','LGEROUINSS:=  ASCAN(APD,{|X| X[1] == IIF(SRA->RA_TPPREVI $"1','000015','000014','.EXE.','5','LGEROUINSS:=  ASCAN(APD,{|X| X[1] == IIF(SRA->RA_TPPREVI $"1* ", ACODFOL[65,1], ACODFOL[1665,1]) .AND. X[3] == CNUMPAG .AND. X[9] <> "D"}) > 0','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','lCalcInss == .F. .And. lGerouInss == .T.   .END.','000016','000000','.CON.','5','','','5','lCalcInss == .F. .And. lGerouInss == .T.','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','aPD[nPosInss,9] := "D"     .CNT.','000017','000016','.EXE.','5','aPD[nPosInss,9] := "D"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','(nPosBAteLim := Ascan(aPd,{|x| x[1] == cVrbBAteLim .and. x','000018','000016','.CON.','5','','','5','(nPosBAteLim := Ascan(aPd,{|x| x[1] == cVrbBAteLim .and. x[3] == CNUMPAG .and. x[9] <> "D"})) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','aPD[nPosBAteLim,9] := "D"     .END.','000019','000018','.EXE.','5','aPD[nPosBAteLim,9] := "D"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','(nPosBAciLim := Ascan(aPd,{|x| x[1] == cVrbBAciLim .and. x','000020','000016','.CON.','5','','','5','(nPosBAciLim := Ascan(aPd,{|x| x[1] == cVrbBAciLim .and. x[3] == CNUMPAG .and. x[9] <> "D"})) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','aPD[nPosBAciLim,9] := "D"     .END.','000021','000020','.EXE.','5','aPD[nPosBAciLim,9] := "D"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','(nPosVlrINSS := Ascan(aPd,{|x| x[1] == cVrbVlrINSS .and. x','000022','000016','.CON.','5','','','5','(nPosVlrINSS := Ascan(aPd,{|x| x[1] == cVrbVlrINSS .and. x[3] == CNUMPAG .and. x[9] <> "D"})) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','aPD[nPosVlrINSS,9] := "D"     .END.','000023','000022','.EXE.','5','aPD[nPosVlrINSS,9] := "D"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','cTipoRot $ "1*7"   .END.','000024','000016','.CON.','5','','','5','cTipoRot $ "1*7"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','(NPOSVRB65 := ASCAN(APD,{|X| X[1] == IIF(SRA->RA_TPPREVI $"1','000025','000024','.CON.','5','','','5','(NPOSVRB65 := ASCAN(APD,{|X| X[1] == IIF(SRA->RA_TPPREVI $"1* ", ACODFOL[65,1], ACODFOL[1665,1]) .AND. X[3] == CNUMPAG .AND. X[9] <> "D"})) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','aPD[nPosVrb65,9] := "D"     .END.','000026','000025','.EXE.','5','aPD[nPosVrb65,9] := "D"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','(nPosVrb168 := Ascan(aPd,{|x| x[1] == aCodFol[168,1] .and.','000027','000024','.CON.','5','','','5','(nPosVrb168 := Ascan(aPd,{|x| x[1] == aCodFol[168,1] .and. x[3] == CNUMPAG .and. x[9] <> "D"})) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','aPD[nPosVrb168,9] := "D"     .END.','000028','000027','.EXE.','5','aPD[nPosVrb168,9] := "D"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','lCalcInss == .T. .And. lGerouInss == .F. .And. cTipoRot $','000029','000000','.CON.','5','','','5','lCalcInss == .T. .And. lGerouInss == .F. .And. cTipoRot $ "1/2/3/4/7/9/L/M"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','S_FCINSS()     .CNT.','000030','000029','.EXE.','5','S_FCINSS()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','S_GRAVINSS()     .END.','000031','000029','.EXE.','5','S_GRAVINSS()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','lCalcInss == .T. .And. lGerouInss == .F. .And. cTipoRot $','000032','000000','.CON.','5','','','5','lCalcInss == .T. .And. lGerouInss == .F. .And. cTipoRot $  "4*5*6"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','S_FCINSS13()     .CNT.','000033','000032','.EXE.','5','S_FCINSS13()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','(CTIPOROT $ "4*6" )   .END.','000034','000032','.CON.','5','','','5','(CTIPOROT $ "4*6" )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALPRVGP','S_GRINSS13()     .END.','000035','000034','.EXE.','5','S_GRINSS13()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0095    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0095( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALSALFA','CALCULO SAL. FAMILIA','','002222','013','2','1',} )

aAdd(aRc3Cols, { '','S_','CALSALFA','LPGSALFAM := FTPAUSSALF(DDATADE,DDATAATE)','000001','000000','.EXE.','5','lPgSalFam := fTpAusSalF(DDATADE,DDATAATE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSALFA','LCOND1 := !(CSITFOLH $ "A*D*F") .OR.  ( CSITFOLH $ "A*F" .AN','000002','000000','.EXE.','5','lCond1 := !(cSitFolh $ "A*D*F") .or.  ( cSitFolh $ "A*F" .And. nDiasPg+nDiasMat > 0 ) .Or. (LPGSALFAM .And. cSitFolh <> "D")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSALFA','LCOND2 :=  (LRECRES .AND. CCOMPL <> "S") .OR. (CTIPOROT = "4','000003','000000','.EXE.','5','lCond2 :=  (LRECRES .AND. CCOMPL <> "S") .OR. (CTIPOROT = "4" .AND. LRECRES .And. CCOMPL == "S" .And. MESANO(GETMEMVAR("RG_DATADEM")) == MESANO(GETMEMVAR("RG_DTGERAR")) )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSALFA','LCOND1 .OR. LCOND2','000004','000000','.CON.','5','','','5','lCond1 .Or. lCond2','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSALFA','CTIPOROT == "4" .AND. ((CCOMPL # "S" .AND. LPGSALFAM) .OR.','000005','000004','.CON.','5','','','5','cTipoRot == "4" .and. ((cCompl # "S" .And. lPgSalFam) .or. ( cCompl == "S" .and. MesAno(GetMemVar("RG_DATADEM")) == MesAno(GetMemVar("RG_DTGERAR")) ) )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSALFA','SALFAM(ACODFOL,@NSAL_FAMI,"S",IIF( EMPTY(DDATADEM),GETMEMVAR','000006','000005','.EXE.','5','SalFam(aCodfol,@nSal_fami,"S",IIf( Empty(dDataDem),GetMemVar("RG_DATADEM"),dDataDem ))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALSALFA','CTIPOROT # "4"  .AND. LPGSALFAM','000007','000004','.CON.','5','','','5','CTIPOROT # "4"  .And. lPgSalFam','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALSALFA','SALFAM(ACODFOL,@NSAL_FAMI,"S")','000008','000007','.EXE.','5','SalFam(aCodfol,@nSal_fami,"S")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0096    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0096( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CALVLFER','CALCULA VALOR DAS FERIAS','','002223','011','2','1',} )

aAdd(aRc3Cols, { '','S_','CALVLFER','NPOS72 := FLOCALIAPD( ACODFOL[72,1] )','000001','000000','.EXE.','5','nPos72 := FLocaliaPd( aCodFol[72,1] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NPOS72 > 0','000002','000000','.CON.','5','','','5','nPos72 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NVFERIAS += FBUSCAPD( ACODFOL[72,1] )','000003','000002','.EXE.','5','nVFerias += fBuscaPd( aCodFol[72,1] )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NDIASFM > 0 .AND. NPOS72 == 0','000004','000000','.CON.','5','','','5','nDiasFM > 0 .And. nPos72 == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NVFERIAS += FGERAVERBA(ACODFOL[72,1], ROUND(NSALD1 * NDIASFM','000005','000004','.EXE.','5','nVFerias += FGeraVerba(aCodFol[72,1], Round(nSalD1 * nDiasFM,2), nDiasFM )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NPOS73 := FLOCALIAPD( ACODFOL[73,1] )','000006','000000','.EXE.','5','nPos73 := FLocaliaPd( aCodFol[73,1] )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NPOS73 > 0','000007','000000','.CON.','5','','','5','nPos73 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NVFERIASMS += FBUSCAPD( ACODFOL[73,1] )','000008','000007','.EXE.','5','nVFeriasMS += fBuscaPd( aCodFol[73,1] )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NDIASFMS > 0 .AND. NPOS73 == 0','000009','000000','.CON.','5','','','5','nDiasFMS > 0 .And. nPos73 == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NDIASFMS1 > 0','000010','000009','.CON.','5','','','5','nDiasFMS1 > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NVFERIASMS += FGERAVERBA(ACODFOL[73,1], ROUND(NSALD2 * NDIAS','000011','000010','.EXE.','5','nVFeriasMS += fGeraVerba(aCodFol[73,1], Round(nSalD2 * nDiasFMS,2), nDiasFMS,,,,,,,,,,,"1" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NVFERIASM3 += FGERAVERBA(ACODFOL[73,1], ROUND(NSALD1 * NDIAS','000012','000010','.EXE.','5','nVFeriasM3 += fGeraVerba(aCodFol[73,1], Round(nSalD1 * nDiasFMS1,2), nDiasFMS1,,,,,,,,,,,"2" )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NDIASFMS1 == 0','000013','000009','.CON.','5','','','5','nDiasFmS1 == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CALVLFER','NVFERIASMS += FGERAVERBA(ACODFOL[73,1], ROUND(NSALD2 * NDIAS','000014','000013','.EXE.','5','nVFeriasMS += fGeraVerba(aCodFol[73,1], Round(nSalD2 * nDiasFMS,2), nDiasFMS,,,,,,,,,,,"1" )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )


dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0097    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0097( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGAAPD','Carrega Verbas do Movto. para Calculo','','','012','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGAAPD','CFAUX := SRA->RA_FILIAL     .CNT.','000001','000000','.EXE.','5','CFAUX := SRA->RA_FILIAL','','','','','','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAAPD','CMATAUX := SRA->RA_MAT     .CNT.','000002','000000','.EXE.','5','CMATAUX := SRA->RA_MAT','','','','','','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAAPD','CPROCAUX := CPROCESSO     .CNT.','000003','000000','.EXE.','5','CPROCAUX := CPROCESSO','','','','','','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAAPD','LDISSIDIO .AND. FINDFUNCTION("GP690TRF")   .END.','000004','000000','.CON.','5','','','5','LDISSIDIO .AND. FINDFUNCTION("GP690TRF")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGAAPD','ADADOS := GP690TRF(SRA->RA_FILIAL, SRA->RA_MAT, CPERIODO )','000005','000004','.EXE.','5','ADADOS := GP690TRF(SRA->RA_FILIAL, SRA->RA_MAT, CPERIODO )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAAPD','CFAUX := ADADOS[1]     .CNT.','000006','000004','.EXE.','5','CFAUX := ADADOS[1]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAAPD','CMATAUX := ADADOS[2]     .CNT.','000007','000004','.EXE.','5','CMATAUX := ADADOS[2]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAAPD','CPROCAUX := ADADOS[3]     .END.','000008','000004','.EXE.','5','CPROCAUX := ADADOS[3]','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGAAPD','FCARMVTO(CFAUX,CMATAUX,CSEMANA,CPROCAUX,CPERIODO,CROT,CNUMPA','000009','000000','.EXE.','5','FCARMVTO(CFAUX,CMATAUX,CSEMANA,CPROCAUX,CPERIODO,CROT,CNUMPAG,GETCONVOCCALC(), Nil, GetBenOP())','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0098    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0098( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGADIS','CARGA DADOS DA MULTA DO DISSIDIO','','','006','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGADIS','NMESADISS := VAL(FDESC( "RCE", SRA->RA_SINDICA , "RCE_MESDIS','000001','000000','.EXE.','5','nMesADiss := Val(fDesc( "RCE", SRA->RA_SINDICA , "RCE_MESDIS" ))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','NMESADISS := IF(EMPTY(NMESADISS), 12, NMESADISS)','000002','000000','.EXE.','5','nMesADiss := If(Empty(nMesADiss), 12, nMesADiss)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','NDIADISS := FDESC( "RCE", SRA->RA_SINDICA, "RCE_DIADIS" )','000003','000000','.EXE.','5','nDiaDiss := fDesc( "RCE", SRA->RA_SINDICA, "RCE_DIADIS" )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','NDIADISS := IF(EMPTY(NDIADISS), 1, NDIADISS)','000004','000000','.EXE.','5','nDiaDiss := If(Empty(nDiaDiss), 1, nDiaDiss)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','AINCRES[2] == "T" .AND. !EMPTY( GETMEMVAR("RG_DTAVISO") )','000005','000000','.CON.','5','','','5','aIncRes[2] == "T" .and. !Empty( GetMemVar("RG_DTAVISO") )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','DDATAAUX := GETMEMVAR("RG_DTAVISO")','000006','000005','.EXE.','5','dDataAux := GetMemVar("RG_DTAVISO")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','DTERMINOAV := (DDATAAUX + NDIASAV)','000007','000005','.EXE.','5','dTerminoAv := (dDataAux + nDiasAv)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','DDATAAUX := CTOD(STR(NDIADISS) + STR(NMESADISS) + STR(YEAR(D','000008','000005','.EXE.','5','dDataAux := CtoD(Str(nDiaDiss) + Str(nMesADiss) + Str(Year(dDataAux)))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','!(AINCRES[2] == "T" .AND. !EMPTY(GETMEMVAR("RG_DTAVISO")))','000009','000000','.CON.','5','','','5','!(aIncRes[2] == "T" .And. !Empty(GetMemVar("RG_DTAVISO")))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','DDATAAUX := CTOD(STR(NDIADISS) + STR(NMESADISS) + STR(YEAR(D','000010','000009','.EXE.','5','dDataAux := CtoD(Str(nDiaDiss) + Str(nMesADiss) + Str(Year(dDatadem1)))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','DTERMINOAV := (GETMEMVAR("RG_DTPROAV"))','000011','000009','.EXE.','5','dTerminoAv := (GETMEMVAR("RG_DTPROAV"))','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','DDATAAUX := IF(DDATAAUX < DTERMINOAV, YEARSUM(DDATAAUX, 1),','000012','000000','.EXE.','5','dDataAux := If(dDataAux < dTerminoAv, YearSum(dDataAux, 1), dDataAux)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','DINIANTLDI := (DDATAAUX - 30)','000013','000000','.EXE.','5','dIniAntLDi := (dDataAux - 30)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGADIS','DFIMANTLDI := (DDATAAUX - 01)','000014','000000','.EXE.','5','dFimAntLDi := (dDataAux - 01)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0099    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0099( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCG','CARREGA DIAS DO MES DE BENEFICIO','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCG','LPROPADM := IF(CTIPOROT == "8",APERGUNTE[2,3] == 1, APERGUNT','000001','000000','.EXE.','5','lPropAdm := If(cTipoRot == "8",aPergunte[2,3] == 1, aPergunte[1,3] == 1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCG','FCARDIASMES(@ADIASMES,LPROPADM)','000002','000000','.EXE.','5','fCarDiasMes(@ADIASMES,lPropAdm)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0100    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0100( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARCH','CARREGA DADOS DO PERIODO','','','092','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARCH','CPERIODO := IF(EMPTY(CPERIODO),GETPERIODCALC(),CPERIODO)','000001','000000','.EXE.','5','cPeriodo := If(Empty(cPeriodo),GetPeriodCalc(),cPeriodo)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CSEMANA := CNUMPAG := IF(EMPTY(CNUMPAG),GETNUMPGCALC(),CNUMP','000002','000000','.EXE.','5','cSemana := cNumPag := If(Empty(cNumPag),GetNumPgCalc(),cNumPag)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CPROCESSO := SRA->RA_PROCES','000003','000000','.EXE.','5','cProcesso := SRA->RA_PROCES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CROT := IF(EMPTY(CROT),GETROTEXEC(),CROT)','000004','000000','.EXE.','5','cRot := If(Empty(cRot),GetRotExec(),cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CROT := IF(CROT=="INC",IF(SRA->RA_CATFUNC $ "P*A",FGETCALCRO','000005','000000','.EXE.','5','cRot := If(cRot=="INC",If(SRA->RA_CATFUNC $ "P*A",fGetCalcRot("9"),fGetRotOrdinar()),cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','FCARPERIODO( CPERIODO , CROT , @APERIODO, @LULTSEMANA, @NPOS','000006','000000','.EXE.','5','fCarPeriodo( cPeriodo , cRot , @aPeriodo, @lUltSemana, @nPosSem)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','P_DIASRES := IF(TYPE('+"'"+'P_DIASRES'+"'"+')<>'+"'"+'U'+"'"+', P_DIASRES, 0)','000007','000000','.EXE.','5','P_DIASRES := If(Type('+"'"+'P_DIASRES'+"'"+')<>'+"'"+'U'+"'"+', P_DIASRES, 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','P_DIASADM := If(Type('+"'"+'P_DIASADM'+"'"+')<>'+"'"+'U'+"'"+', P_DIASADM, 0)     .C','000008','000000','.EXE.','5','P_DIASADM := If(Type('+"'"+'P_DIASADM'+"'"+')<>'+"'"+'U'+"'"+', P_DIASADM, 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','P_LDSRHRSP := Type("P_LDSRHRSP") # "U" .And. P_LDSRHRSP','000009','000000','.EXE.','5','P_LDSRHRSP := Type("P_LDSRHRSP") # "U" .And. P_LDSRHRSP','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','LEN(APERIODO) > 0','000010','000000','.CON.','5','','','5','Len(aPeriodo) > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','DDATADE := APERIODO[NPOSSEM,3]','000011','000010','.EXE.','5','dDataDe := aPeriodo[nPosSem,3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','DDATAATE := APERIODO[NPOSSEM,4]','000012','000010','.EXE.','5','dDataAte := aPeriodo[nPosSem,4]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cComp13 := IIf( P_CCOMP13 == "S" .And. cRot == fGetCalcRot("','000013','000010','.EXE.','5','cComp13 := IIf( P_CCOMP13 == "S" .And. cRot == fGetCalcRot("1") .And. fTemROT132() .And. (fTem132Per() .Or. AnoMes(SRA->RA_ADMISSA) == cPeriodo), "S", "N")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','DTARINI := IF(EMPTY(APERIODO[NPOSSEM,22]),DDATADE,APERIODO[N','000014','000010','.EXE.','5','dTarIni := If(Empty(aPeriodo[nPosSem,22]),DdataDe,aPeriodo[nPosSem,22])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','DTARFIM := IF(EMPTY(APERIODO[NPOSSEM,23]),DDATAATE,APERIODO[','000015','000010','.EXE.','5','dTarFim := If(Empty(aPeriodo[nPosSem,23]),dDataAte,aPeriodo[nPosSem,23])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CANOMES  := APERIODO[NPOSSEM,15] + APERIODO[NPOSSEM,16]','000016','000010','.EXE.','5','cAnoMes  := aPeriodo[nPosSem,15] + aPeriodo[nPosSem,16]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','DDATA_PGTO := APERIODO[NPOSSEM,17]','000017','000010','.EXE.','5','dData_Pgto := aPeriodo[nPosSem,17]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','DDATAREF := CTOD("01/" + APERIODO[NPOSSEM,16] + "/" + APERIO','000018','000010','.EXE.','5','dDataRef := CTOD("01/" + aPeriodo[nPosSem,16] + "/" + aPeriodo[nPosSem,15])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CSITFOLH := FBUSCASITUACAO( SRA->RA_FILIAL , SRA->RA_MAT , D','000019','000010','.EXE.','5','cSitFolh := fBuscaSituacao( SRA->RA_FILIAL , SRA->RA_MAT , dDataDe)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NDIASC := IF(APERIODO[NPOSSEM,16] == "02" .AND. MONTH(SRA->R','000020','000010','.EXE.','5','NDIASC := IF(APERIODO[NPOSSEM,16]=="02" .AND. !P_PGSALFEV .AND. (!EMPTY(CSITFOLH) .OR. (DAY(SRA->RA_ADMISSA) > 01 .AND. (MONTH(SRA->RA_ADMISSA)==2 .AND. YEAR(SRA->RA_ADMISSA) == VAL(APERIODO[NPOSSEM,15])))),APERIODO[NPOSSEM,18], APERIODO[NPOSSEM,20])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cRot $ "ADI/FOL"   .END.','000021','000010','.CON.','5','','','5','cRot $ "ADI/FOL"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','SRA->RA_CATFUNC $ "M*E*H*I" .AND. DAY(SRA->RA_ADMISSA) > 1 .','000022','000021','.CON.','5','','','5','SRA->RA_CATFUNC $ "M*E*H*I" .AND. DAY(SRA->RA_ADMISSA) > 1 .AND. ANOMES(SRA->RA_ADMISSA) == CPERIODO .AND. APERIODO[NPOSSEM,16] <> "02"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NDIASC := IF( APERIODO[NPOSSEM,18] == 31 .AND. P_DIASADM ==','000023','000022','.EXE.','5','NDIASC := IF( APERIODO[NPOSSEM,18] == 31 .AND. P_DIASADM == 1, APERIODO[NPOSSEM,18], APERIODO[NPOSSEM,20])','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','SRA->RA_CATFUNC == "H" .AND. SRA->RA_CATEG == "07" .AND. LMA','000024','000021','.CON.','5','','','5','SRA->RA_CATFUNC == "H" .AND. SRA->RA_CATEG == "07" .AND. LMAPRENDIZ','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NDIASC := 30','000025','000024','.EXE.','5','NDIASC := 30','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','P_HRPONAPR','000026','000024','.CON.','5','','','5','P_HRPONAPR','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','P_LDSRHRSP := .F.','000027','000026','.EXE.','5','P_LDSRHRSP := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cRot == "RES"   .END.','000028','000010','.CON.','5','','','5','cRot == "RES"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NDIASC := IF( ((APERIODO[NPOSSEM,18] == 31 .OR. APERIODO[NPO','000029','000028','.EXE.','5','NDIASC := IF( ((APERIODO[NPOSSEM,18] == 31 .Or. APERIODO[NPOSSEM,16] == "02") .And. P_DIASRES = 1), APERIODO[NPOSSEM,18],If(P_DIASRES == 2, 30, APERIODO[NPOSSEM,20]))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','cCompl == "S" .And. LPROXMES .AND. P_DIASRES == 1','000030','000028','.CON.','5','','','5','cCompl == "S" .And. LPROXMES .AND. P_DIASRES == 1','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','APERIODO2 := {}','000031','000030','.EXE.','5','aPeriodo2 := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','LULTSEM2 := .F.','000032','000030','.EXE.','5','lUltSem2 := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NPOSSEM2 := 0','000033','000030','.EXE.','5','nPosSem2 := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','FCARPERIODO( ANOMES(DDATADEM) , CROT , @APERIODO2, @LULTSEM2','000034','000030','.EXE.','5','fCarPeriodo( AnoMes(dDataDem) , cRot , @aPeriodo2, @lUltSem2, @nPosSem2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NDIASC := IF( ((APERIODO2[NPOSSEM2,18] == 31 .OR. APERIODO2[','000035','000030','.EXE.','5','NDIASC := IF( ((APERIODO2[NPOSSEM2,18] == 31 .Or. APERIODO2[NPOSSEM2,16] == "02") .And. P_DIASRES = 1), APERIODO2[NPOSSEM2,18], APERIODO2[NPOSSEM2,20])','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','ISINCALLSTACK("GPEM070") .AND. SRA->RA_CATFUNC == "H"','000036','000010','.CON.','5','','','5','(IsInCallStack("GPEM070") .Or. IsInCallStack("GPM070GRD")) .AND. SRA->RA_CATFUNC == "H"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NDIASC := 30','000037','000036','.EXE.','5','NDIASC := 30','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','LCALCCOMPL := APERIODO[NPOSSEM,25] == "1"','000038','000010','.EXE.','5','lCalcCompl := aPeriodo[nPosSem,25] == "1"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NSVNORMAL := NORMAL := APERIODO[NPOSSEM,24] * SRA->RA_HRSDIA','000039','000010','.EXE.','5','NSVNORMAL := NORMAL := aPeriodo[nPosSem,24] * SRA->RA_HRSDIA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NSVDESCAN := DESCANSO := APERIODO[NPOSSEM,07] * SRA->RA_HRSD','000040','000010','.EXE.','5','NSVDESCAN := DESCANSO := aPeriodo[nPosSem,07] * SRA->RA_HRSDIA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NDIASC > 0 .AND. SRA->RA_HRSDIA > 0','000041','000010','.CON.','5','','','5','nDiasC > 0 .and. SRA->RA_HRSDIA > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NHRSCAL := ROUND((SRA->RA_HRSDIA * NDIASC),2)','000042','000041','.EXE.','5','nHrsCal := Round((SRA->RA_HRSDIA * nDiasC),2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','P_LDSRHRSP .AND. !(SRA->RA_TPCONTR == "3" .AND. P_NDSRHORI =','000043','000010','.CON.','5','','','5','P_LDSRHRSP .And. !(SRA->RA_TPCONTR == "3" .And. P_NDSRHORI == 3)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','DINITAB := MAX(SRA->RA_ADMISSA, DDATADE)','000044','000043','.EXE.','5','dIniTab := Max(SRA->RA_ADMISSA, dDataDe)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','fHTrabCalen( dIniTab, dDataAte )     .CNT.','000045','000043','.EXE.','5','fHTrabCalen( dIniTab, dDataAte )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','nHrsCal := Round( (nPonTrab + nPonDesc), 2)     .CNT.','000046','000043','.EXE.','5','nHrsCal := Round( (nPonTrab + nPonDesc), 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','nHrsCal == 0   .END.','000047','000043','.CON.','5','','','5','nHrsCal == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','nHrsCal := Round((SRA->RA_HRSDIA * nDiasC),2)     .CNT.','000048','000047','.EXE.','5','nHrsCal := Round((SRA->RA_HRSDIA * nDiasC),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','nPonTrab := NORMAL := NSVNORMAL     .CNT.','000049','000047','.EXE.','5','nPonTrab := NORMAL := NSVNORMAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','nPonDesc := DESCANSO := NSVDESCAN     .END.','000050','000047','.EXE.','5','nPonDesc := DESCANSO := NSVDESCAN','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','LCALCCOMPL','000051','000010','.CON.','5','','','5','lCalcCompl','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','!FVERCOMPL()','000052','000051','.CON.','5','','','5','!fVerCompl()','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','FINALCALC()','000053','000052','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NDIASP := IF(APERIODO[NPOSSEM,16]=="02" .AND. P_PGSALFEV .AN','000054','000010','.EXE.','5','NDIASP := IF(APERIODO[NPOSSEM,16]=="02" .AND. P_PGSALFEV .AND. (!EMPTY(CSITFOLH) .OR. (DAY(SRA->RA_ADMISSA) > 01 .AND. (MONTH(SRA->RA_ADMISSA)== 2 .AND. YEAR(SRA->RA_ADMISSA) == VAL(APERIODO[NPOSSEM,15])))),APERIODO[NPOSSEM,20], APERIODO[NPOSSEM,18])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','P_NTOTDIAS := IF(P_NTOTDIAS == 0, 7, P_NTOTDIAS)','000055','000010','.EXE.','5','P_nTotDias := If(P_nTotDias == 0, 7, P_nTotDias)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','FPOSREG("SRY", 1, XFILIAL("SRY") + CROT)','000056','000010','.EXE.','5','fPosReg("SRY", 1, xFIlial("SRY") + cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CTIPOROT := SRY->RY_TIPO','000057','000010','.EXE.','5','cTipoRot := SRY->RY_TIPO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','(CTIPOROT = '+"'"+'1'+"'"+') .AND. MONTH(DDATAATE) == 12 .AND. !FCOMP13F','000058','000000','.CON.','5','','','5','(CTIPOROT = '+"'"+'1'+"'"+') .And. Month(dDataAte) == 12 .And. !FCOMP13FOL()','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CMSGLOG := FMSGFORM({}) + "O PERIODO '+"'"+'" + CPERIODO + "'+"'"+' N?O','000059','000058','.EXE.','5','CMSGLOG := FMSGFORM({}) + "O PERIODO '+"'"+'" + CPERIODO + "'+"'"+' N?O EST? FECHADO PARA 13 SAL?RIO. FECHE O PERIODO PARA QUE SEJA POSSIVEL CALCULAR O COMPLEMENTO PARA 13 SAL?RIO."','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','ADDLOGEXECROT( CMSGLOG )','000060','000058','.EXE.','5','ADDLOGEXECROT( CMSGLOG )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CFILCALC := "#####"','000061','000058','.EXE.','5','CFILCALC := "#####"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','XFILIAL("RCH") <> XFILIAL("RCJ")','000062','000058','.CON.','5','','','5','xFilial("RCH") <> xFilial("RCJ")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NOPRCREG()','000063','000062','.EXE.','5','NoPrcReg()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','XFILIAL("RCH") == XFILIAL("RCJ")','000064','000058','.CON.','5','','','5','xFilial("RCH") == xFilial("RCJ")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','FINALCALC()','000065','000064','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','LEN(APERIODO) <= 0 .OR. EMPTY(DDATAREF) .OR. EMPTY(CANOMES)','000066','000000','.CON.','5','','','5','Len(aPeriodo) <= 0 .OR. EMPTY(DDATAREF) .OR. EMPTY(CANOMES) .OR. EMPTY(DDATADE) .OR. EMPTY(DDATAATE) .OR. EMPTY(DDATA_PGTO) .OR. ( cTipoRot <> '+"'"+'9'+"'"+' .AND. (EMPTY(NORMAL) ) .AND. !P_LDSRHRSP )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','( CFILCALC <> SRA->RA_FILIAL .AND. CFILCALC <> "#####" ) .OR','000067','000066','.CON.','5','','','5','( cFilCalc <> SRA->RA_FILIAL .and. cFilCalc <> "#####" ) .or. ( cTipoRot <> '+"'"+'9'+"'"+' .AND. (Empty(NORMAL) ) .and. !P_LDSRHRSP )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CMSGLOG := FMSGFORM({}) + "A CONFIGURACAO DOS PERIODOS ESTA','000068','000067','.EXE.','5','CMSGLOG := FMSGFORM({}) + "A configuracao dos campos do periodo ou do funcionario esta incorreta. Verifique o cadastro de periodos. Processo: " + cProcesso + ". Filial: " + SRA->RA_FILIAL + " e o funcionario " + SRA->RA_MAT','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','ADDLOGEXECROT( CMSGLOG )','000069','000067','.EXE.','5','AddLogExecRot( cMsgLog )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CMSGLOG := FMSGFORM({}) + "CONFIRA O CONTEUDO DOS CAMPOS: RF','000070','000067','.EXE.','5','CMSGLOG := FMSGFORM({}) + "CONFIRA O CONTEUDO DOS CAMPOS DO CADASTRO DE PERIODOS: RFQ_MES / RFQ_DTINI / RFQ_DTFIM / RCH_DTPAGO / RCH_PERSEL / RCH_STATUS / RCF_DUTEIS / RCF_DIASDSR"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','ADDLOGEXECROT( CMSGLOG )','000071','000067','.EXE.','5','AddLogExecRot( cMsgLog )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CMSGLOG := FMSGFORM({}) + "CONFIRA O CONTEUDO DOS CAMPOS: RF','000072','000067','.EXE.','5','CMSGLOG := FMSGFORM({}) + "CONFIRA O CONTEUDO DOS CAMPOS DO CADASTRO DE FUNCIONARIOS: RA_HRSDIA"','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','ADDLOGEXECROT( CMSGLOG )','000073','000067','.EXE.','5','AddLogExecRot( cMsgLog )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CFILCALC := "#####"','000074','000067','.EXE.','5','cFilCalc := "#####"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','XFILIAL("RCH") <> XFILIAL("RCJ")','000075','000066','.CON.','5','','','5','xFilial("RCH") <> xFilial("RCJ")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NOPRCREG()','000076','000075','.EXE.','5','NoPrcReg()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','XFILIAL("RCH") == XFILIAL("RCJ")','000077','000066','.CON.','5','','','5','xFilial("RCH") == xFilial("RCJ")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','FINALCALC()','000078','000077','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CTIPOROT <> "3" .AND. LEN(APERIODO) > 0 .AND. APERIODO[NPOSS','000079','000000','.CON.','5','','','5','cTipoRot <> "3" .AND. LEN(APERIODO) > 0 .AND. APERIODO[NPOSSEM,26] <> "1" .AND. !LDISSIDIO .AND. !LRESCDIS .AND. ( CTIPOROT <> '+"'"+'4'+"'"+' .OR. M->RG_EFETIVA = '+"'"+'S'+"'"+') .AND. CTIPOROT <> '+"'"+'C'+"'"+' .AND. !(IsInCallStack("GPEM070") .Or. IsInCallStack("GPM070GRD"))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','(!(CTIPOROT = '+"'"+'6'+"'"+') .AND. P_CCOMP13 = '+"'"+'N'+"'"+')','000080','000079','.CON.','5','','','5','(!(cTipoRot = '+"'"+'6'+"'"+') .And. P_CCOMP13 = '+"'"+'N'+"'"+' .And. !lCalcFol)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CFILCALC <> SRA->RA_FILIAL .AND. CFILCALC <> "#####"','000081','000080','.CON.','5','','','5','cFilCalc <> SRA->RA_FILIAL .and. cFilCalc <> "#####"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CMSGLOG := FMSGFORM({}) + "O PERIODO '+"'"+'" + CPERIODO + "'+"'"+' NAO','000082','000081','.EXE.','5','CMSGLOG := FMSGFORM({}) + "O periodo '+"'"+'" + cPeriodo + "'+"'"+' n?o est? ativo. Selecione um periodo ativo para o c?lculo. Processo -> " + cProcesso + ". Filial -> " + SRA->RA_FILIAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','ADDLOGEXECROT( CMSGLOG )','000083','000081','.EXE.','5','AddLogExecRot( cMsgLog )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','CFILCALC := "#####"','000084','000081','.EXE.','5','cFilCalc := "#####"','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','XFILIAL("RCH") <> XFILIAL("RCJ")','000085','000080','.CON.','5','','','5','xFilial("RCH") <> xFilial("RCJ")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','NOPRCREG()','000086','000085','.EXE.','5','NoPrcReg()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','XFILIAL("RCH") == XFILIAL("RCJ")','000087','000080','.CON.','5','','','5','xFilial("RCH") == xFilial("RCJ")','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARCH','FINALCALC()','000088','000087','.EXE.','5','FINALCALC()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0101    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0101( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGARI1','CARREGA BENEFICIOS DO FUNCIONARIO','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGARI1','!FCARGARI1(@ABENRI1)','000001','000000','.CON.','5','','','5','!fCargaRI1(@aBenRI1)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARGARI1','NOPRCREG()','000002','000001','.EXE.','5','NoPrcReg()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0102    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0102( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARGASR7','CARGA SR7 - GFP','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CARGASR7','aSR7 := CategSR7( SRA->RA_FILIAL, SRA->RA_MAT, dDataDe, dDat','000001','000000','.EXE.','5','aSR7 := CategSR7( SRA->RA_FILIAL, SRA->RA_MAT, dDataDe, dDataAte )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0103    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0103( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARPARMR','CARREGA PAR.MEDIA ROT. RESC. - GFP','','','001','2','1',} )

aAdd(aRc3Cols, { '','S_','CARPARMR','dDt1 := SRF->RF_DATABAS   .CNT.','000001','000000','.EXE.','5','dDt1',':=','5','SRF->RF_DATABAS','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARMR','dDt2 := CTOD("")   .CNT.','000002','000000','.EXE.','5','dDt2',':=','5','CTOD("")','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARMR','dDt3 := dDataDem   .CNT.','000003','000000','.EXE.','5','dDt3',':=','5','dDataDem','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARMR','dDt4 := dDataDem   .CNT.','000004','000000','.EXE.','5','dDt4',':=','5','dDataDem','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARMR','dDt5 := dDataDem   .CNT.','000005','000000','.EXE.','5','dDt5',':=','5','dDataDem','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARMR','lMesAtu := If(GetMemVar("RG_MEDATU")  == "S", .T. , .F.)   .','000006','000000','.EXE.','5','lMesAtu',':=','5','If(GetMemVar("RG_MEDATU")  == "S", .T. , .F.)','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARPARMR','lMovto := .T.   .END.','000007','000000','.EXE.','5','lMovto',':=','5','.T.','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0104    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0104( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CARRCHFE','CARREGA DADOS DO PERIODO DE FERIAS','','084252','044','2','1',} )

aAdd(aRc3Cols, { '','S_','CARRCHFE','CPERIODO := IF(EMPTY(CPERIODO),GETPERIODCALC(),CPERIODO)','000001','000000','.EXE.','5','CPERIODO := IF(EMPTY(CPERIODO),GETPERIODCALC(),CPERIODO)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CPERIODO := IF( ANOMES(GETMEMVAR("RH_DATAINI")) > CPERIODO,','000002','000000','.EXE.','5','CPERIODO := IF( ANOMES(GETMEMVAR("RH_DATAINI")) > CPERIODO, ANOMES(GETMEMVAR("RH_DATAINI")), CPERIODO )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CSEMANA := CNUMPAG := IF(EMPTY(CNUMPAG),GETNUMPGCALC(),CNUMP','000003','000000','.EXE.','5','CSEMANA := CNUMPAG := IF(EMPTY(CNUMPAG),GETNUMPGCALC(),CNUMPAG)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CPROCESSO := SRA->RA_PROCES','000004','000000','.EXE.','5','CPROCESSO := SRA->RA_PROCES','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CROT := IF(EMPTY(CROT),GETROTEXEC(),CROT)','000005','000000','.EXE.','5','CROT := IF(EMPTY(CROT),GETROTEXEC(),CROT)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','!FCARPERIODO( CPERIODO , CROT , @APERIODO, @LULTSEMANA, @NPO','000006','000000','.CON.','5','','','5','!FCARPERIODO( CPERIODO , CROT , @APERIODO, @LULTSEMANA, @NPOSSEM)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FINALCALC()','000007','000006','.EXE.','5','FINALCALC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FIMFORMULA()','000008','000006','.EXE.','5','FimFormula()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','DDATADE := APERIODO[NPOSSEM,3]','000009','000000','.EXE.','5','dDataDe := aPeriodo[nPosSem,3]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','DDATAATE := APERIODO[NPOSSEM,4]','000010','000000','.EXE.','5','dDataAte := aPeriodo[nPosSem,4]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NSVNORMAL := NORMAL := APERIODO[NPOSSEM,24] * SRA->RA_HRSDIA','000011','000000','.EXE.','5','NSVNORMAL := NORMAL := aPeriodo[nPosSem,24] * SRA->RA_HRSDIA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NSVDESCAN := DESCANSO := APERIODO[NPOSSEM,07] * SRA->RA_HRSD','000012','000000','.EXE.','5','NSVDESCAN := DESCANSO := aPeriodo[nPosSem,07] * SRA->RA_HRSDIA','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','P_LDSRHRSP   .END.','000013','000000','.CON.','5','','','5','P_LDSRHRSP','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','DINITAB := MAX(SRA->RA_ADMISSA, DDATADE)     .END.','000014','000013','.EXE.','5','DINITAB := MAX(SRA->RA_ADMISSA, DDATADE)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FHTRABCALEN( DINITAB, DDATAATE )     .CNT.','000015','000013','.EXE.','5','FHTRABCALEN( DINITAB, DDATAATE )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NHRSCAL := ROUND( (NPONTRAB + NPONDESC), 2)     .CNT.','000016','000013','.EXE.','5','NHRSCAL := ROUND( (NPONTRAB + NPONDESC), 2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NHRSCAL == 0   .END.','000017','000013','.CON.','5','','','5','NHRSCAL == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NHRSCAL := ROUND((SRA->RA_HRSDIA * NDIASC),2)     .END.','000018','000017','.EXE.','5','NHRSCAL := ROUND((SRA->RA_HRSDIA * NDIASC),2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NPONTRAB := NORMAL := NSVNORMAL     .END.','000019','000017','.EXE.','5','NPONTRAB := NORMAL := NSVNORMAL','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NPONDESC := DESCANSO := NSVDESCAN     .END.','000020','000017','.EXE.','5','NPONDESC := DESCANSO := NSVDESCAN','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CANOMES := APERIODO[NPOSSEM,15] + APERIODO[NPOSSEM,16]','000021','000000','.EXE.','5','cAnoMes := aPeriodo[nPosSem,15] + aPeriodo[nPosSem,16]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','DDATA_PGTO := APERIODO[NPOSSEM,17]','000022','000000','.EXE.','5','dData_Pgto := aPeriodo[nPosSem,17]','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASC := IF(APERIODO[NPOSSEM,16] ==','000023','000000','.EXE.','5','NDIASC := IF(APERIODO[NPOSSEM,16] == "02" .AND. !P_PGSALFEV,APERIODO[NPOSSEM,18],APERIODO[NPOSSEM,20])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','DDATAREF := CTOD("01/" + APERIODO[NPOSSEM,16] + "/" + APERIO','000024','000000','.EXE.','5','dDataRef := CtoD("01/" + aPeriodo[nPosSem,16] + "/" + aPeriodo[nPosSem,15])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASPERF1 := IF(APERIODO[NPOSSEM,16] == "02",APERIODO[NPOSS','000025','000000','.EXE.','5','NDIASPERF1 := IF(APERIODO[NPOSSEM,16] == "02" .AND. !P_PGSALFEV,APERIODO[NPOSSEM,18],APERIODO[NPOSSEM,20])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASFM := IF( GETMEMVAR("RH_DATAFIM") == GETMEMVAR("RH_DATA','000026','000000','.EXE.','5','nDiasFM := If( GetMemVar("RH_DATAFIM") == GetMemVar("RH_DATAINI") .and. GetMemVar("RH_DFERIAS") == 0 .and. GetMemVar("RH_DABONPE") > 0, 0, Min(aPeriodo[nPosSem,4] , GetMemVar("RH_DATAFIM")) - GetMemVar("RH_DATAINI") + 1 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','LPROXMES := ANOMES(GETMEMVAR("RH_DATAINI")) <> ANOMES(GETMEM','000027','000000','.EXE.','5','lProxMes := AnoMes(GetMemVar("RH_DATAINI")) <> AnoMes(GetMemVar("RH_DATAFIM"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','LPERFERJFM := .F.','000028','000000','.EXE.','5','lPerFerJFM := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CSITFOLH := FBUSCASITUACAO( SRA->RA_FILIAL , SRA->RA_MAT , D','000029','000000','.EXE.','5','cSitFolh := fBuscaSituacao( SRA->RA_FILIAL , SRA->RA_MAT , dDataDe)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','!LPROXMES','000030','000000','.CON.','5','','','5','!lProxMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASABM := IF(GETMEMVAR("RH_ABOPEC") == "1",GETMEMVAR("RH_D','000031','000030','.EXE.','5','nDiasAbM := If(GetMemVar("RH_ABOPEC") == "1",GetMemVar("RH_DABONPE"),(If( GetMemVar("RH_DABONPE") > ( aPeriodo[nPosSem,4] - GetMemVar("RH_DATAFIM") ) , aPeriodo[nPosSem,4] - GetMemVar("RH_DATAFIM") , GetMemVar("RH_DABONPE"))))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASABMS := IF(GETMEMVAR("RH_ABOPEC") == "1",0,GETMEMVAR("R','000032','000030','.EXE.','5','nDiasAbMs := If(GetMemVar("RH_ABOPEC") == "1",0,GetMemVar("RH_DABONPE")-nDiasAbM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASFMS := 0','000033','000030','.EXE.','5','nDiasFMS := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASFM -= ( GETMEMVAR("RH_DIALREM") )','000034','000030','.EXE.','5','nDiasFM -= ( GetMemVar("RH_DIALREM") )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASABMS > 0','000035','000030','.CON.','5','','','5','nDiasABMS > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NORDERAUX := RCH->(INDEXORD())','000036','000035','.EXE.','5','nOrderAux := RCH->(IndexOrd())','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','RCH->(DBSETORDER( RETORDER("RCH" , "RCH_FILIAL + RCH_PROCES','000037','000035','.EXE.','5','RCH->(DbSetOrder( RetOrder("RCH" , "RCH_FILIAL + RCH_PROCES + RCH_ROTEIR + RCH_PER + RCH_NUMPAG")))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','RCH->(DBSEEK(XFILIAL("RCH")+CPROCESSO+CROT+CPERIODO+APERIODO','000038','000035','.EXE.','5','RCH->(DbSeek(xFilial("RCH")+cProcesso+cRot+cPeriodo+aPeriodo[nPosSem,2]))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','RCH->(DBSKIP())','000039','000035','.EXE.','5','RCH->(DbSkip())','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','RCH->RCH_ROTEIR # CROT .OR. RCH->RCH_PROCES # CPROCESSO .OR.','000040','000035','.CON.','5','','','5','RCH->RCH_ROTEIR # cRot .or. RCH->RCH_PROCES # cProcesso .or. RCH->RCH_DTINI - 1 <> aPeriodo[nPosSem,4]','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CMSGLOG := FMSGFORM({}) + "A CONFIGURACAO DOS PERIODOS ESTA','000041','000040','.EXE.','5','CMSGLOG := FMSGFORM({}) + "A CONFIGURAÇÃO DOS PERIODOS ESTÁ INCORRETA OU NÃO EXISTEM DADOS VÁLIDOS PARA O PERÍODO QUE ESTÁ SENDO CALCULADO. VERIFIQUE SE EXISTE PERÍODO QUE CORRESPONDA A DATA FINAL DAS FÉRIAS."','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','S_MSGLOG()','000042','000040','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FINALCALC()','000043','000040','.EXE.','5','FINALCALC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FIMFORMULA()','000044','000040','.EXE.','5','FimFormula()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','APERIODO := {}','000045','000035','.EXE.','5','aPeriodo := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FCARPERIODO( RCH->RCH_PER , CROT , @APERIODO, @LULTSEMANA, @','000046','000035','.EXE.','5','FCARPERIODO( RCH->RCH_PER , CROT , @APERIODO, @LULTSEMANA, @NPOSSEM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASPERF2 := APERIODO[NPOSSEM,20]','000047','000035','.EXE.','5','NDIASPERF2 := IF(APERIODO[NPOSSEM,16] == "02" .AND. !P_PGSALFEV,APERIODO[NPOSSEM,18],APERIODO[NPOSSEM,20])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','RCH->(DBSETORDER(NORDERAUX))','000048','000035','.EXE.','5','RCH->(DbSetOrder(nOrderAux))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','APERIODO := {}','000049','000035','.EXE.','5','aPeriodo := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FCARPERIODO( CPERIODO , CROT , @APERIODO, @LULTSEMANA, @NPOS','000050','000035','.EXE.','5','FCARPERIODO( CPERIODO , CROT , @APERIODO, @LULTSEMANA, @NPOSSEM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','LPROXMES','000051','000000','.CON.','5','','','5','lProxMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','APERIODO := {}','000052','000051','.EXE.','5','aPeriodo := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NRECRCH := FNEXTPER(CPROCESSO,CANOMES,CROT)','000053','000051','.EXE.','5','nRecRCH := fNextPer(CPROCESSO,CANOMES,cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NRECRCH > 0','000054','000051','.CON.','5','','','5','nRECRCH > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','RCH->(DBGOTO(NRECRCH))','000055','000054','.EXE.','5','RCH->(DbGoto(nRECRCH))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CSEMANA :=  RCH->RCH_NUMPAG','000056','000054','.EXE.','5','CSEMANA :=  RCH->RCH_NUMPAG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','(NRECRCH <= 0) .OR. (LULTSEMANA .AND. STOD(ANOMES(RCH->RCH_D','000057','000051','.CON.','5','','','5','(nRECRCH <= 0) .Or. (LULTSEMANA .AND. sToD(anomes(RCH->RCH_DTINI) + '+"'"+'01'+"'"+') - 1 <> DDATAATE)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CMSGLOG := FMSGFORM({}) + "A CONFIGURACAO DOS PERIODOS ESTA','000058','000057','.EXE.','5','CMSGLOG := FMSGFORM({}) + "A CONFIGURAÇÃO DOS PERIODOS ESTÁ INCORRETA OU NÃO EXISTEM DADOS VÁLIDOS PARA O PERÍODO QUE ESTÁ SENDO CALCULADO. VERIFIQUE SE EXISTE PERÍODO QUE CORRESPONDA A DATA FINAL DAS FÉRIAS."','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','S_MSGLOG()','000059','000057','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FINALCALC()','000060','000057','.EXE.','5','FINALCALC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FIMFORMULA()','000061','000057','.EXE.','5','FimFormula()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASFM -= GETMEMVAR("RH_DIALREM")','000062','000051','.EXE.','5','NDIASFM -= GETMEMVAR("RH_DIALREM")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FCARPERIODO( RCH->RCH_PER , CROT , @APERIODO, @LULTSEMANA, @','000063','000051','.EXE.','5','FCARPERIODO( RCH->RCH_PER , CROT , @APERIODO, @LULTSEMANA, @NPOSSEM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','EMPTY(APERIODO)','000064','000051','.CON.','5','','','5','EMPTY(APERIODO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CMSGLOG := FMSGFORM({}) + "A CONFIGURACAO DOS PERIODOS ESTA','000065','000064','.EXE.','5','CMSGLOG := FMSGFORM({}) + "A CONFIGURAÇÃO DOS PERIODOS ESTÁ INCORRETA OU NÃO EXISTEM DADOS VÁLIDOS PARA O PERÍODO QUE ESTÁ SENDO CALCULADO. VERIFIQUE SE EXISTE PERÍODO QUE CORRESPONDA A DATA FINAL DAS FÉRIAS."','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','S_MSGLOG()','000066','000064','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FINALCALC()','000067','000064','.EXE.','5','FINALCALC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FIMFORMULA()','000068','000064','.EXE.','5','FimFormula()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASPERF2 := APERIODO[NPOSSEM,20]','000069','000051','.EXE.','5','NDIASPERF2 := IF(APERIODO[NPOSSEM,16] == "02" .AND. !P_PGSALFEV,APERIODO[NPOSSEM,18],APERIODO[NPOSSEM,20])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','GETMEMVAR("RH_ABOPEC") == "1"','000070','000051','.CON.','5','','','5','GetMemVar("RH_ABOPEC") == "1"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASABM := GETMEMVAR("RH_DABONPE")','000071','000070','.EXE.','5','nDiasAbM := GetMemVar("RH_DABONPE")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','LPROXMES := MESANO(GETMEMVAR("RH_DATAFIM")) <> MESANO(APERIO','000072','000051','.EXE.','5','lProxMes := MesAno(GetMemVar("RH_DATAFIM")) <> MesAno(aPeriodo[nPosSem,4])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','!LPROXMES','000073','000051','.CON.','5','','','5','!lProxMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','SRA->RA_TIPOPGT == "S"','000074','000073','.CON.','5','','','5','SRA->RA_TIPOPGT == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASFMS := ( GETMEMVAR("RH_DATAFIM") - FIRSTDAY(APERIODO[NP','000075','000074','.EXE.','5','nDiasFMS := ( GetMemVar("RH_DATAFIM") - firstday(aPeriodo[nPosSem,3]) + 1 ) - ( GetMemVar("RH_DIALRE1") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','SRA->RA_TIPOPGT <> "S"','000076','000073','.CON.','5','','','5','SRA->RA_TIPOPGT <> "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASFMS := ( GETMEMVAR("RH_DATAFIM") - APERIODO[NPOSSEM,3]','000077','000076','.EXE.','5','nDiasFMS := ( GetMemVar("RH_DATAFIM") - aPeriodo[nPosSem,3] + 1 ) - ( GetMemVar("RH_DIALRE1") )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASABMS := IF(GETMEMVAR("RH_ABOPEC") == "1",GETMEMVAR("RH_','000078','000073','.EXE.','5','nDiasAbMs := If(GetMemVar("RH_ABOPEC") == "1",GetMemVar("RH_DABONPE")-nDiasABM,(If(GetMemVar("RH_DABONPE")-nDiasABM>(aPeriodo[nPosSem,4]-GetMemVar("RH_DATAFIM")),aPeriodo[nPosSem,4]-GetMemVar("RH_DATAFIM"),GetMemVar("RH_DABONPE")-nDiasABM)))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASABMS1 := GETMEMVAR("RH_DABONPE") - NDIASABM - NDIASABMS','000079','000073','.EXE.','5','nDiasAbMs1 := GetMemVar("RH_DABONPE") - nDiasABM - nDiasABMS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','LPROXMES','000080','000051','.CON.','5','','','5','lProxMes','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','LPERFERJFM := .T.','000081','000080','.EXE.','5','lPerFerJFM := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','GETMEMVAR("RH_DIALREM") + GETMEMVAR("RH_DIALRE1") > 0','000082','000080','.CON.','5','','','5','GETMEMVAR("RH_DIALREM") + GETMEMVAR("RH_DIALRE1") > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASLMS := ( GETMEMVAR("RH_DIALREM") + GETMEMVAR("RH_DIALRE','000083','000082','.EXE.','5','nDiasLMS := ( GETMEMVAR("RH_DIALREM") + GETMEMVAR("RH_DIALRE1") ) - Day(GETMEMVAR("RH_DATAFIM"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASLMS1 := ( GETMEMVAR("RH_DIALREM") + GETMEMVAR("RH_DIALR','000084','000082','.EXE.','5','nDiasLMS1 := ( GETMEMVAR("RH_DIALREM") + GETMEMVAR("RH_DIALRE1") ) - nDiasLMS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASFMS := MAX((APERIODO[NPOSSEM,4] - APERIODO[NPOSSEM,3] +','000085','000080','.EXE.','5','nDiasFMS := Max((aPeriodo[nPosSem,4] - aPeriodo[nPosSem,3] + 1) - nDiasLMS, 0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASABMS := MAX(IF(GETMEMVAR("RH_ABOPEC") == "1",GETMEMVAR(','000086','000080','.EXE.','5','nDiasAbMs := Max(If(GetMemVar("RH_ABOPEC") == "1",GetMemVar("RH_DABONPE")-nDiasABM,(If(GetMemVar("RH_DABONPE")-nDiasABM>(aPeriodo[nPosSem,4]-GetMemVar("RH_DATAFIM")),aPeriodo[nPosSem,4]-GetMemVar("RH_DATAFIM"),GetMemVar("RH_DABONPE")-nDiasABM))),0)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASABMS1 := GETMEMVAR("RH_DABONPE") - NDIASABM - NDIASABMS','000087','000080','.EXE.','5','nDiasAbMs1 := GetMemVar("RH_DABONPE") - nDiasABM - nDiasABMS','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NRECRCH := FNEXTPER(CPROCESSO,APERIODO[NPOSSEM,15] + APERIOD','000088','000080','.EXE.','5','nRecRCH := fNextPer(CPROCESSO,APERIODO[NPOSSEM,15] + APERIODO[NPOSSEM,16],cRot)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NRECRCH > 0','000089','000080','.CON.','5','','','5','nRECRCH > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','RCH->(DBGOTO(NRECRCH))','000090','000089','.EXE.','5','RCH->(DbGoto(nRECRCH))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CSEMANA :=  RCH->RCH_NUMPAG','000091','000089','.EXE.','5','CSEMANA :=  RCH->RCH_NUMPAG','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NRECRCH <= 0','000092','000080','.CON.','5','','','5','nRECRCH <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','CMSGLOG := FMSGFORM({}) + "A CONFIGURACAO DOS PERIODOS ESTA','000093','000092','.EXE.','5','CMSGLOG := FMSGFORM({}) + "A CONFIGURAÇÃO DOS PERIODOS ESTÁ INCORRETA OU NÃO EXISTEM DADOS VÁLIDOS PARA O PERÍODO QUE ESTÁ SENDO CALCULADO. VERIFIQUE SE EXISTE PERÍODO QUE CORRESPONDA A DATA FINAL DAS FÉRIAS."','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','S_MSGLOG()','000094','000092','.EXE.','5','S_MSGLOG()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FINALCALC()','000095','000092','.EXE.','5','FINALCALC()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FIMFORMULA()','000096','000092','.EXE.','5','FimFormula()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','APERIODO := {}','000097','000080','.EXE.','5','aPeriodo := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FCARPERIODO( RCH->RCH_PER , CROT , @APERIODO, @LULTSEMANA, @','000098','000080','.EXE.','5','FCARPERIODO( RCH->RCH_PER , CROT , @APERIODO, @LULTSEMANA, @NPOSSEM)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','NDIASFMS1 := MAX(( GETMEMVAR("RH_DATAFIM") - APERIODO[NPOSSE','000099','000080','.EXE.','5','nDiasFMS1 := Max(( GetMemVar("RH_DATAFIM") - aPeriodo[nPosSem,3] + 1 ) -  nDiasLMS1, 0)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','RCH->(DBSETORDER(NORDERAUX))','000100','000051','.EXE.','5','RCH->(DbSetOrder(nOrderAux))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','APERIODO := {}','000101','000051','.EXE.','5','aPeriodo := {}','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CARRCHFE','FCARPERIODO( CPERIODO , CROT , @APERIODO, @LULTSEMANA, @NPOS','000102','000051','.EXE.','5','FCARPERIODO( CPERIODO , CROT , @APERIODO, @LULTSEMANA, @NPOSSEM)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

aAdd(aItensSYP, { '','084252','001','000341 - carlos.capeli -  05/07/2008 / 22:30 - Inclusão                         ','CW8_HISTOR',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0105    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0105( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CAVISOIN','CALCULO AVISO PREVIO INDENIZADO','','','044','2','1',} )

aAdd(aRc3Cols, { '','S_','CAVISOIN','NBKPAV := NDIASAV     .CNT.','000001','000000','.EXE.','5','NBKPAV := NDIASAV','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nSavIns := nIntInsal     .CNT.','000002','000000','.EXE.','5','nSavIns := nIntInsal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nSavPer := nIntPercul     .CNT.','000003','000000','.EXE.','5','nSavPer := nIntPercul','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nIntInsal := If( Type('+"'"+'nIntResIns'+"'"+') <> "U" .And. nIntResIns','000004','000000','.EXE.','5','nIntInsal := If( Type('+"'"+'nIntResIns'+"'"+') <> "U" .And. nIntResIns > 0, nIntResIns, nIntInsal )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nIntPercul := If( Type('+"'"+'nIntResPer'+"'"+') <> "U" .And. nIntResPer','000005','000000','.EXE.','5','nIntPercul := If( Type('+"'"+'nIntResPer'+"'"+') <> "U" .And. nIntResPer > 0, nIntResPer, nIntPercul )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux := 0     .CNT.','000006','000000','.EXE.','5','nPosAux := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','lAdcsResc := Len(aCodFol) >= 1680 .And. !Empty(aCodFol[1680,','000007','000000','.EXE.','5','lAdcsResc := Len(aCodFol) >= 1680 .And. !Empty(aCodFol[1680,1])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVATS := 0','000008','000000','.EXE.','5','nValAvAts := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVPER := 0','000009','000000','.EXE.','5','nValAvPer := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVINS := 0','000010','000000','.EXE.','5','nValAvIns := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVCON := 0','000011','000000','.EXE.','5','nValAvCon := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVTRA := 0','000012','000000','.EXE.','5','nValAvTra := 0','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LVB250 := !EMPTY(ACODFOL[250,1])','000013','000000','.EXE.','5','LVB250 := !EMPTY(ACODFOL[250,1])','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LPGSABDOM := NDIAINDE == 0 .AND. LSABDOM','000014','000000','.EXE.','5','LPGSABDOM := NDIAINDE == 0 .AND. LSABDOM','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','SRA->RA_CATFUNC == "H" .AND. LHOJORVA   .END.','000015','000000','.CON.','5','','','5','SRA->RA_CATFUNC == "H" .AND. LHOJORVA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NAXSAL := SALARIO     .CNT.','000016','000015','.EXE.','5','NAXSAL := SALARIO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','SALARIO := nSalMesAp     .END.','000017','000015','.EXE.','5','SALARIO := nSalMesAp','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','CCOMPL == "S" .AND. LPROXMES .AND. ASCAN( APDRESC, { |X| X[1','000018','000000','.CON.','5','','','5','cCompl == "S" .And. lProxMes .And. aScan( aPdResc, { |x| x[1] == aCodFol[0250,1] } ) == 0 .and. NMEDAVISO > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LVB250 := .F.','000019','000018','.EXE.','5','LVB250 := .F.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("SALARIO :" + STR(SALARIO),1,1)     .CNT.','000020','000000','.EXE.','5','FADDMEMLOG("SALARIO :" + STR(SALARIO),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("ADICIONAL SERVICO :" + STR(NADTSERV ),1,1)     .','000021','000000','.EXE.','5','FADDMEMLOG("ADICIONAL SERVICO :" + STR(NADTSERV ),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("PERICULOSIDADE :" + STR(NINTPERCUL ),1,1)','000022','000000','.EXE.','5','FADDMEMLOG("PERICULOSIDADE :" + STR(nIntPercul ),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("INSALUBRIDADE :" + STR(NINTINSAL ),1,1)','000023','000000','.EXE.','5','FADDMEMLOG("INSALUBRIDADE :" + STR(nIntInsal ),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("ADICIONAL CONFIANCA :" + STR(NADCCONF ),1,1)','000024','000000','.EXE.','5','FADDMEMLOG("ADICIONAL CONFIANCA :" + STR(NADCCONF ),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("ADICIONAL TRANSFERENCIA :" + STR(NADCTRF ),1,1)','000025','000000','.EXE.','5','FADDMEMLOG("ADICIONAL TRANSFERENCIA :" + STR(NADCTRF ),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("COMISSAO AVISO :" + STR(NGCOMISAV ),1,1)     .CN','000026','000000','.EXE.','5','FADDMEMLOG("COMISSAO AVISO :" + STR(NGCOMISAV ),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("MEDIA AVISO :" + STR(NMEDAVISO ),1,1)  FADDMEMLO','000027','000000','.EXE.','5','FADDMEMLOG("MEDIA AVISO :" + STR(NMEDAVISO ),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("TAREFA AVISO :" + STR(NGTAREFAV),1,1)     .CNT.','000028','000000','.EXE.','5','FADDMEMLOG("TAREFA AVISO :" + STR(NGTAREFAV),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NBASEAV := SALARIO','000029','000000','.EXE.','5','NBASEAV := SALARIO','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AINCRES[2] $ "SIA" .OR. ( AINCRES[2] $ "T*B" .AND. (NDIAINDE','000030','000000','.CON.','5','','','5','aIncRes[2] $ "SIA" .OR. ( AINCRES[2] $ "T*B" .AND. (NDIAINDE > 0 .OR. lPgSabDom ))','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AINCRES[2] $ "T*B" .AND. (NDIAINDE > 0  .OR. LPGSABDOM )','000031','000030','.CON.','5','','','5','AINCRES[2] $ "T*B" .AND. (NDIAINDE > 0  .Or. lPgSabDom )','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV := NDIAINDE     .CNT.','000032','000031','.EXE.','5','NDIASAV := NDIAINDE','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LPAGTRAB := .F.     .CNT.','000033','000031','.EXE.','5','LPAGTRAB := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AINCRES[15] == "N" .AND. LSABDOM .AND. DOW( DDATADEM1 ) ==','000034','000031','.CON.','5','','','5','AINCRES[15] == "N" .AND. LSABDOM .AND. DOW( DDATADEM1 ) == 6','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LPAGTRAB := .T.     .END.','000035','000034','.EXE.','5','LPAGTRAB := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("DIAS AVISO :" + STR(NDIASAV),1,1)     .CNT.','000036','000031','.EXE.','5','FADDMEMLOG("DIAS AVISO :" + STR(NDIASAV),1,1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','!LVB250','000037','000030','.CON.','5','','','5','!LVB250','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','!EMPTY(ACODFOL[111,1]) .AND. NDIASAV > 0','000038','000037','.CON.','5','','','5','!Empty(aCodfol[111,1]) .and. nDiasAv > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','!LADCSRESC .OR. (CCOMPL == "S" .AND. !LTEMIDRESC)','000039','000038','.CON.','5','','','5','!lAdcsResc .Or. (cCompl == "S" .And. !LTEMIDRESC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NBASEAV := (SALARIO + NADTSERV + NINTPERCUL + NINTINSAL + NA','000040','000039','.EXE.','5','NBASEAV := (Salario + nAdtServ + nIntPercul + nIntInsal + nAdcConf + nAdcTrf + nGComisAv + nMedAviso + nGTarefAv + FINCSEMID("0111"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAV := (NBASEAV / 30 ) * NDIASAV','000041','000039','.EXE.','5','nValAv := (NBASEAV / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[111,1] .AND. X[9] # "D" } )','000042','000039','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[111,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[111,1],ROUND(NVALAV,2) , NDIASAV, , ,'+"'"+'V'+"'"+',','000043','000042','.EXE.','5','fGeraVerba(aCodfol[111,1],Round(nValav,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[111,1] + " - AVISO PREVIO IN','000044','000042','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[111,1] + " - AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(SALMES + NVALAUX + NGCOMISAV + NMEDAVISO + NGTA','000045','000042','.EXE.','5','FADDMEMLOG("(SalMes + nValAux + nGComisAv + nMedAviso + nGTarefAv) / 30 * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)     .CNT.','000046','000042','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LADCSRESC .AND. ( CCOMPL <> "S" .OR. LTEMIDRESC)','000047','000038','.CON.','5','','','5','LADCSRESC .AND. ( CCOMPL <> "S" .OR. LTEMIDRESC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NBASEAV := SALARIO + NGCOMISAV + NMEDAVISO + NGTAREFAV + FIN','000048','000047','.EXE.','5','NBASEAV := Salario + nGComisAv + nMedAviso + nGTarefAv + FINCSEMID("0111")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAV := (NBASEAV / 30) * NDIASAV','000049','000047','.EXE.','5','nValAv := (NBASEAV / 30) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nValAvAts := ( nAdtServ / 30 ) * nDiasAv     .CNT.','000050','000047','.EXE.','5','nValAvAts := ( nAdtServ / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVPER := ( NINTPERCUL / 30 ) * NDIASAV','000051','000047','.EXE.','5','nValAvPer := ( nIntPercul / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVINS := ( NINTINSAL / 30 ) * NDIASAV','000052','000047','.EXE.','5','nValAvIns := ( nIntInsal / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVCON := ( NADCCONF / 30 ) * NDIASAV','000053','000047','.EXE.','5','nValAvCon := ( nAdcConf / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVTRA := ( NADCTRF / 30 ) * NDIASAV','000054','000047','.EXE.','5','nValAvTra := ( nAdcTrf / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1707,1] } )','000055','000047','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1707,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000056','000047','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000057','000056','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1707,1],NADTSERV,NORDGRPD})','000058','000056','.EXE.','5','aAdd(aSalBase,{aCodfol[1707,1],nAdtServ,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000059','000047','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NADTSERV','000060','000059','.EXE.','5','aSalBase[nPosAux,2] := nAdtServ','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000061','000059','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1683,1] } )','000062','000047','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1683,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000063','000047','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000064','000063','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1683,1],NINTPERCUL,NORDGRPD})','000065','000063','.EXE.','5','aAdd(aSalBase,{aCodfol[1683,1],nIntPercul,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000066','000047','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NINTPERCUL','000067','000066','.EXE.','5','aSalBase[nPosAux,2] := nIntPercul','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000068','000066','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1695,1] } )','000069','000047','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1695,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000070','000047','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000071','000070','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1695,1],NINTINSAL,NORDGRPD})','000072','000070','.EXE.','5','aAdd(aSalBase,{aCodfol[1695,1],nIntInsal,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000073','000047','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NINTINSAL','000074','000073','.EXE.','5','aSalBase[nPosAux,2] := nIntInsal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000075','000073','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1719,1] } )','000076','000047','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1719,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000077','000047','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000078','000077','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1719,1],NADCCONF,NORDGRPD})','000079','000077','.EXE.','5','aAdd(aSalBase,{aCodfol[1719,1],nAdcConf,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000080','000047','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NADCCONF','000081','000080','.EXE.','5','aSalBase[nPosAux,2] := nAdcConf','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000082','000080','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1713,1] } )','000083','000047','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1713,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000084','000047','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000085','000084','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1713,1],NADCTRF,NORDGRPD})','000086','000084','.EXE.','5','aAdd(aSalBase,{aCodfol[1713,1],nAdcTrf,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000087','000047','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NADCTRF','000088','000087','.EXE.','5','aSalBase[nPosAux,2] := nAdcTrf','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000089','000087','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[111,1] .AND. X[9] # "D" } )','000090','000047','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[111,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[111,1],ROUND(NVALAV,2) , NDIASAV, , ,'+"'"+'V'+"'"+',','000091','000090','.EXE.','5','fGeraVerba(aCodfol[111,1],Round(nValav,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[111,1] + " - AVISO PREVIO IN','000092','000090','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[111,1] + " - AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(SALARIO + NVALAUX + NGCOMISAV + NMEDAVISO + NGT','000093','000090','.EXE.','5','FADDMEMLOG("(Salario + nValAux + nGComisAv + nMedAviso + nGTarefAv) / 30 * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)     .CNT.','000094','000090','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1707,1],ROUND(NVALAVATS,2) , NDIASAV, , ,','000095','000047','.EXE.','5','IIF( nValAvAts < 0, nValAvAts := 0,fGeraVerba(aCodfol[1707,1],Round(nValAvAts,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1683,1],ROUND(NVALAVPER,2) , NDIASAV, , ,','000096','000047','.EXE.','5','IIF( nValAvPer < 0, nValAvPer := 0,fGeraVerba(aCodfol[1683,1],Round(nValAvPer,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1695,1],ROUND(NVALAVINS,2) , NDIASAV, , ,','000097','000047','.EXE.','5','IIF( nValAvIns < 0, nValAvIns := 0,fGeraVerba(aCodfol[1695,1],Round(nValAvIns,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1719,1],ROUND(NVALAVCON,2) , NDIASAV, , ,','000098','000047','.EXE.','5','IIF( nValAvCon < 0, nValAvCon := 0,fGeraVerba(aCodfol[1719,1],Round(nValAvCon,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1713,1],ROUND(NVALAVTRA,2) , NDIASAV, , ,','000099','000047','.EXE.','5','IIF( nValAvTra < 0, nValAvTra := 0,fGeraVerba(aCodfol[1713,1],Round(nValAvTra,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1689,1],ROUND((NMEDPERAV / 30 ) * NDIASAV','000100','000047','.EXE.','5','IIF( NMEDPERAV < 0, NMEDPERAV := 0,fGeraVerba(aCodfol[1689,1],Round((NMEDPERAV / 30 ) * nDiasAv,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1701,1],ROUND((NMEDINSAV / 30 ) * NDIASAV','000101','000047','.EXE.','5','IIF( NMEDINSAV < 0, NMEDINSAV := 0,fGeraVerba(aCodfol[1701,1],Round((NMEDINSAV / 30 ) * nDiasAv,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nValAvAts > 0   .END.','000102','000047','.CON.','5','','','5','nValAvAts > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1707,1] + " - ATS AVISO PREV','000103','000102','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1707,1] + " - ATS AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NADTSERV / 30) * NDIASAV",1,2)','000104','000102','.EXE.','5','FADDMEMLOG("(nAdtServ / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVATS,2)),1,2)','000105','000102','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvAts,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVPER > 0','000106','000047','.CON.','5','','','5','nValAvPer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1683,1] + " - PERICULOSIDADE','000107','000106','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1683,1] + " - PERICULOSIDADE AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NINTPERCUL / 30) * NDIASAV",1,2)','000108','000106','.EXE.','5','FADDMEMLOG("(nIntPercul / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVPER,2)),1,2)','000109','000106','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvPer,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVINS > 0','000110','000047','.CON.','5','','','5','nValAvIns > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1695,1] + " - INSALUBRIDADE','000111','000110','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1695,1] + " - INSALUBRIDADE AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NINTINSAL / 30) * NDIASAV",1,2)','000112','000110','.EXE.','5','FADDMEMLOG("(nIntInsal / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVINS,2)),1,2)','000113','000110','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvIns,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVCON > 0','000114','000047','.CON.','5','','','5','nValAvCon > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1719,1] + " - CARGO CONF. AV','000115','000114','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1719,1] + " - CARGO CONF. AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NADCCONF / 30) * NDIASAV",1,2)','000116','000114','.EXE.','5','FADDMEMLOG("(nAdcConf / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVCON,2)),1,2)','000117','000114','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvCon,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVTRA > 0','000118','000047','.CON.','5','','','5','nValAvTra > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1713,1] + " - ADIC. TRANSF.','000119','000118','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1713,1] + " - ADIC. TRANSF. AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NADCTRF / 30) * NDIASAV",1,2)','000120','000118','.EXE.','5','FADDMEMLOG("(nAdcTrf / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVTRA,2)),1,2)','000121','000118','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvTra,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LVB250','000122','000030','.CON.','5','','','5','LVB250','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','!EMPTY(ACODFOL[111,1]) .AND. NDIASAV > 0','000123','000122','.CON.','5','','','5','!Empty(aCodfol[111,1]) .and. nDiasAv > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','!LADCSRESC .OR. (CCOMPL == "S" .AND. !LTEMIDRESC)','000124','000123','.CON.','5','','','5','!lAdcsResc .Or. (cCompl == "S" .And. !LTEMIDRESC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NBASEAV :=  SALARIO + NADTSERV + NINTPERCUL + NINTINSAL + N','000125','000124','.EXE.','5','NBASEAV :=  Salario + nAdtServ + nIntPercul + nIntInsal + nAdcConf + nAdcTrf + nGComisAv + nGTarefAv + FINCSEMID("0111")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAV := ( NBASEAV / 30) * NDIASAV','000126','000124','.EXE.','5','nValAv := ( NBASEAV / 30) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NMEDAVISO := ( (NMEDAVISO / 30 ) * NDIASAV )','000127','000124','.EXE.','5','nMedAviso := ( (nMedAviso / 30 ) * nDiasAv )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[111,1] .AND. X[9] # "D" } )','000128','000124','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[111,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[111,1],ROUND(NVALAV,2), NDIASAV, , ,'+"'"+'V'+"'"+',"','000129','000128','.EXE.','5','fGeraVerba(aCodfol[111,1],Round(nValav,2), nDiasAv, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[111,1] + " - AVISO PREVIO IN','000130','000128','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[111,1] + " - AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG(" nValAv := ( SalMes + nValAux + nGComisAv + nGTa','000131','000128','.EXE.','5','FADDMEMLOG(" nValAv := ( SalMes + nValAux + nGComisAv + nGTarefAv ) / 30 * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)     .CNT.','000132','000128','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[250,1] .AND. X[9] # "D" } )','000133','000124','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[250,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','fGeraVerba(aCodfol[250,1],Round(nMedAviso,2), nDiasAv, , ,'+"'"+'V','000134','000133','.EXE.','5','fGeraVerba(aCodfol[250,1],Round(nMedAviso,2), nDiasAv, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV := ((DDATADEM1 - MAX(GETMEMVAR("RG_DTAVISO"),STOD(AN','000135','000133','.EXE.','5','NDIASAV := ((DDATADEM1 - MAX(GETMEMVAR("RG_DTAVISO"),STOD(ANOMES(DDATADEM)+"01")))+1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[250,1] + " - MEDIA AVISO PRE','000136','000133','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[250,1] + " - MEDIA AVISO PREVIO RESCISAO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(Round(nMedAviso,2)),1,2)     .EN','000137','000133','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nMedAviso,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LADCSRESC .AND. ( CCOMPL <> "S" .OR. LTEMIDRESC)','000138','000123','.CON.','5','','','5','LADCSRESC .AND. ( CCOMPL <> "S" .OR. LTEMIDRESC)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NBASEAV := SALARIO + NGCOMISAV + NGTAREFAV + FINCSEMID("0111','000139','000138','.EXE.','5','NBASEAV := Salario + nGComisAv + nGTarefAv + FINCSEMID("0111")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAV := (NBASEAV / 30) * NDIASAV','000140','000138','.EXE.','5','nValAv := (NBASEAV / 30) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nMedAviso := (nMedAviso / 30 ) * nDiasAv     .CNT.','000141','000138','.EXE.','5','nMedAviso := (nMedAviso / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nValAvAts := ( nAdtServ / 30 ) * nDiasAv     .CNT.','000142','000138','.EXE.','5','nValAvAts := ( nAdtServ / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVPER := ( NINTPERCUL / 30 ) * NDIASAV','000143','000138','.EXE.','5','nValAvPer := ( nIntPercul / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVINS := ( NINTINSAL / 30 ) * NDIASAV','000144','000138','.EXE.','5','nValAvIns := ( nIntInsal / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVCON := ( NADCCONF / 30 ) * NDIASAV','000145','000138','.EXE.','5','nValAvCon := ( nAdcConf / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVTRA := ( NADCTRF / 30 ) * NDIASAV','000146','000138','.EXE.','5','nValAvTra := ( nAdcTrf / 30 ) * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1707,1] } )','000147','000138','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1707,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000148','000138','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000149','000148','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1707,1],NADTSERV,NORDGRPD})','000150','000148','.EXE.','5','aAdd(aSalBase,{aCodfol[1707,1],nAdtServ,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000151','000138','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NADTSERV','000152','000151','.EXE.','5','aSalBase[nPosAux,2] := nAdtServ','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000153','000151','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1683,1] } )','000154','000138','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1683,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000155','000138','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000156','000155','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1683,1],NINTPERCUL,NORDGRPD})','000157','000155','.EXE.','5','aAdd(aSalBase,{aCodfol[1683,1],nIntPercul,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000158','000138','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NINTPERCUL','000159','000158','.EXE.','5','aSalBase[nPosAux,2] := nIntPercul','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000160','000158','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1695,1] } )','000161','000138','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1695,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000162','000138','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000163','000162','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1695,1],NINTINSAL,NORDGRPD})','000164','000162','.EXE.','5','aAdd(aSalBase,{aCodfol[1695,1],nIntInsal,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000165','000138','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NINTINSAL','000166','000165','.EXE.','5','aSalBase[nPosAux,2] := nIntInsal','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000167','000165','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1719,1] } )','000168','000138','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1719,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000169','000138','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000170','000169','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1719,1],NADCCONF,NORDGRPD})','000171','000169','.EXE.','5','aAdd(aSalBase,{aCodfol[1719,1],nAdcConf,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000172','000138','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NADCCONF','000173','000172','.EXE.','5','aSalBase[nPosAux,2] := nAdcConf','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000174','000172','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NPOSAUX := ASCAN(ASALBASE, { |X| X[1] == ACODFOL[1713,1] } )','000175','000138','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[1713,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000176','000138','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000177','000176','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[1719,1],NADCTRF,NORDGRPD})','000178','000176','.EXE.','5','aAdd(aSalBase,{aCodfol[1719,1],nAdcTrf,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000179','000138','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NADCTRF','000180','000179','.EXE.','5','aSalBase[nPosAux,2] := nAdcTrf','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000181','000179','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[111,1] .AND. X[9] # "D" } )','000182','000138','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[111,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[111,1],ROUND(NVALAV,2) , NDIASAV, , ,'+"'"+'V'+"'"+',','000183','000182','.EXE.','5','fGeraVerba(aCodfol[111,1],Round(nValav,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[111,1] + " - AVISO PREVIO IN','000184','000182','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[111,1] + " - AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(SALARIO + NVALAUX + NGCOMISAV + NMEDAVISO + NGT','000185','000182','.EXE.','5','FADDMEMLOG("(Salario + nValAux + nGComisAv + nMedAviso + nGTarefAv) / 30 * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)     .CNT.','000186','000182','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[250,1] .AND. X[9] # "D" } )','000187','000138','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[250,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','fGeraVerba(aCodfol[250,1],Round(nMedAviso,2), nDiasAv, , ,'+"'"+'V','000188','000187','.EXE.','5','fGeraVerba(aCodfol[250,1],Round(nMedAviso,2), nDiasAv, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[250,1] + " - MEDIA AVISO PRE','000189','000187','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[250,1] + " - MEDIA AVISO PREVIO RESCISAO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(Round(nMedAviso,2)),1,2)     .EN','000190','000187','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nMedAviso,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1707,1],ROUND(NVALAVATS,2) , NDIASAV, , ,','000191','000138','.EXE.','5','IIF( nValAvAts < 0, nValAvAts := 0,fGeraVerba(aCodfol[1707,1],Round(nValAvAts,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1683,1],ROUND(NVALAVPER,2) , NDIASAV, , ,','000192','000138','.EXE.','5','IIF( nValAvPer < 0, nValAvPer := 0,fGeraVerba(aCodfol[1683,1],Round(nValAvPer,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1695,1],ROUND(NVALAVINS,2) , NDIASAV, , ,','000193','000138','.EXE.','5','IIF( nValAvIns < 0, nValAvIns := 0,fGeraVerba(aCodfol[1695,1],Round(nValAvIns,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1719,1],ROUND(NVALAVCON,2) , NDIASAV, , ,','000194','000138','.EXE.','5','IIF( nValAvCon < 0, nValAvCon := 0,fGeraVerba(aCodfol[1719,1],Round(nValAvCon,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1713,1],ROUND(NVALAVTRA,2) , NDIASAV, , ,','000195','000138','.EXE.','5','IIF( nValAvTra < 0, nValAvTra := 0,fGeraVerba(aCodfol[1713,1],Round(nValAvTra,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1689,1],ROUND((NMEDPERAV / 30 ) * NDIASAV','000196','000138','.EXE.','5','IIF( NMEDPERAV < 0, NMEDPERAV := 0,fGeraVerba(aCodfol[1689,1],Round((NMEDPERAV / 30 ) * nDiasAv,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[1701,1],ROUND((NMEDINSAV / 30 ) * NDIASAV','000197','000138','.EXE.','5','IIF( NMEDINSAV < 0, NMEDINSAV := 0,fGeraVerba(aCodfol[1701,1],Round((NMEDINSAV / 30 ) * nDiasAv,2) , nDiasAv, , ,'+"'"+'V'+"'"+',"R"))','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nValAvAts > 0   .END.','000198','000138','.CON.','5','','','5','nValAvAts > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1707,1] + " - ATS AVISO PREV','000199','000198','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1707,1] + " - ATS AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NADTSERV / 30) * NDIASAV",1,2)','000200','000198','.EXE.','5','FADDMEMLOG("(nAdtServ / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVATS,2)),1,2)','000201','000198','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvAts,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVPER > 0','000202','000138','.CON.','5','','','5','nValAvPer > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1683,1] + " - PERICULOSIDADE','000203','000202','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1683,1] + " - PERICULOSIDADE AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NINTPERCUL / 30) * NDIASAV",1,2)','000204','000202','.EXE.','5','FADDMEMLOG("(nIntPercul / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVPER,2)),1,2)','000205','000202','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvPer,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVINS > 0','000206','000138','.CON.','5','','','5','nValAvIns > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1695,1] + " - INSALUBRIDADE','000207','000206','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1695,1] + " - INSALUBRIDADE AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NINTINSAL / 30) * NDIASAV",1,2)','000208','000206','.EXE.','5','FADDMEMLOG("(nIntInsal / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVINS,2)),1,2)','000209','000206','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvIns,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVCON > 0','000210','000138','.CON.','5','','','5','nValAvCon > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1719,1] + " - CARGO CONF. AV','000211','000210','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1719,1] + " - CARGO CONF. AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NADCCONF / 30) * NDIASAV",1,2)','000212','000210','.EXE.','5','FADDMEMLOG("(nAdcConf / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVCON,2)),1,2)','000213','000210','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvCon,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVTRA > 0','000214','000138','.CON.','5','','','5','nValAvTra > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[1713,1] + " - ADIC. TRANSF.','000215','000214','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[1713,1] + " - ADIC. TRANSF. AVISO PREVIO INDENIZADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("(NADCTRF / 30) * NDIASAV",1,2)','000216','000214','.EXE.','5','FADDMEMLOG("(nAdcTrf / 30) * nDiasAv",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(ROUND(NVALAVTRA,2)),1,2)','000217','000214','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValAvTra,2)),1,2)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AINCRES[2] == "T" .AND. NDIAINDE > 0','000218','000030','.CON.','5','','','5','AINCRES[2] == "T" .AND. NDIAINDE > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV := NBKPAV     .END.','000219','000218','.EXE.','5','NDIASAV := NBKPAV','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[111,1] } )','000220','000030','.EXE.','5','nPosAux := aScan(aSalBase, { |X| X[1] == aCodfol[111,1] } )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux == 0   .END.','000221','000030','.CON.','5','','','5','nPosAux == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nOrdGrPd++     .CNT.','000222','000221','.EXE.','5','nOrdGrPd++','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AADD(ASALBASE,{ACODFOL[111,1],NBASEAV,NORDGRPD})','000223','000221','.EXE.','5','aAdd(aSalBase,{aCodfol[111,1],NBASEAV,nOrdGrPd})','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nPosAux > 0   .END.','000224','000030','.CON.','5','','','5','nPosAux > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASALBASE[NPOSAUX,2] := NBASEAV','000225','000224','.EXE.','5','aSalBase[nPosAux,2] := NBASEAV','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aSalBase[nPosAux,3] := nOrdGrPd     .END.','000226','000224','.EXE.','5','aSalBase[nPosAux,3] := nOrdGrPd','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','aIncRes[2] $ "T" .and. ( !Empty(GetMemVar("RG_DTAVISO")) .','000227','000000','.CON.','5','','','5','aIncRes[2] $ "T" .and. ( !Empty(GetMemVar("RG_DTAVISO")) .or. nDiasAv > 0 ) .and. !Empty(aCodfol[112,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AINCRES[15] == "N"   .END.','000228','000227','.CON.','5','','','5','AINCRES[15] == "N"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NBKPAV := NDIASAV     .CNT.','000229','000228','.EXE.','5','NBKPAV := NDIASAV','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV := DIASTRAB     .CNT.','000230','000228','.EXE.','5','NDIASAV := DIASTRAB','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[112,1] + " - AVISO PREVIO TR','000231','000228','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[112,1] + " - AVISO PREVIO TRABALHADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LPAGTRAB   .END.','000232','000228','.CON.','5','','','5','LPAGTRAB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDAVTRAB := NDIASAV     .END.','000233','000232','.EXE.','5','NDAVTRAB := NDIASAV','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','!LPAGTRAB   .END.','000234','000228','.CON.','5','','','5','!LPAGTRAB','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDAVTRAB := MIN(NDIASAV, (DDATADEM1-STOD(ANOMES(DDATADEM)+"','000235','000234','.EXE.','5','NDAVTRAB := MIN(NDIASAV, (DDATADEM1-STOD(ANOMES(DDATADEM)+"01"))+1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','LSABDOM .AND. DOW( DDATADEM1 ) == 6','000236','000228','.CON.','5','','','5','LSABDOM .AND. DOW( DDATADEM1 ) == 6','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDAVTRAB := NDIASAV - NDIASIND','000237','000236','.EXE.','5','NDAVTRAB := NDIASAV - NDIASIND','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','POSSRV( ACODFOL[112,1], SRA->RA_FILIAL, "RV_BASCAL" ) <> "','000238','000228','.CON.','5','','','5','POSSRV( ACODFOL[112,1], SRA->RA_FILIAL, "RV_BASCAL" ) <> "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("SALARIO :" + STR(SALARIO),1,2)     .END.','000239','000238','.EXE.','5','FADDMEMLOG("SALARIO :" + STR(SALARIO),1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NSALAUX := SALARIO     .END.','000240','000238','.EXE.','5','NSALAUX := SALARIO','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','POSSRV( ACODFOL[112,1], SRA->RA_FILIAL, "RV_BASCAL" ) == "','000241','000228','.CON.','5','','','5','POSSRV( ACODFOL[112,1], SRA->RA_FILIAL, "RV_BASCAL" ) == "2" .AND. !LHOJORVA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("SALARIO :" + STR(SALMES),1,2)     .END.','000242','000241','.EXE.','5','FADDMEMLOG("SALARIO :" + STR(SALMES),1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NSALAUX := SALMES','000243','000241','.EXE.','5','NSALAUX := SALMES','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("DIAS AVISO :" + STR(nDavTrab),1,2)     .CNT.','000244','000228','.EXE.','5','FADDMEMLOG("DIAS AVISO :" + STR(nDavTrab),1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV > 0','000245','000228','.CON.','5','','','5','nDiasAv > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("nValAv  := ( NSALAUX / 30 ) * nDavTrab",1,2)','000246','000245','.EXE.','5','FADDMEMLOG("nValAv  := ( NSALAUX / 30 ) * nDavTrab",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nValAv  := ( NSALAUX / 30 ) * nDavTrab     .END.','000247','000245','.EXE.','5','nValAv  := ( NSALAUX / 30 ) * nDavTrab','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV <= 0','000248','000228','.CON.','5','','','5','nDiasAv <= 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAV  := ((DDATADEM - MAX(GETMEMVAR("RG_DTAVISO"),STOD(ANO','000249','000248','.EXE.','5','NVALAV  := ((DDATADEM - MAX(GETMEMVAR("RG_DTAVISO"),STOD(ANOMES(DDATADEM)+"01")))+1) * ( NSALAUX / 30 )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("NVALAV  := ((DDATADEM - MAX(GETMEMVAR('+"'"+'+"'+"'"+'"+'+"'"+'RG_','000250','000248','.EXE.','5','FADDMEMLOG("NVALAV  := ((DDATADEM - MAX(GETMEMVAR('+"'"+'RG_DTAVISO'+"'"+'),STOD(ANOMES(DDATADEM)+'+"'"+'01'+"'"+')))+1) * ( NSALAUX / 30 )",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','POSSRV( ACODFOL[112,1], SRA->RA_FILIAL, "RV_BASCAL" ) == "2"','000251','000248','.CON.','5','','','5','PosSrv( aCodFol[112,1], SRA->RA_FILIAL, "RV_BASCAL" ) == "2"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("NVALAV  := ((DDATADEM - MAX(GETMEMVAR('+"'"+'+"'+"'"+'"+'+"'"+'RG_','000252','000251','.EXE.','5','FADDMEMLOG("NVALAV := ((DDATADEM - MAX(GETMEMVAR(RG_DTAVISO),STOD(ANOMES(DDATADEM)+'+"'"+'01'+"'"+')))+1) * ( SALMES / 30 )",1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAV  := ((DDATADEM - MAX(GETMEMVAR("RG_DTAVISO"),STOD(ANO','000253','000251','.EXE.','5','NVALAV  := ((DDATADEM - MAX(GETMEMVAR("RG_DTAVISO"),STOD(ANOMES(DDATADEM)+"01")))+1) * ( SALMES / 30 )','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV := ((DDATADEM1 - MAX(GETMEMVAR("RG_DTAVISO"),STOD(AN','000254','000248','.EXE.','5','NDIASAV := ((DDATADEM1 - MAX(GETMEMVAR("RG_DTAVISO"),STOD(ANOMES(DDATADEM)+"01")))+1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[112,1] .AND. X[9] # "D" } )','000255','000228','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[112,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','fGeraVerba(aCodfol[112,1],Round(nValav,2), nDavTrab, , ,'+"'"+'V'+"'"+',','000256','000255','.EXE.','5','fGeraVerba(aCodfol[112,1],Round(nValav,2), nDavTrab, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)     .CNT.','000257','000255','.EXE.','5','FADDMEMLOG("VALOR : " + STR(Round(nValav,2)),1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV := ((DDATADEM1 - MAX(GETMEMVAR("RG_DTAVISO"),STOD(AN','000258','000255','.EXE.','5','NDIASAV := ((DDATADEM1 - MAX(GETMEMVAR("RG_DTAVISO"),STOD(ANOMES(DDATADEM)+"01")))+1)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV := NBKPAV     .END.','000259','000228','.EXE.','5','NDIASAV := NBKPAV','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','AINCRES[2] $ "D" .AND. NDIASAV > 0 .AND. !EMPTY(ACODFOL[113,','000260','000000','.CON.','5','','','5','aIncRes[2] $ "D" .and. nDiasAv > 0 .and. !Empty(aCodfol[113,1])','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVD := ( SALARIO + NGCOMISAV + NGTAREFAV ) / 30 * NDIASA','000261','000260','.EXE.','5','nValAvd := ( Salario + nGComisAv + nGTarefAv ) / 30 * nDiasAv','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("NVALAVD -->  ( SALARIO + NGCOMISAV + NGTAREFAV )','000262','000260','.EXE.','5','FADDMEMLOG("NVALAVD -->  ( SALARIO + NGCOMISAV + NGTAREFAV ) / 30 * NDIASAV",1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','PosSrv( aCodFol[113,1], SRA->RA_FILIAL, "RV_BASCAL" ) == "','000263','000260','.CON.','5','','','5','PosSrv( aCodFol[113,1], SRA->RA_FILIAL, "RV_BASCAL" ) == "2" .AND. !LHOJORVA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("NVALAVD --> ( SALMES + NGCOMISAV + NGTAREFAV ) /','000264','000263','.EXE.','5','FADDMEMLOG("NVALAVD --> ( SALMES + NGCOMISAV + NGTAREFAV ) / 30 * NDIASAV",1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVD := ( SALMES + NGCOMISAV + NGTAREFAV ) / 30 * NDIASAV','000265','000263','.EXE.','5','nValAvd := ( SalMes + nGComisAv + nGTarefAv ) / 30 * nDiasAv','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','P_DESCMEDA == "S"','000266','000260','.CON.','5','','','5','P_DESCMEDA == "S"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NMEDAVISO := ( (NMEDAVISO / 30 ) * NDIASAV )','000267','000266','.EXE.','5','nMedAviso := ( (nMedAviso / 30 ) * nDiasAv )','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("nMedAviso := ( (nMedAviso / 30 ) * nDiasAv )",1,','000268','000266','.EXE.','5','FADDMEMLOG("nMedAviso := ( (nMedAviso / 30 ) * nDiasAv )",1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','!EMPTY(ACODFOL[972,1]) .AND. NDIASAV > 0','000269','000266','.CON.','5','','','5','!Empty(aCodfol[972,1]) .and. nDiasAv > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[972,1] .AND. X[9] # "D" } )','000270','000269','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[972,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[972,1] + " - DESC. MEDIA A.','000271','000270','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[972,1] + " - DESC. MEDIA A. PREVIO RESCISAO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("Valor ; " + Str(NMEDAVISO),1,2)     .CNT.','000272','000270','.EXE.','5','FADDMEMLOG("Valor ; " + Str(NMEDAVISO),1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[972,1],ROUND(NMEDAVISO,2), NDIASAV, , ,'+"'"+'V','000273','000270','.EXE.','5','fGeraVerba(aCodfol[972,1],Round(nMedAviso,2), nDiasAv, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','EMPTY(ACODFOL[972,1]) .AND. NDIASAV > 0','000274','000266','.CON.','5','','','5','Empty(aCodfol[972,1]) .and. nDiasAv > 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("NVALAVD --> nValAvd += nMedAviso" + str(nValAvd+','000275','000274','.EXE.','5','FADDMEMLOG("NVALAVD --> nValAvd += nMedAviso" + str(nValAvd+nMedAviso),1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NVALAVD += NMEDAVISO','000276','000274','.EXE.','5','nValAvd += nMedAviso','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','ASCAN(APD,{ |X| X[1] == ACODFOL[113,1] .AND. X[9] # "D" } )','000277','000260','.CON.','5','','','5','aScan(aPd,{ |X| X[1] == aCodfol[113,1] .and. X[9] # "D" } ) == 0','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("VERBA : " + ACODFOL[113,1] + " - AVISO PREVIO DE','000278','000277','.EXE.','5','FADDMEMLOG("VERBA : " + ACODFOL[113,1] + " - AVISO PREVIO DESCONTADO" ,1,1)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FADDMEMLOG("Valor ; " + Str(nvalavd),1,2)     .CNT.','000279','000277','.EXE.','5','FADDMEMLOG("Valor ; " + Str(nvalavd),1,2)','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','FGERAVERBA(ACODFOL[113,1],ROUND(NVALAVD,2), NDIASAV, , ,'+"'"+'V'+"'"+',','000280','000277','.EXE.','5','fGeraVerba(aCodfol[113,1],Round(nValavd,2), nDiasAv, , ,'+"'"+'V'+"'"+',"R")','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','NDIASAV := NBKPAV','000281','000000','.EXE.','5','nDiasAv := nBkPav','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','SRA->RA_CATFUNC == "H" .AND. LHOJORVA   .END.','000282','000000','.CON.','5','','','5','SRA->RA_CATFUNC == "H" .AND. LHOJORVA','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','SALARIO :=  NAXSAL     .END.','000283','000282','.EXE.','5','SALARIO :=  NAXSAL','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nIntInsal := nSavIns     .CNT.','000284','000000','.EXE.','5','nIntInsal := nSavIns','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CAVISOIN','nIntPercul := nSavPer     .END.','000285','000000','.EXE.','5','nIntPercul := nSavPer','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0106    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0106( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CBASEINI','Calcula Base Inicial','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CBASEINI','FBASEINI()','000001','000000','.EXE.','6','FBaseIni()','','','','','','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0107    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0107( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CBENAUT','CARGA DE BENEFICIOS AUTOMATICOS','','','003','2','1',} )

aAdd(aRc3Cols, { '','S_','CBENAUT','FCRGBENAUT(.T.)','000001','000000','.EXE.','5','fCrgBenAut(.T.)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0108    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0108( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CCODASSM','CARGA DA TABELA DE ASSITENCIA MEDICA','','','005','2','1',} )

aAdd(aRc3Cols, { '','S_','CCODASSM','CCODASSM <> SRA->RA_ASMEDIC   .END.','000001','000000','.CON.','5','','','5','cCodAssM <> SRA->RA_ASMEDIC','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CCODASSM','CARASSMED()    .CNT.','000002','000001','.EXE.','5','CarAssMed()','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CCODASSM','CCODASSM := SRA->RA_ASMEDIC     .END.','000003','000001','.EXE.','5','CCODASSM := SRA->RA_ASMEDIC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CCODASSM','CCODASSM == SRA->RA_ASMEDIC   .END.','000004','000000','.CON.','5','','','5','cCodAssM == SRA->RA_ASMEDIC','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CCODASSM','CALCASMED := .T.    .CNT.','000005','000004','.EXE.','5','CalcAsmed := .T.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CCODASSM','CCODASSM := SRA->RA_ASMEDIC     .END.','000006','000004','.EXE.','5','CCODASSM := SRA->RA_ASMEDIC','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0109    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0109( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CDIFFER','GERACAO DA MOVIMENTACAO DE FERIAS NA FOL','','','004','2','1',} )

aAdd(aRc3Cols, { '','S_','CDIFFER','LGERAFER := .F.     .CNT.','000001','000000','.EXE.','5','LGERAFER := .F.','','5','','','5','','.CNT.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CDIFFER','CSITFOLH $ "A/F" .OR. SRA->RA_SITFOLH == "F"   .END.','000002','000000','.CON.','5','','','5','CSITFOLH $ "A/F" .OR. SRA->RA_SITFOLH == "F"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CDIFFER','LGERAFER := .T.     .END.','000003','000002','.EXE.','5','LGERAFER := .T.','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )
aAdd(aRc3Cols, { '','S_','CDIFFER','LGERAFER .AND. C__ROTEIRO <> "FER" .AND. CPAISLOC $ "BRA/U','000004','000000','.CON.','5','','','5','LGERAFER .AND. C__ROTEIRO <> "FER" .AND. CPAISLOC $ "BRA/URU"','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CDIFFER','GERAFER(aCodFol)     .END.','000005','000004','.EXE.','5','GERAFER(aCodFol)','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

/*/
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o    ³AddBRA0110    ³Autor³ Gerado pelo sistema ³ Data ³          ³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ/*/
Function AddBRA0110( aRc2Header , aRc3Header , aSYPHeader )

Local aRc2Cols    := {}
Local aRc3Cols    := {}
Local aItensSYP   := {}

Local cFilRC2     := xFilial('RC2')
Local cCliVersao  := ''

Local lFound      := .F.

Local nRc2Origem	:=  GdFieldPos( 'RC2_ORIGEM' , aRC2Header )
Local nRc2Codigo	:=  GdFieldPos( 'RC2_CODIGO' , aRC2Header )
Local nRc2Versao	:=  GdFieldPos( 'RC2_VERSAO' , aRC2Header )

aAdd(aRc2Cols, { '','S_','CENCEMP','CALCULO ENCARGOS EMPRESA','','','008','2','1',} )

aAdd(aRc3Cols, { '','S_','CENCEMP','(CCOMP13 <> "S" .OR. LDISSIDIO)','000001','000000','.CON.','5','','','5','(CCOMP13 <> "S" .OR. LDISSIDIO)','','5','','.END.','PMSTASK1','PMSTASK1',} )
aAdd(aRc3Cols, { '','S_','CENCEMP','FCALCINSSFUN()','000002','000001','.EXE.','5','fCalcInssFun()','','5','','','5','','.END.','PMSTASK4','PMSTASK4',} )

dbSelectArea("RC2")
RC2->( dbSetOrder( RetOrdem('RC2','RC2_FILIAL+RC2_ORIGEM+RC2_CODIGO') ) )
lFound := RC2->( dbSeek( cFilRC2 + aRc2Cols[ 1 , nRc2Origem ] + aRc2Cols[ 1 , nRc2Codigo ] ) )
If ( lFound )
	cCliVersao := RC2->RC2_VERSAO
Else
	cCliVersao := '__New_Version__' 
EndIf
If ( Val(cCliVersao) < Val(aRc2Cols[ 1 , nRc2Versao ]) ) .Or. (cCliVersao == '__New_Version__') .Or. ( lFilRPO .and. Val(cCliVersao) == Val(aRc2Cols[ 1 , nRc2Versao ]) )
	fFormGrava( aRc2Cols , aRc3Cols , aRC2Header , aRC3Header , aSYPHeader, aItensSYP )
EndIf

Return( NIL )

