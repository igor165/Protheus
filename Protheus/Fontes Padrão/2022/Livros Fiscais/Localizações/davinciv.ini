?{"Nome do Arquivo INI","DaVinciV.INI"}
?{"Descicao Completa do Arquivo Magnetico","Arquivo magnetico Livro de Vendas IVA"}
?{"A Quem se Destina","Aos sujeitos passivos ou terceiros responsaveis obrigados a apresentacao do Livro de Compras e Vendas IVA."}
?{"Objetivo","Tem por objetivo de incrementar a eficiencia nos trabalhos de fiscalizacao e por sua vez facilitar aos contribuintes sobre suas obrigacoes formais."}
?{"Prazo de Entrega","Mensal"}
?{"Aplicativo Disponibilizado pelo Fisco","DaVinci"}
?{"Versao do Aplicativo Contemplada pela Microsiga","2.0.0.0"}
?{"Comentarios",""}

[XXX Inicializacao]
(PRE) _aTotal[03] := {}
(PRE) _aTotal[04] := {}
(PRE) _aTotal[05] := .F.
(PRE) _aTotal[06] := {}

[XXX Montagem do CFP Utilizado pela rotina - PRINCIPAL]
(PRE) aAdd(_aTotal[03],"Da Vinci")
(PRE) aAdd(_aTotal[03],"")
(PRE) aAdd(_aTotal[03],"Complete las informaciones solicitadas.")
(PRE) aAdd(_aTotal[03],"Informaciones necesárias para la generacion do archivo magnetico.")

[XXX Painel  - Configuracoes Gerais]
(PRE) aAdd(_aTotal[04],{})
(PRE) aAdd(_aTotal[04][1],"Bolivia")
(PRE) aAdd(_aTotal[04][1],"Configuraciones generais")
(PRE) aAdd(_aTotal[04][1],{})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"De Sucursal: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,Replicate("X",TamSX3("F3_FILIAL")[01]),1,,,,TamSX3("F3_FILIAL")[01],,,"SM0"})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{0,"",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{1,"Hasta Sucursal: ",,,,,,})
(PRE) aAdd(_aTotal[04][1][3],{2,,Replicate("X",TamSX3("F3_FILIAL")[01]),1,,,,TamSX3("F3_FILIAL")[01],,,"SM0"})

[XXX Chamada do Wizard]
(PRE) _aTotal[05] := xMagWizard(_aTotal[03],_aTotal[04],"DAVINCIC")
(PRE) Iif(_aTotal[05],xMagLeWiz("DAVINCIC",@_aTotal[06],.T.),Nil)
(PRE) lAbtMT950	:= !_aTotal[05]

[XXX Registro SIP - Retencao e Percecpcao]
(PRE) DaVinci("V",_aTotal[06][1][1],_aTotal[06][1][2])
(PRE) _aTotal[01] := "ventas_"+StrZero(Month(mv_par01),2)+Str(Year(mv_par01),4)+"_"+Alltrim(SM0->M0_CGC)+".TXT"

[LCV Livro Vendas IVA]
(ARQ) (_aTotal[01])
(DEL)|M
(PRE) dbGoTop()
ESPECIF    C 001 0 "3"
NUMSEQ     C 006 0 LCV->NUMSEQ
EMISSAO    C 010 0 Left(DtoC(LCV->EMISSAO),6)+Str(Year(LCV->EMISSAO),4)
NFISCAL    C 015 0 LCV->NFISCAL
NUMAUT     C 015 0 LCV->NUMAUT
STATUSNF   C 001 0 LCV->STATUSNF
NIT        C 013 0 LCV->NIT
RAZSOC     C 150 0 LCV->RAZSOC
VALCONT    C 010 2 IIf(Empty(LCV->VALCONT),"0",Str(LCV->VALCONT,10,2))
EXENTAS    C 010 2 IIf(Empty(LCV->EXENTAS),"0",Str(LCV->EXENTAS,10,2))
EXPORT     C 010 2 IIf(Empty(LCV->EXPORT),"0",Str(LCV->EXPORT,10,2))
TAXAZERO   C 010 2 IIf(Empty(LCV->TAXAZERO),"0",Str(LCV->TAXAZERO,10,2))
SUBTOT     C 010 2 IIf(Empty(LCV->SUBTOT),"0",Str(LCV->SUBTOT,10,2))
DESCONT    C 010 2 IIf(Empty(LCV->DESCONT),"0",Str(LCV->DESCONT,10,2))
BASEIMP    C 010 2 IIf(Empty(LCV->BASEIMP),"0",Str(LCV->BASEIMP,10,2))
VALIMP     C 010 2 IIf(Empty(LCV->VALIMP),"0",Str(LCV->VALIMP,10,2))
CODCTR     C 017 0 LCV->CODCTR

[XXX Finalizacao     ]
(PRE) LCV->(dbCloseArea())

(PRE) DavinciDel()
