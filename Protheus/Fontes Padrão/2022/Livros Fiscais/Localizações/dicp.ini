?{"Nombre del archivo INI","DICP.INI"}
?{"Descripción completa del archivo magnético","Declaración informativa de clientes y proveedores"}
?{"A Quien se Destina","A las personas morales y las personas físicas con actividades empresariales y profesionales"}
?{"Objetivo","Presentar datos de las operaciones realizadas com clientes y proveedores"}
?{"Plazo de Entrega","Anual"}
?{"Comentarios",""}
[XXX Inicializacao]
(PRE) _aTotal[001] := MV_PAR01
(PRE) _aTotal[002] := MV_PAR02
(PRE) _aTotal[003] := MV_PAR03
(PRE) _aTotal[004] := MV_PAR04
(PRE) _aTotal[005] := MV_PAR05
(PRE) _aTotal[006] := {}
(PRE) _aTotal[007] := {}
(PRE) _aTotal[008] := .F.
(PRE) _aTotal[009] := {}
//clientes - numero de clientes que relaciona
(PRE) _aTotal[010] := 0
//clientes - monto total de operaciones que relaciona
(PRE) _aTotal[011] := 0
//clientes - monto total de operaciones con clientes en el ejercicio
(PRE) _aTotal[012] := 0
//clientes - numero de clientes residentes en el extranjero
(PRE) _aTotal[013] := 0
//clientes - monto total de operaciones con clientes residentes en el extranjero en el ejercicio
(PRE) _aTotal[014] := 0
//proveedores - numero de proveedores que relaciona
(PRE) _aTotal[015] := 0
//proveedores - monto total de operaciones que relaciona
(PRE) _aTotal[016] := 0
//proveedores - monto total de operaciones con proveedores en el ejercicio
(PRE) _aTotal[017] := 0
//proveedores - numero de proveedores residentes en el extranjero
(PRE) _aTotal[018] := 0
//proveedores - monto total de operaciones con proveedores residentes en el extranjero en el ejercicio
(PRE) _aTotal[019] := 0

[XXX Montagem do CFP Utilizado pela rotina - PRINCIPAL]
(PRE) aAdd (_aTotal[006], "Generación de la DICP")
(PRE) aAdd (_aTotal[006], "")
(PRE) aAdd (_aTotal[006], "Rellene correctamente las informaciones solicitadas.")
(PRE) aAdd (_aTotal[006], "Informaciones necesarias para el rellenado automático de la DICP: Declaración informativa de clientes y proveedores")

[XXX Montagem do CFP Utilizado pela rotina - COMPLEMENTAR]
(PRE) aAdd (_aTotal[007], {})
(PRE) aAdd (_aTotal[007][1], "Generación de la DICP")
(PRE) aAdd (_aTotal[007][1], "Parámetros necesários")
(PRE) aAdd (_aTotal[007][1], {})
(PRE) aAdd (_aTotal[007][1][3], {1, "De sucursal",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,"XXXXXXX",1,,,,7})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "A sucursal",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,"XXXXXXX",1,,,,7})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Tipo de declaración",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {3,,,,,{"0-Normal","1-Complementaria"},,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Complemento",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {2,,"99",2,0,,,2,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "Anexos",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {1, "",,,,,,})
(PRE) aAdd (_aTotal[007][1][3], {3,,,,,{"0-Clientes","1-Proveedores","2-Ambos"},,})

[XXX Chamada do Wizard]
(PRE) _aTotal[008]	:= xMagWizard( _aTotal[006] , _aTotal[007] , "DICP" )
(PRE) Iif(_aTotal[008],xMagLeWiz("DICP" ,@_aTotal[009],.T.),Nil)
(PRE) lAbtMT950	:= !_aTotal[008]

//dicpmex(sucursal inicial,sucursal final,tipo de anexo,monto minimo,fecha inicial,fecha final,archivo proveedores,archivo clientes)
[XXX Criacao do arquivo temporario]
(PRE) DICPMEX(_aTotal[9,1,1],_aTotal[9,1,2],Substr(_aTotal[9,1,5],1,1),50000,_aTotal[1],_aTotal[2])

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Geracao do arquivo texto³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
[XXX Linea 1 - encabezado de formulario] 
IDFORM     C 003 0 "f42"

[XXX Linea 2 - Informacion del periodo]
(DEL)|MF
RFC        C 013 0 SM0->M0_CGC
ANO        N 004 0 Year(_aTotal[001])
MESINI     N 002 0 Month(_aTotal[001])
MESFIN     N 002 0 Month(_aTotal[002])
NOME       C 060 0 SM0->M0_NOMECOM
TIPODEC    N 001 0 Val(Substr(_aTotal[009,1,3],1,1))
COMPLEM    C 002 0 If(Substr(_aTotal[009,1,3],1,1) == "0","",AllTrim(_aTotal[009,1,4]))
ANEXOS     N 001 0 Val(Substr(_aTotal[9,1,5],1,1))
NRCLIEREL  N 013 0 _aTotal[10]
TTLCLIEEXT N 013 0 _aTotal[11]
MONTOCLIEN N 013 0 _aTotal[12]
CLIEEXT    N 013 0 _aTotal[13]
TTLCLIEEXT N 013 0 _aTotal[14]
NRPROVREL  N 013 0 _aTotal[15]
TOTALPROV  N 013 0 _aTotal[16]
MONTOPROV  N 013 0 _aTotal[17]
PROVEXT    N 013 0 _aTotal[18]
TTLPROVEXT N 013 0 _aTotal[19]

[XXX Linea 3 - Encabezado de datos de clientes]
CABCLIE    C 014 0 If(_aTotal[10] <> 0,"clientes_datos",)

[DIC Linea 4 - Informacion de clientes]
(DEL)|MF
(PRE) DIC->(DbGoTop())
NRCONSEC   C 013 0 DIC->NRCONSEC
RFC        C 013 0 DIC->RFC
RAZON      C 060 0 DIC->RAZON
APELLPAT   C 020 0 DIC->APELLPAT
APELLMAT   C 020 0 DIC->APELLMAT
NOMBRE     C 020 0 DIC->NOMBRE
CURP       C 018 0 DIC->CURP
MONTONETO  N 013 0 DIC->MONTONETO
OPERACION  N 001 0 DIC->OPERACION
CALLE      C 060 0 DIC->CALLE
NREXT      C 015 0 DIC->NREXT
NRINT      C 010 0 DIC->NRINT
COLONIA    C 050 0 DIC->COLONIA
MUNICIPIO  C 050 0 DIC->MUNICIPIO
CODPOSTAL  C 005 0 DIC->CODPOSTAL
LOCALIDAD  C 050 0 DIC->LOCALIDAD
ESTADO     N 002 0 DIC->ESTADO
TELEFONO   C 012 0 DIC->TELEFONO
CONSTCLIE  N 001 0 0

[XXX Linea 5 - Encabezado de datos de proveedores]
CABPROV    C 017 0 If(_aTotal[15] <> 0,"proveedores_datos",)

[DIP Linea 6 - Informacion de proveedores]
(DEL)|MF
(PRE) DIP->(DbGoTop())
NRCONSEC   C 013 0 DIP->NRCONSEC
RFC        C 013 0 DIP->RFC
RAZON      C 060 0 DIP->RAZON
APELLPAT   C 020 0 DIP->APELLPAT
APELLMAT   C 020 0 DIP->APELLMAT
NOMBRE     C 020 0 DIP->NOMBRE
CURP       C 018 0 DIP->CURP
MONTONETO  N 013 0 DIP->MONTONETO
OPERACION  N 001 0 DIP->OPERACION
CALLE      C 060 0 DIP->CALLE
NREXT      C 015 0 DIP->NREXT
NRINT      C 010 0 DIP->NRINT
COLONIA    C 050 0 DIP->COLONIA
MUNICIPIO  C 050 0 DIP->MUNICIPIO
CODPOSTAL  C 005 0 DIP->CODPOSTAL
LOCALIDAD  C 050 0 DIP->LOCALIDAD
ESTADO     N 002 0 DIP->ESTADO
TELEFONO   C 012 0 DIP->TELEFONO
CONSTPROV  N 001 0 1

[XXX Impresion del resumen]
(PRE) DICPResMex(Substr(_aTotal[9,1,5],1,1))

[XXX Report de validacion]
(PRE) DICPValMex()
[XXX Borra archivos temporales...]
(PRE) DICPDel()
