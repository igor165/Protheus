#INCLUDE "locr019.ch" 
/*/{PROTHEUS.DOC} LOCR019.PRW
ITUP BUSINESS - TOTVS RENTAL
IMPRESSAOO DE ANALISE TECNICA - TELA RAT
@TYPE FUNCTION
@AUTHOR FRANK ZWARG FUGA
@SINCE 03/12/2020
@VERSION P12
@HISTORY 03/12/2020, FRANK ZWARG FUGA, FONTE PRODUTIZADO.
/*/

#INCLUDE "PROTHEUS.CH"     
#INCLUDE "TOPCONN.CH"

FUNCTION LOCR019()
LOCAL XALIAS 	 := GETAREA() 

PRIVATE CCABEC   := ""
PRIVATE _NLINCOL := 130

// --> SELECAO DA IMPRESSORA.
OOBJPRINT := TMSPRINTER():NEW(CCABEC)
OOBJPRINT:SETSIZE( 210, 297 )
OOBJPRINT:SETUP()

LJMSGRUN(STR0001,,{|| IMP_RAT() }) //"POR FAVOR AGUARDE, IMPRIMINDO RELATORIO ANALISE TECNICA..."

// --> MOSTRA RELATORIO PARA IMPRIMIR.
OOBJPRINT:SETSIZE( 210, 297 )
OOBJPRINT:PREVIEW()

RESTAREA(XALIAS)

RETURN(NIL)



/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPROGRAMA  ³ IMP_RAT   º AUTOR ³ IT UP BUSINESS     º DATA ³ 01/05/2007 º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDESCRICAO ³ IMPRESSAOO DE ANALISE TECNICA - TELA RAT                   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUSO       ³ ESPECIFICO GPO                                             º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
STATIC FUNCTION IMP_RAT()

LOCAL   ITRC 

PRIVATE OFONTE01	:= NIL
PRIVATE OFONTE02	:= NIL
PRIVATE OFONTE03	:= NIL
PRIVATE OFONTE04	:= NIL
PRIVATE OFONTE05	:= NIL
PRIVATE OFONTE06	:= NIL
PRIVATE OFONTE07	:= NIL
PRIVATE OFONTE08    := NIL
PRIVATE NLINHAATUAL := 0
PRIVATE NNUMPAGINA	:= 0
PRIVATE CUSER 

ITRC := CRIATRAB(NIL,.F.) 

// --> INICIALIZA OBJETOS DA CLASSE TMSPRINTER. 
OFONTE01 := TFONT():NEW("ARIAL",12,20,,.T.,,,16,.F.)
OFONTE02 := TFONT():NEW("ARIAL",06,10,,.T.,,,08,.F.)
OFONTE03 := TFONT():NEW("ARIAL",10,12,,.T.,,,08,.F.)
OFONTE04 := TFONT():NEW("ARIAL",10,12,,.F.,,,08,.F.)
OFONTE05 := TFONT():NEW("ARIAL",08,09,,.T.,,,08,.F.)
OFONTE06 := TFONT():NEW("ARIAL",06,09,,.F.,,,08,.F.)
OFONTE07 := TFONT():NEW("ARIAL",06,20,,.T.,,,08,.F.)
OFONTE08 := TFONT():NEW("ARIAL",06,-11,,.F.,,,08,.F.)

// --> IMPRIME CABECALHO DO RELATORIO.
LFIRST   := .T.
IMP_CABEC(@NNUMPAGINA,@NLINHAATUAL,CUSER,1)

IMPRAT()

//FP5->(DBSETFILTER({|| FP5_ITEM == '001' }, " FP5_ITEM == '001' "))

RETURN(NIL)



/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPROGRAMA  ³ IMP_CABEC º AUTOR ³ IT UP BUSINESS     º DATA ³ 16/05/2007 º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDESCRICAO ³ IMPRESSAOO DE ANALISE TECNICA - TELA RAT                   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUSO       ³ ESPECIFICO GPO                                             º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
STATIC FUNCTION IMP_CABEC(NNUMPAGINA,NLINHAATUAL,CUSER,NVIAS)

NNUMPAGINA += 1

IF !LFIRST
	OOBJPRINT:ENDPAGE()
	OOBJPRINT:STARTPAGE()
ENDIF                                       

LFIRST := .F.

RETURN(.T.)



/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPROGRAMA  ³ IMPRAT    º AUTOR ³ IT UP BUSINESS     º DATA ³ 01/05/2007 º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDESCRICAO ³ IMPRESSAO DOS ITENS APURADOS                               º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUSO       ³ ESPECIFICO GPO                                             º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
STATIC FUNCTION IMPRAT()

LOCAL I := 0 

NLINHA:= NAUX := NLINOBS := 0 
                           
DBSELECTAREA("FP0")    
DBSETORDER(1)
MSSEEK( XFILIAL("FP0") + FP5->FP5_PROJET + FP5->FP5_OBRA )

DBSELECTAREA("FP1")    
DBSETORDER(1)
MSSEEK( XFILIAL("FP1") + FP5->FP5_PROJET + FP5->FP5_OBRA )

//DBSELECTAREA("ZA6")    
//DBSETORDER(1)
//MSSEEK( XFILIAL("ZA6") + FP5->FP5_PROJET + FP5->FP5_OBRA )

IF FP0->FP0_TIPOSE <> "T"
	CENDER   := FP1->FP1_ENDORI
	CBAIRR   := FP1->FP1_BAIORI
	CMUNIC   := FP1->FP1_MUNORI
	CESTAD   := FP1->FP1_ESTORI
	CCONTATO := FP1->FP1_CONORI
	CTELE    := "("+ALLTRIM(FP1->FP1_DDDORI)+") "+ALLTRIM(FP1->FP1_TELORI)
	CFAX     := "("+ALLTRIM(FP1->FP1_DDDORI)+") "+ALLTRIM(FP1->FP1_FAXORI)
	COBS     := FP1->FP1_ESCOPO
	DDATAVIS := FP1->FP1_DTVIS
	DPRAZO   := FP1->FP1_DTVIS
	CEMAIL   := FP1->FP1_EMAORI
    CDADOSOB:= FP1->FP1_OBRA + " - "+FP1->FP1_NOMORI
ELSE
	CLOCAL   := ZA6->ZA6_NOMORI
	CENDER   := ZA6->ZA6_ENDORI
	CBAIRR   := ZA6->ZA6_BAIORI
	CMUNIC   := ZA6->ZA6_MUNORI
	CESTAD   := ZA6->ZA6_ESTORI
	CCONTATO := ZA6->ZA6_CONORI
	CTELE    := "("+ALLTRIM(ZA6->ZA6_DDDORI)+") "+ALLTRIM(ZA6->ZA6_TELORI)
	CFAX     := "("+ALLTRIM(ZA6->ZA6_DDDORI)+") "+ALLTRIM(ZA6->ZA6_FAXORI)
	COBS     := ZA6->ZA6_OBSVIA
	DDATAVIS := ZA6->ZA6_DTVIS
	DPRAZO   := ZA6->ZA6_DTVIS
	CEMAIL   := ZA6->ZA6_EMAORI
    CDADOSOB := ZA6->ZA6_OBRA+ " - " +ZA6->ZA6_NOMORI
ENDIF 

DBSELECTAREA("FP5")
DBCLEARFILTER()

OOBJPRINT:SAY( 050  , 0700  , STR0002    , OFONTE01   , 100 ) //"RELATORIO DE ANALISE TECNICA "
OOBJPRINT:SAY( 150  , 0500  , STR0003+ALLTRIM(FP5->FP5_PROJET)+STR0004+FP5->FP5_REVISA+STR0005+FP5->FP5_COMPLE , OFONTE01   , 100 ) //"NRO.RAT: "###" REVISÃO: "###" COMPL.:"
OOBJPRINT:SAY( 200  , 0080  , REPLICATE("_",120),OFONTE02 , 100 )
OOBJPRINT:SAY( 250  , 0080  , STR0006 +  DTOC(DDATABASE) ,OFONTE02 , 100 )     //"EMITIDA EM :  "
OOBJPRINT:SAY( 250  , 1720  , STR0007 +  DTOC(FP5->FP5_EMISSA) ,OFONTE02 , 100 )     //"INCLUIDA EM :  "
OOBJPRINT:SAY( 300  , 0080  , REPLICATE("_",120),OFONTE02 , 100 )
OOBJPRINT:SAY( 350  , 0080  , IIF(!EMPTY(FP0->FP0_PROSPE),STR0008+FP0->FP0_PRONOM,STR0009 + FP0->FP0_CLINOM),OFONTE02 , 100 ) //"PROSPECT :  "###"CLIENTE :  "
OOBJPRINT:SAY( 400  , 0080  , STR0010 + FP0->FP0_CLICON,OFONTE02 , 100 ) //"CONTATO :  "
OOBJPRINT:SAY( 400  , 1100  , STR0011 + FP0->FP0_CLIDDD+"-"+FP0->FP0_CLITEL,OFONTE02 , 100 ) //"TELEFONES :  "
OOBJPRINT:SAY( 400  , 1800  , STR0012 + FP0->FP0_CLIFAX,OFONTE02 , 100 ) //"FAX :   "
OOBJPRINT:SAY( 450  , 0080  , STR0013 +LOWER(FP0->FP0_CLIEMA) ,OFONTE02 , 100 ) //"EMAIL :   "
OOBJPRINT:SAY( 500  , 0080  , REPLICATE("_",120),OFONTE02 , 100 )
    
OOBJPRINT:SAY( 550  , 0080  , STR0014 + SUBSTR(CDADOSOB,1,60)      ,OFONTE02 , 100 ) //"OBRA :    "
OOBJPRINT:SAY( 550  , 1100  , STR0015 + CCONTATO      ,OFONTE02 , 100 ) //"CONTATO:  "
    
OOBJPRINT:SAY( 600  , 0080  , STR0016 + CENDER,OFONTE02 , 100 ) //"ENDERECO : "
OOBJPRINT:SAY( 650  , 0080  , STR0017 + CBAIRR,OFONTE02 , 100 ) //"BAIRRO :   "
OOBJPRINT:SAY( 650  , 1100  , STR0018 + CMUNIC,OFONTE02 , 100 ) //"CIDADE :   "
OOBJPRINT:SAY( 650  , 1800  , STR0019 + CESTAD,OFONTE02 , 100 ) //"ESTADO :   "
    
OOBJPRINT:SAY( 700  , 0080  , STR0020 + CTELE ,OFONTE02 , 100 ) //"TELEFONE :   "
OOBJPRINT:SAY( 700  , 0600  , STR0012      + CFAX,OFONTE02 , 100 ) //"FAX :   "
OOBJPRINT:SAY( 700  , 1100  , STR0013 + LOWER(CEMAIL) ,OFONTE02 , 100 ) //"EMAIL :   "
        
OOBJPRINT:SAY( 750  , 0080  , REPLICATE("_",120),OFONTE02 , 100 )
OOBJPRINT:SAY( 800  , 850  , STR0021    , OFONTE03   , 100 ) //"DESCRIÇÃO DOS SERVIÇOS"

NLINHA := 850
    
XT   := MLCOUNT(FP5->FP5_OBSERV,_NLINCOL)
NAUX := (XT*050)+050

OOBJPRINT:BOX( NLINHA  , 0060  , NLINHA+NAUX , 2330)	//2350 )   
    
NLINOBS := NLINHA
FOR I:=1 TO XT
	OOBJPRINT:SAY( NLINOBS , 0080 ,  MEMOLINE(FP5->FP5_OBSERV ,_NLINCOL, I )       , OFONTE08   , 100 ) 
	IF NLINOBS > 3200
		OOBJPRINT:ENDPAGE()        
		OOBJPRINT:STARTPAGE()
		OOBJPRINT:BOX( 0100 , 0050 , 3350 , 2370)    
		NLINOBS := 100
	ENDIF
	NLINOBS := NLINOBS + 50
NEXT I  
    
NLINHA := NLINOBS + 100
OOBJPRINT:BOX(NLINHA  , 060  ,  NLINHA+60 , 2330)	//2350 )   
OOBJPRINT:SAY(NLINHA+10  , 1100  ,  STR0022    , OFONTE02  , 100 ) //"OBSERVACOES"

XT     := MLCOUNT(FP5->FP5_OBS,_NLINCOL)
NAUX   := (XT*050)+100

NLINHA := NLINHA +60
OOBJPRINT:BOX( NLINHA  , 0060  , NLINHA+NAUX , 2330)	//2350 )   

NLINOBS := NLINHA + 50
FOR I:=1 TO XT
	OOBJPRINT:SAY( NLINOBS , 0080 ,  MEMOLINE(FP5->FP5_OBS ,_NLINCOL, I )       , OFONTE08   , 100 ) 
	IF NLINOBS > 3200
    	OOBJPRINT:ENDPAGE()        
		OOBJPRINT:STARTPAGE()
		OOBJPRINT:BOX( 0100 , 0050 , 3350 , 2370)    
		NLINOBS := 100
	ENDIF
	NLINOBS := NLINOBS + 50
NEXT I 
    
CCODRAT := FP5->FP5_COD
CCODREV := FP5->FP5_REVISA
CCOMPLE := FP5->FP5_COMPLE
    
NAUX    := 0
NLINHA  := NLINOBS + 100
IF NLINHA > 3200
	OOBJPRINT:ENDPAGE()        
	OOBJPRINT:STARTPAGE()
	OOBJPRINT:BOX( 0100 , 0050 , 3350 , 2370)    
	NLINHA := 100
ENDIF

OOBJPRINT:BOX( NLINHA +NAUX , 060  , NLINHA+60 , 2330)	//2350 )   
OOBJPRINT:SAY( NLINHA +NAUX+10 , 850  , STR0023    , OFONTE02   , 100 ) //"CARACTERISTICAS DO OBJETO"
NLINHA := NLINOBS + 150
    
AAREAZA8 := FP5->(GETAREA())
DBSELECTAREA("FP5")
NLINHA   := NLINHA+030
    
OOBJPRINT:BOX(NLINHA  	 , 060   , NLINHA+60 		, 2330)	//2350 )
OOBJPRINT:SAY(NLINHA+3   , 0080  , STR0024 	,OFONTE02 , 100 )		 //"DESCRIÇÃO: "
OOBJPRINT:SAY(NLINHA+3   , 0620  , "C" 				,OFONTE02 , 100 )
OOBJPRINT:SAY(NLINHA+3   , 0870  , "L" 				,OFONTE02 , 100 )
OOBJPRINT:SAY(NLINHA+3   , 1160  , "A" 				,OFONTE02 , 100 )
OOBJPRINT:SAY(NLINHA+3   , 1465  , "D"	 			,OFONTE02 , 100 )
OOBJPRINT:SAY(NLINHA+3   , 1700  , "P (TON)"	 	,OFONTE02 , 100 )
OOBJPRINT:SAY(NLINHA+3   , 1950  , STR0025 		,OFONTE02 , 100 ) //"DESENHO"

NLINHA   := NLINHA+070
    	
WHILE !EOF() .AND. FP5->FP5_PROJET + FP5->FP5_OBRA + FP5->FP5_COD + FP5->FP5_REVISA + FP5->FP5_COMPLE == ;
                   FP1->FP1_PROJET + FP1->FP1_OBRA +  CCODRAT     +      CCODREV    + CCOMPLE
	    
	IF NLINHA > 3100
		OOBJPRINT:ENDPAGE()        
		OOBJPRINT:STARTPAGE()
		NLINHA   := 100
		NAUX     := 0
	ENDIF
    /*
	OOBJPRINT:SAY(NLINHA +NAUX , 0080  , "DESCRIÇÃO: " ,OFONTE02 , 100 )		
	OOBJPRINT:SAY(NLINHA +NAUX , 0670  , "C : " ,OFONTE02 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 0950  , "L : " ,OFONTE02 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 1210  , "A : " ,OFONTE02 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 1470  , "D : " ,OFONTE02 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 1730  , "P (TON) : " ,OFONTE02 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 2100  , "DESENHO:  " ,OFONTE02 , 100 )
	*/
	OOBJPRINT:SAY(NLINHA +NAUX , 0080  , SUBSTR(ALLTRIM(FP5->FP5_DESC),1,19) ,OFONTE08 , 100 )

	OOBJPRINT:SAY(NLINHA +NAUX , 0500  , TRANSFORM(FP5->FP5_COMP,"@E 999,999,999.99") ,OFONTE08 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 0750  , TRANSFORM(FP5->FP5_LARG,"@E 999,999,999.99") ,OFONTE08 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 1050  , TRANSFORM(FP5->FP5_ALTU,"@E 999,999,999.99") ,OFONTE08 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 1350  , TRANSFORM(FP5->FP5_DIAM,"@E 999,999,999.99") ,OFONTE08 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 1650  , TRANSFORM(FP5->FP5_PESO,"@E 999,999,999.99") ,OFONTE08 , 100 )
	OOBJPRINT:SAY(NLINHA +NAUX , 1950  , ALLTRIM(FP5->FP5_DESEN) ,OFONTE08 , 100 )
			    
	DBSELECTAREA("FP5")
	DBSKIP()
	
	NAUX := NAUX + 50

ENDDO 
	
NLINHA := NLINHA + NAUX + 100
	
RESTAREA(AAREAZA8)
OOBJPRINT:BOX(NLINHA     , 0060  , NLINHA+60 , 2330)	//2350 )   	
OOBJPRINT:SAY(NLINHA+10  , 1000  , STR0026    , OFONTE02   , 100 ) //"DESCRICAO DA OPERACAO"

XT     := MLCOUNT(FP5->FP5_OBSOPE,_NLINCOL)
NAUX   := (XT*050)+100

NLINHA := NLINHA +60
OOBJPRINT:BOX( NLINHA  , 0060  , NLINHA+NAUX , 2330)	//2350 )   

NLINOBS := NLINHA + 10
FOR I:=1 TO XT
	OOBJPRINT:SAY( NLINOBS , 080,  MEMOLINE(FP5->FP5_OBSOPE ,_NLINCOL, I )       , OFONTE08   , 100 ) 
	IF NLINOBS > 3200
		OOBJPRINT:ENDPAGE()        
		OOBJPRINT:STARTPAGE()
		OOBJPRINT:BOX( 0100 , 0050 , 3350 , 2370)    
		NLINOBS := 100
	ENDIF
	NLINOBS := NLINOBS + 50
NEXT I 
    
NAUX   := 0
NLINHA := NLINOBS + 50
NLINHA := NLINHA +100

IF NLINHA > 3200
	OOBJPRINT:ENDPAGE()        
	OOBJPRINT:STARTPAGE()
	NLINHA := 100
	NAUX   := 0
ENDIF

OOBJPRINT:BOX( NLINHA  , 0060  , NLINHA+60 , 2330)	//2350 ) 
OOBJPRINT:SAY( NLINHA+10  , 950  , STR0027                 , OFONTE02   , 100 ) //"EQUIPAMENTOS NECESSARIOS"
    
XT     := MLCOUNT(FP5->FP5_OBSEQU,_NLINCOL)
NAUX   := (XT*050)+100

NLINHA := NLINHA +60
OOBJPRINT:BOX( NLINHA  , 0060  , NLINHA+NAUX , 2330)	//2350 )   

NLINOBS := NLINHA + 10
FOR I:=1 TO XT
	OOBJPRINT:SAY( NLINOBS , 080,  MEMOLINE(FP5->FP5_OBSEQU ,_NLINCOL, I )       , OFONTE08   , 100 ) 
	IF NLINOBS > 3200
		OOBJPRINT:ENDPAGE()        
		OOBJPRINT:STARTPAGE()
		OOBJPRINT:BOX( 0100 , 0050 , 3350 , 2370)    
		NLINOBS := 100
	ENDIF
	NLINOBS := NLINOBS + 50
NEXT I
    
NAUX   := 0 
NLINHA := NLINOBS + 50 
NLINHA := NLINHA  + 100

IF NLINHA > 3200
	OOBJPRINT:ENDPAGE()        
	OOBJPRINT:STARTPAGE()
	NLINHA := 100
	NAUX   := 0
ENDIF

OOBJPRINT:BOX( NLINHA     , 0060   , NLINHA+60 , 2330)	//2350 ) 
OOBJPRINT:SAY( NLINHA+10  ,1000  , STR0028                 , OFONTE02   , 100 ) //"ACESSORIOS DE IÇAMENTO"
	
XT     := MLCOUNT(FP5->FP5_OBSACE,_NLINCOL)
NAUX   := (XT*050)+100

NLINHA := NLINHA +60
OOBJPRINT:BOX( NLINHA  , 0060  , NLINHA+NAUX , 2330)	//2350 )   

NLINOBS := NLINHA + 10
FOR I:=1 TO XT
	OOBJPRINT:SAY( NLINOBS , 080,  MEMOLINE(FP5->FP5_OBSACE ,_NLINCOL, I )       , OFONTE08   , 100 ) 
	IF NLINOBS > 3200
		OOBJPRINT:ENDPAGE()        
		OOBJPRINT:STARTPAGE()
		OOBJPRINT:BOX( 0100 , 0050 , 3350 , 2370)    
		NLINOBS := 100
	ENDIF
	NLINOBS := NLINOBS + 50
NEXT I 
    
NAUX   := 0
NLINHA := NLINOBS + 50
NLINHA := NLINHA +100

IF NLINHA > 3200
	OOBJPRINT:ENDPAGE()        
	OOBJPRINT:STARTPAGE()
	NLINHA := 100
	NAUX   := 0
ENDIF
	
OOBJPRINT:SAY(NLINHA  , 0080  , STR0029 + DTOC(DDATAVIS)  ,OFONTE02, 100 ) //"PRAZO DE EXECUCAO :   "

NLINHA := NLINHA + 50
	
DBSELECTAREA("SA3")
DBSETORDER(1)
MSSEEK(XFILIAL("SA3") + FP5->FP5_GESTOR )

OOBJPRINT:SAY(NLINHA  ,   80  , STR0030 + DTOC(FP5->FP5_DTVIS)   ,OFONTE02 , 100 ) //"DATA DA VISTORIA :  "
OOBJPRINT:SAY(NLINHA  ,  800  , STR0031 + FP5->FP5_RESPON ,OFONTE02 , 100 ) //"RESPONSAVEL PELA ANALISE  : "

NLINHA := NLINHA + 50
OOBJPRINT:SAY(NLINHA  ,   80  , STR0032 + ALLTRIM(SA3->A3_NOME)              ,OFONTE02 , 100 ) //"GESTOR : "
	
NLINHA := NLINHA + 50
OOBJPRINT:SAY(NLINHA  ,   80  , STR0033                                     ,OFONTE02 , 100 ) //"VISTO :   "
OOBJPRINT:SAY(NLINHA  ,  800  , STR0034 + IIF(FP5->FP5_INLOCO=="S",STR0035,STR0036),OFONTE02 , 100 ) //"VISITA IN LOCO :   "###"SIM"###"NAO"
	
RETURN
