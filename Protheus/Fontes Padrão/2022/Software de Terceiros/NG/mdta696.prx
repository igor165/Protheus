#INCLUDE "mdta696.ch"
#Include "Protheus.ch"

#DEFINE _nVERSAO 1 //Versao do fonte
/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ MDTA696  ³ Autor ³ Denis Hyroshi de Souza³ Data ³13/01/2010³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Programa Cadastro de EPI's entregues aos funcionarios.      ³±±
±±³          ³O programa inicia com o browser da tabela de funcionarios,  ³±±
±±³          ³ao teclar no botao EPI, o programa mostra uma tela estilo   ³±±
±±³          ³pai filho, na parte pai dados do funcionario epi e na parte ³±±
±±³          ³filho, mostra os Epi's entregues para o funcionario, o usua-³±±
±±³          ³rio podera incluir novos.                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Objetivo  ³ Este programa irá executar a rotina MDTA695, porém, sem    ³±±
±±³          ³ opção de integração com estoque.                           ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Function MDTA696( cProgCham )

Local aNGBEGINPRM := NGBEGINPRM(_nVERSAO)
Local cUserEPI := SuperGetMv("MV_NG2U696",.F.,"")
Local cUser    := cUserName
Local aUsers   := UserEPI(cUserEPI)

If aScan(aUsers,{|x| SubStr(Upper(AllTrim(x)),1,25) == Upper(Alltrim(cUser)) }) == 0
	MsgStop(STR0001+Chr(13)+Chr(10)+; //"Este usuário não está configurado para acessar o Histórico de EPI."
			STR0002) //"O administrador do sistema deverá configurar o parâmetro MV_NG2U696 para liberar este acesso."
	Return .f.
Endif

MDTA695("MDTA696")

NGRETURNPRM(aNGBEGINPRM)
Return .t.

/*/
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³UserEPI	³ Autor ³ Denis Hyroshi de Souza  Data ³          ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Grava todos os usuarios do Historico de EPI                ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
*/
Static Function UserEPI(cUserEPI)
Local aUser    := {}
Local cUserAll := cUserEPI
Local cUserTMP := ""

While .t.
	nPos := At(",",cUserAll)
	If nPos == 0
		cUserTMP := cUserAll
		cUserAll := ""
	Else
		cUserTMP := Substr(cUserAll,1,nPos-1)
		cUserAll := Substr(cUserAll,nPos+1)
	Endif
	
	If !Empty(cUserTMP)
		aADD(aUser,Upper(Alltrim(cUserTMP)))
	Endif
	If Empty(cUserAll)
		Exit
	Endif
End

Return aUser