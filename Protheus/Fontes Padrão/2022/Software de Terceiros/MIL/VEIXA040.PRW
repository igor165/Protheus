// ͻ
//  Versao  4      
// ͼ

#include "Protheus.ch"
#include "VEIXA040.CH"

/*


Ŀ
Funcao     VEIXA040  Autor  Andre Luis Almeida                 Data  19/05/14 
Ĵ
Descricao  Agrega/Desagrega no Equipamento                                        
ٱ


*/
Function VEIXA040()
Local cFiltro     := " VV1_SITVEI='0' AND VV1_GRASEV<>'6' AND VV1_FILENT='"+xFilial("VVF")+"' "
Private cCadastro := STR0001 // Agrega/Desagrega no Equipamento
Private aRotina   := MenuDef()
//
DbSelectArea("VV1")
DbSetOrder(1)
//
mBrowse( 6, 1,22,75,"VV1",,,,,,,,,,,,,,cFiltro)

DbSelectArea("VV1")
Return()

/*


Ŀ
Funcao     MenuDef   Autor  Andre Luis Almeida                 Data  19/05/14 
Ĵ
Descricao  Menu (AROTINA) - Agrega/Desagrega no Equipamento                       
ٱ


*/
Static Function MenuDef()
Local aRotina := {}
aRotina := {{STR0002, "AxPesqui", 0, 1}, ; // Pesquisar
{STR0003, "VEIVC140(VV1->VV1_CHASSI, VV1->VV1_CHAINT)", 0, 2},; // Visualizar
{STR0004, "VEIXX040(1)", 0, 4}, ; // Agregar
{STR0005, "VEIXX040(2)", 0, 4}, ; // Desagregar
{STR0006, "VX040CANC()", 0, 5}, ; // Cancelar
{STR0007, "VEIC020(VV1->VV1_CHASSI)", 0, 4}} // Histrico Agrega/Desagrega
Return aRotina