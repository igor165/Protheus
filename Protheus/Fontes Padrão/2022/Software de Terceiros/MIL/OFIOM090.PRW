#INCLUDE "ofiom090.ch"
/*


Ŀ
Funo     OFIOM090  Autor                         Data  26/06/99 
Ĵ
Descrio  ABERTURA DE OS-ELETRONICA                                  
Ĵ
Sintaxe                                                               
Ĵ
Uso        (Oficina)                                                  
ٱ


*/
FUNCTION OFIOM090

PRIVATE aCampos := {}
PRIVATE aRotina := MenuDef()
//Ŀ
// Define o cabecalho da tela de atualizacoes                   
//
PRIVATE cCadastro := OemToAnsi(STR0006) //"Planos de Revisao"

//Ŀ
// Endereca a funcao de BROWSE                                  
//
mBrowse( 6, 1,22,75,"VO1")

Return


********************************
Function MLVISUAL(cAlias,nReg,nOpc)

PegCofiom090()
AxVisual(cAlias,nReg,nOpc,aCampos)

Return


********************************
Function MLINCLUI(cAlias,nReg,nOpc)

PegCofiom090()
AxInclui(cAlias,nReg,nOpc,aCampos)

Return


********************************
Function MLALTERA(cAlias,nReg,nOpc)

PegCofiom090()
AxAltera(cAlias,nReg,nOpc,aCampos)

Return


********************************
Function MLEXCLUI(cAlias,nReg,nOpc)

PegCofiom090()
AxDeleta(cAlias,nReg,nOpc,aCampos)

Return


Function PEGCOFIOM090()
Local i := 0
aCampos := {}
bBloco := {|nCPO|  Field(nCPO) }
StrCampos := "0203070809101204"
For i=1 to len(StrCampos) STEP 2
    j := val(substr(StrCampos,i,2))
    aadd(aCampos,FieldName(j))
Next

Return

Static Function MenuDef()
Local aRotina := { { STR0001 ,"AxPesqui", 0 , 1},; 		//Pesquisar
                     { STR0002,"MlVisual", 0 , 2},; 	//Visualizar
                     { STR0003   ,"MlInclui", 0 , 3},; 	//Incluir
                     { STR0004   ,"MlAltera", 0 , 4},; 	//Alterar
                     { STR0005   ,"MlExclui", 0 , 5} } 	//Excluir
Return aRotina
