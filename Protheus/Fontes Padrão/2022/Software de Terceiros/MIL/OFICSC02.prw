// ษออออออออหออออออออป
// บ Versao บ 003    บ
// ศออออออออสออออออออผ

#Include "PROTHEUS.CH"
#include "OFICSC02.ch"
/*
===============================================================================
###############################################################################
##+----------+------------+-------+-----------------------+------+----------+##
##|Funcao    | OFICSC02   | Autor |Carla Catiane F R      | Data | 06/05/14 |##
##+----------+------------+-------+-----------------------+------+----------+##
##|Descricao | Consulta Informacoes do WHI Scania.                          |##
##+----------+--------------------------------------------------------------+##
##|Uso       | Oficina integra็ใo com Montadora Scania                      |##
##+----------+--------------------------------------------------------------+##
###############################################################################
===============================================================================
*/
Function OFICSC02(lNoMBrowse, nOpcAux)

Default lNoMBrowse := .f.
Default nOpcAux    := 2

Private cCadastro := ""
Private aRotina := MenuDef()

Private cVV1Mostra := "VV1_CHASSI/VV1_CHAINT/VV1_MODVEI/VV1_DESMOD/VV1_FABMOD/VV1_DATVEN/VV1_DTUVEN/VV1_PROATU/VV1_LJPATU/VV1_NOMPRO/VV1_DATETG"

DbSelectArea("VV1")
If lNoMBrowse
	If ( nOpcAux <> 0 ) .And. !Deleted()
		bBlock := &( "{ |a,b,c,d,e| " + aRotina[ nOpcAux,2 ] + "(a,b,c,d,e) }" )
		Eval( bBlock, Alias(), (Alias())->(Recno()))
	Endif
Else
	mBrowse( 6, 1,22,75,"VV1",,,,,,,,,,,,,,)
EndIf
//

Return

/*
===============================================================================
###############################################################################
##+----------+------------+-------+-----------------------+------+----------+##
##|Funcao    | OFCSCCO2   | Autor | Takahashi             | Data | 31/04/13 |##
##+----------+------------+-------+-----------------------+------+----------+##
##|Descricao | Definicao de Menu                                            |##
##+----------+--------------------------------------------------------------+##
##|Uso       | Oficina                                                      |##
##+----------+--------------------------------------------------------------+##
###############################################################################
===============================================================================
*/
Function OFCSCCO2(cAlias, nReg)

Local cURL := GETMV("MV_MIL0034")

VV1->(DbGoto(nReg))
cURL += VV1->VV1_CHARED

ShellExecute( "Open", cURL, "", "C:\", 1 )

Return


/*
===============================================================================
###############################################################################
##+----------+------------+-------+-----------------------+------+----------+##
##|Funcao    | MenuDef    | Autor | Takahashi             | Data | 31/04/13 |##
##+----------+------------+-------+-----------------------+------+----------+##
##|Descricao | Definicao de Menu                                            |##
##+----------+--------------------------------------------------------------+##
##|Uso       | Oficina                                                      |##
##+----------+--------------------------------------------------------------+##
###############################################################################
===============================================================================
*/
Static Function MenuDef()

Local aRotina:= {{ STR0001 , "PesqBrw"   , 0 , 1},; // Pesquisar
{ STR0002 , "OFCSCCO2"  , 0 , 2}} // Cons. Chassi
Return aRotina
