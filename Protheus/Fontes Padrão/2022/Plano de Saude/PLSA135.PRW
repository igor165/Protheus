#INCLUDE "plsa135.ch"

#include "RWMAKE.CH"
#include "PLSMGER.CH"

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PLSA135 Ё Autor Ё Michele Tatagiba     Ё Data Ё 27.06.2002 Ё╠╠
╠╠цддддддддддедддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Coloca os dados do BA8 para o BR8                          Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso       Ё                                                            Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ Nenhum                                                     Ё╠╠
╠╠цддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё            ATUALIZACOES SOFRIDAS DESDE A CONSTRU─AO INICIAL           Ё╠╠
╠╠цддддддддддддбддддддддбддддддбдддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁProgramador Ё Data   Ё BOPS Ё  Motivo da Altera┤└o                     Ё╠╠
╠╠цддддддддддддеддддддддеддддддедддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠юддддддддддддаддддддддаддддддадддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Function PLSA135()

PRIVATE oDlg5

@ 96,42 TO 323,505 DIALOG oDlg5 TITLE STR0001 //"Exporta procedimentos da TDE"
@ 8,10 TO 84,222
@ 91,168 BMPBUTTON TYPE 1 ACTION ImportProc()
@ 91,196 BMPBUTTON TYPE 2 ACTION Close(oDlg5)
@ 23,14 SAY STR0002 size 150,015 //"Este programa tem como objetivo exportar os procedimentos  "
@ 33,14 SAY STR0003 size 150,015 //"da TDE para a Tabela Padrao. "
@ 43,14 SAY STR0004 size 150,015 //"- Acrescenta registro no BR8 "
ACTIVATE DIALOG oDlg5
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim do Programa Principal...                                        Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return                                 

Static Function ImportProc
MsAguarde({ || OKProc() }, STR0005) //"Aguarde"

Close(oDlg5)
Return

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o	 ЁOKProc    ЁAutor  Ё Michele Tatagiba            Ё Data Ё 27.06.02 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o ЁUsado para importar os procedimentos                              Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 ЁPLSA135                                                           Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Static Function OKProc()
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis...                                                      Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
PRIVATE cDesc    := ""
PRIVATE cCodPro  := ""
PRIVATE cCodPad  := ""
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Exibe mensagens...                                                  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
MsProcTXT(STR0006) //"Aguarde. Exportando os procedimentos..."
BA8->(DbGoTop())
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Inicia e importa arquivo AMB1                                       Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
While ! BA8->(Eof())
      cCodPro := BA8->BA8_CODPRO
      //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
      //Ё Mensagem informativa...                                             Ё
      //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
      MsProcTXT(STR0007+cCodPro) //"Exportando os procedimentos... "
      //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
      //Ё Verifica se espelha na Tabela Padrao                                Ё
      //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
      BF8->(DBSetOrder(1))
      If BF8->(DBSeek(xFilial("BF8")+BA8->BA8_CODTAB))
         If BF8->BF8_ESPTPD == "1"
            cCodPad := BF8->BF8_CODPAD
            If Empty(cCodPad)
               BA8->(DBSkip())
               Loop
            Endif
         Else
            BA8->(DBSkip())
            Loop
         Endif
      Else
         BA8->(DBSkip())
         Loop
      Endif
      //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
      //Ё Verifica se ja existe na Tabela Padrao                              Ё
      //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
      BR8->(DBSetOrder(1))
      If !BR8->(DBSeek(xFilial("BR8")+cCodPad+cCodPro))
         BR8->(RecLock("BR8",.T.))
         BR8->BR8_FILIAL := xFilial("BR8")
         BR7->(DBGoTop())
         While ! BR7->(Eof())
               If BR7->BR7_PROCES == "3"
                  cDado  := &("BA8->"+AllTrim(BR7->BR7_FLDTDE))
                  cCampo := "BR8->"+AllTrim(BR7->BR7_FLDPSA)
                  &cCampo := cDado
               Else
                  If BR7->BR7_PROCES == "1"
                     cDado  := &("BA8->"+AllTrim(BR7->BR7_FLDTDE))
                     cCampo := "BR8->"+AllTrim(BR7->BR7_FLDPSA)
                     &cCampo := cDado
                  Endif
               Endif
         BR7->(DbSkip())
         Enddo

         BR8->BR8_BENUTL := "0"
         BR8->(MsUnLock())
      Endif
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Acessa proximo registro do arquivo...                               Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
BA8->(DbSkip())
Enddo
MsgInfo(STR0008)   //"Exportacao Concluida."
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina...                                                    Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return

