#INCLUDE "APWEBEX.CH"
#INCLUDE "PROTHEUS.CH"
#INCLUDE "PPLMFUN.CH"
#INCLUDE "PLSMGER.CH"

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLTPCHM 	  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Chamada do menu consulta ou sadt								Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLTPCHM()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁOperadora padrao
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
wcGetIntPad()

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Verificar permissЦo de acesso do botao internados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:CcUsr	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
HttpSession->cBtIntern := ""

If oObj:VALACEBOT()
	If LEN(oObj:OWSVALACEBOTRESULT:OWSSUSUARIO) > 0
		HttpSession->cBtIntern := oObj:OWSVALACEBOTRESULT:OWSSUSUARIO[1]:CPERMITE
	EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁDefine o tipo de entrada de dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If ValType(HttpSession->cTipCar) == 'U'
	If HttpSession->USR_INFO[1]:OWSUSERLOGPLS:cTipCar == '1'
		HttpSession->cTipCar := "1"
	Else
		HttpSession->cTipCar := "0"
	EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁTipo de pre-atendimento se vai pre-atender ou atender (executar)		   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cTpPreAte := "0"
HttpSession->cBtInterna:= "0"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina para entrar com a matricula							   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLCARTMAT" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLSTIPCAR  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Alimenta variavel de sessao									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSTIPCAR()
LOCAL cResult := "true"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDefine o tipo de entrada de dados									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cTipCar := HttpGet->cTipCar

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cResult
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLSDADUSR  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Carrega dados do usuario e envia para consulta ou sadt		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSDADUSR()
LOCAL nI
LOCAL oObj
LOCAL oObjPar
LOCAL nPos
LOCAL lUnimeds
LOCAL cResult 		:= ""
LOCAL cSepara1 		:= ""
LOCAL cSepara2 		:= ""
LOCAL cSepara3 		:= ""
LOCAL cNomeCartao 	:= ""
LOCAL cViaCartao 	:= ""
LOCAL cNumCartao 	:= ""
LOCAL cDtValid 		:= ""
LOCAL cLocalCob		:= ""
LOCAL cProduto		:= ""
LOCAL cAbrange		:= ""
LOCAL cNatJuri		:= ""
LOCAL aCartao 		:= {}
LOCAL aMatrCartao 	:= {}
LOCAL lPreAten      := .F.
LOCAL cResultInc    := "" //variavel usada para pegar o retorno da inclusЦo na grid quando o pre atendimento for no atendimento
LOCAL lDigiRetro	:= .T.
LOCAL CDATALIMIT	:= ""
local cCodLdp := ""
LOCAL cHtml := ""
Local lTimeAte	:= .F.
Local nTmpIni := Seconds()

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Pega o parametro													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjPar := WSCFGDICTIONARY():New()
WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PLSUNI"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjPar:GETPARAM()
	lUnimeds := IiF( AllTrim(oObjPar:cGETPARAMRESULT)=="1",.T.,.F.)
EndIf

oObjPar:cMVPARAM	:= "MV_PTIMATE" 
If oObjPar:GETPARAM()
	lTimeAte := oObjPar:cGETPARAMRESULT
	If ValType(lTimeAte) == 'U'
		lTimeAte := .F.
	ElseIf	ValType(lTimeAte) == 'C'
		If Type(lTimeAte)=="L"
			lTimeAte := &(lTimeAte)
		EndIf
	EndIf
EndIf
//Guarda a trilha informada

If At( "_pntItrrog_", HttpGet->TrilhaCard ) > 0
 	HttpGet->TrilhaCard := StrTran( HttpGet->TrilhaCard, "_pntItrrog_", "?" )
EndIf

If At( "_pntmod_", HttpGet->TrilhaCard ) > 0
 	HttpGet->TrilhaCard := StrTran( HttpGet->TrilhaCard, "_pntmod_", "%" )
EndIf

If At( "_2pnt_", HttpGet->TrilhaCard ) > 0
 	HttpGet->TrilhaCard := StrTran( HttpGet->TrilhaCard, "_2pnt_", ":" )
EndIf

If At( "_pntundf_", HttpGet->TrilhaCard ) > 0
 	HttpGet->TrilhaCard := StrTran( HttpGet->TrilhaCard, "_pntundf_", "Г" )
EndIf

HttpSession->TrilhaCard := HttpGet->TrilhaCard


//Verifica se o usuАrio possui permissЦo para digitar guia retroativa no portal
If ValType(HttpGet->lDigiRetro) <> "U" .and. (HttpGet->lDigiRetro == "true")
	//Chamar funГЦo para verificar se o usuАrio tem permissЦo
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	oObj:cUSERCODE	:= "MSALPHA"
	oObj:cRDACode		:= HttpGet->cRda
	oObj:cCodLoc		:= HttpGet->cCodLoc
	oObj:cCUsr			 := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
	oObj:cUserCardNumber := HttpGet->TrilhaCard
	oObj:cDatGuia		    := HttpGet->dDtaAtd

	//Verificar se existe calendАrio de pagamento cadastrado para essa RDA e localidade
	If oObj:GETCALEND() .and. !Empty(oObj:cGETCALENDRESULT)
		If oObj:GETDIARETRO() .and. !("false" $ oObj:CGETDIARETRORESULT)
			cDataLimit := oObj:CGETDIARETRORESULT
		Else
			//cResult := "false|Sem permissЦo para digitar guia para esse prestador."
			cResult := oObj:CGETDIARETRORESULT
			lDigiRetro := .F.
		EndIf
	Else
		cResult := "false|NЦo hА calendАrio cadastrado, entre em contato com a operadora."
		lDigiRetro := .F.
	EndIf

	/* 	Como pode ser informado tanto o nЗmero da carteirinha
	*	quanto o nЗmero da matrМcula (BA1_MATEMP),
	* 	verificamos nesse ponto se o nЗmero informado И de matrМcula (isto И, se for encontrado BA1_MATEMP).
	*	Caso positivo, substituimos o nЗmero pela carteirinha para validaГЦo.
	*	Caso negativo, continua com o nЗmero informado.
	*/
	If lDigiRetro .and. oObj:VLDBA1MATEMP()
		If !Empty(oObj:cVLDBA1MATEMPRESULT)
			HttpGet->TrilhaCard 		:= oObj:cVLDBA1MATEMPRESULT
			HttpSession->TrilhaCard 	:= HttpGet->TrilhaCard
		EndIf
	EndIf

	if oObj:GETDIGP()
		cCodLdp := oObj:cGETDIGPRESULT

		if alltrim(cCodLdp) = ""
			cResult := "false|O parБmetro MV_PLSDIGP nЦo estА configurado, entre em contato com a operadora."
			lDigiRetro := .F.
		else
			if alltrim(cCodLdp) = "9999"
				cResult := "false|O parБmetro MV_PLSDIGP estА configurado de forma errada (Valor: 9999), entre em contato com a operadora."
				lDigiRetro := .F.
			endif
		endif
	endif


EndIf

If lDigiRetro
	//Guardo a data de atendimento informada na digitaГЦo de guias
	HttpSession->dDtaAtend := HttpGet->dDtaAtd
	If Len(HttpGet->TrilhaCard) >= 16 .Or. !lUnimeds
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Para ponto de entrada tratamento das trilhas de carcao					 Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If ExistBlock("PLSCARD")
			aMatrCartao := ExecBlock("PLSCARD",.F.,.F.,{HttpGet->TrilhaCard,HttpSession->cTipCar})
			If Len(aMatrCartao) > 0 .And. Empty(aMatrCartao[9])
				cNumCartao 	:= aMatrCartao[1]
				cNomeCartao := aMatrCartao[2]
				cViaCartao 	:= aMatrCartao[3]
				cDtValid 	:= aMatrCartao[4]
				cLocalCob	:= aMatrCartao[5]
				cProduto	:= aMatrCartao[6]
				cAbrange	:= aMatrCartao[7]
				cNatJuri	:= aMatrCartao[8]
				cMsgErro	:= aMatrCartao[9]
			Else
			   If Empty(aMatrCartao[9])
				   cResult := "false|Passe o cartao novamente"
			   Else
			  	   cResult := "false|"+aMatrCartao[9]
			   EndIf
			EndIf
	    Else
			//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Valida trilha																Ё
			//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			HttpGet->TrilhaCard := Upper(HttpGet->TrilhaCard)
			nPos := At( ":", HttpGet->TrilhaCard )
			If nPos > 0
			   HttpGet->TrilhaCard := Upper(SubStr(HttpGet->TrilhaCard,1,nPos))+'Г'+SubStr( HttpGet->TrilhaCard,(nPos+2),Len(HttpGet->TrilhaCard) )
			EndIf
			//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Case																		Ё
			//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			Do Case
				Case At( "?", HttpGet->TrilhaCard ) > 0
					cSepara1 := "?"
					cSepara2 := "%"
					cSepara3 := ";"
				Case At( ":", HttpGet->TrilhaCard ) > 0
					cSepara1 := ":"
					cSepara2 := "%"
					cSepara3 := "Г"
			EndCase
			//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Separa																		Ё
			//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			If !Empty( cSepara1 )
				aCartao := Separa( HttpGet->TrilhaCard, cSepara1 )
				If Empty(aCartao) .Or. Len(aCartao) < 2
				   cResult := "false|Passe o cartao novamente"
				EndIf
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Tratamento matriz cartao													Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				aMatrCartao := Separa( SubStr( aCartao[2], At( cSepara3, aCartao[2] ) + 1 ), "=" )
				If Empty(aMatrCartao) .Or. Len(aMatrCartao) < 3
				   cResult := "false|Passe o cartao novamente"
				EndIf
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Pega os valores															    Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				If Empty(cResult)
					cNumCartao 	:= aMatrCartao[1]
					cViaCartao 	:= SubStr( aMatrCartao[2], 1, 2 )
					cDtValid 	:= SubStr( aMatrCartao[2], 3, 4 )
					cLocalCob	:= SubStr( aMatrCartao[3], 1, 4 )
					cProduto	:= SubStr( aMatrCartao[3], 5, 3 )
					cAbrange	:= SubStr( aMatrCartao[3], 8, 1 )
					cNatJuri	:= SubStr( aMatrCartao[3], 9, 1 )
					cNomeCartao := PLSDECODE(aCartao[1])
					cNomeCartao := StrTran(cNomeCartao,"%","")

				EndIf
			Else
				cNumCartao := HttpGet->TrilhaCard
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Verifica se existe alfa na scrintg											Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				If lUnimeds
					For nI:=1 To Len(AllTrim(HttpGet->TrilhaCard))
				      	lOk := IsAlpha(SubStr(HttpGet->TrilhaCard,	nI,1))
				      	If lOk
						   cResult := "false|Conteudo invalido"
					    EndIf
					Next
				EndIf
			EndIf
		EndIf
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё se nao tiver critica														Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If Empty(cResult)
			//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Valida a Data da Validade Carteirinha										Ё
			//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			If !Empty(cDtValid) .And. cDtValid < Substr(StrZero(Year(Date()),4),3,2)+StrZero( Month( Date() ),2)
				cResult := "false|Data de validade do cartЦo vencida"
			Else
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё obj																			Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				oObj := WSPLSXFUN():New()
				WsChgURL( @oObj, "PLSXFUN.APW" )
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Parametros																    Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				oObj:cUSERCODE			:= "MSALPHA"
				oObj:cUSERCARDNUMBER	:= cNumCartao
				oObj:cUSERCARDNAME	    := cNomeCartao
				oObj:cLocalExec			:= "1"
				oObj:cAreaAbr			:= cAbrange
				oObj:cUserCardEdition   := cViaCartao
				oObj:cDatGuia		    := HttpGet->dDtaAtd
				If ValType(HttpGet->lBloqGui) <> "U"
					oObj:LBLOQGUI		:= iif ("true" $ HttpGet->lBloqGui,.T.,.F.)
				Endif

				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Executa o metodo															Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				If oObj:USERCARDVALIDATION()
					//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//Ё Verifica se teve critica													Ё
					//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					If Len(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI) == 0
						//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Nome do cartao																Ё
						//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					    If Empty(cNomeCartao)
						    cNomeCartao := WTDecode(oObj:oWSUSERCARDVALIDATIONRESULT:cCARDNAME)
						EndIf
						//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Validade																	Ё
						//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					    If Empty(cDtValid)
						    cDtValid := DToS(oObj:oWSUSERCARDVALIDATIONRESULT:dValCar)
						EndIf
						//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Produto																		Ё
						//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						If Empty(cProduto)
						    cProduto := oObj:oWSUSERCARDVALIDATIONRESULT:cPlano
						EndIf
						//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Matriz de sessao															Ё
						//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						HttpSession->aVldCartao := {	cNomeCartao,;										//01
													 	oObj:oWSUSERCARDVALIDATIONRESULT:cCardNumber,;		//02
														cViaCartao,;										//03
														cDtValid,;											//04
														cLocalCob,;											//05
														cProduto,;											//06
														cAbrange,;											//07
														cNatJuri,;											//08
														oObj:oWSUSERCARDVALIDATIONRESULT:cNumCarNac,;		//09
														oObj:oWSUSERCARDVALIDATIONRESULT:lInterchange,;		//10
														oObj:oWSUSERCARDVALIDATIONRESULT:cCardNumberOld,;	//11
														oObj:oWSUSERCARDVALIDATIONRESULT:cTelefone,;		//12
														oObj:oWSUSERCARDVALIDATIONRESULT:cNomTit,;			//13
														oObj:oWSUSERCARDVALIDATIONRESULT:cNomEmp,;			//14
														oObj:oWSUSERCARDVALIDATIONRESULT:cVida,;			//15
														oObj:oWSUSERCARDVALIDATIONRESULT:cDig1,;			//16
														oObj:oWSUSERCARDVALIDATIONRESULT:cDig2,;			//17
														oObj:oWSUSERCARDVALIDATIONRESULT:cTpAcom,;			//18
														oObj:oWSUSERCARDVALIDATIONRESULT:cPadCon,;			//19
														oObj:oWSUSERCARDVALIDATIONRESULT:cDesAcom}			//20
						//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Carrega para o determinado formulario consulta,sadt etc						Ё
						//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						If Valtype(HttpSession->USR_INFO) != "U"
							If HttpSession->USR_INFO[1]:OWSUSERLOGPLS:cBiometria == '1' .And. (!oObj:oWSUSERCARDVALIDATIONRESULT:lInterchange .Or. oObj:oWSUSERCARDVALIDATIONRESULT:lChkBioInter)
								//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
								//Ё Form da biometria													   Ё
								//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
								cDigital := oObj:oWSUSERCARDVALIDATIONRESULT:cDig1+oObj:oWSUSERCARDVALIDATIONRESULT:cDig2

								//зддддддддддддддддддддддддддддддддддддддддддддддддддддд©
								//ЁPonto de entrada que habilita a biometria via portal.Ё
								//юддддддддддддддддддддддддддддддддддддддддддддддддддддды

								If ExistBlock("PPLBiomet")
								   If ExecBlock('PPLBiomet',.F.,.F.,{cNumCartao})
									   cResult := "true|S|" + AllTrim( Iif( Empty( cDigital ),'1','2' ) )+'|'+cDigital+'|'+HttpSession->USR_INFO[1]:OWSUSERLOGPLS:cBiometriaCad+'|'+'Biometria'
								   Else
								       cResult := "true|N"
								   Endif
								Else
		      						cResult := "true|S|" + AllTrim( Iif( Empty( cDigital ),'1','2' ) )+'|'+cDigital+'|'+HttpSession->USR_INFO[1]:OWSUSERLOGPLS:cBiometriaCad+'|'+'Biometria'
								EndIf
							Else
								cResult := "true|N"
							EndIf
						Else
							cResult := "true|N"
						Endif
					Else

						//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё valida se permite continuar pre-atendimento mesmo com critica	 			   Ё
						//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						If HttpSession->cBtInterna == "1"

							If !oObj:oWSUSERCARDVALIDATIONRESULT:lCritPreAtdm
								cResult := "false|"
							Else

								 If Empty(cNomeCartao)
								    cNomeCartao := WTDecode(oObj:oWSUSERCARDVALIDATIONRESULT:cCARDNAME)
								EndIf
								//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
								//Ё Validade																	Ё
								//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
							    If Empty(cDtValid)
								    cDtValid := DToS(oObj:oWSUSERCARDVALIDATIONRESULT:dValCar)
								EndIf
								//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
								//Ё Produto																		Ё
								//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
								If Empty(cProduto)
								    cProduto := oObj:oWSUSERCARDVALIDATIONRESULT:cPlano
								EndIf
								//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
								//Ё Matriz de sessao															Ё
								//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
								HttpSession->aVldCartao := {	cNomeCartao,;										//01
													 	oObj:oWSUSERCARDVALIDATIONRESULT:cCardNumber,;		//02
														cViaCartao,;										//03
														cDtValid,;											//04
														cLocalCob,;											//05
														cProduto,;											//06
														cAbrange,;											//07
														cNatJuri,;											//08
														oObj:oWSUSERCARDVALIDATIONRESULT:cNumCarNac,;		//09
														oObj:oWSUSERCARDVALIDATIONRESULT:lInterchange,;		//10
														oObj:oWSUSERCARDVALIDATIONRESULT:cCardNumberOld,;	//11
														oObj:oWSUSERCARDVALIDATIONRESULT:cTelefone,;		//12
														oObj:oWSUSERCARDVALIDATIONRESULT:cNomTit,;			//13
														oObj:oWSUSERCARDVALIDATIONRESULT:cNomEmp,;			//14
														oObj:oWSUSERCARDVALIDATIONRESULT:cVida,;			//15
														oObj:oWSUSERCARDVALIDATIONRESULT:cDig1,;			//16
														oObj:oWSUSERCARDVALIDATIONRESULT:cDig2,;			//17
														oObj:oWSUSERCARDVALIDATIONRESULT:cTpAcom,;			//18
														oObj:oWSUSERCARDVALIDATIONRESULT:cPadCon,;			//19
														oObj:oWSUSERCARDVALIDATIONRESULT:cDesAcom}			//20


								cResult := "true|T|"

							EndIf

							For nI := 1 To Len(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI)
							    If !Empty(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)

									If !oObj:oWSUSERCARDVALIDATIONRESULT:lCritPreAtdm
										cResult += AllTrim(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)+" - "+AllTrim(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESSEQ)+Chr(13)
									Else
										cResult += AllTrim(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)+" - "+AllTrim(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESSEQ)+Chr(13) + "|"
									EndIf
								EndIf
							Next
						Else

							cResult := "false|"

							For nI := 1 To Len(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI)

							    If !Empty(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)

									cResult += AllTrim(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)+" - "+AllTrim(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESSEQ)+Chr(13)
								EndIf
							Next
						EndIf
					EndIf
				Else
					cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
				EndIf
			EndIf
		EndIf
	Else
		cResult := "false|Matricula invalida"
	EndIf
EndIf

if "true" $ cResult
	if ExistBlock("PLSVLDC")//Ё Para ponto de entrada para validacoes complementares apos as validacoes  padroesЁ
		cResult := ExecBlock("PLSVLDC",.F.,.F.,{HttpGet->TrilhaCard,HttpSession->cTipCar,aMatrCartao,cResult})
	endif

	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Verifica se И preatendimento no atendimento													Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if ValType(HttpGet->lPreAten) <> "U" .AND. HttpGet->lPreAten == "true"
		//eu atribui os valores direto no HttpGet porque a funГЦo que И chamada dentro do W_PPLENVPRT() usa o HttpGet, jА que ela era
		//usada dentro da funГЦo de pre atendimento antiga
		HttpGet->cMatric := oObj:oWSUSERCARDVALIDATIONRESULT:cCardNumber
		HttpGet->cNomeUsu := alltrim(cNomeCartao)

		if !("true|S" $ cResult) .OR. ("Biometria" $ cResult) //se nЦo precisa validar a biometria eu prossigo  //Identificar o processo de Biometria na tela de Atendimento
			cResult = StrTran(cResult, "Biometria", "")
			cResultInc := W_PPLENVPRT()
			if "false" $ cResultInc
				cResult := cResultInc
			else
				//separador do result deste metodo com o do W_PPLENVPRT
				cResultInc :=  substr(cResultInc, 6, len(alltrim(cResultInc)))
				cResult += "#" + cResultInc
			endif
		endif
	else
		HttpSession->cBtInterna := "0"
	endif
	If ValType(cDataLimit) <> "U" .and. !Empty(cDataLimit)
		//Adiciona data limite, caso possua
		cResult += "@" + cDataLimit
	EndIf
endif

WEB EXTENDED END

//Mostra o tempo que durou pra confirmar o atendimento
If lTimeAte
    oObjPar:cMsgLog  := "1) " + Time()+ "|" + Alltrim(Str(Seconds() - nTmpIni)) + "|" + HttpGet->cRDA
    oObjPar:cFileLog := "PreAtendimento.txt"
    oObjPar:PutPLSLogFil()
EndIf

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLENVFOR  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Alimenta Sessions rda e envia pra tela de consulta ou sadt	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLENVFOR()
LOCAL oObj
LOCAL cCodConsulta 	:= ""
LOCAL cHtml 		:= ""
LOCAL cCookie 		:= ""
LOCAL cAprNumImp	:= "0" // NЦo Apresenta o campo NЗmero Impresso no Portal
PRIVATE lPreAten := .T.

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDefine se vai mostrar o botao voltar na impressao da guia			   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cBVolt := "0"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁBiscoito																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cCookie := HttpCookies->SIGAPLS
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSCFGDICTIONARY():New()
WsChgURL( @oObj, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cMVPARAM	:= "MV_PLSCDCO"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GETPARAM()
	cCodConsulta := oObj:cGETPARAMRESULT
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro que indica se apresenta o campo de Numero Impresso no Portal Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cMVPARAM	:= "MV_PLSNIMP"

If oObj:GETPARAM()
	cAprNumImp := oObj:cGETPARAMRESULT
	If ValType(cAprNumImp) == 'L'
		cAprNumImp := IIF(cAprNumImp,"1","0")
   ElseIf ValType(cAprNumImp) == 'C'
   	cAprNumImp := IIF(cAprNumImp==".T.","1","0")
   EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁVerifica se esta ligado para exibir todos os profissionais
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cMVPARAM	:= "MV_PLSPRFS" // .T. filtra - .F.  lista todos

If oObj:GETPARAM()
	HttpSession->lFiltPRF := oObj:cGETPARAMRESULT
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE := "MSALPHA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta as variaves com o x3-combobox								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
if oObj:getCombo()
	HttpSession->cCodPad   	:= oObj:oWSGETCOMBORESULT:cCodPad
	HttpSession->cCodCons  	:= SubStr(cCodConsulta,3,16)
	HttpSession->aTpDoe 	:= oObj:oWSGETCOMBORESULT:oWSCBTPDOE:oWSGenericStruct
	HttpSession->aTmpDoe  	:= oObj:oWSGETCOMBORESULT:oWSCBTMPDOE:oWSGenericStruct
	HttpSession->aIndAcid	:= oObj:oWSGETCOMBORESULT:oWSCBIndAcid:oWSGenericStruct
	HttpSession->aTpCon		:= oObj:oWSGETCOMBORESULT:oWSCBTpCon:oWSGenericStruct
	HttpSession->aTpSai 	:= oObj:oWSGETCOMBORESULT:oWSCBTpSai:oWSGenericStruct
	HttpSession->aCarSolict	:= oObj:oWSGETCOMBORESULT:oWSCBCarSolict:oWSGenericStruct
	HttpSession->aTpAtend	:= oObj:oWSGETCOMBORESULT:oWSCBTpAtend:oWSGenericStruct
	HttpSession->aViaAce	:= oObj:oWSGETCOMBORESULT:oWSCBViaAce:oWSGenericStruct
	HttpSession->aTecUti	:= oObj:oWSGETCOMBORESULT:oWSCBTecUti:oWSGenericStruct
	HttpSession->aGraPart  	:= oObj:oWSGETCOMBORESULT:oWSCBGraPart:oWSGenericStruct
	HttpSession->aTpPreAte 	:= oObj:oWSGETCOMBORESULT:oWSCbTpPreAte:oWSGenericStruct
	HttpSession->aTpAtOD   	:= oObj:oWSGETCOMBORESULT:oWSCbTpAtOD:oWSGenericStruct
	HttpSession->aTpInter	:= oObj:oWSGETCOMBORESULT:oWSCbTpInter:oWSGenericStruct
	HttpSession->aRegInter	:= oObj:oWSGETCOMBORESULT:oWSCbRegInter:oWSGenericStruct
	HttpSession->aTipGui	:= oObj:oWSGETCOMBORESULT:oWSCbTipGui:oWSGenericStruct
	HttpSession->cAprNImp   := cAprNumImp
	HttpSession->aTipFat	:= oObj:oWSGETCOMBORESULT:oWSCbTipFat:oWSGenericStruct
else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLENVFOR.APW" )
endIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁVerifica se tem RdMake compilado para tratamento no botao confirmar	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If  ExistBlock("PPLREGBTN")
	HttpSession->ExisRegEsp := '1'
Else
	HttpSession->ExisRegEsp := '0'
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama formulario de pre-atendimento									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage("PPLMOSPRE")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLENVPRT Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Alimenta Sessions rda e envia pra tela de consulta ou sadt	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLENVPRT()
LOCAL oObj
LOCAL cCodConsulta 	:= ""
LOCAL cHtml 		:= ""
LOCAL cCookie 		:= ""
LOCAL cAprNumImp	:= "0" // NЦo Apresenta o campo NЗmero Impresso no Portal
PRIVATE lPreAten := .T.

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDefine se vai mostrar o botao voltar na impressao da guia			   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cBVolt := "0"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁBiscoito																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cCookie := HttpCookies->SIGAPLS
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSCFGDICTIONARY():New()
WsChgURL( @oObj, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cMVPARAM	:= "MV_PLSCDCO"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GETPARAM()
	cCodConsulta := oObj:cGETPARAMRESULT
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro que indica se apresenta o campo de Numero Impresso no Portal Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cMVPARAM	:= "MV_PLSNIMP"

If oObj:GETPARAM()
	cAprNumImp := oObj:cGETPARAMRESULT
	If ValType(cAprNumImp) == 'L'
		cAprNumImp := IIF(cAprNumImp,"1","0")
   ElseIf ValType(cAprNumImp) == 'C'
   	cAprNumImp := IIF(cAprNumImp==".T.","1","0")
   EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁVerifica se esta ligado para exibir todos os profissionais
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cMVPARAM	:= "MV_PLSPRFS" // .T. filtra - .F.  lista todos

If oObj:GETPARAM()
	HttpSession->lFiltPRF := oObj:cGETPARAMRESULT
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE := "MSALPHA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta as variaves com o x3-combobox								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
if oObj:getCombo()
	HttpSession->cCodPad   	:= oObj:oWSGETCOMBORESULT:cCodPad
	HttpSession->cCodCons  	:= SubStr(cCodConsulta,3,16)
	HttpSession->aTpDoe 	:= oObj:oWSGETCOMBORESULT:oWSCBTPDOE:oWSGenericStruct
	HttpSession->aTmpDoe  	:= oObj:oWSGETCOMBORESULT:oWSCBTMPDOE:oWSGenericStruct
	HttpSession->aIndAcid	:= oObj:oWSGETCOMBORESULT:oWSCBIndAcid:oWSGenericStruct
	HttpSession->aTpCon		:= oObj:oWSGETCOMBORESULT:oWSCBTpCon:oWSGenericStruct
	HttpSession->aTpSai 	:= oObj:oWSGETCOMBORESULT:oWSCBTpSai:oWSGenericStruct
	HttpSession->aCarSolict	:= oObj:oWSGETCOMBORESULT:oWSCBCarSolict:oWSGenericStruct
	HttpSession->aTpAtend	:= oObj:oWSGETCOMBORESULT:oWSCBTpAtend:oWSGenericStruct
	HttpSession->aViaAce	:= oObj:oWSGETCOMBORESULT:oWSCBViaAce:oWSGenericStruct
	HttpSession->aTecUti	:= oObj:oWSGETCOMBORESULT:oWSCBTecUti:oWSGenericStruct
	HttpSession->aGraPart  	:= oObj:oWSGETCOMBORESULT:oWSCBGraPart:oWSGenericStruct
	HttpSession->aTpPreAte 	:= oObj:oWSGETCOMBORESULT:oWSCbTpPreAte:oWSGenericStruct
	HttpSession->aTpAtOD   	:= oObj:oWSGETCOMBORESULT:oWSCbTpAtOD:oWSGenericStruct
	HttpSession->aTpInter	:= oObj:oWSGETCOMBORESULT:oWSCbTpInter:oWSGenericStruct
	HttpSession->aRegInter	:= oObj:oWSGETCOMBORESULT:oWSCbRegInter:oWSGenericStruct
	HttpSession->aTipGui	:= oObj:oWSGETCOMBORESULT:oWSCbTipGui:oWSGenericStruct
	HttpSession->cAprNImp   := cAprNumImp
	HttpSession->aTipFat	:= oObj:oWSGETCOMBORESULT:oWSCbTipFat:oWSGenericStruct
else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLENVPRT.APW" )
endIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁVerifica se tem RdMake compilado para tratamento no botao confirmar	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If  ExistBlock("PPLREGBTN")
	HttpSession->ExisRegEsp := '1'
Else
	HttpSession->ExisRegEsp := '0'
EndIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return W_PPLTRAPRE()
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHABIO  Ё Autor Ё Alexander Santos     Ё Data Ё 20.01.2008 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario da biometria								 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHABIO()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLMOSBIO")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLINCBIO  Ё Autor Ё Alexander Santos     Ё Data Ё 20.01.2008 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario da biometria								 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLINCBIO()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXINC():New()
WsChgURL( @oObj, "PLSXINC.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Processa a guia																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE				:= "MSALPHA"					//Usuario
oObj:OWSINCMATBIO:cVida 	:= HttpSession->aVldCartao[15]	//Vida
oObj:OWSINCMATBIO:cAlias	:= 'BTS'						//Alias
oObj:OWSINCMATBIO:cDig		:= HttpGet->cDedo				//Digital (Dedo)
oObj:OWSINCMATBIO:cDig1		:= StrTran( HttpGet->cDig1," ","+" )//String biometrica 1
oObj:OWSINCMATBIO:cDig2		:= StrTran( HttpGet->cDig2," ","+" )//String biometrica 2
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Processa Guia																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:IncBio()
	cResult :=  oObj:CINCBIORESULT
Else
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLATEUSU    Ё Autor Ё Alexander Santos	   Ё Data Ё 02.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Carrega dados do usuario solicitacao de atendimento			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLATEUSU()
LOCAL nI
LOCAL oObj
LOCAL cResult 		:= ""
LOCAL cMsnBloqInt	:= ""
LOCAL cHtml 		:= ""
LOCAL cTipGui 		:= ""
LOCAL cCodUsr 		:= ""
LOCAL cCodRda 		:= ""
LOCAL cGuiRef 		:= ""
LOCAL cMatric 		:= ""
LOCAL cDatGui 		:= ""

WEB EXTENDED INIT cHtml START "InSite"

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё obj																			Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametros																    Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE		 := "MSALPHA"
oObj:cUSERCARDNUMBER := StrTran(StrTran(HttpGet->cMatric,".",""),"-","")
oObj:cUSERCARDNAME	 := HttpGet->cNomeUsu
oObj:cRdaCode	 	 := HttpGet->cRda
oObj:cCodLoc	 	 := HttpGet->cCodLoc
oObj:cTipAtd		 := HttpGet->cTpAte
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Executa o metodo															Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:USERCARDVALIDATION()
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Verifica se teve critica													Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If Len(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI) == 0
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Matriz de sessao															Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		HttpSession->aVldCartao := {	oObj:oWSUSERCARDVALIDATIONRESULT:cCARDNAME,;				//1
									 	oObj:oWSUSERCARDVALIDATIONRESULT:cCardNumber,;		   		//2
										AllTrim(Str(oObj:oWSUSERCARDVALIDATIONRESULT:nViaCartao)),;//3
										DToS(oObj:oWSUSERCARDVALIDATIONRESULT:dValCar),;   			//4
										oObj:oWSUSERCARDVALIDATIONRESULT:cLocalCob,;				//5
										oObj:oWSUSERCARDVALIDATIONRESULT:cPlano,;		   			//6
										oObj:oWSUSERCARDVALIDATIONRESULT:cAbrange,;		   			//7
										oObj:oWSUSERCARDVALIDATIONRESULT:cNatJuri,;		   			//8
										oObj:oWSUSERCARDVALIDATIONRESULT:cNumCarNac,;	   			//9
										oObj:oWSUSERCARDVALIDATIONRESULT:lInterchange,;				//10
										oObj:oWSUSERCARDVALIDATIONRESULT:cCardNumberOld,;	   		//11
										oObj:oWSUSERCARDVALIDATIONRESULT:cTelefone,;   				//12
										oObj:oWSUSERCARDVALIDATIONRESULT:cNomTit,;                 	//13
										oObj:oWSUSERCARDVALIDATIONRESULT:cNomEmp,;                 	//14
										oObj:oWSUSERCARDVALIDATIONRESULT:cVida,;					//15
										oObj:oWSUSERCARDVALIDATIONRESULT:cDig1,;					//16
										oObj:oWSUSERCARDVALIDATIONRESULT:cDig2,;					//17
										oObj:oWSUSERCARDVALIDATIONRESULT:cTpAcom,;					//18
										oObj:oWSUSERCARDVALIDATIONRESULT:cPadCon,;					//19
										oObj:oWSUSERCARDVALIDATIONRESULT:cDesAcom}					//20
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Lista de profissional de saude										   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If ValType(oObj:oWSUSERCARDVALIDATIONRESULT:cMsnBloInter) == "C"
			cMsnBloqInt := oObj:oWSUSERCARDVALIDATIONRESULT:cMsnBloInter
		Endif

		HttpSession->cMsnBloInt := cMsnBloqInt

		HttpSession->PROSAUD := {}
		If ! HttpGet->cTpAte $ "1,2,3,4" //Tipo de Guia 
			If oObj:ProfSaud()
				HttpSession->PROSAUD := oObj:OWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD
	
				If ValType(oObj:OWSPROFSAUDRESULT:OWSLISTPFSEXE:oWSPROFSAUD) <> "U" .And. Len(oObj:OWSPROFSAUDRESULT:OWSLISTPFSEXE:oWSPROFSAUD) > 0
					HttpSession->PROSAUDEXE := oObj:OWSPROFSAUDRESULT:OWSLISTPFSEXE:oWSPROFSAUD
				EndIF
			Else
				cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
			EndIf
		EndIf
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se e fisica ou juridica quando solicitado consulta			   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If HttpGet->cTpAte == "1"
			nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == HttpGet->cRda .And. x:cCodLoc == HttpGet->cCodLoc} )
		EndIf
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Carrega para o determinado formulario consulta,sadt etc						Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If Empty(cResult)
			If  !(Empty(cMsnBloqInt)) .and.  (HttpGet->cTpAte == "2" .OR. HttpGet->cTpAte == "4" )
				cResult :=  "true|W_PPLCHAATE.APW" + "|" + HttpSession->cMsnBloInt
			else

				cResult := "true|W_PPLCHAATE.APW|"
			EndIF
		EndIf
	Else
		cResult := "false|"
		For nI := 1 To Len(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI)
		    If !Empty(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)
				cResult += AllTrim(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)+" - "+AllTrim(oObj:OWSUSERCARDVALIDATIONRESULT:OWSUSERCRITICA:OWSUSERCARDCRI[1]:CDESSEQ)+Chr(13)
			EndIf
		Next
	EndIf
	
	//Gravo os atributos necessarios para o metodo 'isDupGui'
	cTipGui := if(HttpGet->cTpAte == "4","2",HttpGet->cTpAte)
	cCodUsr := oObj:cUserCode
	cCodRda := oObj:cRdaCode
	cGuiRef := ""
	cMatric := HttpGet->cMatric
	cDatGui := DtoS(Date())
	
	// Parametros para retornar se a guia eh duplicada
	oObj:cUserCode			:= cCodUsr
	oObj:cRdaCode			:= cCodRda
	oObj:cTipGui			:= cTipGui	
	oObj:cUserCardNumber	:= cMatric
	oObj:cNumGuiRef			:= cGuiRef
	oObj:cDatGuia		 	:= cDatGui
	
	// Verifica se a guia pode estar sendo duplicada
	if oObj:isDupGui()
		cResult += "|" + SubStr(oObj:cIsDupGuiRESULT,6)
	endif 

Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina																Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCHAATE    Ё Autor Ё Alexander Santos	   Ё Data Ё 02.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Chama determinado formulario do atendimento					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHAATE()
LOCAL cHtml 	:= ""
LOCAL oObj	    := nil
LOCAL oObjRG    := nil
LOCAL nPosRda	:= 0
LOCAL cTISSVer	:= ""
LOCAL cRda		:= ""
LOCAL cCodLoc	:= ""
LOCAL aRDA		:= {}
LOCAL nI		:= 0
LOCAL nY		:= 0
LOCAL cResult	:= ""
LOCAL lDiagno	:= ""
Local cDigiGui	:= IIF(ValType(HttpGet->cDigiGui  ) == "C", AllTrim(HttpGet->cDigiGui  ) , "")
Local cNumGuiRef	:= IIF(ValType(HttpGet->cNumGuiRef) == "C", AllTrim(HttpGet->cNumGuiRef) , "")
Local cTpGuiRef  	:= IIF(ValType(HttpGet->cTpGuiRef ) == "C", AllTrim(HttpGet->cTpGuiRef ) , "")
Local cRecGuiRef 	:= IIF(ValType(HttpGet->cRecGuiRef) == "C", AllTrim(HttpGet->cRecGuiRef) , "")
Local cCodConsulta	:= ""
Local oObjx		:= Nil
LOCAL cTipoG	:= ""
Local lAltCpAUT	:= IIF (ValType(HttpGet->cTipAltG) == "C" .AND. HttpGet->cTipAltG == "AltCmp", .T., .F.)
Local cRecnoBD5 := IIF(ValType(HttpGet->cRecnoBD5) == "C", AllTrim(HttpGet->cRecnoBD5) , "")
LOCAL cTipoAlt := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Aliemnta variavel de sessao											   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cTp := HttpGet->cTp
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Recupera a RDA e sua versЦo TISS						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cRda := HttpGet->cRda
cCodLoc := HttpGet->cCodLoc

//para achar a versao da tiss precisa sempre olhar sС o codigo da rda, o codloc nЦo precisa mas somente nesse caso
nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == cRda } )
If nPosRDA > 0
	aRDA := ClassDataArr(HttpSession->RDAVIEW[nPosRDA])
Endif
If aScan(aRDA,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0
	cTISSVer := HttpSession->RDAVIEW[nPosRDA]:cTissVer
EndIf
HttpSession->cTISSVer := cTISSVer
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cTipo 		:= HttpSession->cTp
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta a dados especifico por tipo de guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GetDadG()
	Do Case
		Case HttpSession->cTp == "3" //Internacao
			HttpSession->RDASOLT 	:= oObj:oWSGetDadGRESULT:oWSDADRDATP:oWSMSDADRDA
		Case HttpSession->cTp == "4" //ODontologico
			HttpSession->cCodPad 	:= oObj:oWSGetDadGRESULT:cCodPad
    EndCase
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLENVFOR.APW" )
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Ponto de Entrada que define os campos obrigatorios a mais na GUia 	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cObrCpGuia := ""
If ExistBlock('PLSCPGUI')
  	HttpSession->cObrCpGuia := ExecBlock('PLSCPGUI',.F.,.F.,{HttpSession->cTp})
EndIf

//Indicacao dos tipos de formularios a terem o botao complemento habilitado no portal 1=Cons 2=SADT 3=GIH e 4=Odonto
If oObj:PLSGETMV("MV_PLCMPFP","") .And. ExistBlock("PLSCMPFP")
	If !Empty(oObj:cPLSGETMVRESULT) .And. HttpSession->cTp $ oObj:cPLSGETMVRESULT
		HttpSession->cCmpl := oObj:cPLSGETMVRESULT
	EndIf
EndIf

//DigitaГЦo de Guias
oObj:cDigigui		:= cDigigui
oObj:cRECNOBD5   := cRecnoBD5
oObj:cTipo 	:= IIF(Empty(HttpGet->cTipoOrigem),"",HttpGet->cTipoOrigem)
If !(EmpTy(oObj:Ctipo)) //Tratamentos especМficos da digitaГЦo de guias

	If Separa(oObj:cTipo,"|")[1] == "consulta"
		oObjx := WSCFGDICTIONARY():New()
		WsChgURL( @oObjx, "CFGDICTIONARY.APW" )

		oObjx:cUSERCODE	:= "MSALPHA"
		oObjx:cMVPARAM	:= "MV_PLSCDCO"

		If oObjx:GETPARAM()
			cCodConsulta := oObjx:cGETPARAMRESULT //Inicia a session que inicializa o cСdgo da consulta.
		EndIf

		HttpSession->cCodCons  	:= SubStr(cCodConsulta,3,16)
	EndIf

	oObjx := WSPLSXFUN():New()
	WsChgURL( @oObjx, "PLSXFUN.APW" )
	oObjx:cUSERCODE:= "MSALPHA"

	oObj:cRdaCode	:= HttpGet->cRda
	oObj:cCodLoc	:= HttpGet->cCodLoc
	If !HttpSession->cTp $ "1,2,3,4,5,11,12,6"
		If oObj:ProfSaud()
			HttpSession->PROSAUD := oObj:oWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD
		EndIf
	EndIf

EndIf

	IF lAltCpAUT
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё obj																			Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		oObj := WSPLSXFUN():New()
		WsChgURL( @oObj, "PLSXFUN.APW" )
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Parametros																    Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		oObj:cUSERCODE	:= "MSALPHA"
		oObj:cRdaCode	:= HttpGet->cRda
		oObj:cCodLoc	:= HttpGet->cCodLoc
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Lista de profissional de saude										   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If !HttpSession->cTp $ "1,2,3,4,5,11,12,6"
			If oObj:ProfSaud()
				HttpSession->PROSAUD := oObj:oWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD
			EndIf
		ENDIF
	ENDIF

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё CRIAR PAGINA PARA TISS 3.0													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If cTissVer >= "3"
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё oBJ
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Parametros
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj:cUserCode	:= "MSALPHA"
	oObj:oWSGUIATISS:cTipGui		:= STRZERO(val(HttpSession->cTp),2)
	oObj:oWSGUIATISS:cVerTiss	:= cTISSVer
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Aqui eu pego o que vem de Session executo aqui pra enviar a informaГao
	// pro WS pois o mesmo nao acessa o conteudo da Session	dificultando o dinamismo
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If oObj:GetCmbFormT()
		// ATRIBUO OS PARAMETROS NOVAMENTE PARA UTILIZAгцO DO PROXIMO METODO
		oObj:cUserCode	:= "MSALPHA"
		oObj:oWSGUIATISS:cTipGui	:= STRZERO(val(HttpSession->cTp),2)
		oObj:oWSGUIATISS:cVerTiss	:= cTISSVer
		oObj:oWSGUIATISS:cDadCombo	:= ""
		
		If Len(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA) > 0
		
			For nI := 1 To Len(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA)
		
				cStrCBOX := ""
				If "HTTPSESSION" $ Upper(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)	 // Se for uma Session eu pego CCODE e CNAME e monto o Combo
					If ValType(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)) <> 'U'
						For nY := 1 To Len(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX))
							cStrCBOX += Alltrim(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cCODE")) + "=" + Alltrim(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cNAME")) + ";"
						Next nY
					EndIf
					If nY > 2
						cStrCBOX += ";="
					EndIf
				Else // Caso contrario eu pego a STRING com mesma estrutura do X3_COBX
					cStrCBOX := Alltrim(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)
				EndIf
				If SubStr(cStrCBOX, Len(cStrCBOX),1) == ";"
					cStrCBOX := SubStr(cStrCBOX, 1, Len(cStrCBOX)-1)
				EndIf
				oObj:oWSGUIATISS:cDadCombo	+= Alltrim(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCampoG) + ";" + cStrCBOX + "|"
			Next
		EndIf
	EndIf
	If SubStr(oObj:oWSGUIATISS:cDadCombo, Len(oObj:oWSGUIATISS:cDadCombo),1) == "|"
		oObj:oWSGUIATISS:cDadCombo := SubStr(oObj:oWSGUIATISS:cDadCombo, 1, Len(oObj:oWSGUIATISS:cDadCombo)-1)
	EndIf
	//Alimenta tipo de guia, se И modo de ediГЦo com a query string passada por parБmetro e data limite para inclusЦo da data
	IF (lAltCpAUT .AND. Empty(cDigiGui))  //Se alteraГЦo estiver preenchido e digiguia nЦo, garanto que nЦo И da digitaГЦo de contas off e sim da autorizaГЦo
			oObj:cTipo		:= "AltCmp|" + AllTrim(StrTran(StrTran(HttpGet->cNumGOB,".",""),"-","")) + '|' + HttpGet->cTp
	ELSEIF (lAltCpAUT .AND. !Empty(cDigiGui))
		oObj:cTipo		:= "AltCmp|" + IIF(Empty(HttpGet->cTipoOrigem),"",HttpGet->cTipoOrigem)
	ELSE
		oObj:cTipo		:= IIF(Empty(HttpGet->cTipoOrigem),"",HttpGet->cTipoOrigem)
	ENDIF
	oObj:ccRecno 		:= IIF(Empty(HttpGet->cNumGuia),"",HttpGet->cNumGuia)
	oObj:cDtLimRetro 	:= IIF(Empty(HttpGet->dDtLimRetro),"",HttpGet->dDtLimRetro)
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Retorna dados da pagina
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj:cMsnBloInter	:= HttpSession->cMsnBloInt
	oObj:cDigigui		:= cDigigui
	oObj:cNumGuiRef 	:= cNumGuiRef
	oObj:cTpGuiRef   	:= cTpGuiRef
	oObj:cRecGuiRef  	:= cRecGuiRef
	oObj:lAltCpAT		:= lAltCpAUT //r77
	
	//Adiciona data da guia SADT na inclusЦo de outras despesas
	if (HttpSession->cTp == "12")
		HttpSession->cDatAtd	:= IIF(Empty(HttpGet->cDatAtd),"",HttpGet->cDatAtd)	
	endif
	
	If ValType(HttpSession->aVldCartao) == 'A'
		oObj:lIntercambio		:= HttpSession->aVldCartao[10]
	Else
		oObj:lIntercambio		:= .F.
	EndIf
	HttpSession->cDigitacao := cDigigui
	oObj:cRECNOBD5   := cRecnoBD5
	oObj:cDtJs := iif(valtype(HttpSession->cDtJs) <> 'U', HttpSession->cDtJs, "")
	If oObj:GetFormTiss()
		cResult :=  oObj:OWSGETFORMTISSRESULT:cPagina
		If ValType(oObj:OWSGETFORMTISSRESULT:cGrids) == "C"
			HttpSession->cGrids := oObj:OWSGETFORMTISSRESULT:cGrids
		EndIf

		If ValType(oObj:OWSGETFORMTISSRESULT:OWSCMPGUIA:oWSSCmpGuia) == "A" /*/:OWSCMPGUIA:OWSSCMPGUIA)*/
			HttpSession->aCmpGuia := aClone(oObj:OWSGETFORMTISSRESULT:OWSCMPGUIA:oWSSCmpGuia)
		EndIf

		//Executa os inicializadores dos campos
		nIni := At("<%=",cResult)
		While  nIni > 0
			nFim := At("%>",cResult)
			cComando := SubStr(cResult,nIni+3,nFim - nIni-3)
			xResult := &(cComando)

			cTipResult := ValType(xResult)
			Do Case
				Case cTipResult == "D"
					xResult := DtoS(xResult)
					xResult := SubStr(xResult,7,2) + "/" + SubStr(xResult,5,2) + "/" + SubStr(xResult,1,4)
				Case cTipResult == "N"
					xResult := Alltrim(Str(xResult))
			EndCase

			cResult := StrTran ( cResult, "<%=" + cComando + "%>", xResult) //, nIni, 1)
			nIni := At("<%=",cResult)
		EndDo

	EndIf

	HttpSession->cPaginaGuia := Substr(cResult,At("|",cResult)+1,Len(cResult)) // Retiro o true| ou o false|

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё FIM CRIAR PAGINA PARA TISS 3.0													   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
EndIf


//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Envia para o determinado formulario									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If cTissVer < "3"
	Do Case
		Case HttpSession->cTp == "1" //Consulta
			cHtml := ExecInPage( "PPLSCONS?cRda="+HttpGet->cRda+"&cCodLoc="+HttpGet->cCodLoc )
		Case HttpSession->cTp == "2" //Sadt
			cHtml := ExecInPage( "PPLSSADT?cRda="+HttpGet->cRda+"&cCodLoc="+HttpGet->cCodLoc )
		Case HttpSession->cTp == "3" //Internacao
			//recupera valor do parБmetro
			oObjPar := WSCFGDICTIONARY():New()
			WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )

			oObjPar:cUSERCODE	:= "MSALPHA"
			oObjPar:cMVPARAM	:= "MV_PLSDGN"
			If oObjPar:GETPARAM()
				lDiagno := oObjPar:cGETPARAMRESULT
				If ValType(lDiagno) == 'U'
					lDiagno := .F.
				ElseIf	ValType(lDiagno) == 'C'
					If Type(lDiagno)=="L"
						lDiagno := &(lDiagno)
					EndIf
				EndIf
			EndIf

			HttpSession->lDiagno	:= lDiagno//SuperGetMv( "MV_PLSDGN", .F.,.F.)
			cHtml := ExecInPage( "PPLSSOIN?cRda="+HttpGet->cRda+"&cCodLoc="+HttpGet->cCodLoc )
		Case HttpSession->cTp == "4" //ODontologico
			cHtml := ExecInPage( "PPLSGTOP?cRda="+HttpGet->cRda+"&cCodLoc="+HttpGet->cCodLoc )
	EndCase
Else
	oObj:cMsnBloInter	:= HttpSession->cMsnBloInt
	//GUIA ODONTOLOGICA AINDA NAO EH DINAMICA TODAS AS OUTRAS SAO...
	//FOI FEITO DESTA FORMA POIS O LAYOUT DE GUIA DA GUIA ODONTOLOGICA EH O MESMO
	//LAYOUT DA GUIA SADT. NO FUTURO ISSO DEVE SER CORRIGIDO 22/07/2014 - DAHER
	If HttpSession->cTp == "4" //ODontologico

		//Sessions para alimentar os hiddens da guia odontolСgica.
		HttpSession->dDtLimRetro := HttpGet->dDtLimRetro
		HttpSession->cTipoOrigem := HttpGet->cTipoOrigem

		//Se for alteraГЦo, alimenta a session cAltCmpG e o recno.
		if(lAltCpAUT)
			HttpSession->cAltCmpG := oObj:cTipo
			HttpSession->cRecnoBD5 := oObj:cRECNOBD5
		else
			//Limpa sessions de possМveis outros formulАrios
			HttpSession->cAltCmpG := ""
			HttpSession->cRecnoBD5 := ""
		endif

		if ValType(HttpGet->dDtLimRetro) <> "U"
			cHtml := ExecInPage( "PPLSGTOF?cRda="+HttpGet->cRda+"&cCodLoc="+HttpGet->cCodLoc+"&dDtLimRetro="+HttpGet->dDtLimRetro+"&cTipoOrigem="+HttpGet->cTipoOrigem )
		else
		cHtml := ExecInPage( "PPLSGTOF?cRda="+HttpGet->cRda+"&cCodLoc="+HttpGet->cCodLoc )
		endif
	Else
		cHtml += ExecInPage("PPLSGUIAS")
	Endif
EndIf

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCHAPRE    Ё Autor Ё Alexander Santos	   Ё Data Ё 09.06.06 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Mostra pacientes para o atendimento chamada do menu			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHAPRE()
LOCAL cHtml := ""
LOCAL oObjPar := nil
Private lPreAten := .F.

WEB EXTENDED INIT cHtml START "InSite"

 HttpSession->cBtIntern := " "
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁRecupera parametro para verificar se o PrИ atendimento estА habilitado dentro do atendimento
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObjPar := WSCFGDICTIONARY():New()
WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )

oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PLPREATE"
If oObjPar:GETPARAM()
	lPreAten := oObjPar:cGETPARAMRESULT
	If ValType(lPreAten) == 'U'
		lPreAten := .F.
	ElseIf	ValType(lPreAten) == 'C'
		If Type(lPreAten)=="L"
			lPreAten := &(lPreAten)
		EndIf
	EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁPrИ atendimento dentro do atendimento
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If lPreAten
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁOperadora padrao
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	wcGetIntPad()
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Verificar permissЦo de acesso do botao internados
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )

	oObj:cUserCode	:= "MSALPHA"
	oObj:CcUsr	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
	HttpSession->cBtIntern := ""

	If oObj:VALACEBOT()
		If LEN(oObj:OWSVALACEBOTRESULT:OWSSUSUARIO) > 0
			HttpSession->cBtIntern := oObj:OWSVALACEBOTRESULT:OWSSUSUARIO[1]:CPERMITE
		EndIf
	EndIf
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁDefine o tipo de entrada de dados
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If ValType(HttpSession->cTipCar) == 'U'
		If HttpSession->USR_INFO[1]:OWSUSERLOGPLS:cTipCar == '1'
			HttpSession->cTipCar := "1"
		Else
			HttpSession->cTipCar := "0"
		EndIf
	EndIf
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁTipo de pre-atendimento se vai pre-atender ou atender (executar)		   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	HttpSession->cTpPreAte := "0"
	HttpSession->cBtInterna:= "0"
EndIf

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё "0" Pre-Atendimento "1" Pacientes "2" Atendimento						  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cTpPreAte := HttpGet->cP
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё "2" Atendimento	carrega combos											  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If HttpSession->cTpPreAte != '0'
	W_PPLENVFOR()
Else
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Chama formulario de atendimento											  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cHtml += ExecInPage("PPLMOSPRE")
EndIf

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSCHKCID Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica se o cid e valido									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCHKCID()
LOCAL cResult := ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode	:= "MSALPHA"
oObj:cCid		:= HttpGet->cChkCid
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo verificar se o cid e valido							   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:ChkCid()
	If ValType(HttpGet->cCampoRef) == "U"  //nas versoes 3.xx.xx esse cara vem preenchido
		cResult := 'true|'+oObj:cCHKCIDRESULT
	Else
		cResult := 'true|'+HttpGet->cCampoRef+"|"+oObj:cCHKCIDRESULT
	Endif
Else
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSITEPCT Ё Autor Ё Roberto Vanderlei    Ё Data Ё 10.04.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢ ╠╠
╠╠ЁDescri┤└o Ё Procura e inclui dados dos itens do pacote,qtd e codpad		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSITEPCT()
Local cCodPct	:= SubStr(HttpGet->cCodPct,3,10)
Local cQtdSSol	:= HttpGet->cQtdSSol
Local cQtdAutSSol	:= HttpGet->qtdAutSSol
Local cStatusAut 	:= HttpGet->cStatusAut
Local cTpAut 		:= HttpGet->cTpAut
Local aMatPct 		:= HttpGet->aMatPct
Local lRetCab 		:= HttpGet->lRetCab
Local dDtExe		:= HttpGet->dDtExe
Local nRedAcreSExe	:= HttpGet->nRedAcreSExe
Local cCodRda		:= HttpGet->cCodRda
Local nI
Local cResult 	:= ""
Local nLen
Local nPos
Local aResultado
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

If ValType(HttpGet->lRetCab) = "U"
	lRetCab := .F.
Else
	lRetCab := .T.
EndIf

If ValType(HttpGet->dDtExe) = "U"
	dDtExe := ""
EndIf

If ValType(HttpGet->nRedAcreSExe) = "U"
	nRedAcreSExe := ""
EndIf

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW")
oObj:cUSERCODE := "MSALPHA"
oObj:OWSPRODAD:cCodPro	:= cCodPct

If oObj:RetLstPro()
	cResult := oObj:cRETLSTPRORESULT //+ "cQtdSSol;" + cQtdSSol + "~" + "cQtdAutSSol;" + cQtdAutSSol + "~"
EndIf

aResultado := PlSplitAdvpl(cResult, "|")

cResult := "true"

/*Adicionando a todos os itens a quantidade autorizada/solicitada do pacote.*/
For nI:=2 To Len(aResultado)
	If dDtExe = ""
		cResult += "|" + aResultado[nI] + "~cQtdAutSSol;" + cQtdAutSSol + "~" + "cQtdSSol;" + cQtdSSol + "~" + "cStatusAut;" + cStatusAut + "~" + "cTpAut;" + cTpAut + "~cCodPct;" + cCodPct + "~dDtExe;"+dDtExe + "~nRedAcreSExe;" + nRedAcreSExe
	Else
		cResult += "|" + aResultado[nI] + "~cQtdAutSSol;" + cQtdAutSSol + "~" + "cStatusAut;" + cStatusAut + "~" + "cTpAut;" + cTpAut + "~cCodPct;" + cCodPct + "~dDtExe;"+dDtExe + "~nRedAcreSExe;" + nRedAcreSExe
	EndIf

Next

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSCHKPCT Ё Autor Ё Roberto Vanderlei    Ё Data Ё 09.04.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica se o procedimento e pacote  								Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCHKPCT()
Local lPLSEXPC
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 			:= "MSALPHA"
oObj:oWSMatPre:cCodRda	:= HttpGet->cRda										  	//Rda
oObj:oWSMatPre:cMatric	:= HttpGet->cMatric											//Matricula
oObj:oWSMatPre:cNomeUsu	:= HttpGet->cNomeUsu										//Nome do usuario
oObj:oWSMatPre:cCodUsr	:= getUsrWeb()											 	//Codigo de login web Login pls bsw
oObj:oWSMatPre:cMatric	:= HttpGet->cMatric		//Matricula

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode			:= "MSALPHA"
oObj:OWSPRODAD:cCodPro	:= SubStr(HttpGet->cCodPadPro,3,8)
oObj:OWSPRODAD:cCodRda	:= SubStr(HttpGet->cCodPadPro,11,6)

/*Roberto Vanderlei de Arruda*/
if oObj:ChkCodPct()

	cResult := "true|"+oObj:cCHKCODPCTRESULT+"?" + SubStr(HttpGet->cCodPadPro,3,8)//+ "?" + cV

else
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
endif

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSCHKSER Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica se o procedimento e valido							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCHKSER()

LOCAL cTISSVer:= ""
LOCAL cResult := ""
LOCAL aRDA    := {}
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 			:= "MSALPHA"
oObj:oWSMatPre:cCodRda	:= HttpGet->cRda										  	//Rda

oObj:oWSMatPre:cMatric	:= HttpGet->cMatric											//Matricula
oObj:oWSMatPre:cNomeUsu	:= HttpGet->cNomeUsu										//Nome do usuario
oObj:oWSMatPre:cCodUsr	:= getUsrWeb()											 	//Codigo de login web Login pls bsw

oObj:oWSMatPre:cMatric	:= HttpGet->cMatric		//Matricula

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode			:= "MSALPHA"
oObj:OWSPRODAD:cTpServ	:= HttpSession->cTp
oObj:OWSPRODAD:cCodPad	:= Left(HttpGet->cCodPadPro,2)
oObj:OWSPRODAD:cCodPro	:= SubStr(HttpGet->cCodPadPro,3,10)
oObj:OWSPRODAD:cTpProc	:= HttpGet->cTpProc
oObj:OWSPRODAD:cCodRda	:= HttpGet->cRda

nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == HttpGet->cRda } )
If nPosRDA > 0
	aRDA := ClassDataArr(HttpSession->RDAVIEW[nPosRDA])
Endif
If aScan(aRDA,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0
	cTISSVer := HttpSession->RDAVIEW[nPosRDA]:cTissVer
EndIf
oObj:OWSPRODAD:cTissVer	:= cTISSVer

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁExecuta metodo verificar se o procedimento e valido
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:ChkCodPro()
	cResult := oObj:cCHKCODPRORESULT
Else
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSQTD	  Ё Autor Ё Totvs    			 Ё Data Ё 217.10.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Quantidade															 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSQTD()
LOCAL cResult := ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 	:= "MSALPHA"
oObj:OWSPRODAD:cCodPad	:= HttpGet->cCodPad
oObj:OWSPRODAD:cCodPro	:= HttpGet->cCodPro

If ValType(HttpGet->nQtdPro) <> "U"
	oObj:OWSPRODAD:nQtdPro	:= val(HttpGet->nQtdPro)
ElseIf ValType(HttpGet->cQtdPro) <> "U"
	oObj:OWSPRODAD:nQtdPro	:= val(HttpGet->cQtdPro)
Else
	oObj:OWSPRODAD:nQtdPro := 0
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁExecuta metodo verificar se o procedimento e valido
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:ChkQtdPro()
	cResult := oObj:cCHKQTDPRORESULT
Else
 	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPSDETPRO  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna informaГЦo do prof de saude com base na selecao		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PPSDETPRO(cProfSau,cTp,cTpProf)
LOCAL cResult       := ""
LOCAL nPosPSau 	    := 0
LOCAL nI			:= 0
LOCAL aRet			:= {}
LOCAL oObj			:= NIL
LOCAL cTpGuia       := iif(valtype(HttpSession->cTp) <> "U", HttpSession->cTp, "")
LOCAL dDatFxFun     :=  GetAPOInfo("WSPLSXFUN.PRX")[4] 
LOCAL dDtCliet      :=  GetAPOInfo("WSCLIENT_WSPLSXFUN.PRX")[4] 
DEFAULT	 cTpProf	:= "S" //S - Solicitante | E - Executante

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Profissional de Saude												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If HttpSession->PROSAUD == NIL
	HttpSession->PROSAUD := {}
EndIf
If HttpSession->PROSAUDEXE == NIL
	HttpSession->PROSAUDEXE := {}
EndIf

If !(cTp == "W") .And. cTpProf <> "E" .And. aScan( HttpSession->PROSAUD, { |x| x:cCODE == AllTrim(cProfSau) } ) == 0 
    oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )

	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Parametros																    Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	oObj:cUSERCODE	:= "MSALPHA"
	oObj:cRdaCode	:= cProfSau
	oObj:cCodLoc	:= HttpGet->cCodLoc
	
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Lista de profissional de saude										   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If oObj:ProfSaud()
		HttpSession->PROSAUD := oObj:oWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD
	EndIf		
EndIf

nPosPSau := aScan( IIF(cTpProf == "E",HttpSession->PROSAUDEXE,HttpSession->PROSAUD), { |x| x:cCODE == AllTrim(cProfSau) } )

If nPosPSau == 0
	//Seleciona o profissional caso exista apenas 1 na session
	If (cTpProf == "E" .and. (ValType(HttpSession->PROSAUDEXE) == "A" .OR. ValType(HttpSession->PROSAUDEXE) == "O") .AND. Len(HttpSession->PROSAUDEXE) == 1 .and. (AllTrim(HttpSession->PROSAUDEXE[1]:cCode) == AllTrim(cProfSau))) .or. ;
	   (cTpProf <> "E" .and. (ValType(HttpSession->PROSAUD)    == "A" .OR. ValType(HttpSession->PROSAUD)    == "O") .AND. Len(HttpSession->PROSAUD)    == 1 .and. (AllTrim(HttpSession->PROSAUD[1]:cCode)    == AllTrim(cProfSau)))
		
		nPosPSau := 1
	else
		//Caso nЦo seja encontrado na session
		//Realizo busca na BB0 para retornar os demais dados do profissional (orgao, n╨ orgao, uf orgao, etc).
		//Chamada da funГЦo que busca o profissional na BB0
		oObj := WSPLSXFUN():New()
		WsChgURL( @oObj, "PLSXFUN.APW" )
		
		if(ValType(HttpGet->cRda) <> 'U')
			oObj:cRdaCode		:= HttpGet->cRda
		elseif(ValType(HttpPost->cRda) <> 'U')
			oObj:cRdaCode		:= HttpPost->cRda
		else
			oObj:cRdaCode		:= ""
		endIf
		
		if(ValType(HttpGet->cCodLoc) <> 'U')
			oObj:cCodLoc		:= HttpGet->cCodLoc
		elseif(ValType(HttpPost->cRda) <> 'U')
			oObj:cCodLoc		:= HttpPost->cCodLoc
		else
			oObj:cCodLoc		:= ""
		endIf

		oObj:cUSERCODE 	:= "MSALPHA"
		oObj:cBusca		:= cProfSau //Codigo do profissional a ser gatilhado
		oObj:cTipo		:= "2" //Tipo de busca: 1 - por nome, 2 - por cСdigo
		oObj:cTipGui	:= cTpGuia
		oObj:cTipProf	:= cTpProf

		If oObj:ProfSaud()
			if (cTpProf == "E")
    		    HttpSession->PROSAUDEXE := oObj:OWSPROFSAUDRESULT:OWSLISTPFSEXE:oWSPROFSAUD
			else
				HttpSession->PROSAUD := oObj:oWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD
			endif
			
			if len(Iif(cTpProf == "E",HttpSession->PROSAUDEXE,HttpSession->PROSAUD)) == 1
				nPosPSau := 1
			endif
		EndIf
	EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Carrega dados do profissional										   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If nPosPSau > 0
	If cTp == "W"
		cResult :=  "true|"+HttpSession->PROSAUD[nPosPSau]:cCodSig	+"|"+;
							HttpSession->PROSAUD[nPosPSau]:cNumCr	+"|"+;
							HttpSession->PROSAUD[nPosPSau]:cEstado	+"|"+;
							HttpSession->PROSAUD[nPosPSau]:cName + "@" + HttpSession->PROSAUD[nPosPSau]:cCode +"|"+;
							HttpSession->PROSAUD[nPosPSau]:cCpfCnpj	+"|"+;
							HttpSession->PROSAUD[nPosPSau]:cCodOpe
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Ajusta caracter especial											   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		cResult := PLSDECODE(cResult)

	ElseIf cTp == "W2"
		cResult := "true|"+ IIF(cTpProf == "E", HttpSession->PROSAUDEXE[nPosPSau]:cCodSig, HttpSession->PROSAUD[nPosPSau]:cCodSig)	 +"|"+;
							IIF(cTpProf == "E", HttpSession->PROSAUDEXE[nPosPSau]:cNumCr, HttpSession->PROSAUD[nPosPSau]:cNumCr)	 +"|"+;
							IIF(cTpProf == "E", HttpSession->PROSAUDEXE[nPosPSau]:cEstado, HttpSession->PROSAUD[nPosPSau]:cEstado)	 +"|"+;
							IIF(cTpProf == "E", HttpSession->PROSAUDEXE[nPosPSau]:cName + "@" + HttpSession->PROSAUDEXE[nPosPSau]:cCode, HttpSession->PROSAUD[nPosPSau]:cName + "@" + HttpSession->PROSAUD[nPosPSau]:cCode) + "|"+;
							IIF(cTpProf == "E", HttpSession->PROSAUDEXE[nPosPSau]:cCpfCnpj, HttpSession->PROSAUD[nPosPSau]:cCpfCnpj) +"|"+;
							IIF(cTpProf == "E", HttpSession->PROSAUDEXE[nPosPSau]:cCodOpe, HttpSession->PROSAUD[nPosPSau]:cCodOpe)
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Ajusta caracter especial											   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If cTpProf == "E"
			If Type("HttpSession->PROSAUDEXE["+alltrim(str(nPosPSau))+"]:oWsEspeci") <> 'U'
				If Len(HttpSession->PROSAUDEXE[nPosPSau]:oWsEspeci:oWsGenericStruct) > 0
					cResult += "|"
					For nI:=1 To Len(HttpSession->PROSAUDEXE[nPosPSau]:oWsEspeci:oWsGenericStruct)
						cResult += HttpSession->PROSAUDEXE[nPosPSau]:oWsEspeci:oWsGenericStruct[nI]:cCode+"#"+alltrim(HttpSession->PROSAUDEXE[nPosPSau]:oWsEspeci:oWsGenericStruct[nI]:cDescription)+"$"
				    Next
				Endif
			Endif
		Else
			If Type("HttpSession->PROSAUD["+alltrim(str(nPosPSau))+"]:oWsEspeci") <> 'U'
				If Len(HttpSession->PROSAUD[nPosPSau]:oWsEspeci:oWsGenericStruct) > 0
					cResult += "|"
					For nI:=1 To Len(HttpSession->PROSAUD[nPosPSau]:oWsEspeci:oWsGenericStruct)
						cResult += HttpSession->PROSAUD[nPosPSau]:oWsEspeci:oWsGenericStruct[nI]:cCode+"#"+alltrim(HttpSession->PROSAUD[nPosPSau]:oWsEspeci:oWsGenericStruct[nI]:cDescription)+"$"
					Next
				Endif
			Endif
		Endif
	Else
		cResult	 := {}
	    AaDd(cResult,{	HttpSession->PROSAUD[nPosPSau]:cCodSig,;
	    				HttpSession->PROSAUD[nPosPSau]:cNumCr,;
						HttpSession->PROSAUD[nPosPSau]:cEstado,;
						HttpSession->PROSAUD[nPosPSau]:cName + "@" + HttpSession->PROSAUD[nPosPSau]:cCode,;
						HttpSession->PROSAUD[nPosPSau]:cCpfCnpj,;
						HttpSession->PROSAUD[nPosPSau]:cCodOpe } )
	EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cResult
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPSDADPSAU Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna informaГЦo do prof de saude com base na selecao		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPSDADPSAU()
LOCAL cResult := "true|||||||||||||||||||||||"
LOCAL cRet 	  := ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPega detalhe do profissional										   	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cRet := PPSDETPRO(HttpGet->cProSaud,"W2")
If ExistBlock('PLSPROF')
	aRet :=Execblock('PLSPROF',.F.,.F.,{HttpGet->cProSaud,HttpGet->cMatric})
   If !aRet[1]
  		cRet:="false|"+aRet[2]
   Endif
Endif
If !Empty(cRet)
	cResult := cRet
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPSDADPSAU Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna informaГЦo do prof de saude com base na selecao		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPCBOSPSAU()
LOCAL cResult := "true|||||||||||||||||||||||"
LOCAL cRet 	  := ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPega detalhe do profissional										   	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
if HttpGet->cTpProf != NIL .AND. !Empty(HttpGet->cTpProf)
    cRet := PPSDETPRO(HttpGet->cProSaud,"W2",HttpGet->cTpProf)
else
    cRet := PPSDETPRO(HttpGet->cProSaud,"W")
endif

If ExistBlock('PLSPROF')
	aRet :=Execblock('PLSPROF',.F.,.F.,{HttpGet->cProSaud,HttpGet->cMatric})
   If !aRet[1]
  		cRet:="false|"+aRet[2]
   Endif
Endif
If !Empty(cRet)
	cResult := cRet
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPSDADRSOL Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna informaГЦo do prof de saude com base na selecao		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPSDADRSOL()
LOCAL nPos	  := 0
LOCAL cResult := "true|"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Dados da Rda																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ( nPos := aScan( HttpSession->RDASOLT, { |x| AllTrim(x:cNAME) == AllTrim(HttpGet->cNomeSolT) } ) ) > 0
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Para a resposta																	  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cResult +=	HttpSession->RDASOLT[nPos]:cCnpfCpf+"|"+;
				HttpSession->RDASOLT[nPos]:cCode+"|"+;
				HttpSession->RDASOLT[nPos]:cCodProf+"|"+;
				HttpSession->RDASOLT[nPos]:cCodOpe+"|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPSVLDESP  Ё Autor Ё Alexander Santos     Ё Data Ё 06.08.2008 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna especifica do cliente com base no ponto de entrada	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPSVLDESP()
LOCAL cResult := "true||"
LOCAL aRet	  := ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPega informacao para tratamento no ponto de entrada					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cCodRda := HttpGet->cCodRda
cMatric := HttpGet->cMatric
cCodPad := HttpGet->cCodPad
cCodPro := HttpGet->cCodPro
dDatPro := HttpGet->dDatPro
nVlrPro := HttpGet->nVlrPro
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁVerifica ponto de entrada											   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If  ExistBlock("PPLREGBTN")
	aRet := ExecBlock( "PPLREGBTN",.F.,.F.,{cCodRda,cMatric,cCodPad,cCodPro,dDatPro} )
	If Len(aRet)>0 .And. !Empty(aRet[1])
		cResult := "false|"+AllTrim(aRet[1])+"|"
	EndIf
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPSDETRDA  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna informaГЦo da rda com base na selecao do combo 		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PPSDETRDA(cRda,cCodLoc, cTpGuia)
LOCAL nI
LOCAL nPosRDA := 0
LOCAL cResult := "true|NORMAL|||||||||||||||||||||||"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё se nao e necessario o codloc na busca da Rda
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if !empty(cCodLoc)
nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == cRda .And. x:cCodLoc == cCodLoc} )
else
	nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == cRda} )
endIf

HttpSession->cEndCon :=	""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta resultado														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If nPosRDA > 0
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Monta o endereco do contratado										   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	HttpSession->cEndCon :=	HttpSession->RDAVIEW[nPosRDA]:cTpLograd+HttpSession->RDAVIEW[nPosRDA]:cCep+;
							HttpSession->RDAVIEW[nPosRDA]:cNumero+HttpSession->RDAVIEW[nPosRDA]:cState

	cResult :=  "true|"+HttpSession->RDAVIEW[nPosRDA]:cRegAtend+"|"+;//0
						HttpSession->RDAVIEW[nPosRDA]:cRegAns+"|"+;//1
						HttpSession->RDAVIEW[nPosRDA]:cCnpfCpf+"|"+;//2
						HttpSession->RDAVIEW[nPosRDA]:cName+"|"+;//3
						HttpSession->RDAVIEW[nPosRDA]:cCnes+"|"+;//4
						AllTrim(HttpSession->RDAVIEW[nPosRDA]:cTpLograd)+"|"+;//5
						PadR(HttpSession->RDAVIEW[nPosRDA]:cAddress+' - '+AllTrim(HttpSession->RDAVIEW[nPosRDA]:cNumero)+' - '+HttpSession->RDAVIEW[nPosRDA]:cComplen,60)+"|"+;//6
						HttpSession->RDAVIEW[nPosRDA]:cDistrict+"|"+;//7
						HttpSession->RDAVIEW[nPosRDA]:cState+"|"+;//8
						HttpSession->RDAVIEW[nPosRDA]:cIBGE+"|"+;//9
						HttpSession->RDAVIEW[nPosRDA]:cCep+"|"+;//10
						HttpSession->RDAVIEW[nPosRDA]:cSigCr+"|"+;//11
						HttpSession->RDAVIEW[nPosRDA]:cCodCr+"|"+;//12
						HttpSession->RDAVIEW[nPosRDA]:cEstCr+"|"+;//13
						HttpSession->RDAVIEW[nPosRDA]:cTipPE+"|"+;//14
						HttpSession->RDAVIEW[nPosRDA]:cCodBB0+"|"//15
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Dados do profissional de saude da rda								   Ё
						//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						cDadProf := Iif ((cTpGuia $ "6,5") .or. Empty(AllTrim(HttpSession->RDAVIEW[nPosRDA]:cCodBB0)), "", StrTran( PPSDETPRO(HttpSession->RDAVIEW[nPosRDA]:cCodBB0,"W"),"true|",""))
						cResult +=	IiF(Empty(cDadProf),"|||||",cDadProf)+"|"//16-cCodSig, 17-cNumCr, 18-cEstado, 19-cName, 20-cCpfCnpj, 21-cCodOpe
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//ЁLocal de atendimento													   Ё
						//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						cResult +=	HttpSession->RDAVIEW[nPosRDA]:cCodLoc+"|"//22
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//ЁCarater da Solicitacao												   Ё
						//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						cResult +=	HttpSession->RDAVIEW[nPosRDA]:cCarSol+"|"//23
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Se for maior que um coloca o cabecalho								   Ё
						//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						If Len(HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA) > 1
							cResult +=	"~$-- CBOS --"
						EndIf
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Monta as especialidades												   Ё
						//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						For nI:=1 To Len(HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA)
						     cResult +=	"~"+HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA[nI]:cCodEsp+;//24
									    	HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA[nI]:cCodCBOS+"$"+;
											AllTrim(HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA[nI]:cDesCBOS)
						Next
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//ЁVersЦo da TISS utilizada pela RDA                                       Ё
						//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						aRDA := ClassDataArr(HttpSession->RDAVIEW[nPosRDA])
						If aScan(aRDA,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0
							cResult +=	"|"+HttpSession->RDAVIEW[nPosRDA]:cTissVer+"|"//25
						EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLDADRDA  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna informaГЦo da rda com base na selecao do combo 		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDADRDA()
LOCAL cHtml := ""
Private lProSauLoad := .T.

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInformacao da rda													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpGet->cRda) <> 'U' .And. ValType(HttpGet->cCodLoc) <> 'U'
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Verfica se precisa carregar profissionais									Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If ValType(HttpSession->PROSAUD) == 'U' .Or. Len(HttpSession->PROSAUD) == 0
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё obj																			Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		oObj := WSPLSXFUN():New()
		WsChgURL( @oObj, "PLSXFUN.APW" )
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Parametros																    Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		oObj:cUSERCODE	:= "MSALPHA"
		oObj:cRdaCode	:= HttpGet->cRda
		oObj:cCodLoc	:= HttpGet->cCodLoc
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Lista de profissional de saude										   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If !HttpSession->cTp $ "1,2,3,4,11,12,5,6" //Tipo de Guia 
			If oObj:ProfSaud()
				HttpSession->PROSAUD := oObj:oWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD
			EndIf
		else
			lProSauLoad := .F.
			HttpSession->PROSAUD := {} 
		EndIf
	Else
		If HttpSession->cTp $ "1,2,3,4,11,12,5,6"
			lProSauLoad := .F.
		EndIf
	EndIf
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Dados da Rda														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cResult := PPSDETRDA(HttpGet->cRda, HttpGet->cCodLoc, HttpSession->cTp)
Else
	cResult := PPSDETRDA("")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSERGET  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Pega o conteudo do campo da matriz							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PPLSERGET(cVar,aDad)
LOCAL nPos
LOCAL cVal := ""
LOCAL 	cHtml := ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPesquisa na matriz e pega o valor									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
nPos := aScan(aDad,{|x|AllTrim(x[1])==AllTrim(cVar)})
If nPos > 0
	If AllTrim(cVar) == 'cSeq' .And. Empty(aDad[nPos,2])
		cVal := '001'
	Else
		cVal := aDad[nPos,2]
	EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cVal

function getCmpAlt(aCamposAlterados, cTipo,  aCampoCabec, aCampoItem)

local aRet := {}
local cEsp := ""
local nFor
local cTpCon
local cTpSai
local cTpDoe
local cTmpDoe
local cTmpDoeC
local cIndAcid
local aTabDup := PlsBusTerDup(SuperGetMv("MV_TISSCAB",.F.,"87"))
local objGuia
local cAtendRN

for nFor := 1 to len(aCamposAlterados)
	if cTipo == "1"
		Do Case
		   Case cCampoTela == 'cAtendRN'
		      cAtendRN := HttpPost->cAtendRN
			  aadd(aCampoCabec, {"BD5_ATERNA", cAtendRN})
		   Case cCampoTela == 'cCbosExe'
			  cCbos	 := HttpPost->cCbosExe

		   	  cEsp := SubString(cCbos,1,3)

		   	  aadd(aCampoCabec, {"BD5_CODESP", cEsp})
		   	  aadd(aCampoItem,  {"BD6_CODESP", cEsp})

		   Case cCampoTela == 'cTpCon'

		   	  cTpCon := alltrim(PLSVARVINC('52', nil, HttpPost->cTpCon) )

		   	  aadd(aCampoCabec, {"BD5_TIPCON", cTpCon})
		   	  aadd(aCampoItem,  {"BD6_TIPCON", cTpCon})

		  // Case cCampoTela == 'cProSol' //Verificar Prestador

		   Case cCampoTela == 'cTpSai'

		   	  cTpSai := alltrim(PLSVARVINC('39','BEA', HttpPost->cTpSai))

		   	  aadd(aCampoCabec, {"BD5_TIPSAI", cTpSai})

		   Case cCampoTela == 'cTpDoe'

		   	  cTpDoe	 := HttpPost->cTpDoe
		   	  aadd(aCampoCabec, {"BD5_TIPDOE", cTpDoe})

		   Case cCampoTela == 'cTmpDoe'

		   	  cTmpDoe	 := HttpPost->cTmpDoe
		   	  aadd(aCampoCabec, {"BD5_TPODOE", cTmpDoe})

		   Case cCampoTela == 'cTmpDoeC'

		   	  cTmpDoeC	 := HttpPost->cTmpDoeC
		   	  aadd(aCampoCabec, {"BD5_UTPDOE", cTmpDoeC})


		   Case cCampoTela == 'cIndAcid'

		   	  cIndAcid := alltrim(PLSVARVINC('36', nil, HttpPost->cIndAcid))
		   	  aadd(aCampoCabec, {"BD5_INDACI", cIndAcid})


		   Case cCampoTela == 'cCodPad' .or. cCampoTela == 'cCodPro'

		   	  cCodPad := AllTrim(PLSVARVINC('87','BR4', HttpPost->cCodPad))

		   	  cCodPro := AllTrim(PLSVARVINC(HttpPost->cCodPad,'BR8',HttpPost->cCodPro ,HttpPost->cCodPad+HttpPost->cCodPro,,aTabDup,@CCODPAD))

		   	  aadd(aCampoItem, {"BD6_CODPAD", cCodPad})
		   	  aadd(aCampoItem, {"BD6_CODPRO", cCodPro})

		   Case cCampoTela == 'cVlrPro'

		   	  aadd(aCampoItem, {"BD6_VLRAPR", HttpPost->cVlrPro})

		EndCase

	elseif cTipo == "6"
			Do Case
				Case cCampoTela == 'cAtendRN'
					cAtendRN := HttpPost->cAtendRN
					aadd(aCampoCabec, {"BD5_ATERNA", cAtendRN})


				Case cCampoTela == 'dDataIniFat'
					aadd(aCampoCabec, {"BD5_TPODOE", cTmpDoe})
					ctod(HttpPost->dDataIniFat)		//Inicio Faturamento

				Case cCampoTela == 'dDataFimFat'
					aadd(aCampoCabec, {"BD5_TPODOE", cTmpDoe})
					ctod(HttpPost->dDataFimFat)		//Fim Faturamento
			EndCase

	elseif cTipo == "2"
	  	Do Case
		   Case cCampoTela == 'cAtendRN'
			  cAtendRN	 := HttpPost->cAtendRN
		   	  aAdd(aCampoCabec,  {"BD5_ATERNA", cAtendRN})

		   Case cCampoTela == 'cProSol'
			  cProSol	 := HttpPost->cProSol
		   	  aAdd(aCampoCabec,  {"BD5_CDPFSO", cProSol})
		   	  aAdd(aCampoItem,   {"BD6_CDPFSO", cProSol})

		   Case cCampoTela == 'cCodSigSol'
			  cCodSigSol := HttpPost->cCodSigSol
		   	  aAdd(aCampoCabec,  {"BD5_SIGLA", cCodSigSol})
		   	  aAdd(aCampoItem,   {"BD6_SIGLA", cCodSigSol})

		   Case cCampoTela == 'cNumCrSol'
			  cNumCrSol := HttpPost->cNumCrSol
		   	  aAdd(aCampoCabec,  {"BD5_REGSOL", cNumCrSol})
		   	  aAdd(aCampoItem,   {"BD6_REGSOL", cNumCrSol})

		   Case cCampoTela == 'cEstSigSol'
			  cEstSigSol := HttpPost->cEstSigSol
		   	  aAdd(aCampoCabec,  {"BD5_ESTSOL", cEstSigSol})
		   	  aAdd(aCampoItem,   {"BD6_ESTSOL", cEstSigSol})

		   Case cCampoTela == 'cCbosSol'
			  cCbosSol := HttpPost->cCbosSol
		   	  aAdd(aCampoCabec,  {"BD5_CODESP", SubString(cCbosSol,1,3)})
		   	  aAdd(aCampoItem,   {"BD6_CODESP", SubString(cCbosSol,1,3)})

		   Case cCampoTela == 'cCarSolicit'
			  cCarSolicit := HttpPost->cCarSolicit
		   	  aAdd(aCampoCabec,  {"BD5_TIPADM", cCarSolicit})

		   Case cCampoTela == 'dDtSolicit'
			  dDtSolicit := HttpPost->dDtSolicit
		   	  aAdd(aCampoCabec,  {"BD5_DATSOL", dDtSolicit})

		   Case cCampoTela == 'cIndCliSol'
		  	  nTaman	 := (TamSX3("BD5_INDCLI")[1])
			  cIndCliSol := HttpPost->cIndCliSol
		   	  aAdd(aCampoCabec,  {"BD5_INDCLI", SubStr(AllTrim(cIndCliSol),1, nTaman) })
		   	  aAdd(aCampoCabec,  {"BD5_INDCL2", IIF (Len(cIndCliSol) > nTaman, SubStr(cIndCliSol,nTaman+1,Len(cIndCliSol) ), "")})

		   Case cCampoTela == 'cCnesExe'
			  cCnesExe := HttpPost->cCnesExe
		   	  aAdd(aCampoCabec,  {"BD5_CNES", cCnesExe })

		   Case cCampoTela == 'cTpAteExe'   //De/Para
			  cTpAteExe := alltrim(PLSVARVINC('50', nil, HttpPost->cTpAteExe) )
		   	  aAdd(aCampoCabec,  {"BD5_TIPATE", cTpAteExe})

		   Case cCampoTela == 'cIndAcid'   //De/Para
			  cIndAcid := alltrim(PLSVARVINC('36', nil, HttpPost->cIndAcid) )
		   	  aAdd(aCampoCabec,  {"BD5_ESTSOL", cIndAcid})

		   Case cCampoTela == 'cTpCon'    //De/Para
			  cTpCon := alltrim(PLSVARVINC('52', nil, HttpPost->cTpCon) )
		   	  aAdd(aCampoCabec,  {"BD5_TIPCON", cTpCon})
		   	  aAdd(aCampoItem,   {"BD6_ESTSOL", cTpCon})

		   Case cCampoTela == 'cTpSai'    //De/Para
			  cTpSai := alltrim( PLSVARVINC('39', nil, HttpPost->cTpSai) )
		   	  aAdd(aCampoCabec,  {"BD5_TIPSAI", cTpSai})

		   Case cCampoTela == 'cTpDoe'
			  cTpDoe := HttpPost->cTpDoe
			  aadd(aCampoCabec, {"BD5_TIPDOE", cTpDoe})

		   Case cCampoTela == 'cTmpDoe'
		  	  cTmpDoe	 := HttpPost->cTmpDoe
		  	  aadd(aCampoCabec, {"BD5_TPODOE", cTmpDoe})

	       Case cCampoTela == 'cTmpDoeC'
	      	  cTmpDoeC	 := HttpPost->cTmpDoeC
	      	  aadd(aCampoCabec, {"BD5_UTPDOE", cTmpDoeC})

	       Case cCampoTela == 'cNumInt'
	      	  cNumInt	 := HttpPost->cNumInt
	      	  aadd(aCampoCabec, {"BD5_NRLBOR", cNumInt})
	      	  aadd(aCampoItem,  {"BD6_NRLBOR", cNumInt})
        EndCase

    elseif cTipo == "4" //OdontolСgico
		Do Case
		   Case cCampoTela == 'cAtendRN'
			  cAtendRN	 := HttpPost->cProSol
		   	  aAdd(aCampoCabec,  {"BD5_ATERNA", cAtendRN})

		   Case cCampoTela == 'cProSol'
			  cProSol	 := HttpPost->cProSol
		   	  aAdd(aCampoCabec,  {"BD5_CDPFSO", cProSol})
		   	  aAdd(aCampoItem,   {"BD6_CDPFSO", cProSol})

		   Case cCampoTela == 'cCodSigSol'
			  cCodSigSol := HttpPost->cCodSigSol
		   	  aAdd(aCampoCabec,  {"BD5_SIGLA", cCodSigSol})
		   	  aAdd(aCampoItem,   {"BD6_SIGLA", cCodSigSol})

		   Case cCampoTela == 'cNumCrSol'
			  cNumCrSol := HttpPost->cNumCrSol
		   	  aAdd(aCampoCabec,  {"BD5_REGSOL", cNumCrSol})
		   	  aAdd(aCampoItem,   {"BD6_REGSOL", cNumCrSol})

		   Case cCampoTela == 'cEstSigSol'
			  cEstSigSol := HttpPost->cEstSigSol
		   	  aAdd(aCampoCabec,  {"BD5_ESTSOL", cEstSigSol})
		   	  aAdd(aCampoItem,   {"BD6_ESTSOL", cEstSigSol})

		   Case cCampoTela == 'cCbosSol'
			  cCbosSol := HttpPost->cCbosSol
		   	  aAdd(aCampoCabec,  {"BD5_CODESP", SubString(cCbosSol,1,3)})
		   	  aAdd(aCampoItem,   {"BD6_CODESP", SubString(cCbosSol,1,3)})

		   Case cCampoTela == 'cProExe'
			  cProExe	 := HttpPost->cProExe
		   	  aAdd(aCampoCabec,  {"BD5_CDPFRE", cProExe})
		   	  aAdd(aCampoItem,   {"BD6_CDPFRE", cProExe})

		   Case cCampoTela == 'cCnpjCpfExe'
			  cCnpjCpfExe := HttpPost->cCnpjCpfExe
		   	  aAdd(aCampoCabec,  {"BD5_CPFRDA", cCnpjCpfExe})
		   	  aAdd(aCampoItem,   {"BD6_CPFRDA", cCnpjCpfExe})

		   Case cCampoTela == 'cNumCrExe'
			  cNumCrExe := HttpPost->cNumCrExe
		   	  aAdd(aCampoCabec,  {"BD5_REGEXE", cNumCrExe})
		   	  aAdd(aCampoItem,   {"BD6_REGEXE", cNumCrExe})

		   Case cCampoTela == 'cEstSigExe'
			  cEstSigExe := HttpPost->cEstSigSol
		   	  aAdd(aCampoCabec,  {"BD5_ESTEXE", cEstSigExe})
		   	  aAdd(aCampoItem,   {"BD6_ESTEXE", cEstSigExe})

		   Case cCampoTela == 'cCbosExe'  //Se tiver executante, grava do Executante
			  cCbosExe := HttpPost->cCbosExe
		   	  aAdd(aCampoCabec,  {"BD5_CODESP", SubString(cCbosExe,1,3)})
		   	  aAdd(aCampoItem,   {"BD6_CODESP", SubString(cCbosExe,1,3)})

		   Case cCampoTela == 'cTpAto'   //De/Para
			  cTpAto := alltrim(PLSVARVINC('51', nil, HttpPost->cTpAto) )
		   	  aAdd(aCampoCabec,  {"BD5_TIPATE", cTpAto})

		   Case cCampoTela == 'dDtEmissao'
			  dDtEmissao := HttpPost->dDtEmissao
		   	  aAdd(aCampoCabec,  {"BD5_DATPRO", dDtEmissao})

	       Case cCampoTela == 'cGuiaPrincipal'
	      	  cGuiaPrincipal	 := HttpPost->cGuiaPrincipal
	      	  aadd(aCampoCabec, {"BD5_NRLBOR", cGuiaPrincipal})
	      	  aadd(aCampoItem,  {"BD6_NRLBOR", cGuiaPrincipal})

		   Case cCampoTela == 'cTpFat'   //De/Para
			  cTpFat := alltrim(PLSVARVINC('55', nil, HttpPost->cTpFat) )
		   	  aAdd(aCampoCabec,  {"BD5_TIPFAT", cTpFat})

		   Case cCampoTela == 'cTpDoe'
			  cTpDoe := HttpPost->cTpDoe
			  aadd(aCampoCabec, {"BD5_TIPDOE", cTpDoe})

		   Case cCampoTela == 'cTmpDoe'
		  	  cTmpDoe	 := HttpPost->cTmpDoe
		  	  aadd(aCampoCabec, {"BD5_TPODOE", cTmpDoe})

	       Case cCampoTela == 'cTmpDoeC'
	      	  cTmpDoeC	 := HttpPost->cTmpDoeC
	      	  aadd(aCampoCabec, {"BD5_UTPDOE", cTmpDoeC})
        EndCase

	endif
next

return

/*
	FunГЦo ResponsАvel pela processamento da alteraГЦo de guias offline.
*/

Web Function PPLPROCALT()
Local aSepara				:= {}
Local cCamposAlterados	:= IIf(Valtype(HttpPost->cLstCmpAlt) == "U", "",  HttpPost->cLstCmpAlt)
Local cItensAlterados  	:= IIf(Valtype(HttpPost->cLstCmpAltServ) == "U", "", HttpPost->cLstCmpAltServ)
Local cTipoConfirm		:= IIF(Valtype(HttpGet->cTipoConfirm)== "U", "", HttpGet->cTipoConfirm)
Local oObj
Local cResult 			:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"


//Chamar funГЦo para verificar se o usuАrio tem permissЦo
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUSERCODE	:= "MSALPHA"
oObj:cCamposAlterados := cCamposAlterados
oObj:cItensAlterados := cItensAlterados
oObj:cTipo 		:= HttpSession->cTp
oObj:cRecnoBD5 	:= AllTrim(HttpGet->cRecno)

oObj:cTipoAut		:= cTipoConfirm
if HttpSession->cTp = "1"
	oObj:cTableCode := HttpPost->cCodPad
else
	oObj:cTableCode := HttpPost->cCodPadSExe
endif

if oObj:GRVALTOFF()
	cResult := oObj:cGRVALTOFFRESULT
	If !Empty(cResult)

		//Verifica se existe crМticas para a guia no retorno da gravaГЦo, se sim, adiciona na string para o modal.
		IF ('|-|' $ cResult)
			aSepara := SEPARA(cResult, '|-|', .F.)
			cResult := "true|warning|Guia gravada! NЗmero: " + aSepara[1] + "<br>"
			cResult += "CrМticas: <br>" + aSepara[2]
		Else
			cResult := "true|success|Guia gravada com sucesso. NЗmero: " + cResult
		EndIf
	else
		cResult := "true|fail|Houve um erro ao editar a guia, contate a operadora."
	endif
endif

WEB EXTENDED END

return  PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLPROCGUI Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Processa as Guias											 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROCGUI()
LOCAL nI,nY		  := 0
LOCAL nPos		  := 0
LOCAL oObj			:= NIL
LOCAL oObjAux		:= NIL
LOCAL oObjSex 		:= NIL
LOCAL nIteAut     := 0
LOCAL nIteNeg     := 0
LOCAL nTmpDoe	  := 0
LOCAL nValTot	  := 0
LOCAL cResultCab  := "true|"
LOCAL cResultItem := ""
LOCAL cResultSenPr:= ""
LOCAL cCodEsp		:= ""
LOCAL cEspSol		:= ""
LOCAL cEspExe		:= ""
LOCAL cNomeSol	  := ""
LOCAL cProExe     := ""
LOCAL cCodOpeExe  := ""
LOCAL cProSol     := ""
LOCAL cCodOpeSol  := ""
LOCAL cCid		  := ""
LOCAL cCid2		  := ""
LOCAL cCid3		  := ""
LOCAL cCid4		  := ""
LOCAL cCid5		  := ""
LOCAL cCbos		  := ""
LOCAL cTpCon 	  := ""
LOCAL cTpSai	  := ""
LOCAL cTpAteExe	  := ""
LOCAL cTpDoe	  := ""
LOCAL cTmpDoeC	  := ""
LOCAL cIndAcid	  := ""
LOCAL cNomeRda	  := ""
LOCAL cCnpjCpfSol := ""
LOCAL cCnesSol    := ""
LOCAL cCnesExe    := ""
LOCAL cCpfExe	  := ""
LOCAL cNumAut	  := ""
LOCAL cResult 	  := ""
LOCAL cTpAto	  := ""
LOCAL cTpFat 	  := ""
LOCAL cSequen	  := ""
LOCAL cCodTab	  := ""
LOCAL cCodPro	  := ""
LOCAL cDesPro	  := ""
LOCAL cDente	  := ""
LOCAL cFace	  	  := ""
LOCAL cQtdTot	  := ""
LOCAL cSenPro	  := ""
LOCAL cCritica	  := ""
LOCAL cQtdUs	  := ""
LOCAL cData		  := ""
LOCAL cSenhaAu	  := ""
LOCAL cTpIntern	  := ""
LOCAL cRegInter	  := ""
LOCAL cOrigem	  := "2"
LOCAL cStatus 	  := "1"
LOCAL cGrPar      := ""
LOCAL cCodSig 	  := ""
LOCAL cNumCr	  := ""
LOCAL cEstado 	  := ""
LOCAL cNomfExe	  := ""
LOCAL cUsuProc    := ""
LOCAL cSexo       := ""
LOCAL cTpAcom	  := ""
LOCAL cPadCon	  := ""
LOCAL cQtdDSol	  := ""
LOCAL cCnpjSolT	  := ""
LOCAL cDadInt	  := ""
LOCAL cResAut	  := ""
LOCAL cIndCliEvo  := ""
LOCAL cNumPeg	  := ""
LOCAL cVia  	  := ""
LOCAL cAbrang	  := ""
LOCAL cNatur	  := ""
LOCAL cDesGRP	  := ""
LOCAL lFemini		:= .F.
LOCAL lProGe		:= .F.
LOCAL lExecu		:= .F.
LOCAL lChkReg		:= .T.
LOCAL lInter		:= .F.
LOCAL lEvolu		:= .F.
LOCAL lHonor		:= .F.
LOCAL lResInt		:= .F.
LOCAL aMatIte		:= {}
LOCAL aRetProf		:= {}
LOCAL cStProc	  	:= ""
LOCAL cAtendRN		:= ""
LOCAL cTissVer		:= HttpSession->cTISSVer
LOCAL nJ			:= 0
LOCAL aMatGrp		:= {}
LOCAL dPrvInt       := ctod('')
Local cDigigui	:= IIf(Valtype(HttpGet->cTipoOrigem) == "U", "", HttpGet->cTipoOrigem)
Local aAlerta   := {}
Local nAl       := 0
Local lAlerta   := .F.
Local cResAlert := ""
Local cTipoConfirm	:= IIf(Valtype(HttpGet->cTipoConfirm) == "U", "", HttpGet->cTipoConfirm)
LOCAL cProtoc	  	:= ""
LOCAL nC			:= 0
LOCAL nP			:= 0
LOCAL cTokEdi	  	:= ""
LOCAL cImpNoAut	  	:= ""
LOCAL aNoAutTemp  	:= {}
LOCAL cTextoRadio  := "false"
LOCAL aSeqProc		:= {} 
LOCAL lProcSeq      := .F. 
LOCAL cHtml := ""
LOCAL nTmpIni		:= 0
LOCAL cNumGui		:= ""
LOCAL lTimeAte		:= .f.
Local lTissVt		:= Iif( (!Empty(cTissVer) .and. cTissVer >= "3"), .T., .F.)
Local cCarSol  		:= ""

nTmpIni := Seconds()

WEB EXTENDED INIT cHtml START "InSite"

if !empty(cDigigui)
	nIteAut := 1
endif

	oObjPar := WSCFGDICTIONARY():New()
	WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )

	oObjPar:cUSERCODE	:= "MSALPHA"
	oObjPar:cMVPARAM	:= "MV_PTIMATE" //Informa se И gestante na solicitaГЦo (1) ou na execuГЦo (2)

	If oObjPar:GETPARAM()

		lTimeAte := oObjPar:cGETPARAMRESULT

		If ValType(lTimeAte) == 'U'
			lTimeAte := .F.
		ElseIf	ValType(lTimeAte) == 'C'
			If Type(lTimeAte)=="L"
				lTimeAte := &(lTimeAte)
			EndIf
		EndIf

	EndIf

	oObjPar:cMVPARAM	:= "MV_PLPROGE"
	If oObjPar:GETPARAM()
		cUsuProc := oObjPar:cGETPARAMRESULT
		If Type(cUsuProc) == 'L'
			cUsuProc := ""
		EndIf
	EndIf

	If Empty(cUsuProc) //Se esse cara ta vazio eu nem preciso rodar os parametros abaixo pq nao vai servir pra nada de acordo com a logica proposta
	
	oObjPar:cMVPARAM	:= "MV_PLCHAGE" //Informa se И gestante na solicitaГЦo (1) ou na execuГЦo (2)
	If oObjPar:GETPARAM()
		cChaGe := oObjPar:cGETPARAMRESULT
		If Type(cUsuProc) == 'L'
			cChaGe := ""
		EndIf
	EndIf
		
	//Web Service * retorna sexo											   
	oObjSex := WSPLSXINC():New()
	WsChgURL( @oObjSex, "PLSXINC.APW" )

	oObjSex:cUSERCODE	:= "MSALPHA"	//Usuario

	if HttpPost->cNumecart = NIL
	    oObjSex:cMatricula 	:= HttpGet->cNumecart // matricula
		    cMatricula := HttpGet->cNumecart
	else
	oObjSex:cMatricula 	:= HttpPost->cNumecart // matricula
			cMatricula := HttpPost->cNumecart
	endif

	If oObjSex:SexoUser()
		cSexo := oObjSex:cSexoUserResult
	EndIf

	lFemini:= (cSexo=="2")
	EndIf

//Sessao para impressao da guia										   
HttpSession->aResult := {}
HttpSession->lSen 	 := .F.

//PLSXMOV																	 		  
oObj := WSPLSXMOV():New()
WsChgURL( @oObj, "PLSXMOV.APW" )

//Processa a guia																	  
oObj:cUSERCODE	:= "MSALPHA"				//Usuario
oObj:cRDACODE 	:= HttpPost->cRDA			//Rda
oObj:nAUTTYPE	:= Val(HttpSession->cTp)	//Tipo de guia consulta,sadt,internacao,Odonto

If cDigigui <> ""
	oObj:cDigitacaoGuia	:= HttpGet->cTipoOrigem
EndIf

Do Case
	
	//Consulta																			 
   Case HttpSession->cTp == '1'

		HttpSession->cTpComprov	:= 'Consulta - ExecuГЦo'

		lChkReg  				:= .T.
		
		If Type('HttpPost->cCidPri') <> 'U'
        	cCid	:= HttpPost->cCidPri
		Endif
		
		If Type('HttpPost->cCid2') <> 'U'
			cCid2 	:= HttpPost->cCid2
		Endif
		
		If Type('HttpPost->cCid3') <> 'U'
			cCid3 	:= HttpPost->cCid3
		Endif
		
		If Type('HttpPost->cCid4') <> 'U'
			cCid4 	:= HttpPost->cCid4
		Endif
		
		cCid5 	 	:= ""

		If Type('HttpPost->cCbosExe') <> 'U'
			cCbos	 := HttpPost->cCbosExe
	    Else
			cCbos	 := HttpPost->cCbos
	    Endif
		
		cEspSol	:= SubString(cCbos,1,3)
		cCodEsp 	:= cEspSol
		cTpCon 	 := HttpPost->cTpCon
		
        If Type('HttpPost->cProSol') <> 'U'
        	cProExe  := HttpPost->cProSol
        ElseIf Type('HttpPost->cNomeExe') <> 'U'
        	cProExe  := HttpPost->cNomeExe
        Else
        	cProExe  := HttpPost->cProSaud
        Endif
		
        aRetProf := PPSDETPRO(cProExe,"L")
		
        If Len(aRetProf) > 0
			cCodOpeExe	:= aRetProf[1,6]
		EndIf
		
		cNomeRda  := HttpPost->cNomeRdaExe
        cOrigem	  := "1"
		
		If Type('HttpPost->cTpSai') <> 'U'
			cTpSai	  := HttpPost->cTpSai
		Endif
		If Type('HttpPost->cTpDoe') <> 'U'
			cTpDoe	  := HttpPost->cTpDoe
		Endif
		
		If Type('HttpPost->cTmpDoe') <> 'U'
			nTmpDoe	  := Val(HttpPost->cTmpDoe)
		Endif
		
		If Type('HttpPost->cTmpDoeC') <> 'U'
			cTmpDoeC  := HttpPost->cTmpDoeC
		Endif

		cIndAcid:= HttpPost->cIndAcid
		cCodSig 		:= HttpPost->cCodSigExe
		cNumCr			:= HttpPost->cNumCrExe
		cEstado 		:= HttpPost->cEstSigExe

		If Type('HttpPost->cCnpfCpf') <> 'U'
			cCpfExe 	:= HttpPost->cCnpfCpf
		endif

		If Type('HttpPost->cCnesExe') <> 'U'
			cCnesExe 	:= HttpPost->cCnesExe
		endif

	//Sadt																				 
   Case HttpSession->cTp == '2'

		//Solicitacao																		  
		HttpSession->cTpComprov	:= 'Sadt - SolicitaГЦo'

		If ValType(HttpPost->cCbosSol) <> 'U'
			cCbos := HttpPost->cCbosSol
			cEspSol	:= SubString(cCbos,1,3)
    	   	cCodEsp	:= cEspSol
    	EndIf

		lChkReg  				:= .T.
		
		If ! Empty(cTissVer) .and. cTissVer >= "3"
	    	cCid 					:= ""
	    Else
	    	cCid 					:= HttpPost->cCid
	    EndIf
        cProSol  				:= HttpPost->cProSol
                
        if !empty(cProSol)        
            aRetProf := PPSDETPRO(cProSol,"L")
        endif
        
        If Len(aRetProf) > 0
			cNomeSol 	:= aRetProf[1,4]
			cCodOpeSol	:= aRetProf[1,6]
		Else
			cNomeSol := HttpPost->cNomeRdaSol
		EndIf
		
		cNomeRda  := HttpPost->cNomeRdaSol
		cOrigem	  := "2"
		cTpSai	  := HttpPost->cTpSai
		cTpAteExe := HttpPost->cTpAteExe
		cNumInt   := HttpPost->cNumInt
		cIndAcid  := HttpPost->cIndAcid

		//Executante																		  
        If HttpPost->cNumAut <> "" .Or. !Empty(HttpPost->cSolExe) .Or. !Empty(cDigigui)
		
			cCarSol 				:= HttpPost->cCarSol	//Carater da solicitacao na execuГЦo			
			cNumAut					:= AllTrim(StrTran(StrTran(HttpPost->cNumAut,".",""),"-",""))
			HttpSession->cTpComprov	:= 'Sadt - ExecuГЦo'
			cCbos	 				:= HttpPost->cCbosExe
	        cEspExe	 			:= SubString(cCbos,1,3)
	        cProExe  				:= HttpPost->cProExe
	        
	        if !empty(cProExe)
	           aRetProf := PPSDETPRO(cProExe,"L")
	        endif
	        
	        If Len(aRetProf) > 0
				cCodOpeExe	:= aRetProf[1,6]
			EndIf
			
			cNomeRda  := HttpPost->cNomeRdaExe
	        cOrigem   := "1"

			If !Empty(cTissVer) .AND. cTissVer >= "3"
				
				cTpCon 	 	:= HttpPost->cTpCon
				cCnesExe   		:= HttpPost->cCnesExe
				cCnpjCpfSol := HttpPost->cCnpjCpfSol//12
				
				//Implementar Executantes da guia
			Else
				cTpDoe	  := HttpPost->cTpDoe
				nTmpDoe	  := Val(HttpPost->cTmpDoe)
				cTmpDoeC  := HttpPost->cTmpDoeC
			EndIf

			If cChaGe == "2"
				lExecu    := .T.
			Endif
			
	    Else
		    
		    If Type('HttpPost->cIndAcid') <> 'U' 
		    	cIndAcid  := HttpPost->cIndAcid
		    EndIf 
		    
		    If cChaGe == "1"
				lExecu    := .T.
			Endif
			
	    EndIf
	//Internacao
   Case HttpSession->cTp == '3'
		
		//Solicitacao
		HttpSession->cTpComprov	:= 'InternaГЦo - SolicitaГЦo'
		
		If Type('HttpPost->cCbosSol') <> 'U'
			cCbos	 	:= HttpPost->cCbosSol //18 
	    Endif
		cEspSol  	 			:= SubString(cCbos,1,3)
       cCodEsp					:= cEspSol
		lChkReg  				:= .T.
   		lInter 					:= .T.

		//Contratado Solicitante
		cCnpjCpfSol 	:= HttpPost->cCnpjCpfSol //12 <-- BE4_RDACON
		cNomeRda   	:= HttpPost->cNomeRdaSol //13 <-- BE4_DRDACO
		cCnesSol   	:= HttpPost->cCnesSol

		//Profissional Solicitante
		 cProSol  	:= HttpPost->cProSol //14 <-- BE4_CDPFSO
        aRetProf 	:= PPSDETPRO(cProSol,"L")

        If Len(aRetProf) > 0
			cNomeSol 	:= aRetProf[1,4] // <-- BE4_NOMSOL
			cCodOpeSol	:= aRetProf[1,6] // <-- BE4_REGSOL
		Else
			cNomeSol := HttpPost->cNomeSol
		EndIf
		
		dPrvInt := ctod(HttpPost->dDSPrAH)
		
		//Contratado Solicitado (Executante)
		cCnpjSolT := HttpPost->cCnpjSolT //20

		//Solicitacao de internacao
        If HttpPost->cNumAut == ""
	        cOrigem	   	:= "2"
		    cCid 		:= HttpPost->cCid
		    cCid2 		:= HttpPost->cCid2
		    cCid3 		:= HttpPost->cCid3
		    cCid4 		:= HttpPost->cCid4
			cTpIntern  	:= HttpPost->cTpIntern
			cRegInter  	:= HttpPost->cRegInter
			cQtdDSol	:= HttpPost->cQtdDSol
			cTpDoe	  	:= HttpPost->cTpDoe
			
			If Empty(cTissVer) .OR. cTissVer < "3"
				nTmpDoe	  	:= Val(HttpPost->cTmpDoe)
			EndIf
			
			cTmpDoeC  	:= HttpPost->cTmpDoeC
			cIndAcid  	:= HttpPost->cIndAcid
			cTpAcom	   	:= HttpSession->aVldCartao[18]
			cPadCon	   	:= HttpSession->aVldCartao[19]

        	if !Empty(HttpPost->cRdaSolT)
				oObj:cRDACODE 	:= HttpPost->cRdaSolT			//Rda
			endIf
			
 		Else
			
			HttpSession->cTpComprov	:= 'ProrrogaГЦo - ExecuГЦo'

	        lEvolu	:= .T.
			cOrigem	:= "1"
			cNumAut	:= AllTrim(StrTran(StrTran(HttpPost->cNumAut,".",""),"-",""))

			//Na execucao da prorrogacao tenho que verificar o Contratato Solicitado			  
        	If !Empty(HttpPost->cRdaSolT)
				HttpPost->cCodLoc 	:= ""
				oObj:cRDACODE 		:= HttpPost->cRdaSolT			//Rda
        		cProExe 			:= HttpPost->cProfSolT
				cCodOpeExe  		:= HttpPost->cOpeSolT
			EndIf
			
		EndIf
		
	//Odontologico
   Case HttpSession->cTp == '4'
		
		//Solicitacao
		HttpSession->cTpComprov	:= 'OdontolСgico - SolicitaГЦo'
		cCbos	 				:= HttpPost->cCbosSol
       cEspSol  				:= SubString(cCbos,1,3)
       cCodEsp					:= cEspSol
		lChkReg  				:= .T.
	    cCid 					:= ""
        cProSol  				:= HttpPost->cProSol
        aRetProf 				:= PPSDETPRO(cProSol,"L")
		cTpAto 					:= HttpPost->cTpAto
		cTpFat 					:= HttpPost->cTpFat
		
        If Len(aRetProf) > 0
			cNomeSol 	:= aRetProf[1,4]
			cCodOpeSol	:= aRetProf[1,6]
		Else
			cNomeSol := HttpPost->cNomeSol
		EndIf
		
		cNomeRda  := HttpPost->cNomeRda
        cOrigem	  := "2"
		
		//Executante
        If HttpPost->cNumAut <> "" .Or. !Empty(HttpPost->cProExe)
			cNumAut					:= AllTrim(StrTran(StrTran(HttpPost->cNumAut,".",""),"-",""))
			cNumPeg					:= HttpPost->cChvBD6
			HttpSession->cTpComprov	:= 'OdontolСgico - ExecuГЦo'
			cCbos	 				:= HttpPost->cCbosExe
	        cEspExe   	 			:= SubString(cCbos,1,3)
	        cProExe  				:= HttpPost->cProExe
	        aRetProf 				:= PPSDETPRO(cProExe,"L")
			
	        If Len(aRetProf) > 0
				cCodOpeExe	:= aRetProf[1,6]
			EndIf
			
			cNomeRda  := HttpPost->cNomeRda
	        cOrigem   := "1"
	    EndIf
		
	//Honorario Individual
   Case HttpSession->cTp $ '6'

		HttpSession->cTpComprov	:= 'HonorАrio'
		lChkReg 		:= .T.
   		lInter 			:= .T.
		lHonor 			:= .T.
       cOrigem			:= "1"

		cNumAut			:= AllTrim(StrTran(StrTran(HttpPost->cGuiaInter,".",""),"-",""))
		cNomeRda		:= HttpPost->cNomeRdaExe
		
    	If lTissVt
    		cNomfExe 		:= ""
			cGrPar  		:= ""
		Else
			cNomfExe 		:= HttpPost->cNomExe
			cGrPar  		:= HttpPost->cGrPar
		EndIf
		
		//Descricao do Grau de participacao
		If (nPos := aScan( HttpSession->aGrPart, { |x| x:cCODE == cGrPar} ) ) > 0
			cDesGRP := HttpSession->aGrPart[nPos]:CDESCRIPTION
		EndIf

		cCodSig 		:= HttpPost->cCodSigExe
		cNumCr			:= HttpPost->cNumCrExe
		cEstado 		:= HttpPost->cEstSigExe
		cCnesExe   	:= HttpPost->cCnesExe
		cNumPeg		:= HttpPost->cChvBD6
		cTpAcom		:= HttpPost->cTpAcom
		nValTot		:= Val(HttpPost->nVlrTotHor)

       	cProExe  	:= HttpPost->cNomeRdaExe
       	cCpfExe		:= Iif ( lTissVt, HttpPost->cCnpjCpfExe, HttpPost->cCpfExe )
       	aRetProf 	:= PPSDETPRO(AllTrim(cProExe),"L")
		
		If Len(aRetProf) > 0
       		cNomfExe 	:= Iif ( lTissVt, aRetProf[1,4], "" )
       		cCodOpeExe	:= aRetProf[1,6]
       	EndIf

	//Resumo de InternaГЦo
   Case HttpSession->cTp == '5'

		//Solicitacao	
		HttpSession->cTpComprov	:= 'Resumo de InternaГЦo'
		lChkReg 			:= .T.
   		lInter 			:= .T.
       cOrigem			:= "1"
       lResInt			:= .T.
      
	   	cCid2 		:= HttpPost->cCid2
	   	cCid3 		:= HttpPost->cCid3
	   	cCid4 		:= HttpPost->cCid4
	   	cCid5		:= HttpPost->cCidObt
	   	cIndAcid  	:= HttpPost->cIndAcid
		cTpIntern 	:= HttpPost->cTpIntern
		cRegInter	:= HttpPost->cRegInter
		cTpFat 	:= HttpPost->cTipFat
		cNumDecVivo	:= HttpPost->cNumDecVivo
		cNumDecObt		:= HttpPost->cNumDecObt
		cIndicRN		:= HttpPost->cIndicRN
		cHorIniFat		:= HttpPost->cHorIniFat
		cHorFimFat		:= HttpPost->cHorFimfat
		
		cNomeRda  := HttpPost->cNomeRdaSol
		cTpSai	  := HttpPost->cTpSai
		
		//Executante
		If (nPos := aScan( HttpSession->aGrPart, { |x| x:cCODE == cGrPar} ) ) > 0
			cDesGRP := HttpSession->aGrPart[nPos]:CDESCRIPTION
		EndIf

		cCodSig 		:= HttpPost->cCodSigExe
		cNumCr			:= HttpPost->cNumCrExe
		cEstado 		:= HttpPost->cEstSigExe
		cCnesExe   	:= HttpPost->cCnesExe
		cNumPeg		:= HttpPost->cChvBD6
		cTpAcom		:= HttpPost->cTpAcom
		nValTot		:= Val(HttpPost->nVlrTotHor)

       	cProExe  	:= HttpPost->cNomeRdaSol
       	cCpfExe		:= Iif ( lTissVt, HttpPost->cCnpjCpfSol, HttpPost->cCpfExe )
       	aRetProf 	:= PPSDETPRO(AllTrim(cProExe),"L")
		
		If Len(aRetProf) > 0
       		cNomfExe 	:= Iif ( lTissVt, aRetProf[1,4], "" )
       		cCodOpeExe	:= aRetProf[1,6]
       	EndIf

	//ProrrogaГЦo de InternaГЦo
	Case HttpSession->cTp == '11'

		//Solicitacao
		HttpSession->cTpComprov	:= 'ProrrogaГЦo - ExecuГЦo'
		cCbos					:= HttpPost->cCbosSol
		cEspExe				:= SubString(cCbos,1,3)
		lChkReg  				:= .T.
   		lInter 					:= .T.
   		cTpAcom	   	:= HttpSession->aVldCartao[18]

		//Contratado Solicitante
		cCnpjCpfSol := HttpPost->cCnpjCpfSol//12
		cNomeRda   	:= HttpPost->cNomeRdaSol//13

		//Profissional Solicitante
		cProSol  	:= HttpPost->cProSol 	//15
		aRetProf 	:= PPSDETPRO(cProSol,"L")

		If Len(aRetProf) > 0
			cNomeSol 	:= aRetProf[1,4]
			cCodOpeSol	:= aRetProf[1,6]
		Else
			cNomeSol := HttpPost->cNomeSol
		EndIf

		cQtdDSol	:= HttpPost->cQtdDSol

		lEvolu	:= .T.
		cOrigem	:= "1"
		cNumAut	:= AllTrim(StrTran(StrTran(HttpPost->cGuiaOpe,".",""),"-","")) //O  NUmAut И o Numero da guia na operaddora

EndCase

//Usuario
If ValType(HttpSession->aVldCartao) != 'U'
	cVia 	:= HttpSession->aVldCartao[3] 		//Via
	cAbrang := HttpSession->aVldCartao[7] 		//Abrangencia
	cNatur  := HttpSession->aVldCartao[8] 		//Natureza juridica
EndIf

If Type('HttpPost->cProtoc') <> 'U'
	cProtoc	:= HttpPost->cProtoc
Endif

If Type('HttpPost->cTokEdi') <> 'U'
	cTokEdi	:= HttpPost->cTokEdi
Endif

//Restante dos dados da guia
oObj:cLOCALCODE											:= HttpPost->cCodLoc				//LOCAL
oObj:cOrigem 												:= cOrigem							//Se e para solicitar ou executar

oObj:oWSAUTHORIZATION  									:= PLSXMOV_AUTHORIZATIONVIEW():New()
oObj:oWSAUTHORIZATION:oWSAUTHEADER						:= PLSXMOV_AUTHEADERVIEW():New()

aClasse := ClassDataArr(oObj:oWSAUTHORIZATION:oWSAUTHEADER)

If aScan(aClasse,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTissVer			:= cTissVer
EndIf

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cReleaseNumber		:= cNumAut			                //Numero da Liberacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cGuiPri	 			:= Iif( ValType(HttpPost->cGuiaPrincipal)=='U','',AllTrim(StrTran(StrTran(HttpPost->cGuiaPrincipal,".",""),"-","")) )//Numero da guia principal

if HttpPost->cNumeCart = nil
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cREGISTRATIONNUMBER 	:= Alltrim(HttpGet->cNumeCart) //Matricula -- A MATANT pode ter traГos ou pontos e ai nЦo faz o seek
else
    oObj:oWSAUTHORIZATION:oWSAUTHEADER:cREGISTRATIONNUMBER 	:= Alltrim(HttpPost->cNumeCart) //Matricula -- A MATANT pode ter traГos ou pontos e ai nЦo faz o seek
endif

oObj:oWSAUTHORIZATION:oWSAUTHEADER:dProcedureDate		:=	IIF(!(EmpTy(cDigigui)),; 			//Se for digitaГЦo de guias
																	IIF(EmpTy(httpSession->dDtaAtend),;//Pode vir nessa session, caso o Post venha vazio..
																	IIF(Empty(HttpPost->dDtAtend),; 	//Se vier vazio, nЦo И Consulta
																	IIF(EmpTy(HttpPost->dDtExe),;		//Se vier vazio, nЦo И SADT
																	IIF(EmpTy(Httpget->dDtExePro),;		//Se vier vazio, nЦo И InternaГЦo
																	Date(),;								//Se nЦo achou nada, retorna a data atual
																	CtoD(Httpget->dDtExePro)),;	//Se for DigitaГЦo de guias de InternaГЦo, pega esse Get
																	CtoD(HttpPost->dDtExe)),;		//Se for DigitaГЦo de guias de SADT, pega esse Get
																	CtoD(HttpPost->dDtAtend)),;		//Se for DigitaГЦo de guias de Consulta, pega esse Get
																	CtoD(httpSession->dDtaAtend)),; //Se veio na session, pega o valor da session
																	Date())						//Data do procedimento (Se nЦo for digitaГЦo de guias, pega a data atual)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCidPri 			    := cCid					   			//CidPri
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCid2 			    := cCid2		   					//Cid2
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCid3 			    := cCid3		   					//Cid3
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCid4 			    := cCid4		   					//Cid4
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCid5 			    := cCid5				   			//Cid5
oObj:oWSAUTHORIZATION:oWSAUTHEADER:lChkReg 			    := lChkReg				   			//Se vai chegar regras ou nao

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cPROFSOL 			:= cProSol		   					//Codigo do Solicitante
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCODOPESOL			:= cCodOpeSol						//Operadora do Solicitante
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cRDACON 			:= IIF((!empty(cCnpjCpfSol) .and. HttpSession->cTp == "3"), cCnpjCpfSol, "")	//Codigo do Solicitante



oObj:oWSAUTHORIZATION:oWSAUTHEADER:cPROFEXE    			:= cProExe		   					//Codigo do executante
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCODOPEEXE			:= cCodOpeExe                       //Operadora do executante
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cNomfExe				:= cNomfExe                    		//Nome do Executante
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCpfExe				:= cCpfExe                    		//Cpf do Executante
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCnesExe				:= cCnesExe                    		//CNes do Executante

oObj:oWSAUTHORIZATION:oWSAUTHEADER:nValTot				:= nValTot                    		//Valor Total

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cNomeRda				:= cNomeRda                    		//Nome da Rda
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cGrPar				:= cGrPar                      		//Grau de Participacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCodSig				:= cCodSig                     		//Sigla
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cNumCr				:= cNumCr                     		//Numero CR
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cEstado				:= cEstado                     		//Estado

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCARDEDITION 		:= cVia						 		//Via
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCARDENCLOSES		:= cAbrang					 		//Abrangencia
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCARDNATJUST			:= cNatur							//Natureza juridica

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCARDVALIDDATE		:= HttpPost->cVldCarteira 			//Validade

if HttpPost->cNomeUsu = nil
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCARDNAME			:= HttpGet->cNomeUsu 				//Nome do cartao
else
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCARDNAME			:= HttpPost->cNomeUsu 				//Nome do cartao
endif

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cSpecialityCode	:= cCodEsp								//Especialidade da RDA (BD5_CODESP)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cEspSol			:= cEspSol								//Especialidade solicitante (BD5_ESPSOL)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cEspExe			:= cEspExe								//Especialidade executante (BD5_ESPEXE)

If Type('oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW:cCBO') <> 'U'
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCBO					:= SubString(cCbos, 4, len(cCbos))							//CBO

ElseIf HttpSession->cTp == '11'  
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCBO					:= cCbos													//CBO   
EndIf 

//Caso a data de algum procedimento seja menor que a data de atendimento, a data do procedimento serА salГva no campo DATPRO.
if (ValType(HttpPost->dDataCorDig) <> 'U' .and. !(empty(HttpPost->dDataCorDig)) )
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:dProcedureDate := iif( (CtoD(HttpPost->dDataCorDig) < oObj:oWSAUTHORIZATION:oWSAUTHEADER:dProcedureDate), CtoD(HttpPost->dDataCorDig), oObj:oWSAUTHORIZATION:oWSAUTHEADER:dProcedureDate)	
endif	

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTipCon				:= cTpCon							//Tipo de Consulta
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTipSai				:= cTpSai							//Tipo de Saida
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTipAte				:= cTpAteExe			   			//Tipo de Atendimento
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTipAto				:= cTpAto				   			//Tipo de Atendimento Odontologico
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTipFat				:= cTpFat				   			//Tipo de Faturamento

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTpIntern			:= cTpIntern   						//Tipo de Internacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cRegInter			:= cRegInter   						//Regime da internacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTpAcom			    := cTpAcom   						//Tipo de Acomodacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cPadCon			    := cPadCon   						//Padrao de Conforto
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cQtdDSol			    := cQtdDSol 						//Quantidade de Diaria Solicitada
oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDatPre              := dPrvInt                          //Data prevista de internaГЦo

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTipDoe				:= cTpDoe   						//Tipo de Doenca
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nTmpDoe				:= nTmpDoe				   			//Tempo da Doenca
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cUndDoe				:= cTmpDoeC			   				//Unidade da Doenca
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cIndAcid				:= cIndAcid							//Indicacao de Acidente
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCnpjSolT			:= cCnpjSolT						//CGC da Rda Solicitada

oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDatSol				:= Iif(ValType(HttpPost->dDtSolicit) <> "U",ctod(HttpPost->dDtSolicit),ctod(''))		//Data da solicitacao

if empTy(cCarSol)
    oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCarSol				:= HttpPost->cCarSolicit			//Carater da solicitacao
else
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCarSol			:=cCarSol
endif 

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cIndCli				:= HttpPost->cIndCliSol				//Indicacao clinica
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cFormNumber			:= HttpPost->cFormNumber			//Numero Impresso
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cObs					:= HttpPost->cObs					//Observacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cEndCon				:= HttpSession->cEndCon				//Endereco Contratado

oObj:oWSAUTHORIZATION:oWSAUTHEADER:lInter				:= lInter							//Internacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:lEvolu				:= lEvolu							//Prorrogacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:lHonor				:= lHonor			   				//Honorario
oObj:oWSAUTHORIZATION:oWSAUTHEADER:lResInt				:= lResInt							//Resumo de internacao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cNumPeg				:= cNumPeg							//Numero da Guia Chave no BD6
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cProtoc				:= cProtoc							//Numero do Protocolo de Atendimento
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cGuiPre	 			:= HttpPost->cNumPre				//Numero Guia Prestador via Guia de Consulta do Portal

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTipoConfirm			:= cTipoConfirm						//string que indica a confirmaГЦo ou nЦo da finalizaГЦo da guia

If Type('HttpPost->cTokEdi') <> 'U' 
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTokEdi				:= cTokEdi							//Token PTU Online
EndIf 

If ValType(HttpPost->dDtRlz) <> "U"
	
	If !Empty(HttpPost->dDtRlz)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz				:= ctod(HttpPost->dDtRlz)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz := ctod('')
	Endif
	
EndIf

If ValType(HttpPost->dDtRlz2) <> "U"
	
	If !Empty(HttpPost->dDtRlz2)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz2				:= ctod(HttpPost->dDtRlz2)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz2 := ctod('')
	Endif
	
EndIf

If ValType(HttpPost->dDtRlz3) <> "U"
	
	If !Empty(HttpPost->dDtRlz3)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz3				:= ctod(HttpPost->dDtRlz3)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz3 := ctod('')
	Endif
	
EndIf

If ValType(HttpPost->dDtRlz3) <> "U"
	
	If !Empty(HttpPost->dDtRlz3)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz3				:= ctod(HttpPost->dDtRlz3)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz3 := ctod('')
	Endif
	
EndIf

If ValType(HttpPost->dDtRlz4) <> "U"
	If !Empty(HttpPost->dDtRlz4)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz4				:= ctod(HttpPost->dDtRlz4)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz4 := ctod('')
	Endif
EndIf

If ValType(HttpPost->dDtRlz5) <> "U"
	If !Empty(HttpPost->dDtRlz5)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz5				:= ctod(HttpPost->dDtRlz5)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz5 := ctod('')
	Endif
EndIf

If ValType(HttpPost->dDtRlz6) <> "U"
	If !Empty(HttpPost->dDtRlz6)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz6				:= ctod(HttpPost->dDtRlz6)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz6 := ctod('')
	Endif
EndIf

If ValType(HttpPost->dDtRlz7) <> "U"
	If !Empty(HttpPost->dDtRlz7)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz7				:= ctod(HttpPost->dDtRlz7)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz7 := ctod('')
	Endif
EndIf

If ValType(HttpPost->dDtRlz8) <> "U"
	If !Empty(HttpPost->dDtRlz8)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz8				:= ctod(HttpPost->dDtRlz8)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz8 := ctod('')
	Endif
EndIf

If ValType(HttpPost->dDtRlz9) <> "U"
	If !Empty(HttpPost->dDtRlz9)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz9				:= ctod(HttpPost->dDtRlz9)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz9 := ctod('')
	Endif
EndIf

If ValType(HttpPost->dDtRlz1) <> "U"
	If !Empty(HttpPost->dDtRlz1)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz1				:= ctod(HttpPost->dDtRlz1)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDtRlz1 := ctod('')
	Endif
EndIf


If Empty(oObj:oWSAUTHORIZATION:oWSAUTHEADER:cGuiPri) .And. HttpSession->cTp == "2"
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cGuiPri	 			:= Iif( ValType(HttpPost->cNumInt)=='U','',AllTrim(StrTran(StrTran(HttpPost->cNumInt,".",""),"-","")) )//Numero da guia principal
EndIf
If ValType(HttpPost->cAtendRN) <> "U"
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cAtenRN				:= HttpPost->cAtendRN		//Atendimento a RN
EndIf

If Type('HttpPost->cAtenRN') <> "U"
	
	If HttpSession->cTp == "3"
	
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:cAtenRN				:= IIF(HttpPost->cAtenRN == "2","0","1")			//Atendimento a RN
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:cAtenRN				:= HttpPost->cAtenRN			//Atendimento a RN
	EndIf
	
EndIf

If aScan(aClasse,{|x| AllTrim(x[1]) == "CPRVOPM"  }) > 0  .and.  Type('HttpPost->cOpme') <> "U"
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cPrvOpm			:= HttpPost->cOpme
EndIf

If aScan(aClasse,{|x| AllTrim(x[1]) == "CPRVQUI"  }) > 0 .and.  Type('HttpPost->cQuimio') <> "U"
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cPrvQui			:= HttpPost->cQuimio
EndIf

If ValType(HttpPost->dDataIniFat) <> "U"
	If !Empty(HttpPost->dDataIniFat)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dIniFat				:= ctod(HttpPost->dDataIniFat)		//Inicio Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dIniFat := ctod('')
	EndIf
Else
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:dIniFat := ctod('')
EndIf

If ValType(HttpPost->dDataFimFat) <> "U"
	If !Empty(HttpPost->dDataFimFat)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dFimFat				:= ctod(HttpPost->dDataFimFat)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dFimFat := ctod('')
	Endif
Else
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:dFimFat := ctod('')
EndIf

//Guia de HonorАrio
If ValType(HttpPost->dDadaFimFat) <> "U"
	If !Empty(HttpPost->dDadaFimFat)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dFimFat				:= ctod(HttpPost->dDadaFimFat)		//Fim Faturamento
	Else
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:dFimFat := ctod('')
	Endif
Else
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:dFimFat := ctod('')
EndIf

If ValType(HttpPost->cObs) <> "U"
	If !Empty(HttpPost->cObs)
		oObj:oWSAUTHORIZATION:oWSAUTHEADER:cObs := Alltrim(HttpPost->cObs)		// ObservaГЦo da Guia
	Endif
EndIf

//Dados da Guia de Resumo de InternaГЦo
if HttpSession->cTp == '5'
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cNumDecVivo := cNumDecVivo
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cNumDecObt := cNumDecObt
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cIndicRN := cIndicRN
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cHorIniFat := cHorIniFat
	oObj:oWSAUTHORIZATION:oWSAUTHEADER:cHorFimFat := cHorFimFat
endif

//Monta matriz de participaГУes													 		  
If !Empty(HttpPost->cMatTabExe)
    aMatGrp := PPLSALIMA(HttpPost->cMatTabExe)
EndIf

//Monta matriz de itens													 		  
If HttpSession->cTp == '1'
    If !Empty(cTissVer) .AND. cTissVer >= "3" //na versao 3 tem valor apresentado na guia de consulta
    	AaDd( aMatIte,{ {'cSeq',''},{'cCodPad',HttpPost->cCodPad},{'cCodPro',HttpPost->cCodPro},{'nQtdSol','1'},{'nQtdAut','1'},{'nVlrApr',HttpPost->cVlrPro},{'cDente',''},{'cFace',''},{'cStProc',''} } )
	Else
		AaDd( aMatIte,{ {'cSeq',''},{'cCodPad',HttpPost->cCodPad},{'cCodPro',HttpPost->cCodPro},{'nQtdSol','1'},{'nQtdAut','1'},{'nVlrApr','0'},{'cDente',''},{'cFace',''},{'cStProc',''} } )
	Endif
Else
	aMatIte := PPLSALIMA(HttpPost->cMatTabES)

	If HttpPost->cSeqProc != NIL
		aSeqProc := PPLSALIMA(HttpPost->cSeqProc + "||")
	EndIf
EndIf


	If ExistBlock("PPLSVPTU")
		lRet := ExecBlock("PPLSVPTU",.F.,.F.,{cMatricula,cNumAut})
		If !lRet
			Return(.F.)
		Endif
	EndIf

//Alimenta a strutura ws com todos os itens do formulario genericamente   
oObj:oWSAUTHORIZATION:oWSAUTITEM := PLSXMOV_ARRAYOFAUTITEMVIEW():New()

For nI:=1 To Len(aMatIte)

	AaDd( oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW, PLSXMOV_AUTITEMVIEW():New() )

	//No caso de uma execuГЦo a partir de uma liberaГЦo deve ser passado o sequencial correto
	//do procedimento para controlar o saldo da liberaГЦo.
	If !EMPTY(aSeqProc)

		If LEN(aSeqProc[1]) >= nI

			If VALTYPE(aSeqProc[1][nI]) == "A"
				oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cSEQUENCE 			:= AllTrim(aSeqProc[1][nI][2])  //Sequencia
				lProcSeq := .T.
			EndIf
		EndIf
		
	EndIf

	//Se o procedimento nЦo И derivado de uma liberaГЦo, o sistema usa o sequencial do array de itens.
	If !lProcSeq
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cSEQUENCE 			:= StrZero( Val( AllTrim( PPLSERGET('cSeq',aMatIte[nI]) ) ), 3 )  //Sequencia
	Else
		lProcSeq := .F.
	EndIf

	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cCODPAD 			:= AllTrim( PPLSERGET('cCodPad',aMatIte[nI]) )						//Tabela
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cPROCEDURECODE 		:= AllTrim( PPLSERGET('cCodPro',aMatIte[nI]) )						//Servico

	If !EMPTY(PPLSERGET('dDtExePro',aMatIte[nI]))
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:dDatPro := CTOD(PPLSERGET('dDtExePro',aMatIte[nI]))
	elseIf !(Empty(httpSession->dDtaAtend)) //Guia de consulta - DigitaГЦo OffLine
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:dDatPro := CTOD( httpSession->dDtaAtend )
	EndIf

	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nPROCEDUREQUANTITY	:= Val( PPLSERGET('nQtdSol',aMatIte[nI]) )							//Qtd Solicitada
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nQtdAut  			:= Val( PPLSERGET('nQtdAut',aMatIte[nI]) ) 						//Qtd Autorizada
	
	//Alterado o tratamento, agora retira toda a mАscara e divide o valor por 100, garantindo o resultado correto
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nVlrApr  			:= Val( StrTran(strtran(PPLSERGET('nVlrApr',aMatIte[nI]),',',''),'.','') )/100			//Valor Apresentado
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cResAut  			:= AllTrim( PPLSERGET('cResAut',aMatIte[nI]) )						//Respon. pela Autorizacao
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cIndCliEvo  		:= AllTrim( PPLSERGET('cIndCliEvo',aMatIte[nI]) )					//Indicacao Clinica
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cDente  			:= AllTrim( PPLSERGET('cDente',aMatIte[nI]) )						//Dente
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cFace  			    := AllTrim( PPLSERGET('cFace',aMatIte[nI]) )						//Face
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cHorIni			    := AllTrim( StrTran(PPLSERGET('cHorIni',aMatIte[nI]),':','') )		//Hora Inicio
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cHorFim			    := AllTrim( StrTran(PPLSERGET('cHorFim',aMatIte[nI]),':','') )		//Hora Fim
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cViaAc			    := AllTrim( StrTran(PPLSERGET('cViaAc',aMatIte[nI]),':','') )		//Via
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cTecUt			    := AllTrim( StrTran(PPLSERGET('cTecUt',aMatIte[nI]),':','') )		//Tec
	
	if HttpSession->cTp == '5' .or. HttpSession->cTp == '6' 
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nRedAcre		    := Val(PPLSERGET('nRedAcre',aMatIte[nI]) )						//RedAcre
	else
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nRedAcre		    := Val( StrTran(strtran(PPLSERGET('nRedAcre',aMatIte[nI]),',',''),'.','') )/100	//RedAcre
	endif
	
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cDiagPro		    :=  PPLSERGET('cDiagPro',aMatIte[nI] ) 						//cDiagPro

		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cStProc			:= AllTrim( PPLSERGET('cStatus',aMatIte[nI]) )						//Status do Procedimento

	//Alimenta a strutura ws com todos os itens do formulario genericamente   
	aClasse := ClassDataArr(oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI])
	
	If aScan(aClasse,{|x| AllTrim(x[1]) == "OWSGRPPAREXE"  }) > 0
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE := PLSXMOV_ARRAYOFGRPPAREXE():New()
		nCmp := 0
		
		For nJ:=1 To Len(aMatGrp)

			If val(AllTrim( PPLSERGET('cSeqPro'	,aMatGrp[nJ]))) == Val( AllTrim( PPLSERGET('cSeq',aMatIte[nI])))
				nCmp++
				AaDd( oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE, PLSXMOV_GRPPAREXE():New() ) //cNumCrExe;cEstSigExe;

				oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cSeqPro 	:= AllTrim( PPLSERGET('cSeqPro'	,aMatGrp[nJ]) )			//Sequencia
				oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cGrPar 	:= AllTrim( PPLSERGET('cGrPar'	,aMatGrp[nJ]) )			//Grau ParticipaГЦo
				oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cCpfExe 	:= AllTrim( PPLSERGET('cCpfExe'	,aMatGrp[nJ]) )			//CPF Executante
				oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cProFExe 	:= AllTrim( PPLSERGET('cProExe'	,aMatGrp[nJ]) )			//Prof Executante
				oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cCodSig	:= AllTrim( PPLSERGET(IIF(HttpSession->cTp $ '5,6','cCodSigExe','cCodSig')	,aMatGrp[nJ]) )			//Sigla;cCodSigExe
				oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cNumCr  	:= AllTrim( PPLSERGET(IIF(HttpSession->cTp $ '5,6','cNumCrExe','cNumCr')	,aMatGrp[nJ]) ) 			//Num Cr;cNumCrExe
				oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cEstado  	:= AllTrim( PPLSERGET(IIF(HttpSession->cTp $ '5,6','cEstSigExe','cEstado')	,aMatGrp[nJ]) )			//Estado;cEstSigExe

				If aScan(  aMatGrp[nJ]  ,{|x| AllTrim(x[1]) == "cCbos"  }) > 0
					cEspExe := AllTrim( PPLSERGET('cCbos'	,aMatGrp[nJ]) )
					oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cEspExe  	:= IIF (HttpSession->cTp == '2', cEspExe, "")
					oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cCbos  	:= IIF (HttpSession->cTp == '2', "", cEspExe)
				Else

					oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cCbos  	:= AllTrim( PPLSERGET('cCbosExe'	,aMatGrp[nJ]) )			//Especialidade
				EndIf
				
				aRetProf 		:= PPSDETPRO(AllTrim( PPLSERGET('cProExeDesc'	,aMatGrp[nJ]) ),"L")
				If Len(aRetProf) > 0
					oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:oWSGRPPAREXE:oWSGRPPAREXE[nCmp]:cNomProf 	:= AllTrim( aRetProf[1,4] )			//Nome Prof.
				EndIf
			EndIf

		Next
	EndIf

	If Type('oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW['+alltrim(str(nI))+']:cCodNeg') <> 'U'
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cCodNeg			:= AllTrim( PPLSERGET('cCodNeg',aMatIte[nI]) )						//Status do Procedimento
	Endif

	If Type('oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW['+alltrim(str(nI))+']:cStProc') <> 'U'
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cStProc			:= AllTrim( PPLSERGET('cStatus',aMatIte[nI]) )						//Status do Procedimento
	Endif

Next
//Processa Guia																	  
If oObj:PUTAUTHORIZATION()

	//Somente na internacao															  
	If HttpSession->cTp == '3'
	
  		cDadInt :=	Iif(Empty(cNumAut),'I','P')+"*"+;
  					oObj:oWSPUTAUTHORIZATIONRESULT:cMSGCLIENT+"*"+;
					dToc(oObj:oWSPUTAUTHORIZATIONRESULT:dDPrAH)+"*"+;
  					oObj:oWSPUTAUTHORIZATIONRESULT:cQTDDAUT+"*"+;
  					HttpSession->aVldCartao[18]+"*"

		//Dados da Rda																	  
		If !Empty(HttpPost->cNomeSolT)
			If ( nPos := aScan( HttpSession->RDASOLT, { |x| AllTrim(x:cNAME) == AllTrim(HttpPost->cNomeSolT) } ) ) > 0

				//Para a resposta																	  
				cDadInt +=	HttpSession->RDASOLT[nPos]:cCnpfCpf	+"*"+;
	  						HttpSession->RDASOLT[nPos]:cName+"*"+;
							HttpSession->RDASOLT[nPos]:cCnes+"*"+;
		  					HttpSession->aVldCartao[20]+"*"

			EndIf
		Else

			//Para a resposta																	  
			If ( nPos := aScan( HttpSession->RDASOLT, { |x| AllTrim(x:cNAME) == AllTrim(HttpPost->cNomeSolT) } ) ) > 0
				
				//Para a resposta																	  
				cDadInt +=	cCnpjCpfSol+"*"+;
	  						cNomeRda+"*"+;
							HttpSession->RDASOLT[nPos]:cCnes+"*"+;
		  					HttpSession->aVldCartao[20]+"*"
		  	Else
				cDadInt +=	cCnpjCpfSol+"*"+;
							cNomeRda+"*"+;
							''+"*"+;
		  					HttpSession->aVldCartao[20]+"*"

			EndIf
		EndIf
    EndIf
	
	//Rda,Nome rda,Nome produto,Servico formatado,Numero da autorizacao,Senha e total	  
	cResultCab +=	oObj:oWSPUTAUTHORIZATIONRESULT:cNUMBER			+"|"+;	//0
			  		oObj:oWSPUTAUTHORIZATIONRESULT:cPASSWORD		+"|"+;	//1
			  		DToC( Date() )									+"|"+;	//2
			  		DToC(oObj:oWSPUTAUTHORIZATIONRESULT:dDtValSen)	+"|"+;  //3
			  		cDadInt+"||||||"						        //4
	cNumGui := oObj:oWSPUTAUTHORIZATIONRESULT:cNUMBER		  	

	//Procedimentos autorizados														  
    cResultA := ""
    cResultN := ""
	
    For nI:=1 To Len(oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW)
    	
	    nIteAut := 1
    	cSequen		:= oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSequence
    	cCodTab		:= oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cTableCode
    	cCodPro		:= oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cProcedureCode
    	cDesPro		:= StrTran(PadR(oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cDescription,55)," ","&nbsp;")
		cDente    	:= AllTrim(oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cDente)
		cDente    	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cDente),"&nbsp;&nbsp;&nbsp;&nbsp;",cDente ),"" )
		cFace     	:= AllTrim(oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cFace)
		cFace     	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cFace),"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",cFace ),"" )
		cQtdTot		:= StrZero(oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:nQtdTotal,4)

		cQtdUs      := AllTrim(Str(oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:nTotalUS))
		cData       := DtoC(Date())
		cSenhaAu    := oObj:oWSPUTAUTHORIZATIONRESULT:cPASSWORD

		cSenPro		:= oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSenha

		If (cCodTab+cCodPro) $ cUsuProc
			lProGe :=.T.
		Endif

		//Monta Linha para retorno  em tela												  
		cResultA += cSequen+"&nbsp;"+cCodTab+"-"+cCodPro+" - "+cDesPro+" - "+cQtdTot+"<br>";
		
		//Guia de Prorrogacao Senhas dos procedimentos									  
		If !Empty(cSenPro)
			cResultSenPr += cSenPro+"@"
		EndIf

	    For nAl:= 1 To Len(oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW)

	        If oObj:oWSPUTAUTHORIZATIONRESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSequence == oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW[nAl]:cSequence .OR.;
	           oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW[nAl]:cSequence == "Alerta"

	            cCritica := WCTextNeg( oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW[nAl]:cCode+" - "+oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW[nAl]:cDescription )
				
				//Monta Linha para retorno em tela												  
				cResAlert +=	cCritica

    			AaDd(aAlerta,cCritica )

    			lAlerta := .T.
			EndIf
	    Next

        AaDd( HttpSession->aResult,{cSequen,cCodTab,cCodPro,cDesPro,cDente,cFace,cQtdTot,{},cQtdUs,cData,cSenhaAu,cSenPro,cDesGRP,cStProc,aAlerta} )

		//Verifica se tem algum procedimento com senha									  
        If !Empty(cSenPro)
			HttpSession->lSen := .T.
        EndIf
		
    Next
	//Procedimentos nao autorizados Obs (Nao precisa do if pq e a ultima implementacao) Ё
    For nI:=1 To Len(oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW)-1//10
    	
   	    nIteNeg   	:= 1
    	aCritica 	:= {}
    	cSequen		:= oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSequence
    	cCodTab		:= oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cTableCode
    	cCodPro		:= oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cProcedureCode
    	cDesPro		:= StrTran(oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cDescription," ","&nbsp;")
		cDente    	:= AllTrim(oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cDente)
		cDente    	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cDente),"&nbsp;&nbsp;&nbsp;&nbsp;",cDente ),"" )
		cFace     	:= AllTrim(oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cFace)
		cFace     	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cFace),"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",cFace ),"" )
		cQtdTot		:= StrZero(oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:nQtdTotal,4)
		cQtdUs      := alltrim(Str(oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:nTotalUS))
		cData       := dtoc(date())
		cSenhaAu    := oObj:oWSPUTAUTHORIZATIONRESULT:cPASSWORD

		//Monta Linha para retorno de em tela												  
		cResultN += cSequen+"&nbsp;"+cCodTab+"-"+cCodPro+" - "+cDesPro+" - "+cQtdTot+"<br>";

		//Procedimentos criticados														  
	    For nY:= 1 To Len(oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW)
		
	        If oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSequence == oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cSequence

	            cCritica := WCTextNeg( oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cCode+" - "+oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cDescription)

				//Monta Linha para retorno em tela												  
				cResultN +=	cCritica

				//Monta matriz para impressao de guia									  			  
    			AaDd(aCritica,cCritica )
				
			EndIf
			
	    Next
		
		//Monta matriz para impressao de guia									  			  
        AaDd( HttpSession->aResult,{cSequen,cCodTab,cCodPro,cDesPro,cDente,cFace,cQtdTot,aCritica,cQtdUs,cData,cSenhaAu,"",cDesGRP,cStProc} )
    Next

	//Monta variaveis de sessao para impressao										  
	If Len(oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW) > 0
	
		cImpNoAut := oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[Len(oObj:oWSPUTAUTHORIZATIONRESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW)]:cImpProc
	
		If cImpNoAut == "0"
			
			For nC := Len(HttpSession->aResult) To 1  step -1 
				If Len(HttpSession->aResult[nC][8]) > 0
					ADEL(HttpSession->aResult,nC) 
				EndIf
			Next

			aNoAutTemp := AClone(HttpSession->aResult)
			HttpSession->aResult := {}

			For nP := 1 To Len(aNoAutTemp)
				If aNoAutTemp[nP] != NIL
					AaDd(HttpSession->aResult, aNoAutTemp[nP])
				EndIF
			Next

		EndIF
	EndIF

	HttpSession->cNumeAut	:= Iif(lEvolu,cNumAut,oObj:oWSPUTAUTHORIZATIONRESULT:cNUMBER)
	HttpSession->cSenha		:= Iif(lEvolu,"",oObj:oWSPUTAUTHORIZATIONRESULT:cPASSWORD)
	HttpSession->cCid  		:= cCid

	if HttpPost->cNumeCart = nil
		HttpSession->cNome		:= HttpGet->cNumeCart+" - "+HttpGet->cNomeUsu
	else
	HttpSession->cNome		:= HttpPost->cNumeCart+" - "+HttpPost->cNomeUsu
	endif
	//atenГЦo a alteracao anterior estava causando erro no momento de confirmar uma guia de consulta
	//voltei para o changeset que de-fato corrigiu este problema (285345)
	HttpSession->cNomeSol   := Iif(!Empty(cProSol) .And. !Empty(cNomeSol),cProSol+" - "+cNomeSol,Iif(Empty(HttpPost->cProSol), "", HttpPost->cProSol)+" - "+ Iif(Empty(HttpPost->cNomeSol), "", HttpPost->cNomeSol))//SOL. NAO ENCONTRADO (guia de consulta nao tem solicitante)

	HttpSession->cNomeRda	:= HttpPost->cRda+" - "+cNomeRda
	HttpSession->cIndCli	:= HttpPost->cIndCliSol
    HttpSession->cFormNumber:= HttpPost->cFormNumber

	cStatus := Iif( nIteAut==1 .and. nIteNeg==0,"1",Iif( nIteAut==0 .and. nIteNeg==1,"3","2") )

    If oObj:oWSPUTAUTHORIZATIONRESULT:lAto .And. cStatus $ "1,2"
	    cStatus := "5"
	EndIf
	//TODO rever a chamado da funcao RetSx3Box
	if cStatus == '1'
		HttpSession->cTitulo := 'Autorizada'
	elseIf cStatus == '2'	
		HttpSession->cTitulo := 'Autorizada Parcialmente'
	elseIf cStatus == '3'	
		HttpSession->cTitulo := 'Nao Autorizada'
	elseIf cStatus == '4'	
		HttpSession->cTitulo := 'Aguardando finalizacao do atendimento'
	elseIf cStatus == '5'	
		HttpSession->cTitulo := 'Aguardando Liq. Titulo a Pagar'
	elseIf cStatus == '6'	
		HttpSession->cTitulo := 'Em analise pela auditoria'
	endIf
	
	If oObj:oWSPUTAUTHORIZATIONRESULT:lProcRadio <> Nil .AND. oObj:oWSPUTAUTHORIZATIONRESULT:lProcRadio
		cTextoRadio := "true"
	EndIf
	
	if !empty(cDigigui)
		HttpSession->cTitulo := "Guia gravada com sucesso."
	endif

	If nIteAut==1 .and. nIteNeg==0
		
		cResultA	:= ""

		If lAlerta

			cResultItem := cResultA + cResultN + cResAlert
		Else
			cResultItem := cResultA
		EndIf
	EndIf

	If nIteNeg==1	.and. nIteAut==1

		If lAlerta
		cResultItem	:= cResultA+cResultN + cResAlert
		Else
			cResultItem	:= cResultA+cResultN
		EndIf
	EndIf

	If nIteAut==0 .and. nIteNeg==1
		cResultItem	:= cResultN
	EndIf
	
	// RETIRADO O RETORNO DO VALOR DE COPARTICIPAгцO DAQUI QUE GRAVA EM UMA SESSION QUE NцO и UTILIZADA NESSE MOMENTO
	// ESTAVA ONERANDO DESNECESSARIAMENTE A APLICAгцO
	
	//Para digitaГЦo de guias off-line o tratamento das crМticas e alertas И diferenciado.
	IF !empty(cDigigui)
		
		//Incluimos o tratamento de alertas da consulta na digitaГЦo off-line nesse trecho pois a digitaГЦo off-line nЦo alimenta o array de procedimentos autorizados
		IF HttpSession->cTp == '1' .and. !Empty(oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW)
		
			//Tratamento exclusivo para alertas da guia de consulta
			cCritica := "Foram encontrados alertas no processo: <br>"
		
			For nAl:= 1 To Len(oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW)
	         	cCritica += WCTextNeg( oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW[nAl]:cCode + " - " +; 
         								  oObj:oWSPUTAUTHORIZATIONRESULT:oWSALERTA:oWSAUTERRORVIEW[nAl]:cDescription + "<br>" )
			Next
					
			cResultItem := cCritica
			HttpSession->cTitulo := "Guia Gravada - ContЙm Alertas."
	
    		lAlerta := .T.		
		ELSEIF !Empty(oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW)
			
			cCritica := "Foram encontradas crМticas no processo: <br>"
			
			For nY:= 1 To Len(oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW)
	            cCritica += WCTextNeg( "Procedimento: "+ oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cSequence + ' - '+;
	                        oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cCode+" - "+oObj:oWSPUTAUTHORIZATIONRESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cDescription + "<br>" )
		    Next
			
			cResultItem := cCritica
			HttpSession->cTitulo := "Guia Gravada - ContЙm CrМticas."
			
		ENDIF
		
	ENDIF

	If oObj:oWSPUTAUTHORIZATIONRESULT:lAudi <> Nil .AND. oObj:oWSPUTAUTHORIZATIONRESULT:lAudi
		cResult := cResultCab + cResultItem + "|" + "Em AnАlise" + "|"
	ElseIf !empty(cDigigui) .And. oObj:oWSPUTAUTHORIZATIONRESULT:lMudFasOff <> Nil .And. !oObj:oWSPUTAUTHORIZATIONRESULT:lMudFasOff
		cResult := cResultCab + "<br> A guia estА sendo processada e em breve poderА consultar no Portal o status da Guia." + cResultItem + "|" + "AtenГЦo! Processo em Andamento" + "|"
	Else
	cResult := cResultCab + cResultItem + "|" + HttpSession->cTitulo + "|"
	EndIf
	
    If lExecu .And. lFemini .And. lProge
		cResult += "SIM"
    Else
        cResult += "NAO"
    Endif
    
	    cResult += "|" + cResultSenPr + "|" + cTextoRadio + "|"

	If lAlerta
		cResult += "true|"
	Else
		cResult += "false|"
	EndIf

Else
	cResult := "false|" + StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//Mostra o tempo que durou pra confirmar o atendimento
If lTimeAte
    oObjPar:cMsgLog  := Time()+ "|" + Alltrim(Str(Seconds() - nTmpIni)) + "|" + HttpPost->cRDA + "-" + cNomeRda + "|" + HttpSession->cTp  + "|" + IIf(!Empty(HttpPost->cNumAut),"Exec","Solic")  + "| Itens: " + Alltrim(StrZero(Len(aMatIte),3))  + "|" +  cNumGui + "|" + cDigigui 
    oObjPar:cFileLog := "ConfirmaAtendimento.txt"
    oObjPar:PutPLSLogFil()
EndIf

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLFINCUS   Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Abre o formulario de inclusao de usuario de intercambio		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLFINCUS()

LOCAL cHtml	:= ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInicio Extended														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDireciona para pagina												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLSINCUSU" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim Extended														   	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLINCUSU   Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Executa a inclusao de usuario de intercambio				 	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLINCUSU()
LOCAL nI
LOCAL oObj
LOCAL cResult := "true|||"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXINC():New()
WsChgURL( @oObj, "PLSXINC.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁAlimenta parametros													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode				:= "MSALPHA"
oObj:OWSINCMAT:cMatricula	:= HttpPost->cMatric
oObj:OWSINCMAT:cNome		:= HttpPost->cNome
oObj:OWSINCMAT:cSexo		:= HttpPost->cSexo
oObj:OWSINCMAT:dDatNas		:= CtoD(HttpPost->cDatNas)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInclusao																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:INCUSUARIO()
    If !Empty(oObj:oWSINCUSUARIORESULT:cMatricula)
		cResult := "true|"+oObj:oWSINCUSUARIORESULT:cMatricula+"|"
	Else
		cResult := "false|"
		For nI:=1 To Len(oObj:oWSINCUSUARIORESULT:oWSSMATCRI:oWSGenericStruct)
			cResult += 	oObj:oWSINCUSUARIORESULT:oWSSMATCRI:oWSGenericStruct[nI]:cCode+" - "+;//0
						oObj:oWSINCUSUARIORESULT:oWSSMATCRI:oWSGenericStruct[nI]:cDescription+Chr(13)+Chr(10)//1
		Next
	EndIf
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLFINCPR   Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Abre o formulario de inclusao de profissional de saude		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLFINCPR()
LOCAL cHtml	:= ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInicio Extended														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDireciona para pagina												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpPost->cRda    := HttpGet->cRda
HttpPost->cCodLoc := HttpGet->cCodLoc
If Type('HttpGet->cTp') <> 'U'
	HttpPost->cTp     := HttpGet->cTp
Else
	HttpPost->cTp     := '1'//tipo execucao, so mostra as especialidades da RDA
Endif
cHtml := ExecInPage( "PPLSINCPRO" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim Extended														   	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLLISTPCT   Ё Autor Ё Roberto Vanderlei   Ё Data Ё 22.04.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Abre o formulАrio para listagem de pacotes.	 				 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLLISTPCT()
LOCAL cHtml	:= ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInicio Extended														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDireciona para pagina												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpPost->cRda    := HttpGet->cRda
HttpPost->cCodLoc := HttpGet->cCodLoc
If Type('HttpGet->cTp') <> 'U'
	HttpPost->cTp     := HttpGet->cTp
Else
	HttpPost->cTp     := '1'//tipo execucao, so mostra as especialidades da RDA
Endif
cHtml := ExecInPage( "PPLSINCPRO" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim Extended														   	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLPROCPRO  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Executa a inclusao de profissional de saude					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROCPRO()
LOCAL oObj
LOCAL cResult := ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXINC():New()
WsChgURL( @oObj, "PLSXINC.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁAlimenta parametros													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode					:= "MSALPHA"
oObj:OWSINCMATPROF:cNome		:= UPPER(HttpPost->cNome)
oObj:OWSINCMATPROF:cCodSig		:= UPPER(HttpPost->cCodSig)
oObj:OWSINCMATPROF:cNumCr		:= UPPER(HttpPost->cNumCr)
oObj:OWSINCMATPROF:cEstado		:= UPPER(HttpPost->cEstado)
oObj:OWSINCMATPROF:cCGC  		:= HttpPost->cCGC
oObj:OWSINCMATPROF:cVinc  		:= HttpPost->cVinc
oObj:OWSINCMATPROF:cRda  		:= HttpPost->cRda
oObj:OWSINCMATPROF:cCodLoc  	:= HttpPost->cCodLoc
oObj:OWSINCMATPROF:cCodEsp  	:= HttpPost->cCodEsp
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁExecuta o metodo de inclusao	incluir RDA
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:INCPRSAUDE()
	cResult := oObj:cINCPRSAUDERESULT
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLIMPGUIA  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama formulario de impressao (comprovante)					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLIMPGUIA()
LOCAL cHtml	  := ""
LOCAL cArqAph := ""

WEB EXTENDED INIT cHtml START "InSite"

If ExistBlock("PPLMFUN1")
	cRet  := Execblock("PPLMFUN1",.F.,.F.,{})
	cHtml := ExecInPage( cRet )
Else

	cArqAph := PPSAphGuia(HttpSession->cTp)
	cHtml 	:= ExecInPage(cArqAph)

Endif

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLRETOCHA  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna para a pagina de digitacao da carteirinha			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRETOCHA()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

	cHtml := ExecInPage( "PPLCARTMAT" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSMONCON Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Monta matriz de todos os conselho bah						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSMONCON()
LOCAL nI
LOCAL oObj
LOCAL cResult  	:= "true|"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё oBJ																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSMCTMD():New()
WsChgURL( @oObj, "PLSMCTMD.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE := "MSALPHA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Executa metodo para pegar os conselhos								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:getSigCon()
	For nI:=1 To Len(oObj:oWSGETSIGCONRESULT:oWSGenericStruct)
		cResult +=	oObj:oWSGETSIGCONRESULT:oWSGenericStruct[nI]:cCode+"$"+;
					oObj:oWSGETSIGCONRESULT:oWSGenericStruct[nI]:cDescription+"|"
	Next
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLTRTIND Ё Autor Ё Daher			     Ё Data Ё 17.12.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё 																 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLTRTIND()

LOCAL cResult 	:= "true|"
LOCAL aMat 	  	:= {}
LOCAL oObj	  	:= Nil
LOCAL cString 	:= HttpGet->cString
LOCAL nI		:= 0
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

If !Empty(cString)
	While ( nPos := At( "|", cString ) ) > 0
	    AaDd( aMat,SubStr( cString, 1, nPos-1 ) )
	    cString := SubStr( cString, nPos+1, Len(cString) )
	EndDo
EndIf

If Len(aMat) > 0
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	oObj:cUSERCODE := "MSALPHA"

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁMonta Matriz de itens ja executados									   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

		oObj:oWSSAUTPROC:oWSAUTITEM := PLSXFUN_ARRAYOFAUTITEMVIEW():New()

	    For nI:=1 To Len(aMat)
	        If !Empty(aMat[nI])
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//ЁMonta dados dos itens												   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				aMatIte := PPLSALIMA(aMat[nI]+'||')
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//ЁAlimenta a estrutura para envio dos procedimentos ja executados		   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				AaDd( oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW, PLSXFUN_AUTITEMVIEW():New() )
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//ЁQuantidade de itens													   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				nQtd := Len( oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW )
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//ЁAtribui dados ao obj													   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cCODPAD 				:= AllTrim( PPLSERGET('cCodPad',aMatIte[1]) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cPROCEDURECODE 		:= AllTrim( PPLSERGET('cCodPro',aMatIte[1]) )
            Endif
        Next


		If oObj:PPINDCLIN()
			If oObj:oWSPPINDCLINRESULT:OWSSTRATIND[1]:LOBRIGAT .AND. Empty(HttpGet->cIndCli)
				cResult := "false|Indicacao Clinica deve ser informada para pelo menos um dos procedimentos informados."
				return PLSDECODE(cResult)
			Endif
		Endif
		oObj:oWSSAUTPROC:oWSAUTITEM := nil

Endif

WEB EXTENDED END

Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠ЁPrograma  Ё PPLSINCITE Ё Autor Ё Totvs     Ё Data Ё 	         Ё╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSINCITE()

LOCAL aMat 	  	:= {}
LOCAL cString 	:= HttpGet->cString


WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPega o conteudo														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If !Empty(cString)
	While ( nPos := At( "|", cString ) ) > 0
	    AaDd( aMat,SubStr( cString, 1, nPos-1 ) )
	    cString := SubStr( cString, nPos+1, Len(cString) )
	EndDo
EndIf



WEB EXTENDED END

return

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSAUTITE Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Valida e inclui dados do procedimento,qtd e codpad			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSAUTITE()
LOCAL nI	  	:= 0
LOCAL nQtd		:= 0
LOCAL nPos	  	:= 0
LOCAL nPosRDA   := 0
LOCAL lPror		:= .F.
LOCAL cResult 	:= "true|"
LOCAL aMat 	  	:= {}
LOCAL oObj	  	:= Nil
LOCAL cString 	:= HttpGet->cString
LOCAL cHtml		:= ""
LOCAL lTimeAte	:= .F.
Local nTmpIni 	:= Seconds()

WEB EXTENDED INIT cHtml START "InSite"

//Pega o conteudo														   
If ! Empty(cString)
	While ( nPos := At( "|", cString ) ) > 0
	    AaDd( aMat,SubStr( cString, 1, nPos-1 ) )
	    cString := SubStr( cString, nPos+1, Len(cString) )
	EndDo
EndIf

oObjPar := WSCFGDICTIONARY():New()
WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )

oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PTIMATE" 
If oObjPar:GETPARAM()
	lTimeAte := oObjPar:cGETPARAMRESULT
	If ValType(lTimeAte) == 'U'
		lTimeAte := .F.
	ElseIf	ValType(lTimeAte) == 'C'
		If Type(lTimeAte)=="L"
			lTimeAte := &(lTimeAte)
		EndIf
	EndIf
EndIf


//Verifica se foi enviado algum registro para tratamento				   
If Len(aMat) >= 2

	//Registro no WS														   
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	oObj:cUSERCODE := "MSALPHA"

	If Type("HttpGet->cCodPro") <> "U"	.and. Type("HttpGet->cIndCli") <> "U" .and. Type("HttpGet->cCodPad") <> "U"

		oObj:oWSSAUTPROC:oWSAUTITEM := PLSXFUN_ARRAYOFAUTITEMVIEW():New()
		AaDd( oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW, PLSXFUN_AUTITEMVIEW():New() )
		oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[1]:cCODPAD 				:= AllTrim( HttpGet->cCodPad )
		oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[1]:cPROCEDURECODE 		:= AllTrim( HttpGet->cCodPro )

		If oObj:PPINDCLIN()
			If oObj:oWSPPINDCLINRESULT:OWSSTRATIND[1]:LOBRIGAT .AND. Empty(HttpGet->cIndCli)
				cResult := "false|Indicacao Clinica deve ser informada para este procedimento."
				return PLSDECODE(cResult)
			Endif
		Endif
		oObj:oWSSAUTPROC:oWSAUTITEM := nil
	Endif

	oObj:ccRecno := iIf(ValType(Httpget->cRecnoBD5) == "C", Httpget->cRecnoBD5, "")
	oObj:cDigiGui:= IIF(ValType(HttpSession->cDigitacao) == "C", HttpSession->cDigitacao, "")
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁMonta Matriz de itens ja executados									   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If Len(aMat) > 3

		oObj:oWSSAUTPROC:oWSAUTITEM := PLSXFUN_ARRAYOFAUTITEMVIEW():New()

	    For nI := 3 To Len(aMat)
	        If ! Empty(aMat[nI])
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//ЁMonta dados dos itens												   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				aMatIte := PPLSALIMA(aMat[nI]+'||')
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//ЁAlimenta a estrutura para envio dos procedimentos ja executados		   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				AaDd( oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW, PLSXFUN_AUTITEMVIEW():New() )
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//ЁQuantidade de itens													   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				nQtd := Len( oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW )
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//ЁAtribui dados ao obj													   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cCODPAD 				:= AllTrim( PPLSERGET('cCodPad',aMatIte[1]) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cPROCEDURECODE 		:= AllTrim( PPLSERGET('cCodPro',aMatIte[1]) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:nPROCEDUREQUANTITY		:= Val( PPLSERGET('nQtdSol',aMatIte[1]) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cHORINI				:= HttpGet->cHrSolicit
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cDENTE					:= AllTrim( PPLSERGET('cDente',aMatIte[1]) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cFACE					:= AllTrim( PPLSERGET('cFace',aMatIte[1]) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cSEQUENCE				:= aMat[1]
				
				
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:nVlrApr  				:= Val( StrTran(strtran(PPLSERGET('nVlrApr',aMatIte[1]),',',''),'.','') )/100
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cResAut				:= AllTrim( PPLSERGET('cResAut',aMatIte[1]) )	
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cIndCliEvo 			:= AllTrim( PPLSERGET('cIndCliEvo',aMatIte[1]) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cHorIni 				:= AllTrim( StrTran(PPLSERGET('cHorIni',aMatIte[1]),':','') )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cHorFim 				:= AllTrim( StrTran(PPLSERGET('cHorFim',aMatIte[1]),':','') )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cViaAc 				:= AllTrim( PPLSERGET('cViaAc',aMatIte[1]) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cTecUt 				:= AllTrim( strtran(PPLSERGET('cTecUt',aMatIte[1]), ',', '' ) ) 
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:nRedAcre 				:= Val( PPLSERGET('nRedAcre',aMatIte[1] ) )
				oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cDiagPro 				:= PPLSERGET('cDiagPro',aMatIte[1])					
				
			EndIf
		Next
	EndIf
    //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    //Ё Na solicitacao da prorrogacao tenho que verificar o Contratato Solicitado
    //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    If HttpSession->cTp == '3'
		lPror := (HttpGet->cChkPro == '1')
	EndIf
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Rda																	   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If valType(HttpSession->RDAVIEW) == 'A' .and. ! lPror
		nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == HttpGet->cRda .And. x:cCodLoc == HttpGet->cCodLoc} )
	EndIf
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Verifica RDA														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If nPosRDA > 0 .or. lPror
	
		//Parametros de envio													   
		if HttpSession->cTp == '5'
		
			oObj:oWSSAUTPROC:cCarSol 	:=  HttpGet->cCarSolicit
			oObj:oWSSAUTPROC:cCnes 		:=	HttpGet->cCnes
			oObj:oWSSAUTPROC:cCid2 		:=	HttpGet->cCid2
			oObj:oWSSAUTPROC:cCid3 		:=	HttpGet->cCid3
			oObj:oWSSAUTPROC:cCid4 		:=	HttpGet->cCid4
			oObj:oWSSAUTPROC:cCid5 		:=	HttpGet->cCidObt
			oObj:oWSSAUTPROC:cTipSai 	:=	HttpGet->cTpSai
			oObj:oWSSAUTPROC:cTipFat 	:=	HttpGet->cTipFaT
			oObj:oWSSAUTPROC:cIndAci 	:=	HttpGet->cIndAcid
			oObj:oWSSAUTPROC:cTipInt 	:=	HttpGet->cTpIntern
			oObj:oWSSAUTPROC:cNumSol 	:=	HttpGet->cNumInt
			oObj:oWSSAUTPROC:cNumGuiTrc :=	HttpGet->cNumGuiTrc
						
			oObj:oWSSAUTPROC:cDtIniF 	:=  HttpGet->dDataIniFat
			oObj:oWSSAUTPROC:cHrIniF 	:=	HttpGet->cHorIniFat
			oObj:oWSSAUTPROC:cDtFimF 	:=	HttpGet->dDataFimFat
			oObj:oWSSAUTPROC:cHrFimF	:=	HttpGet->cHorFimFat
			
			oObj:oWSSAUTPROC:cCodOpe	:=	HttpGet->cCodOpe
			oObj:oWSSAUTPROC:cCodLdp	:=	HttpGet->cCodLdp
			oObj:oWSSAUTPROC:cCodPeg	:=	HttpGet->cCodPeg
			oObj:oWSSAUTPROC:cNumero	:=	HttpGet->cNumero
			oObj:oWSSAUTPROC:cSeqMov    :=  HttpGet->cSequen
			oObj:oWSSAUTPROC:cRegAte	:=  HttpGet->cRegInter
			oObj:oWSSAUTPROC:cOperacao	:=  HttpGet->cOperacao
			oObj:oWSSAUTPROC:cObserv	:=  HttpGet->cObserv
		endif		

		oObj:oWSSAUTPROC:cRegInter 	:= Iif(ValType(HttpGet->cRegInt) <> 'U',HttpGet->cRegInt,"")
		oObj:oWSSAUTPROC:cRda		:= HttpGet->cRDA
		oObj:oWSSAUTPROC:cCodLoc	:= HttpGet->cCodLoc
		oObj:oWSSAUTPROC:cOpeRda 	:= Iif(!lPror,HttpSession->RDAVIEW[nPosRDA]:cCodOpe,HttpGet->cOpeSolT )
		oObj:oWSSAUTPROC:cTipPre 	:= Iif(!lPror,HttpSession->RDAVIEW[nPosRDA]:cTipPE,"")
		
		if HttpSession->cTp <> '5'
			oObj:oWSSAUTPROC:cRegAte := Iif(!lPror,HttpSession->RDAVIEW[nPosRDA]:cRegAtend,"")
		endif
		
		oObj:oWSSAUTPROC:cMatric 	:= HttpSession->aVldCartao[2]
		oObj:oWSSAUTPROC:cCdpfSo 	:= HttpGet->cProSol
		oObj:oWSSAUTPROC:cCodExe 	:= Iif(ValType(HttpGet->cProExe) <> 'U',HttpGet->cProExe,"")
		oObj:oWSSAUTPROC:cTipGui 	:= HttpSession->cTp
		oObj:oWSSAUTPROC:cPadInt 	:= Iif(ValType(HttpGet->cTpAcom) <> 'U',HttpGet->cTpAcom,"") //HttpSession->aVldCartao[18]
		oObj:oWSSAUTPROC:cPadCon 	:= Iif(ValType(HttpGet->cPadCon) <> 'U',HttpGet->cPadCon,"") //HttpSession->aVldCartao[19]
		oObj:oWSSAUTPROC:cAreaAbr	:= HttpSession->aVldCartao[7]
		oObj:oWSSAUTPROC:dDatPro 	:= IIF(EmpTy(httpSession->dDtaAtend),;//Pode vir nessa session, caso o Post venha vazio..
										IIF(Empty(HttpPost->dDtAtend),; 	//Se vier vazio, nЦo И Consulta
										IIF(EmpTy(HttpPost->dDtExe),;		//Se vier vazio, nЦo И SADT
										IIF(EmpTy(Httpget->dDtExePro),;		//Se vier vazio, nЦo И InternaГЦo
										Date(),;								//Se nЦo achou nada, retorna a data atual
										CtoD(HttpGet->dDtExePro)),;	//Se for DigitaГЦo de guias de InternaГЦo, pega esse Get
										CtoD(HttpPost->dDtExe)),;		//Se for DigitaГЦo de guias de SADT, pega esse Get
										CtoD(HttpPost->dDtAtend)),;		//Se for DigitaГЦo de guias de Consulta, pega esse Get
										CtoD(httpSession->dDtaAtend)) //Se veio na session, pega o valor da session
		//Data do procedimento
		//fiz isso porque na digitaГЦo offline, como preenchia o datpro do procedimento com a data do atendimento, tava permitindo o usuАrio colocar uma data 
		//anterior a data da solicitaГЦo... tem que validar sempre com a data do procedimento na guia.
		//POSTERIORMENTE serА necessАrio colocar para as novas guias tbm HONORARIO e RESUMO de internaГЦo e ver qual o nome do campo de data que vai utilizar... 
		//Por enquanto temos apenas a SADT
		If ValType(HttpSession->cDigitacao) == "C" .AND. Capital(HttpSession->cDigitacao) == "Digitacao" .AND. HttpSession->cTp == '2'
			oObj:oWSSAUTPROC:dDatPro 	:= CtoD(HttpGet->dDtExePro)
		EndIf
		
		If ValType(HttpGet->cHrSolicit) <> 'U'
			oObj:oWSSAUTPROC:cHorPro 	:= HttpGet->cHrSolicit
		Else
			oObj:oWSSAUTPROC:cHorPro 	:= strtran(Substr(Time(),1,5),':','')
		Endif
		oObj:oWSSAUTPROC:cSequen 	:= aMat[1]
		oObj:oWSSAUTPROC:cMatRet 	:= aMat[2] + "~"
		oObj:oWSSAUTPROC:cCodPad 	:= Alltrim(HttpGet->cCodPad)
		oObj:oWSSAUTPROC:cCodPro 	:= HttpGet->cCodPro
		oObj:oWSSAUTPROC:nQtdPro 	:= IIf(ValType(HttpGet->nQtdSol) <> 'U',Val(HttpGet->nQtdSol), 1)  //ProteГЦo para evita problemas na cemig
		oObj:oWSSAUTPROC:cCid	 	:= HttpGet->cCid
		oObj:oWSSAUTPROC:cAteRN 	:= HttpGet->cAteRN
		oObj:oWSSAUTPROC:cGrpInt 	:= ""
		oObj:oWSSAUTPROC:cDente  	:= HttpGet->cDente
		oObj:oWSSAUTPROC:cFace  	:= HttpGet->cFace
		oObj:oWSSAUTPROC:cChavLib	:= Iif( HttpSession->cTp != '3' ,allTrim(strTran(strTran(httpGet->cNumAut,".",""),"-","")),"")
		
		If ValType(HttpSession->cDigitacao) == "C" .AND. Capital(HttpSession->cDigitacao) == "Digitacao" //Na digitaГЦo offLine И sempre ExecuГЦo
			oObj:oWSSAUTPROC:cTipoProc	:= "E"
		else
			oObj:oWSSAUTPROC:cTipoProc	:= Iif( HttpSession->cTp != '3', Iif( Empty(HttpGet->cNumAut),'S','E'),'S')
		EndIf

		oObj:oWSSAUTPROC:cCbos		:= Left(HttpGet->cCbos,3)
		oObj:oWSSAUTPROC:cEndCon	:= HttpSession->cEndCon
		oObj:oWSSAUTPROC:cChvBD6	:= HttpGet->cChvBD6
		oObj:oWSSAUTPROC:cValorApr	:= iif(HttpSession->cTp == '4', HttpGet->nVlrApr, HttpGet->cVlrUniSExe) // StrTran(strtran( iif(HttpSession->cTp == '4', HttpGet->nVlrApr, HttpGet->cVlrUniSExe) ,',',''),'.','') 
		
		oObj:oWSSAUTPROC:cHorIni 	:= Iif(HttpGet->cHorIni <> NIL, HttpGet->cHorIni, "")
		oObj:oWSSAUTPROC:cHorFim 	:= Iif(HttpGet->cHorFim <> NIL, HttpGet->cHorFim, "")
		oObj:oWSSAUTPROC:cViaAc 	:= Iif(HttpGet->cViaAc <> NIL, HttpGet->cViaAc, "")
		
		if HttpGet->cTecUt <> nil .and. allTrim(HttpGet->cTecUt) <> ""
			oObj:oWSSAUTPROC:cTecUt := strTran(HttpGet->cTecUt, ",", "")
		else
			oObj:oWSSAUTPROC:cTecUt := ""
		endif
		
		if HttpGet->nRedAcre <> nil .and. allTrim(HttpGet->nRedAcre) <> ""
			oObj:oWSSAUTPROC:nRedAcre 	:= val(HttpGet->nRedAcre)
		else
			oObj:oWSSAUTPROC:nRedAcre 	:= 1
		endif		
		
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁExecuta o metodo pega o retorno										   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If oObj:AutProc()
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁSe foi autorizado ou negado											   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		    If oObj:oWSAUTPROCRESULT:lPROAUT
			   cResult += "1|"
			Else
			   cResult += "Critica(s)|"
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁMatriz que retorna os resultados formatados campo a campo do formulario		 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			cResult += oObj:oWSAUTPROCRESULT:cMatRetRes+"|"
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁMonta a string de retorno											   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			cResult += oObj:oWSAUTPROCRESULT:cAUTORI+"|"+;
					   oObj:oWSAUTPROCRESULT:cCHAVE+"|"+;
					   oObj:oWSAUTPROCRESULT:cNIVEL+"|"
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁMonta as criticas													   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			For nI:=1 To Len(oObj:oWSAUTPROCRESULT:oWSMATCRI:oWSGenericStruct)
				cResult += 	oObj:oWSAUTPROCRESULT:oWSMATCRI:oWSGenericStruct[nI]:cCode+" - "+;//0
							oObj:oWSAUTPROCRESULT:oWSMATCRI:oWSGenericStruct[nI]:cDescription//1
			Next
			cResult += "|"

			If ValType(oObj:oWSAUTPROCRESULT:cLembrete) <> 'U'
				cResult += oObj:oWSAUTPROCRESULT:cLembrete+"|"
			EndIf

			For nI:=1 To Len(oObj:oWSAUTPROCRESULT:oWSALERTA:oWSGenericStruct)
				cResult += 	oObj:oWSAUTPROCRESULT:oWSALERTA:oWSGenericStruct[nI]:cCode+" - "+;//0
							oObj:oWSAUTPROCRESULT:oWSALERTA:oWSGenericStruct[nI]:cDescription//1
			Next

			If Len(oObj:oWSAUTPROCRESULT:oWSALERTA:oWSGenericStruct) > 0

				If !oObj:oWSAUTPROCRESULT:lPROAUT
					cResult += "| e Alerta(s)|"
				Else
					cResult += "|Alerta(s)|"
				EndIf
			EndIf

			If ValType(oObj:oWSAUTPROCRESULT:cTpProc) == "C" .and. oObj:oWSAUTPROCRESULT:cTpProc <> ""
				If ValType(oObj:oWSAUTPROCRESULT:cLembrete) = 'U'
					cResult += "|"
				endif

				If Len(oObj:oWSAUTPROCRESULT:oWSALERTA:oWSGenericStruct) <= 0
					cResult += "|"
				endif

				cResult += "|" + oObj:oWSAUTPROCRESULT:cTpProc + "|"
			endif

			if HttpSession->cTp = '5' .and. HttpGet->cOperacao  = "I"
				cResult += "|" + oObj:oWSAUTPROCRESULT:cNumGui + "|"
			endif
			
		//Retirado o tratamento do campo Indc. Cli, jА И realizado em outro ponto e nЦo existe mais na Struct
		// correspondente no WSPLSXFUN

		Else
			cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
		EndIf
	Else
		cResult := "false|RDA invalida"
	EndIf
Else
	cResult := "false|Nenhum registro para tratamento"
EndIf

WEB EXTENDED END

//Mostra o tempo que durou pra confirmar o atendimento
If lTimeAte
    oObjPar:cMsgLog  := Time()+ "|" + Alltrim(Str(Seconds() - nTmpIni)) + "|" + HttpGet->cRDA + "|" + HttpGet->cCodPro + "|" + HttpSession->cTp
    oObjPar:cFileLog := "IncluiDespesa.txt"
    oObjPar:PutPLSLogFil()
EndIf

Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSHORPAR Ё Autor Ё Roberto Arruda     Ё Data Ё 11.03.2010 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Inclui itens para processamento do honorario					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSHORPAR()
LOCAL nI	  := 0
LOCAL nPosBD6 := 0
LOCAL cResult := "true|"
LOCAL oObj	  := Nil
LOCAL cHtml := ""
local nJ
local aMatGrp := {}
local nOpc
local nRecno
local cTable

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj WebService														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 				:= "MSALPHA"
oObj:oWSSAUTPROC:cRda		:= HttpGet->cRda
oObj:oWSSAUTPROC:cNomRda	:= HttpGet->cNomeRdaExe
oObj:oWSSAUTPROC:cChavLib	:= AllTrim( StrTran(StrTran(HttpGet->cGuiaInter,".",""),"-","") )
oObj:oWSSAUTPROC:cChvBD6	:= HttpGet->cChvBD6
oObj:oWSSAUTPROC:cGrPar		:= HttpGet->cGrPar
oObj:oWSSAUTPROC:cSeqMov 	:= HttpGet->cSeqMov
oObj:oWSSAUTPROC:cCodPad 	:= HttpGet->cCodPad
oObj:oWSSAUTPROC:cCodPro 	:= HttpGet->cCodPro
oObj:oWSSAUTPROC:nQtdPro 	:= Val(HttpGet->nQtdSol)
oObj:oWSSAUTPROC:cNomExe  	:= HttpGet->cNomExe
oObj:oWSSAUTPROC:cCodSig 	:= HttpGet->cCodSigExe
oObj:oWSSAUTPROC:cNumCr	 	:= HttpGet->cNumCrExe
oObj:oWSSAUTPROC:cEstado   	:= HttpGet->cEstSigExe
oObj:oWSSAUTPROC:dDatPro   	:= IIF(EmpTy(httpSession->dDtaAtend),;//Pode vir nessa session, caso o Post venha vazio..
								   IIF(Empty(HttpPost->dDtAtend),; 	//Se vier vazio, nЦo И Consulta
								   IIF(EmpTy(HttpPost->dDtExe),;		//Se vier vazio, nЦo И SADT
								   IIF(EmpTy(Httpget->dDtExePro),;		//Se vier vazio, nЦo И InternaГЦo
								   Date(),;								//Se nЦo achou nada, retorna a data atual
								   CtoD(HttpGet->dDtExePro)),;	//Se for DigitaГЦo de guias de InternaГЦo, pega esse Get
								   CtoD(HttpPost->dDtExe)),;		//Se for DigitaГЦo de guias de SADT, pega esse Get
								   CtoD(HttpPost->dDtAtend)),;		//Se for DigitaГЦo de guias de Consulta, pega esse Get
								   CtoD(httpSession->dDtaAtend)) //Se veio na session, pega o valor da session

nOpc    :=  HttpGet->nOpc
nRecno	:=  HttpGet->nRecno
cTable	:=  HttpGet->cTable

If aScan(  ClassDataArr(oObj:oWSSAUTPROC)   ,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0

	//Recupera a versЦo da TISS
	oObj:oWSSAUTPROC:cTissVer := HttpGet->cTissVer

EndIf

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta matriz de participaГУes													 		  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If !Empty(HttpGet->cMatTabExe)
    aMatGrp := PPLSALIMA(HttpGet->cMatTabExe, .T.)
EndIf

//oObj:oWSSAUTPROC:oWSGRPPAREXE := PLSXFUN_ARRAYOFGRPPAREXE():New()

oObj:oWSSAUTPROC:cGrpParExe = ""

For nJ:=1 To Len(aMatGrp)

	//AaDd( oObj:oWSSAUTPROC:oWSGRPPAREXE:oWSGRPPAREXE, PLSXFUN_GRPPAR():New() ) //cNumCrExe;cEstSigExe;
	//oObj:oWSSAUTPROC:oWSGRPPAREXE:oWSGRPPAREXE[nJ]:cGrPar 	:= AllTrim( PPLSERGET('cGrPar'	,aMatGrp[nJ]) )			//Grau ParticipaГЦo
	
	oObj:oWSSAUTPROC:cGrpParExe += AllTrim( PPLSERGET('cGrPar'	,aMatGrp[nJ]) )  + ";"
next

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta o metodo pega o retorno										   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:VldHoPar() 
	If oObj:oWSVLDHOPARRESULT:lPROAUT
		cResult += "S|" + nOpc + "|" + nRecno + "|" + cTable + "|" 
	else
		cResult += "N|" + PLSDECODE(oObj:oWSVLDHOPARRESULT:cMatRetRes)
	endif
endif

WEB EXTENDED END


return cResult


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSHORITE Ё Autor Ё Alexander Santos     Ё Data Ё 11.03.2010 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Inclui itens para processamento do honorario					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSHORITE()
LOCAL nI	  := 0
LOCAL nPosBD6 := 0
LOCAL cResult := "true|"
LOCAL oObj	  := Nil
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj WebService														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 				:= "MSALPHA"
oObj:oWSSAUTPROC:cRda		:= HttpGet->cRda
oObj:oWSSAUTPROC:cNomRda	:= HttpGet->cNomeRdaExe
oObj:oWSSAUTPROC:cChavLib	:= AllTrim( StrTran(StrTran(HttpGet->cGuiaInter,".",""),"-","") )
oObj:oWSSAUTPROC:cChvBD6	:= HttpGet->cChvBD6
oObj:oWSSAUTPROC:cGrPar		:= HttpGet->cGrPar
oObj:oWSSAUTPROC:cSeqMov 	:= HttpGet->cSeqMov
oObj:oWSSAUTPROC:cCodPad 	:= HttpGet->cCodPad
oObj:oWSSAUTPROC:cCodPro 	:= HttpGet->cCodPro
oObj:oWSSAUTPROC:nQtdPro 	:= Val(HttpGet->nQtdSol)
oObj:oWSSAUTPROC:cNomExe  	:= HttpGet->cNomExe
oObj:oWSSAUTPROC:cCodSig 	:= HttpGet->cCodSigExe
oObj:oWSSAUTPROC:cNumCr	 	:= HttpGet->cNumCrExe
oObj:oWSSAUTPROC:cEstado   	:= HttpGet->cEstSigExe
oObj:oWSSAUTPROC:dDatPro   	:= IIF(EmpTy(httpSession->dDtaAtend),;//Pode vir nessa session, caso o Post venha vazio..
																	IIF(Empty(HttpPost->dDtAtend),; 	//Se vier vazio, nЦo И Consulta
																	IIF(EmpTy(HttpPost->dDtExe),;		//Se vier vazio, nЦo И SADT
																	IIF(EmpTy(Httpget->dDtExePro),;		//Se vier vazio, nЦo И InternaГЦo
																	Date(),;								//Se nЦo achou nada, retorna a data atual
																	CtoD(HttpGet->dDtExePro)),;	//Se for DigitaГЦo de guias de InternaГЦo, pega esse Get
																	CtoD(HttpPost->dDtExe)),;		//Se for DigitaГЦo de guias de SADT, pega esse Get
																	CtoD(HttpPost->dDtAtend)),;		//Se for DigitaГЦo de guias de Consulta, pega esse Get
																	CtoD(httpSession->dDtaAtend)) //Se veio na session, pega o valor da session


If aScan(  ClassDataArr(oObj:oWSSAUTPROC)   ,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0

	//Recupera a versЦo da TISS
	oObj:oWSSAUTPROC:cTissVer := HttpGet->cTissVer

EndIf

If ValType(HttpSession->aMatBD6) <> 'U'
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁPara garantir se incluiu e excluiu do browse
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	nPosBD6 := aScan( HttpSession->aMatBD6, { |x| !empty(x:cSeqInf) .and.  allTrim(x:cCodPad) == allTrim(HttpGet->cCodPad) .and. allTrim(x:cCodPro) == allTrim(HttpGet->cCodPro)} )
	if nPosBD6>0
		HttpSession->aMatBD6[nPosBD6]:cSeqInf := ""
	endIf

	oObj:oWSSAUTPROC:oWSMATBD6  		 	:= PLSXFUN_ARRAYOFSMATBD6():New()
	oObj:oWSSAUTPROC:oWSMATBD6:oWSSMATBD6	:= HttpSession->aMatBD6
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta o metodo pega o retorno										   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:VldHoIn()
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁSe foi autorizado ou negado											  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    If oObj:oWSVLDHOINRESULT:lPROAUT
	   	cResult += "1|"
	   	If oObj:oWSVLDHOINRESULT:nPosBD6>0
		   HttpSession->aMatBD6[oObj:oWSVLDHOINRESULT:nPosBD6]:cSeqInf := oObj:oWSVLDHOINRESULT:cSeqInf
	 	EndIf
	Else
	   	cResult += "0|"
	EndIf
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁMonta as criticas													   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	For nI:=1 To Len(oObj:oWSVLDHOINRESULT:oWSMATCRI:oWSGenericStruct)
		cResult += 	oObj:oWSVLDHOINRESULT:oWSMATCRI:oWSGenericStruct[nI]:cCode+" - "+;//0
					oObj:oWSVLDHOINRESULT:oWSMATCRI:oWSGenericStruct[nI]:cDescription//1
	Next
	cResult += "|"
	If(valType(HttpGet->cSeqPro))<>'U'
		cResult += HttpGet->cSeqPro + "|"
	Else
		cResult += "|"
	EndIf

	If(valType(HttpGet->nOpc))<>'U'
		cResult += HttpGet->nOpc + "|"
	Else
		cResult += "|"
	EndIf

	If(valType(HttpGet->nRecno))<>'U'
		cResult += HttpGet->nRecno + "|"
	Else
		cResult += "|"
	EndIf

Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSALIMA  Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Alimenta matriz de itens										 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PPLSALIMA(cString, lExec)
LOCAL nPos,nPosAux,nPosAux2
LOCAL cCmpOri,cCmpGer,cCmpC,cCmpV
LOCAL aMatRet   := {}
LOCAL cHtml := ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMonta campos da matriz												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If !Empty(cString)
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁLinhas																   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	While ( nPos := At( "|", cString ) ) > 0

        cCmpOri := SubStr( cString, 1, nPos-1 )
   	    cString := SubStr( cString, nPos+1, Len(cString) )

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁColunas																   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If (!Empty(cString) .or. lExec) .And. !Empty(cCmpOri)

		    cMatDin := "{|| AaDd(aMatRet,{"
			While ( nPosAux := At( "$", cCmpOri  ) ) > 0

		        If nPosAux > 0
				    cCmpGer := SubStr( cCmpOri, 1, nPosAux-1 )
			        nPosAux2 := At( "@", cCmpGer  )
			   	    cCmpOri := SubStr( cCmpOri, nPosAux+1, Len(cCmpOri) )
					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//ЁCampo e valor														   Ё
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			        cCmpC := SubStr( cCmpGer, 1, nPosAux2-1 )
			        cCmpV := AllTrim(SubStr( cCmpGer, nPosAux2+1, Len(cCmpGer) ))
					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//ЁInclui na matriz														   Ё
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		           cMatDin +="{'"+cCmpC+"','"+cCmpV+ "'}" + Iif( !Empty(cCmpOri),",","}) }")
			    EndIf
		   	EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁInclui na matriz de retrono											   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

		   	Eval(&cMatDin)
		EndIf
	EndDo
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return aMatRet
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSCHALIB Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Procura a liberacao e mostra os dados						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCHALIB()
LOCAL nI      	:= 0
LOCAL oObj	  	:= NIL
LOCAL lExibe  	:= .F.
LOCAL cResult 	:= "true|"
LOCAL cOpme   	:= ""
LOCAL cQuimio	:= ""
LOCAL cValGDExe	:= ""
LOCAL cHtml := ""
LOCAL cSetDtInt := ""
LOCAL cCriticas := ""
Local cValPr		:= "0"	

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		 := "MSALPHA"
oObj:cNumAut   		 := AllTrim(StrTran(StrTran(HttpGet->cNumeAut,".",""),"-",""))
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁA solicitacao deve informar o tipo.									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpSession->aVldCartao) != 'U'
	oObj:cUserCardNumber := HttpSession->aVldCartao[2]
EndIf
oObj:cPacotes := HttpGet->cPacote
oObj:cTipo		:= HttpGet->cTp
//oObj:cRDACode	:= HttpGet->cRda
oObj:cCodLoc	:= HttpGet->cCodLoc
oObj:cTipoAut	:= IiF( ValType(HttpGet->cTpAut) != 'U',HttpGet->cTpAut,"L")

cSetDtInt := Iif(!Empty(HttpGet->SetDtInt),HttpGet->SetDtInt,"0")

oObj:cSetDtInt	:= cSetDtInt

cValPr				:= iif( ValType(HttpGet->cVPerDig) != 'U', HttpGet->cVPerDig, "0")

if cSetDtInt = "1"
	oObj:cRDACode	:= StrTran(PLA09ASES(),"|M",",")
else
	oObj:cRDACode	:= HttpGet->cRda
endif

oObj:cAltera	:= Iif(!Empty(HttpGet->cAltGuia),HttpGet->cAltGuia,"")
oObj:cCRecno	   := Iif(!Empty(HttpGet->cRecno),HttpGet->cRecno,"0")
if !empty(HttpGet->cCodLoc)
	nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == HttpGet->cRda .And. x:cCodLoc == HttpGet->cCodLoc} )
else
	nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == HttpGet->cRda} )
endIf
if nPosRDA > 0 .AND. ValType(HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA) == "A"
	If Len(HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA) > 0
  		oObj:cCodEsp := HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA[1]:cCodEsp
  	EndIf
endif

if ValType(HttpGet->cTipoOrigem) != 'U' .and. !empty(HttpGet->cTipoOrigem)

	oObj:cDigiGui := HttpGet->cTipoOrigem
	oObj:cTipGui := HttpGet->cTipoGuia
	oObj:cDatGuia := HttpSession->dDtaAtend

endIf

//Caso coloque o nЗmero da LiberaГЦo, para validar a data com base na data de atendimento, e nЦo na data atual
if (cValPr == "1")
	oObj:ccOpcao := "1"
	oObj:cDatGuia := HttpSession->dDtaAtend
Endif	

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo para retorno da liberacao								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:RetAutLib()

		aClasse := ClassDataArr(oObj:OWSRetAutLibRESULT:OWSSCABGUI)
		If aScan(aClasse,{|x| AllTrim(x[1]) == "CPRVOPM"  }) > 0
	    	cOpme   := oObj:OWSRetAutLibRESULT:OWSSCABGUI:cPrvOpm
	  	EndIf

		If aScan(aClasse,{|x| AllTrim(x[1]) == "CPRVQUI"  }) > 0
	    	cQuimio := oObj:OWSRetAutLibRESULT:OWSSCABGUI:cPrvQui
	  	EndIf

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁCabecalho															   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		cResult +=	"cRegAns!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRegAns+"|"+;				//0
					"cNomeRdaSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeRda+"|"+; 		//1
					"cCnpjCpfSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCnpjCpfSol+"|"+;		//2
					"cCnesSol!"+iif(HttpGet->cTp = "06", HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA[1]:cCnes, oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCnesSol)+"|"+;      		//3
					"dDtAut!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtAut)+"|"+;        //4
					"cSenha!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cSenha+"|"+;           	//5
					"dDtValid!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtValid)+"|"+;    //6
			   		"dDtSolicit!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtSolicit)+"|"+;//7
					"cHrSolicit!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cHrSolicit+"|"+;   	//8
					"cCarSolicit!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCarSolicit+"|"+; 	//9
					"cCid!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCid+"|"+;               	//10
					"cProSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProSol+"|"+;         	//11
					"cOpeSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cOpeSol+"|"+;         	//12
					"cNomeSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeSol+"|"+;       	//13
					"cCodSigSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCodSigSol+"|"+;   	//14
					"cNumCrSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumCrSol+"|"+;     	//15
					"cEstSigSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cEstSigSol+"|"+;   	//16
					"cObs!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cObs+"|"+;         			//17
					"cIndCliSol!"+ WTDecode(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cIndCli) +"|"+;         //18 
					"cChvBD6!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cChvBD6+"|"+;				//19
					"cCbosSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCbosSol+'$'+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDescCbosSol+"|"+; //20
					"cTpAto!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipAto+"|"+; //21
					"cTpIntern!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTpIntern+"|"+; //22
					"cRegInter!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cRegInter+"|"+; //23
					"cQtdDSol!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cQtdDSol+"|"+; //24
					"cTpDoe!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTipDoe+"|"+; //25
					"cTmpDoe!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTmpDoe+"|"+; //26
					"cTmpDoeC!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cUndDoe+"|"+; //27
					"cIndAcid!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cIndAcid+"|"+; //28
					"cCid2!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCid2+"|"+; //29
					"cCid3!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCid3+"|"+; //30
					"cCid4!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCid4+"|"+; //31
					"dDPrAH!"+DToC(oObj:OWSRetAutLibRESULT:OWSSCABGUI:dDPrAH)+"|"+; //32
					"cQtdDAut!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cQtdDAut+"|"+; //33
					"cQtdDAutPro!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cQtdDAut+"|"+; //34
					"cTpAcom!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTpAcom+"|"+; //35
					"cCnpjCpfAut!"+Iif(Empty(oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCnpjSolT),oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCnpjCpfSol,oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCnpjSolT)+"|"+; //36
					"cNomeRdaAut!"+Iif(Empty(oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCnpjSolT),oObj:OWSRetAutLibRESULT:OWSSCABGUI:cNomeRda,oObj:OWSRetAutLibRESULT:OWSSCABGUI:cNomeSolT)+"|"+; //37
					"cCnesAut!"+Iif(Empty(oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCnpjSolT),oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCnesSol,oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCnesSolT)+"|"+; //38
					"cCnpjSolT!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCnpjSolT+"|"+; //39
					"cNomeSolT!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cNomeSolT+"|"+; //40
					"cTpAcomPro!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTpAcom+"|"+; //41
					"cDesAcomPro!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cDesAcom+"|"+; //42
					"cRdaSolT!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cRdaSolT+"|"+; //43
					"cProfSolT!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cProfSolT+"|"+; //44
					"cOpeSolT!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cOpeSolT+"|"+; //45
					"dDatInt!"+DToC(oObj:OWSRetAutLibRESULT:OWSSCABGUI:dDatInt)+"|"+; //46
					"cHorInt!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cHrAut+"|"+; //47
					"dDatAlt!"+DToC(oObj:OWSRetAutLibRESULT:OWSSCABGUI:dDatAlt)+"|"+; //48
					"cHorAlt!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cHorAlt+"|"+; //49
					"cCancel!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCancel+"|"+;//50
					"cStatus!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cDesSTAut+"|"+;//51
					"cNumeCart!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cMatric+"|"+;//52
					"cNomeUsu!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cNomeUsr+"|"+;//53
					"cFindEvo!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cFindEvo+"|"+;//54
					"dDtEmissao!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtAut)+"|"+;//55
					"cPlano!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cNomPla+"|"+;//56
					"cVldCarteira!"+DToC(oObj:OWSRetAutLibRESULT:OWSSCABGUI:dDtVldCar)+"|"+;//57
					"cCarSaud!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCarSaud+"|"+;//58
					"cGrPar!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cGrPar+"|"+;//59
					"cGraPartExe!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cGrPar+"|"+;//59
					"cTpFat!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTipFat+"|"+; //60
					"cQtdDPro!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cQtdDPro+"|"+; //61
					"cAtendRN!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cAteRN+"|"+; //62
					"cAtenRN!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cAteRN+"|"+; //63
					"cOpme!"+cOpme+"|"+; //64
					"cQuimio!"+cQuimio+"|"+; //65
					"dDtRlz!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz,"")+"|"+; //66
					"dDtRlz2!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz2),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz2,"")+"|"+; //67
					"dDtRlz3!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz3),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz3,"")+"|"+; //68
					"dDtRlz4!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz4),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz4,"")+"|"+; //69
					"dDtRlz5!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz5),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz5,"")+"|"+; //70
					"dDtRlz6!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz6),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz6,"")+"|"+; //71
					"dDtRlz7!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz7),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz7,"")+"|"+; //72
					"dDtRlz8!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz8),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz8,"")+"|"+; //73
					"dDtRlz9!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz9),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz9,"")+"|"+; //74
					"dDtRlz1!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz1),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDtRlz1,"")+"|"+; //75
					"cTpAteExe!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipAte),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipAte,"")+"|"+; // 76
					"cIndAcid!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cIndAci),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cIndAci,"")+"|"+; // 77
					"cTpSai!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipSai),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipSai,"")+"|"+; // 78
					"cTipCon!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipCon),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipCon,"")+"|"+; // 79
					"cTpCon!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipCon),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipCon,"")+"|"+; //80
					"cCodSigExe!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipCon),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCCPECO,"")+"|"+; //81
					"cNumCrExe!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipCon),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRGEXCO,"")+"|"+; //82
					"cEstSigExe!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipCon),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cEXECCO,"")+"|"+; //83
					"cCbosExe!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTipCon),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCEPCCO,"")+"|"+; //84
					"cProSol!" + IIF(HttpGet->cTp == '01' .AND. (oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProSol == ""), oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cPREXCC,"" )+"|"+; //85
					"cFormNumber!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumImp+"|"+; //86
					"cGralau!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cGralau+"|"+; //87
					"cProSolDesc!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeSol+"|"+; //88
					"cProtoc!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cProtoc+"|" //89

					if ValType(oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTipAut) == "C"
						cResult += "cTipAlt!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTipAut+"|" //96
					EndIf

					if ValType(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumAux) == "C"
						cResult += "cNumMaxAux!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumAux+"|"
					endif
					
					cResult += "<" //Fim

		//NЗmero de auxiliares
		HttpSession->cNumAux		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumAux

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Matriz de itens														   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		For nI:=1 To Len(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI)
		    If oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cExibe == "1"
		        lExibe := .T.
	            aClasse := ClassDataArr(oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI])
				  iF aScan(aClasse,{|x| AllTrim(x[1]) == "CDIAGNO"  }) > 0
	            	cDiagno := oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDiagno
	            Else
	            	cDiagno := ''
	            EndIf

	            cResult +=	"cTpServ!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cTpServ+"@"+; //0
					        "cExibe!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cExibe+"@"+;  //1
	            			"cCodPad!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPad+"@"+; //2
							"cCodPro!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPro+"@"+; //3
							"cDesPro!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDesPro+"@"+; //4
							"nQtdSol!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cQtdSol+"@"+; //5
							"nQtdAut!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cQtdAut+"@"+; //6
							"cFabric!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cFabric+"@"+; //7
							"nVlrApr!"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrApr,"@U 999,999,999.99" ) )+"@"+;//8
							"cDente!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDente+"@"+;//9
							"cFace!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cFace+"@"+;//10
							"nQtdUs!"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nQtdUs,"@U 999,999,999.99" ) )+"@"+;//11
							"nVlrCon!"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrCon,"@U 999,999,999.99" ) )+"@"+;//12
							"nVlrTpf!"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrTpf,"@U 999,999,999.99" ) )+"@"+;//13
							"cStatus!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cAutori+"@"+;//14
							"cSeqMov!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSequencia+"@"+;//15
							'dDtExePro!'+DToC(oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:dDtExe)+"@"+;//16
							'cSenhaPro!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSenha+"@"+;//17
							'cResAutPro!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cResAut+"@"+;//18
							'cHorIni!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cHorIni+"@"+;//19
							'cHorFim!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cHorFim+"@"+;//20
							'cViaAc!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cViaAc+"@"+;//21
							'cTecUt!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cTecUt+"@"+;//22
							'nRedAcre!'+AllTrim( TransForm( oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nRedAcre,"@U 999.99" ) )+"@"+;//23
							'nVlrTAp!'+AllTrim( TransForm( oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrTAp,"@U 999,999,999.99" ) )+"@"+;
							'cDiagPro!'+cDiagno+"@"+;//24
							'cVlrPro!'+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrApr,"@U 999,999,999.99" ) )+"@"+;//para guia de consulta
							'dDtAtend!'+DToC(oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:dDtExe)+"@"+;//16
							'lPacote!' + oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cPacote +"@"+;
							'cTpProc!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cTpProc+"~"//25

				  // Esse item ira montar o grid na session, foi necessario pois na chamada da liberaГЦo pela sesssion esta vazia ele perdia os procedimentos
	            cValGDExe :=	"cTpServ$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cTpServ+";"+; //0
					        "cExibe$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cExibe+";"+;  //1
	            			"cCodPadSExe$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPad+";"+; //2 ***
							"cCodProSExe$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPro+";"+; //3 ***
							"cDesProSExe$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDesPro+";"+; //4 ***
							"cQtdSExe$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cQtdAut+";"+; //6 ***
							"cFabric$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cFabric+";"+; //7
							"nVlrUniSExe$"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrApr,"@U 999,999,999.99" ) )+";"+;//8 ***
							"cDente$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDente+";"+;//9
							"cFace$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cFace+";"+;//10
							"nQtdUs$"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nQtdUs,"@U 999,999,999.99" ) )+";"+;//11
							"nVlrCon$"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrCon,"@U 999,999,999.99" ) )+";"+;//12
							"nVlrTotSExe$"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrTpf,"@U 999,999,999.99" ) )+";"+;//13 ***
							"cStatus$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cAutori+";"+;//14
							"cSeqMov$"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSequencia+";"+;//15
							'dDtExe$'+DToC(oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:dDtExe)+";"+;//16 ***
							'cSenhaPro$'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSenha+";"+;//17
							'cResAutPro$'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cResAut+";"+;//18
							'cHorIniSExe$'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cHorIni+";"+;//19 ***
							'cHorFimSExe$'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cHorFim+";"+;//20 ***
							'cViaSExe$'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cViaAc+";"+;//21 ***
							'cTecSExe$'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cTecUt+";"+;//22 ***
							'nRedAcreSExe$'+AllTrim( TransForm( oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nRedAcre,"@U 999.99" ) )+";"+;//23
							'nVlrTAp$'+AllTrim( TransForm( oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrTAp,"@U 999,999,999.99" ) )+";"+;
							'cDiagPro$'+cDiagno+";"+;//24
							'cTpProc$'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cTpProc+";"//25


			EndIf
			If !Empty(cValGDExe)
				PTrGdLib(cValGDExe,"TabExeSer")
			EndIf
		Next

		// Matriz de criticas 												   
		if( Len(oObj:OWSRETAUTLIBRESULT:OWSSCriGui:oWsAutErrorView) > 0)
			For nI:=1 To Len(oObj:OWSRETAUTLIBRESULT:OWSSCriGui:oWsAutErrorView)
				if !("&nbsp;" $ oObj:OWSRETAUTLIBRESULT:OWSSCriGui:oWsAutErrorView[nI]:cCode)
					cCriticas += oObj:OWSRETAUTLIBRESULT:OWSSCriGui:oWsAutErrorView[nI]:cCode + " - "
					cCriticas += oObj:OWSRETAUTLIBRESULT:OWSSCriGui:oWsAutErrorView[nI]:cDescription + ";"
				endIf
			Next
			cCriticas := LEFT(cCriticas, (len(cCriticas)-1)) 
		endIf

		//Gravo os atributos necessarios para o metodo 'isDupGui'
		cTipGui := oObj:cTipo
		cCodUsr := oObj:cUserCode
		cCodRda := oObj:cRdaCode
		cGuiRef := oObj:cNumAut
		cMatric := oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric
		cDatGui := DtoS(Date())
		
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁHonorario Individual													   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If HttpSession->cTp == '5'
			oObj:cNumPeg :=  oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cChvBD6
			If oObj:GetBD6()
				HttpSession->aMatBD6 := oObj:oWSGETBD6RESULT:OWSSMATBD6
			EndIf
		EndIf
		
		// Parametros para retornar se a guia eh duplicada
		oObj:cUserCode			:= cCodUsr
		oObj:cRdaCode			:= cCodRda
		oObj:cTipGui			:= cTipGui	
		oObj:cUserCardNumber	:= cMatric
		oObj:cNumGuiRef			:= cGuiRef
		oObj:cDatGuia		 	:= cDatGui
		
		// Verifica se a guia pode estar sendo duplicada
		cResult += "<" //coloquei aqui pra garantir no js que essa posiГЦo vai ser sempre do isdupgui
		if oObj:isDupGui()
			cResult += SubStr(oObj:cIsDupGuiRESULT,6)
		endif 
		
		cResult += "<" + cCriticas //criticas
		
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Se nao tem procedimento												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If !lExibe
			cResult := "false|Nenhum procedimento autorizado para o executante!"
		EndIf
Else
		cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSALERT  Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Procura a liberacao e mostra os dados						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PPLSALERT( cMsgInternal, cTopo, cMsg, cPagVolta )
LOCAL cHtml 	:= ""
LOCAL cMsgError := PWSGetWSError( cMsgInternal )

cMsgError := SubStr(cMsgError,At(":",cMsgError)+1,Len(cMsgError))

WEB EXTENDED INIT cHtml START "InSite"

HttpSession->_HTMLERRO := { NIL, NIL, NIL }

If Empty( cMsg )
	If !Empty( cMsgError )
		cMsg := cMsgError
	Endif
Endif
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁVariavel  para exibir												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->_HTMLERRO[1] := cTopo
HttpSession->_HTMLERRO[2] := cMsg
HttpSession->_HTMLERRO[3] := cPagVolta
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁEnvia para o determinado formulario									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLSMSG" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSREIPAR Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina chama formulario de parametros reimpressao da guia	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSREIPAR()
LOCAL cHtml	:= ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLSPAREIM" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSREIMGU Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para reimpressao da guia								 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSREIMGU()
LOCAL oObj
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 		:= "MSALPHA"

//oObj:cUserCardNumber:= AllTrim(StrTran(StrTran(HttpPost->cMatricula,".",""),"-",""))
//Conforme informaГУes, a tratativa de retirada do "ponto" e do "traГo" foi devido a uma tratativa antiga,
//porИm conforme as novas telas do portal , exemplo a nova tela de atendimento, esta funcionalidade de retirar
//o "ponto" e "traГo" foi descontinuado. Por isso retiramos tambИm da reimpressЦo, conforme abaixo
oObj:cUserCardNumber:= HttpPost->cMatricula
oObj:cRDACode		:= SubStr( HttpPost->cRda,1,At('|',HttpPost->cRda)-1 )
oObj:cCodLoc		:= SubStr( HttpPost->cRda,At('|',HttpPost->cRda)+1 )

If !EMPTY(HttpPost->cDtAut) 
	oObj:dDtAut	    := CtoD(HttpPost->cDtAut)
Else
	oObj:dDtAut 	:= CTOD("")
EndIf 

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama metodo para traser todas as guias do usuario na data e prestador  Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:RetAut()
	HttpSession->aMatGuia := { oObj:OWSRETAUTRESULT:OWSSMATAUT }
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLSREIPAR.APW" )
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁEnvia para o formulario												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLSREIMGU" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSMATREI Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Alimenta a matriz para reimpressao da guia					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSMATREI()
LOCAL oObj,oObjX  := NIL
LOCAL nI,nY       := 0
LOCAL nPos		  := 0
LOCAL cHtml   	  := ""
LOCAL cSequen	  := ""
LOCAL cCodTab	  := ""
LOCAL cCodPro	  := ""
LOCAL cDesPro	  := ""
LOCAL cDente	  := ""
LOCAL cFace	  	  := ""
LOCAL cQtdTot	  := ""
LOCAL cCritica	  := ""
LOCAL cQtdUs      := ""
LOCAL cData       := ""
LOCAL cSenhaAu    := ""
LOCAL cSenPro	  := ""
LOCAL cDesGRP	  := ""
LOCAL aCBox		  := {}
Local cArqAph 	  := ""
Local lProrrog  	  := (HttpGet->lProrrog <> Nil .and. HttpGet->lProrrog == '.T.')

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁSessao para impressao da guia										   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->aResult := {}
HttpSession->lSen 	 := .F.
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode		 := "MSALPHA"
oObj:cUserCardNumber := ""
oObj:cNumAut         := AllTrim(StrTran(StrTran(HttpGet->cNumGuia,".",""),"-",""))
oObj:cTipoAut        := "A"
oObj:cCampos         := "BEA_STATUS"
oObj:cTipo		     := HttpGet->cTp
HttpSession->cTp 	 := HttpGet->cTp
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMonta o box de um determinado campo									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GetBox()
	aCBox := oObj:OWSGETBOXRESULT:OWSGENERICSTRUCT
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo para retorno das guia									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:RetAutLib()
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁAlimenta variaveis													   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cStatusGuia 			:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cSTAut
	HttpSession->cNumeAut	:= HttpGet->cNumGuia
	HttpSession->cSenha		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cSenha
	HttpSession->cCid  		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCid
	HttpSession->DtPro 		:= DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtAut)
	HttpSession->HrPro		:= Transform( oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cHrAut, "@R 99:99" )
	HttpSession->cNome		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric + " - " + oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeUsr
	HttpSession->cNomeSol	:= Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProSol),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProSol+" - "+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeSol,"")
	HttpSession->cNomeRda	:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRda + " - " + oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeRda
	HttpSession->cIndCli	:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cIndCli
	If Type('oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cFormNumber') <> 'U'
		HttpSession->cFormNumber:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cFormNumber
	Else
		HttpSession->cFormNumber:= ''
	Endif
	cData       			:= DtoC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtAut)
	cSenhaAu    			:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cSenha
	cGrPar					:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cGrPar
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Se ainda nao existir crio														  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If ValType(HttpSession->aGrPart) == 'U'
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁWeb Service															   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		oObjX := WSPLSXFUN():New()
		WsChgURL( @oObjX, "PLSXFUN.APW" )
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		//Ё Propriedade
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		oObjX:cUserCode	:= "MSALPHA"
		oObjX:cTipo 	:= HttpGet->cTp
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Executando Metodo																  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If oObjX:GetDadG()
			HttpSession->aGrPart := oObjX:oWSGetDadGRESULT:oWSCbGraPar:oWSGenericStruct
		EndIf
	EndIf
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Descricao do Grau de participacao												  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If (nPos := aScan( HttpSession->aGrPart, { |x| x:cCODE == cGrPar} ) ) > 0
		cDesGRP := HttpSession->aGrPart[nPos]:CDESCRIPTION
	EndIf
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁTipo de Guia															   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Do Case
	   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	   //Ё Consulta																			 Ё
	   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	   Case HttpSession->cTp == '1'
			HttpSession->cTpComprov	:= 'Consulta - ExecuГЦo'
	   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	   //Ё Sadt																				 Ё
	   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	   Case HttpSession->cTp == '2'
			HttpSession->cTpComprov	:= 'Sadt - SolicitaГЦo'
	        If oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cOrigem == '1'
				HttpSession->cTpComprov	:= 'Sadt - ExecuГЦo'
		    EndIf
	   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	   //Ё Internacao 																		 Ё
	   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	   Case HttpSession->cTp == '3'
			HttpSession->cTpComprov	:= 'Inter./Prorrog. - Solic./Exec.'
	   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	   //Ё Odontologico																		 Ё
	   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	   Case HttpSession->cTp == '4'
			HttpSession->cTpComprov	:= 'OdontolСgico - SolicitaГЦo'
	        If oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cOrigem == '1'
				HttpSession->cTpComprov	:= 'OdontolСgico - ExecuГЦo'
		    EndIf
	   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	   //Ё Honorario Individual																 Ё
	   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	   Case HttpSession->cTp == '5'
			HttpSession->cTpComprov	:= 'HonorАrio Individual'
	EndCase
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁItens e criticas														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	For nI := 1 To Len( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI )
	   	If HttpGet->lProrrog <> Nil .and. !lProrrog .and. !Empty(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSenha)
    		Loop
    	EndIf

    	aCritica 	:= {}
    	cSequen		:= oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSequencia
    	cCodTab		:= oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPad
    	cCodPro		:= AllTrim( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPro )
    	cDesPro		:= StrTran(PadR(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDesPro,55)," ","&nbsp;")
		cDente    	:= AllTrim(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDente)
		cDente    	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cDente),"&nbsp;&nbsp;&nbsp;&nbsp;",SubStr(cDente,1,At('-',cDente)-1) ),"" )
		cFace     	:= AllTrim(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cFace)
		cFace     	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cFace),"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",SubStr(cFace,1,At('-',cFace)-1) ),"" )

		If oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cOrigem == '2'  //solicitaГЦo
			cQtdTot		:= StrZero(Val(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cQtdSol),4)
		Else
			cQtdTot		:= StrZero(Val(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cQtdAut),4)
		Endif

		cQtdUs      := AllTrim( Str(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nQtdUs) )
		cSenPro		:= oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSenha
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁCriticas																   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		For nY:=1 To Len(oObj:OWSRETAUTLIBRESULT:OWSSCRIGUI:oWSAUTERRORVIEW)
			If oObj:OWSRETAUTLIBRESULT:OWSSCRIGUI:oWSAUTERRORVIEW[nY]:cSequence == oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSequencia
	            cCritica := "&nbsp;&nbsp;&nbsp;&nbsp;<samp class='TextoNegPeq'>"+oObj:OWSRETAUTLIBRESULT:OWSSCRIGUI:oWSAUTERRORVIEW[nY]:cCode+" - "+;
						  											  			 	 oObj:OWSRETAUTLIBRESULT:OWSSCRIGUI:oWSAUTERRORVIEW[nY]:cDescription+"</samp><br>"
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Monta matriz para impressao de guia									  			  Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    			AaDd(aCritica,cCritica )
			EndIf
		Next
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta matriz para impressao de guia									  			  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        AaDd( HttpSession->aResult,{cSequen,cCodTab,cCodPro,cDesPro,cDente,cFace,cQtdTot,aCritica,cQtdUs,cData,cSenhaAu,cSenPro,cDesGRP} )
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se tem algum procedimento com senha									  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        If !Empty(cSenPro)
			HttpSession->lSen := .T.
        EndIf
	Next
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁContinua alimentando variaves para impressao							   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If oObj:GetBox()
		HttpSession->cTitulo := aCBox[Ascan( aCBox, {|x| x:cCODE == cStatusGuia} )]:CDESCRIPTION
	EndIf
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁFormulario de impressao de guia										   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	HttpSession->cBVolt := "1"
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁRetorna o valor da co-participacao									   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If !Empty(HttpSession->cNumeAut)  .And. HttpSession->cTp <> '5'
		oObj:CNUMAUT := AllTrim(StrTran(StrTran(HttpSession->cNumeAut,".",""),"-",""))
		If oObj:GetVlrCo() .AND. oObj:OWSGETVLRCORESULT:NVLRPF > 0
			HttpSession->aVlrPF := {}
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CGUIACO)//1
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:NVLRPF)//2
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:NVLRBPF)//3
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:NPERCPF)//4
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:NVLRTPF)//5
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:NVLRTAD)//6
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CEXIBECO)//7
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CEXIBEBA)//8
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CPAGRDA)//9
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁMensagens															   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG001)//10
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG002)//11
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG003)//12
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG004)//13
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG005)//14
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG006)//15
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG007)//16
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG008)//17
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG009)//18
			AaDd(HttpSession->aVlrPF,oObj:OWSGETVLRCORESULT:CMSG010)//19
		EndIf
	EndIf

	If ExistBlock("PPLMFUN1")
		cRet  := Execblock("PPLMFUN1",.F.,.F.,{})
		cHtml := ExecInPage( cRet )
	Else

		cArqAph := PPSAphGuia(HttpSession->cTp)
		cHtml := ExecInPage(cArqAph)

	Endif

Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLSREIPAR.APW" )
EndIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSCHAAL  Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina chama form de alteracao de senha						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCHAAL()
LOCAL cHtml	:= ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLALTSEN" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSCHEPAS Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Altera a senha do usuario									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCHEPAS()
LOCAL oObj
LOCAL cResult := "true|"
LOCAL lRet	  := .T.
Local nX      := 0
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ёobj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSUSERPORTAL():NEW()
WsChgUrl(@oObj,"USERPORTAL.apw")

oObj:cUSERCODE := "MSALPHA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁVerifica se a senha confere											   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If !(AllTrim( GetUsrSenha() ) == HttpGet->Field_SENHA)
  Return cResult := PLSDECODE("false|Senha nЦo confere")
Endif

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁVerifica se a nova senha Tem tamanho 8										   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If LEN(AllTrim(HttpGet->Field_NEWSEN)) < 8
	lRet := .F.
Endif
If lRet
	// Verifica se existe pelo menos 1 digito
	lRet:= .F.
	FOR nX := 1 TO Len(Alltrim(HttpGet->Field_NEWSEN))
		IF ISDIGIT((SUBSTR(Alltrim(HttpGet->Field_NEWSEN),nX,1))) .Or.;
			!LETTERORNUM(SUBSTR(Alltrim(HttpGet->Field_NEWSEN),nX,1))
			lRet := .T.
	    	Exit
	    ENDIF
	NEXT nX
Endif
If !lRet
  Return cResult := PLSDECODE("false|Por seguranГa a senha deve ter 8 caracteres, sendo pelo menos 1 caractere nЦo-alfabИtico (numИrico ou caractere especial)")
Endif

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMetodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:PRTPSWUSER( getUsrWeb() , AllTrim(GetUsrSenha()), HttpGet->Field_NEWSEN, HttpSession->cTipoPortal)
	If !SetUsrSenha( HttpGet->Field_NEWSEN )
		HttpFreeSession()
	Endif
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFaz a validacao da senha e criptografa, faz a gravacao do campo data.   Ё
//ЁAlterado por Ronaldo Dantas                                             Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	HttpGet->Field_NEWSEN := PLSCRIDEC(1,Alltrim(HttpGet->Field_NEWSEN))

	cResult := "true|Senha alterada com sucesso"
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
Endif

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PLSCHAHIS  Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina chama form de Historico de utilizacao					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCHAHIS()

LOCAL cHtml	:= ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInicio Extended														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDireciona para pagina												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLHISUTI" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PLSPROHISU Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina processar e chama form de Historico de utilizacao		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSPROHIS()
LOCAL oObj
LOCAL cResult := ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE				:= "MSALPHA"
oObj:oWSMViewPar:cCodLog	:= HttpPost->Field_CODUSU
oObj:oWSMViewPar:cDateDe   	:= HttpPost->Field_DTDE
oObj:oWSMViewPar:cDateAte  	:= HttpPost->Field_DTATE
oObj:oWSMViewPar:cHorDe    	:= HttpPost->Field_HRDE
oObj:oWSMViewPar:cHorAte   	:= HttpPost->Field_HRATE
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo para retorno das guia									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GetHistLogin()
   HttpSession->aMatHisUti := { oObj:OWSGETHISTLOGINRESULT:OWSSVIEWHISTLOG }
   cResult := "true|"
Else
   cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPLSCHFORHU  Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Abre o formulario com resultado da utilizacao do usuario		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCHFORH()

LOCAL cHtml	:= ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInicio Extended														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDireciona para pagina												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLMOSHIUT" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim Extended														   	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLS673PA  Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina chama formulario de parametros extrato rda			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLS673PA()
LOCAL cHtml	:= ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLPAR673" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLEXE673   Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Executa o relatorio 673 extrato da rda						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEXE673()
LOCAL oObj
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁCria variavel de sessao												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpPost->cRda) <> 'U'
	HttpSession->cRDARel := SubStr( HttpPost->cRda,1,At('|',HttpPost->cRda)-1 )
	HttpSession->cCodLoc := SubStr( HttpPost->cRda,At('|',HttpPost->cRda)+1 )
	HttpSession->cAnoRel := HttpPost->cAno
	HttpSession->cMesRel := HttpPost->cMes
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSRELT():New()
WsChgURL( @oObj, "PLSRELT.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 			:= "MSALPHA"
oObj:oWSINPAR:cRDA 		:= HttpSession->cRdaRel
oObj:oWSINPAR:cCodLoc   := HttpSession->cCodLoc
oObj:oWSINPAR:cAno		:= HttpSession->cAnoRel
oObj:oWSINPAR:cMes 		:= HttpSession->cMesRel
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:REL673S()
	FT_FUse( oObj:cREL673SRESULT )
	FT_FGotop()
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Todas as linhas														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	HttpSession->aMatRel := {}
	While ( !FT_FEof() )
	    cRelato := FT_FREADLN()
	    If At("RPC",cRelato) == 0
			AaDd( HttpSession->aMatRel, StrTran(cRelato ," ","&nbsp;") + CRLF  )
		EndIf
		FT_FSkip()
	EndDo
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Fecha o arquivo														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	FT_FUse()
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLS673PA.APW" )
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDefine rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cRotRel := "W_PPLEXE673.APW"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLMOSREL" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLS754PA  Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Extrato de Utilizacoes										 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLS754PA()
LOCAL cHtml	:= ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLPAR754" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLEXE754   Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Executa o relatorio 754 Extrato de Utilizacao				 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEXE754()
LOCAL oObj	:= nil
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁCria variavel de sessao												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpPost->cRda) <> 'U'
	HttpSession->cRDARel	:= SubStr( HttpPost->cRda,1,At('|',HttpPost->cRda)-1 )
	HttpSession->cCodLoc   	:= SubStr( HttpPost->cRda,At('|',HttpPost->cRda)+1 )
	HttpSession->cDtDe		:= HttpPost->cDtDe
	HttpSession->cDtAte  	:= HttpPost->cDtAte
	HttpSession->cGuia   	:= HttpPost->cGuia
	HttpSession->cTipo   	:= HttpPost->cTipo
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSRELT():New()
WsChgURL( @oObj, "PLSRELT.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 			:= "MSALPHA"
oObj:oWSINPAR:cRDA		:= HttpSession->cRDARel
oObj:oWSINPAR:cCodLoc   := HttpSession->cCodLoc
oObj:oWSINPAR:dDtDe		:= CToD(HttpSession->cDtDe)
oObj:oWSINPAR:dDtAte	:= CToD(HttpSession->cDtAte)
oObj:oWSINPAR:cGuia 	:= HttpSession->cGuia
oObj:oWSINPAR:cTipo 	:= HttpSession->cTipo
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:REL754S()
	FT_FUse( oObj:cREL754SRESULT )
	FT_FGotop()
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Todas as linhas														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	HttpSession->aMatRel := {}
	While ( !FT_FEof() )
	    cRelato := FT_FREADLN()
	    If At("RPC",cRelato) == 0
			AaDd( HttpSession->aMatRel, StrTran(cRelato ," ","&nbsp;") + CRLF  )
		EndIf
		FT_FSkip()
	EndDo
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Fecha o arquivo														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	FT_FUse()
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLS754PA.APW" )
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDefine rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cRotRel := "W_PPLEXE754.APW"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLMOSREL" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLS018PA  Ё Autor Ё Alexander Santos     Ё Data Ё 28.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina chama formulario de parametros Demostrativo de Pagamen Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLS018PA()
LOCAL cHtml	:= ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpGet->cR) != 'U'
	HttpSession->cTpRel := HttpGet->cR
EndIf
cHtml += ExecInPage( "PPLPAR018" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLEXE018   Ё Autor Ё Alexander Santos     Ё Data Ё 07.03.2007 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Executa o relatorio Demos Pag, Demos Odon e Extrato Pag		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEXE018()
LOCAL oObj
LOCAL cRelato	:= ""
LOCAL cHtml 	:= ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁCria variavel de sessao												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpPost->cRda) <> 'U'
	HttpSession->cRDARel  := SubStr( HttpPost->cRda,1,At('|',HttpPost->cRda)-1 )
	HttpSession->cCodLRel := SubStr( HttpPost->cRda,At('|',HttpPost->cRda)+1 )
	HttpSession->cAnoRel  := HttpPost->cAno
	HttpSession->cMesRel  := HttpPost->cMes
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSRELT():New()
WsChgURL( @oObj, "PLSRELT.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 			:= "MSALPHA"
oObj:oWSINPAR:cRDA 		:= HttpSession->cRDARel
oObj:oWSINPAR:cCodLoc	:= HttpSession->cCodLRel
oObj:oWSINPAR:cAno		:= HttpSession->cAnoRel
oObj:oWSINPAR:cMes 		:= HttpSession->cMesRel
oObj:oWSINPAR:cTp 		:= HttpSession->cTpRel
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:REL018S()
	FT_FUse( oObj:cREL018SRESULT )
	FT_FGotop()
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Todas as linhas														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	HttpSession->aMatRel := {}
	While ( !FT_FEof() )
	    cRelato := StrTran(FT_FREADLN(),'' ,'')
	    If At("RPC",cRelato) == 0
			AaDd( HttpSession->aMatRel, StrTran(cRelato ," ","&nbsp;") + CRLF  )
		EndIf
		FT_FSkip()
	EndDo
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Fecha o arquivo														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	FT_FUse()
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLS018PA.APW" )
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁDefine rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cRotRel := "W_PPLEXE018.APW"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLMOSREL" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLSSELO Ё Autor Ё Alexander Santos	   Ё Data Ё 09.06.06 Ё╠╠
╠╠цддддддддддедддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Ajuda para como logar no portal							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSSELO()
LOCAL cHtml  := ""
PRIVATE cMsg := ""

WEB EXTENDED INIT cHtml

	cMsg := "Para utilizaГЦo do Portal PLS basta informar os login e senha.<br><br>"
	cMsg += "ApСs informar os dados necessАrios basta clicar no botЦo 'Acessar o Portal'</b>"
	cMsg += "<br><br>"
	cMsg += "Caso tenha alguma duvida sobre os dados de login e senha<br>"
	cMsg += "utilize a funcionalidade 'Esqueceu sua Senha?'<br><br>"
	cMsg += "<br><br>"

cHtml += ExecInPage("PPLSSENHA")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLSSELO Ё Autor Ё Alexander Santos	   Ё Data Ё 11.01.12 Ё╠╠
╠╠цддддддддддедддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Ajuda para campo											 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSHELP()
LOCAL cHtml  := ""
PRIVATE cMsg := ""

WEB EXTENDED INIT cHtml

	cMsg := 'Para fazer uma busca, basta digital o conteЗdo que desejar.' + "<br>"
	cMsg += "   <br><br>"
	cMsg += 'A tecla "Delete" limpa o conteЗdo da busca por completo, ' + "<br>"
	cMsg += 'retornando a posiГЦo inicial.' + "</b>"
	cMsg += "   <br><br>"
	cMsg += 'A tecla "Backspace" limpa o conteЗdo da busca ' + "<br>"
	cMsg += 'ate retornar a posiГЦo inicial.' + "<br>"
	cMsg += "   <br><br>"

cHtml += ExecInPage("PPLSSENHA")

WEB EXTENDED END

Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLSHEL1 Ё Autor Ё Daher				   Ё Data Ё 11.01.12 Ё╠╠
╠╠цддддддддддедддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Ajuda para campo											 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSHEL1()
LOCAL cHtml  := ""
PRIVATE cMsg := ""

WEB EXTENDED INIT cHtml

	cMsg := 'Informe neste campo o nЗmero da guia de honorАrio individual' + "<br>"
	cMsg += " <br><br>"
	cMsg += 'Este campo deve ser informando quando for necessАrio' + "<br>"
	cMsg += 'consultar uma guia de honorАrio individual jА digitada.' + "</b>"
	cMsg += "   <br><br>"
	cMsg += 'O nЗmero da guia de SolicitaГЦo/Senha deve ser informado' + "<br>"
	cMsg += 'no campo 3-N╨ Guia de SolicitaГЦo/Senha.' + "<br>"
	cMsg += "   <br><br>"

cHtml += ExecInPage("PPLSSENHA")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLSHEL2 Ё Autor Ё Daher				   Ё Data Ё 11.01.12 Ё╠╠
╠╠цддддддддддедддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Ajuda para campo											 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSHEL2()
LOCAL cHtml  := ""
PRIVATE cMsg := ""

WEB EXTENDED INIT cHtml

	cMsg := 'Informe neste campo o nЗmero da guia de solictaГЦo de ' + "<br>"
	cMsg += "internaГЦo que originou o honorario individual que <br>"
	cMsg += 'esta sendo digitado' + "<br>"

cHtml += ExecInPage("PPLSSENHA")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLESQSENH   Ё Autor Ё Alexander Santos	   Ё Data Ё 09.06.06 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Esqueceu a Senha	chamada para o informar o e-mail			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLESQSENH()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml

cHtml += ExecInPage("PPLESQSENH")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLSEVSEN      Ё Autor Ё Alexander Santos	     Ё Data Ё 09.06.06 Ё╠╠
╠╠цддддддддддедддддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Validacao de dados e envia por e-mail						   Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSEVSEN()
LOCAL oEmail
LOCAL oObj
LOCAL cSmtpEnv
LOCAL cUsuEmai
LOCAL cUsuPass
LOCAL lRet  	:= .T.
LOCAL cResult 	:= ""
LOCAL cHtml := ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSCFGDICTIONARY():New()
WsChgURL( @oObj, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cMVPARAM	:= "MV_RELSERV"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMetodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GETPARAM()
	cSmtpEnv := oObj:cGETPARAMRESULT
	If Type(cSmtpEnv) == 'L'
		lRet 	:= .F.
		cResult := "false|Parametro MV_RELSERV nЦo encontrado"
	Else
		If Empty(cSmtpEnv)
			lRet	:= .F.
			cResult := "false|Parametro MV_RELSERV sem conteudo"
		EndIf
	EndIf
Else
	lRet 	:= .F.
	cResult := "false|Parametro MV_RELSERV nЦo encontrado"
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPega a conta do usuario para fazer o envio							   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If lRet
	oObj:cMVPARAM	:= "MV_RELACNT"
	If oObj:GETPARAM()
		cUsuEmai := oObj:cGETPARAMRESULT
		If Type(cUsuEmai) == 'L'
		    lRet 	:= .F.
			cResult := "false|Parametro MV_RELACNT nЦo encontrado"
	    Else
	   		If Empty(cUsuEmai)
				lRet 	:= .F.
				cResult := "false|Parametro MV_RELACNT sem conteudo"
			EndIf
		EndIf
	Else
		lRet 	:= .F.
		cResult := "false|Parametro MV_RELACNT nЦo encontrado"
	EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPega a senha do usuario para fazer o envio							   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If lRet
	oObj:cMVPARAM	:= "MV_RELPSW"
	If oObj:GETPARAM()
		cUsuPass := oObj:cGETPARAMRESULT
		If Type(cUsuEmai) = 'L'
			lRet 	:= .F.
			cResult := "false|Parametro MV_RELPSW nЦo encontrado"
	    Else
			If Empty(cUsuPass)
				lRet 	:= .F.
				cResult := "false|Parametro MV_RELPSW sem conteudo"
			EndIf
	    EndIf
	Else
		lRet 	:= .F.
		cResult := "false|Parametro MV_RELPSW nЦo encontrado"
	EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁSe pode continuar													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If lRet
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁObj																	   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	oEmail := WSPLSXFUN():New()
	WsChgURL(@oEmail,"PLSXFUN.APW")
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁParametro															   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	oEmail:cUSERCODE  := "MSALPHA"
	oEmail:cUserEmail := HttpPost->cEmail
	oEmail:cSmtpEnv	  := cSmtpEnv
	oEmail:cUsuEmai	  := cUsuEmai
	oEmail:cUsuPass	  := cUsuPass
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁMetodo																   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If oEmail:GetEmail()
	   cResult := "true|"+oEmail:cGETEMAILRESULT
	Else
	   cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
	EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da funcao														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGUIMED    Ё Autor Ё Alexander Santos	   Ё Data Ё 09.06.06 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Mostra formulario do guia medico								 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGUIMED()
LOCAL cHtml := ""
LOCAL nX	:= 1
LOCAL oObjxFun

WEB EXTENDED INIT cHtml 

oObj := WSPLSMCTMD():New()
WsChgURL( @oObj, "PLSMCTMD.APW" )

oObjxFun := WSPLSXFUN():New()
WsChgURL( @oObjxFun, "PLSXFUN.APW" )

oObj:cUSERCODE 	:= "MSALPHA"
oObj:cFunName	:= 'PLPEECB'
oObj:nTp		:= 1


If ValType(HttpSession->aEspecialidade) == 'U' 
	If oObj:getParGM()
		HttpSession->aEspecialidade := oObj:oWSGETPARGMRESULT:OWSGENERICSTRUCT
	Else
		HttpSession->aEspecialidade := {}
	EndIf
EndIf

if ValType(HttpSession->aProdutos) == 'U'
	oObjxFun:cUSERCODE	:= "MSALPHA"
	if oObjxFun:getProdutos()
		HttpSession->aProdutos := {}		
		for nX := 1 to len(oObjxFun:oWSGETPRODUTOSRESULT:oWSPRODUTOSLIST)
			aAdd( HttpSession->aProdutos, WsClassNew( "ProdutosGM" ) )  
			HttpSession->aProdutos[nX]:cCODE			:= AllTrim(oObjxFun:oWSGETPRODUTOSRESULT:oWSPRODUTOSLIST[nX]:cCodigo)
			HttpSession->aProdutos[nX]:cDESCRIPTION		:= AllTrim(oObjxFun:oWSGETPRODUTOSRESULT:oWSPRODUTOSLIST[nX]:cNome)
		next
	else
		HttpSession->aProdutos := {}
	endif
endif

cHtml += ExecInPage("PPLGUIMED")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCGUIMED     Ё Autor Ё Alexander Santos	     Ё Data Ё 09.06.06 Ё╠╠
╠╠цддддддддддедддддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Chama form do guia medico									   Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCGUIMED()
LOCAL oObj		:= NIL
LOCAL cResult 	:= "true|"
LOCAL nI		:= 0
LOCAL aRet		:= {}
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml 

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё oBJ																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSMCTMD():New()
WsChgURL( @oObj, "PLSMCTMD.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametros															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cFunName   := "PLPEECB"
oObj:nTp		:= Val(HttpGet->nTp)
oObj:cCodEsp	:= HttpGet->cCodEsp
oObj:cCodEst	:= HttpGet->cCodEst
oObj:cCodMun	:= HttpGet->cCodMun
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:getParGM()
	aRet := oObj:oWSGETPARGMRESULT:OWSGENERICSTRUCT
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Monta retono
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If Len(aRet) > 0
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁMonta retorno para o combo
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	For nI:=1 To Len(aRet)
		cResult += aRet[nI]:cCode + "$" + aRet[nI]:cDescription + "|"
	Next
	cResult := Left(cResult,Len(cResult)-1)
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLMOSMAP    Ё Autor Ё Alexander Santos	   Ё Data Ё 09.06.06 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Mostra mapa													 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLMOSMAP()
LOCAL cHtml := ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Chamada do formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
WEB EXTENDED INIT cHtml

cHtml += ExecInPage("PPLMOSMAP")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLTRAPRE    Ё Autor Ё Alexander Santos	   Ё Data Ё 02.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Tratamento do pre-atendimento inclusao/alteracao e exclusao	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLTRAPRE()
LOCAL nI
LOCAL nPosRDA  := 0
LOCAL cResult  := "true|"
LOCAL cHtml := ""
Local lTimeAte	:= .F.
Local nTmpIni := Seconds()
Local lMatrAnt:= .T.

WEB EXTENDED INIT cHtml START "InSite"

oObjPar := WSCFGDICTIONARY():New()
WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )

oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PTIMATE" //Informa se И gestante na solicitaГЦo (1) ou na execuГЦo (2)
If oObjPar:GETPARAM()
	lTimeAte := oObjPar:cGETPARAMRESULT
	If ValType(lTimeAte) == 'U'
		lTimeAte := .F.
	ElseIf	ValType(lTimeAte) == 'C'
		If Type(lTimeAte)=="L"
			lTimeAte := &(lTimeAte)
		EndIf
	EndIf
EndIf

oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PLMATAP" //Exibe a matricula antiga
If oObjPar:GETPARAM()
 
	lMatrAnt := oObjPar:cGETPARAMRESULT == "1"
	
	If lMatrAnt .And. Valtype(HttpSession->aVldCartao) == "A" .and. !Empty(HttpSession->aVldCartao[11]) ;
	.And. HttpGet->cTpAca <> "E" .And. ValType(HttpSession->aVldCartao[11]) == 'C' .AND. !Empty(HttpGet->cMatric)  
		HttpGet->cMatric:= AllTrim(HttpSession->aVldCartao[11])
	EndIf
EndIf

//Obj																	   Ё
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//Registro no WS														   Ё
oObj:cUSERCODE 			:= "MSALPHA"
oObj:oWSMatPre:cCodRda	:= HttpGet->cRDA										  	//Rda
oObj:oWSMatPre:cTpAca	:= HttpGet->cTpAca									 		//Tipo de acao Inclui,altera ou excluir
oObj:oWSMatPre:cMatric	:= HttpGet->cMatric											//Matricula
oObj:oWSMatPre:cNomeUsu	:= alltrim(HttpGet->cNomeUsu)										//Nome do usuario
oObj:oWSMatPre:cCodUsr	:= getUsrWeb()											 	//Codigo de login web Login pls bsw
oObj:oWSMatPre:cCodLoc	:= HttpGet->cCodLoc   										//LOCAL de atendimento
oObj:oWSMatPre:cTrilha	:= HttpSession->TrilhaCard
If (ValType(HttpGet->cOrdResult) <> "U")
	If (HttpGet->cOrdResult = "")
		oObj:oWSMatPre:cOrdResult	:= "1"
	Else
		oObj:oWSMatPre:cOrdResult	:= HttpGet->cOrdResult
	EndIf
Else
	oObj:oWSMatPre:cOrdResult	:= "1"
EndIf
If ValType(HttpGet->cRDAOld) <> "U" .AND. ValType(HttpGet->cCodLocOld) <> "U" //Valores anteriores Ю alteraГЦo
	oObj:oWSMatPre:cCodRdaOld := HttpGet->cRDAOld
	oObj:oWSMatPre:cCodLocOld := HttpGet->cCodLocOld
Else
	oObj:oWSMatPre:cCodRdaOld := ""
	oObj:oWSMatPre:cCodLocOld := ""
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Verificacao															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If !Empty(HttpGet->cRDA)
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Rda																	   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	nPosRDA := aScan( HttpSession->RDAVIEW, { |x| alltrim(x:cCODE) == alltrim(HttpGet->cRda) .And. alltrim(x:cCodLoc) == alltrim(HttpGet->cCodLoc)} )
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Parametros															   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If nPosRDA == 0
		nPosRDA := 1
	Endif

	oObj:oWSMatPre:cOpeRda	:= HttpSession->RDAVIEW[nPosRDA]:cCodOpe			//Operadora da rda
	oObj:oWSMatPre:cNomRda	:= HttpSession->RDAVIEW[nPosRDA]:cName	   			//Nome rda
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:PreAte()
	HttpSession->aMatPreAte := { oObj:oWSPREATERESULT:oWSSRETMATPRE }
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Monta a string de resposta											   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If ValType(HttpSession->aVldCartao) == 'A'
		cResult += Iif(Empty(HttpSession->aVldCartao[11]),Transform(HttpSession->aVldCartao[2],'@R 9999.9999.999999.99-9'),Iif( Len(HttpSession->aVldCartao[11])>16,Transform(HttpSession->aVldCartao[11],'@R 9999.9999.999999.99-9'),Transform(HttpSession->aVldCartao[11],'@R 999.9999.999999.99-9') ) )+"@"+HttpSession->aVldCartao[1]+"~"
	Else
		cResult += "@~"
	EndIf
	For nI:=1 To Len(HttpSession->aMatPreAte[1])
	    cResult += 	HttpSession->aMatPreAte[1,nI]:cMsg+"$"+;
	    			Iif( Len(HttpSession->aMatPreAte[1,nI]:cMatric)>16,Transform( HttpSession->aMatPreAte[1,nI]:cMatric, "@R 9999.9999.999999.99-9" ),Transform( HttpSession->aMatPreAte[1,nI]:cMatric, "@R !999.9999.999999.99-9" ) )+"$"+;
		   			AllTrim(HttpSession->aMatPreAte[1,nI]:cNomeUsu)+"$"+;
		   			HttpSession->aMatPreAte[1,nI]:cRda+"$"+;
		   			AllTrim(HttpSession->aMatPreAte[1,nI]:cNomeRda)+"$"+;
		   			HttpSession->aMatPreAte[1,nI]:cCodLoc+"$"+;
		   			DtoC(HttpSession->aMatPreAte[1,nI]:dDatChe)+"$"+;
		   			Transform( HttpSession->aMatPreAte[1,nI]:cHorChe, "@R 99:99" )+"|"
	Next
Else
    cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//Mostra o tempo que durou pra confirmar o atendimento
If lTimeAte
    oObjPar:cMsgLog  := "2) " + Time()+ "|" + Alltrim(Str(Seconds() - nTmpIni)) + "|" + HttpGet->cRDA
    oObjPar:cFileLog := "PreAtendimento.txt"
    oObjPar:PutPLSLogFil()
EndIf

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLSETLL     Ё Autor Ё Alexander Santos	   Ё Data Ё 29.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Grava latitudo e longitude									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSETLL()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= "true|"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSMCTMD():New()
WsChgURL( @oObj, "PLSMCTMD.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE	:= "MSALPHA"
oObj:cRecno		:= HttpGet->cRecno
oObj:cLatLon	:= HttpGet->cLatLon
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:setLatLon()

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETELL    Ё Autor Ё Alexander Santos	   Ё Data Ё 29.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna o endereco fisico, latitude longitude e endereco show Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETELL()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml 

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSMCTMD():New()
WsChgURL( @oObj, "PLSMCTMD.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cRecno		:= HttpGet->cRecno
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:getEndLL()
	cResult := oObj:cGETENDLLRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCHACOM    Ё Autor Ё Alexander Santos	   Ё Data Ё 29.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Chama form para mostrar a composicao de Solicitacao			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHACOM()
LOCAL cHtml := ""
LOCAL oObj  := NIL

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cCampos 	:= "BEA_TIPO"
oObj:cShowAnexo	:= "1"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMonta o box de um determinado campo									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpSession->aTpAut) == 'U'
	If oObj:GetBox()
		HttpSession->aTpAut := oObj:OWSGETBOXRESULT:OWSGENERICSTRUCT
	EndIf
EndIf

cHtml += ExecInPage("PPLMOSSOL")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCHAELE    Ё Autor Ё Alexander Santos	   Ё Data Ё 29.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Chama form para mostrar a solicitacao de elegibilidade		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHAELE()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Ponto de entrada para controle da exibicao das colunas da elegibilidade	 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->aMatEleg := {.T.,.T.,.T.,.T.,.T.,.T.,.T.,.T.,.T.,.T.,.T.,.F.}
If ExistBlock("PPLEXIELE")
	HttpSession->aMatEleg := ExecBlock("PPLEXIELE",.F.,.F.)
EndIf

cHtml += ExecInPage("PPLMOSELE")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCHADTIN   Ё Autor Ё Alexander Santos	   Ё Data Ё 06.03.10 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Chama form para informar data de internacao					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHADTIN()

LOCAL cHtml := ""
LOCAL oObj  := NIL
Local cRetorno := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUSERCODE		:= "MSALPHA"
oObj:cChave 		:= "39"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta a dados especifico por tipo de guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:RetBTQChv()

cRetorno := oObj:cRETBTQCHVRESULT

HttpSession->aMotivoAlta := StrTokArr(cRetorno, "#")//oObj:cRETBTQCHVRESULT//"teste"//cRetorno//StrTokArr(cRetorno, "$")

cHtml += ExecInPage("PPLDATINT")

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCHAHOIN   Ё Autor Ё Alexander Santos	   Ё Data Ё 06.03.10 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Chama form para honorario									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHAHOIN()
LOCAL cHtml := ""
LOCAL oObj  := NIL
LOCAL cTISSVer	:= ""

LOCAL cResult  	:= ""
LOCAL aCmbWS		:= {}
LOCAL aCmbX		:= {}
LOCAL aCmbAux		:= {}
LOCAL cStrCBOX	:= ""
LOCAL nI,nY, nPos

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cTp	:= '6'
HttpSession->cBVolt := "1"

oObj:cUSERCODE		:= "MSALPHA"
oObj:cTipo 			:= HttpSession->cTp
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta a dados especifico por tipo de guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GetDadG()
	HttpSession->aGrPart := oObj:oWSGetDadGRESULT:oWSCbGraPar:oWSGenericStruct
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAHOIN.APW" )
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta as variaves com o x3-combobox								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:getCombo()
	HttpSession->cCodPad    := oObj:oWSGETCOMBORESULT:cCodPad
	HttpSession->aViaAce	:= oObj:oWSGETCOMBORESULT:oWSCBViaAce:oWSGenericStruct
	HttpSession->aTecUti	:= oObj:oWSGETCOMBORESULT:oWSCBTecUti:oWSGenericStruct
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAHOIN.APW" )
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Passa a primeira rda do usuario logado								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cRdaRel := ""
HttpSession->cCodLoc := ""
If Len(HttpSession->RDAVIEW) >= 1
	HttpSession->cRdaRel := HttpSession->RDAVIEW[1]:cCODE
	HttpSession->cCodLoc := HttpSession->RDAVIEW[1]:cCodLoc

	//Recupera a versЦo da TISS da RDA
	aRDA := ClassDataArr(HttpSession->RDAVIEW[1])
	If aScan(aRDA,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0
		cTISSVer := HttpSession->RDAVIEW[1]:cTissVer
	EndIf
	HttpSession->cTISSVer := cTISSVer

EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё CRIAR PAGINA PARA TISS 3.0													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If cTissVer >= "3"

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё oBJ
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Parametros
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj:cUserCode	:= "MSALPHA"
	oObj:oWSGUIATISS:cTipGui		:= "06" // Guia de Honorarios
	oObj:oWSGUIATISS:cVerTiss	:= cTISSVer
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Aqui eu pego o que vem de Session executo aqui pra enviar a informaГao
	// pro WS pois o mesmo nao acessa o conteudo da Session	dificultando o dinamismo
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If oObj:GetCmbFormT()
		// ATRIBUO OS PARAMETROS NOVAMENTE PARA UTILIZAгцO DO PROXIMO METODO
		oObj:cUserCode	:= "MSALPHA"
		oObj:oWSGUIATISS:cTipGui		:= "06"
		oObj:oWSGUIATISS:cVerTiss	:= cTISSVer
		//oObj:oWSGUIATISS:OWSCMBGUIA	:= {}
		oObj:oWSGUIATISS:cDadCombo	:= ""
		If Len(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA) > 0 //oObj:OWSGETCMBFORMTRESULT:oWSRETCMBSGUIA
			For nI:=1 To Len(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA)
				cStrCBOX := ""
				If "HTTPSESSION" $ Upper(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)	 // Se for uma Session eu pego CCODE e CNAME e monto o Combo
					If ValType(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)) <> 'U'
						For nY := 1 To Len(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX))
							cStrCBOX += Alltrim(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cCODE")) + "=" + Alltrim(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cNAME")) + ";"
						Next nY
					EndIf
					If nY > 2
						cStrCBOX += ";="//cStrCBOX += ";=-- Selecione um item --"
					EndIf
				Else // Caso contrario eu pego a STRING com mesma estrutura do X3_COBX
					cStrCBOX := Alltrim(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)
				EndIf
				If SubStr(cStrCBOX, Len(cStrCBOX),1) == ";"
					cStrCBOX := SubStr(cStrCBOX, 1, Len(cStrCBOX)-1)
				EndIf
				oObj:oWSGUIATISS:cDadCombo	+= Alltrim(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCampoG) + ";" + cStrCBOX + "|"
				//WSDATA RetCmbsGuia	AS Array Of SRetCmbsGuia OPTIONAL
			Next
		EndIf
	EndIf
	If SubStr(oObj:oWSGUIATISS:cDadCombo, Len(oObj:oWSGUIATISS:cDadCombo),1) == "|"
		oObj:oWSGUIATISS:cDadCombo := SubStr(oObj:oWSGUIATISS:cDadCombo, 1, Len(oObj:oWSGUIATISS:cDadCombo)-1)
	EndIf
	//Alimenta tipo de guia com a query string passada por parБmetro
	oObj:cTipo 		:= IIF(Empty(HttpGet->cTipoOrigem),"",HttpGet->cTipoOrigem)
	oObj:ccRecno 		:= IIF(Empty(HttpGet->cNumGuia),"",HttpGet->cNumGuia)
	oObj:cDtLimRetro	:= IIF(Empty(HttpGet->dDtLimRetro),"",HttpGet->dDtLimRetro)

	HttpSession->cDigitacao := ""

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Retorna dados da pagina
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj:cDtJs := iif(valtype(HttpSession->cDtJs) <> 'U', HttpSession->cDtJs, "")
	If oObj:GetFormTiss()
		cResult :=  oObj:OWSGETFORMTISSRESULT:cPagina

		If ValType(oObj:OWSGETFORMTISSRESULT:cGrids) == "C"
			HttpSession->cGrids := oObj:OWSGETFORMTISSRESULT:cGrids
		EndIf

		If ValType(oObj:OWSGETFORMTISSRESULT:OWSCMPGUIA:oWSSCmpGuia) == "A" /*/:OWSCMPGUIA:OWSSCMPGUIA)*/
			HttpSession->aCmpGuia := aClone(oObj:OWSGETFORMTISSRESULT:OWSCMPGUIA:oWSSCmpGuia)
		EndIf

		//Executa os inicializadores dos campos
		nIni := At("<%=",cResult)
		While  nIni > 0
			nFim := At("%>",cResult)
			cComando := SubStr(cResult,nIni+3,nFim - nIni-3)
			xResult := &(cComando)

			cTipResult := ValType(xResult)
			Do Case
				Case cTipResult == "D"
					xResult := DtoS(xResult)
					xResult := SubStr(xResult,7,2) + "/" + SubStr(xResult,5,2) + "/" + SubStr(xResult,1,4)
				Case cTipResult == "N"
					xResult := Alltrim(Str(xResult))
			EndCase

			cResult := StrTran ( cResult, "<%=" + cComando + "%>", xResult)
			nIni := At("<%=",cResult)
		EndDo

	EndIf

	HttpSession->cPaginaGuia := Substr(cResult,At("|",cResult)+1,Len(cResult)) // Retiro o true| ou o false|

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё FIM CRIAR PAGINA PARA TISS 3.0													   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
EndIf

If cTissVer >= "3"
	cHtml += ExecInPage("PPLSGUIAS")
	//cHtml += ExecInPage("PPLSHOIN")
	//cHtml += ExecInPage("PPLSHOIF")
Else
	cHtml += ExecInPage("PPLSHOIN")
EndIf

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLEXEALT    Ё Autor Ё Roberto Vanderlei	   Ё Data Ё 06.03.10 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Informa a data de alta do paciente						     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEXEALT()
LOCAL cResult	:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 	:= "MSALPHA"
oObj:cNumAut	:= AllTrim( StrTran(StrTran(HttpGet->cNumGui,".",""),"-","") )
oObj:dDatAlt	:= CToD(HttpGet->dDatAlt)
oObj:cHorAlt	:= StrTran(HttpGet->cHorAlt,":","")
oObj:cMotAlt	:= alltrim(HttpGet->cMotAlt)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:ExeDHAlt()
	cResult := oObj:cExeDHAltRESULT
Else
    cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cResult
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLEXEINT    Ё Autor Ё Alexander Santos	   Ё Data Ё 06.03.10 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Informa a data de internacao do paciente						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEXEINT()
LOCAL cResult	:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 	:= "MSALPHA"
oObj:cNumAut	:= AllTrim( StrTran(StrTran(HttpGet->cNumGui,".",""),"-","") )
oObj:dDatInt	:= CToD(HttpGet->dDatInt)
oObj:cHorInt	:= StrTran(HttpGet->cHorInt,":","")
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:ExeDHInt()
	cResult := oObj:cExeDHIntRESULT
Else
    cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cResult
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLSTAGUI    Ё Autor Ё Alexander Santos	   Ё Data Ё 02.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Mostra dados da Guia										     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSTAGUI()
LOCAL nI,nY      := 0
LOCAL aMatComGui := {}
LOCAL cCritica	 := ""
LOCAL lbCancel	 := "true"
LOCAL cResult  	 := "true|"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 	:= "MSALPHA"
oObj:cNumAut	:= AllTrim( StrTran(StrTran(HttpGet->cNumGui,".",""),"-","") )
oObj:cTipoAut	:= HttpGet->cTipoAut
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:StatusGuia()
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Retorno																   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	aMatComGui := oObj:OWSSTATUSGUIARESULT:OWSSMATCOMPGUI
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Matriz de Retorno													   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	For nI:=1 To Len(aMatComGui)
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Nome do usuario e Data da Solicitacao								   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If nI == 1

			If aScan( HttpSession->RDAVIEW, { |x| x:cCODE == aMatComGui[1]:CRDACODE} ) == 0 .and. !(HttpGet->cTipoAut $ '7,8,9')
				lbCancel := 'false'
			EndIf

			cResult += aMatComGui[1]:cNomeUsu+"@"+;
					   aMatComGui[1]:cDtGui+"@"+;
					   aMatComGui[1]:cStaGui+"@"+;
					   aMatComGui[1]:cCancel+"@"+;
					   aMatComGui[1]:cOnLine+"@"+lbCancel+"~"
		EndIf
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Itens																   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    cResult += 	aMatComGui[nI]:cCodTab+"$"+; //Tabela
		   			aMatComGui[nI]:cCodPro+"$"+; //Procedimento
		   			aMatComGui[nI]:cDesPro+"$"+; //Nome do Procedimento
		   			aMatComGui[nI]:cQtdSol+"$"+; //Qtd Solcitacao
		   			aMatComGui[nI]:cQtdRea+"$"+; //Qtd Realizada
		   			aMatComGui[nI]:cQtdSal+"$"+; //Qtd Saldo
		   			aMatComGui[nI]:cStaAud+"$"+; //Status Auditoria
		   			aMatComGui[nI]:cStaPro+"^"	  //Status Procedimento
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Criticas															   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		cCritica := ""
		For nY:=1 To Len(aMatComGui[nI]:OWSMATCRI:OWSGENERICSTRUCT)
		    cCritica +=	"*        " + aMatComGui[nI]:OWSMATCRI:OWSGENERICSTRUCT[nY]:cCODE+" - "+AllTrim(aMatComGui[nI]:OWSMATCRI:OWSGENERICSTRUCT[nY]:cDescription)
		Next
		cResult += Iif( Empty(cCritica),'*',cCritica) + "|"
	Next

Else
    cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCANGUI    Ё Autor Ё Alexander Santos	   Ё Data Ё 02.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Cancela Guia													 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCANGUI()
LOCAL cResult	:= ""
LOCAL lDigiOff	:= .F.
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
lDigiOff := IIF(Valtype(HttpGet->cDigiGuia) <> "U" .AND. HttpGet->cDigiGuia == "1" , lDigiOff := .T., lDigiOff := .F.) //Verifico se И da DigitaГЦo Off-Line

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE  := "MSALPHA"
oObj:cNumAut	:= AllTrim( StrTran(StrTran(HttpGet->cNumGui,".",""),"-","") ) //Se DigitaГЦo Off-Line, passo o RECNO da BD5.
oObj:cMotivo	:= IIF (!lDigiOff, AllTrim( HttpGet->cMotivo ), "RECOFF") //SerА utilizado como comparador na hora da pesqusia do alias para deletar
oObj:cTipo		:= IIF (!lDigiOff, "", HttpGet->cTipo)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:CancelaGuia()
	cResult := oObj:cCANCELAGUIARESULT
Else
    cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLPROELE    Ё Autor Ё Alexander Santos	   Ё Data Ё 02.05.07 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Mostra dados Elegibilidade do Beneficiario					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROELE()
LOCAL nI	  := 0
LOCAL cResult := "true|"
LOCAL lPPLEXIS :=ExistBlock("PPLEXSTAT")
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS									  					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->aResult := {}
oObj:cUSERCODE 		 := "MSALPHA"
oObj:cUserCardNumber := AllTrim(HttpGet->cMatric) //AllTrim( StrTran(StrTran(HttpGet->cMatric,".",""),"-","") )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:Elegibilidade()
	cResult += 	AllTrim(oObj:OWSELEGIBILIDADERESULT:CCARDNAME)+"|"+;
				AllTrim(oObj:OWSELEGIBILIDADERESULT:CNOMTIT)+"|"+;
				AllTrim(oObj:OWSELEGIBILIDADERESULT:CNOMEMP)+"|"+;
				AllTrim(oObj:OWSELEGIBILIDADERESULT:CCARDNUMBEROLD)+"|"+;
				Iif(oObj:OWSELEGIBILIDADERESULT:LINTERCHANGE == .T.,"SIM","NцO")+"|"+;
				oObj:OWSELEGIBILIDADERESULT:COPEORI+"|"+;
				AllTrim(oObj:OWSELEGIBILIDADERESULT:CPLANO)+"|"+;
				DToC(oObj:OWSELEGIBILIDADERESULT:DVALCAR)+"|"+;
				oObj:OWSELEGIBILIDADERESULT:CNUMCARNAC+"|"+;
				AllTrim( Str(oObj:OWSELEGIBILIDADERESULT:NVIACARTAO) )+"|"+;
				oObj:OWSELEGIBILIDADERESULT:CABRANGE+"|"+;
				Substr(Dtos(oObj:OWSELEGIBILIDADERESULT:DDATBLO),7,2)+"/"+;
				Substr(Dtos(oObj:OWSELEGIBILIDADERESULT:DDATBLO),5,2)+"/"+;
				Substr(Dtos(oObj:OWSELEGIBILIDADERESULT:DDATBLO),1,4)
				If lPPLEXIS
					cResult += +"|"+(oObj:OWSELEGIBILIDADERESULT:CSTATUSEL)+"|$"
				Else
					cResult += +"|$"
				EndIf
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Criticas															   Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				For nI := 1 To Len(oObj:OWSELEGIBILIDADERESULT:OWSUSERCRITICA:OWSUSERCARDCRI)
				    If !Empty(oObj:OWSELEGIBILIDADERESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)
						cResult += AllTrim(oObj:OWSELEGIBILIDADERESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESPRI)+" - "+AllTrim(oObj:OWSELEGIBILIDADERESULT:OWSUSERCRITICA:OWSUSERCARDCRI[nI]:CDESSEQ)+chr(10)+chr(13)
					EndIf
				Next
Else
    cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina									 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠здддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁPrograma   Ё PPLTROMATЁ Autor Ё Alexander Santos	     Ё Data Ё 2.05.07  Ё╠╠
╠╠цдддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao  Ё Procura matricula antiga caso seja usuario de intercambio  Ё╠╠
╠╠юдддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PPLTROMAT(cMatric)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁVerifica se e usuario de intercambio									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Local cMatAnt := cMatric // para fazer o seek com o matant, pois pode ter traГos e pontos
cMatric := AllTrim(StrTran(StrTran(cMatric,".",""),"-",""))
BA1->( DbSetOrder(2) ) //BA1_FILIAL + BA1_CODINT + BA1_CODEMP + BA1_MATRIC + BA1_TIPREG + BA1_DIGITO
If !BA1->( MsSeek( xFilial("BA1")+cMatric ) )
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁProcura matricula antiga												   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	BA1->( DbSetOrder(5) ) //BA1_FILIAL + BA1_MATANT + BA1_TIPANT
	If BA1->( MsSeek( xFilial("BA1")+cMatAnt ) )
   	   cMatric := BA1->(BA1_CODINT+BA1_CODEMP+BA1_MATRIC+BA1_TIPREG+BA1_DIGITO)
   	ElseIf BA1->( MsSeek( xFilial("BA1")+Right(cMatric,16) ) )
   	   cMatric := BA1->(BA1_CODINT+BA1_CODEMP+BA1_MATRIC+BA1_TIPREG+BA1_DIGITO)
   	Else
   	   cMatric := ""
    EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ёfim da funcao														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cMatric
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠здддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁPrograma   ЁPLSDECODE Ё Autor Ё Alexander Santos	     Ё Data Ё 05.06.07 Ё╠╠
╠╠цдддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao  Ё Codifica caracteres especiais acentuacao				   Ё╠╠
╠╠юдддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PLSDECODE(cString)
Return( WCDecode(cString) )
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCHADOW    Ё Autor Ё Alexander Santos	   Ё Data Ё 05.03.09 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Chama form para download										 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHADOW()
LOCAL cHtml    	:= ""
LOCAL cCaminho 	:= getWebDir()

WEB EXTENDED INIT cHtml START "InSite"

If !Empty(cCaminho)
	cCaminho := cCaminho + getPrtSkin() + "\biometria\"
EndIf

HttpSession->Driver   := File(cCaminho+"Instalacao_Driver.Rar")
HttpSession->Register := File(cCaminho+"RegistrarDll.exe")

cHtml += ExecInPage("PPLDOWDRV")

WEB EXTENDED END

Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCHAMANU  Ё Autor Ё Flavio S. Correa     Ё Data Ё 17.06.2009 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do menu Manuais										 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLCHAMANU()
LOCAL cHtml  	:= ""
LOCAL cDir	 	:= getWebDir()
LOCAL aFiles	:= {}

WEB EXTENDED INIT cHtml START "InSite"

If !Empty(cDir)

	cDir := cDir + getPrtSkin() + "\manuaistiss\"
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁLe diretorio para mostrar os arquivos disponiveis
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	aFiles := DIRECTORY(cDir+"*.*")

	If Len(aFiles) > 0
    	HttpPost->aFiles := aClone(aFiles)
		HttpPost->cDir := cDir
	Else
		Return PPLSALERT( "", "AtenГЦo", "Nenhum arquivo encontrado dentro do Diretorio ManuaisTISS", "" )
	EndIf

Else
	Return PPLSALERT( "", "AtenГЦo", "Nao foi possivel encontrar o Diretorio de ManuaisTISS", "" )
EndIf

cHtml += ExecInPage("PPLSMANUAL")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCHADUVI  Ё Autor Ё Flavio S. Correa     Ё Data Ё 16.06.2009 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do menu Duvidas/Esclarecimentos						 Ё╠╠
╠╠Ё----------Ё---------------------------------------------------------------Ё╠╠
╠╠ЁAlteracao Ё Luciano Aparecido  | restruturado para o padrao				 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLCHADUVI()
LOCAL cHtml  	:= ""
LOCAL oObjLib 	:= Nil
LOCAL cIntPad   := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁAlimenta a intpad													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjLib := WSPLSXFUN():New()
WsChgURL( @oObjLib, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta o metodo												  	       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjLib :PlsIntPad()
cIntPad := oObjLib:cPLSINTPADRESULT
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁBusca contatos na tabela BIM
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjLib:getContato("MSALPHA",cIntPad)

	HttpPost->oContatos := oObjLib:oWSGETCONTATORESULT:oWSCONTATOSTISS

	cHtml += ExecInPage("PPLSDUVIDA")

Else
	Return PPLSALERT( "", "AtenГЦo", "Nao Existe nenhum Contato TISS cadastrado", "" )
EndIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCHAORIE  Ё Autor Ё Flavio S. Correa     Ё Data Ё 17.06.2009 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do menu Orientacoes TISS								 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLCHAORIE()
LOCAL cHtml	:= ""
LOCAL cArq 	:= getWebDir()

WEB EXTENDED INIT cHtml START "InSite"

If !Empty(cArq)

	cArq := cArq + getPrtSkin() + "\orientacoestiss.html"

	If !File(cArq)
		Return PPLSALERT( "", "AtenГЦo", "Nao foi encontrado o arquivo orientacoestiss", "" )
	Endif

Else
	Return PPLSALERT( "", "AtenГЦo", "Nao foi encontrado o diretorio imagens-pls", "" )
EndIf

cHtml += ExecInPage("PPLSORIENT")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCHAPROD  Ё Autor Ё Totvs			     Ё Data Ё 18.06.2009 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do menu Produtos										 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLCHPROD()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁWS
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁParametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE	:= "MSALPHA"

If oObj:getProdutos()
	HttpSession->aProdutos := oObj:oWSGETPRODUTOSRESULT:oWSPRODUTOSLIST
EndIf

	cHtml += ExecInPage("PPLSPRODUT")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCHAEXML  Ё Autor Ё Flavio S. Correa     Ё Data Ё 22.06.2009 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do menu Envio XML									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLCHAEXML()
LOCAL cHtml  	:= ""
LOCAL oObjLib	:= Nil

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁAlimenta a intpad													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjLib := WSPLSXFUN():New()
WsChgURL( @oObjLib, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta o metodo												  	       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjLib :PlsIntPad()
HttpSession->cIntPad := oObjLib:cPLSINTPADRESULT
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁBusca Links na tabela B0F											   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjLib:GetLinks("MSALPHA",HttpSession->cIntPad,"2")

	HttpPost->oLinks := oObjLib:oWSGETLINKSRESULT:oWSLINKSLIST

	cHtml += ExecInPage("PPLSENVXML")

Else
	Return PPLSALERT( "", "AtenГЦo", "Nenhum Link encontrado para Download/Upload", "" )
EndIf

WEB EXTENDED END

Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCHAWBSE  Ё Autor Ё Flavio S. Correa     Ё Data Ё 22.06.2009 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do menu Webservice									 Ё╠╠
╠╠Ё----------Ё---------------------------------------------------------------Ё╠╠
╠╠ЁAlteracao Ё Luciano Aparecido  | restruturado para o padrao				 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLCHAWBSE()
LOCAL cHtml  	:= ""
LOCAL oObjLib	:= Nil

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁAlimenta a intpad													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjLib := WSPLSXFUN():New()
WsChgURL( @oObjLib, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta o metodo												  	       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjLib :PlsIntPad()
HttpSession->cIntPad := oObjLib:cPLSINTPADRESULT

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁBusca Links na tabela B0F
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjLib:getLinks("MSALPHA",HttpSession->cIntPad,"1")

	HttpPost->oLinks := oObjLib:oWSGETLINKSRESULT:oWSLINKSLIST

	cHtml += ExecInPage("PPLSWEBSER")

Else
	Return PPLSALERT( "", "AtenГЦo", "Nenhuma WebService encontrada", "" )
EndIf

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSMONESP Ё Autor Ё Patricia Duca Aguiar   Data Ё 13.11.2009 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Monta matriz de todos os conselho bah						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSMONESP()
LOCAL nI
LOCAL oObj
LOCAL cResult  	:= "true|"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё oBJ																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSMCTMD():New()
WsChgURL( @oObj, "PLSMCTMD.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE 			:= "MSALPHA"
oObj:OWSESPEC:cRda  	:= HttpGet->cRda
oObj:OWSESPEC:cCodLoc  	:= HttpGet->cCodLoc
oObj:OWSESPEC:cTp  		:= HttpGet->cTp
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Executa metodo para pegar os conselhos								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:getSigEsp()
	For nI:=1 To Len(oObj:oWSGETSIGESPRESULT:oWSGenericStruct)
		cResult +=	oObj:oWSGETSIGESPRESULT:oWSGenericStruct[nI]:cCode+"$"+;
					oObj:oWSGETSIGESPRESULT:oWSGenericStruct[nI]:cDescription+"|"
	Next
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCHAIMP   Ё Autor Ё Totvs                Ё Data Ё 20.02.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do processamento de arquivo xml						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHAIMP()
LOCAL cHtml := ""
LOCAL nI    := 0
LOCAL oObj 	:= NIL
LOCAL oObjLib := NIL
LOCAL nLen		:= IIf(Valtype(HttpSession->RDAVIEW) == "A", Len(HttpSession->RDAVIEW), 0 )
PRIVATE cInterPag := ""
PRIVATE cValParam := "1"

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Pega o parametro													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSCFGDICTIONARY():New()
WsChgURL( @oObj, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cMVPARAM	:= "MV_PLCALPG"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GETPARAM()
	cValParam := IiF( Empty(oObj:cGETPARAMRESULT),"1",alltrim(oObj:cGETPARAMRESULT))
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAIMP.APW" )
EndIf

If cValParam == "2"
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁAlimenta a intpad
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	oObjLib := WSPLSXFUN():New()
	WsChgURL( @oObjLib, "PLSXFUN.APW" )
	oObjLib:cUSERCODE	:= "MSALPHA"
	oObjLib:cRDACode := ""
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё RDA(s)														   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if nLen > 0
		for nI := 1 to nLen
			oObjLib:cRDACode	+= HttpSession->RDAVIEW[nI]:cCode + "|"
		next nI

		if right(oObjLib:cRDACode, 1) == "|" //tiro o ; final
			oObjLib:cRDACode := left(oObjLib:cRDACode, (len(oObjLib:cRDACode)-1))
		endif
	else
		Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAIMP.APW" )
	endif
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
   	//ЁBusca Calendario de Pagamento
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If oObjLib:getCalend()
		cInterPag := oObjLib:cGETCALENDRESULT
	Else
		Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAIMP.APW" )
	EndIf
EndIf

cHtml += ExecInPage("PPLCHAIMP")


WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLCHAMNC
Estatistica de parto

@author  PLS TEAM
@version P11
@since   15.10.15
/*/
//-------------------------------------------------------------------
Web Function PPLCHAMNC()
LOCAL cHtml := ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe pagina															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage("PPLCHAMNC")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLRELMOV   Ё Autor Ё Totvs                Ё Data Ё 20.02.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do processamento de arquivo xml						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRELMOV()
LOCAL cHtml 		:= ""
PRIVATE cMVQTDIARQ	:= "0"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe pagina															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"


//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Pega o parametro que indica se os arquivos ficarЦo disponiveis para download e quantos dias  Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSCFGDICTIONARY():New()
WsChgURL( @oObj, "CFGDICTIONARY.APW" )

oObj:cUSERCODE	:= "MSALPHA"
oObj:cMVPARAM	:= "MV_QTDIARQ"

If oObj:GETPARAM()
	cMVQTDIARQ := Iif(oObj:cGETPARAMRESULT == '.F.','0',oObj:cGETPARAMRESULT)
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage("PPLRELMOV")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLMOSIMP   Ё Autor Ё Totvs                Ё Data Ё 20.02.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Mostra lista de arquivos XML	para importacao					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLMOSIMP()
LOCAL cHtml := "true|"
LOCAL oObj 	:= NIL

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Verifica se a variavel ja esta definida								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If type('HttpSession->RDAVIEW') == 'U' .and. type('HttpSession->USR_INFO') <> 'U'
	HttpSession->RDAVIEW := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFRDA:OWSRDAVIEW //Prestador

Endif
If ValType(HttpGet->cPagina) != 'U'
	HttpSession->nPagUp := Val(HttpGet->cPagina)
Else
	HttpSession->nPagUp  := 1
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Pega o parametro													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSCFGDICTIONARY():New()
WsChgURL( @oObj, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cMVPARAM	:= "MV_LOGSCHE"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GETPARAM()
	HttpSession->MV_LOGSCHE := Iif(oObj:cGETPARAMRESULT == '.F.','1',oObj:cGETPARAMRESULT)
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta o metodo												  	       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:PlsIntPad()
HttpSession->cIntPad := oObj:cPLSINTPADRESULT
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁQuantidade de registros por pagina									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode		:= "MSALPHA"
oObj:nPaginaIni 	:= HttpSession->nPagUp
oObj:nRegPagina 	:= 10
oObj:cRDACode 		:= HttpGet->cRda
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe lista de arquivos 												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->aFileList 	:= {}
HttpSession->nTPagUp 	:= 1

If oObj:getFList()
	HttpSession->aFileList := oObj:oWSGetFListRESULT:oWSARQUIVOSLIST
	HttpSession->nTPagUp   := HttpSession->aFileList[1]:nQtdPag
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe pagina															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpSession->cRetChImp) == 'U' // foi necessАrio guardar o resultado porque a pagina faz duas requisiГУes seguidas perdendo o valor do metodo
	cHtml := "true| |"
Else
	cHtml := "true|" + HttpSession->cRetChImp + "|"
EndIf

HttpSetPart(.F.)

cHtml += ExecInPage("PPLMOSIMP")

HttpSetPart(.T.)

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cHtml)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLPROARQ    Ё Autor Ё Totvs				   Ё Data Ё 20.02.11 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Processa arquivo (importacao xml)							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROARQ()
LOCAL cResult := "true|"
LOCAL cDirArq := ""
LOCAL lProc	  := .F.
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Val(HttpGet->cLinArray) > 0 .And. Len(HttpSession->aFileList) > 0 .And. Len(HttpSession->aFileList) >= Val(HttpGet->cLinArray)
	cDirArq := HttpSession->aFileList[Val(HttpGet->cLinArray)]:cArquivoIN
	lProc   := HttpSession->aFileList[Val(HttpGet->cLinArray)]:cStatus == '0'
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS									  					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		:= "MSALPHA"
oObj:cUserPlsName 	:= getNameUsr()
oObj:cDirArqIn 		:= cDirArq
oObj:cRDACode 		:= Httpget->cRda
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If lProc
	If oObj:ProcUpXml()
		cResult := oObj:CPROCUPXMLRESULT
	Else
	    cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
	EndIf
Else
	cResult := "false|Este arquivo jА foi processado"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina									 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLIAARQ     Ё Autor Ё Totvs				   Ё Data Ё 20.02.11 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Inclui ou altera arquivo XML									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLIAARQ()
LOCAL cResult := ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

If ValType(HttpPost->cRda) == 'U'
	HttpPost->cRda := ""
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS									  					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		:= "MSALPHA"
oObj:cUserPlsName 	:= getNameUsr()
oObj:cDirArqIn 		:= strtran(HttpPost->cDirArq,'/\','\')
oObj:cRDACode 		:= substr(HttpPost->cRda,1,6)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:IncXmlUp()
	cResult := oObj:cINCXMLUPRESULT
Else
	cResult := StrTran(PWSGetWSError( "" ),":","")
EndIf
HttpSession->cRetChImp := cResult

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina									 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLATUPRO  Ё Autor Ё Alexander Santos     Ё Data Ё 11.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna informaГЦo do prof com base na pesquisa				 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLATUPRO()
LOCAL cResult 	:=  "true|"
LOCAL nI		:= 0
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё obj
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE	:= "MSALPHA"
oObj:cRdaCode	:= HttpGet->cRda
oObj:cCodLoc	:= HttpGet->cCodLoc
oObj:cBusca		:= HttpGet->cBusca
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Lista de profissional de saude
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:ProfSaud()
	HttpSession->PROSAUD := oObj:oWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁMonta retorno para o combo
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
For nI:=1 To Len(HttpSession->PROSAUD)
	cResult += HttpSession->PROSAUD[nI]:cCODE + "%" + AllTrim(HttpSession->PROSAUD[nI]:cNAME) + "|"
Next

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSMONSOL Ё Autor Ё Totvs 				 | Data Ё 24.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Monta box de Solicitantes									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSMONALL()
LOCAL nI		:= 0
LOCAL cResult  	:= "true|"
LOCAL oObj		:= NIL
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUSERCODE:= "MSALPHA"
oObj:cBusca  := HttpGet->cBusca
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Lista de profissional de saude										   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->PROSAUD := {}
If oObj:ProfSAll()
	HttpSession->PROSAUD := oObj:oWSPROFSALLRESULT:OWSLISTPROFSAUD:oWSPROFSAUD

	For nI:=1 To Len(HttpSession->PROSAUD)
		cResult +=	HttpSession->PROSAUD[nI]:cCode+"$"+;
					HttpSession->PROSAUD[nI]:cName+"|"
	Next
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSMONSOL Ё Autor Ё Totvs 				 | Data Ё 24.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Monta box de Solicitantes									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSMONSOL()
LOCAL nI		:= 0
LOCAL cResult  	:= "true|"
LOCAL oObj		:= NIL
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUSERCODE:= "MSALPHA"
oObj:cRdaCode := HttpGet->cRda
oObj:cCodLoc  := HttpGet->cCodLoc
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Lista de profissional de saude										   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->PROSAUD := {}
If oObj:ProfSaud()
	HttpSession->PROSAUD := oObj:oWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD

	cResult +=	"''"+"$"+"-- Selecione um Solicitante --"+"|"

	For nI:=1 To Len(HttpSession->PROSAUD)
		cResult +=	HttpSession->PROSAUD[nI]:cCode+"$"+;
					HttpSession->PROSAUD[nI]:cName+"|"
	Next
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHACPR  Ё Autor Ё Alexander Santos     Ё Data Ё 26.01.2012 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario de perda e roubo							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHACPR()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁObj
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametro
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE 	:= "MSALPHA"
oObj:nTp		:= 3
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё ComboBox da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If ValType(HttpSession->aMotCar) == 'U'
	If oObj:getCombo()
		HttpSession->aMotCar := oObj:oWSGETCOMBORESULT:oWSCbMotCar:oWSGenericStruct
	EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHACPR")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHABOL  Ё Autor Ё Alexander Santos     Ё Data Ё 26.01.2012 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario de boleto									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHABOL()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Contratos
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If ValType(HttpSession->aContrato) == 'U'
	HttpSession->aContrato := PLRETOECS(HttpSession->OPEVIEW,'C')
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHABOL")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHAMIR  Ё Autor Ё Alexander Santos     Ё Data Ё 26.01.2012 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario de IR										 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHAMIR()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHAMIR")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHASIN  Ё Autor Ё Alexander Santos     Ё Data Ё 26.01.2012 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario de Sinistralidade							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHASIN()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHASIN")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHAUTL  Ё Autor Ё Alexander Santos     Ё Data Ё 26.01.2012 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario de extrato de utilizacao					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLCHAUTL()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHAUTL")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHDPM   Ё Autor Ё Totvs                Ё Data Ё 15.01.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario demonstrativo de pagamento medico			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLCHDPM()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHDPM")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHEPM   Ё Autor Ё Totvs                Ё Data Ё 15.01.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario extrato de pagamento medico    			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLCHEPM()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHEPM")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHDAC   Ё Autor Ё Totvs                Ё Data Ё 15.01.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario demonstrativo de analise conta medica		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLCHDAC()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHDAC")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHDPO	  Ё Autor Ё Totvs                Ё Data Ё 15.01.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario demonstrativo de pagamento odontologico	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLCHDPO()
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHDPO")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHAPTC  Ё Autor Ё Alexander Santos     Ё Data Ё 26.12.2012 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama o formulario de geracao de protocolo					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHAPTC()
LOCAL cHtml := ""
local nI
LOCAL oObjPar 	:= NIL
LOCAL oObjLib := NIL
LOCAL nLen		:= IIf(Valtype(HttpSession->RDAVIEW) == "A", Len(HttpSession->RDAVIEW), 0 )

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁParametro
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if valType(HttpSession->lMosGui) == 'U'

	httpSession->lMosGui := .t.

	oObj := WSCFGDICTIONARY():new()
	wsChgURL( @oObj, "CFGDICTIONARY.APW" )
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё parametro para verificar se exibe as guias ou nao
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj:cUSERCODE:= "MSALPHA"
	oObj:cMVPARAM := "MV_PLSEGU"
	if oObj:GETPARAM()
		httpSession->lMosGui := iIf( allTrim(oObj:cGETPARAMRESULT)=="1",.t.,.f. )
	endIf
endIf

//Pego local de DigitaГЦo off-line
oObj := WSCFGDICTIONARY():new()
wsChgURL( @oObj, "CFGDICTIONARY.APW" ) 
oObj:cUSERCODE:= "MSALPHA"
oObj:cMVPARAM	:= "MV_PLSDIGP"
If oObj:GETPARAM()
	httpSession->cCodOff := oObj:cGETPARAMRESULT
ENDIF

oObjPar := WSCFGDICTIONARY():New()
WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PLCALPG"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjPar:GETPARAM()
	cValParam := IiF( Empty(oObjPar:cGETPARAMRESULT),"1",alltrim(oObjPar:cGETPARAMRESULT))
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLDIGGUIP.APW" )
EndIf

oObjLib := WSPLSXFUN():New()
WsChgURL( @oObjLib, "PLSXFUN.APW" )
oObjLib:cUSERCODE	:= "MSALPHA"
oObjLib:cRDACode := ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё RDA(s)														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
if nLen > 0
	for nI := 1 to nLen
		oObjLib:cRDACode	+= HttpSession->RDAVIEW[nI]:cCode + "|"
	next nI

	if right(oObjLib:cRDACode, 1) == "|" //tiro o ; final
		oObjLib:cRDACode := left(oObjLib:cRDACode, (len(oObjLib:cRDACode)-1))
	endif
else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAIMP.APW" )
endif
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁBusca Calendario de Pagamento
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjLib:getCalend()
	cInterPag := oObjLib:cGETCALENDRESULT
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAIMP.APW" )
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁObj
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametro
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE 	:= "MSALPHA"
oObj:nTp		:= 1
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё ComboBox da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if oObj:getCombo()
	httpSession->aTipGui := oObj:oWSGETCOMBORESULT:oWSCbTipGui:oWSGenericStruct
else
	return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAPTC.APW" )
endIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCHAPTC")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммямммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁPPLRELGEN ╨Autor  ЁTotvs				  ╨ Data Ё  16.03.2012 ╨╠╠
╠╠лммммммммммьммммммммммймммммммомммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     Ё Relatorios 											   	   ╨╠╠
╠╠хммммммммммоммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
*/
Web Function PPLRELGEN()
LOCAL oObj	:= NIL
LOCAL cHtml := ""
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁWeb Function
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁWS
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSRELT():New()
WsChgURL( @oObj, "PLSRELT.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁParametros
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode 	:= "MSALPHA"
oObj:cFunName  	:= HttpGet->cFunName
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁParametros conforme rotina
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Do Case
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁBoleto
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELBOL'
		oObj:oWSINPAR:nRecno := Val( StrTran( strTran(HttpGet->cRecno, ".", ""), ",", ""))
		oObj:oWSINPAR:cAlias := 'SE1'
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁExtrato de utilizacao
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELULT'
		oObj:oWSINPAR:cMatric	:= HttpGet->Field_MATUSU
		oObj:oWSINPAR:dDtDe		:= CToD(HttpGet->Field_DTDE)
		oObj:oWSINPAR:dDtAte	:= CToD(HttpGet->Field_DTATE)
	//Carteirinha beneficiario
	Case HttpGet->cFunName == 'PPLSRECB'
		oObj:oWSINPAR:cMatric := HttpGet->Field_MATUSU
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁDemonstrativo de I.R
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELIR'
		oObj:oWSINPAR:cMatric	:= HttpGet->Field_MATUSU
		oObj:oWSINPAR:cCodEmp	:= HttpGet->Field_CODEMP
		oObj:oWSINPAR:cAno		:= HttpGet->Field_ANO
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁSinistralidade
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELSIN'
		oObj:oWSINPAR:cMatric	:= HttpGet->Field_MATUSU
		oObj:oWSINPAR:cAno		:= HttpGet->Field_ANO
		oObj:oWSINPAR:cMes		:= HttpGet->Field_MES
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁMovimentacao
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELBEN'
		oObj:oWSINPAR:cNumCon	:= HttpGet->Field_NUMCON
		oObj:oWSINPAR:cSubCon	:= HttpGet->Field_SUBCON
		oObj:oWSINPAR:dDtDe		:= CToD(HttpGet->Field_DTDE)
		oObj:oWSINPAR:dDtAte	:= CToD(HttpGet->Field_DTATE)
		oObj:oWSINPAR:cSituac	:= HttpGet->Field_SITCAD
		oObj:oWSINPAR:cTipo		:= HttpGet->Field_TIPO
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁXML
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELXML'
		oObj:oWSINPAR:cXmlFile	:= HttpGet->Field_FName
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁGuia SADT PDF
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELST'
		oObj:oWSINPAR:cNumAut := HttpGet->Field_NUMAUT
		oObj:oWSINPAR:cProrrog := HttpGet->lProrrog

		If !PPLVGUTIS() 	// Verifica se imprime Guia Tiss padrЦo ANS.
	   		If HttpGet->cReimpr == "1"
				W_PPLSMATREI() 	// Imprime Guia Antiga
			Else
		   		W_PPLIMPGUIA()
       		EndIf
			Return cHtml
		EndIf
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁGuia Recurso de GLOSA PDF
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELRG'
		oObj:oWSINPAR:nRecno := val(HttpGet->cRecno)
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Relatorio de Solicitacao de Cancelamento de Planos
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    Case HttpGet->cFunName == 'PP99BSOL'	
		oObj:oWSINPAR:nRecno := val(HttpGet->cRecno)
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Relatorio de Confirmacao de Cancelamento de Plano
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
    Case HttpGet->cFunName == 'PP99BCON'	
		oObj:oWSINPAR:nRecno := val(HttpGet->cRecno)
		
	Case HttpGet->cFunName == 'PPRELUPD'
		oObj:oWSINPAR:cRda := HttpGet->Field_RDA
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁPEG - protoolo eletronico de guias
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELPEG'
 		oObj:oWSINPAR:cXmlFile	:= HttpGet->Field_FName
 		oObj:oWSINPAR:nRecno	:= If(ValType(HttpGet->cRecno)=="C",Val( StrTran( StrTran(HttpGet->cRecno, ",", ""), ".", "")),nil)
 	Case HttpGet->cFunName == 'PPRELPROT'
 		oObj:oWSINPAR:cProtocolo	:= HttpGet->cProtocolo
 		oObj:oWSINPAR:nRecno	:= If(ValType(HttpGet->cRecno)=="C",Val( StrTran( StrTran(HttpGet->cRecno, ",", ""), ".", "")),nil)
	Case HttpGet->cFunName == 'PLSRCRIT'
		oObj:oWSINPAR:cSequen	:= HttpGet->Field_SEQUEN

	Case HttpGet->cFunName == 'PPLEXE754'
		oObj:oWSINPAR:cTipo	 := HttpGet->Field_CTIPO
		oObj:oWSINPAR:ddtAte := cTod(HttpGet->Field_DTATE)
		oObj:oWSINPAR:ddtDe	 := cTod(HttpGet->Field_DTDE)
		oObj:oWSINPAR:cRda	 := HttpGet->Field_CODRDA
		oObj:oWSINPAR:cGuia	 := HttpGet->Field_CGUIA
		oObj:oWSINPAR:cTp	 := HttpGet->Field_CLIBERA
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁDemonstrativo de pagamento medico
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELDPM' .or. HttpGet->cFunName == 'PPRELDAC' .or. HttpGet->cFunName == 'PPRELDPO'.or. HttpGet->cFunName == 'PPRELEPM'
		oObj:oWSINPAR:cRda	:= HttpGet->Field_CODRDA
		oObj:oWSINPAR:cAno	:= HttpGet->Field_ANO
		oObj:oWSINPAR:cMes	:= HttpGet->Field_MES
	Case HttpGet->cFunName == 'PPRELDOC'
		oObj:oWSINPAR:nRecno	:= Val(HttpGet->cRecno)
 		oObj:oWSINPAR:cAlias := 'B2H'
 	Case HttpGet->cFunName == 'PLSQUIT'
 		oObj:oWSINPAR:cTipo 		:= "1"
 		oObj:oWSINPAR:cCodEmp	:= Right(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:CCODE, 4)
 		oObj:oWSINPAR:cNumCon	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:CNUMCON
 		oObj:oWSINPAR:cSubCon	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:CSUBCON
		oObj:oWSINPAR:cMatric	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CFAMILIA
		oObj:oWSINPAR:cAno		:= IIF( ValType(HttpGet->Field_Data) == "C", HttpGet->Field_Data, "")
	Case HttpGet->cFunName == 'PLSIMPBEN'
		oObj:oWSINPAR:nRecno	:= Val(HttpGet->cRecno)
 		oObj:oWSINPAR:cAlias := 'BBA'
 	case HttpGet->cFunName == 'PPRELRCT'
 		oObj:oWSINPAR:cProtocolo := HttpGet->cProtocolo
	//Estatistica de Partos
	Case HttpGet->cFunName == 'PPLSREPA'
		oObj:oWSINPAR:cOperac	:= HttpGet->Field_CODOPE
		oObj:oWSINPAR:cRdaHos	:= HttpGet->Field_RDAHOS
		oObj:oWSINPAR:cRdaMed	:= HttpGet->Field_RDAMED
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁReembolso AnalМtico
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELRBANL'
		oObj:oWSINPAR:cMatric	:= HttpGet->Field_MATUSU
		oObj:oWSINPAR:dDtDe		:= CToD(HttpGet->Field_DTDE)
		oObj:oWSINPAR:dDtAte	:= CToD(HttpGet->Field_DTATE)
		oObj:oWSINPAR:dDtDeO	:= CToD(HttpGet->Field_DTDEP)
		oObj:oWSINPAR:dDtAteO	:= CToD(HttpGet->Field_DTATEP)
		oObj:oWSINPAR:cChaveGen	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CCODE
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁExtrato de Reajuste
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'R510WEB'
		oObj:oWSINPAR:cMatric	:= HttpGet->Field_MATUSU
		oObj:oWSINPAR:dDtDe		:= cToD('01/01/' + HttpGet->Field_ANO)
		oObj:oWSINPAR:dDtAte	:= cToD('31/12/' + HttpGet->Field_ANO)
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁExtrato de utilizaГЦo BeneficiАrio - Co-participaГЦo
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPRELEXTUTI'
		oObj:oWSINPAR:cMatric	:= HttpGet->Field_MATUSU
		oObj:oWSINPAR:cMes		:= HttpGet->Field_DTDESCI //irА receber mes e ano inicial desconto
		oObj:oWSINPAR:cAno		:= HttpGet->Field_DTDESCF  // irА receber mes e ano final desconto
		oObj:oWSINPAR:dDtDe		:= CToD(HttpGet->Field_DTDEP)
		oObj:oWSINPAR:dDtAte	:= CToD(HttpGet->Field_DTATEP)
		oObj:oWSINPAR:cChaveGen	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CCODE
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁExtrato Financeiro
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	Case HttpGet->cFunName == 'PPREEFINA' //19-01
		oObj:oWSINPAR:dDtDe		:= CTOD("01/"+HttpGet->cDatIni)
		oObj:oWSINPAR:dDtAte	:= CTOD("01/"+HttpGet->cDatFin)
		oObj:oWSINPAR:cMatric 	:= IF(!EMPTY(HttpGet->cMatric), HttpGet->cMatric, HttpGet->cMatTitular)
		oObj:oWSINPAR:cTipo   	:= HttpGet->cTipoDesp
		oObj:oWSINPAR:cTp   	:= HttpGet->cTipoProd


	//ImpressЦo de guias TISS em branco
	Case HttpGet->cFunName == 'PPRELGUI'
 		oObj:oWSINPAR:cTipo := HttpGet->cTipGui
 		oObj:oWSINPAR:nRecno	 := VAL(HttpGet->cQtdGui)

EndCase
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁExecuta metodo
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
HttpSession->cFileName := ""

If oObj:getRelGEN() //Nessa chamada o array ja esta vazio
	HttpSession->cFileName := oObj:cGETRELGENRESULT
EndIf
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁExibe boleto
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLRELGEN")

WEB EXTENDED END
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLGETCID  Ё Autor Ё Totvs				 Ё Data Ё 11.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna Cidades do Estado									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETCID()
LOCAL cResult 	:= "true|"
LOCAL nI		:= 0
LOCAL aRet		:= {}
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁObj
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametro
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode 	:= "MSALPHA"
oObj:nTp		:= 4
oObj:cAlias		:= "BID"
oObj:cRetorno	:= "BID->BID_CODMUN,BID->BID_DESCRI"
oObj:nIdx		:= 3 //BID_FILIAL + BID_EST + BID_DESCRI
oObj:cChave		:= HttpGet->Field_ESTADO
oObj:cCmdChave	:= "BID_EST"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Alimenta as variaves com o x3-combobox
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:getCombo()

	aRet := oObj:oWSGETCOMBORESULT:oWSCbGeneric:oWSGenericStruct
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Monta combo
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If Len(aRet) > 0
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		//ЁMonta retorno para o combo
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		For nI:=1 To Len(aRet)
			cResult += aRet[nI]:cCode + "$" + aRet[nI]:cDescription + "|"
		Next
		cResult := Left(cResult,Len(cResult)-1)
	EndIf
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLGETSUB  Ё Autor Ё Totvs				 Ё Data Ё 11.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna subcontratos de um contrato							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETSUB()
LOCAL cResult 	:= "true|"
LOCAL nI		:= 0
LOCAL aRet		:= {}
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Lista Cidade
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
aRet := PLRETOECS(HttpSession->OPEVIEW,'S',HttpGet->Field_NUMCON)

If Len(aRet) > 0
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁRetorna a operadora
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	cResult += WCGetIntPad() + "%"
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁMonta retorno para o combo
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	For nI:=1 To Len(aRet)
		cResult += aRet[nI]:cCode + "$" + If(Empty(aRet[nI]:cNomSub),aRet[nI]:cDescription,aRet[nI]:cNomSub) + "|"
	Next
	cResult := Left(cResult,Len(cResult)-1)
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLGATCMP  Ё Autor Ё Totvs				 Ё Data Ё 11.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Gatilho de campos											 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGATCMP()
LOCAL cResult 	:= "true|"
LOCAL oObj		:= NIL
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml  //Aqui nЦo tem o insite pq И utilizada no layout generico onde nЦo tem login

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁObj
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametro
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode		:= "MSALPHA"
oObj:cUserPlsCode	:= getUsrWeb()
oObj:nTpPor			:= getTpPortal()
oObj:cFunName		:= HttpGet->cFunName
oObj:cChave			:= HttpGet->cChave
oObj:cVldGen		:= HttpGet->cVldGen
oObj:nTp			:= Val(HttpGet->nTpRet)
If valtype(HttpSession->cTp) <> "U"
	oObj:cTipGui := STRZERO(val(HttpSession->cTp),2)
Else
	oObj:cTipGui := "01"
Endif
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁExecuta metodo para montar Header
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:getGAT()
	cResult := 'true|' + oObj:cGETGATRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLPROBEN  Ё Autor Ё Totvs				 Ё Data Ё 11.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Post do formulario para gravacao								 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROBEN()
LOCAL cResult 	:= "true|"
LOCAL oObj		:= NIL
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁObj
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXINC():New()
WsChgURL( @oObj, "PLSXINC.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ёparametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁMonta envio de fields
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
WCArrPost(@oObj:oWSINCBENEFIC:oWSDADBENEFIC)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁExecuta metodo para montar Header
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:setBenefic()
	cResult := "true|" + oObj:cSETBENEFICRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSETCAR  Ё Autor Ё Totvs				 Ё Data Ё 11.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Set solicitacao de carteirinha								 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSETCAR()
LOCAL cResult 	:= "true|"
LOCAL oObj		:= NIL
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁObj
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametro
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE 	:= "MSALPHA"
oObj:cMatUsu	:= HttpGet->Field_MATUSU
oObj:cMotCar	:= HttpGet->Field_MOTCAR
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁExecuta metodo para montar Header
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:setSolCar()
	cResult := "true|" + oObj:cSETSOLCARRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁFim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLGETDGRI Ё Autor Ё Totvs 				 | Data Ё 24.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna dados para o browse gridData							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETDGRI()
LOCAL cResult  	:= "true|"
LOCAL cRdas		:= ""
LOCAL oObj		:= NIL

LOCAL nI		:= 0
LOCAL nLen		:= IIf(Valtype(HttpSession->RDAVIEW) == "A", Len(HttpSession->RDAVIEW), 0 ) //Tratamento para a existencia das RDAs (a funГЦo eh chamada antes do login para consulta rede credenciada)
LOCAL cHtml 	:= ""

// RemoГЦo do InSite pois o guia medico nЦo esta conectado
WEB EXTENDED INIT cHtml 
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Metodo e propriedades
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//HttpSession->RDAVIEW
For nI := 1 to nLen
	If ! Empty(cRdas)
		cRdas += ","
	EndIf
	cRdas += "'" + HttpSession->RDAVIEW[nI]:cCodOpe + HttpSession->RDAVIEW[nI]:cCode +"'"
Next nI
//Tratamento para a existencia das RDAs (a funГЦo eh chamada antes do login para consulta rede credenciada)
If nLen > 0
	httpGet->cWhere += "|"+"Field_RDA=" + cRdas
EndIf

oObj:cUserCode	:= "MSALPHA"
oObj:cFunName	:= httpGet->cFunName
oObj:cWhere 	:= httpGet->cWhere
oObj:cBuscaTReg	:= httpGet->cBuscaTReg
oObj:cPesquisa	:= iIf(valType(httpGet->cPesquisa)=='U',"",httpGet->cPesquisa)
oObj:cSemaforo	:= iIf(valType(httpGet->cSemaforo)=='U',"",httpGet->cSemaforo)
oObj:nPaginaIni	:= val(httpGet->nPagina)

If ! Empty(httpGet->cRecnoAtu)

	cRecnoChaPtc := httpGet->cRecnoAtu

	If cRecnoChaPtc <> "undefined" .AND. cRecnoChaPtc > '0'
	    HttpSession->RECNOCHAPTC := cRecnoChaPtc
	ElseIf cRecnoChaPtc <> "undefined" .AND. cRecnoChaPtc == '0'
		oObj:cWhere := +"Field_RECNO=" + HttpSession->RECNOCHAPTC
	EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Lista de faturas
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:getDadGrid()
	cResult +=	oObj:cGETDADGRIDRESULT
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
return PLSDECODE(cResult)
/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Funcao    ЁPPSAphGuia╨Autor  Ё Paulo Sampaio      ╨ Data Ё 18/06/2012  ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     Ё P.E. que altera a funcao que monta a ExecPage na funcao    ╨╠╠
╠╠╨          ЁPPLSMATREI - Impressao da Guia de Atendimento.              ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё S-Case Tecnologia.                                         ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
*/
Function PPSAphGuia(cTipoGuia)
LOCAL cPageExec := "PPLIMPGUIA"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁTipo de Guia
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Do Case
   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
   //Ё Verifica se irА imprimir guia Tiss padrЦo ANS									 Ё
   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
   Case !PPLVGUTIS() // NЦo imprime Guia Tiss padrЦo ANS.
		cPageExec := "PPLIMPGUIA"
   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
   //Ё Consulta																			 Ё
   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
   Case cTipoGuia == '1'
		cPageExec := "PPLSCONS" // "PPLGUICON" // 'Consulta - ExecuГЦo'
   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
   //Ё Sadt
   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
   Case cTipoGuia == '2'
		cPageExec := "PPLSSADT" // "PPLGUISADT" // 'Sadt'
   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
   //Ё Internacao
   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
   Case cTipoGuia == '3'
		cPageExec := "PPLSSOIN" // "PPLGUIINTE" // 'Inter./Prorrog. - Solic./Exec.'
   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
   //Ё Odontologico
   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
   Case cTipoGuia == '4'
		cPageExec := "PPLSGTOP" //"PPLGUIODON" // OdontolСgico
   //зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
   //Ё Honorario Individual
   //юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
   Case	cTipoGuia == '5'
		cPageExec := "PPLSHOIN"

EndCase

WEB EXTENDED END
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return(cPageExec)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLPROARQ    Ё Autor Ё Totvs				   Ё Data Ё 20.02.11 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Processa arquivo (importacao xml)							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEXCARQ()
LOCAL cResult := "true|"
LOCAL cDirArq := ""
LOCAL lProc	  := .F.
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Val(HttpGet->cLinArray) > 0 .And. Len(HttpSession->aFileList) > 0 .And. Len(HttpSession->aFileList) >= Val(HttpGet->cLinArray)
	cDirArq := HttpSession->aFileList[Val(HttpGet->cLinArray)]:cArquivoIN
	lProc   := (HttpSession->aFileList[Val(HttpGet->cLinArray)]:cStatus $ '2')
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS									  					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		:= "MSALPHA"
oObj:cUserPlsName 	:= getNameUsr()
oObj:cDirArqIn 		:= cDirArq
oObj:cRDACode 		:= Httpget->cRda
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Metodo																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If lProc
	If oObj:ProcDeXml()
		cResult := oObj:CPROCDEXMLRESULT
	Else
	    cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
	EndIf
Else
	cResult := "false|Somente podem ser excluidos arquivos nao acatados."
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina									 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLVALPEG  Ё Autor Ё Totvs 				 | Data Ё 24.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Valida Guias antes da PEG		 			        		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLVALPEG()
LOCAL cResult  	:= ""
LOCAL oObj		:= nil
//D - DigitaГЦo Offline   P - Protocolo
Local cTipo		:= IIf(Valtype(HttpGet->cTipo) == "U", "D", HttpGet->cTipo)
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Metodo e propriedades
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():new()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ёparametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode				:= "MSALPHA"

oObj:cChave		:= httpGet->cInfPegGui
oObj:cTipo 		:= cTipo
oObj:cTipGui	:= httpGet->cTipGuia

if oObj:verDtGuia()
	cResult :=	oObj:cVERDTGUIARESULT
else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
endIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSETPEG  Ё Autor Ё Totvs 				 | Data Ё 24.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Gera peg de guias		 									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLSETPEG()
LOCAL cResult  	:= ""
LOCAL oObj		:= nil
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Guarda na sessao caso sai da pagina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
httpSession->cInProcRda := httpGet->cInProcRda
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Metodo e propriedades
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if valType(HttpSession->lMosGui) == 'U'

	httpSession->lMosGui := .t.

	oObj := WSCFGDICTIONARY():new()
	wsChgURL( @oObj, "CFGDICTIONARY.APW" )
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё parametro para verificar se exibe as guias ou nao
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj:cUSERCODE:= "MSALPHA"
	oObj:cMVPARAM := "MV_PLSEGU"
	if oObj:GETPARAM()
		httpSession->lMosGui := iIf( allTrim(oObj:cGETPARAMRESULT)=="1",.t.,.f. )
	endIf
endIf
oObj := WSPLSXFUN():new()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ёparametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode				:= "MSALPHA"
oObj:oWSMatPeg:cWhere		:= httpGet->cWhere
oObj:oWSMatPeg:cColsCk		:= httpGet->cColCK
oObj:oWSMatPeg:cColsUnCk	:= httpGet->cColUnCK
oObj:oWSMatPeg:cSemaforo	:= httpGet->cSemaforo
oObj:oWSMatPeg:lGerPeg		:= iIf(httpGet->lGerPeg=="true",.t.,.f.)
oObj:oWSMatPeg:lMosGui		:= httpSession->lMosGui
oObj:oWSMatPeg:cfunName		:= IIF(Empty(httpGet->DigMan), "", httpGet->DigMan)  //Informar se И da digitaГЦo off-line de guias
oObj:oWSMatPeg:lgrvVlrApr	:= IIF(Empty(httpGet->lVlrApr), .F., iif( httpGet->lVlrApr == "true", .T., .F.))  //Informar se И da digitaГЦo off-line de guias
oObj:oWSMatPeg:cTipoGuia		:= IIF( Empty(httpGet->cTipoGuia), "",httpGet->cTipoGuia )  //Se И Resumo de InternaГЦo

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё tranferencia de guias para peg definitivo
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if oObj:setTFGuia()
	cResult :=	oObj:cSETTFGUIARESULT
else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
endIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHKIPR  Ё Autor Ё Totvs 				 | Data Ё 24.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica se esta em processado							 	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLCHKIPR()
LOCAL cResult  	:= ""
LOCAL oObj		:= nil
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Metodo e propriedades
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode			 	:= "MSALPHA"
oObj:oWSMatPeg:cSemaforo	:= httpGet->cSemaforo
oObj:oWSMatPeg:cFunJs	 	:= httpGet->cFunJs
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё tranferencia de guias para peg definitivo
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if oObj:getInProces()
	cResult :=	oObj:cGETINPROCESRESULT
else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
endIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHKIPR  Ё Autor Ё Totvs 				 | Data Ё 24.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica se esta em processado							 	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPOSICIONE()
LOCAL cResult := "false|"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Metodo e propriedades
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode		:= "MSALPHA"
oObj:nIdx			:= VAL(HttpGet->Field_INDICE)
oObj:cCmdChave	 	:= HttpGet->Field_CAMPO
oObj:cChave	 		:= HttpGet->Field_CODRDA
oObj:cAlias	 		:= HttpGet->Field_ALIAS

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё tranferencia de guias para peg definitivo
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if oObj:posicione()
	cResult :=	oObj:cPOSICIONERESULT
else
	cResult :=	"false|"+StrTran(PWSGetWSError( "" ),":","")
endif

WEB EXTENDED END

return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHKIPR  Ё Autor Ё Totvs 				 | Data Ё 24.01.2011 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Imprime relatorio e manda por email						 	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
web function PPLIPREE

LOCAL cResult := "false|"
Local cGlosa  := 'N'
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Metodo e propriedades
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

if ValType(HttpGet->cGlosa) <> 'U'
	cGlosa  :=  HttpGet->cGlosa
endif

oObj:cUserCode		:= "MSALPHA"
oObj:cChave			:= HttpGet->Field_CODRDA + "|" + HttpGet->Field_EMAIL + "|" + HttpGet->cRecno + "|" + HttpGet->cTipoRel + "|" + cGlosa + "|"
oObj:cFunName	 	:= HttpGet->cFunRel

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё tranferencia de guias para peg definitivo
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if oObj:ppImpRel()
	cResult :=	oObj:cPPIMPRELRESULT
else
	cResult :=	"false|"+StrTran(PWSGetWSError( "" ),":","")
endif

WEB EXTENDED END

return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠здддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁPrograma   Ё PPLVGUTISЁ Autor Ё TOTVS			     Ё Data Ё 01.02.13 Ё╠╠
╠╠цдддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao  Ё Verifica se irА imprimir guia Tiss padrЦo ANS			   Ё╠╠
╠╠юдддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PPLVGUTIS()

LOCAL lRet := .F.
LOCAL oObjPar
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Pega o parametro													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjPar := WSCFGDICTIONARY():New()
WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_POGTISS"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjPar:GETPARAM()
	lRet := Iif(oObjPar:cGETPARAMRESULT == '.T.',.T.,.F.)
EndIf

If ValType(lRet) <> 'L'
	lRet := .F.
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ёfim da funcao														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return (lRet)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGUIPR 	  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 07.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina de escolha de Guia ou Protocolo (recurso Glosa)Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRECGLO()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml  START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina para entrar com o protocolo/Guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLRECGLO" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLADRECG 	  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina para adicionar Recurso de Glosa               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLADRECG()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁTipo de pre-atendimento se vai pre-atender ou atender (executar)		   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cObsRecG := ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina para entrar com o protocolo/Guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLADDRECG" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLVIRECG 	  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina para visualizar Recurso de Glosa               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLVIRECG()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina para entrar com o protocolo/Guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLVISRECG" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETRECG    Ё Autor Ё Rogerio Tabosa	      Ё Data Ё 18/03/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os dados da guia glosada                              Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETRECG()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLRECGLO():New()
WsChgURL( @oObj, "PLRECGLO.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cRecno		:= HttpGet->cRecno
oObj:cVisDad		:= HttpGet->cTipRet
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GetDadGuiGlo()
	cResult := oObj:cGetDadGuiGloRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLDOCRECG    Ё Autor Ё Rogerio Tabosa	      Ё Data Ё 18/03/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Grava o anexo do Recurso de Glosa                             Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDOCRECG()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLRECGLO():New()
WsChgURL( @oObj, "PLRECGLO.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cRecnoB4D	:= HttpGet->cRecno
oObj:cArq1			:= HttpGet->cUpld1
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:PutRecGloDoc()
	cResult += oObj:cPutRecGloDocRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLDETRECG    Ё Autor Ё Rogerio Tabosa	      Ё Data Ё 18/03/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os dados do recurso de glosa                          Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDETSRECG()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLRECGLO():New()
WsChgURL( @oObj, "PLRECGLO.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cRecnoBVO	:= Alltrim(Str(HttpGet->cRecno))

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GetRecGloEvents()
	cResult += oObj:cGetRecGloEventsRESULT

EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)


Web Function PPLTMPPCT()

local cPacote
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

cPacote := HttpGet->cPacote

HttpSession->cPacote := cPacote

WEB EXTENDED END


return PLSDECODE("true")

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLSERPC 	  Ё Autor Ё Roberto       Ё Data Ё 21.05.2015 		Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o ЁFunГЦo responsАvel por popular a lista de pacotes na liberaГЦo Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSERPC()

LOCAL cHtml   := ""
LOCAL aRetorno := {}
Local cMatric
Local cNumAut
Local cTipo
Local cRDACode
Local cCodLoc
Local cTipoAut
Local nPosRDA
Local cCodEsp
Local cAltCmp	:= ""
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
local aServ := {}
local cPacote := "false|Erro ao buscar dados da liberaГЦo."
local nI
local nP

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

cMatric := HttpSession->aVldCartao[2]


cNumAut := AllTrim(StrTran(StrTran(HttpGet->cNumeAut,".",""),"-",""))

cTipo   := HttpGet->cTp

cRDACode := HttpGet->cRda

cCodLoc := HttpGet->cCodLoc

cTipoAut	:= IiF( ValType(HttpGet->cTpAut) != 'U',HttpGet->cTpAut,"L")

cAltCmp	:= HttpGet->cAltGuia

if !empty(cCodLoc)
	nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == HttpGet->cRda .And. x:cCodLoc == cCodLoc} )
else
	nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == HttpGet->cRda} )
endIf

if nPosRDA > 0 .AND. ValType(HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA) == "A"
	If Len(HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA) > 0
  		cCodEsp := HttpSession->RDAVIEW[nPosRDA]:OWSMESPRDA:OWSESPRDA[1]:cCodEsp
  	EndIf
endif

oObj:cUSERCODE		 := cMatric
oObj:cUSERCARDNUMBER := cMatric
oObj:cNUMAUT		 :=	cNumAut
oObj:cTIPOAUT		 := cTipoAut
oObj:cRDACODE		 := cRDACode
oObj:cCODLOC		 := cCodLoc
oObj:cTIPO			 := cTipo
oObj:cCODESP		 := cCodEsp
oObj:cSETDTINT 		 := ""
oObj:cAltera		 := cAltCmp

aadd(aServ, {"CСdigo", "DescriГЦo", "Pacote"})

If oObj:RetSerPct()

	if Len(oObj:oWSRETSERPCTRESULT:OWSMITEGUI) <> 0

		cPacote := "true|cabecalho@"

		For nI:=1 To Len(oObj:oWSRETSERPCTRESULT:OWSMITEGUI)

			For nP := 1 to len(oObj:oWSRETSERPCTRESULT:OWSMITEGUI[nI]:OWSSPCTITEGUI:OWSMPCTITEGUI)
				cPacote += oObj:oWSRETSERPCTRESULT:OWSMITEGUI[nI]:cCodPro + "|" + oObj:oWSRETSERPCTRESULT:OWSMITEGUI[nI]:cDesPro + "|" + oObj:oWSRETSERPCTRESULT:OWSMITEGUI[nI]:OWSSPCTITEGUI:OWSMPCTITEGUI[nP]:cCodPro + "|" + oObj:oWSRETSERPCTRESULT:OWSMITEGUI[nI]:OWSSPCTITEGUI:OWSMPCTITEGUI[nP]:cDesPro

				if nP <> len(oObj:oWSRETSERPCTRESULT:OWSMITEGUI[nI]:OWSSPCTITEGUI:OWSMPCTITEGUI)
					cPacote += "~"
				endif
			next

			if nI <> Len(oObj:oWSRETSERPCTRESULT:OWSMITEGUI)
				cPacote += "@"
			endif

		next
	else
		cPacote := "true|"
	endif

EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cPacote)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLVIRECG 	  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina para visualizar Recurso de Glosa               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDETRECG()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina para entrar com o protocolo/Guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLDETRECG" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCMPFP   Ё Autor Ё TOTVS S/A            Ё Data Ё 15/08/2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Botao de complemento nos formularios do portal                Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCMPFP()
Local cResult := ""
Local oObj    := Nil
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSCMPFP():New()
WsChgURL( @oObj, "PLSCMPFP.APW" )

oObj:cUserCode := "MSALPHA"
oObj:cFunName  := HttpGet->cFunName
oObj:cRda	   := HttpGet->cRda
oObj:cCodLoc   := HttpGet->cCodLoc
oObj:cTp	   := HttpGet->cTp
oObj:cNumAut   := StrTran(HttpGet->cNumAut,".","")

If oObj:PPLSCMPFP()
	cResult := oObj:CPPLSCMPFPRESULT
Else
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLSHON	  Ё Autor Ё Daher	       Ё Data Ё 12.09.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para buscar o honorario individual	               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSHON()
LOCAL nI      	:= 0
LOCAL oObj	  	:= NIL
LOCAL lExibe  	:= .F.
LOCAL cResult 	:= "true|"
LOCAL nA		:= 0
LOCAL cSelected	:= ""
LOCAL cRetDadUsr:= ""
LOCAL cHtml 	:= ""
LOCAL cCodUsr	:= ""
LOCAL cCodRda	:= ""
LOCAL cTipGui	:= ""
LOCAL cMatric	:= ""
LOCAL cGuiRef	:= ""
LOCAL cDatGui	:= ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		 := "MSALPHA"
oObj:cNumAut   		 := AllTrim(StrTran(StrTran(HttpGet->cNumeAut,".",""),"-",""))
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁA solicitacao deve informar o tipo.									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpSession->aVldCartao) != 'U'
	oObj:cUserCardNumber := HttpSession->aVldCartao[2]
EndIf
 
oObj:cTipo 		 := HttpGet->cTp

if HttpGet->cTp = '11'
	oObj:cRDACode	 := StrTran(PLA09ASES(),"|M",",")//HttpGet->cRda Localiza todas as RDAS que estЦo no login
else
	oObj:cRDACode	 := HttpGet->cRda 
endif
 
oObj:cCodLoc	 := HttpGet->cCodLoc
oObj:cTipoAut	 := IiF( ValType(HttpGet->cTpAut) != 'U',HttpGet->cTpAut,"L")

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo para retorno da liberacao								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:RetAutLib()

		HttpGet->cRda		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRda
		HttpGet->cCodLoc	:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCodLoc
		If ValType(HttpSession->cTp) == 'U'		
			HttpSession->cTp := HttpGet->cTp
		EndIf
		
		W_PPLDADRDA()

		For nA := 1 To Len(HttpSession->PROSAUD)
			if nA = 1
				cResult += "cComboSol!"
			endif

			if alltrim(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProSol) = alltrim(HttpSession->PROSAUD[nA]:cCode)
				cSelected = "T"
			else
				cSelected = "F"
			endif

			cResult += HttpSession->PROSAUD[nA]:cCode + "$"+ HttpSession->PROSAUD[nA]:cName + "$" + cSelected + ";"
		next

		if Len(HttpSession->PROSAUD) > 0
			cResult += "|"
		endif

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁCabecalho															   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		cResult +=	"cRda!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRda+"|"+;				//0
					"cRegAns!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRegAns+"|"+;				//1
					"cNomeRdaSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeRda+"|"+; 		//2
					"cCnpjCpfSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCnpjCpfSol+"|"+;		//3
					"cCnesSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCnesSol+"|"+;      		//4
					"cNomeSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeSol+"|"+;       	//5
					"cProExe!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProExe+"|"+;       	//6
					"cCodSigExe!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCodSigExe+"|"+;       	//7
					"cNumCrExe!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumCrExe+"|"+;       	//8
					"cEstSigExe!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cEstSigExe+"|"+;       	//9
					"cMatric!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric+"|"+;   	//10
					"cNomeUsr!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeUsr+"|"+;     	//11
					"cTpAcom!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cTpAcom+"|"+;   	//12
					"cNomeSolT!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeSolT+"|"+;         			//13
					"cCnesSolT!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCnesSolT+"|"+;         //14
					"cNomPla!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomPla+"|"+;				//15
					"cDtVldCar!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtVldCar)+"|"+; //16
					"cCarSaud!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCarSaud+"|"+; //17
					"cGrPar!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cGrPar+"|"+;  //18
					"cGraPartExe!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cGrPar+"|"+;  //18
					"cDtEmiss!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtSolicit)+"|"+; //19
					"cSenha!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cSenha+"|"+; //20
					"cFormNumber!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumImp+"|"+;//62
					"cObs!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cObs+"|"+;//38
					"cAtendRN!"+ Iif(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cAteRN == '1', '1', '0')+"|"+;
					"cCarSolicit!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCarSolicit+"|"+; 	//9
					"cTpIntern!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cTpIntern+"|"+; //22
					"cRegInter!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cRegInter+"|"+; //23
					"cIndAcid!"+Iif(!Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cIndAcid),oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cIndAcid,"")+"|"+; // 77					
					"cCbosSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCbosSol+'$'+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cDescCbosSol+"|"+; //20
					"cProSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProSol+"|"+;         	//11
					"cProSolDesc!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeSol+"|"+;
					"cNomeSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeSol+"|"+;       	//13
					"dDataIniFat!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dIniFat)+"|"+;
					"dDataFimFat!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dFimFat)+"|"+;
					"dDataFimFat!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dFimFat)+"|"+;
					"cNomeUsu!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeUsr+"|"+;
					"cNumeCart!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric+"|"+;
					"cCodSigSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCodSigSol+"|"+;
					"cCid!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCid+"|"+;               	//10
					"cCid2!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCid2+"|"+; //29
					"cCid3!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCid3+"|"+; //30
					"cCid4!"+oObj:OWSRetAutLibRESULT:OWSSCABGUI:cCid4+"|"+; //31										
					"cNumCrSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumCrSol+"|"+;
					"dDtAut!"+dtoc(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtAut)+"|"+; 		//1
					"dDtValid!"+DToC(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtValid)+"|"+;    //6					
					"cEstSigSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cEstSigSol+"|"+;
					iif(HttpGet->cTp != '11', "cCodLoc!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cCodLoc+"|", "" )+;
					"cObs!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cObs+"|"+;         			//17
					"cPadCon!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cPadCon+"|"+; 
					"cQtdDSol!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cQtdDSol+"|"+;
					"cNumMaxAux!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumAux+"|<"

		//Alimenta Sessions de impressЦo
		HttpSession->cNumeAut	:= AllTrim(StrTran(StrTran(HttpGet->cNumeAut,".",""),"-",""))
		HttpSession->cSenha		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cSenha
		HttpSession->cCid  		:= ""
		HttpSession->cNome		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric+" - "+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeUsr
		HttpSession->cNomeSol  	:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeSolT
		HttpSession->cNomeRda	:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRda + " - " + oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeRda
		HttpSession->cIndCli		:= ""
		HttpSession->cFormNumber	:= ""
		HttpSession->aResult 	:= {}

		//NЗmero de auxiliares
		HttpSession->cNumAux		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumAux

		For nI:=1 To Len(oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI) 		//63
		    If oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cExibe == "1"
		        lExibe := .T.
	            cResult +=	"cTpServ!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cTpServ+"@"+; //0
					        "cExibe!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cExibe+"@"+;  //1
	            			"cCodPad!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPad+"@"+; //2
							"cCodPro!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPro+"@"+; //3
							"cDesPro!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDesPro+"@"+; //4
							"nQtdSol!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cQtdSol+"@"+; //5
							"nQtdAut!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cQtdAut+"@"+; //6
							"cFabric!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cFabric+"@"+; //7
							"nVlrApr!"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrApr,"@U 999,999,999.99" ) )+"@"+;//8
							"cDente!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDente+"@"+;//9
							"cFace!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cFace+"@"+;//10
							"nQtdUs!"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nQtdUs,"@U 999,999,999.99" ) )+"@"+;//11
							"nVlrCon!"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrCon,"@U 999,999,999.99" ) )+"@"+;//12
							"nVlrTpf!"+AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrTpf,"@U 999,999,999.99" ) )+"@"+;//13
							"cStatus!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cAutori+"@"+;//14
							"cSeqMov!"+oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSequencia+"@"+;//15
							'dDtExePro!'+DToC(oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:dDtExe)+"@"+;//16
							'cSenhaPro!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSenha+"@"+;//17
							'cResAutPro!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cResAut+"@"+;//18
							'cHorIni!'+AllTrim( TransForm( oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cHorIni,"@R !!:!!" ) )+"@"+;//19
							'cHorFim!'+AllTrim( TransForm( oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cHorFim,"@R !!:!!" ) )+"@"+;//20
							'cViaAc!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cViaAc+"@"+;//21
							'cTecUt!'+oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cTecUt+"@"+;//22
							'nRedAcre!'+AllTrim( TransForm( oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nRedAcre,"@U 999.99" ) )+"@"+;//23
							'nVlrTAp!'+AllTrim( TransForm( oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nVlrTAp,"@U 999,999,999.99" ) )+"~"//24
			EndIf

			//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta matriz para impressao de guia									  			  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        AaDd( HttpSession->aResult,{oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSequencia,;
        									oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPad,;
        									oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cCodPro,;
        									oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDesPro,;
        									oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cDente,;
        									oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cFace,;
        									oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cQtdAut,;
        									{},;
        									AllTrim( TransForm( oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:nQtdUs,"@U 999,999,999.99" ) ),;
        									DToC(oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:dDtExe),;
        									"",;
        									oObj:OWSRetAutLibRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cSenha,;
        									"",;
        									oObj:OWSRETAUTLIBRESULT:OWSSITEGUI:OWSMITEGUI[nI]:cAutori} )

		Next

		If HttpSession->cTissVer >=  "3"
			//EXECUTANTES
			cResult += "<"
			For nI:=1 To Len(oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI) 		//63
	            cResult += "nSeqRef!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cSequen+"@"+; //0
					        "cGrPar!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cGrPar+"@"+;  //1
					        "cGraPartExe!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cGrPar+"@"+;  //1
	            			"cCpfExe!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cCpfExe+"@"+; //2
							"cNomExe!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cNomExe+"@"+; //3
							"cCodSigExe!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cConReg+"@"+; //4
							"cNumCrExe!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cNumCr+"@"+; //5
							"cEstSigExe!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cUfCr+"@"+; //6
							"cCbosExe!"+oObj:OWSRETAUTLIBRESULT:OWSSEXEGUI:OWSMEXEGUI[nI]:cCbo+"@"+"~"//7
			Next
		EndIf
		
		//Gravo os atributos necessarios para o metodo 'isDupGui'
		cTipGui := HttpGet->cTp
		cCodUsr := oObj:cUserCode
		cCodRda := oObj:cRdaCode
		cGuiRef := HttpSession->cNumeAut
		cMatric := oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric
		cDatGui := DtoS(Date())
		
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁHonorario Individual													   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If HttpSession->cTp == '5'
			oObj:cNumPeg :=  oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cChvBD6
			If oObj:GetBD6()
				HttpSession->aMatBD6 := oObj:oWSGETBD6RESULT:OWSSMATBD6
			EndIf
		EndIf

		//Para guia de prorrogaГЦ (tipo 11), И necessАio validar a matricula do usurio e gravar as sessions de matricula
		If HttpSession->cTp == '11'
			//Atribui valor da carteirinha na variavel para busca dos dados do usuario
			HttpGet->TrilhaCard 	:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric
			HttpGet->cRda 		:= oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRda
			HttpGet->cCodLoc 		:= "001"


			cRetDadUsr := W_PPLSDADUSR()

			//Se houver algum problema na validacao do usuario, atribui o retorno para a funcaoo exibir alerta na tela e nao prosseguir com o processamento.
			if "false" $ cRetDadUsr
				cResult := cRetDadUsr
			endif
		EndIf

		// Parametros para retornar se a guia eh duplicada
		oObj:cUserCode			:= cCodUsr
		oObj:cRdaCode			:= cCodRda
		oObj:cTipGui			:= cTipGui	
		oObj:cUserCardNumber	:= cMatric
		oObj:cNumGuiRef			:= cGuiRef
		oObj:cDatGuia		 	:= cDatGui
		
		if HttpSession->cTp == '5' //Se for resumo de internaГЦo, joga resumo de internaГЦo
			oObj:cTipGui := HttpSession->cTp
		endif
		
		// Verifica se a guia pode estar sendo duplicada
		if oObj:isDupGui()
			cResult += "<" + SubStr(oObj:cIsDupGuiRESULT,6)
		endif 

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Se nao tem procedimento												   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If !lExibe .and. HttpSession->cTp != '11'
			cResult := "false|Nenhum procedimento autorizado para o executante!"
		EndIf
Else
		cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGUIPR 	  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 07.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o ЁChamada da pagina de escolha de Guia ou Protocolo (recurso Glosa)Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDOCG()
Local cHtml	:= ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina para entrar com o protocolo/Guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cResDoc := ""
If ValType(HttpGet->cChvPes) == 'U'
	HttpGet->cChvPes := "||" // manda vazio a primeira vez
EndIf
cHtml := ExecInPage( "PPLDOCGUIA" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLADRECG 	  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina para adicionar Recurso de Glosa               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDOCGUI()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁTipo de pre-atendimento se vai pre-atender ou atender (executar)		   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cObsRecG := ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina para entrar com o protocolo/Guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLADDOCG" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETRECG    Ё Autor Ё Rogerio Tabosa	      Ё Data Ё 18/03/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os dados da guia glosada                              Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETDOCG()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLRECGLO():New()
WsChgURL( @oObj, "PLRECGLO.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cRecno		:= HttpGet->cRecno
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GetDadEveGui()
	cResult := oObj:cGetDadEveGuiRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGRVDOCG    Ё Autor Ё Rogerio Tabosa	      Ё Data Ё 18/03/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Grava documento					                               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGRVDOCG()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLRECGLO():New()
WsChgURL( @oObj, "PLRECGLO.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cRecno		:= HttpGet->cRecno
oObj:cArq1		 	:= HttpPost->cDirArq
oObj:cArq2		 	:= HttpPost->cDir2Arq
oObj:cCodRda	 	:= HttpSession->RDAVIEW[1]:CCODE

HttpSession->cResDoc := "Vazio"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:PutDocGuiEvents()
	cResult += oObj:cPutDocGuiEventsRESULT
	HttpSession->cResDoc := cResult
Else
	HttpSession->cResDoc := ""
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁWTDecode    Ё Autor Ё Daher		 	      Ё Data Ё 18/03/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Grava documento					                               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function WTDecode(cString)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁATENCAO ESTA FUNCAO TEM A FUNCIONALIDADE DE RETIRAR OS CARACTERES ESPECIAIS
// DE UMA DETERMINADA STRING.
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cString := StrTran(cString,"А","a");cString := StrTran(cString,"Ю","a");cString := StrTran(cString,"Б","a");cString := StrTran(cString,"Ц","a")
cString := StrTran(cString,"Д","a");cString := StrTran(cString,"а","A");cString := StrTran(cString,"ю","A");cString := StrTran(cString,"ц","A")
cString := StrTran(cString,"б","A");cString := StrTran(cString,"д","A");cString := StrTran(cString,"И","e");cString := StrTran(cString,"Х","e")
cString := StrTran(cString,"Й","e");cString := StrTran(cString,"К","e");cString := StrTran(cString,"и","E");cString := StrTran(cString,"х","E")
cString := StrTran(cString,"й","E");cString := StrTran(cString,"к","E");cString := StrTran(cString,"М","i");cString := StrTran(cString,"Л","i")
cString := StrTran(cString,"О","i");cString := StrTran(cString,"м","I");cString := StrTran(cString,"л","I");cString := StrTran(cString,"н","I")
cString := StrTran(cString,"о","I");cString := StrTran(cString,"С","o");cString := StrTran(cString,"Р","o");cString := StrTran(cString,"У","o")
cString := StrTran(cString,"Т","o");cString := StrTran(cString,"Ж","o");cString := StrTran(cString,"с","O");cString := StrTran(cString,"р","O")
cString := StrTran(cString,"у","O");cString := StrTran(cString,"т","O");cString := StrTran(cString,"ж","O");cString := StrTran(cString,"З","u")
cString := StrTran(cString,"Ы","u");cString := StrTran(cString,"Э","u");cString := StrTran(cString,"Ш","u");cString := StrTran(cString,"ш","U")
cString := StrTran(cString,"з","U");cString := StrTran(cString,"ы","U");cString := StrTran(cString,"э","U");cString := StrTran(cString,"Г","c")
cString := StrTran(cString,"г","C");cString := StrTran(cString,"╣","" );cString := StrTran(cString,"©","" );cString := StrTran(cString,"╢","")
cString := StrTran(cString,"%","" );cString := StrTran(cString,"@","" );cString := StrTran(cString,"#","" );cString := StrTran(cString,"$","")
cString := StrTran(cString,"&","" );cString := StrTran(cString,"*","" );cString := StrTran(cString,"-","" );cString := StrTran(cString,"=","")
cString := StrTran(cString,"`","" );cString := StrTran(cString,"~","" );cString := StrTran(cString,"?","" );cString := StrTran(cString,"/","")
cString := StrTran(cString,"\","" );cString := StrTran(cString,"Ч","" );cString := StrTran(cString,"ч","" );cString := StrTran(cString,"╬","")
cString := StrTran(cString,"{","" );cString := StrTran(cString,"|","" );cString := StrTran(cString,"}","" );cString := StrTran(cString,"║","")
cString := StrTran(cString,"╒","" );cString := StrTran(cString,"ё","" );cString := StrTran(cString,"╓","" );cString := StrTran(cString,"╔","")
cString := StrTran(cString,"╕","" );cString := StrTran(cString,"╗","" );cString := StrTran(cString,"╘","" );cString := StrTran(cString,"╙","")
cString := StrTran(cString,"╚","" );cString := StrTran(cString,"╛","" );cString := StrTran(cString,"╜","" );cString := StrTran(cString,"╝","")
cString := StrTran(cString,"╞","" );cString := StrTran(cString,"╟","" );cString := StrTran(cString,"╠","" );cString := StrTran(cString,"╡","")
cString := StrTran(cString,"Ё","" );cString := StrTran(cString,"╢","" );cString := StrTran(cString,"╣","" );cString := StrTran(cString,"╤","")
cString := StrTran(cString,"╥","" );cString := StrTran(cString,"╦","" );cString := StrTran(cString,"╧","" );cString := StrTran(cString,"╨","")
cString := StrTran(cString,"╩","" );cString := StrTran(cString,"╪","" );cString := StrTran(cString,"╫","" );cString := StrTran(cString,"╬","")
cString := StrTran(cString,"©","" );cString := StrTran(cString,"в","" );cString := StrTran(cString,"ь","" );cString := StrTran(cString,"ъ","")
cString := StrTran(cString,"Ф","" );cString := StrTran(cString,"Г","c");cString := StrTran(cString,"В","" );cString := StrTran(cString,"Ь","")
cString := StrTran(cString,"Щ","y");cString := StrTran(cString,"Ч","");cString := StrTran(cString,"Ъ","y" );cString := StrTran(cString,"°","")
cString := StrTran(cString,"┼","S");cString := StrTran(cString," ","s");cString := StrTran(cString,"÷","Y");cString := StrTran(cString,"▌","Z")
cString := StrTran(cString,"·","z");cString := StrTran(cString,"┐","f");cString := StrTran(cString,"!","" );cString := StrTran(cString,"Chr(166)","")
cString := StrTran(cString,"╗","" );cString := StrTran(cString,"╟","" );cString := StrTran(cString,"╨","" );cString := StrTran(cString,"","")
cString := StrTran(cString,"","" );cString := StrTran(cString,"<","" );cString := StrTran(cString,"Chr(167)","") 
		     
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da funcao														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return(cString)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLPRTCAR    Ё Autor Ё Thiago Guilherme	      Ё Data Ё 03/12/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Exibe procedimentos e suas carencias no portal                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPRTCAR()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= "true|"
LOCAL nResult		:= 0
LOCAL nI			:= 0
local xHeader    := ""
Local xCols      := ""
LOCAL cGrid	   := "89"
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:ExCarPortal()

	nResult := Len(oObj:OWSEXCARPORTALRESULT:OWSSCARPOR)

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Cabecalho
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	xHeader += "[{name:'Codigo'},"
	xHeader += "{name:'DescriГЦo'},"
	xHeader += "{name:'CarЙncia Proc.'}]"

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'CodPro', value:'" + oObj:OWSEXCARPORTALRESULT:OWSSCARPOR[nI]:cCodPro +   "'},"
		xCols +=  "1:{field:'DescPro',value:'" + SubStr(oObj:OWSEXCARPORTALRESULT:OWSSCARPOR[nI]:cDescPro,1,80) +"'},"
		xCols +=  "2:{field:'REC', value:'0#"  + oObj:OWSEXCARPORTALRESULT:OWSSCARPOR[nI]:cRec + "'}"  +Iif( nResult != nI ,"},","}]" )
	Next nI

	cResult += xHeader + "|" + xCols +"|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCARPOR    Ё Autor Ё Thiago Guilherme	      Ё Data Ё 03/12/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё 									                               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCARPOR()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina de procedimentos				 						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

cHtml += ExecInPage( "PPLEXCARPORT" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCARENC    Ё Autor Ё Thiago Guilherme	      Ё Data Ё 13/01/14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna as carencias do beneficiario para o portal            Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCARENC()
LOCAL cResult  	:= "true|"
LOCAL cMatric := HttpGet->cMatric
LOCAL cRecno  := HttpGet->cRecno
LOCAL nResult
LOCAL nI
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:CcMatrc	:= cMatric
oObj:CcRecno	:= cRecno

If oObj:CarenBnf()

	nResult := Len(oObj:OWSCARENBNFRESULT:OWSSRETCAREN)

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Cabecalho
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'cInfo', value:'" + oObj:OWSCARENBNFRESULT:OWSSRETCAREN[nI]:CcInfo +   "'},"
		xCols +=  "1:{field:'cMsg',value:'" + SubStr(oObj:OWSCARENBNFRESULT:OWSSRETCAREN[nI]:CcMsg,1,80) +"'}" + Iif( nResult != nI ,"},","}]" )

	Next nI

	cResult += xCols + "|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGRPFAM    Ё Autor Ё Thiago Guilherme	    Ё Data Ё 09/01/14Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os dados do grupo familiar                            Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLGRPFAM()
LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If HttpSession->MPortal == "000010"

oObj:cUserCode	:= "MSALPHA"
oObj:cCUSRLOGIN	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE

EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DadGrpFam()

	nResult := Len(oObj:OWSDadGrpFamRESULT:OWSSDADGRP)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'cMatric', value:'" + oObj:OWSDadGrpFamRESULT:OWSSDADGRP[nI]:cMatricl +   "'},"
		xCols +=  "1:{field:'cNomBnf',value:'" +  SubStr(oObj:OWSDadGrpFamRESULT:OWSSDADGRP[nI]:cNomeBnf,1,20) +"'}" + Iif( nResult != nI ,"},","}]" )
	Next

	cResult += xCols +"|"

Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLNOTIC    Ё Autor Ё Thiago Guilherme	      Ё Data Ё 03/12/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os dados da noticia no portal			                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLNOTIC()
LOCAL  oObj 		:= NIL
LOCAL  cResult  	:= "true|"
LOCAL  nQtdPrtd	:= 0
LOCAL  nI			:= 0
LOCAL  cCodPrt		:= ""
LOCAL  cRe       := ""
LOCAL  nQtdEspec	:= 0
LOCAL  nQtdNot		:= 0
LOCAL 	cHtml := ""
STATIC lVerTds		:= .F.

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Chamada da rotina pelo portal do prestador
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If HttpSession->MPortal == "000008"

	nQtdPrtd := Len(HttpSession->RDAVIEW)

	For nI := 1 To nQtdPrtd

		if nI <nQtdPrtd
			cCodPrt+= HttpSession->RDAVIEW[nI]:CCODE+ ","
		Else
			cCodPrt+= HttpSession->RDAVIEW[nI]:CCODE
		EndIf
	Next

	oObj:cUserCode	:= "MSALPHA"
	oObj:CcCodRDA		:= cCodPrt

 	If EMPTY(HttpGet->cOpcao)
 		oObj:CcOpcao := "1"
 		oObj:CcCodEsp := HttpGet->cCdEspec
 	Else
 		oObj:CcOpcao  := HttpGet->cOpcao
 		oObj:CcCodNotic := HttpGet->cCdNot
 	EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Chamada da rotina pelo portal do beneficiario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
ElseIf HttpSession->MPortal == "000010"

	oObj:cUserCode	:= "MSALPHA"

 	If EMPTY(HttpGet->cOpcao)
 		oObj:CcOpcao := "1"
 		oObj:CcUserCod := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
 	Else
 		oObj:CcOpcao    := HttpGet->cOpcao
 		oObj:CcCodNotic := HttpGet->cCdNot
 	EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados para a pagina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд

If oObj:RetNot()

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Retorna os tМtulos das notМcias
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If oObj:CcOpcao == "1"

		nQtdEspec := LEN(oObj:OWSRETNOTRESULT:OWSSNOTICIA)

		For nI := 1 To nQtdEspec

			cRe += "<li class='newsItem'><a class='newsLink' href='W_PPLNOTIC.APW?cOpcao=2&cCdNot=" + oObj:OWSRETNOTRESULT:OWSSNOTICIA[nI]:CCCODNOT + "' target='principal' "
			cRe += "title='TМtulo da notМcia disponМvel'>" + oObj:OWSRETNOTRESULT:OWSSNOTICIA[nI]:CTITULONOT
			cRe += "</a></li>"

			If !lVerTds .AND. nI == 10

				cRe += "<li class='newsItem'><a href='#' onclick='carregaNoticia()' title='Visualizar todas as notМcias disponМveis' class='newsLink'>"
				cRe += "<i>Todas as notМcias</i><a/></li>"
				lVerTds := .T.

				EXIT
			EndIf
		Next

		   If lVerTds .AND. nI > 10

				cRe += "<li class='newsItem'><a href='#' onclick='carregaNoticia()' title='Visualizar somente as Зltimas notМcias' class='newsLink'>"
				cRe += "<i>Visualizar somente as Зltimas dez notМcias</i><a/></li>"
				lVerTds := .F.
			EndIf

		If nQtdEspec == 0
			cRe += "<li class='newsItem'><a href='#' class='newsLink' style='text-align:start;'><i>NЦo existem notМcias disponМveis no momento.<i></a></li>"
		EndIf

		cResult += cRe

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Retorna o conteЗdo da notМcia
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	ElseIf oObj:CcOpcao == "2"

		nQtdNot := LEN(oObj:OWSRETNOTRESULT:OWSSNOTICIA)

		cRe := "<html>"
		cRe +=   	"<head>"

		cRe += "<title>Untitled Document</title>"
		cRe += "<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'>"
		cRe += "<meta http-equiv='X-UA-Compatible' content='IE=Edge' >"
		cRe += "<meta name='viewport' content='width=device-width, initial-scale=1' >"
		cRe += "<meta name='description' content='' >"
		cRe += "<meta name='author' content='' >"
		cRe += "<link href='" + GetPrtSkin() +"/estilo.css' rel='stylesheet' type='text/css'>"
		cRe += "<script type='text/javascript' src='pplanguage.js'></script>"
		cRe += "<script type='text/javascript' src='criaobj.js'></script>"
		cRe += "<script type='text/javascript' src='" + GetPrtSkin() +"/jspls.js'></script>"
		cRe += "<link href='" + GetPrtSkin() +"/componentes/bootstrap/dist/css/bootstrap.css' rel='stylesheet'>"
		cRe += "<link href='" + GetPrtSkin() +"/componentes/metisMenu/css/metisMenu.css' rel='stylesheet'>"
		cRe += "<link href='" + GetPrtSkin() +"/componentes/datatables-plugins/css/dataTables.bootstrap.css' rel='stylesheet'>"
		cRe += "<link href='" + GetPrtSkin() +"/componentes/datatables-responsive/css/dataTables.responsive.css' rel='stylesheet'>"
		cRe += "<link href='" + GetPrtSkin() +"/componentes/layout-responsivo/css/layout-responsivo.css' rel='stylesheet'>"
		cRe += "<link href='" + GetPrtSkin() +"/componentes/font-awesome/css/font-awesome.css' rel='stylesheet' type='text/css'>"
		cRe +=   	"</head>"

		cRe += "<body>"

		cRe += "<div id='ModalPage'>"
		cRe += "<div class='ModalBackground'></div>"
		cRe += "<div id='ModalContainer' class='ModalContainer'></div>"
		cRe += "</div>"

		For nI := 1 To nQtdNot
			cRe += "<div class='col-lg-12'>"
			cRe += "<h3>" + CAPITAL(oObj:OWSRETNOTRESULT:OWSSNOTICIA[nI]:CTITULONOT) + "</h3>"
			cRe += "</div>"


			cRe += "<div id='newContainer'>"
			cRe += oObj:OWSRETNOTRESULT:OWSSNOTICIA[nI]:CTEXTONOT

			If !EMPTY(oObj:OWSRETNOTRESULT:OWSSNOTICIA[nI]:OWSARQNOT:OWSSARQNOT)
				cRe += "<br><p style='font-size:14px;'>Anexo referente a notМcia disponМvel para download: "
				cRe += 		"<a href='W_PPLCHANOT.APW?cCodNot="+ oObj:OWSRETNOTRESULT:OWSSNOTICIA[nI]:CCCODNOT +"' title='Baixar anexos disponМveis referente a notМcia.'>"
				cRe += "<i>Clique aqui</i><a/></p>"
			EndIf
			 cRe += "</div>"
		Next
		CrE += "</body>
		cRe += "</html>"

		cResult :=  cRe

	EndIf
Else
	cResult := "false|NЦo foi possМvel carregar a notМcia"
EndIf

WEB EXTENDED END

//
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLNOT    Ё Autor Ё Thiago Guilherme	      Ё Data Ё 03/12/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё 									                               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLNOT()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina de procedimentos				 						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

cHtml += ExecInPage( "PPLEXNOT.APW?cCdEspec="+HttpGet->cCdEspec )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCHANOT  Ё Autor Ё Thiago Guilherme	      Ё Data Ё 03/12/13 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada do menu de arquivo de noticias do portal   			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLCHANOT()
LOCAL cHtml  	:= ""
LOCAL cDir	 	:= getPastPp(.T.)
LOCAL aFiles	:= {}

WEB EXTENDED INIT cHtml START "InSite"

If !Empty(cDir)

	cDir := cDir + getPrtSkin() + "\arquivonoticia\"+ HttpGet->cCodNot + "\"
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//ЁLe diretorio para mostrar os arquivos disponiveis
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	aFiles := DIRECTORY(cDir+"*.*")

	If Len(aFiles) > 0
    	HttpPost->aFiles := aClone(aFiles)
		HttpPost->cDir := HttpGet->cCodNot
	Else
		Return PPLSALERT( "", "AtenГЦo", "Nenhum arquivo encontrado para esta notМcia.", "" )
	EndIf
Else
	Return PPLSALERT( "", "AtenГЦo", "Nao foi possМvel localizar os arquivos desta notМcia.", "" )
EndIf

cHtml += ExecInPage("PPLSNOTICIA.APH")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina			   													     Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml



/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLVIRECG 	  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina para retornar um valor da TISS              Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRETVLRTISS()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:oWSTERMOTISS:cCodAlias	:= HttpGet->cAlias
oObj:oWSTERMOTISS:cVlrProt	:= HttpGet->cVlrProt
oObj:oWSTERMOTISS:cCampo		:= HttpGet->cCampo
oObj:oWSTERMOTISS:cVerTiss	:= HttpSession->cTISSVer

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GetVlrTiss()
	cResult += oObj:cGETVLRTISSRESULT

EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLVIRECG 	  Ё Autor Ё Everton M. Fernandes Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada para montar guia de acordo com a TISS                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLFORMTISS()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL aCmbWS		:= {}
LOCAL aCmbX		:= {}
LOCAL aCmbAux		:= {}
LOCAL cStrCBOX	:= ""
LOCAL cTISSVer	:= ""
LOCAL nI,nY, nPos
Local cAnexCli	:= IIF( ValType(Httpget->cAnexCli) == "U", "", Httpget->cAnexCli )
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:oWSGUIATISS:cTipGui		:= HttpGet->cTipGui

//Recupera a versЦo da TISS da RDA
aRDA := ClassDataArr(HttpSession->RDAVIEW[1])
If aScan(aRDA,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0
	cTISSVer := HttpSession->RDAVIEW[1]:cTissVer
EndIf
If cTISSVer >= '3'
	oObj:oWSGUIATISS:cVerTiss := cTISSVer
Else
	cTISSVer :=  HttpGet->cVerTiss
	oObj:oWSGUIATISS:cVerTiss := cTISSVer
Endif
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Aqui eu pego o que vem de Session executo aqui pra enviar a informaГao
// pro WS pois o mesmo nao acessa o conteudo da Session	dificultando o dinamismo
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GetCmbFormT()
	// ATRIBUO OS PARAMETROS NOVAMENTE PARA UTILIZAгцO DO PROXIMO METODO
	oObj:cUserCode	:= "MSALPHA"
	oObj:oWSGUIATISS:cTipGui		:= HttpGet->cTipGui
	oObj:oWSGUIATISS:cVerTiss	:= cTISSVer
	//oObj:oWSGUIATISS:OWSCMBGUIA	:= {}
	oObj:oWSGUIATISS:cDadCombo	:= ""
	If Len(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA) > 0 //oObj:OWSGETCMBFORMTRESULT:oWSRETCMBSGUIA
		For nI:=1 To Len(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA)
			cStrCBOX := ""
			If "HTTPSESSION" $ Upper(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)	 // Se for uma Session eu pego CCODE e CNAME e monto o Combo
				If ValType(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)) <> 'U'
					For nY := 1 To Len(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX))
						cStrCBOX += Alltrim(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cCODE")) + "=" + Alltrim(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cNAME")) + ";"
					Next nY

					If nY > 2
						cStrCBOX += ";="//cStrCBOX += ";=-- Selecione um item --"
					EndIf
				EndIf
			Else // Caso contrario eu pego a STRING com mesma estrutura do X3_COBX
				cStrCBOX := Alltrim(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)
			EndIf
			If SubStr(cStrCBOX, Len(cStrCBOX),1) == ";"
				cStrCBOX := SubStr(cStrCBOX, 1, Len(cStrCBOX)-1)
			EndIf
			oObj:oWSGUIATISS:cDadCombo	+= Alltrim(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCampoG) + ";" + cStrCBOX + "|"
			//WSDATA RetCmbsGuia	AS Array Of SRetCmbsGuia OPTIONAL
		Next
	EndIf
EndIf
If SubStr(oObj:oWSGUIATISS:cDadCombo, Len(oObj:oWSGUIATISS:cDadCombo),1) == "|"
	oObj:oWSGUIATISS:cDadCombo := SubStr(oObj:oWSGUIATISS:cDadCombo, 1, Len(oObj:oWSGUIATISS:cDadCombo)-1)
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cDtJs := iif(valtype(HttpSession->cDtJs) <> 'U', HttpSession->cDtJs, "")
If oObj:GetFormTiss()
	cResult :=  oObj:OWSGETFORMTISSRESULT:cPagina

	If ValType(oObj:OWSGETFORMTISSRESULT:cGrids) == "C"
		HttpSession->cGrids := oObj:OWSGETFORMTISSRESULT:cGrids
	EndIf

	If ValType(oObj:OWSGETFORMTISSRESULT:OWSCMPGUIA:oWSSCmpGuia) == "A" /*/:OWSCMPGUIA:OWSSCMPGUIA)*/
		HttpSession->aCmpGuia := aClone(oObj:OWSGETFORMTISSRESULT:OWSCMPGUIA:oWSSCmpGuia)
	EndIf

	//Executa os inicializadores dos campos
	nIni := At("<%=",cResult)
	While  nIni > 0
		nFim := At("%>",cResult)
		cComando := SubStr(cResult,nIni+3,nFim - nIni-3)
		xResult := &(cComando)

		cTipResult := ValType(xResult)
		Do Case
			Case cTipResult == "D"
				xResult := DtoS(xResult)
				xResult := SubStr(xResult,7,2) + "/" + SubStr(xResult,5,2) + "/" + SubStr(xResult,1,4)
			Case cTipResult == "N"
				xResult := Alltrim(Str(xResult))
		EndCase

		cResult := StrTran ( cResult, "<%=" + cComando + "%>", xResult)
		nIni := At("<%=",cResult)
	EndDo
EndIf

IF cAnexCli <> "" //Guias de anexos sЦo carregadas com window.location, precisamos tirar o "true|" antes de mandar pra pАgina
	cResult := SubStr(cResult, At("|", cResult) + 1)
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁEXCLRESU   Ё Autor Ё Roberto Vanderlei    Ё Data Ё 22.03.2017  Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da Rotina de Exclusao de Itens do Resumo.			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function  EXCLRESU(aCols, cParPosExcl)

LOCAL oObj 		:= NIL
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"


oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"

oObj:cChave	:= cParPosExcl

oObj:ExclResu()

WEB EXTENDED END

return

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁEXCLRECT   Ё Autor Ё Roberto Vanderlei    Ё Data Ё 27.10.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da Rotina de Exclusao de Itens da Receitas.			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function  EXCLRECT(aCols, cParPosExcl)

LOCAL oObj 		:= NIL
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"


oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"

oObj:cProtoc	:= cParPosExcl
oObj:cMedicamento	:= aCols[1]
oObj:ExclRect()

WEB EXTENDED END

return

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGETGRID  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o ЁResponsАvel pela manipulaГЦo dos grids das Guias no Portal     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETGRID()
LOCAL oObj 		:= NIL

LOCAL nI			:= 0
LOCAL nJ			:= 0
LOCAL nL			:= 0
LOCAL nLen			:= 0
LOCAL nLenVal		:= 0
LOCAL nPos			:= 0
LOCAL nPosVal		:= 0
LOCAL nOpc 		:= 0
LOCAL nPosCols	:= 0
LOCAL nRecno		:= 0
LOCAL nLenCols	:= 0
LOCAL nQtdReg		:= 1
LOCAL nQtdPag 	:= 1
LOCAL nRegPagina 	:= 1

LOCAL cResult  	:= ""
LOCAL cGrid		:= ""
LOCAL xHeader 	:= "[{}]"
LOCAL xCols		:= ""

//Variaveis a utilizar posteriormente
LOCAL cPesquisa	:= ""
LOCAL cMsg			:= ""

//LOCAL aCampos		:= Separa ( HttpGet->cCmp, "," , .T.)
LOCAL aValores	:= {}
LOCAL aHeader		:= {}
LOCAL aCols		:= {}
LOCAL aLinha		:= {}

//Variaveis de tratamento do relacionamento que preenche a combo genericamente
LOCAL aRelac 		:= {}
LOCAL cCpoRelac	:= 	""
LOCAL cVlrRelac	:= ""

LOCAL cLinhas		:= ""
LOCAL lAtuVisibl	:= ""
LOCAL lDelVisibl	:= ""
LOCAL nNumAux		:= -1
LOCAL lFromGrid   := "false"
LOCAL cFunPosExcl 	:= ""
local cParPosExcl 	:= ""
local cSeqDelExec	:= "000"

LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml //Aqui nЦo tem o insite pq И utilizada no layout generico onde nЦo tem login

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
// HttpSession->aCmpGuia -> Guarda todos os campos/grids da Guia
// HttpSession->aCmpGuia[nPos] -> Trata-se da referЙncia a um campo ou grid
//
// HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING -> aHeader do Grid
// HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING -> aCols do Grid
//
// xCols e xHeader sЦo as strings que o JSPLS usarА para montar o grid
// aCols e aHeader sЦo os arrays que serЦo utilizados para manipular os campos
//por esta funГЦo
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If '*@*' $ HttpGet->cValores
	HttpGet->cValores := strTran(HttpGet->cValores, '*@*', '╖') //para tratar campos do tipo email que contИm @
EndIf

aValores	:= Separa ( HttpGet->cValores, "@" , .F.)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Recupera dados da pАgina
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cGrid := HttpGet->cGrid
nRecno := IIF(HttpGet->nRecno == "", "0", HttpGet->nRecno)
nRecno := IIF(Valtype("nRecno") <> "C", "", nRecno)
nOpc := Val(HttpGet->nOpc)
lBotao := HttpGet->lBotao
cSt := HttpGet->cSt
cValores	:= HttpGet->cValores

If ValType(HttpGet->cFunPosExcl) <> "U"
	cFunPosExcl := HttpGet->cFunPosExcl
Else
	cFunPosExcl := ""
EndIf

If ValType(HttpGet->cParPosExcl) <> "U"
	cParPosExcl := HttpGet->cParPosExcl
Else
	cParPosExcl := ""
EndIf

If ValType(HttpGet->lBtnAtuVisible) <> "U"
	lAtuVisibl := HttpGet->lBtnAtuVisible
Else
	lAtuVisibl := "true"
EndIf
If ValType(HttpGet->lBtnDelVisible) <> "U"
	lDelVisibl := HttpGet->lBtnDelVisible
Else
	lDelVisibl := "true"
EndIf

If ValType(HttpGet->lPacote) <> "U"
	lPacote := HttpGet->lPacote
Else
	lPacote := "false"
EndIf

If ValType(HttpGet->lFromGrid) <> "U"
	lFromGrid := HttpGet->lFromGrid
Else
	lFromGrid := "false"
EndIf

If ValType(HttpGet->cRelac) <> "U" .AND. !Empty(HttpGet->cRelac)
	aRelac := StrToArray(HttpGet->cRelac, "~")
	cCpoRelac	:= 	aRelac[2]
	cVlrRelac	:= ""
	aRelac := StrToArray(aRelac[3], "|")
Else
	if lDelVisibl <> "false"
		lDelVisibl := "true"
	EndIf
EndIf


If ValType(HttpGet->cSeqDelExec) <> "U"
	cSeqDelExec := HttpGet->cSeqDelExec
Else
	cSeqDelExec := "000"
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Encontra o objeto no array de campos
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Monta o aCols e aHeader
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If nPos > 0

	aHeader	:= HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING
	aCols		:= HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Verifica se o aCols e aHeader estЦo vazios
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If ValType(aHeader) <> 'A'
		aHeader := {}
		HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING := {}
	EndIf
	If ValType(aCols) <> 'A'
		aCols := {}
		HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING := {}
	EndIf

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Adiciona no aCols ou Posiciona na linha da alteraГЦo
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If nOpc == 3

		aAdd(aCols,{})
		aAdd(aHeader,{})
		nPosCols := Len(aCols)

	ElseIf nOpc == 4 .OR. nOpc == 5
		nPosCols := Val(nRecno)

	ElseIf nOpc == 6
		xCols := ""
		xHeader := "[{}]"
		nQtdReg := 0
		aCols := {}
		aHeader := {}
	EndIf

	If nPosCols > 0

		If nOpc == 5
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Exclui registro
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			If Len(aCols) > 0

				if cFunPosExcl <> ""
					&cFunPosExcl.(aCols[nPosCols], cParPosExcl) //Chama funГЦo apСs a exclusЦo da gride.
				endif

				aDel(aCols,nPosCols)
				aSize(aCols,Len(aCols)-1)
				aDel(aHeader,nPosCols)
				aSize(aHeader,Len(aHeader)-1)
			EndIf

		Else
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Inicia o xHeader e o xCols
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			xHeader := "["

			If 	Empty(HttpSession->aCmpGuia[nPos]:CXCOLS)
				xCols := "["
			Else
				xCols := HttpSession->aCmpGuia[nPos]:CXCOLS
				xCols := Left(xCols,Len(xCols)-1) + ","
			EndIf

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Monta xHeader e xCols
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)
			nLenVal := len(aValores)
			For nI := 1 to nLenVal
				If "╖" $ aValores[nI]
							aValores[nI] := strTran(aValores[nI], '╖', '@')
				EndIf
				aLinha := Separa(aValores[nI],";",.F.)
				nNumAux := -1
				If Len(aCols) < nPosCols+nI-1
					aAdd(aCols,{})
					aAdd(aHeader,{})
				EndIf
				For nJ := 1 to nLen

					If nJ == 1
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
						//Adiciona os botУes da linha e coloca o Recno
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
						If (lAtuVisibl == "true") .OR. (lDelVisibl == "true")
							xCols += "{"
						EndIf
						If (lAtuVisibl == "true")
							If nI == 1
								xHeader += "{name:'Alterar'},"
							EndIf
							nNumAux++
							//xCols += "{"
							xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'0#" + AllTrim(Str(nPosCols+nI-1)) + "," + cGrid + ".id,4'},"
						EndIf
						If (lDelVisibl == "true")
							If nI == 1
								xHeader += "{name:'Excluir'},"
							EndIf
							nNumAux++

							if cFunPosExcl <> ""
								xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'1#" + AllTrim(Str(nPosCols+nI-1)) + "," + cGrid + ".id,5,true," + '""' + " ," + '""' + " ,cCampoDefault," + lAtuVisibl + "," + lDelVisibl + "," + lFromGrid + ", cFunPosExcl, cParPosExcl'}," //BotЦo Excluir
							else
								xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'1#" + AllTrim(Str(nPosCols+nI-1)) + "," + cGrid + ".id,5,true," + '""' + " ," + '""' + " ,cCampoDefault," + lAtuVisibl + "," + lDelVisibl + "," + lFromGrid + "'}," //BotЦo Excluir
							endif

						EndIf
					EndIf

					cCampo  := alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nJ]:CNOME)
					cTitulo := alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nJ]:CDESCRI)

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					//Ё Verifica se o campo jА tem algum valor
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					nPosVal := aScan(aLinha , { |x| cCampo $ x } )
					If cCampo == "cProExe" .AND. nPosVal > 0
						If Separa(aLinha[nPosVal],"$",.T.)[1] == "cProExeDesc"
							nPosVal := 9	
						Endif
					EndIF
					If nPosVal > 0
						cValor	 := Separa(aLinha[nPosVal],"$",.T.)[2]
					Else
						cValor := ""
					EndIf

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					//Ё Cabecalho
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					If nI == 1 .AND. cTitulo <> 'CMPSEQ' // ValidaГЦo para remover do cabeГalho pois estava desposicionando os itens da grid.
						xHeader += "{name:'" + cTitulo + "'}" + Iif( nLen != nJ ,",","]" )
					EndIf

					If nOpc == 3  // Inclui registro

						aAdd(aCols[nPosCols+nI-1],cValor)
						aAdd(aHeader[nPosCols+nI-1],cCampo)
						nNumAux++
						If (lAtuVisibl == "false") .AND. (lDelVisibl == "false")
							xCols += "{"
						EndIf
						xCols += cValToChar(nNumAux) + ":{field:'"+cCampo+"', value:'" + /*cBtnPos +*/ cValor + "'} "

						If nLen != nJ
							xCols += ","
						Else
							xCols += "}"
							If nI != nLenVal
								xCols += ","
							Else
								xCols += "]"
							EndIf
						EndIf
					ElseIf nOpc == 4//Altera Registro

						aCols[nPosCols][nJ] := cValor

					EndIf
				Next nJ
				If nLen > 0
					If nOpc == 3
						aAdd(aCols[nPosCols+nI-1],cSt)
						aAdd(aHeader[nPosCols+nI-1],"Marca")
					ElseIf nOpc == 4
						aCols[nPosCols][len(aCols[nPosCols])] := cSt
					EndIf
				EndIf
			Next nI
		EndIf
	EndIf

	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Se for alteraГЦo, reconstroi o xCols
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If nOpc == 4 .OR. nOpc == 5
		nLenCols := Len(aCols)
		If nLenCols > 0
			xCols := "[{
			For nI := 1 to nLenCols
				nNumAux = -1
				If (lAtuVisibl == "true")
					nNumAux++
					xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'0#" + AllTrim(Str(nI)) + "," + cGrid + ".id,2'}," //BotЦo Alterar
				EndIf
				If (lDelVisibl == "true")
					nNumAux++
					xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'1#" + AllTrim(Str(nI)) + "," + cGrid + ".id,5,true," + '""' + " ," + '""' + " ,cCampoDefault," + lAtuVisibl + "," + lDelVisibl + "," + lFromGrid + "'}," //BotЦo Excluir
				EndIf
				nLenHeader := Len(aHeader[nI])-1	//,true,cCampo.value,"",cCampoDefault.replace(/\|/g,",")
				For nJ := 1 to nLenHeader
					nNumAux++
					xCols += cValToChar(nNumAux) + ":{field:'"+ aHeader[nI][nJ]+ "', value:'" + aCols[nI][nJ] + "'} " + Iif( nLenHeader != nJ ,",","}" )
				Next nJ
				xCols += Iif( nLenCols != nI ,",{","]" )

			Next nI
			nQtdReg		:= 1
			nQtdPag 		:= 1
			nRegPagina 	:= 1
		Else
			xCols := ""
			xHeader := "[{}]"
			nQtdReg		:= 0
			//nQtdPag 	:= 0
			//nRegPagina 	:= 0
		EndIf

	EndIf
	//Indica que a linha deve ser marcada
	nLenCols := len(aCols)
	nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)
	For nI := 1 to nLenCols
		If aCols[nI][nLen+1] <> "1"
			cLinhas += AllTrim(str(nI))+"&"
		EndIf
	Next nI

	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Adiciona o xHeader e xCols ao array da session
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд

	//Verifica se nЦo houve problemas na montagem e caso haja, fecha o xHeader
	If RAT(xHeader,",") == 0
		xHeader := Left(xHeader,Len(xHeader)-1)+"]"
	EndIf

	HttpSession->aCmpGuia[nPos]:CXHEADER := xHeader
	HttpSession->aCmpGuia[nPos]:CXCOLS   := xCols
	HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING := aClone(aHeader)
	HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING := aClone(aCols)
	If !Empty(cCpoRelac)
		cVlrRelac := "["
		For nI := 1 To Len(aCols)
			For nL := 1 To Len(aRelac)
				nPosVal := aScan(aHeader[1] , { |x| aRelac[nL] == x } )
				If nPosVal <> 0
					cVlrRelac += IIf(nL == 1, "[", "")
					cVlrRelac += IIf(nL <> Len(aRelac), "'" + aCols[nI,nPosVal] + "'" + "," ,"'" + aCols[nI,nPosVal] + "'" + "]")
				EndIf
			Next nL
			If nI <> Len(aCols)
				cVlrRelac += ","
			EndIf
		Next nI
		cVlrRelac += "]"
	EndIf

	//Calcula a qtd de pАginas
	/*nQtdReg	:= nI-1

    	if nRegPagina==0
    		nRegPagina := 1
    	endIf

		nRest	:= mod(nQtdReg, nRegPagina)

		If nRest > 0
			nQtdPag	:= Int(nQtdReg / nRegPagina)+1
		Else
			nQtdPag := Int(nQtdReg / nRegPagina)
		EndIf

		If 	nQtdPag == 0
			nQtdPag := 1
		EndIf*/


	cResult := "true|" +;
				 cValToChar(nI-1) + "|" + ;
				 cValToChar(nQtdPag) + "|" + ;
				 cValToChar(nRegPagina) + "|" + ;
				 xHeader + "|" +	;
				 xCols + "|" + ;
				 cMsg + "|" + ;
				 "true"/* iIf(lContinua,'true','false')*/ + "|" + ;
				 "1"/*cValToChar(nPaginaAtu)*/ + "|" + ;
				 cPesquisa + "|" + ;
				 "true"/* iIf(lCSemafo,'true','false') */ + "|" + ;
				 cGrid + "|" + ;
				 AllTrim(Str(nOpc)) + "|" +;
				  "" + "|" +;
				 lBotao + "|" +;
				 cSt + "|" +;
				 cLinhas + "|"+;
				 lAtuVisibl + "|"+;
				 lDelVisibl + "|"+;
				 lPacote    + "|"+;
				 cCpoRelac + "|"+;
				 cVlrRelac + "|"+;
				 cSeqDelExec + "|"
Else
	cResult := "false|NЦo foi encontrado o grid especificado!"
EndIf

WEB EXTENDED END

/*HttpGet->cCmp*/
Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGETCMP   Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna os campos do grid                                     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETCMP()
LOCAL oObj 		:= NIL

LOCAL nI			:= 0
LOCAL nLen			:= 0
LOCAL nPos			:= 0

LOCAL cResult  	:= ""
LOCAL cGrid		:= ""
LOCAL nOpc			:= ""
LOCAL cRecno		:= ""
LOCAL lAtuVisibl	:= ""
LOCAL lDelVisibl	:= ""
LOCAL lFromGrid   := ""
local cFunPosExcl   := ""
local cParPosExcl	:= ""
local cSeqDelExec	:= "000"

LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Recupera nome do grid
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cGrid := HttpGet->cGrid
nOpc := HttpGet->nOpc
cRecno := HttpGet->nRecno
lBotao := HttpGet->lBotao
cSt		:= HttpGet->cSt // 1-Normal; 0-Marca a linha
cValores := HttpGet->cValores
cCampoDefault := HttpGet->cCampoDefault

If ValType(HttpGet->cFunPosExcl) <> "U"
	cFunPosExcl := HttpGet->cFunPosExcl
Else
	cFunPosExcl := ""
EndIf

If ValType(HttpGet->cParPosExcl) <> "U"
	cParPosExcl := HttpGet->cParPosExcl
Else
	cParPosExcl := ""
EndIf

If ValType(HttpGet->lBtnAtuVisible) <> "U"
	lAtuVisibl := HttpGet->lBtnAtuVisible
Else
	lAtuVisibl := "true"
EndIf
If ValType(HttpGet->lBtnDelVisible) <> "U"
	lDelVisibl := HttpGet->lBtnDelVisible
Else
	lDelVisibl := "true"
EndIf

If ValType(HttpGet->lPacote) <> "U"
	lPacote := HttpGet->lPacote
Else
	lPacote := "false"
EndIf

If ValType(HttpGet->lFromGrid) <> "U"
	lFromGrid := HttpGet->lFromGrid
Else
	lFromGrid := "false"
EndIf

If ValType(HttpGet->cSeqDelExec) <> "U"
	cSeqDelExec := HttpGet->cSeqDelExec 
EndIf

If cRecno='undefined'
	cRecno := '0'
EndIf

If lBotao='undefined'
	lBotao := 'true'
EndIf

If cSt='undefined'
	cSt := '1'
EndIf

If lAtuVisibl='undefined'
	lAtuVisibl := 'true'
EndIf

If lDelVisibl='undefined'
	lDelVisibl := 'true'
EndIf
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Encontra o objeto no array de campos
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Monta o aCols e aHeader
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If nPos > 0

	cResult := "true|" +	 cGrid + "|" + nOpc + "|["
	nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)

	For nI := 1 to nLen
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		//Ё Verifica se foi informado funcao de tratamento na linha
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		cResult += alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nI]:CNOME) + Iif( nLen != nI ,",","]|" )
	Next nI

	cResult += + cRecno + "|" + lBotao + "|" + cSt + "|"  + cValores + "|" + cCampoDefault + "|" + lAtuVisibl + "|" + lDelVisibl + "|" + lPacote + "|" + lFromGrid + "|" + cFunPosExcl + "|"  + cParPosExcl + "|" + cSeqDelExec + "|"
Else
	cResult := "false|NЦo foi encontrado o grid especificado!"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLVISGRID  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna as colunas e valores da linha do Grid                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLVISGRID()

LOCAL oObj 		:= NIL

LOCAL nI			:= 0
LOCAL nJ			:= 0
LOCAL nLen			:= 0
LOCAL nPos			:= 0
LOCAL nOpc 		:= 0
LOCAL nPosCols	:= 0
LOCAL nRecno		:= 0
LOCAL nLenCols	:= 0
LOCAL nQtdReg		:= 1
LOCAL nQtdPag 	:= 1
LOCAL nRegPagina 	:= 1

LOCAL cResult  	:= ""
LOCAL cGrid		:= ""
LOCAL xCols		:= "[]"

LOCAL aHeader		:= {}
LOCAL aCols		:= {}

LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Recupera dados da pАgina
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cGrid := HttpGet->cGrid
nRecno := Val(HttpGet->nRecno)
nOpc := Val(HttpGet->nOpc)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Encontra o objeto no array de campos
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Monta o aCols e aHeader
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If nPos > 0
 
	aHeader	:= HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING
	aCols		:= HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Verifica se o aCols e aHeader estЦo vazios
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If ValType(aHeader) <> 'A'
		aHeader := {}
	EndIf
	If ValType(aCols) <> 'A'
		aCols := {}
	EndIf

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Recupera os valores e monta o xCols
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	xCols := "["
	nLenCols := len(aCols[nRecno])
	If nLenCols = 0
		xCols := ""
	EndIf
	For nI := 1 to nLenCols
		cValor := aCols[nRecno][nI]
		cCampo := aHeader[nRecno][nI]
		xCols += "{field:'"+cCampo+"', value:'" + cValor + "'} " + Iif( nLenCols != nI ,",","]" )
	Next nI

	cResult := "true|" + xCols + "|" +;
				Alltrim(Str(nRecno)) + "|" +;
				cGrid + "_RECNO" + "|" +;
				"bSave" + cGrid + "|"

EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLSETACMP  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o ЁResponsАvel pela manipulaГЦo dos grids das Guias no Portal     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSETACMP()
LOCAL cResult  	:= ""


LOCAL xCols		:= Separa ( HttpGet->cCols, "@" , .F.)

LOCAL aHeaderTmp	:=  {}
LOCAL aHeader	:=  {}
LOCAL aCols		:= {}
LOCAL aLinhaMarc	:= Separa ( HttpGet->aLinhas, "," , .F.) //Indica as linhas marcadas no grid
LOCAL aLinha		:= {}

LOCAL cGrid 		:= HttpGet->cGrid
LOCAL nPos			:= 0
LOCAL nPosNomExe	:= 0
LOCAL nI			:= 0
LOCAL nLinhas		:= 0
Local nCont			:= 0

LOCAL cSeqRefAtu := iif(type("HttpGet->cSeqRefAtu") <> "U" .and. !empty(HttpGet->cSeqRefAtu), HttpGet->cSeqRefAtu, "")
LOcal aAuxSeqRef := {}

LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

For nCont := 1 To Len(aLinhaMarc)
	If ValType(aLinhaMarc[nCont]) <> "N"
		aLinhaMarc[nCont] := Val(aLinhaMarc[nCont])	
	EndIf
Next nCont

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Encontra o objeto no array de campos
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Monta o aCols e aHeader
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//coloquei esse len do separa pois nos casos que a guia nao tem itens ainda dava error log,
//outras despesas por exemplo, pode nЦo ter itens gravados
If nPos > 0 .and. len(Separa( HttpGet->cHeader, "@" , .F.)) > 0
	//Adiciona coluna que indica se a linha deve ser pintada
	aAdd(aHeaderTmp,Separa (Separa ( HttpGet->cHeader, "@" , .F.)[1],"|",.F.))
	aAdd(aHeaderTmp[len(aHeaderTmp)],"Marca")

	//Reconstruo o aCols que foi passado pela pАgina
	nLinhas := len(xCols)
	For nI := 1 to nLinhas
		aLinha := Separa(xCols[nI],"|",.T.)
		//Verifica se a linha estА marcada no grid
		If aScan( aLinhaMarc, { |x| x == nI} ) > 0
			aAdd(aLinha, "0" ) //Marcada
		Else
			aAdd(aLinha, "1" ) //NЦo marcada
		EndIf
		aAdd(aHeader,aHeaderTmp[1])
		aAdd(aCols,aLinha)
	Next nI

	HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING := aClone(aHeader)
	HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING := aClone(aCols)
	
	if(!empty(cSeqRefAtu))
		cSeqRefAtu := Separa(cSeqRefAtu, "!")
		
		for nI := 1 to len(cSeqRefAtu)
			
			aAuxSeqRef := Separa(cSeqRefAtu[nI], "$")
			HttpSession->aCmpGuia[nPos]:cXCols := StrTran( HttpSession->aCmpGuia[nPos]:cXCols, "field:'nSeqRef', value:'" + aAuxSeqRef[1] + "'", "field:'nSeqRef', value:'" + aAuxSeqRef[2] + "'")	
		
		next nI
		
	endIf
	
	cResult := "true|"
Else
	cResult := "false|NЦo foi encontrado o grid especificado!"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLPROSAUD  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna as colunas e valores da linha do Grid                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROSAUD()

LOCAL nI			:= 0
LOCAL cResult  	:= ""
LOCAL cProSaud	:= ""
LOCAL oProSaud	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Recupera dados da pАgina
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cCombo := HttpGet->cCombo

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё obj																			Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametros																    Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cRdaCode	:= HttpGet->cRda
oObj:cCodLoc	:= HttpGet->cCodLoc

//Lista de profissional de saude
//Alterar posteriormente na reformulaГЦo da guia Odonto para o novo padrЦo.
If !HttpSession->cTp $ "1,2,3,4,5,11,12,6" .and. HttpSession->cTissVer < "3" .and. oObj:ProfSaud()
	oProSaud := oObj:oWSPROFSAUDRESULT:OWSLISTPROFSAUD:oWSPROFSAUD
	
	For nI := 1 To Len( oProSaud )
		cProSaud += oProSaud[nI]:cCODE + ";" + oProSaud[nI]:cNAME + "~"
	Next nI
EndIf

cResult := "true|" + cCombo + "|" + cProSaud + "|"

WEB EXTENDED END

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  PPLCHAANOP  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna as colunas e valores da linha do Grid                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLANOPM
LOCAL cHtml 	:= ""
LOCAL oObj	    := nil
LOCAL oObjRG    := nil
LOCAL nPosRda	:= 0
LOCAL cTISSVer	:= ""
LOCAL cRda		:= ""
LOCAL cCodLoc	:= ""
LOCAL aRDA		:= {}


WEB EXTENDED INIT cHtml START "InSite"
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE := "MSALPHA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta as variaves com o x3-combobox								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
if oObj:getCombo()
	HttpSession->cCodPad   	:= oObj:oWSGETCOMBORESULT:cCodPad
Endif

HttpSession->cTp := '09'
cHtml := ExecInPage( "PPLSSANO" )
WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  PPLCHAANRA  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna as colunas e valores da linha do Grid                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLANRAD
LOCAL cHtml 	:= ""
LOCAL oObj	    := nil
LOCAL oObjRG    := nil
LOCAL nPosRda	:= 0
LOCAL cTISSVer	:= ""
LOCAL cRda		:= ""
LOCAL cCodLoc	:= ""
LOCAL aRDA		:= {}

WEB EXTENDED INIT cHtml START "InSite"
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE := "MSALPHA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta as variaves com o x3-combobox								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
if oObj:getCombo()
	HttpSession->cCodPad   	:= oObj:oWSGETCOMBORESULT:cCodPad
Endif
HttpSession->cTp := '08'
HttpSession->cNumAut := If (HttpGet->cNumAut == Nil,"",HttpGet->cNumAut)

cHtml := ExecInPage( "PPLSSANR" )
WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLANQUI  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna as colunas e valores da linha do Grid                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLANQUI
LOCAL cHtml 	:= ""
LOCAL oObj	    := nil
LOCAL oObjRG    := nil
LOCAL nPosRda	:= 0
LOCAL cTISSVer	:= ""
LOCAL cRda		:= ""
LOCAL cCodLoc	:= ""
LOCAL aRDA		:= {}

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE := "MSALPHA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Alimenta as variaves com o x3-combobox								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
if oObj:getCombo()
	HttpSession->cCodPad   	:= oObj:oWSGETCOMBORESULT:cCodPad
Endif
HttpSession->cTp := '07'

cHtml := ExecInPage( "PPLSSANQ" )

WEB EXTENDED END

Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSANX Ё Autor Ё Daher				     Ё Data Ё 28.03.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Procura a liberacao e mostra os dados						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSANX()
local nI      	:= 0
local oObj	  	:= NIL
local lExibe  	:= .F.
local cResult 	:= "true|"
local cHtml 	:= ""
local cTipGui 	:= ""
local cCodUsr 	:= ""
local cCodRda 	:= ""
local cGuiRef 	:= ""
local cMatric 	:= ""
local cDatGui 	:= ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		 := "MSALPHA"
oObj:cNumAut   		 := AllTrim(StrTran(StrTran(HttpGet->cNumeAut,".",""),"-",""))
oObj:cTipo			 := HttpGet->cTp

//Resgatar a lista de RDA's e passar para o RetAutLib separadas por vМrgula.

oObj:cRDACode := StrTran(PLA09ASES(),"|M",",") 

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExecuta metodo para retorno da liberacao								   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:RetAutLib()
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁCabecalho															   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If !Empty(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProtoc)//Carrega numero do protocolo RN 395 da guia principal
	   		cResult +=	"B4A_REGANS!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRegAns+"|"+;		    //0
					"B4A_DATPRO!"+dtoc(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtAut)+"|"+; 		//1
					"B4A_NOMUSR!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeUsr+"|"+;		        //2
					"B4A_USUARI!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric+"|"+;      		//3
					"B4A_PESO!"+ AllTrim(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cPeso) +"|"+;       //4
					"B4A_ALTURA!"+ AllTrim(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cAltura) +"|"+;   //5
					"B4A_IDADE!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cIdade+"|"+;                //6
					"B4A_SEXO!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cSexo+"|"+;                  //7
					"cFormNumber!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumImp+"|"+;             //8 
					"B4A_PROATE!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cProtoc+"|<"               //9
		Else
			cResult +=	"B4A_REGANS!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cRegAns+"|"+;			//0
					"B4A_DATPRO!"+dtoc(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:dDtAut)+"|"+; 		//1
					"B4A_NOMUSR!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNomeUsr+"|"+;		        //2
					"B4A_USUARI!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric+"|"+;      		//3
					"B4A_PESO!"+ AllTrim(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cPeso) +"|"+;       //4
					"B4A_ALTURA!"+ AllTrim(oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cAltura) +"|"+;   //5
					"B4A_IDADE!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cIdade+"|"+;                //6
					"B4A_SEXO!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cSexo+"|"+;                  //7
					"cFormNumber!"+oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cNumImp+"|<"              //8 
		EndIf

		//Gravo os atributos necessarios para o metodo 'isDupGui'
		cTipGui := oObj:cTipo
		cCodUsr := oObj:cUserCode
		cCodRda := oObj:cRdaCode
		cGuiRef := oObj:cNumAut
		cMatric := oObj:OWSRETAUTLIBRESULT:OWSSCABGUI:cMatric
		cDatGui := DtoS(Date())
		
		// Parametros para retornar se a guia eh duplicada
		oObj:cUserCode			:= cCodUsr
		oObj:cRdaCode			:= cCodRda
		oObj:cTipGui			:= cTipGui	
		oObj:cUserCardNumber	:= cMatric
		oObj:cNumGuiRef			:= cGuiRef
		oObj:cDatGuia		 	:= cDatGui
		
		// Verifica se a guia pode estar sendo duplicada
		if oObj:isDupGui()
			cResult += "<" + SubStr(oObj:cIsDupGuiRESULT,6)
		endif

Else
		cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSCBTQ Ё Autor Ё Daher				     Ё Data Ё 28.03.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Procura a liberacao e mostra os dados						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSCBTQ

LOCAL nI      	:= 0
LOCAL oObj	  	:= NIL
LOCAL lExibe  	:= .F.
LOCAL cResult 	:= "true|"
LOCAL cHtml 	:= ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		 := "MSALPHA"
oObj:cChave   		 := HttpGet->cChkCpo
oObj:ccOpcao		 := HttpGet->cTab
oObj:ccCheckDePara	 := HttpGet->cCheckDePara
If !oObj:VldBTQChv()
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
Else
	cResult := "true|"+HttpGet->cCampoRef+"|"+oObj:OWSVldBTQChvRESULT:OWSSCABGUI:COBS
Endif

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSAUTANE Ё Autor Ё Daher				 Ё Data Ё 28.03.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Procura a liberacao e mostra os dados						 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSAUTANE()
LOCAL nI	  	:= 0
LOCAL nQtd		:= 0
LOCAL nPos	  	:= 0
LOCAL nPosRDA   := 0
LOCAL lPror		:= .F.
LOCAL cResult 	:= "true|"
LOCAL aMat 	  	:= {}
LOCAL oObj	  	:= Nil
LOCAL cString 	:= HttpGet->cString
LOCAL 	cHtml 	:= ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPega o conteudo														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If !Empty(cString)
	While ( nPos := At( "|", cString ) ) > 0
	    AaDd( aMat,SubStr( cString, 1, nPos-1 ) )
	    cString := SubStr( cString, nPos+1, Len(cString) )
	EndDo
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Verifica se foi enviado algum registro para tratamento				   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Len(aMat) >= 2
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Registro no WS														   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		oObj := WSPLSXFUN():New()
		WsChgURL( @oObj, "PLSXFUN.APW" )
		oObj:cUSERCODE := "MSALPHA"
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁMonta Matriz de itens ja executados									   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If Len(aMat) > 3

			oObj:oWSSAUTPROC:oWSAUTITEM := PLSXFUN_ARRAYOFAUTITEMVIEW():New()

		    For nI:=3 To Len(aMat)
		        If !Empty(aMat[nI])
					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//ЁMonta dados dos itens												   Ё
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					aMatIte := PPLSALIMA(aMat[nI]+'||')
					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//ЁAlimenta a estrutura para envio dos procedimentos ja executados		   Ё
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					AaDd( oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW, PLSXFUN_AUTITEMVIEW():New() )
					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//ЁQuantidade de itens													   Ё
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					nQtd := Len( oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW )
					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//ЁAtribui dados ao obj													   Ё
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cCODPAD 				:= AllTrim( PPLSERGET('B4C_CODPAD',aMatIte[1]) )
					oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cPROCEDURECODE 		:= AllTrim( PPLSERGET('B4C_CODPRO',aMatIte[1]) )
					oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:nPROCEDUREQUANTITY		:= Val( PPLSERGET('B4C_QTDPRO',aMatIte[1]) )
					oObj:oWSSAUTPROC:oWSAUTITEM:oWSAUTITEMVIEW[nQtd]:cSEQUENCE				:= aMat[1]
				EndIf
			Next
		EndIf
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Parametros de envio													   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		oObj:oWSSAUTPROC:cMatric 	:= HttpGet->cMatric
		oObj:oWSSAUTPROC:cTipGui 	:= HttpSession->cTp
		oObj:oWSSAUTPROC:dDatPro 	:= Date()
		oObj:oWSSAUTPROC:cSequen 	:= aMat[1]
		oObj:oWSSAUTPROC:cMatRet 	:= aMat[2]+"~"
		oObj:oWSSAUTPROC:cCid	 	:= HttpGet->cCid
		oObj:oWSSAUTPROC:cCodPad 	:= HttpGet->cCodPad
		oObj:oWSSAUTPROC:cCodPro 	:= HttpGet->cCodPro
		If ("," $ HttpGet->nQtdSol)
			nQtd := SEPARA(HttpGet->nQtdSol,",")[2]
			oObj:oWSSAUTPROC:nQtdPro 	:= Val(nQtd)
		Else
			oObj:oWSSAUTPROC:nQtdPro 	:= Val(HttpGet->nQtdSol)
		EndIf
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁExecuta o metodo pega o retorno										   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If oObj:AutAnexo()
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁSe foi autorizado ou negado											   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		    If oObj:oWSAutAnexoRESULT:lPROAUT
			   cResult += "1|"
			Else
			   cResult += "Critica(s)|"
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁMatriz que retorna os resultados formatados campo a campo do formulario		 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			cResult += oObj:oWSAutAnexoRESULT:cMatRetRes+"|"
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁMonta a string de retorno											   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			cResult += oObj:oWSAutAnexoRESULT:cAUTORI+"|"+;
					   oObj:oWSAutAnexoRESULT:cCHAVE+"|"+;
					   oObj:oWSAutAnexoRESULT:cNIVEL+"|"
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁMonta as criticas													   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			For nI:=1 To Len(oObj:oWSAutAnexoRESULT:oWSMATCRI:oWSGenericStruct)
				cResult += 	oObj:oWSAutAnexoRESULT:oWSMATCRI:oWSGenericStruct[nI]:cCode+" - "+;//0
							oObj:oWSAutAnexoRESULT:oWSMATCRI:oWSGenericStruct[nI]:cDescription//1
			Next
		Else
			cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
		EndIf
Else
	cResult := "false|Nenhum registro para tratamento"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLPRANEXO Ё Autor Ё Daher			     Ё Data Ё 07.03.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Processa as Guias											 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPRANEXO()
LOCAL nI,nY		  := 0
LOCAL nPos		  := 0
LOCAL oObj,oObjAux,oObjSex := NIL
LOCAL nIteAut     := 0
LOCAL nIteNeg     := 0
LOCAL nTmpDoe	  := 0
LOCAL nValTot	  := 0
LOCAL cResultCab  := "true|"
LOCAL cResultItem := ""
LOCAL cResultSenPr:= ""
LOCAL cEsp     	  := ""
LOCAL cNomeSol	  := ""
LOCAL cProExe     := ""
LOCAL cCodOpeExe  := ""
LOCAL cProSol     := ""
LOCAL cCodOpeSol  := ""
LOCAL cCid		  := ""
LOCAL cCid2		  := ""
LOCAL cCid3		  := ""
LOCAL cCid4		  := ""
LOCAL cCid5		  := ""
LOCAL cCbos		  := ""
LOCAL cTpCon 	  := ""
LOCAL cTpSai	  := ""
LOCAL cTpAteExe	  := ""
LOCAL cTpDoe	  := ""
LOCAL cTmpDoeC	  := ""
LOCAL cIndAcid	  := ""
LOCAL cNomeRda	  := ""
LOCAL cCnpjCpfSol := ""
LOCAL cCnesSol    := ""
LOCAL cCnesExe    := ""
LOCAL cCpfExe	  := ""
LOCAL cNumAut	  := ""
LOCAL cResult 	  := ""
LOCAL cTpAto	  := ""
LOCAL cTpFat 	  := ""
LOCAL cSequen	  := ""
LOCAL cCodTab	  := ""
LOCAL cCodPro	  := ""
LOCAL cDesPro	  := ""
LOCAL cDente	  := ""
LOCAL cFace	  	  := ""
LOCAL cQtdTot	  := ""
LOCAL cSenPro	  := ""
LOCAL cCritica	  := ""
LOCAL cQtdUs	  := ""
LOCAL cData		  := ""
LOCAL cSenhaAu	  := ""
LOCAL cTpIntern	  := ""
LOCAL cRegInter	  := ""
LOCAL cOrigem	  := "2"
LOCAL cStatus 	  := "1"
LOCAL cGrPar      := ""
LOCAL cCodSig 	  := ""
LOCAL cNumCr	  := ""
LOCAL cEstado 	  := ""
LOCAL cNomfExe	  := ""
LOCAL cUsuProc    := ""
LOCAL cSexo       := ""
LOCAL cTpAcom	  := ""
LOCAL cPadCon	  := ""
LOCAL cQtdDSol	  := ""
LOCAL cCnpjSolT	  := ""
LOCAL cDadInt	  := ""
LOCAL cResAut	  := ""
LOCAL cIndCliEvo  := ""
LOCAL cNumPeg	  := ""
LOCAL cVia  	  := ""
LOCAL cAbrang	  := ""
LOCAL cNatur	  := ""
LOCAL cDesGRP	  := ""
LOCAL lFemini		:= .F.
LOCAL lProGe		:= .F.
LOCAL lExecu		:= .F.
LOCAL lChkReg		:= .T.
LOCAL lInter		:= .F.
LOCAL lEvolu		:= .F.
LOCAL lHonor		:= .F.
LOCAL lResInt		:= .F.
LOCAL aMatIte		:= {}
LOCAL aRetProf		:= {}
LOCAL cStProc	  	:= ""
LOCAL cAtendRN		:= ""
LOCAL cTissVer	:= HttpSession->RDAVIEW[1]:cTissVer
LOCAL nJ			:= 0
LOCAL aMatGrp		:= {}
Local lTemProc := cTissVer < '3.03.00' .OR. HttpSession->cTp != "08" //radioterapia nЦo tem mais procedimentos a partir da tiss 3.03.00
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"


//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁSessao para impressao da guia										   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->aResult := {}
HttpSession->lSen 	 := .F.

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode		 := "MSALPHA"
oObj:cUserCardNumber := ""
oObj:cNumAut         := ""
oObj:cTipoAut        := "A"
oObj:cCampos         := "B4A_STATUS"
oObj:cTipo		     := HttpSession->cTp
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMonta o box de um determinado campo									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GetBox()
	aCBox := oObj:OWSGETBOXRESULT:OWSGENERICSTRUCT
EndIf

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё PLSXMOV																	 		  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXMOV():New()
WsChgURL( @oObj, "PLSXMOV.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Processa a guia																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"				//Usuario
oObj:nAUTTYPE	:= val(HttpSession->cTp)			//Tipo de guia consulta,sadt,internacao,Odonto
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Restante dos dados da guia														  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cOrigem 								:= cOrigem							//Se e para solicitar ou executar

oObj:oWSAUTHORIZATION  						:= PLSXMOV_AUTHORIZATIONVIEW():New()
oObj:oWSAUTHORIZATION:oWSAUTHEADER			:= PLSXMOV_AUTHEADERVIEW():New()

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cRegAns	:= HttpPost->B4A_REGANS
oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDatDia	:= If(HttpPost->B4A_DATDIA <> nil,ctod(HttpPost->B4A_DATDIA),ctod(''))
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cDiaImg	:= HttpPost->B4A_DIAIMG
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cEstadi	:= HttpPost->B4A_ESTADI
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cEcog	:= HttpPost->B4A_ECOG
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cFinAtd	:= HttpPost->B4A_FINALI
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cDiaGch	:= HttpPost->B4A_DIAGCH
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cGuiRef	:= AllTrim(StrTran(StrTran(HttpPost->B4A_GUIREF,".",""),"-",""))//Matricula
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cInfRel	:= HttpPost->B4A_INFREL
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCirurg	:= HttpPost->B4A_CIRURG
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cQuimio	:= HttpPost->B4A_QUIMIO
oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDatCir	:= If(HttpPost->B4A_DATCIR <> nil,ctod(HttpPost->B4A_DATCIR),ctod(''))
oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDatIrr	:= If(HttpPost->B4A_DATIRR <> nil,ctod(HttpPost->B4A_DATIRR),ctod(''))
oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDatqui	:= If(HttpPost->B4A_DATQUI <> nil,ctod(HttpPost->B4A_DATQUI),ctod(''))
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cNomfSol	:= HttpPost->B4A_NOMSOL
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cEmafSol	:= HttpPost->B4A_EMASOL
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTelfSol	:= HttpPost->B4A_TELSOL
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nNroCam	:= If(HttpPost->B4A_NROCAM <> nil,val(StrTran(HttpPost->B4A_NROCAM,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nDosDia	:= If(HttpPost->B4A_DOSDIA <> nil,val(StrTran(HttpPost->B4A_DOSDIA,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nDosTot	:= If(HttpPost->B4A_DOSTOT <> nil,val(StrTran(HttpPost->B4A_DOSTOT,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nNroDia	:= If(HttpPost->B4A_NRODIA <> nil,val(StrTran(HttpPost->B4A_NRODIA,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:dDatPre	:= If(HttpPost->B4A_DATPRE <> nil,ctod(HttpPost->B4A_DATPRE),ctod(''))
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cPlater	:= HttpPost->B4A_PLATER
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTipQui	:= HttpPost->B4A_TIPQUI
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nSupCor	:= If(HttpPost->B4A_SUPCOR <> nil,val(StrTran(HttpPost->B4A_SUPCOR,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nAltura	:= If(HttpPost->B4A_ALTURA <> nil,val(StrTran(HttpPost->B4A_ALTURA,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nPeso	:= If(HttpPost->B4A_PESO <> nil,val(StrTran(HttpPost->B4A_PESO,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCidPri 	:= HttpPost->B4A_CIDPRI
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCid2 	:= HttpPost->B4A_CIDSEC
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCid3 	:= HttpPost->B4A_CIDTER
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cCid4 	:= HttpPost->B4A_CIDQUA
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cEspMat	:= HttpPost->B4A_ESPMAT
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cObserv	:= HttpPost->B4A_OBSERV
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cJustTe	:= HttpPost->B4A_JUSTTE
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cAreaIr	:= HttpPost->B4A_AREA
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nNroCic	:= If(HttpPost->B4A_NROCIC <> nil,val(StrTran(HttpPost->B4A_NROCIC,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nCicAtu	:= If(HttpPost->B4A_CICATU <> nil,val(StrTran(HttpPost->B4A_CICATU,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nIntCic	:= If(HttpPost->B4A_INTCIC <> nil,val(StrTran(HttpPost->B4A_INTCIC,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nIdade	:= If(HttpPost->B4A_IDADE <> nil,val(StrTran(HttpPost->B4A_IDADE,",",".")),0)
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cSexo	:= HttpPost->B4A_SEXO

oObj:oWSAUTHORIZATION:oWSAUTHEADER:cTumor	:= HttpPost->B4A_TUMOR
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cNodulo	:= HttpPost->B4A_NODULO
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cMetast	:= HttpPost->B4A_METAST
oObj:oWSAUTHORIZATION:oWSAUTHEADER:nDCicAtu	:= If(HttpPost->B4A_DCICAT <> nil,val(StrTran(HttpPost->B4A_DCICAT,",",".")),0)

oObj:oWSAUTHORIZATION:oWSAUTHEADER:lChkReg 				:= .T.				   				//Se vai chegar regras ou nao
oObj:oWSAUTHORIZATION:oWSAUTHEADER:dProcedureDate		:= Date()							//Data do procedimento
oObj:oWSAUTHORIZATION:oWSAUTHEADER:cRegistrationNumber 	:= AllTrim(HttpPost->B4A_USUARI) //Matricula -- A MATANT pode ter traГos ou pontos e ai nЦo faz o seek


aMatIte := PPLSALIMA(HttpPost->cMatTabES)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁAlimenta a strutura ws com todos os itens do formulario genericamente   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:oWSAUTHORIZATION:oWSAUTITEM := PLSXMOV_ARRAYOFAUTITEMVIEW():New()

For nI:=1 To Len(aMatIte)

	AaDd( oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW, PLSXMOV_AUTITEMVIEW():New() )
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁAdiciona na strutura ws												   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cSEQUENCE 			:= StrZero( Val( AllTrim( PPLSERGET('cSeq',aMatIte[nI]) ) ), 3 )  //Sequencia
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cCODPAD 			:= AllTrim( PPLSERGET('cCodPad',aMatIte[nI]) )					  //Tabela
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cPROCEDURECODE 		:= AllTrim( PPLSERGET('cCodPro',aMatIte[nI]) )					  //Servico
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nPROCEDUREQUANTITY	:= Val( PPLSERGET('nQtdSol',aMatIte[nI]) )						  //Qtd Solicitada
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nQtdAut  			:= Val( PPLSERGET('nQtdAut',aMatIte[nI]) ) 						  //Qtd Autorizada
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:dDatPro				:= ctod( PPLSERGET('dDatPro',aMatIte[nI]) )
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cViaAdm				:= AllTrim( PPLSERGET('cViaAdm',aMatIte[nI]) )
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nFreque				:= val(AllTrim( PPLSERGET('cFreque',aMatIte[nI]) ))
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cRegAnv				:= AllTrim( PPLSERGET('cRegAnv',aMatIte[nI]) )
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cRefMat				:= AllTrim( PPLSERGET('cRefMaf',aMatIte[nI]) )
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cAutFun				:= AllTrim( PPLSERGET('cAutFun',aMatIte[nI]) )
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nVlrUnt				:= val( StrTran( StrTran(PPLSERGET('nVlrUnt',aMatIte[nI]), ".", ""), ",","") ) /100
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:nVlrTot				:= val( StrTran( StrTran(PPLSERGET('nVlrUna',aMatIte[nI]), ".", ""), ",","") ) /100
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cOpcao				:= AllTrim( PPLSERGET('cOpcao',aMatIte[nI]) )
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cViaAc				:= AllTrim( PPLSERGET('cViaAc',aMatIte[nI]) )	
	oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cUniMedC			:= AllTrim( PPLSERGET('cUniMed',aMatIte[nI]) )  
	
	If Type('oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW['+alltrim(str(nI))+']:cCodNeg') <> 'U'
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cCodNeg			:= AllTrim( PPLSERGET('cCodNeg',aMatIte[nI]) )						//Status do Procedimento
	Endif

	If Type('oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW['+alltrim(str(nI))+']:cStProc') <> 'U'
		oObj:oWSAUTHORIZATION:oWSAUTITEM:oWSAUTITEMVIEW[nI]:cStProc			:= AllTrim( PPLSERGET('cStatus',aMatIte[nI]) )						//Status do Procedimento
	Endif

Next
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Processa Guia																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GravaAnexo()
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Somente na internacao															  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Rda,Nome rda,Nome produto,Servico formatado,Numero da autorizacao,Senha e total	  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cResultCab +=	oObj:oWSGRAVAANEXORESULT:cNUMBER			+"|"+;	//0
			  		oObj:oWSGRAVAANEXORESULT:cPASSWORD		+"|"+;	//1
			  		DToC( Date() )									+"|"+;	//2
			  		DToC(oObj:oWSGRAVAANEXORESULT:dDtValSen)	+"|"+;  //3
			  		cDadInt+"||||||"						        //4
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Procedimentos autorizados														  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    cResultA := ""
    cResultN := ""
    If lTemProc
    	    
    For nI:=1 To Len(oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW)
	    nIteAut := 1
    	cSequen		:= oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSequence
    	cCodTab		:= oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cTableCode
    	cCodPro		:= oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cProcedureCode
    	cDesPro		:= StrTran(PadR(oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cDescription,55)," ","&nbsp;")
		cDente    	:= AllTrim(oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cDente)
		cDente    	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cDente),"&nbsp;&nbsp;&nbsp;&nbsp;",cDente ),"" )
		cFace     	:= AllTrim(oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cFace)
		cFace     	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cFace),"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",cFace ),"" )
		cQtdTot		:= StrZero(oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:nQtdTotal,4)

		cQtdUs      := AllTrim(Str(oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:nTotalUS))
		cData       := DtoC(Date())
		cSenhaAu    := oObj:oWSGRAVAANEXORESULT:cPASSWORD

		cSenPro		:= oObj:oWSGRAVAANEXORESULT:oWSAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSenha

		If (cCodTab+cCodPro) $ cUsuProc
			lProGe :=.T.
		Endif
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta Linha para retorno  em tela												  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		cResultA += cSequen+"&nbsp;"+cCodTab+"-"+cCodPro+" - "+cDesPro+" - "+cQtdTot+"<br>";
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Guia de Prorrogacao Senhas dos procedimentos									  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If !Empty(cSenPro)
			cResultSenPr += cSenPro+"@"
		EndIf
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta matriz para impressao de guia									  			  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        AaDd( HttpSession->aResult,{cSequen,cCodTab,cCodPro,cDesPro,cDente,cFace,cQtdTot,{},cQtdUs,cData,cSenhaAu,cSenPro,cDesGRP,cStProc} )
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se tem algum procedimento com senha									  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        If !Empty(cSenPro)
			HttpSession->lSen := .T.
        EndIf
    Next
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Procedimentos nao autorizados Obs (Nao precisa do if pq e a ultima implementacao) Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    For nI:=1 To Len(oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW)//10
   	    nIteNeg   	:= 1
    	aCritica 	:= {}
    	cSequen		:= oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSequence
    	cCodTab		:= oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cTableCode
    	cCodPro		:= oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cProcedureCode
    	cDesPro		:= StrTran(PadR(oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cDescription,55)," ","&nbsp;")
		cDente    	:= AllTrim(oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cDente)
		cDente    	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cDente),"&nbsp;&nbsp;&nbsp;&nbsp;",cDente ),"" )
		cFace     	:= AllTrim(oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cFace)
		cFace     	:= Iif(HttpSession->cTp=="4" , Iif( Empty(cFace),"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",cFace ),"" )
		cQtdTot		:= StrZero(oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:nQtdTotal,4)
		cQtdUs      := alltrim(Str(oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:nTotalUS))
		cData       := dtoc(date())
		cSenhaAu    := oObj:oWSGRAVAANEXORESULT:cPASSWORD
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta Linha para retorno de em tela												  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		cResultN += cSequen+"&nbsp;"+cCodTab+"-"+cCodPro+" - "+cDesPro+" - "+cQtdTot+"<br>";
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Procedimentos criticados														  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    For nY:= 1 To Len(oObj:oWSGRAVAANEXORESULT:oWSERROR:oWSAUTERRORVIEW)
	        If oObj:oWSGRAVAANEXORESULT:oWSNOTAUTHORIZED:oWSAUTHORIZEDVIEW[nI]:cSequence == oObj:oWSGRAVAANEXORESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cSequence

	            cCritica := WCTextNeg( oObj:oWSGRAVAANEXORESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cCode+" - "+oObj:oWSGRAVAANEXORESULT:oWSERROR:oWSAUTERRORVIEW[nY]:cDescription )
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Monta Linha para retorno em tela												  Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				cResultN +=	cCritica
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Monta matriz para impressao de guia									  			  Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    			AaDd(aCritica,cCritica )
			EndIf
	    Next
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Monta matriz para impressao de guia									  			  Ё
		//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
        AaDd( HttpSession->aResult,{cSequen,cCodTab,cCodPro,cDesPro,cDente,cFace,cQtdTot,aCritica,cQtdUs,cData,cSenhaAu,"",cDesGRP,cStProc} )
    Next
	Else
		nIteAut := 1
		nIteNeg := 0
		aCritica := {}
	EndIf
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Monta variaveis de sessao para impressao										  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	HttpSession->cNumeAut	:= Iif(lEvolu,cNumAut,oObj:oWSGRAVAANEXORESULT:cNUMBER)
	HttpSession->cSenha		:= Iif(lEvolu,"",oObj:oWSGRAVAANEXORESULT:cPASSWORD)
    HttpSession->cFormNumber:= HttpPost->cFormNumber

    cStatus := Iif( nIteAut == 1 .And. nIteNeg == 0,"1",Iif( nIteAut == 0 .And. nIteNeg == 1,"3","2") )
    
    If nIteAut == 0 .AND. nIteNeg == 0 //Guia de Radioterapia pode nЦo ter itens, daМ atualiza aqui.. talvez isso tenha que ser revisto no futuro
    	cStatus := "1"
    endIf

    If oObj:oWSGRAVAANEXORESULT:lAto .And. cStatus $ "1,2"
	    cStatus := "5"
	EndIf

	HttpSession->cTitulo := AllTrim(aCBox[Ascan( aCBox, {|x| x:cCODE == cStatus} )]:CDESCRIPTION)

	If nIteAut==1 .and. nIteNeg==0
		cResultA	:= ""
		cResultItem := cResultA
	EndIf

	If nIteNeg==1	.and. nIteAut==1
		cResultItem	:= cResultA+cResultN
	EndIf

	If nIteAut==0 .and. nIteNeg==1
		cResultItem	:= cResultN
	EndIf

	If oObj:oWSGRAVAANEXORESULT:lAudi <> Nil .AND. oObj:oWSGRAVAANEXORESULT:lAudi
		cResult := cResultCab + cResultItem + "|" + "Em AnАlise" + "|"
	Else
	cResult := cResultCab + cResultItem + "|" + HttpSession->cTitulo + "|"
	EndIf

    If lExecu .And. lFemini .And. lProge
		cResult += "SIM"
    Else
        cResult += "NAO"
    Endif

    cResult += "|" + cResultSenPr + "|"

Else
	cResult := "false|" + StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Retorna o valor de resposta da Session																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Web Function PPLRESDOCG()
Return PLSDECODE("true|" + HttpSession->cResDoc)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLINTERBE    Ё Autor Ё Thiago Guilherme	   Ё Data Ё 13/03/14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё 									                               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLINTERBE()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina de procedimentos				 						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

cHtml += ExecInPage( "PPLINTERABER" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLMATRIC    Ё Autor Ё Thiago Guilherme	   Ё Data Ё 13/03/14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna a matricula do beneficiario internado                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLMATRIC()
LOCAL cResult  	:= "true|"
LOCAL cRecno  := HttpGet->cRecno
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

HttpSession->cBtInterna := "1"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:CcRecno	:= cRecno

If HttpSession->cTipCar $ HttpSession->cBtIntern .OR. HttpSession->cBtIntern $ "2"

	If oObj:Matric()
		cResult += oObj:OWSMatricRESULT:OWSSMatric[1]:CMATRIC
	Else
		cResult := "false|"
	EndIf
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLRETINTR    Ё Autor Ё Thiago Guilherme	   Ё Data Ё 26/03/14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Utilizado para controlar utilizacao do botao interna          Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRETINTR()

LOCAL cResult := "true|"
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

HttpSession->cBtInterna := "0"

WEB EXTENDED END

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLB4DRGLO Ё Autor Ё Bruno Iserhardts     Ё Data Ё 14.05.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna informaГЦo o Recurso de Glosa para popular a guia     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLB4DRGLO()
Local cResult := ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInformacao do Recurso                                                   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpGet->cRecnoB4D) <> 'U'
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё obj                                                                         Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	oObj := WSPLRECGLO():New()
	WsChgURL( @oObj, "PLRECGLO.APW" )
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Parametros																          Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	oObj:cUSERCODE	:= "MSALPHA"
	oObj:cRecno	:= HttpGet->cRecnoB4D
	oObj:cVisDad	:= IIF(HttpGet->cOpc == "V","1","0") // se for somente visualizacao ou nao
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Dados do Recurso                                                       Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If oObj:GetRecGloB4D()
		cResult += "true|" + oObj:cGetRecGloB4DRESULT
	else
		cResult += "false"
	EndIf
Else
	cResult := "false"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina                                                           Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLPROCRGL Ё Autor Ё Bruno Iserhardt      Ё Data Ё 20.05.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Processa a Guia de Recurso de Glosa								Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROCRGL()

LOCAL cResult := ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё obj                                                                         Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLRECGLO():New()
WsChgURL( @oObj, "PLRECGLO.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametros																          Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cRecno	:= HttpPost->cRecnoB4D
oObj:cTipoGlosa	:= HttpPost->cTpRecGlo
oObj:cJustif	:= HttpPost->cMatJustif

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Dados do Recurso                                                       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:ProcJustfRecGlo()
	cResult += oObj:cProcJustfRecGloRESULT
else
	cResult += "false|"
EndIf

WEB EXTENDED END

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд	дддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCHARECG    Ё Autor ЁRogerio Tabosa	   Ё Data Ё 02.05.14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Chama determinado forumulario do atendimento					 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHARECG()
LOCAL cHtml 	:= ""
LOCAL oObj	    := nil
LOCAL oObjRG    := nil
LOCAL nPosRda	:= 0
LOCAL cTISSVer	:= "3.01.00"
LOCAL cRda		:= ""
LOCAL cCodLoc	:= ""
LOCAL aRDA		:= {}
LOCAL nI		:= 0
LOCAL nY		:= 0
LOCAL cResult	:= ""
LOCAL lDiagno	:= ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Aliemnta variavel de sessao											   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
HttpSession->cTp := "10"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Recupera a RDA e sua versЦo TISS						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cRda := HttpGet->cRda

nPosRDA := aScan( HttpSession->RDAVIEW, { |x| x:cCODE == cRda } )
If nPosRDA > 0
	aRDA := ClassDataArr(HttpSession->RDAVIEW[nPosRDA])
	If aScan(aRDA,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0
		cTISSVer := HttpSession->RDAVIEW[nPosRDA]:cTissVer
	EndIf
Else
	cTISSVer := HttpSession->RDAVIEW[1]:cTissVer
EndIf
HttpSession->cTISSVer := cTISSVer

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё CRIAR PAGINA PARA TISS 3.0													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If cTissVer >= "3"

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё oBJ
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Parametros
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj:cUserCode	:= "MSALPHA"
	oObj:oWSGUIATISS:cTipGui		:= "10" // Guia de Recurso de Glosa
	oObj:oWSGUIATISS:cVerTiss	:= cTISSVer

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Aqui eu pego o que vem de Session executo aqui pra enviar a informaГao
	// pro WS pois o mesmo nao acessa o conteudo da Session	dificultando o dinamismo
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If oObj:GetCmbFormT()
		// ATRIBUO OS PARAMETROS NOVAMENTE PARA UTILIZAгцO DO PROXIMO METODO
		oObj:cUserCode	:= "MSALPHA"
		oObj:oWSGUIATISS:cTipGui		:= STRZERO(val(HttpSession->cTp),2)
		oObj:oWSGUIATISS:cVerTiss	:= cTISSVer
		//oObj:oWSGUIATISS:OWSCMBGUIA	:= {}
		oObj:oWSGUIATISS:cDadCombo	:= ""
		If Len(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA) > 0 //oObj:OWSGETCMBFORMTRESULT:oWSRETCMBSGUIA
			For nI:=1 To Len(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA)
				cStrCBOX := ""
				If "HTTPSESSION" $ Upper(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)	 // Se for uma Session eu pego CCODE e CNAME e monto o Combo
					If ValType(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)) <> 'U'
						For nY := 1 To Len(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX))
							cStrCBOX += Alltrim(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cCODE")) + "=" + Alltrim(&(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cNAME")) + ";"
						Next nY
					EndIf
					If nY > 2
						cStrCBOX += ";="//cStrCBOX += ";=-- Selecione um item --"
					EndIf
				Else // Caso contrario eu pego a STRING com mesma estrutura do X3_COBX
					cStrCBOX := Alltrim(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCBOX)
				EndIf
				If SubStr(cStrCBOX, Len(cStrCBOX),1) == ";"
					cStrCBOX := SubStr(cStrCBOX, 1, Len(cStrCBOX)-1)
				EndIf
				oObj:oWSGUIATISS:cDadCombo	+= Alltrim(oObj:OWSGETCMBFORMTRESULT:OWSRETCMBSGUIA:OWSSRETCMBSGUIA[nI]:cCampoG) + ";" + cStrCBOX + "|"
				//WSDATA RetCmbsGuia	AS Array Of SRetCmbsGuia OPTIONAL
			Next
		EndIf
	EndIf
	If SubStr(oObj:oWSGUIATISS:cDadCombo, Len(oObj:oWSGUIATISS:cDadCombo),1) == "|"
		oObj:oWSGUIATISS:cDadCombo := SubStr(oObj:oWSGUIATISS:cDadCombo, 1, Len(oObj:oWSGUIATISS:cDadCombo)-1)
	EndIf

	oObj:cMsnBloInter	:= HttpSession->cMsnBloInt

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Retorna dados da pagina
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	oObj:cDtJs := iif(valtype(HttpSession->cDtJs) <> 'U', HttpSession->cDtJs, "")
	If oObj:GetFormTiss()
		cResult :=  oObj:OWSGETFORMTISSRESULT:cPagina
		If ValType(oObj:OWSGETFORMTISSRESULT:cGrids) == "C"
			HttpSession->cGrids := oObj:OWSGETFORMTISSRESULT:cGrids
		EndIf

		If ValType(oObj:OWSGETFORMTISSRESULT:OWSCMPGUIA:oWSSCmpGuia) == "A" /*/:OWSCMPGUIA:OWSSCMPGUIA)*/
			HttpSession->aCmpGuia := aClone(oObj:OWSGETFORMTISSRESULT:OWSCMPGUIA:oWSSCmpGuia)
		EndIf

		//Executa os inicializadores dos campos
		nIni := At("<%=",cResult)
		While  nIni > 0
			nFim := At("%>",cResult)
			cComando := SubStr(cResult,nIni+3,nFim - nIni-3)
			xResult := &(cComando)

			cTipResult := ValType(xResult)
			Do Case
				Case cTipResult == "D"
					xResult := DtoS(xResult)
					xResult := SubStr(xResult,7,2) + "/" + SubStr(xResult,5,2) + "/" + SubStr(xResult,1,4)
				Case cTipResult == "N"
					xResult := Alltrim(Str(xResult))
			EndCase

			cResult := StrTran ( cResult, "<%=" + cComando + "%>", xResult) //, nIni, 1)
			nIni := At("<%=",cResult)
		EndDo

	EndIf

	HttpSession->cPaginaGuia := Substr(cResult,At("|",cResult)+1,Len(cResult)) // Retiro o true| ou o false|

	cHtml += ExecInPage("PPLSGUIAS")
EndIf

WEB EXTENDED END

Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLRGVLD Ё Autor Ё Rogerio Tabosa      Ё Data Ё 20.05.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Valida inclusao de  Recurso de Glosa								Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRGVLD()
Local cResult := ""
Local cRda		:= ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё obj                                                                         Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLRECGLO():New()
WsChgURL( @oObj, "PLRECGLO.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametros																          Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cRecno	:= HttpGet->cRecnoB4D
cRda			:= HttpGet->cRda
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Dados do Recurso                                                       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:VldRecGlo()
	cResult += oObj:cVldRecGloRESULT
else
	cResult += "false|"
EndIf

WEB EXTENDED END

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)



/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLRGDEL Ё Autor Ё Rogerio Tabosa      Ё Data Ё 20.05.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Cancela um recurso de Glosa	  								Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRGDEL()
Local cResult := ""
Local cRda		:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё obj                                                                         Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLRECGLO():New()
WsChgURL( @oObj, "PLRECGLO.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametros																          Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cRecno	:= HttpGet->cRecno
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Dados do Recurso                                                       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:ExcRecGlo()
	cResult += oObj:cExcRecGloRESULT
else
	cResult += "false|"
EndIf

WEB EXTENDED END

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina																	  Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLTIPDOC    Ё Autor Ё Thiago Guilherme	    Ё Data Ё 09/01/14Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os tipos de documentos do reembolso no portal do
	beneficiarioЁ╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLTIPDOC()
LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//If HttpSession->MPortal == "000010"

oObj:cUserCode	:= "MSALPHA"
//oObj:cCUSRLOGIN	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE

//EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DadTipDoc()

	nResult := Len(oObj:OWSDadTipDocRESULT:OWSSDadTip)

	xCols := "["
	For nI := 1 to nResult

 		 xCols += "{"
  		 xCols +=  "0:{field:'cCod', value:'" + oObj:OWSDadTipDocRESULT:OWSSDadTip[nI]:cCod +   "'},"
  		 xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:OWSDadTipDocRESULT:OWSSDadTip[nI]:cDescri,1,25) + "'},"
  		 xCols +=  "2:{field:'cImgHelp',value:'" + oObj:OWSDadTipDocRESULT:OWSSDadTip[nI]:cImgHelp + "'},"
  		 xCols +=  "3:{field:'cObriga',value:'" + oObj:OWSDadTipDocRESULT:OWSSDadTip[nI]:cObriga + "'}"
 		 xCols +=  IIF( nResult != nI ,"},","}]" )
 	Next

 	If nResult == 0
  		xCols += "{"
  		xCols +=  "0:{field:'cCod', value:'01'},"
  		xCols +=  "1:{field:'cDescri',value:'Nota Fiscal'},"
  		xCols +=  "2:{field:'cImgHelp',value:''},"
  		xCols +=  "3:{field:'cObriga',value:'1'}}]"
 	EndIf

	cResult += xCols +"|"

Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPRDAREF  Ё Autor Ё Tabosa               Ё Data Ё 20.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna a RDA nao referenciada BK6 ao digitar o CPF/CNPJ   	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PRDAREF()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""
Local cMatric	:= ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCpfCnpj		:= HttpGet->cProSaud
oObj:cMatric		:= SubStr(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CBENEFI,1,14)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:RDARef()
	cResult += oObj:cRDARefRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGETCMP   Ё Autor Ё Thiago Ribas       Ё Data Ё 18.03.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna os campos do grid                                     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGCMP()
LOCAL oObj 		:= NIL

LOCAL nI			:= 0
LOCAL nLen			:= 0
LOCAL nPos			:= 0

LOCAL cResult  	:= ""
LOCAL cGrid		:= ""
LOCAL nOpc			:= ""
LOCAL cRecno		:= ""
LOCAL aObjSess	:= {} // Variaveis para criaГЦo de Grid generica
LOCAL aMntSess	:= {} 	// Variaveis para criaГЦo de Grid generica
LOCAL aCpoAtu		:= {} 	// Variaveis para criaГЦo de Grid generica
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Recupera nome do grid
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cGrid := HttpGet->cGrid
nOpc := HttpGet->nOpc
cRecno := HttpGet->nRecno
lBotao := HttpGet->lBotao
cSt		:= HttpGet->cSt // 1-Normal; 0-Marca a linha
cValores := HttpGet->cValores
cCampoDefault := HttpGet->cCampoDefault
cMontaSess := HttpGet->cMontaSess
cLarBrw 	:= HttpGet->cLarBrw
cAltBrw 	:= HttpGet->cAltBrw
cUpdReg	:= HttpGet->cUpdReg
cNoLpCamp	:= IIf(Empty(HttpGet->cNoLimpa), "", HttpGet->cNoLimpa)

If cRecno='undefined'
	cRecno := '0'
EndIf

If lBotao='undefined'
	lBotao := 'true'
EndIf

If cSt='undefined'
	cSt := '1'
EndIf

If cMontaSess='undefined'
	cMontaSess := ''
Else
	aMntSess := StrToArray(cMontaSess, "|")
EndIf

If cLarBrw='undefined'
	cLarBrw := '630'
EndIf

If cAltBrw='undefined'
	cAltBrw := '300'
EndIf

If cUpdReg='undefined'
	cUpdReg := '1'
EndIf

If cNoLpCamp='undefined'
	cNoLpCamp := ''
EndIf

// Para montagem do Grid especificado direto da pagina sem ir no WS
If !Empty(cMontaSess) .AND. ValType(HttpSession->aCmpGuia) == 'U'	//.AND. nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	oObj:cUSERCODE := "MSALPHA"

	AaDd( aObjSess, PLSXFUN_ARRAYOFSCMPGUIA():New() ) //aObjSess := PLSXFUN_ARRAYOFSCMPGUIA():New()

	nPos := Len(aObjSess)
	AaDd( aObjSess[nPos]:OWSSCMPGUIA, PLSXFUN_SCMPGUIA():New() )

	aObjSess[nPos]:OWSSCMPGUIA[1]:cTipo := 'G'
	aObjSess[nPos]:OWSSCMPGUIA[1]:cNome := cGrid
	aObjSess[nPos]:OWSSCMPGUIA[1]:cDescri := ""
	aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid := PLSXFUN_ARRAYOFSCMPGRID():NEW()

	aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols := PLSXFUN_ARRAYOFSTRING():NEW()
	aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader := PLSXFUN_ARRAYOFSTRING():NEW()

	aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols := PLSXFUN_ARRAYOFSTRING():NEW()
	aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader := PLSXFUN_ARRAYOFSTRING():NEW()

	//AaDd( aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols , PLSXFUN_ARRAYOFSTRING():NEW())
	//AaDd( aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader , PLSXFUN_ARRAYOFSTRING():NEW())
	aObjSess[nPos]:OWSSCMPGUIA[1]:cxCols := ""
	aObjSess[nPos]:OWSSCMPGUIA[1]:cxHeader := ""

	For nI := 1 To Len(aMntSess)
		aCpoAtu := StrToArray(aMntSess[nI],";") // FIELD_CAMPO (na pagina) | Descricao Coluna | Tipo
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		//Adiciona os campos da Grid
		//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд

		AaDd( aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:OWSSCmpGrid, PLSXFUN_SCMPGRID():NEW() )
		aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[nI]:cTipo := IIf(Len(aCpoAtu) >= 3,aCpoAtu[3],"C")
		aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[nI]:cNome := aCpoAtu[1]
		aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[nI]:cDescri := aCpoAtu[2]
	Next nI
	HttpSession->aCmpGuia := aClone(aObjSess[nPos]:OWSSCMPGUIA)
EndIf

//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Encontra o objeto no array de campos
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Monta o aCols e aHeader
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If nPos > 0

	cResult := "true|" +	 cGrid + "|" + nOpc + "|["
	nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)

	For nI := 1 to nLen
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		//Ё Verifica se foi informado funcao de tratamento na linha
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
		cResult += "'" + alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nI]:CNOME) + "'" + Iif( nLen != nI ,",","]|" )
	Next nI
	cResult += + cRecno + "|" + lBotao + "|" + cSt + "|"  + cValores + "|" + cCampoDefault + "|" + cLarBrw + "|" + cAltBrw + "|" + cUpdReg + "|" + cNoLpCamp + "|"
Else
	cResult := "false|NЦo foi encontrado o grid especificado!"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGETGRID  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 18.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o ЁResponsАvel pela manipulaГЦo dos grids das Guias no Portal     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGGRID()
LOCAL oObj 		:= NIL

LOCAL nI			:= 0
LOCAL nJ			:= 0
LOCAL nLen			:= 0
LOCAL nLenVal		:= 0
LOCAL nPos			:= 0
LOCAL nOpc 		:= 0
LOCAL nPosCols	:= 0
LOCAL nRecno		:= 0
LOCAL nLenCols	:= 0
LOCAL nQtdReg		:= 1
LOCAL nQtdPag 	:= 1
LOCAL nRegPagina 	:= 1

LOCAL cResult  	:= ""
LOCAL cGrid		:= ""
LOCAL xHeader 	:= "[{}]"
LOCAL xCols		:= ""

//Variaveis a utilizar posteriormente
LOCAL cPesquisa	:= ""
LOCAL cMsg			:= ""

LOCAL aCampos		:= Separa ( HttpGet->cCmp, "," , .T.)
LOCAL aValores	:= Separa ( HttpGet->cValores, "@" , .F.)
LOCAL aHeader		:= {}
LOCAL aCols		:= {}
LOCAL aLinha		:= {}

LOCAL cLinhas		:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
// HttpSession->aCmpGuia -> Guarda todos os campos/grids da Guia
// HttpSession->aCmpGuia[nPos] -> Trata-se da referЙncia a um campo ou grid
//
// HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING -> aHeader do Grid
// HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING -> aCols do Grid
//
// xCols e xHeader sЦo as strings que o JSPLS usarА para montar o grid
// aCols e aHeader sЦo os arrays que serЦo utilizados para manipular os campos
//por esta funГЦo
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Recupera dados da pАgina
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cGrid := HttpGet->cGrid
nRecno := HttpGet->nRecno
nOpc := Val(HttpGet->nOpc)
lBotao := HttpGet->lBotao
cSt := HttpGet->cSt
cValores	:= HttpGet->cValores
cUpdReg 	:= HttpGet->cUpdReg

If HttpSession->cLarGrd == NIL
	HttpSession->cLarGrd := HttpGet->cLarBrw
Endif

If HttpSession->cAltGrd == NIL
	HttpSession->cAltGrd := HttpGet->cAltBrw
Endif

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Encontra o objeto no array de campos
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Monta o aCols e aHeader
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If nPos > 0

	aHeader	:= HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING
	aCols		:= HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Verifica se o aCols e aHeader estЦo vazios
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If ValType(aHeader) <> 'A'
		aHeader := {}
		HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING := {}
	EndIf
	If ValType(aCols) <> 'A'
		aCols := {}
		HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING := {}
	EndIf

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Adiciona no aCols ou Posiciona na linha da alteraГЦo
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If nOpc == 3

		aAdd(aCols,{})
		aAdd(aHeader,{})
		nPosCols := Len(aCols)

	ElseIf nOpc == 4 .OR. nOpc == 5
		nPosCols := Val(nRecno)

	ElseIf nOpc == 6
		xCols := ""
		xHeader := "[{}]"
		nQtdReg := 0
		aCols := {}
		aHeader := {}
	EndIf

	If nPosCols > 0

		If nOpc == 5
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Exclui registro
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			If Len(aCols) > 0
				aDel(aCols,nPosCols)
				aSize(aCols,Len(aCols)-1)
				aDel(aHeader,nPosCols)
				aSize(aHeader,Len(aHeader)-1)
			EndIf

		Else
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Inicia o xHeader e o xCols
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			xHeader := "["

			If 	Empty(HttpSession->aCmpGuia[nPos]:CXCOLS)
				xCols := "[{"
			Else
				xCols := HttpSession->aCmpGuia[nPos]:CXCOLS
				xCols := Left(xCols,Len(xCols)-1) + ",{"
			EndIf

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Adiciona os botУes da linha e coloca o Recno
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			If cUpdReg == "0"
				xHeader += "{name:'Excluir'},"
				xCols += "0:{field:'RECNO', value:'0#" + AllTrim(Str(nPosCols)) + "," + cGrid + ".id,5,undefined,undefined,undefined,undefined,undefined,undefined, undefined, (0).toString()'},"

			Else
				xHeader += "{name:'Alterar'},"
				xCols += "0:{field:'RECNO', value:'0#" + AllTrim(Str(nPosCols)) + "," + cGrid + ".id,4'},"
				xHeader += "{name:'Excluir'},"
				xCols += "1:{field:'RECNO', value:'1#" + AllTrim(Str(nPosCols)) + "," + cGrid + ".id,5'},"
			EndIf

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Monta xHeader e xCols
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)
			nLenVal := len(aValores)
			For nI := 1 to nLenVal
				aLinha := Separa(aValores[nI],",",.F.)
				For nJ := 1 to nLen

					cCampo  := alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nJ]:CNOME)
					cTitulo := alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nJ]:CDESCRI)

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					//Ё Verifica se o campo jА tem algum valor
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					nPosVal := aScan(aLinha , { |x| cCampo $ x } )
					If nPosVal > 0
						cValor	 := Separa(aLinha[nPosVal],"$",.T.)[2]
					Else
						cValor := ""
					EndIf

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					//Ё Cabecalho
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					xHeader += "{name:'" + cTitulo + "'}" + Iif( nLen != nJ ,",","]" )

					If nOpc == 3  // Inclui registro

						aAdd(aCols[nPosCols],cValor)
						aAdd(aHeader[nPosCols],cCampo)
						If cUpdReg == "0"
							xCols += cValToChar((nJ)) + ":{field:'"+cCampo+"', value:'" + /*cBtnPos +*/ cValor + "'} " + Iif( nLen != nJ ,",","}]" )
						Else
							xCols += cValToChar((nJ+1)) + ":{field:'"+cCampo+"', value:'" + /*cBtnPos +*/ cValor + "'} " + Iif( nLen != nJ ,",","}]" )
						EndIf

					ElseIf nOpc == 4//Altera Registro

						aCols[nPosCols][nJ] := cValor

					EndIf
				Next nJ
				If nLen > 0 .AND. nOpc == 3
					aAdd(aCols[nPosCols],cSt)
					aAdd(aHeader[nPosCols],"Marca")
				EndIf
			Next nI
		EndIf
	EndIf

	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Se for alteraГЦo, reconstroi o xCols
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If nOpc == 4 .OR. nOpc == 5

		xHeader := "[{name:'Excluir'},"

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Monta xHeader e xCols
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)
			nLenVal := len(aValores)
			For nI := 1 to nLenVal
				For nJ := 1 to nLen

					cTitulo := alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nJ]:CDESCRI)

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					//Ё Cabecalho
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					xHeader += "{name:'" + cTitulo + "'}" + Iif( nLen != nJ ,",","]" )

				Next nJ
			Next nI

		nLenCols := Len(aCols)
		If nLenCols > 0
			xCols := "[{
			For nI := 1 to nLenCols

				If cUpdReg == "0"
					xCols += "0:{field:'RECNO', value:'0#" + AllTrim(Str(nI)) + "," + cGrid + ".id,5,undefined,undefined,undefined,undefined,undefined,undefined, undefined, (0).toString()'}," //BotЦo Excluir
				Else
					xCols += "0:{field:'RECNO', value:'0#" + AllTrim(Str(nI)) + "," + cGrid + ".id,2'}," //BotЦo Alterar
					xCols += "1:{field:'RECNO', value:'1#" + AllTrim(Str(nI)) + "," + cGrid + ".id,5'}," //BotЦo Excluir
				EndIf
				nLenHeader := Len(aHeader[nI])-1
				For nJ := 1 to nLenHeader
					xCols += cValToChar((nJ+1)) + ":{field:'"+ aHeader[nI][nJ]+ "', value:'" + aCols[nI][nJ] + "'} " + Iif( nLenHeader != nJ ,",","}" )
				Next nJ
				xCols += Iif( nLenCols != nI ,",{","]" )

			Next nI
			nQtdReg		:= 1
			nQtdPag 		:= 1
			nRegPagina 	:= 1
		Else
			xCols := ""
			xHeader := "[{}]"
			nQtdReg		:= 0
		EndIf

	EndIf
	//Indica que a linha deve ser marcada
	nLenCols := len(aCols)
	nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)
	For nI := 1 to nLenCols
		If aCols[nI][nLen+1] <> "1"
			cLinhas += AllTrim(str(nI))+"&"
		EndIf
	Next nI

	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Adiciona o xHeader e xCols ao array da session
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	HttpSession->aCmpGuia[nPos]:CXHEADER := xHeader
	HttpSession->aCmpGuia[nPos]:CXCOLS   := xCols
	HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING := aClone(aHeader)
	HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING := aClone(aCols)


	cResult := "true|" +;
				 cValToChar(nI-1) + "|" + ;
				 cValToChar(nQtdPag) + "|" + ;
				 cValToChar(nRegPagina) + "|" + ;
				 xHeader + "|" +	;
				 xCols + "|" + ;
				 cMsg + "|" + ;
				 "true"/* iIf(lContinua,'true','false')*/ + "|" + ;
				 "1"/*cValToChar(nPaginaAtu)*/ + "|" + ;
				 cPesquisa + "|" + ;
				 "true"/* iIf(lCSemafo,'true','false') */ + "|" + ;
				 cGrid + "|" + ;
				 AllTrim(Str(nOpc)) + "|" +;
				 HttpGet->cCmp + "|" +;
				 lBotao + "|" +;
				 cSt + "|" +;
				 cLinhas + "|" +;
				 HttpSession->cLarGrd + "|" +;
				 HttpSession->cAltGrd + "|" +;
				 cUpdReg + "|"
Else
	cResult := "false|NЦo foi encontrado o grid especificado!"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPLPUTREEMB  Ё Autor Ё Tabosa               Ё Data Ё 20.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Istancia o webservice para gravacao da solicitacao de reemb    Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PLPUTREEMB()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL nI			:= 0
LOCAL nSumTot		:= 0
LOCAL Arda			:= {}
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= HttpGet->cCODUSU
oObj:cCpfCnpj		:= HttpGet->cCODRDA
oObj:cMatUsu		:= HttpGet->cBENEF
oObj:dDatDoc		:= CTOD(HttpGet->cDTDOC)
oObj:cNomRdaNRef	:= HttpGet->cNOMRDA
oObj:cTelefone	:= StrTran(StrTran(HttpGet->cTELEFONE,"(",""),")","")

If !EMPTY(httpget->ccodrda)
	Arda := separa(HttpGet->cCODRDA)
EndIf

oObj:OWSITENSREEMB:OWSLISTDESP := PLSXFUN_ARRAYOFSITENSREEMB():New()

For nI := 1 To Len(HttpSession->aCmpGuia[1]:OWSACOLS:cString)
	AaDd( oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB, PLSXFUN_SITENSREEMB():New() )
	nQtd := Len( oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB )
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cCODPRO 	:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,7]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cCODRDA 	:= Arda[nI]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cEnviaRec 	:= ""
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cIsMedic 	:= IIf(HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,3] == "S", "1","0")
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cTipDoc    := HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,4]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cNroDoc 	:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,5]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cUsoC 		:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,3]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cVlrPro		:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,2]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cQTDPRO 	:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,8]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:dDatDoc		:= CTOD(HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,9])
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cEstd		:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,10]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cCodMun		:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,11]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cSeqRec		:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,12]
	oObj:OWSITENSREEMB:OWSLISTDESP:oWSSITENSREEMB[nQtd]:cNomRDA		:= HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,6]

	nSumTot += Val(HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,2] ) * Val(HttpSession->aCmpGuia[1]:OWSACOLS:cString[nI,8]) //Quantidade vezes valor
Next nI

oObj:cVlrApr		:= Alltrim(Str(nSumTot))

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁAtribui dados ao obj													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:PutReembBen()
	cResult += oObj:cPutReembBenRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCONREE   Ё Autor Ё Tabosa               Ё Data Ё 20.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da Rotina de Reembolso Portal beneficiario			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCONREE()
LOCAL cHtml 	:= ""
LOCAL cResult	:= ""
LOCAL oObjPar := nil

PRIVATE lMultComp	:= "false"
PRIVATE lBaixar	:= "0"
PRIVATE cCodSol := iif(valtype(HttpGet->cCodSol) <> "U", HttpGet->cCodSol, "")

PRIVATE cRDA := iif(valtype(HttpGet->cRdaNoRef) <> "U", HttpGet->cRdaNoRef, "") 
PRIVATE cNomePres := iif(valtype(HttpGet->cNomePres) <> "U", HttpGet->cNomePres, "")
PRIVATE cTipDoc := iif(valtype(HttpGet->cTipDoc) <> "U", HttpGet->cTipDoc, "")
PRIVATE cNumDoc := iif(valtype(HttpGet->cNumDoc) <> "U", HttpGet->cNumDoc, "")
PRIVATE cDatDoc := iif(valtype(HttpGet->cDatDoc) <> "U", HttpGet->cDatDoc, "")
PRIVATE cRecno := iif(valtype(HttpGet->cRecno) <> "U", HttpGet->cRecno, "")

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe pagina															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"

	oObjPar := WSCFGDICTIONARY():New()
	WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )
					
	oObjPar:cUSERCODE	:= "MSALPHA"
	oObjPar:cMVPARAM	:= "MV_PLREEMC"
	
	If oObjPar:GETPARAM()
		lMultComp := oObjPar:cGETPARAMRESULT
		If ValType(lMultComp) == 'U'
			lMultComp := "false"
		ElseIf	ValType(lMultComp) == 'C'
			If Type(lMultComp)=="L"
				If &(lMultComp)
					lMultComp := "true"
				Else
					lMultComp := "false"
				EndIf
			EndIf
		EndIf
	EndIf
	
	oObjPar:cMVPARAM	:= "MV_PLPDWN"
	If oObjPar:GETPARAM()
		lBaixar := oObjPar:cGETPARAMRESULT
		If ValType(lBaixar) == 'U'
			lBaixar := "0"
		ElseIf	ValType(lBaixar) == 'C'
			If Type(lBaixar)=="L"
				If &(lBaixar)
					lBaixar := "1"
				Else
					lBaixar := "0"
				EndIf
			EndIf
		EndIf
	EndIf

cHtml += ExecInPage("PPLCONREE")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLGDGRIDЁ Autor Ё Totvs 				 | Data Ё 24.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna dados para o browse gridData							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGDGRID()
LOCAL cResult  	:= "true|"
LOCAL cRdas		:= ""
LOCAL cUsuarios	:= ""
LOCAL oObj			:= NIL

LOCAL nI		:= 0
LOCAL nLen		:= IIf(Valtype(HttpSession->RDAVIEW) == "A", Len(HttpSession->RDAVIEW), 0 ) //Tratamento para a existencia das RDAs (a funГЦo eh chamada antes do login para consulta rede credenciada)
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Metodo e propriedades
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//HttpSession->RDAVIEW
For nI := 1 to nLen
	If !Empty(cRdas)
		cRdas += ","
	EndIf
	cRdas += "'" + HttpSession->RDAVIEW[nI]:cCodOpe + HttpSession->RDAVIEW[nI]:cCode +"'"
Next nI
//Tratamento para a existencia das RDAs (a funГЦo eh chamada antes do login para consulta rede credenciada)
If nLen > 0
	httpGet->cWhere += "|"+"Field_RDA=" + cRdas
EndIf
If Len(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA) > 0 //Essa verificaГЦo foi inserida, para casos em que o usuАrio logado ainda nЦo И beneficiАrio
	// Beneficiario Logado (Portal do beneficiario) --> Pega o principal pois tem apenas um login
	If ValType(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA) == "A"
		If ValType(httpGet->cUsuari) <> 'U'
			httpGet->cWhere += "|"+"Field_USUARI=" + httpGet->cUsuari

		Else
			For nI := 1 to Len(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA)
				If !Empty(cUsuarios)
					cUsuarios += ","
				EndIf
				cUsuarios += "'" + HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[nI]:cCode +"'"
			Next nI
			httpGet->cWhere += "|"+"Field_USUARI=" + cUsuarios
		EndIf
	EndIf
EndIf
oObj:cUserCode	:= "MSALPHA"
oObj:cFunName	:= httpGet->cFunName
If Type('HTTPSESSION->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:CCODE') == "U"
	oObj:cWhere 	:= httpGet->cWhere
else
	oObj:cWhere	:= httpGet->cWhere// + HTTPSESSION->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:CCODE
EndIf
oObj:cBuscaTReg	:= httpGet->cBuscaTReg
oObj:cPesquisa	:= iIf(valType(httpGet->cPesquisa)=='U',"",httpGet->cPesquisa)
oObj:cSemaforo	:= iIf(valType(httpGet->cSemaforo)=='U',"",httpGet->cSemaforo)
oObj:nPaginaIni	:= val(httpGet->nPagina)
oObj:cCamposCustom := iIf(valType(httpGet->cCampoCustom)=='U',"",httpGet->cCampoCustom)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Lista de faturas
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:getDadGrid()
	cResult +=	oObj:cGETDADGRIDRESULT
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLOBSPRT    Ё Autor Ё Thiago Guilherme	   Ё Data Ё 13/01/14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna a observaГЦo do protocolo selecionado             Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLOBSPRT()
LOCAL cResult  	:= "true|"
LOCAL cRecno  := HttpGet->cRecno
LOCAL nResult
LOCAL nI
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:CcRecno	:= cRecno
oObj:cTipo :=  iif(ValType(HttpGet->cTipo) <> "U", HttpGet->cTipo, "")

If oObj:OBSPROTOC()

	xCols := oOBJ:OWSOBSPROTOCRESULT:OWSSRETOBSPROT[1]:CcMsg

	cResult += xCols + "|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLMSGEXC    Ё Autor Ё Thiago Guilherme	   Ё Data Ё 13/01/14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna o motivo da exclusЦo do item no protocolo             Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLMSGEXC()
LOCAL cResult  	:= "true|"
LOCAL cRecno  := HttpGet->cRecno
LOCAL nResult
LOCAL nI
LOCAL cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:CcRecno	:= cRecno

If oObj:ExcItmReemb()

	xCols :=  oObj:OWSEXCITMREEMBRESULT:OWSSRETITEEX[1]:CcMsg
	cResult += xCols + "|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLEXCREE    Ё Autor Ё Rogerio Tabosa	      Ё Data Ё 18/03/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Exclui um item ou um reembolso 								     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEXCREE()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL cChave		:= iif(valtype(httpget->cChave) <> "U", httpget->cChave, "")
LOCAL cRecno		:= iif(valtype(httpget->cRecno) <> "U", httpget->cRecno, "")
LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:ccRecno		:= cRecno
oObj:cAlias		:= HttpGet->cAlias
oObj:cChave		:= cChave

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:ReembDelPI()
	cResult := oObj:cReembDelPIRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLRMBREC   Ё Autor Ё Tabosa               Ё Data Ё 20.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da Rotina de Reembolso Portal beneficiario			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRMBREC()
LOCAL cHtml 	:= ""
LOCAL cResult	:= ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe pagina															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"

cHtml += ExecInPage("PPLRMBREC")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁPPLATUBOW  ╨Autor  ЁTotvs               ╨ Data Ё  20/08/14   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁAtualiza BOW						   		    ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
*/
Web Function PPLATUBOW()
LOCAL cResult  	:= "true|"
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:CUsrCod	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE

If !oObj:AtuBow()
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETEST    Ё Autor Ё Thiago Guilherme	    Ё Data Ё 09/01/14Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os estados brasileiros no portal

╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETEST()
LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cTipo			:= HttpGet->cTipo
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADRETEST() .OR. oObj:DADRETSIGLACR()

	If oObj:DADRETEST()
		nResult := Len(oObj:OWSDADRETESTRESULT:OWSSDADEST)

		xCols := "["
		For nI := 1 to nResult

			xCols += "{"
			xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:OWSDADRETESTRESULT:OWSSDADEST[nI]:CDESCRI,1,15) +"'}" + Iif( nResult != nI ,"},","}]" )
		Next

		cResult += xCols +"|"
	EndIF

	If oObj:DADRETSIGLACR()

		nResult := Len(oObj:OWSDADRETSIGLACRRESULT:OWSSDADSIGLACR)

		xCols := "["
		For nI := 1 to nResult

			xCols += "{"
			xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:OWSDADRETSIGLACRRESULT:OWSSDADSIGLACR[nI]:CDESCRI,1,15) +"'}" + Iif( nResult != nI ,"},","}]" )
		Next

		cResult += xCols +"|"
	EndIF

Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLRETGEN    Ё Autor Ё Rogerio Tabosa	      Ё Data Ё 18/03/13 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os dados de uma tabela qualquer passada por param     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRETGEN()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCRecno		:= HttpGet->cRecno
oObj:cAlias		:= HttpGet->cAlias
oObj:cCampos		:= HttpGet->cCampos

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GetDadGen()
	cResult := oObj:cGetDadGenRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLEXPSEN   Ё Autor Ё Totvs                Ё Data Ё 20.05.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica se exibe mensagem de Expirar Senha				     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEXPSEN()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cPLSCodUsr	:= getUsrWeb()
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:SenhaExp()
	cResult := oObj:cSenhaExpRESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLDESPRO  Ё Autor Ё Thiago               Ё Data Ё 20.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna a descriГЦo do procedimento a partir do codigo   	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLDESPRO()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCodPro		:= HttpGet->cCodPro
oObj:cClasse		:= HttpGet->cClasse

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DesProc()
	cResult += oObj:cDesProcRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPTrGdLib    Ё Autor Ё Rogerio Tabosa	      Ё Data Ё 18/09/14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Trata a session de valores do grid ao chamar uma liberaГЦo    Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PTrGdLib(cValores,cGrid,nOpc,lAtuVisibl,lDelVisibl)

LOCAL nI			:= 0
LOCAL nJ			:= 0
LOCAL nLen			:= 0
LOCAL nLenVal		:= 0
LOCAL nPos			:= 0
LOCAL nPosCols		:= 0
LOCAL nRecno		:= 0
LOCAL nLenCols		:= 0
LOCAL nQtdReg		:= 1
LOCAL nQtdPag 		:= 1
LOCAL nRegPagina 	:= 1

LOCAL cResult  	:= ""
LOCAL xHeader 	:= "[{}]"
LOCAL xCols		:= ""

//Variaveis a utilizar posteriormente
LOCAL cPesquisa	:= ""
LOCAL cMsg			:= ""

//LOCAL aCampos		:= Separa ( HttpGet->cCmp, "," , .T.)
LOCAL aValores	:= Separa ( cValores, "@" , .F.)
LOCAL aHeader		:= {}
LOCAL aCols		:= {}
LOCAL aLinha		:= {}

LOCAL cLinhas		:= ""
LOCAL nNumAux		:= -1
LOCAL cSt := "1"
Default  lAtuVisibl	:= .T.
Default  lDelVisibl	:= .T.
Default  nOpc			:= 3
Default cGrid		:= ""

If ValType(HttpSession->aCmpGuia) == "U"
	Return()
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Encontra o objeto no array de campos
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Monta o aCols e aHeader
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If nPos > 0

	aHeader	:= HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING
	aCols	:= HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Verifica se o aCols e aHeader estЦo vazios
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If ValType(aHeader) <> 'A'
		aHeader := {}
		HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING := {}
	EndIf
	If ValType(aCols) <> 'A'
		aCols := {}
		HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING := {}
	EndIf

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Adiciona no aCols ou Posiciona na linha da alteraГЦo
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If nOpc == 3

		aAdd(aCols,{})
		aAdd(aHeader,{})
		nPosCols := Len(aCols)

	ElseIf nOpc == 4 .OR. nOpc == 5
		nPosCols := Iif(ValType(nRecno) == "N", nRecno, Val(nRecno) )

	ElseIf nOpc == 6
		xCols := ""
		xHeader := "[{}]"
		nQtdReg := 0
		aCols := {}
		aHeader := {}
	EndIf

	If nPosCols > 0

		If nOpc == 5
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Exclui registro
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			If Len(aCols) > 0
				aDel(aCols,nPosCols)
				aSize(aCols,Len(aCols)-1)
				aDel(aHeader,nPosCols)
				aSize(aHeader,Len(aHeader)-1)
			EndIf

		Else
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Inicia o xHeader e o xCols
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			xHeader := "["

			If 	Empty(HttpSession->aCmpGuia[nPos]:CXCOLS)
				xCols := "["
			Else
				xCols := HttpSession->aCmpGuia[nPos]:CXCOLS
				xCols := Left(xCols,Len(xCols)-1) + ","
			EndIf

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			//Monta xHeader e xCols
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
			nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)
			nLenVal := len(aValores)
			For nI := 1 to nLenVal
				aLinha := Separa(aValores[nI],";",.F.)
				nNumAux := -1
				If Len(aCols) < nPosCols+nI-1
					aAdd(aCols,{})
					aAdd(aHeader,{})
				EndIf
				For nJ := 1 to nLen

					If nJ == 1
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
						//Adiciona os botУes da linha e coloca o Recno
						//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
						If (lAtuVisibl == .T.) .OR. (lDelVisibl == .T.)
							xCols += "{"
						EndIf
						If (lAtuVisibl == .T.)
							If nI == 1
								xHeader += "{name:'Alterar'},"
							EndIf
							nNumAux++
							//xCols += "{"
							xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'0#" + AllTrim(Str(nPosCols+nI-1)) + "," + cGrid + ".id,4'},"
						EndIf
						If (lDelVisibl == .T.)
							If nI == 1
								xHeader += "{name:'Excluir'},"
							EndIf
							nNumAux++
							//xCols += "{"
							xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'1#" + AllTrim(Str(nPosCols+nI-1)) + "," + cGrid + ".id,5,true," + '""' + " ," + '""' + " ,cCampoDefault'}," //BotЦo Excluir
						EndIf
					EndIf

					cCampo  := alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nJ]:CNOME)
					cTitulo := alltrim(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID[nJ]:CDESCRI)

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					//Ё Verifica se o campo jА tem algum valor
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					nPosVal := aScan(aLinha , { |x| cCampo $ x } )

					If nPosVal > 0
					
						If cCampo == "cProExe" .And. Separa(aLinha[nPosVal],"!",.T.)[1] == "cProExe"
							cValor	 := Separa(aLinha[nPosVal],"!",.T.)[2]
						Else
							cValor	 := Separa(aLinha[nPosVal],"$",.T.)[2]
						EndIf
							
					Else
						cValor := ""
					EndIf

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					//Ё Cabecalho
					//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					If nI == 1
						xHeader += "{name:'" + cTitulo + "'}" + Iif( nLen != nJ ,",","]" )
					EndIf

					If nOpc == 3  // Inclui registro

						aAdd(aCols[nPosCols+nI-1],cValor)
						aAdd(aHeader[nPosCols+nI-1],cCampo)
						nNumAux++
						xCols += cValToChar(nNumAux) + ":{field:'"+cCampo+"', value:'" + /*cBtnPos +*/ cValor + "'} "

						If nLen != nJ
							xCols += ","
						Else
							xCols += "}"
							If nI != nLenVal
								xCols += ","
							Else
								xCols += "]"
							EndIf
						EndIf
					ElseIf nOpc == 4//Altera Registro

						aCols[nPosCols][nJ] := cValor

					EndIf
				Next nJ
				If nLen > 0
					If nOpc == 3
						aAdd(aCols[nPosCols+nI-1],cSt)
						aAdd(aHeader[nPosCols+nI-1],"Marca")
					ElseIf nOpc == 4
						aCols[nPosCols][len(aCols[nPosCols])] := cSt
					EndIf
				EndIf
			Next nI
		EndIf
	EndIf

	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Se for alteraГЦo, reconstroi o xCols
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If nOpc == 4 .OR. nOpc == 5
		nLenCols := Len(aCols)
		If nLenCols > 0
			xCols := "[{
			For nI := 1 to nLenCols
				nNumAux = -1
				If (lAtuVisibl == .T.)
					nNumAux++
					xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'0#" + AllTrim(Str(nI)) + "," + cGrid + ".id,2'}," //BotЦo Alterar
				EndIf
				If (lDelVisibl == .T.)
					nNumAux++
					xCols += cValToChar(nNumAux) + ":{field:'RECNO', value:'1#" + AllTrim(Str(nI)) + "," + cGrid + ".id,5,true," + '""' + " ," + '""' + " ,cCampoDefault'}," //BotЦo Excluir
				EndIf
				nLenHeader := Len(aHeader[nI])-1	//,true,cCampo.value,"",cCampoDefault.replace(/\|/g,",")
				For nJ := 1 to nLenHeader
					nNumAux++
					xCols += cValToChar(nNumAux) + ":{field:'"+ aHeader[nI][nJ]+ "', value:'" + aCols[nI][nJ] + "'} " + Iif( nLenHeader != nJ ,",","}" )
				Next nJ
				xCols += Iif( nLenCols != nI ,",{","]" )

			Next nI
			nQtdReg		:= 1
			nQtdPag 		:= 1
			nRegPagina 	:= 1
		Else
			xCols := ""
			xHeader := "[{}]"
			nQtdReg		:= 0
			//nQtdPag 	:= 0
			//nRegPagina 	:= 0
		EndIf

	EndIf
	//Indica que a linha deve ser marcada
	nLenCols := len(aCols)
	nLen := len(HttpSession->aCmpGuia[nPos]:OWSCMPGRID:OWSSCMPGRID)
	For nI := 1 to nLenCols
		If aCols[nI][nLen+1] <> "1"
			cLinhas += AllTrim(str(nI))+"&"
		EndIf
	Next nI

	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Adiciona o xHeader e xCols ao array da session
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	HttpSession->aCmpGuia[nPos]:CXHEADER := xHeader
	HttpSession->aCmpGuia[nPos]:CXCOLS   := xCols
	HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING := aClone(aHeader)
	HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING := aClone(aCols)
EndIf

Return

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PVldNGui
Verifica se a guia principal digitada existe

@Project
@version	P12

/*/
//---------------------------------------------------------------------------------------
Web Function PVldNGui()
Local cResult := ""
Local oObj    := Nil
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUSERCODE 	:= "MSALPHA"
oObj:cTipGui	:= HttpGet->TipGui
oObj:cNumAut   := StrTran(StrTran(HttpGet->NumAut,".",""),"-","")

If oObj:VLNUMGUI()
	cResult := oObj:CVLNUMGUIRESULT
Else
	cResult :=  "false|Erro na tentativa de localizar a guia!"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLDOC Ё Autor Ё TOTVS              Ё Data Ё 13/05/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Consulta o(s) contrato(s) e/ou aditivo(s)    		    		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDOC()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLDOC")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLDELAT    ?Autor ?Karine Riquena	      ?Data ?27/11/14 Ё╠?
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao ?Exclui o atalho da barra de atalhos do portal                 Ё╠?
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDELAT()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL nI := 1
LOCAL nTamI
LOCAL aAtalho     := {}
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

aAtalho := HttpSession->ATAVIEW
nTamI := Len(aAtalho)
lAchou := .F.
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
//?oBJ
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
//?Parametros
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
oObj:cUserCode	:= "MSALPHA"
oObj:cCodMenu		:= HttpGet->cCodMnu
oObj:cUsrCod		:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
//?Retorna dados
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
If oObj:DelAtalho()
	cResult := oObj:cDelAtalhoRESULT
EndIf

If  "true" $ cResult
	While nI <= nTamI .and. !lAchou
	    If(aAtalho[nI][1] == HttpGet->cCodMnu)
	       	ADEL(HttpSession->ATAVIEW , nI)
	       	nTamI--
	       	ASIZE(HttpSession->ATAVIEW, nTamI)
	       	lAchou := .T.
		EndIf
	   nI++
	EndDo

	aAtalho = HttpSession->ATAVIEW
	For nI := 1 To Len(aAtalho)
		cResult += "@" + aAtalho[nI][1] + "|" +  aAtalho[nI][2] + "|" + aAtalho[nI][3] + "|" + aAtalho[nI][4] + "|" + aAtalho[nI][5] + "|"
	Next nI
EndIf

WEB EXTENDED END
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
//?Fim da rotina
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGETIMG  ?Autor ?Karine Riquena        ?Data ?02.12.2014 Ё╠?
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o ?DiretСrio de imagens do servidor 								    Ё╠?
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLGETIMG(cCodMnu)
LOCAL cResult  := "true|"
LOCAL cDir	 	:= getWebDir()
LOCAL aFiles	:= {}
LOCAL nI := 0
LOCAL nTpPor	:= 0
LOCAL cMenu := HttpGet->cCodMnu
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

nTpPor	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:nTpPortal

If !Empty(cDir)
    //verificar tipo de portal do usuario logado
    If nTpPor == 1
		cDir := cDir + getPrtSkin() + "\atalhos_portal\prestador\"
	Else
	    cDir := cDir + getPrtSkin() + "\atalhos_portal\empbenef\"
	EndIf
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
	//ЁLe diretorio para mostrar os arquivos disponiveis
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
	aFiles := DIRECTORY(cDir+"*.png")

	If Len(aFiles) <= 0
		cResult  :=  "true|Nofile"+cMenu
	Else
	    cResult += cMenu + "|" + Alltrim(STR(nTpPor)) + "|"
	EndIf

Else
	cResult  := "true|Nodirectory"
EndIf

For nI := 1 To Len(aFiles)
	cResult += aFiles[nI][1] + "|"
Next nI

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//?Fim da rotina														   ?
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLADDAT    ?Autor ?Karine Riquena	      ?Data ?27/11/14 Ё╠?
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao ?Adiciona o atalho da barra de atalhos do portal                 Ё╠?
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLADDAT()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL nI
LOCAL nTamI
LOCAL aString
LOCAL nCount := 0
LOCAL nNewTamI
LOCAL nTamY
LOCAL nY := 0
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
//?oBJ
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
//?Parametros
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
oObj:cUserCode	:= "MSALPHA"
oObj:cCodMenu		:= HttpGet->cCodMnu
oObj:cUsrCod		:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
oObj:cCamImg      := HttpGet->cCamImg
oObj:nCodPor      := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:nTpPortal
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
//?Retorna dados
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
If oObj:AddAtalho()
	cResult := oObj:cADDATALHORESULT
EndIf


  aString := strtokarr (cResult, "|")
  ADEL(aString, 1)
  ASIZE(aString, 5)

			If  "true" $ cResult
			   AADD(HttpSession->ATAVIEW, { AllTrim(aString[1]), AllTrim(aString[2]), AllTrim(aString[3]), AllTrim(aString[4]), AllTrim(aString[5]) })
			EndIf
			
WEB EXTENDED END

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
//?Fim da rotina
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд?
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCADGEN    Ё Autor Ё Rogerio Tabosa	   Ё Data Ё 02.02.15 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Pagina de cadastro de paginas genericas						   Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCADGEN()
LOCAL cHtml 	:= ""
LOCAL oObj	    := nil
LOCAL oObjRG    := nil
LOCAL nI		:= 0
LOCAL nY		:= 0
LOCAL nJ 		:= 0
LOCAL cResult	:= ""
LOCAL cLayout	:= ""
LOCAL cRecno  := ""
LOCAL xCols   := ""
LOCAL xHeader := ""
LOCAL cChave := Alltrim(HttpGet->cChave)

WEB EXTENDED INIT cHtml START IIF(cChave == "PLSCREDPF" .OR. cChave == "PLSCREDPJ", "","InSite")

HttpSession->xDataAux := IIF( ValType( HttpGet->cDataAux ) == "C", HttpGet->cDataAux, "")

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLCADWEB():New()
WsChgURL( @oObj, "PLCADWEB.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

If ValType(HttpGet->cChave) <> "U"  //nas versoes 3.xx.xx esse cara vem preenchido
	cLayout := Alltrim(HttpGet->cChave)
EndIf

If ValType(HttpGet->cRecno) <> "U"  //nas versoes 3.xx.xx esse cara vem preenchido
	cRecno := Alltrim(HttpGet->cRecno)
EndIf

oObj:cUSERCODE	:= "MSALPHA"
oObj:oWSDataForm:cChaveLay	:= cLayout // Unidade de medida
oObj:oWSDataForm:cRecnoReg := cRecno

If oObj:GetCmbForm()
	// ATRIBUO OS PARAMETROS NOVAMENTE PARA UTILIZAгцO DO PROXIMO METODO
	oObj:cUserCode	:= "MSALPHA"
	oObj:oWSDataForm:cChaveLay	:= cLayout // Unidade de medida
	oObj:oWSDataForm:cDadCombo	:= ""
	oObj:oWSDataForm:cRecnoReg := cRecno
	If Len(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS) > 0 //oObj:OWSGETCMBFORMTRESULT:oWSRETCMBSGUIA
		For nI:=1 To Len(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS)
			cStrCBOX := ""
			If "HTTPSESSION" $ Upper(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS[nI]:cCBOX)	 // Se for uma Session eu pego CCODE e CNAME e monto o Combo
				If ValType(&(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS[nI]:cCBOX)) <> 'U'
					For nY := 1 To Len(&(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS[nI]:cCBOX))
						cStrCBOX += Alltrim(&(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cCODE")) + "=" +;
						 Alltrim(&(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS[nI]:cCBOX + "[" + Alltrim(Str(nY)) + "]:cNAME")) + ";"
					Next nY
				EndIf
				If nY > 2
					cStrCBOX += ";="//cStrCBOX += ";=-- Selecione um item --"
				EndIf
			Else // Caso contrario eu pego a STRING com mesma estrutura do X3_COBX
				cStrCBOX := Alltrim(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS[nI]:cCBOX)
			EndIf
			If SubStr(cStrCBOX, Len(cStrCBOX),1) == ";"
				cStrCBOX := SubStr(cStrCBOX, 1, Len(cStrCBOX)-1)
			EndIf
			oObj:oWSDataForm:cDadCombo	+= Alltrim(oObj:OWSGETCMBFORMRESULT:OWSRETCMBS:OWSSRETCMBS[nI]:cCampoG) + ";" + cStrCBOX + "|"
			//WSDATA RetCmbsGuia	AS Array Of SRetCmbsGuia OPTIONAL
		Next
	EndIf

	If SubStr(oObj:oWSDataForm:cDadCombo, Len(oObj:oWSDataForm:cDadCombo),1) == "|"
		oObj:oWSDataForm:cDadCombo := SubStr(oObj:oWSDataForm:cDadCombo, 1, Len(oObj:oWSDataForm:cDadCombo)-1)
	EndIf
 	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	//Ё Retorna dados da pagina
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
	If oObj:GetForm()
		cResult :=  oObj:OWSGETFORMRESULT:cPagina
		If ValType(oObj:OWSGETFORMRESULT:cGrids) == "C"
			HttpSession->cGrids := oObj:OWSGETFORMRESULT:cGrids
		EndIf


		If ValType(oObj:OWSGETFORMRESULT:OWSCMPS:oWSSCmps) == "A" /*/:OWSCMPGUIA:OWSSCMPGUIA)*/
			HttpSession->aCmpGuia := aClone(oObj:OWSGETFORMRESULT:OWSCMPS:oWSSCmps)
		EndIf

		If ValType(oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS) == "A" .AND. len(oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS) > 0

			For nI := 1 to Len(oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS)
				cGrid := oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS[nI]:cGrid
				xCols := oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS[nI]:cXCols
				xHeader := oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS[nI]:cXHeader

				nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == cGrid} )

				If nPos > 0

					aHeader	:= HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING
					aCols		:= HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING

					HttpSession->aCmpGuia[nPos]:CXCOLS := xCols
					HttpSession->aCmpGuia[nPos]:CXHEADER := xHeader

					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					//Verifica se o aCols e aHeader estЦo vazios
					//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
					If ValType(aHeader) <> 'A'
						aHeader := {}
						HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING := {}
					EndIf
					If ValType(aCols) <> 'A'
						aCols := {}
						HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING := {}
					EndIf

					For nJ := 1 to Len(oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS[nI]:OWSAHEADER:OWSSSTRGRID)
						aAdd(HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING, oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS[nI]:OWSAHEADER:OWSSSTRGRID[nJ]:OWSVALORES:CSTRING)
						aAdd(HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING, oObj:OWSGETFORMRESULT:OWSCONTGRID:OWSAGRIDS[nI]:OWSACOLS:OWSSSTRGRID[nJ]:OWSVALORES:CSTRING)
					Next nJ

				EndIf

			Next nI
		EndIf

		//Executa os inicializadores dos campos
		nIni := At("<%=",cResult)
		While  nIni > 0
			nFim := At("%>",cResult)
			cComando := SubStr(cResult,nIni+3,nFim - nIni-3)
			xResult := &(cComando)

			cTipResult := ValType(xResult)
			Do Case
				Case cTipResult == "D"
					xResult := DtoS(xResult)
					xResult := SubStr(xResult,7,2) + "/" + SubStr(xResult,5,2) + "/" + SubStr(xResult,1,4)
				Case cTipResult == "N"
					xResult := Alltrim(Str(xResult))
			EndCase

			cResult := StrTran ( cResult, "<%=" + cComando + "%>", xResult) //, nIni, 1)
			nIni := At("<%=",cResult)
		EndDo

	EndIf

	HttpSession->cPaginaForm := Substr(cResult,At("|",cResult)+1,Len(cResult)) // Retiro o true| ou o false|

EndIf

cHtml += ExecInPage("PPLCADGEN")

WEB EXTENDED END

Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCONPRO Ё Autor Ё TOTVS                 Ё Data Ё 27/05/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Consulta o(s) protocolos de indicaГУes de profissionais  	Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCONPRO()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCONPRO")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLSolCon 	  Ё Autor Ё Oscar Zanin     Ё Data Ё 30.06.2015	 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Chamada da PАgina de SolicitaГЦo de alteraГЦo contratual		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSolCon()

LOCAL cHtml := ""

local cCodRda	:= httpget->cRDACod

WEB EXTENDED INIT cHtml START "InSite"

HttpSession->CodRDAsolCon := StrZero(Val(cCodRda), 6)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLSOLCONTR")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml



/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGRVGEN   Ё Autor Ё Totvs                Ё Data Ё 20.03.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica se exibe mensagem de Expirar Senha				     Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGRVGEN()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL aAux			:= {}
LOCAL aAux2		:= {}
LOCAL aGrids		:= {}
LOCAL aHeader		:= {}
LOCAL aCols		:= {}
LOCAL nI			:= 0
LOCAL nL			:= 0
LOCAL nR			:= 0
LOCAL cAliAtu		:= ""
LOCAL aDadGri		:= {}
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLCADWEB():New()
WsChgURL( @oObj, "PLCADWEB.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:oWSDataInput:cChaveLay	:= HttpPost->cChvLay
oObj:oWSDataInput:cRecnus	:= HttpPost->cRecnus
oObj:oWSDataInput:cRecnoReg	:= HttpPost->cRecnoReg
oObj:oWSDataInput:cUserLogin:= IIF(Valtype(HttpSession->USR_INFO) == "U", "" , HttpSession->USR_INFO[1]:CUSERLOGIN)
oObj:cDataAux					:= IIF(ValType(HttpSession->xDataAux) == "C", HttpSession->xDataAux, "")

//Adicionando Session do Tipo do Portal e Matricula.

IF !(Valtype(HttpSession->USR_INFO) == "U")
	oObj:oWSDataInput:cTpPortal := IIF(Valtype(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:nTpPortal) == "U", "" , str(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:nTpPortal))

	if alltrim(str(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:nTpPortal)) <> "2" .AND. Len(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA) > 0
		if HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1] <> nil .and. HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1] <> nil .and. ;
		   HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1] <> nil .and. HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1] <> nil .and. ;
		   HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1] <> nil .and. HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CCODE <> nil

		   oObj:oWSDataInput:cMatric := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CCODE
		endif
	endif
EndIf

oObj:oWSDataInput:oWSDados := PLCADWEB_ARRAYOFSCmpVlr():New()
//oObj:oWSAUTHORIZATION:oWSAUTITEM := PLSXMOV_ARRAYOFAUTITEMVIEW():New()

// CabeГalho
If !Empty(HttpPost->cCampos)
	aAux := StrToArray(Alltrim(HttpPost->cCampos) , "|")
	For nI := 1 To Len(aAux)
		If ";" $ aAux[nI]
			cAliAtu := StrToArray(aAux[nI] , ";")[1]
			aAux[nI] := StrToArray(aAux[nI] , ";")[2]
		EndIf
		AaDd( oObj:oWSDataInput:oWSDados:oWSSCmpVlr, PLCADWEB_SCMPVLR():New() )
		oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nI]:cTipo := ""
		oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nI]:cCampo := aAux[nI]
		oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nI]:cValor := &("HttpPost->" + aAux[nI]) // macro do campo que veio do post
		oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nI]:cTabela := cAliAtu
		oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nI]:cSeqGrid := "" // no cabeГalho eu nao preciso da sequencia
	Next nI
EndIf
// Grids
If !Empty(HttpPost->cGrids)
	aAux := StrToArray(Alltrim(HttpPost->cGrids) , "@") // Aqui eu separo cada Grid contido na pagina
	For nI := 1 To Len(aAux)
		aAux2 := StrToArray(Alltrim(aAux[nI]) , "~") // Separo dados do Grid
		AADD(aDadGri, {aAux2[1], aAux2[2], aAux2[3]}) // Nome do Grid, Tabela, Campos
	Next nI

	For nL := 1 To Len(aDadGri)
		nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == aDadGri[nL,1]} )
		aAux := StrToArray (StrToArray(aAux2[3] , "|")[1],",") // Pego os campos do Grid
		aHeader	:= HttpSession->aCmpGuia[nPos]:OWSAHEADER:CSTRING
		aCols		:= HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING
		For nI := 1 To Len(aCols)
			For nR := 1 To Len(aHeader[1]) - 1 // Tiro o campo "marca" do Header
				AaDd( oObj:oWSDataInput:oWSDados:oWSSCmpVlr, PLCADWEB_SCMPVLR():New() )
				nPosAtu := Len(oObj:oWSDataInput:oWSDados:oWSSCmpVlr)
				oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nPosAtu]:cTipo := ""
				oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nPosAtu]:cCampo := aHeader[1,nR]
				oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nPosAtu]:cValor := aCols[nI,nR]
				oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nPosAtu]:cTabela := aDadGri[nL,2]
				oObj:oWSDataInput:oWSDados:oWSSCmpVlr[nPosAtu]:cSeqGrid := Alltrim(Str(nI))
			Next nR
		Next nI
	Next nL
EndIf

If oObj:GrvForm()
	cResult := oObj:cGrvFormRESULT
EndIf

HttpSession->xDataAux := ""

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLVIEWRDA Ё Autor Ё Karine Riquena Limp  Ё Data Ё 23/06/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica se RDA possui mais de uma RDA.   		    		    Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLVIEWRDA()

LOCAL cHtml := ""
LOCAL cResult := "true|"
LOCAL nI := 0

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If ValType(HttpSession->RDAVIEW) <> "U"
	If len(HttpSession->RDAVIEW) > 1
		cHtml += 	"<label>RDA</label>"
		cHtml += 	"<select id='cRdaRec' name='cRdaRecno' class='form-control TextoInputOB ComboSelectOB'>"
		cHtml += 		"<option value='SELECTED'>-- Selecione uma RDA --</option>"

						//Preciso pegar o tipo de pessoa (fisica ou juridica) para redirecionar para o layout certo
						For nI:=1 To Len( HttpSession->RDAVIEW )
							//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
							//ЁNao inclui registro duplicado
							//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
							if at("> "+ allTrim(HttpSession->RDAVIEW[nI]:cNAME) + " <" ,cHTML) == 0
								cHtml += "<option value='" + alltrim(str(HttpSession->RDAVIEW[nI]:nRdaRecno) + HttpSession->RDAVIEW[nI]:cTipPE) + "'> " + AllTrim(HttpSession->RDAVIEW[nI]:cNAME) + " </option>"
							endIf
						Next nI

		cHtml += 	"</select>"

		cResult += "Selecione uma RDA|" + cHtml + "|" + "@Confirmar~ loadAltCadRda();@Cancelar~$('#closeModal').click();"
	Else
		cResult := "true|REDIRECIONAR|" + STR(HttpSession->RDAVIEW[1]:nRdaRecno) + "|" + Upper(AllTrim(HttpSession->RDAVIEW[1]:cTipPE))
	Endif
Else
	cResult := "false|Erro ao processar RDA's"
Endif

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PLENVADT	 Ё Autor Ё TOTVS      	        Ё Data Ё 13/05/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Consulta o(s) contrato(s) e/ou aditivo(s)    		    		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PLENVADT()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

HttpSession->RetSeqACad := HttpGet->cCodSeq
HttpSession->RetMotACad := HttpGet->cMotivos
HttpSession->RetRDAACad := HttpGet->cCodRDA
HttpSession->RetcTipo   := HttpGet->cTipo

HttpSession->RecnoManBen := IIf(HttpGet->cRecno == NIL, "", HttpGet->cRecno)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLADT")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGRTEST 	  Ё Autor Ё Oscar Zanin     Ё Data Ё 30.06.2015	 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Upload de arquivo atravИs da Grid									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGRTEST()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
Local cRecno		:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCRecno		:= cRecno
oObj:cCArquivo	:= HttpGet->cDirArq
oObj:cCCodRda	 	:= Httpget->cCodRDA
oObj:cChave		:= HttpGet->cCodSeq
oObj:cAlias		:= "B98"
oObj:cIndice		:= "1"
oObj:lLIncRap	:= .T.

HttpSession->cUpload := "Vazio"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:UplConhec()
	cResult += oObj:cUplConhecRESULT
	
	HttpSession->cUpload := cResult
Else
	
	HttpSession->cUpload := ""
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

//----
Web Function PPLCONADT()

LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
Local cRecno		:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCCodRda	 	:= HttpGet->cCodRDA
oObj:cChave		:= HttpGet->cCodSeq

HttpSession->cResDoc := "Vazio"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:ConSolAdt()
	cResult += oObj:cConSolAdtRESULT
	
Else
	
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLSTBEN 	  Ё Autor Ё Roberto Vanderlei  Ё Data Ё 08.12.2015	 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Atualizar status da solicitaГЦo para em anАlise.	 			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSTBEN()

LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
Local cRecno	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
//oObj:cCCodRda	 	:= HttpGet->cCodRDA
oObj:cChave		:= HttpGet->cCodSeq
oObj:cModo      := "1"
HttpSession->cResDoc := "Vazio"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:AltStBen()
	cResult += oObj:cAltStBenRESULT
	
Else
	
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLRESUPL 	  Ё Autor Ё Oscar Zanin     Ё Data Ё 30.06.2015	 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Retorna o valor de resposta da Session							Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRESUPL()

Local cTeste := ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

If Valtype(HttpSession->cUpload) == "C"
	cTeste := HttpSession->cUpload
EndIf

WEB EXTENDED END

Return PLSDECODE("true|" + cTeste)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGRVADT 	  Ё Autor Ё Oscar Zanin     Ё Data Ё 30.06.2015	 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Alimentar Browse com os documentos vinculados Ю solicitaГЦo	Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGRVADT()

LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
Local cRecno		:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cObserv		:= IIf(Valtype(HttpGet->cObserv) == "U", "", HttpGet->cObserv)
oObj:cCodSol		:= IIF(Valtype(HttpGet->cCodSol) == "U", "", HttpGet->cCodSol)
oObj:cCCodRda	 	:= IIf(ValType(httpGet->cCodRDA) == "U", "", HttpGet->cCodRDA)

HttpSession->cResDoc := "Vazio"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GrvSolAdt()
	cResult += oObj:cGrvSolAdtRESULT
	HttpSession->cResDoc := cResult
Else
	HttpSession->cResDoc := ""
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCONSCON Ё Autor Ё TOTVS              Ё Data Ё 13/05/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Consulta o(s) contrato(s) e/ou aditivo(s)    		    		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCONSCON()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCONSCON")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLRMBCAL   Ё Autor Ё Thiago Ribas         Ё Data Ё 08.06.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da Rotina de CalendАrio de reembolso
			   no Portal beneficiario			 							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCALREE()
LOCAL cHtml 	:= ""
LOCAL cResult	:= ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe pagina															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"

cHtml += ExecInPage("PPLCALREE")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLRECEI    Ё Autor Ё Thiago Guilherme	   Ё Data Ё 13/03/14 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Rastrear receita				                                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLRECEI()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina de procedimentos				 						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLRASTRE?codRec=" + HttpGet->codRec )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLPEPREST  Ё Autor ЁEverton M Fernandes   Ё Data Ё 15.10.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina de listagem dos prestadores por plano       Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPEPREST()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁParametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE	:= "MSALPHA"

If oObj:getProdutos()
	HttpSession->aProdutos := oObj:oWSGETPRODUTOSRESULT:oWSPRODUTOSLIST
EndIf

//Mostra a pagina para entrar com o protocolo/Guia

cHtml := ExecInPage( "PPLPEPREST" )

WEB EXTENDED END

//Fim da rotina
Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCBCDRDA 	  Ё Autor Ё Oscar Zanin     Ё Data Ё 30.06.2015	 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Abre combo para selecionar RDA ao acessar a rotina				Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCBCDRDA()

LOCAL cHtml := ""
LOCAL cResult := "true|"
LOCAL nI := 0

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If ValType(HttpSession->RDAVIEW) <> "U"
	If len(HttpSession->RDAVIEW) > 1
		cHtml += 	"<label>RDA</label>"
		cHtml += 	"<select id='cRDACod' name='cCoidigoRDA' class='form-control TextoInputOB ComboSelectOB'>"
		cHtml += 		"<option value='SELECTED'>-- Selecione uma RDA --</option>"

						For nI:=1 To Len( HttpSession->RDAVIEW )
							//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
							//ЁNao inclui registro duplicado
							//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
							if at("> "+ allTrim(HttpSession->RDAVIEW[nI]:cNAME) + " <" ,cHTML) == 0
								cHtml += "<option value='" + HttpSession->RDAVIEW[nI]:CCODE + "'> " + AllTrim(HttpSession->RDAVIEW[nI]:cNAME) + " </option>"
							endIf
						Next nI

		cHtml += 	"</select>"

		cResult += "Selecione uma RDA|" + cHtml + "|" + "@Confirmar~ loadSolConRda();@Cancelar~$('#closeModal').click();"
	Else
		cResult := "true|REDIRECIONAR|" + HttpSession->RDAVIEW[1]:CCODE
	Endif
Else
	cResult := "false|Erro ao processar RDA's"
Endif

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETSIGLACR    Ё Autor Ё Totvs       	    Ё Data Ё 17/07/15Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna as siglas C.R. do profissional
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETSIGLACR()
LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cTipo			:= HttpGet->cTipo
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADRETSIGLACR()

	nResult := Len(oObj:OWSDADRETSIGLACRRESULT:OWSSDADSIGLACR)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:OWSDADRETSIGLACRRESULT:OWSSDADSIGLACR[nI]:CDESCRI,1,15) +"'}" + Iif( nResult != nI ,"},","}]" )
	Next

	cResult += xCols +"|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCorpoClinico Ё Autor Ё TOTVS           Ё Data Ё 14/07/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Corpo Clinico da RDA selecionada        )    		    		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCORPOCLI ()
LOCAL cHtml := ""
PRIVATE aDocs := {}
PRIVATE lPrestTiss := .T.

WEB EXTENDED INIT cHtml START "InSite"

//Carregar documentos cadastrados para o corpo clМnico

oObj := WSPLSXFUN():New()

WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUSERCODE	:= "MSALPHA"

If oObj:GetDocCorpoCli()
	aDocs := oObj:OWSGETDOCCORPOCLIRESULT:OWSSDOCS
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLCORPOCLI")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLDEPREST 	  Ё Autor Ё Rogerio Tabosa       Ё Data Ё 07.03.2013 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada para retornar os detalhes do prestadot                Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDEPREST()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁParametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE	:= "MSALPHA"
oObj:cRecnoBB8	:= HttpGet->cRecnoBB8

If oObj:GetPrestBB8()
	cHtml := "true|"
	HttpSession->cArrPrest := oObj:cGetPrestBB8RESULT
EndIf

WEB EXTENDED END

//Fim da rotina
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCAUTZ  Ё Autor Ё Renan Martins        Ё Data Ё 04.03.2015  Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Abre pАg. de consulta de status de autorizaГЦo (beneficiАrio) Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCAUTZ()
LOCAL cHtml	:= ""
LOCAL oObj  := NIL
Local nI		:= 0

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE	:= "MSALPHA"
oObj:cCampos 	:= "BEA_TIPO"
oObj:cShowAnexo	:= "1"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMonta o box de um determinado campo									   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If ValType(HttpSession->aTpGuia) == 'U'
	If oObj:GetBox()
		HttpSession->aTpGuia := oObj:OWSGETBOXRESULT:OWSGENERICSTRUCT
	EndIf
EndIf

cHtml += ExecInPage( "PPLCSAUT" )

WEB EXTENDED END

Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLDETPRES     Ё Autor ЁEverton M FernandesЁ Data Ё 15.10.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina para visualizar o detalhe do prestador      Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDETPRES()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra o detalhamento do prestador                					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLDETPRES" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLSACR
Web Function da pagina PPLSACR.aph

@Project	TTQLAU
@author	Lucas de Azevedo Nonato
@since		29/10/2015
@version	P12
@Return	L
/*/
//---------------------------------------------------------------------------------------
Web Function PPLSACR()
Local cHtml   	:= ""
Local oWs

WEB EXTENDED INIT cHtml START "InSite"

If !Empty(HttpPost->cCodRda)
	oWs := WSPLSXFUN():New()
	oWs:cUSERCODE	:= "MSALPHA"
	oWs:cCODRDAACR 	:= HttpPost->cCodRda

	If oWs:ACREDITACOES()
		HttpSession->Acreditacoes := aClone(oWs:OWSACREDITACOESRESULT:OWSSACREDIT)
	EndIf
EndIf
	
cHtml := ExecInPage("PPLSACR")

WEB EXTENDED END
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGRANXB 	  Ё Autor Ё Renan ALmeida     Ё Data Ё 30.06.2015    Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Upload de arquivo atravИs da Grid									 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGRANXB()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
Local cNomArq		:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCArquivo	:= HttpGet->cDirArq
oObj:cChave		:= Substr(Httpget->cChavP, 1, Len(Httpget->cChavP)-3)
oObj:cAlias		:= Right(Httpget->cChavP,3)
oObj:llIncRap		:= .T.

HttpSession->cUpload := "Vazio"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:UplConhec()
	cResult += oObj:cUplConhecRESULT
	
	HttpSession->cUpload := cResult
Else
	
	HttpSession->cUpload := ""
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSGRVITE Ё Autor Ё Roberto Vanderlei    Ё Data Ё 09.04.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Montar HTML para resposta da IteraГЦo  							Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSGRVITE()
//1
local cResult := "true|"
local cChave 		:= IIF(!EMPTY(HttpSession->cChave),HttpSession->cChave,HttpGet->cChave)
local cChaveInt 	:= IIF(!EMPTY(HttpSession->cChaveInt),HttpSession->cChaveInt, HttpGet->cChaveInt)
local cResposta	:= StrTran(HttpGet->cResposta, "[ENTERz]", chr(10))
//variavel que identifica se ainda hА interaГУes pendentes para alterar o status da guia
//quando nЦo houver mais nenhuma interaГЦo pendente (lPendente false) podemos alterar o status da guia
local lPendente	:= valtype(HttpGet->lPendente) <> "U" .and. HttpGet->lPendente == "true"
local cPublico	:= iif(valtype(HttpGet->cPubl) <> "U",  HttpGet->cPubl, "")
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cChave	  := cChave
oObj:cChaveInt  := cChaveInt
oObj:cResposta  := plsBNumStr(cResposta, 16, 2)
oObj:lPendente  := lPendente
oObj:cPublico   := cPublico

If ! oObj:GrvIntera()
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
Else
	cResult += oObj:cGrvInteraRESULT
EndIf

WEB EXTENDED END

return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETENDER    Ё Autor Ё Totvs       	    Ё Data Ё 17/07/15Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna as siglas C.R. do profissional
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETENDER()
LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCCodRDA			:= HttpGet->cCodRDA
If ValType(HttpGet->cCodLoc)<>"U"
	oObj:cCCodLoc			:= HttpGet->cCodLoc
EndIf	
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADRETENDER()

	nResult := Len(oObj:oWSDADRETENDERRESULT:oWSSDADENDER)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:oWSDADRETENDERRESULT:oWSSDADENDER[nI]:CCODLOC,1,50) + '$' + SubStr(oObj:oWSDADRETENDERRESULT:oWSSDADENDER[nI]:CDESCRI,1,50) +"'}" + Iif( nResult != nI ,"},","}]" )
	Next

	cResult += xCols +"|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLESPEC    Ё Autor Ё Rodrigo Morgon     	    Ё Data Ё 26/08/15Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLESPEC()
LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCCodRDA		:= HttpGet->cCodRDA
oObj:cCodLoc		:= HttpGet->cCodLoc
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADRETESPEC()

	nResult := Len(oObj:oWSDADRETESPECRESULT:oWSSDADESPEC)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:oWSDADRETESPECRESULT:oWSSDADESPEC[nI]:CCODESP,1,50) + "$" + SubStr(oObj:oWSDADRETESPECRESULT:oWSSDADESPEC[nI]:CDESCRI,1,50) +"'}" + Iif( nResult != nI ,"},","}]" )
	Next

	cResult += xCols +"|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSMNTITE Ё Autor Ё Roberto Vanderlei    Ё Data Ё 09.04.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Montar HTML para exibiГЦo das IteraГУes  						Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSMNTITE()

LOCAL cHtml := ""
local cResult := "true|"
local nI
local cChave
local cResposta
Local cVerifica
Local cTipoGuia

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//cVerifica := HttpGet->cVerif
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

oObj:cUSERCODE 			:= "MSALPHA"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

oObj:oWSITEDAD:cALIMOV		:= HttpGet->cAlias
oObj:oWSITEDAD:cANOAUT 		:= HttpGet->cAnoAut
oObj:oWSITEDAD:cCODOPE 		:= HttpGet->cCodOpe
oObj:oWSITEDAD:cMESAUT		:= HttpGet->cMesAut
oObj:oWSITEDAD:cNUMAUT		:= HttpGet->cNumAut
oObj:oWSITEDAD:cSEQPROC		:= HttpGet->cSeqProc

If HttpSession->MPortal == "000010" 

oObj:oWSITEDAD:cTPPUBLICO := "B"

ElseIf HttpSession->MPortal == "000008"

oObj:oWSITEDAD:cTPPUBLICO := "P"

EndIf 

if oObj:GetInteracao()

	cHTML += "<table id='tabIteracao' class='table table-striped table-bordered table-hover dt-responsive' cellspacing='0' cellpadding='0' style='width: 100%;'>"
	cHTML += "		<thead class='cabacalho'>"
	cHTML += "		<tr>"
	cHTML += "			<th><font size='3' >Visualizar</font></th>" 
	cHTML += "			<th><font size='2' >Setor</font></th>"
	cHTML += "			<th><font size='2' >Data InteraГЦo</font></th>"
	cHTML += "			<th><font size='2' >Mot. PadrЦo</font></th>"
	If HttpSession->MPortal == "000008"
	cHTML += "			<th><font size='2' >Aguardando Resposta</font></th>" 
	Endif
	cHTML += "			<th><font size='2' >Aguardando Anexo</font></th>" 
	cHTML += "		</tr>"
	cHTML += "		</thead>"
	cHTML += "		<tbody class='conteudo'>"    //para cada registro

	for nI := 1 to len (oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO)

	   // IF (cVerifica == "S")
	   //    Return cResult := .T.
	   // ENDIF
		if oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:lRESPRE
			cResposta := 'S'
		else
			cResposta := 'N'
		endif

		cChave := '"'
		cChave += "CarregaVisInt('"
		cChave += HttpGet->cCodOpe + HttpGet->cAnoAut + HttpGet->cMesAut + HttpGet->cNumAut + "','" + HttpGet->cSeqProc + "','" + oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cSEQINT + "','"  + DTOC(oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:dDTITERACAO)+"','"+ oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cDESMOP+"','"+ EncodeUTF8(oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cOBSERVACAO) + "','" + cResposta + "','" + oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cALIASPAI + "','" + oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cRESPPREST + "','" + ALLTRIM(STR(getTpPortal()))
		cChave += "')"
		cChave += '"'


		if oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cALIASPAI = 'BEA'
			cTipoGuia := '1'
		else
			if oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cALIASPAI = 'BE4'
				cTipoGuia := '2'
			else
				cTipoGuia := '3'
			endif
		endif
		
		HttpSession->cChave    := HttpGet->cCodOpe + HttpGet->cAnoAut + HttpGet->cMesAut + HttpGet->cNumAut
		HttpSession->cChaveInt := HttpSession->cChave + HttpGet->cSeqProc + oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cSEQINT

		cHTML += "<tr id='Linha" + alltrim(str(nI)) + "' bgcolor='#FFFFFF'>"
		cHTML += "		<td>"
		cHTML += "			<center><img id='btn" + alltrim(str(nI - 1)) +  "' class='colBtn' src='imagens-pls/refresh.gif' alt='Alterar' onclick=" + cChave + /*+ "closeModalBS();" + + "CarregaVisInt('" + cChave +"' )*/"></center>"
		cHTML += "		</td>"
		cHTML += "		<td><font size='2' >" + oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cSETOR + "</font></td>"
		cHTML += "		<td><font size='2' >" + DTOC(oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:dDTITERACAO) + "</font></td>"
		cHTML += "		<td><font size='2' >" + oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cDESMOP + "</font></td>"
		
		If HttpSession->MPortal == "000008"
		If oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:lRESPRE .AND. EMPTY(oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cRespPrest) .AND. ;
		   oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cTipDirec != "A" 
		   
			cHTML += "		<td><font size='2' >Sim</font></td>"
		Else
			cHTML += "		<td><font size='2' >NЦo</font></td>"
			EndIf
		EndIf
		
		If !oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:lANEXADO .AND. !oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:lRESPRE .AND. ; 
		  oObj:oWSGETINTERACAORESULT:oWSSVIEWINTERACAO[nI]:cTipDirec != "A" 
		  
			cHTML += "		<td><font size='2' >Sim</font></td>"
		Else
			cHTML += "		<td><font size='2' >NЦo</font></td>"
		EndIf 
		
		cHTML += "	</tr>"
	Next nI

	cHTML += "		</tbody>"
	cHTML += "	</table>"

	cResult += "HistСrico de InteraГУes|" +cHTML+ "|" + "@Fechar~ closeModalBS();"
else
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
endif

WEB EXTENDED END

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETMUN    Ё Autor Ё FАbio S. dos Santos   Ё Data Ё22/07/2015Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna a cidade conforme o estado selecionado.               Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETMUN()
LOCAL cResult  	:= "true|"
LOCAL xCols  := ""
LOCAL nI
local cCampoCID
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml //Aqui nЦo tem o insite pq И utilizada no layout generico onde nЦo tem login

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCodEst	:= HttpGet->cCod
cCampoCID		:= HttpGet->cCampoCID
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADRETCID()

	nResult := Len(oObj:oWSDADRETCIDRESULT:OWSSDADCODMUN)
	If nResult > 0

		For nI := 1 to nResult

			xCols +=  SubStr(AllTrim(oObj:oWSDADRETCIDRESULT:OWSSDADCODMUN[nI]:CCODCID),1,50) + '$' + SubStr(AllTrim(oObj:oWSDADRETCIDRESULT:OWSSDADCODMUN[nI]:CDESCRI),1,50) + Iif( nResult != nI ,"~","" )

		Next

		cResult += xCols +"|" + cCampoCID +"|"

		//cCampoCID += xCols +"|"

	Else
		cResult += "ZERO|SEM REGISTROS PARA ESSA UF"
	EndIf

Else
	cResult := "false|NЦo permitida a utilizaГЦo do mИtodo webService"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETCEN    Ё Autor Ё Roberto Vanderlei   Ё   Data Ё16/11/2015Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna o endereГo conforme o CEP selecionado.                Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETCEN()

LOCAL cResult  	:= ""
local cCampoEndereco
local cCampoBairro
local cCampoCodMunicipio
local cCampoMunicipio
local cCampoEstado
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml //Aqui nЦo tem o insite pq И utilizada no layout generico onde nЦo tem login

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode     := "MSALPHA"
oObj:cCep          := HttpGet->cCep
cCampoEndereco     := HttpGet->cCampoEndereco
cCampoBairro       := HttpGet->cCampoBairro
cCampoCodMunicipio := HttpGet->cCampoCodMunicipio
cCampoEstado       := HttpGet->cCampoEstado

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADRETCEN()
	if oObj:cDADRETCENRESULT <> ""
		cResult += oObj:cDADRETCENRESULT + "~" + cCampoEndereco + "|" + cCampoBairro + "|" + cCampoCodMunicipio + "|" + cCampoEstado
	endif
Else
	cResult := ""
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLGETDBN    Ё Autor Ё Roberto Vanderlei   Ё   Data Ё17/11/2015Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os dados do beneficiАrio atras do CPF.                Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGETDBN()

LOCAL cResult  	:= ""
local cCampoCpf
local cCmpNome
local cCmpDtNasc
local cCmpRg
local cCmpOrigem
local cCmpCRNA
local cCmpNomePai
local cCmpNomeMae
local cCmpEmail
local cCmpCep
local cCmpComplemento
local cCmpNumero
local cCmpDDD
local cCmpTelefone
local cCmpSexo
local cCmpEstEmi
local cCmpUniv
local cCmpEstCiv
local cCmpInval
local cEstado
local cCampMuni
local cCmpEnder
local cCmpBai
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode  := "MSALPHA"
oObj:cCpfCnpj   := HttpGet->cCpf
cCmpNome        := HttpGet->cCmpNome
cCmpDtNasc      := HttpGet->cCmpDtNasc
cCmpRg          := HttpGet->cCmpRg
cCmpOrigem      := HttpGet->cCmpOrigem
cCmpCRNA        := HttpGet->cCmpCRNA
cCmpNomeMae     := HttpGet->cCmpNomeMae
cCmpNomePai     := HttpGet->cCmpNomePai
cCmpEmail       := HttpGet->cCmpEmail
cCmpCep         := HttpGet->cCmpCep
cCmpComplemento := HttpGet->cCmpComplemento
cCmpNumero      := HttpGet->cCmpNumero
cCmpDDD         := HttpGet->cCmpDDD
cCmpTelefone    := HttpGet->cCmpTelefone
cCmpSexo        := HttpGet->cCmpSexo
cCmpEstEmi      := HttpGet->cCmpEstEmi
cCmpUniv        := HttpGet->cCmpUniv
cCmpEstCiv      := HttpGet->cCmpEstCiv
cCmpInval       := HttpGet->cCmpInval
cEstado         := HttpGet->cEstado
cCampMuni       := HttpGet->cCampMuni
cCmpEnder       := HttpGet->cCmpEnder
cCmpBai         := HttpGet->cCmpBai

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADRETBEN()
	if oObj:cDADRETBENRESULT <> ""
		cResult += oObj:cDADRETBENRESULT + "~" + cCmpNome + "|" + cCmpDtNasc + "|" + cCmpRg + "|" + cCmpOrigem + "|" + cCmpCRNA  + "|" + cCmpNomePai + "|" + cCmpNomeMae + "|" + cCmpEmail + "|" + cCmpCep + "|" + cCmpComplemento+ "|" +  cCmpNumero + "|" + cCmpDDD + "|" + cCmpTelefone + "|" + cCmpSexo + "|" +  cCmpEstEmi  + "|" + cCmpUniv + "|" + cCmpEstCiv + "|" + cCmpInval + "|" + cEstado + "|" + cCampMuni + "|" + cCmpEnder + "|" + cCmpBai
	endif
Else
	cResult := ""
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLVERBEN    Ё Autor Ё Roberto Vanderlei   Ё   Data Ё16/11/2015Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Recebe o Login e verifica se И benef, ou ja solicitou.        Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLVERBEN()
LOCAL cResult  	:= ""
local cCpf := ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	     := "MSALPHA"

if Alltrim(Str(HttpSession->USR_INFO[1]:OWSUSERLOGPLS:nTpPortal)) = "2"
   cCpf := Alltrim(HttpSession->CCPF)
else
   cCpf := Alltrim(HttpSession->USR_INFO[1]:CUSERLOGIN)
endif

oObj:cUsrLoginCode	 := cCpf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд

if len(Alltrim(cCpf)) = 11

	If oObj:VERBENPRI()
		if oObj:cVERBENPRIRESULT = "S"
			cResult := "true|true|" + cCpf//Alltrim(HttpSession->USR_INFO[1]:CUSERLOGIN)
		else
			cResult := "true|false"
		endif
	Else
		cResult := "true|false"
	EndIf
else
	cResult := "true|false"
endif

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPDELPROF    Ё Autor Ё Totvs         	    Ё Data Ё 17/07/15Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Exclui o corpo clinico
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPDELPROF()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCRecno		:= HttpGet->cRecno
oObj:cAlias		:= "BC1"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DelCorpoClinico()
	cResult := oObj:cDELCORPOCLINICORESULT
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)


//--------
//--------
//--------------------------------------------
Web Function PPLGRVLOG()

LOCAL cResult  	:= "true|"
Local cLogin 		:= IIf(ValType(HttpSession->USR_INFO[1]:CUSERLOGIN) == "C", HttpSession->USR_INFO[1]:CUSERLOGIN, "")
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cDadLog 		:= HttpGet->aDados
oObj:cCUSRLOGIN 	:= cLogin

If oObj:GRAVALOG()
	cResult += oObj:cGRAVALOGRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)



/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLCBLOAD    Ё Autor Ё Thiago Guilherme	    Ё Data Ё 09/01/14Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os estados brasileiros no portal

╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCBLOAD()
LOCAL cResult  	:= "true|"
LOCAL xCols		:= ""
LOCAL nI
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cTipo			:= HttpGet->cTipo
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADLOAD()

	nResult := Len(oObj:OWSDADLOADRESULT:OWSSDADLOAD)

	xCols += "["
	For nI := 1 to nResult

		If Empty(oObj:OWSDADLOADRESULT:OWSSDADLOAD[nI]:CDESCRIB)
			xCols += "{"
			xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:OWSDADLOADRESULT:OWSSDADLOAD[nI]:CDESCRIA,1,15) +"'}" + Iif( nResult != nI ,"},","}]" )
		else
			xCols += "{"
			xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:OWSDADLOADRESULT:OWSSDADLOAD[nI]:CDESCRIB,1,15) +"'}" + Iif( nResult != nI ,"},","}]" )
		EndIF
	Next

	cResult += xCols +"|"

Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PLSMAPCAPT  Ё Autor Ё Rodrigo Morgon     Ё Data Ё 28.07.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Inicia a tela de consulta de visitas aos prestadores          Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PLSMAPCAPT()
LOCAL cHtml := ""
Local nI
Local nResult
Local xCols := ""
Private aResult := {}

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁObj
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametro
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUSERCODE 	:= "MSALPHA"
oObj:cTipo			:= "UF"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё ComboBox da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DADLOAD()
	nResult := Len(oObj:OWSDADLOADRESULT:OWSSDADLOAD)

	For nI := 1 to nResult
		aadd(aResult,AllTrim(oObj:OWSDADLOADRESULT:OWSSDADLOAD[nI]:CDESCRIA)+"="+AllTrim(oObj:OWSDADLOADRESULT:OWSSDADLOAD[nI]:CDESCRIA))
	Next
EndIF

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLMAPCAPT")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLProced       Ё Autor Ё Rodrigo Morgon  Ё Data Ё 13/08/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё SolicitaГЦo de procedimentos da RDA          		    		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROCED ()
LOCAL cHtml 		:= ""
LOCAL nPos			:= 1
LOCAL nI			:= 1
LOCAL aObjSess	:= {} // Variaveis para criaГЦo de Grid generica
LOCAL aMntSess	:= {} 	// Variaveis para criaГЦo de Grid generica

PRIVATE lPrestTiss := .T.

WEB EXTENDED INIT cHtml START "InSite"

aAdd( aObjSess, PLSXFUN_ARRAYOFSCMPGUIA():New() )

nPos := Len(aObjSess)

aAdd( aObjSess[nPos]:OWSSCMPGUIA, PLSXFUN_SCMPGUIA():New() )

aObjSess[nPos]:OWSSCMPGUIA[1]:cTipo := 'G'
aObjSess[nPos]:OWSSCMPGUIA[1]:cNome := "BrwGridProc"
aObjSess[nPos]:OWSSCMPGUIA[1]:cDescri := ""
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid := PLSXFUN_ARRAYOFSCMPGRID():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols := PLSXFUN_ARRAYOFSTRING():NEW()
aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader := PLSXFUN_ARRAYOFSTRING():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols := PLSXFUN_ARRAYOFSTRING():NEW()
aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader := PLSXFUN_ARRAYOFSTRING():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:cxCols := ""
aObjSess[nPos]:OWSSCMPGUIA[1]:cxHeader := ""

for nI := 1 to 6
	aadd( aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:OWSSCmpGrid, PLSXFUN_SCMPGRID():NEW() )
next

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cNome := "Field_CODRDAFP"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cDescri := "RDA"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cNome := "Field_F3ENDERECO"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cDescri := "Local"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cNome := "Field_F3ESPECIALIDADE"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cDescri := "Especialidade"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cNome := "Field_F3TABELA"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cDescri := "Tabela"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cNome := "Field_F3PROCEDIMENTO"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cDescri := "Procedimento"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cTipo := "RADIO"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cNome := "Field_RADIOACAO"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cDescri := "Atender"

HttpSession->aCmpGuia := aClone(aObjSess[nPos]:OWSSCMPGUIA)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁChama formulario
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
cHtml += ExecInPage("PPLPROCED")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLSOLOP   Ё Autor Ё FАbio S. dos Santos  Ё Data Ё 08/09/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para chamar a tela de solicitaГЦo de opcionais.        Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSOLOP()
LOCAL cHtml   := ""
LOCAL nPos			:= 1
LOCAL nI			:= 1
LOCAL aObjSess	:= {} // Variaveis para criaГЦo de Grid generica
LOCAL aMntSess	:= {} 	// Variaveis para criaГЦo de Grid generica
Private cClass := Iif(ValType(HttpGet->cClass) <> "U",HttpGet->cClass,"")
WEB EXTENDED INIT cHtml START "InSite"

aAdd( aObjSess, PLSXFUN_ARRAYOFSCMPGUIA():New() )

nPos := Len(aObjSess)

aAdd( aObjSess[nPos]:OWSSCMPGUIA, PLSXFUN_SCMPGUIA():New() )

aObjSess[nPos]:OWSSCMPGUIA[1]:cTipo := 'G'
aObjSess[nPos]:OWSSCMPGUIA[1]:cNome := "BrwGrid"
aObjSess[nPos]:OWSSCMPGUIA[1]:cDescri := ""
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid := PLSXFUN_ARRAYOFSCMPGRID():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols := PLSXFUN_ARRAYOFSTRING():NEW()
aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader := PLSXFUN_ARRAYOFSTRING():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols := PLSXFUN_ARRAYOFSTRING():NEW()
aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader := PLSXFUN_ARRAYOFSTRING():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:cxCols := ""
aObjSess[nPos]:OWSSCMPGUIA[1]:cxHeader := ""

for nI := 1 to 7
	aadd( aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:OWSSCmpGrid, PLSXFUN_SCMPGRID():NEW() )
next

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cNome := "Field_BenefsMat"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cDescri := "MatrМcula"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cNome := "Field_BenefsNom"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cDescri := "Nome"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cNome := "Field_CodOpc"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cDescri := "CСdigo"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cNome := "Field_VerOpc"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cDescri := "VersЦo"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cNome := "Field_descriOpc"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cDescri := "Opcional"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cTipo := "D"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cNome := "Field_DTAD"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cDescri := "Data AdesЦo"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[7]:cTipo := "D"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[7]:cNome := "Field_DTLIM"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[7]:cDescri := "Data Limite"

HttpSession->aCmpGuia := aClone(aObjSess[nPos]:OWSSCMPGUIA)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChamada da pАgina .APH	                                               Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLSOLOP" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCARBEN  Ё Autor Ё Karine Riquena Limp  Ё Data Ё 11/09/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para carregar os beneficiАrios vinculados a familia    Ё╠╠
╠╠Ё          Ё ou a empresa.                                              	 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCARBEN()

LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCUSRLOGIN	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
oObj:nTpPor		:= getTpPortal()
//matricula do beneficiario selecionado para filtrar o multiselect
oObj:cMatUsu		:= IIF(valtype(httpGet->cMatric) != "U", httpGet->cMatric, "")
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DadFrmEmp()

	nResult := Len(oObj:OWSDadFrmEmpRESULT:OWSSDADGRP)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'cMatric', value:'" + oObj:OWSDadFrmEmpRESULT:OWSSDADGRP[nI]:cMatricl +   "'},"
		xCols +=  "1:{field:'cNomBnf',value:'" +  SubStr(oObj:OWSDadFrmEmpRESULT:OWSSDADGRP[nI]:cNomeBnf,1,20) +"'}" + Iif( nResult != nI ,"},","}]" )
	Next

	cResult += xCols +"|"

Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLGRVOP Ё Autor Ё FАbio S. dos Santos  Ё Data Ё 08/09/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para chamar a tela de solicitaГЦo de opcionais.        Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGRVOP()
Local oObj
Local oObjItens		:= {}
Local cResult		:= "true|"
Local nCont			:= 1
Local nTpPortal		:= 0
Local aResult      := {}
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁAlimenta parametros													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode	:= "MSALPHA"
oObj:oWSDADOSOPC:oWSDADOSBENOPC := PLSXFUN_ARRAYOFSITENSOPC():New()

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁInclusao																   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cCUSRLOGIN	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
oObj:nCodPor	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:nTpPortal
aCols			:= HttpSession->aCmpGuia[1]:OWSACOLS:CSTRING
oObj:cClasse 	:= HttpGet->cClass

For nCont := 1 To Len(aCols)
	aAdd( oObj:oWSDADOSOPC:oWSDADOSBENOPC:oWSSITENSOPC, PLSXFUN_SITENSOPC():New() )
	nQtd := Len( oObj:oWSDADOSOPC:oWSDADOSBENOPC:oWSSITENSOPC )

	oObj:oWSDADOSOPC:oWSDADOSBENOPC:oWSSITENSOPC[nQtd]:cCodBen	:= aCols[nCont,1]
	oObj:oWSDADOSOPC:oWSDADOSBENOPC:oWSSITENSOPC[nQtd]:cCodOpc	:= aCols[nCont,3]
	oObj:oWSDADOSOPC:oWSDADOSBENOPC:oWSSITENSOPC[nQtd]:dDatade	:= CtoD(aCols[nCont,6])
	oObj:oWSDADOSOPC:oWSDADOSBENOPC:oWSSITENSOPC[nQtd]:dDatLim	:= CtoD(aCols[nCont,7])
	oObj:oWSDADOSOPC:oWSDADOSBENOPC:oWSSITENSOPC[nQtd]:cVerOpc	:= aCols[nCont,4]

Next

If oObj:INCBENOPC()
	cResult += oObj:cINCBENOPCRESULT
	aResult := 	Separa(cResult, "|")
	cUrl := Iif(len(aResult) > 4 .and. !Empty(aResult[5]), aResult[5], "")

	If(!Empty(cUrl))
		HttpSession->cUrlForm := cUrl
Else
		HttpSession->cUrlForm := ""
	EndIf
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLVLOPC   Ё Autor Ё Karine Riquena Limp  Ё Data Ё 21/09/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para validar a inclusЦo dos beneficiАrios e opcionais  Ё╠╠
╠╠Ё          Ё na solicitaГЦo de opcionais.    									Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLVLOPC()
LOCAL cResult  	:= "true|"
LOCAL cRec := ""
LOCAL cVldEspe := ""
LOCAL cOpcTit := ""
LOCAL aDados := {}
LOCAL oObj := NIL
LOCAL oObjPar := NIL
LOCAL nPos := 0
LOCAL nPosIte := 0
LOCAL nLen := 0
LOCAL nPosMat := 0
LOCAL nPosCodOpc := 0
LOCAL nPosVerOpc := 0
LOCAL aOpc := {}
LOCAL oOpc := nil
local nI := 1
LOCAL aDadosOpc
local oOpc
LOCAL lVldOpc := .F.
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObjPar := WSCFGDICTIONARY():New()
WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )
oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PVLOPCT"
If oObjPar:GETPARAM()
	lVldOpc := oObjPar:cGETPARAMRESULT
	If ValType(lVldOpc) == 'U'
		lVldOpc := .F.
	ElseIf	ValType(lVldOpc) == 'C'
		If Type(lVldOpc)=="L"
			lVldOpc := &(lVldOpc)
		EndIf
	EndIf
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

if lVldOpc
	//pego os itens que jА estЦo na solicitaГЦo
	nPos := aScan( HttpSession->aCmpGuia, { |x| x:cNome == "BrwGrid"} )
	if(nPos > 0)
		nLen := len(HttpSession->aCmpGuia[nPos]:oWSACOLS:CSTRING)
		nPosMat    := aScan( HttpSession->aCmpGuia[nPos]:oWSCMPGRID:oWSSCMPGRID, { |x| x:cNome == "Field_BenefsMat"} )
		nPosCodOpc := aScan( HttpSession->aCmpGuia[nPos]:oWSCMPGRID:oWSSCMPGRID, { |x| x:cNome == "Field_CodOpc"} )
		nPosVerOpc := aScan( HttpSession->aCmpGuia[nPos]:oWSCMPGRID:oWSSCMPGRID, { |x| x:cNome == "Field_VerOpc"} )

		if nPosMat > 0 .and. nPosCodOpc > 0 .and. nPosVerOpc > 0 .and. nLen > 0
			oObj:cARROPC := ""
			For nI := 1 to nLen
				oObj:cARROPC += HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING[nI][nPosMat] + "$"
				oObj:cARROPC += HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING[nI][nPosCodOpc] + "$"
				oObj:cARROPC += HttpSession->aCmpGuia[nPos]:OWSACOLS:CSTRING[nI][nPosVerOpc]
 				oObj:cARROPC += iif(nI >= (nLen-1),"", "|")
			Next nI

		endIf

	endif
endIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cValores		:= HttpGet->cValores
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if oObj:VldBenOpc()

	aDados := Separa(oObj:cVLDBENOPCRESULT, "|", .F.)

	HttpGet->cValores := iif(aDados[1]=="0", "", aDados[1])
	cRec := iif(aDados[2]=="0","", aDados[2])
	cVldEspe := iif(aDados[3]=="0","", aDados[3])
	cOpcTit := iif(aDados[4]=="0","", aDados[4])

	if(HttpGet->cValores != "")
		cResult := W_PPLGETGRID()
	endif

	cResult += ">>"+cRec+">>"+cVldEspe+">>"+cOpcTit
else
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
endIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCONSOP   Ё Autor Ё Karine Riquena Limp  Ё Data Ё 22.09.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina de consulta de solicitaГУes de opcionais    Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCONSOP()
LOCAL cHtml   := ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Chamada do .APH												     		     Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PPLCONSOP" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														            Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPLIMPOPC    Ё Autor Ё Karine Riquena Limp  Ё Data Ё 24.09.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina com o protocolo do opcional                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PLSIMPOPC()
LOCAL cHtml   := ""
LOCAL oObj := NIL
Private oDadSolOpc := NIL //private para poder usar no aph

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:ccRecno		:= HttpGet->cRecno
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
if oObj:GetSolOpc()

	oDadSolOpc := oObj:oWSGETSOLOPCRESULT

endif

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁMostra a pagina para entrar com o protocolo/Guia						   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml := ExecInPage( "PLSIMPOPC" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHECKPR       Ё Autor Ё Rodrigo Morgon  Ё Data Ё 17/08/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё VerificaГЦo da solicitaГЦo de alteraГЦo de procedimento  		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHECKPR()

LOCAL cResult  := "true|"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cDadLog 		:= httpGet->cDadLog

If oObj:CHECKPROCEDIMENTO()
	cResult := oObj:CCHECKPROCEDIMENTORESULT
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLGRVPROC      Ё Autor Ё Rodrigo Morgon  Ё Data Ё 21/08/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё GravaГЦo de procedimento na tabela de anАlise de log	  		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGRVPROC()

LOCAL cResult  	:= ""
Local cLogin 		:= IIf(ValType(HttpSession->USR_INFO[1]:CUSERLOGIN) == "C", HttpSession->USR_INFO[1]:CUSERLOGIN, "")
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cDadLog 		:= HttpGet->aDados
oObj:cCUSRLOGIN 	:= cLogin

If oObj:GRAVAPROCEDIMENTO()
	cResult += oObj:CGRAVAPROCEDIMENTORESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLPRMACE Ё Autor Ё Roberto Vanderlei     Ё Data Ё 14/08/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para verificar se И primeiro acesso, caso seja, o      Ё╠╠
╠╠Ё          Ё sistema irА obrigar que seja alterada a senha. 					Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPRMACE()

local cResult := "true|"
local cUsuarioLogado
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

cUsuarioLogado := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUsrLoginCode	  := cUsuarioLogado


If oObj:VERACESSO()
	cResult += oObj:cVERACESSORESULT
else
	cResult :=  "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLUPLOPC			Ё Autor Ё TOTVS      	 Ё Data Ё 08/09/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama APH da rotina de upload GenИrica	    		    		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLUPLOPC()
LOCAL cHtml := ""
Local cModo := IIF(ValType(HttpGet->cModo) == "U", "1", HttpGet->cModo)

WEB EXTENDED INIT cHtml START "InSite"

	cHtml += ExecInPage("PPLUPLOPC")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cHtml)

Function ALTBBA(cRecnoBBA, cVar)
LOCAL oObj 		:= NIL

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cChave		:= cRecnoBBA
oObj:cModo      := "2"
oObj:AltStBen()

WEB EXTENDED END

return
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLENVUPG 	  Ё Autor Ё Oscar Zanin     Ё Data Ё 08.09.2015	 	Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Upload de arquivo									 				Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLENVUPG()
local oObj 		:= NIL
local cResult  	:= ''
local cExecPos	:= ''
local aFunPos	:= {}
local cFunction	:= ''
local cPar		:= ''
local cHtml 	:= ''

WEB EXTENDED INIT cHtml START "InSite"

If ! Empty(HttpSession->cExecPos )
	cExecPos 	:= HttpSession->cExecPos
	aFunPos  	:= SEPARA(cExecPos, "|")
	cFunction	:= aFunPos[1]
	cPar     	:= aFunPos[2]
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCRecno	:= iIf( valType(HttpGet->cRecno)  == "C", HttpGet->cRecno, "")
oObj:cCArquivo	:= iIf( valType(HttpGet->cDirArq) == "C", HttpGet->cDirArq, "")
oObj:cChave		:= iIf( valType(Httpget->cChave)  == "C", Httpget->cChave, "")
oObj:cAlias		:= iIf( valType(HttpGet->cAlitab) == "C", HttpGet->cAlitab, "")
oObj:cIndice	:= iIf( valType(HttpGet->cNumInd) == "C", HttpGet->cNumInd, "")

if ValType(HttpGet->cNoArqComp) <>  'U' .and. !empty(HttpGet->cNoArqComp) 
	oObj:cNoArqComp := RC4Crypt(HttpGet->cNoArqComp, '123456789')
endif

HttpSession->cUpload := "Vazio"
HttpSession->nAnexos := "Gravou"
if cExecPos <> ""
	&cFunction.(cPar, "") //Chama funГЦo apСs a exclusЦo da gride.
endif

//Retorna dados
If oObj:UplConhec()
	cResult 			 := oObj:cUplConhecRESULT
	HttpSession->cUpload := cResult
Else
	HttpSession->cUpload := ""
	cResult 			 := "false|"
EndIf

WEB EXTENDED END 

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLUPGEN			Ё Autor Ё TOTVS      	 Ё Data Ё 08/09/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chama APH da rotina de upload GenИrica	    		    		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLUPGEN()
LOCAL cHtml := ""
Local cModo := IIF(ValType(HttpGet->cModo) == "U", "1", HttpGet->cModo)
Local cExecPos := IIF(ValType(HttpGet->cExecPos) == "", "", HttpGet->cExecPos)

WEB EXTENDED INIT cHtml START "InSite"

HttpSession->cModoUpl := cModo
HttpSession->cExecPos := cExecPos

HttpSetPart(.F.)

//Se cModo == 1, a chamada И para a pАgina separada
//Se cModo <> 1, a chamada И para a pАgina dentro de outra pАgina
if (cModo == "1")
	cHtml += ExecInPage("PPLUPGEN")
else
	cHtml += "true|" + ExecInPage("PPLUPGEN")
EndIf

HttpSetPart(.T.)

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cHtml)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCONOPC			Ё Autor Ё TOTVS      	 Ё Data Ё 08/09/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё GravaГЦo Opcionais apСs Upload				    		    		Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCONOPC()

LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
Local cRecno		:= ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cChave		:= HttpGet->cCodSeq

HttpSession->cResDoc := "Vazio"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GrvSolOpc()
	cResult += oObj:cGrvSolOpcRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLSTAOPC   Ё Autor Ё Karine R. Limp       Ё Data Ё 28/09/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Altera o status da solicitaГЦo de opcional apСs anexar docs  	Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLSTAOPC()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
Local cRecno		:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:ccRecno		:= HttpGet->cRecno
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:AltSolOpc()
	cResult := oObj:cAltSolOpcRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLUNUPL 	  Ё Autor Ё Oscar Zanin     Ё Data Ё 05.10.2015	 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё ExclusЦo de arquivos do banco de conhecimento        		    Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLUNUPL()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCRecno		:= HttpGet->cRecno

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:UnUplConhec()
	cResult += oObj:cUnUplConhecRESULT
	
Else
	
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLCPARQ 	  Ё Autor Ё Francisco     Ё Data Ё 06.01.2017	 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддаддддддддддд д╢╠╠
╠╠ЁDescri┤└o Ё Chamada da funГЦo que retorna o caminho de download arquivos  Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCPARQ()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCRecno		:= STRTRAN(HttpGet->cRecno, ".","")

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:CpyArqConhe()
	cResult += oObj:cCpyArqConheRESULT
	
Else
	
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLREEMB   Ё Autor Ё Karine Limp          Ё Data Ё 05.10.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da pagina de solicitaГЦo de reembolso                 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLREEMB()

LOCAL cHtml 	:= ""
LOCAL cResult	:= ""
LOCAL aRegras	:= {}
LOCAL nTpPor  := getTpPortal()
LOCAL oObj
LOCAL oObjPar
LOCAL oObjSolic

PRIVATE lRecOb  := "false"
PRIVATE lMultComp	:= "false"
PRIVATE lSolRee	:= "false"
PRIVATE lTourReemb := "true"
PRIVATE aDadosSoli 	:= {}
PRIVATE nX := 1
PRIVATE cCodSol := iif(valtype(HttpGet->cCodSol) <> "U", HttpGet->cCodSol, "")
PRIVATE cMsgs := ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

WEB EXTENDED INIT cHtml START "InSite"

HttpSession->ClasseProc := {}
if (nTpPor <> 2)
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//ЁParametros de entrada												   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	oObj:cUserCode  := "MSALPHA"
	oObj:ccUsrLogin := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
	oObj:cMatUsu    := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CCODE

	If oObj:VerPermRee()
		lSolRee := oObj:cVERPERMREERESULT
		if (lSolRee == "true")
			oObjPar := WSCFGDICTIONARY():New()
			WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )
			
			//Parametro MV_PLRECOB
			oObjPar:cUSERCODE	:= "MSALPHA"
			oObjPar:cMVPARAM	:= "MV_PLRECOB"
			If oObjPar:GETPARAM()
				lRecOb := oObjPar:cGETPARAMRESULT
				If ValType(lRecOb) == 'U'
					lRecOb := "false"
				ElseIf	ValType(lRecOb) == 'C'
					If Type(lRecOb)=="L"
						If &(lRecOb)
							lRecOb := "true"
						Else
							lRecOb := "false"
						EndIf
					EndIf
				EndIf
			EndIf

			//Parametro MV_PLREEMC
			oObjPar:cUSERCODE	:= "MSALPHA"
			oObjPar:cMVPARAM	:= "MV_PLREEMC"
			If oObjPar:GETPARAM()
				lMultComp := oObjPar:cGETPARAMRESULT
				If ValType(lMultComp) == 'U'
					lMultComp := "false"
				ElseIf	ValType(lMultComp) == 'C'
					If Type(lMultComp)=="L"
						If &(lMultComp)
							lMultComp := "true"
						Else
							lMultComp := "false"
						EndIf
					EndIf
				EndIf
			EndIf
			
			//Parametro MV_PLTOURE
			oObjPar:cUSERCODE	:= "MSALPHA"
			oObjPar:cMVPARAM	:= "MV_PLTOURE"
			If oObjPar:GETPARAM()
				lTourReemb := oObjPar:cGETPARAMRESULT
				If ValType(lTourReemb) == 'U'
					lTourReemb := "true"
				ElseIf	ValType(lTourReemb) == 'C'
					If Type(lTourReemb)=="L"
						If &(lTourReemb)
							lTourReemb := "true"
						Else
							lTourReemb := "false"
						EndIf
					EndIf
				EndIf
			EndIf

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁExibe pagina															   		  Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			If Empty(HttpSession->ClasseProc)	//	ValType(HttpSession->ClasseProc) == 'U'
				If oObj:RetClassProc()
					HttpSession->ClasseProc	:=   oObj:OWSRETCLASSPROCRESULT:OWSSCLASSEPROC
				EndIf
			EndIf
			
			If oObj:ReembChkRegr()
				cResult := oObj:cREEMBCHKREGRRESULT
				aRegras := StrToArray(cResult , "|")
			EndIf

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//ЁChama o formulario													   Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			If Len(aRegras) > 0
				HttpSession->cDtLimit := SubStr(aRegras[1],4,2) + "/" + SubStr(aRegras[1],1,2) + "/" + SubStr(aRegras[1],7,4)
			EndIf

     	//Verifica se origem И tela de consulta
			If HttpGet->cOrigem == "consulta" .and. !Empty(HttpGet->cRecnoProt)

    		//Chamada de webservice para obter os dados do recno correspondente e alimentar a private aDadosSoli
				oObjSolic 	:= NIL
				oObjSolic	:= WSPLSXFUN():new()
				WsChgURL( @oObjSolic, "PLSXFUN.APW" )
				oObjSolic:cUserCode	:= "MSALPHA"
				oObjSolic:cCRecno		:= HttpGet->cRecnoProt

				//Invoca mИtodo para alimentar a private aDadosSoli
				if (oObjSolic:EditSolic())
					aadd(aDadosSoli, .T.)
					aadd(aDadosSoli, oObjSolic:oWSEDITSOLICRESULT)
				endif
			ElseIf HttpGet->cOrigem == "consulta" .and. !Empty(HttpGet->cChaveB1N)
				
				oObjSolic 	:= NIL
				oObjSolic	:= WSPLSXFUN():new()
				WsChgURL( @oObjSolic, "PLSXFUN.APW" )
				oObjSolic:cUserCode	:= "MSALPHA"
				oObjSolic:cChave		:= HttpGet->cChaveB1N
				oObjSolic:cCRecno		:= ""

				//Invoca mИtodo para alimentar a private aDadosSoli
				if (oObjSolic:EditSolic())
					aadd(aDadosSoli, .T.)
					aadd(aDadosSoli, oObjSolic:oWSEDITSOLICRESULT)
				endif
			EndIf
						
			//Retorna o texto que serА exibido no li e concordo
			If oObj:GetLieCon()
				HttpSession->cLieCon := oObj:OWSGETLIECONRESULT:CCLIECON    
			EndIf
			
			if( empty(HttpGet->cOrigem) .and. empty(HttpGet->lNewComp) ) //quando И ediГЦo nЦo preciso exibir o tour de novo e nem quando o usuario clica em novo comprovante
				
				oObjSolic 	:= NIL
				oObjSolic	:= WSPLSXFUN():new()
				WsChgURL( @oObjSolic, "PLSXFUN.APW" )
				oObjSolic:cUserCode	:= "MSALPHA"
				oObjSolic:nTPPOR := getTpPortal()
				oObjSolic:cROTINA := "PPLREEMB"
				oObjSolic:cIDIOMA := "POR"
	
				if oObjSolic:GetMsgPortal()
					cMsgs := oObjSolic:cGETMSGPORTALRESULT			
		EndIf
				
			endIf	
		EndIf
	EndIf
endif
If (lSolRee == "false" .AND. HttpSession->cLieCon == NIL)
	HttpSession->cLieCon := ""
EndIf
cHtml += ExecInPage("PPLREEMB")
WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCARREC  Ё Autor Ё Karine Riquena Limp  Ё Data Ё 13/10/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para carregar as receitas aprovadas vinculadas a       Ё╠╠
╠╠Ё          Ё matricula do beneficiario.                                    Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCARREC()

LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
//matricula do beneficiario selecionado para filtrar o multiselect
oObj:cMatUsu		:= httpGet->cMatric
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GetUsrRec()

	nResult := Len(oObj:OWSGetUsrRecRESULT:OWSSDadRecUsr)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'cCodRec', value:'" + oObj:OWSGetUsrRecRESULT:OWSSDadRecUsr[nI]:cCodRec + "'},"
		xCols +=  "1:{field:'cDesRec', value:'" + oObj:OWSGetUsrRecRESULT:OWSSDadRecUsr[nI]:cNomRec + "'},"
		xCols +=  "2:{field:'cCodMed', value:'" + oObj:OWSGetUsrRecRESULT:OWSSDadRecUsr[nI]:cCodMed + "'},"
		xCols +=  "3:{field:'cNomMed', value:'" + oObj:OWSGetUsrRecRESULT:OWSSDadRecUsr[nI]:cNomMed + "'},"
		xCols +=  "4:{field:'nQtdAut', value:'" + alltrim(str(oObj:OWSGetUsrRecRESULT:OWSSDadRecUsr[nI]:nQtdAut)) + "'}," 
		xCols +=  "5:{field:'nQtdExe', value:'" + alltrim(str(oObj:OWSGetUsrRecRESULT:OWSSDadRecUsr[nI]:nQtdExe)) + "'} " + Iif( nResult != nI ,"},","}]" )

	Next

	If nResult <= 0
		xCols += "]"
	EndIF

	cResult += xCols

Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCOPRM  Ё Autor Ё Renan Martins        Ё Data Ё 06.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna dados do procedimento.								       Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCOPRM()
LOCAL nI      	:= 0
LOCAL oOb2	  		:= NIL
LOCAL lExibe  	:= .F.
LOCAL cResult 	:= "true|"
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oOb2 := WSPLSXFUN():New()
WsChgURL( @oOb2, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oOb2:cUserCode 		:= "MSALPHA"
oOb2:ccCodTb   		:= HttpGET->cCodTb
oOb2:ccCodPro			:= HttpGet->cCodPro
oOb2:ccCodRDA			:= HttpGet->cCodRDA
oOb2:ccCodLoc			:= HttpGet->cCodLoc
oOb2:ccCodEsp			:= HttpGet->cCodEsp
oOb2:cFlgVRDA			:= "SIM"

If oOb2:GetVlrPro()
	cResult +=	oOb2:cGetVlrProRESULT
Else
	cResult := "false| ERRO"
ENDIF

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLITREEMB Ё Autor Ё Karine Riquena Limp  Ё Data Ё 14/10/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Grava o item do reembolso enquanto o beneficiarios            Ё╠╠
╠╠Ё          Ё estА fazendo a solicitaГЦo                                    Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLITREEMB()
LOCAL oObj		:= NIL
LOCAL oObjPar 	:= NIL
LOCAL cResult  	:= "true|"
Local aArrFami 	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA
Local nPos     	:= 0
Local cTitPar	:= "T"
LOCAL 	cHtml   := ""
LOCAL dFontxFun :=  GetAPOInfo("WSPLSXFUN.PRX")[4] 
LOCAL dDatCliet :=  GetAPOInfo("WSCLIENT_WSPLSXFUN.PRX")[4] 

WEB EXTENDED INIT cHtml START "InSite"


//Pego cСdigo do titular parametrizado
oObjPar := WSCFGDICTIONARY():new()
wsChgURL( @oObjPar, "CFGDICTIONARY.APW" ) 
oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PLCDTIT"
If oObjPar:GETPARAM()
	cTitPar := oObjPar:cGETPARAMRESULT
EndIf 

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCodSol		:= httpGet->cCodSol
oObj:ccRecno      := httpGet->cRecno

//Busca titular ou responsАvel financeiro
nPos := aScan(aArrFami , { |x| x:cTipUsu == cTitPar} )

if nPos == 0
	nPos := aScan(aArrFami , { |x| x:cResFam == "1"} )
endif

if (nPos == 0)
	cResult := "false|FamМlia nЦo possui titular ou responsАvel financeiro. Entre em contato com a operadora."
	return PLSDECODE(cResult)
else
	oObj:cMatUsu	:= aArrFami[nPos]:cBenefi
endif

oObj:lCabAlt		:= ValType(HttpGet->lCabAlt) <> "U" .and. HttpGet->lCabAlt == "true" //verifica se alterou o cabeГalho do reembolso
oObj:cRecDivs		:= iif(ValType(HttpGet->cRecDivs) <> "U" .and. !empty(HttpGet->cRecDivs), HttpGet->cRecDivs, "0") //esse recnodivs vem quando И multicomprovante e eu sС posso alterar as B1N do comprovante e nЦo da solicitaГЦo interi

//CondiГЦo para garantir a existencia da propriedade e que o client estА atualizado
If dFontxFun >= CTOD("01/11/2017") .AND. dDatCliet >= CTOD("01/11/2017") 
	oObj:cOriReemb		:= "01" //Portal do Beneficiario 
EndIf 
	
	oObj:oWSITEMREEMB := PLSXFUN_SITENSREEMB():New()

	oObj:oWSITEMREEMB:cCodPad := HttpGet->Field_CODPAD
	oObj:oWSITEMREEMB:cCodPro := HttpGet->Field_CODPROC
	oObj:oWSITEMREEMB:cVlrPro := StrTran(strTran(HttpGet->Field_VALOR, ",", ""),".","")
	oObj:oWSITEMREEMB:cUsoC   := iif(HttpGet->Field_USOCONST == "1", "1", "0")
	oObj:oWSITEMREEMB:cQtdPro := HttpGet->Field_QTD
	oObj:oWSITEMREEMB:cMatric := HttpGet->Field_MATRIC
	oObj:oWSITEMREEMB:cCodRec := HttpGet->Field_CODREC
	oObj:oWSITEMREEMB:cCodMed := HttpGet->Field_CODMED
	oObj:oWSITEMREEMB:cSeqMed := HttpGet->Field_SEQMED
	oObj:oWSITEMREEMB:cTipDoc := HttpGet->Field_TIPDOC
	oObj:oWSITEMREEMB:cCPFCNPJ := HttpGet->Field_CPFCNPJ
	oObj:oWSITEMREEMB:cNomRDA := HttpGet->Field_NOMEPRE
	oObj:oWSITEMREEMB:cNroDoc := HttpGet->Field_NUMDOC
	oObj:oWSITEMREEMB:dDatDoc := CtoD(HttpGet->Field_DTEMIS)
	oObj:oWSITEMREEMB:cTipSer := HttpGet->Field_TIPSER
	
	oObj:oWSITEMREEMB:cCidade := HttpGet->cCidade
	oObj:oWSITEMREEMB:cUF     := alltrim(HttpGet->cUf)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:GrvItReemb()

	cResult += oObj:cGRVITREEMBRESULT

Else
	cResult := "false|" + StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLExDsp Ё Autor Ё Oscar Zanin  Ё Data Ё 20/10/2015 			Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё ExclusЦo da despesa            									Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLExDsp()

Local oObj	:= NIL
Local cResult	:= ""
LOCAL 	cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

oObj	:= WSPLSXFUN():new()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cCRecno		:= HttpGet->cRecno

If oObj:DelDesp()
	cResult += oObj:cDELDESPRESULT

else
	cResult := "false|"

EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCHTAB  Ё Autor Ё Renan Martins        Ё Data Ё 12.01.2014  Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Abre pАgina de consulta de tabelas solicitadas      Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCHTAB()
LOCAL cHtml	:= ""

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLTBLVL" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLTBKHF  Ё Autor Ё Renan Martins        Ё Data Ё 06.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna dados do procedimento.								       Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLTBKHF()
LOCAL oObj	  		:= NIL
LOCAL cResult 	:= "true|"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		:= "MSALPHA"
oObj:ccCodTb   		:= HttpGET->cCodTb
oObj:ccCodRDA			:= HttpGet->cCodRDA
oObj:ccCodLoc			:= HttpGet->cCodLoc
oObj:ccCodEsp			:= HttpGet->cCodEsp
oObj:cUsuEmai			:= HttpGet->cEmail
oObj:cPLSCodUsr		:= HttpGet->cCodUs
oObj:cTipo				:= HttpGet->cForRel

If oObj:PlsTWPGQ()
   cResult := 'true|'+oObj:cPlsTWPGQRESULT
Else
    
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
ENDIF

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLReemCon Ё Autor Ё Oscar Zanin  Ё Data Ё 20/10/2015 			Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё ConfirmaГЦo SolicitaГЦo          									Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLReemCon()

Local oObj 	:= NIL
Local oObjPar := NIL
Local cResult	:= ""
Local aArrFami := {}
Local nPos     	:= 0
Local cTitPar	:= "T"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

aArrFami := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA

//Pego cСdigo do titular parametrizado
oObjPar := WSCFGDICTIONARY():new()
wsChgURL( @oObjPar, "CFGDICTIONARY.APW" ) 
oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PLCDTIT"

If oObjPar:GETPARAM()
	cTitPar := oObjPar:cGETPARAMRESULT
EndIf 

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"

if empty(httpGet->cCodSol)

    cResult := "false|Ocorreu um erro na conexЦo, por favor tente novamente."
    
else

    oObj:cCodSol := httpGet->cCodSol
    
    //Busca titular ou responsАvel financeiro
    nPos := aScan(aArrFami , { |x| x:cTipUsu == cTitPar} )
    
    if nPos == 0
        nPos := aScan(aArrFami , { |x| x:cResFam == "1"} )
    endif
    
    if (nPos == 0)
        cResult := "false|FamМlia nЦo possui titular ou responsАvel financeiro. Entre em contato com a operadora."
        return PLSDECODE(cResult)
    else
        oObj:cMatUsu    := aArrFami[nPos]:cBenefi
    endif
    
    oObj:cCPFCNPJ       := HttpGet->cCpfCnpj
    oObj:cNomRdaNRef    := HttpGet->cNomePres
    oObj:cCUsrLogin := HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
    oObj:cTipo          := HttpGet->cTipDoc
    oObj:cNumDoc        := HttpGet->cNumDoc
    oObj:cDocEmi        := HttpGet->cDatDoc
    oObj:cAltera        := HttpGet->lAltera
    oObj:cDocObrig    := HttpGet->lDocObrig
    oObj:lCabAlt        := ValType(HttpGet->lCabAlt) <> "U" .and. HttpGet->lCabAlt == "true"
    oObj:cRecDivs       := iif(ValType(HttpGet->cRecDivs) <> "U", HttpGet->cRecDivs, "0")
    
    oObj:cAtuB1N   := iif(ValType(HttpGet->lAtuB1N) <> "U", HttpGet->lAtuB1N, "S") 
    oObj:cTipoVld       := IIF (ValType(HttpGet->lMulti) <> "U" .And. HttpGet->lMulti == "true", "1", "0")
    
    If oObj:GrvFimReemb()
        cResult := oObj:cGRVFIMREEMBRESULT
    else
        cResult := "false|"
    EndIf
endif

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLISMBJE Ё Autor Ё Oscar Zanin  Ё Data Ё 20/10/2015 			Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica na BJE se o serviГo estА definido como medicamento	Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLISMBJE()

Local oObj	:= NIL
Local cRet	:= ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj	:= WSPLSXFUN():new()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cTipSer		:= Httpget->cTipSer

If oObj:IsMedBJE()
	cRet := "true|" + oObj:cISMEDBJERESULT
else
	cRet := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cRet)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLVRSOL  Ё Autor Ё Renan Martins        Ё Data Ё 06.01.2014 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna dados do procedimento.								       Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLVRSOY()
LOCAL oObj	  		:= NIL
LOCAL cResult 	:= ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		:= "MSALPHA"
oObj:ccCodRDA			:= HttpGet->cCodRDA
oObj:cPLSCodUsr		:= HttpGet->cCodUs

If oObj:PLSRELYB()
   cResult := 'true|'+oObj:cPLSRELYBRESULT
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
ENDIF

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLEDITPRO Ё Autor Ё Rodrigo Morgon       Ё Data Ё 20/10/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Verifica status do protocolo selecionado e, caso permitido,   Ё╠╠
╠╠Ё          Ё abre a tela de solicitaГЦo com os dados preenchidos.          Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLEDITPRO()

LOCAL cHtml := ""
Local oObj 	:= NIL
Local cResult	:= ""

WEB EXTENDED INIT cHtml START "InSite"

oObj	:= WSPLSXFUN():new()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cCRecno		:= HttpGet->cRecno

HttpSession->_SOLICITACAO := { .F., NIL, NIL }

If oObj:VldPrtReem()
	//Armazena em session os valores para mostrar no cabeГalho.
	HttpSession->_SOLICITACAO[1] := .T.
	HttpSession->_SOLICITACAO[2] := oObj:OWSVLDPRTREEMRESULT
else
	cResult := "false|O status atual da solicitaГЦo nЦo permite o uso desta funcionalidade."
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLDWLDY  Ё Autor Ё Renan Martins     Ё Data Ё 20.01.2015      Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Procurar pastas com arquivos de downloads         				Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
WEB FUNCTION PPLDWLDY()
Local aArqDw	:= {}
Local cPastAq := ""
Local cNomArq := ""
Local cResult
Local nPos		:= 0
LOCAL oObj	  		:= NIL
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		:= "MSALPHA"
If oObj:PLSGETMV("MV_PLSDRDA","")
   cResult := oObj:cPLSGETMVRESULT
Else
	cResult := StrTran(PWSGetWSError( "" ),":","")
ENDIF

cNom := HttpGet->cNomArq
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//ЁLe diretorio para mostrar os arquivos disponiveis
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If !(Empty(cNom))
cNom := Alltrim(cNom)
cResult := Substr(cResult, 0, Len(cResult)-1)
nPos    := RAT("\", cResult)
cResult := Substr(cResult, nPos, Len(cResult))
cResult := cResult + "\" + cNom
cResult := Strtran(cResult, "\", "/")
cResult := "true|"+cResult
	Else
		cResult := "false| nenhum arquivo encontrado"
	EndIf
	
WEB EXTENDED END
	
Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGETPRO  Ё Autor Ё Roberto Vanderlei     Ё Data Ё 13.10.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna a o prestador a partir do CRM e Estado    	 		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLGETPRO()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCrm		:= HttpGet->cCrm
oObj:cEstado	:= HttpGet->cEstado
oObj:cCodSig	:= HttpGet->cConselho 

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:RDAPro()
	cResult := oObj:cRDAProRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLPROREC   Ё Autor Ё Roberto Vanderlei    Ё Data Ё 27.10.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da Rotina de Receitas Portal beneficiario.			 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLPROREC()
LOCAL cHtml 	:= ""
LOCAL cResult	:= ""
local nI
LOCAL aObjSess	:= {} // Variaveis para criaГЦo de Grid generica
LOCAL aMntSess	:= {} 	// Variaveis para criaГЦo de Grid generica


//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe pagina															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"


aAdd( aObjSess, PLSXFUN_ARRAYOFSCMPGUIA():New() )

nPos := Len(aObjSess)

aAdd( aObjSess[nPos]:OWSSCMPGUIA, PLSXFUN_SCMPGUIA():New() )

aObjSess[nPos]:OWSSCMPGUIA[1]:cTipo := 'G'
aObjSess[nPos]:OWSSCMPGUIA[1]:cNome := "BrwGridProc"
aObjSess[nPos]:OWSSCMPGUIA[1]:cDescri := ""
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid := PLSXFUN_ARRAYOFSCMPGRID():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols := PLSXFUN_ARRAYOFSTRING():NEW()
aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader := PLSXFUN_ARRAYOFSTRING():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaCols := PLSXFUN_ARRAYOFSTRING():NEW()
aObjSess[nPos]:OWSSCMPGUIA[1]:oWsaHeader := PLSXFUN_ARRAYOFSTRING():NEW()

aObjSess[nPos]:OWSSCMPGUIA[1]:cxCols := ""
aObjSess[nPos]:OWSSCMPGUIA[1]:cxHeader := ""

for nI := 1 to 2
	aadd( aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:OWSSCmpGrid, PLSXFUN_SCMPGRID():NEW() )
next

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cNome := "Field_CODMED"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[1]:cDescri := "CСd. Medicamento"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cNome := "Field_DESPRO"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[2]:cDescri := "Desc. Medicamento"

/*aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cNome := "Field_F3ESPECIALIDADE"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[3]:cDescri := "Especialidade"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cNome := "Field_F3TABELA"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[4]:cDescri := "Tabela"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cTipo := "C"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cNome := "Field_F3PROCEDIMENTO"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[5]:cDescri := "Procedimento"

aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cTipo := "RADIO"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cNome := "Field_RADIOACAO"
aObjSess[nPos]:OWSSCMPGUIA[1]:oWSCmpGrid:oWSSCmpGrid[6]:cDescri := "Atender"*/

HttpSession->aCmpGuia := aClone(aObjSess[nPos]:OWSSCMPGUIA)

cHtml += ExecInPage("PPLPROREC")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLGRVREC   Ё Autor Ё     Roberto Vanderlei Data Ё 27/10/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
D╠╠ЁDescri┤└o Ё GravaГЦo do CabeГalho/Item da receita B7D e B4F				 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGRVREC()

LOCAL cResult := "true|"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	  := "MSALPHA"
oObj:cProtoc 	  := HttpGet->cProtoc
oObj:cBenef 	  := HttpGet->cBenef
oObj:cCrm 		  := HttpGet->cCrm
oObj:cEstado 	  := HttpGet->cUf
oObj:cMedico	  := HttpGet->cMedico
oObj:cDtReceita	  := HttpGet->cDtReceita
oObj:cMedicamento := HttpGet->cCodMed
oObj:cCodSig       := HttpGet->cConselho

If oObj:GrvRec()
	cResult += oObj:CGRVRECRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLALTREC   Ё Autor Ё     Roberto Vanderlei Data Ё 28/10/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
D╠╠ЁDescri┤└o Ё AlteraГЦo Status  B7D.			 							 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLALTREC()

LOCAL cResult := "true|"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	  := "MSALPHA"
oObj:cProtoc 	  := HttpGet->cProtoc
oObj:cBenef 	  := HttpGet->cBenef

If oObj:AltRect()
	cResult += oObj:CALTRECTRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLCARBA1 Ё Autor Ё Renan MArtins              Data Ё 11/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Rotina para carregar os beneficiАrios com acesso ao reemblso  Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLCARBA1()

LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode		:= "MSALPHA"
oObj:cCUSRLOGIN		:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
oObj:nTpPor			:= getTpPortal()
//matricula do beneficiario selecionado para filtrar o multiselect
oObj:cMatUsu		:= IIF(valtype(httpGet->cMatric) != "U", httpGet->cMatric, "")
oObj:cPermT 		:= "1"  //Para identificar o reembolso|
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DadFrmEmp()

	nResult := Len(oObj:OWSDadFrmEmpRESULT:OWSSDADGRP)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'cMatric', value:'" + oObj:OWSDadFrmEmpRESULT:OWSSDADGRP[nI]:cMatricl +   "'},"
		xCols +=  "1:{field:'cNomBnf',value:'" +  SubStr(oObj:OWSDadFrmEmpRESULT:OWSSDADGRP[nI]:cNomeBnf,1,50) +"'}" + Iif( nResult != nI ,"},","}]" )
	Next

	cResult += xCols +"|"

Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLVERPRO   Ё Autor Ё     Roberto Vanderlei Data Ё 28/10/2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
D╠╠ЁDescri┤└o Ё  Verifica se jА nЦo possue algum protocolo em aberto. 		  ╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLVERPRO()

LOCAL cResult := "true|"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode := "MSALPHA"
oObj:cCpfCnpj 	   := HttpSession->cCpf

If oObj:VerPro()
	cResult += oObj:CVERPRORESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLMSGPOR  Ё Autor Ё TOTVS     Ё            Data Ё 19.11.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna mensagens do portal                                   Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLMSGPOR()
LOCAL oObj := NIL
LOCAL cMsgs 		:= ""
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁObj																	   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Parametro															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUSERCODE := "MSALPHA"
oObj:nTPPOR := getTpPortal()
oObj:cROTINA := IIF(valType(HttpGet->cRotina) <> "U",HttpGet->cRotina , "") //"PPLMOSPRE"
oObj:cCODMSG := IIF(valType(HttpGet->cCodMsg) <> "U",HttpGet->cCodMsg , "")//HttpGet->cCodMsg
oObj:cIDIOMA := IIF(valType(HttpGet->cIdioma) <> "U",HttpGet->cIdioma , "")//HttpGet->cIdioma //"POR"

if oObj:GetMsgPortal()
	cMsgs := oObj:cGETMSGPORTALRESULT
endif

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cMsgs

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLDIGGUIP  Ё Autor Ё Rodrigo Morgon        Ё Data Ё 11/2015  Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna guias de acordo com o critИrio selecionado.           Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLDIGGUIP()
LOCAL cHtml		:= ""
LOCAL cTpDIGR 	:= ""
LOCAL cResult		:= ""
LOCAL nLenCombo 	:= 1
Local cCodOff		:= ""

LOCAL oObjPar 	:= NIL
LOCAL oObjLib := NIL
Local oObjCbx		:= Nil
LOCAL nLen		:= IIf(Valtype(HttpSession->RDAVIEW) == "A", Len(HttpSession->RDAVIEW), 0 )
Local nI

PRIVATE lPrestTiss := .T.
PRIVATE cDataLimit := ""


PRIVATE cInterPag := ""
PRIVATE cValParam := "1"

WEB EXTENDED INIT cHtml START "InSite"

//Pego local de DigitaГЦo off-line
oObj := WSCFGDICTIONARY():new()
wsChgURL( @oObj, "CFGDICTIONARY.APW" ) 
oObj:cUSERCODE:= "MSALPHA"
oObj:cMVPARAM	:= "MV_PLSDIGP"
If oObj:GETPARAM()
	httpSession->cCodOff := oObj:cGETPARAMRESULT
EndIf 


//ATENгцO: Foi criado um parБmetro temporАrio para exibir ou nЦo a opГЦo de Guia de GRI e GH na digitaГЦo Off-line, enquanto nЦo ocorre a homologaГЦo oficial.NЦo retirar este ponto!
oObjCbx := WSCFGDICTIONARY():New()
WsChgURL( @oObjCbx, "CFGDICTIONARY.APW" )
oObjCbx:cUSERCODE	:= "MSALPHA"
oObjCbx:cMVPARAM	:= "MV_POPTCBX"
If oObjCbx:GETPARAM()
	httpSession->cPLSPOPTCBX := Iif( Empty(oObjCbx:cGETPARAMRESULT) .or. oObjCbx:cGETPARAMRESULT == ".F.", 'false', lower(oObjCbx:cGETPARAMRESULT))
else
	httpSession->cPLSPOPTCBX := 'true'
EndIf

//Verifico se o usuАrio tem acesso a incluir guias no portal, definida na tabela BSO, de usuАrios de portal

oObjPar := WSCFGDICTIONARY():New()
WsChgURL( @oObjPar, "CFGDICTIONARY.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Registro no WS														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObjPar:cUSERCODE	:= "MSALPHA"
oObjPar:cMVPARAM	:= "MV_PLCALPG"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjPar:GETPARAM()
	cValParam := IiF( Empty(oObjPar:cGETPARAMRESULT),"1",alltrim(oObjPar:cGETPARAMRESULT))
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLDIGGUIP.APW" )
EndIf

oObjLib := WSPLSXFUN():New()
WsChgURL( @oObjLib, "PLSXFUN.APW" )
oObjLib:cUSERCODE	:= "MSALPHA"
oObjLib:cRDACode := ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё RDA(s)														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
if nLen > 0
	for nI := 1 to nLen
		oObjLib:cRDACode	+= HttpSession->RDAVIEW[nI]:cCode + "|"
	next nI

	if right(oObjLib:cRDACode, 1) == "|" //tiro o ; final
		oObjLib:cRDACode := left(oObjLib:cRDACode, (len(oObjLib:cRDACode)-1))
	endif
else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAIMP.APW" )
endif
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁBusca Calendario de Pagamento
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObjLib:getCalend()
	cInterPag := oObjLib:cGETCALENDRESULT
Else
	Return PPLSALERT( "", "AtenГЦo", "", "W_PPLCHAIMP.APW" )
EndIf


oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   			Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 	:= "MSALPHA"
oObj:nTp			:= 1

//Alimenta session tipo guia
httpSession->aTipGui := {}

if oObj:getCombo()
	httpSession->aTipGui := oObj:oWSGETCOMBORESULT:oWSCbTpPreAte:oWSGenericStruct
EndIf

cHtml += ExecInPage( "PPLDIGGUIAS" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml


/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддддд©╠╠
╠╠ЁPrograma  Ё PPLBKGUI  Ё Autor Ё Rodrigo Morgon          Ё Data Ё 11/2015    Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Retorna fase das guias selecionadas para voltar para digitaГЦo  Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLBKGUI()
LOCAL oObj 		:= NIL
LOCAL cResult  	:= ""

LOCAL nI
LOCAL nTamI
LOCAL aString
LOCAL nCount := 0
LOCAL nNewTamI
LOCAL nTamY
LOCAL nY := 0
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXMOV():New()
WsChgURL( @oObj, "PLSXMOV.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cNumAut		:= HttpGet->cRecnoGuias
oObj:nAutType		:= Val(HttpGet->cTipoGuias)

If oObj:BackDigitacaoGuia()
	cResult := oObj:cBACKDIGITACAOGUIARESULT
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLTIPGUI    Ё Autor Ё Thiago Guilherme	    Ё Data Ё 09/01/14Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna os tipos de guia para impressЦo em branco.
	beneficiarioЁ╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Web Function PPLTIPGUI() //02-12
LOCAL cResult  	:= "true|"
LOCAL xCols
LOCAL nI
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"

//EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:DadTipGui()

	nResult := Len(oObj:OWSDadTipGuiRESULT:OWSSTipGui)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'cCod', value:'" + oObj:OWSDadTipGuiRESULT:OWSSTipGui[nI]:cCod +   "'},"
		xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:OWSDadTipGuiRESULT:OWSSTipGui[nI]:cDescri,1,25) +"'}" + Iif( nResult != nI ,"},","}]" )
	Next

	cResult += xCols +"|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLCRRBAN - RelatСrio de Reembolso AnalМtico
@author	Renan Martins
@since		11/2015
@version	P12
@Obs
//---------------------------------------------------------------------------------------/*/
Web Function PPLCRRBAN()
Local cHtml   	:= ""
Private cTipo	:= "R"
//cTipo, para identificar se И tela de opГУes de reembolso ou utilizaГЦo

WEB EXTENDED INIT cHtml START "InSite"

	cHtml := ExecInPage("PPLCHRRAN.APH")
	
WEB EXTENDED END

Return cHtml

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLCRREUTX - RelatСrio de Extrato de UtilizaГЦo
@author	Renan Martins.
@since		12/2015
@version	P12
@Obs 	.
//---------------------------------------------------------------------------------------/*/
Web Function PPLCRREUTX()
Local cHtml   	:= ""
Private cTipo	:= "E"
//cTipo, para identificar se И tela de opГУes de reembolso ou utilizaГЦo

WEB EXTENDED INIT cHtml START "InSite"

	cHtml := ExecInPage("PPLCHRRAN.APH")
	
WEB EXTENDED END

Return cHtml
//-------------------------------------------------------------------
/*/{Protheus.doc} PPLCHAMCB
Carteirinha do beneficiario

@author  PLS TEAM
@version P11
@since   15.10.15
/*/
//-------------------------------------------------------------------
web function PPLCHAMCB()
LOCAL cHtml := ""

//Exibe pagina
WEB EXTENDED INIT cHtml START "InSite"

//Pega o parametro
oObj := WSCFGDICTIONARY():New()
WsChgURL( @oObj, "CFGDICTIONARY.APW" )

//Registro no WS
oObj:cUSERCODE	:= "MSALPHA"
oObj:cMVPARAM	:= "MV_LRN360"

//Pegar a codigo de consulta definido no parametro
If oObj:GETPARAM()
	HttpSession->MV_LRN360 := oObj:cGETPARAMRESULT
EndIf

//Chama o formulario
cHtml += ExecInPage("PPLCHAMCB")

WEB EXTENDED END

return cHtml

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} 	PPLREAJ
Web Function da pagina PPLREAJ.aph

@author	Lucas de Azevedo Nonato
@since		23/12/2015
@version	P12
/*/
//---------------------------------------------------------------------------------------
Web Function PPLREAJ()
Local cHtml   	:= ""

WEB EXTENDED INIT cHtml START "InSite"

	If HTTPSESSION->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CFAMILIA <> nil
		HttpSession->cMatric := HTTPSESSION->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CFAMILIA
	EndIf

	cHtml := ExecInPage("PPLREAJ")

WEB EXTENDED END

Return cHtml
//---------------------------------------------------------------------------------------
/*/{Protheus.doc} 	PPLGETFREL
Web Function da listagem de arquivos nos relatorios de pagamento PPLRELMOV

@author	RogИrio Tabosa
@since		01/2016
@version	P11
/*/
//---------------------------------------------------------------------------------------
Web Function PPLGETFREL()
LOCAL cResult  := ""
LOCAL cRdas	:= ""
LOCAL oObj		:= NIL
LOCAL nI		:= 0
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Metodo e propriedades
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode	:= "MSALPHA"
oObj:cRDACode	:= httpGet->cRdaCode

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Lista de arquivos
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:getArqRel()
	cResult +=	oObj:cGETARQRELRESULT
Else
	cResult := "false|"+StrTran(PWSGetWSError( "" ),":","")
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da Rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
return PLSDECODE(cResult)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} 	PPLBLORE
Web Function da verificaГЦo de bloqueio do usuАrio para fazer o reembolso.

@author	Lucas Nonato
@since		03/2016
@version	P12
/*/
//---------------------------------------------------------------------------------------

Web Function PPLBLORE()
LOCAL oObj
LOCAL cResult  	:= "true|"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros.
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cDocObrig    := HttpGet->lDocObrig
	oObj:oWSITEMREEMB := PLSXFUN_SITENSREEMB():New()

	oObj:oWSITEMREEMB:cCodPad := HttpGet->Field_CODPAD
	oObj:oWSITEMREEMB:cCodPro := HttpGet->Field_CODPROC
	If ValType(HttpGet->Field_VALOR) <> "U"
	oObj:oWSITEMREEMB:cVlrPro := StrTran(strTran(HttpGet->Field_VALOR, ",", ""),".","")
	Endif

	oObj:oWSITEMREEMB:cUsoC   := iif(HttpGet->Field_USOCONST == "1", "1", "0")
	oObj:oWSITEMREEMB:cQtdPro := HttpGet->Field_QTD
	oObj:oWSITEMREEMB:cMatric := HttpGet->Field_MATRIC
	oObj:oWSITEMREEMB:cCodRec := HttpGet->Field_CODREC
	oObj:oWSITEMREEMB:cCodMed := HttpGet->Field_CODMED
	oObj:oWSITEMREEMB:cSeqMed := HttpGet->Field_SEQMED
	oObj:oWSITEMREEMB:cTipDoc := HttpGet->Field_TIPDOC
	oObj:oWSITEMREEMB:cCPFCNPJ := HttpGet->Field_CPFCNPJ
	oObj:oWSITEMREEMB:cNomRDA := HttpGet->Field_NOMEPRE
	oObj:oWSITEMREEMB:cNroDoc := HttpGet->Field_NUMDOC
	oObj:oWSITEMREEMB:dDatDoc := CtoD(HttpGet->Field_DTEMIS)
	oObj:oWSITEMREEMB:cTipSer := HttpGet->Field_TIPSER

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Retorna dados
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
If oObj:BloqReem()

	cResult += oObj:cBLOQREEMRESULT

Else
	cResult := "false|" + AllTrim(StrTran(PWSGetWSError( "" ),":",""))
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  ЁPPLGUIBCO   Ё Autor Ё Thiago Guilherme     Ё Data Ё 30.11.2015 Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Chamada da Rotina de impressЦo de guias TISS em branco		 Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLGUIBCO()
LOCAL cHtml 	:= ""
LOCAL cResult	:= ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁExibe pagina															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
WEB EXTENDED INIT cHtml START "InSite"

cHtml += ExecInPage("PPLGUIBCO")

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLRDEB
Chamada da tela para geraГЦo do relatСrio de quitaГЦo de dИbitos no Portal
@author Oscar Zanin
@since 27/04/2016
@version P12
/*/
//-------------------------------------------------------------------
Web Function PPLRDEB()

LOCAL cHtml := ""

WEB EXTENDED INIT cHtml START "InSite"

cHtml += ExecInPage("PPLRDEB")

WEB EXTENDED END

Return cHtml

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLTBLVALOR
Chamada da tela de verificaГЦo de elegibilidade de procedimentos e solicitaГЦo de tabela

@author Renan Martins
@since 29/04/2016
@version P12
/*/
//-------------------------------------------------------------------
Web Function PPLTBLVALOR()
LOCAL cHtml	:= ""
PRIVATE lPrestTiss := .T.

WEB EXTENDED INIT cHtml START "InSite"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁChama o formulario													   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cHtml += ExecInPage( "PPLTBLVALOR" )

WEB EXTENDED END
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return cHtml

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    ЁPPLMEMORET   Ё Autor Ё Karine Riquena Limp   Ё Data Ё 05/05/16 Ё╠╠
╠╠цддддддддддедддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Retorna o conteudo memo de um campo pelo recno                Ё╠╠
╠╠юддддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Web Function PPLMEMORET()
LOCAL cResult  	:= "true|"
LOCAL cRecno  := HttpGet->cRecno
LOCAL cAlias  := HttpGet->cAlias
LOCAL cCampo  := HttpGet->cCampo
LOCAL nResult
LOCAL nI
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:CcRecno	:= cRecno
oObj:cAlias	:= cAlias
oObj:CCampos	:= cCampo

If oObj:RETMEMOGEN()

	xCols := oOBJ:OWSRETMEMOGENRESULT:OWSSRETOBSPROT[1]:CcMsg

	cResult += xCols + "|"
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLFLAINT
Altera a flag da interaГЦo no anexo

@author Karine Riquena Limp
@since 20/07/2016
@version P12
/*/
//-------------------------------------------------------------------
Web Function PPLFLAINT()
local cResult := "true|"
local oObj := WSPLSXFUN():New()
local lPendente	:= valtype(HttpGet->lPendente) <> "U" .and. HttpGet->lPendente == "true"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

	WsChgURL( @oObj, "PLSXFUN.APW" )

	//Parametros
	oObj:cUserCode	:= "MSALPHA"
	oObj:cChave		:= HttpGet->cChave
	oObj:cAlias		:= HttpGet->cAlias
	oObj:lPendente   	:= lPendente
	oObj:cSequen		:= HttpGet->cSequen

	If oObj:AltFlaInt()

		cResult := oOBJ:cAltFlaIntResult

	Else
		cResult := "false|"
	EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLGRCAAUT
Gravar apenas os campos apСs autorizaГЦo

@author Renan Martins
@since 09/06/2016
@version P12
/*/
//-------------------------------------------------------------------
Web Function PPLGRCAAUT()
	LOCAL cVar 		:= HttpGet->cElmts
	Local cVarIts 	:= HttpGet->cElmtsIts
	LOCAL cResult 	:= 'true|'
	LOCAL 	cHtml := ""
	LOCAL nI		:= 0
	
WEB EXTENDED INIT cHtml START "InSite"

	//OBJETO WEBSERVICE
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )

	//Parametros
	oObj:cChave		:= cVar
	oObj:cCmdChave	:= cVarIts

	If oObj:ATGUIAAAUT()

		cResult:= oOBJ:cATGUIAAAUTRESULT

	Else
		cResult := "false|"
	EndIf
	
WEB EXTENDED END

Return PLSDECODE(cResult)



//-------------------------------------------------------------------
/*/{Protheus.doc} PPLRETCRMF
Retorna CrМticas da BDX no DigitaГЦo Off-Line

@author Renan Martins
@since 07/2016
@version P12
/*/
//-------------------------------------------------------------------
Web Function PPLRETCRMF()
LOCAL cResult  	:= "true|"
LOCAL cChave  := HttpGet->cChave
LOCAL nI
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё oBJ
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cChave  	:= cChave

If oObj:RETCRIMF()

	cResult += oOBJ:cRETCRIMFRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Fim da rotina
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
Return PLSDECODE(cResult)

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLVLBLBen

@author Oscar Zanin
@since 07/2016
@version P12
/*/
//-------------------------------------------------------------------
Web Function PPLVLBLBen()
Local cResult := "true|"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode := "MSALPHA"
oObj:cBenef    := IIF( ValType(Httpget->cBenef) == "U" , "", Httpget->cBenef )
oObj:cDATASTRING	 := IIF( ValType(HttpGet->cDatPro) == "U", "", HttpGet->cDatPro )

If oObj:VBlqBen()
	cResult += oOBJ:cVBLQBENRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)


//-------------------------------------------------------------------
/*/{Protheus.doc} PPLPRORINT
Chama tela de prorrogaГЦo de internaГЦo

@author  Rodrigo Morgon
@version P12
@since   04.07.16
/*/
//-------------------------------------------------------------------
Web Function PPLPRORINT()
LOCAL cHtml := ""
Local cTISSVer := ""
local aRDA := {}

WEB EXTENDED INIT cHtml START "InSite"

If Len(HttpSession->RDAVIEW) >= 1
	HttpSession->cRdaRel := HttpSession->RDAVIEW[1]:cCODE
	HttpSession->cCodLoc := HttpSession->RDAVIEW[1]:cCodLoc

	//Recupera a versЦo da TISS da RDA
	aRDA := ClassDataArr(HttpSession->RDAVIEW[1])
	If aScan(aRDA,{|x| AllTrim(x[1]) == "CTISSVER"  }) > 0
		cTISSVer := HttpSession->RDAVIEW[1]:cTissVer
	EndIf
	HttpSession->cTISSVer := cTISSVer
	HttpSession->cTp		 := "11"

EndIf

//Chama o formulario
cHtml += ExecInPage("PPLPRORINT")

WEB EXTENDED END

Return cHtml

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLGETPATD
Web Function para pegar o nЗmero do protocolo de atendimento

@author	Lucas Nonato
@since		08/08/2016
@version	P11
/*/
//---------------------------------------------------------------------------------------
Web Function PPLGETPATD()
Local cHtml		:= ""
Local oObj		:= nil

WEB EXTENDED INIT cHtml START "InSite"

If !(HttpGet->lAnexos == 'true') .And. ValType(HttpSession->aVldCartao) == 'A' .And. HttpSession->aVldCartao[10]
	cResult := "false|Para usuАrios de intercambio И necessАrio a digitaГЦo do protocolo"

Else
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )

	oObj:cUserCode	:= "MSALPHA"

	If oObj:getNumProtoc()
		cHtml +=	"true|"+oObj:cGETNUMPROTOCRESULT + "|" + HttpGet->bID + "|" + HttpGet->cID
	Else
		cHtml := "false|"+StrTran(PWSGetWSError( "" ),":","")
	EndIf

EndIf

WEB EXTENDED END

return PLSDECODE(cHtml)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLVLDPROT
Web Function para validaГЦo do protocolo de atendimento

@author	Lucas Nonato
@since		09/08/2016
@version	P11
/*/
//---------------------------------------------------------------------------------------
Web Function PPLVLDPROT()
Local cResult	:= ""
Local cHtml	:= ""
Local oObj		:= nil

WEB EXTENDED INIT cHtml START "InSite"
	cNumProto := HttpGet->cProtoc	
	If ValType(HttpSession->aVldCartao) == 'A'
		cMatric := HttpSession->aVldCartao[2]
	Else
		cMatric := HttpGet->cMatric
	
	EndIF	
	
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	
	oObj:cUserCode	:= "MSALPHA"
	oObj:cNumProtoc	:= cNumProto
	oObj:cMatUsu	:= cMatric
	
	If oObj:VldNumProtoc()			
		If !Empty(oObj:cVLDNUMPROTOCRESULT)
			cResult +=	"false|Erro na validaГЦo do Protocolo" + Chr(13) + oObj:cVLDNUMPROTOCRESULT
		Else
			cResult +=	"true"
		EndIf
	EndIf
	
WEB EXTENDED END	

Return PLSDECODE(cResult)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLINTPROTOC
Web Function que chama a tela de integraГЦo do protocolo

@author	Lucas Nonato
@since		08/08/2016
@version	P11
/*/
//---------------------------------------------------------------------------------------
Web Function PPLINTPROTOC()
Local cHtml			:= ""


WEB EXTENDED INIT cHtml START "InSite"	
	HttpSession->cMatInterc := HttpGet->cMatric
	cHtml := ExecInPage( "PPLSPROTOC" )

WEB EXTENDED END	

Return PLSDECODE(cHtml)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPL773WEBRN
Web Function para pegar o nЗmero do protocolo da Unimed Origem

@author	 Lucas Nonato
@since	 08/08/2016
@version P11
/*/
//---------------------------------------------------------------------------------------
Web Function PPL773WEBRN()
Local cHtml		:= ""
Local oObj		:= nil	
Local cIsAnexo	:= "|false"
WEB EXTENDED INIT cHtml START "InSite"
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	oObj:cUserCode	:= "MSALPHA"
	oObj:cDDD 		:= HttpGet->cDDD
	oObj:cTelefone 	:= HttpGet->cTel
	oObj:cSentimento:= HttpGet->cSent
	oObj:cProtAnt 	:= HttpGet->cProtAnt
	oObj:cTxtLivre 	:= HttpGet->cTxtLivre
	
	If ValType(HttpSession->aVldCartao) == "A" .And. Empty(HttpSession->cMatInterc)
		oObj:cMatric 	:= HttpSession->aVldCartao[2]
	Else
		oObj:cMatric 	:= HttpSession->cMatInterc
		cIsAnexo	:= "|true"
	EndIf
	
	If oObj:Protocolo()
		cHtml := oObj:cPROTOCOLORESULT + cIsAnexo
	EndIF
	
WEB EXTENDED END	

Return PLSDECODE(cHtml)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLVERINT
Web Function para verificar se a integraГЦo estА ativada.

@author	Lucas Nonato
@since		08/08/2016
@version	P11
/*/
//---------------------------------------------------------------------------------------
Web Function PPLVERINT()
Local cHtml			:= ""
Local lPL395WS 	:= .F.

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSCFGDICTIONARY():New()
WsChgURL( @oObj, "CFGDICTIONARY.APW" )

oObj:cUSERCODE	:= "MSALPHA"
oObj:cMVPARAM	:= "MV_PL395WS"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁPegar a codigo de consulta definido no parametro 					   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If oObj:GETPARAM()
	lPL395WS := IiF( AllTrim(oObj:cGETPARAMRESULT)=="1",.T.,.F.)
EndIf
If	lPL395WS
	cHtml := "true|" + Iif(ValType(HttpGet->cMatric) == "C", HttpGet->cMatric, "")	
Else
	cHtml := "false|Para usuАrios de intercambio И necessАrio a digitaГЦo do protocolo"
EndIf

WEB EXTENDED END

Return PLSDECODE(cHtml)

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLdtFut

@author Oscar Zanin
@since 07/2016
@version P12
/*/
//-------------------------------------------------------------------
Web Function PPLdtFut()
Local cResult := "true|"
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode := "MSALPHA"
oObj:cDATASTRING	 := IIF( ValType(HttpGet->cDatPro) == "U", "", HttpGet->cDatPro )
oObj:cBenef    := IIF( ValType(HttpSession->TrilhaCard) == "U" , "", HttpSession->TrilhaCard )

If oObj:VBlqBen()
	cResult += oOBJ:cVBLQBENRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLUPDB1N

@author Karine Riquena Limp
@since 28/09/2016
@version P12
@description Atualiza todas os itens da B1N quando altera o cabeГalho 
               no reembolso
/*/
//-------------------------------------------------------------------
Web Function PPLUPDB1N()
Local cResult := "true|"
local oObj := WSPLSXFUN():New()
LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"

WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUserCode := "MSALPHA"
oObj:cCodSol		:= HttpGet->cCodSol
oObj:cCPFCNPJ		:= HttpGet->cCpfCnpj
oObj:cNomRdaNRef	:= HttpGet->cNomRda
oObj:cTipo			:= HttpGet->cTipDoc
oObj:cNumDoc		:= HttpGet->cNroDoc
oObj:cDocEmi		:= HttpGet->cDatDoc

If oObj:UpdB1N()
	cResult += oOBJ:cUpdB1NRESULT
Else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLBENINT
Web Function para verificar se a integraГЦo estА ativada.

@author	Lucas Nonato
@since		08/08/2016
@version	P11 
/*/
//---------------------------------------------------------------------------------------

Web Function PPLBENINT()

Local cHtml	:= ""
Local cNumCart:= HttpGet->cNumCart

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
oObj:cUSERCODE 	:= "MSALPHA"
oObj:cUserCardNumber := cNumCart

If oObj:RetItercamb()
	cHtml := oObj:cRetItercambRESULT
Else
	cHtml := ""
EndIf

WEB EXTENDED END

Return PLSDECODE(cHtml)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLDADPES
Web Function da pagina PPLSDADPES.aph

@Project	
@author	Lucas Nonato
@since		29/10/2015
@version	P12

/*/
//---------------------------------------------------------------------------------------
Web Function PPLDADPES()
	local cHtml   	:= ""
	local cCodUsr	:= ""
	local oWs

	WEB EXTENDED INIT cHtml START "InSite"	 // Garante que existe uma sessЦo vАlida.
	
	HttpSession->aDados := {}
	
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj,"PLSXFUN.APW" )
	oObj:cUSERCODE 	:= "MSALPHA"
	oObj:cMatric 	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:OWSLISTOFOPE:OWSSOPERADORA[1]:OWSEMPRESA:OWSSEMPRESA[1]:OWSCONTRATO:OWSSCONTRATO[1]:OWSSUBCONTRATO:OWSSSUBCONTRATO[1]:OWSFAMILIA:OWSSFAMILIA[1]:CBENEFI
	oObj:RetDadBen()
	

	aadd( HttpSession->aDados,{	OOBJ:oWSRETDADBENRESULT:CCNOMEUSUARI,;
								OOBJ:OWSRETDADBENRESULT:CCMATRICULA,;
								OOBJ:OWSRETDADBENRESULT:CDDTNACTO,;
								OOBJ:OWSRETDADBENRESULT:CCCNESUSU,;
								OOBJ:OWSRETDADBENRESULT:CCSUSEP,;
								OOBJ:OWSRETDADBENRESULT:CCSEGASSPL,;
								OOBJ:OWSRETDADBENRESULT:CCNUMREGOPE,;
								OOBJ:OWSRETDADBENRESULT:CCCONTATOOPE,;
								OOBJ:OWSRETDADBENRESULT:CCCONTATOANS,;
								OOBJ:OWSRETDADBENRESULT:CDCPT,;
								OOBJ:OWSRETDADBENRESULT:CCTPACOMODA,;
								OOBJ:OWSRETDADBENRESULT:CCCONTRATACA,;
								OOBJ:OWSRETDADBENRESULT:CCABRANG,;
								OOBJ:oWSRETDADBENRESULT:CCNOMPRO,;
								OOBJ:OWSRETDADBENRESULT:CCNFANTAZOPE,;
								OOBJ:OWSRETDADBENRESULT:CCNFAADMBENE,;
								OOBJ:OWSRETDADBENRESULT:CCRZSOCIAL,;
								OOBJ:OWSRETDADBENRESULT:CDDTVIGPL,;
								OOBJ:OWSRETDADBENRESULT:CCNUMCON,;
								OOBJ:OWSRETDADBENRESULT:CDDATCON,;
								OOBJ:OWSRETDADBENRESULT:CDDTMAXCON,;
								OOBJ:OWSRETDADBENRESULT:CCINFOPLAN,;
								OOBJ:OWSRETDADBENRESULT:CCINFORMACOE,; 
								OOBJ:OWSRETDADBENRESULT:CCCARENCAMB,; 
								OOBJ:OWSRETDADBENRESULT:CCCARENCHOS,;
								OOBJ:OWSRETDADBENRESULT:CCCARENCPAT,; 
								OOBJ:OWSRETDADBENRESULT:CCCARENCODO} )
				
		cHtml := ExecInPage("PPLDADPES")

	WEB EXTENDED END
return cHtml


//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLEXFINA
Chamada do relatСrio de extrato financeiro

@Project	
@author	Thiago Guilherme
@since		30.11.2015
@version	P12

/*/
//---------------------------------------------------------------------------------------
Web Function PPLEXFINA()
LOCAL cHtml 	:= ""
LOCAL cResult	:= ""


//Exibe pagina	

WEB EXTENDED INIT cHtml START "InSite"

cHtml += ExecInPage("PPLEXFIN")

WEB EXTENDED END

//Fim da rotina

Return cHtml


/*/{Protheus.doc} PPLGETLAN
Retorna os tipos de lanГamentos

@Project	
@author	Totvs
@since		18.06.2009
@version	P12

/*/
WEB FUNCTION PPLGETLAN()

LOCAL cResult := "true|"
LOCAL nI	  := NIL
LOCAL nResult := NIL
LOCAL xCols	  := NIL

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUSERCODE	:= "MSALPHA"

If oObj:getLancam()
	
	nResult := Len(oObj:OWSGETLANCAMRESULT:OWSSTipGui)

	xCols := iif(nResult > 0, "[", "[]")
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'cCod', value:'" + oObj:OWSGETLANCAMRESULT:OWSSTipGui[nI]:cCod +   "'},"
		xCols +=  "1:{field:'cDescri',value:'" +  SubStr(oObj:OWSGETLANCAMRESULT:OWSSTipGui[nI]:cDescri,1,25) +"'}" + Iif( nResult != nI ,"},","}]" )
	Next
	
	cResult += xCols +"|"
Else
	cResult := "false|"
EndIf

Return PLSDECODE(cResult)


/*/{Protheus.doc} PPLPROD
Retorna os Produtos

@Project	
@author	Totvs
@since		18.06.2009
@version	P12

/*/
WEB FUNCTION PPLPROD()

LOCAL cResult := "true|"
LOCAL nI	  := NIL
LOCAL nResult := NIL
LOCAL xCols	  := NIL

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

oObj:cUSERCODE	:= "MSALPHA"

If oObj:getProdutos()
	
	nResult := Len(oObj:oWSGETPRODUTOSRESULT:oWSPRODUTOSLIST)

	xCols := "["
	For nI := 1 to nResult

		xCols += "{"
		xCols +=  "0:{field:'cCod', value:'" + oObj:oWSGETPRODUTOSRESULT:oWSPRODUTOSLIST[nI]:CCODIGO +   "'},"
		xCols +=  "1:{field:'cDescri',value:'" +  oObj:oWSGETPRODUTOSRESULT:oWSPRODUTOSLIST[nI]:CNOME +"'}" + Iif( nResult != nI ,"},","}]" )
	Next
	
	cResult += xCols +"|"
Else
	cResult := "false|"
EndIf

Return PLSDECODE(cResult)



//-------------------------------------------------------------------
/*/{Protheus.doc} PPLVlItRe
Valida itens negados para reembolso

@author Francisco Edcarlo
@since 03/2017
@version P12
/*/
//-------------------------------------------------------------------
Web Function PPLVlItRe()

Local oObj 	:= NIL
Local cResult	:= ""

LOCAL 	cHtml := ""
WEB EXTENDED INIT cHtml START "InSite"


oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
//Ё Parametros
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
oObj:cUserCode	:= "MSALPHA"
oObj:cCodSol		:= httpGet->cCodSol


If oObj:VldItReemb()
	cResult := oObj:cVldItReembRESULT
else
	cResult := "false|"
EndIf

WEB EXTENDED END

Return PLSDECODE(cResult)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLHABBOT
Web Function para anexos medicamento uso constante.

@author	Lucas Nonato
@since		08/08/2016
@version	P11 
/*/
//---------------------------------------------------------------------------------------

Web Function PPLHABBOT()

Local cHtml	:= ""
Local cRecno:= HttpGet->cRecno
Local cChave:= HttpGet->cChave


	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	oObj:cUSERCODE 	:= "MSALPHA"
	
	oObj:ccRecno := Alltrim(cRecno)
	oObj:cChave := Alltrim(cChave)
	
	If oObj:HabBotao()
		cHtml := oObj:cHabBotaoresult
	Else
		cHtml := "true|"
	EndIf

Return PLSDECODE(cHtml)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLCANPLA
Web Function para carregar pagina de cancelamento de planos

@author	Lucas Nonato
@since		08/08/2016
@version	P11 
/*/
//---------------------------------------------------------------------------------------
Web Function PPLCANPLA()
LOCAL cHtml := ""


//Chama formulario
WEB EXTENDED INIT cHtml

If ValType(HttpSession->aFamBloq) <> "A"
	HttpSession->aFamBloq := {}
EndIf

//Ws
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//Parametros
oObj:cUserCode	:= "MSALPHA"
oObj:cCUSRLOGIN	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE

If oObj:getFamBloq()
	HttpSession->aFamBloq := oObj:oWSGETFAMBLOQRESULT:oWSFAMBLOQLIST
EndIf

cHtml += ExecInPage("PPLCANPLA")

WEB EXTENDED END

Return cHtml    


//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLCONFPLA
Web Function para confirmacao do cancelamento de planos

@author	Lucas Nonato
@since		08/08/2016
@version	P11 
/*/
//---------------------------------------------------------------------------------------
Web Function PPLCONFPLA()
Local cHtml := "false|" 

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//Parametros
oObj:cUserCode	:= "MSALPHA"
oObj:cCUSRLOGIN	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
oObj:ccRecno    := HttpGet->cRecSelec

If oObj:procSolicBloq() 
	cHtml := oObj:cPROCSOLICBLOQRESULT
EndIf

Return PLSDECODE(cHtml)   


//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLRELCPL
Web Function para exibicao de relatorios da RN 412

@author	Renan Sakai
@since		08/08/2016
@version	P11 
/*/
//---------------------------------------------------------------------------------------
Web Function PPLRELCPL()
LOCAL cHtml := ""

//Ws
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

If ValType(HttpSession->aSolCanPla) <> "A"
	HttpSession->aSolCanPla := {}
EndIf

//Parametros
oObj:cUserCode	:= "MSALPHA"
oObj:cCUSRLOGIN	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
oObj:ccRecno    := "0"

If oObj:getSolCanPla()
	HttpSession->aSolCanPla := oObj:oWSGETSOLCANPLARESULT:oWSSOLICCANPLALIST
EndIf

//Chama formulario
WEB EXTENDED INIT cHtml

	cHtml += ExecInPage("PPLRELCPL")

WEB EXTENDED END

Return cHtml         

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLINFCPL
Web Function para exibicao de busca de informacoes de uma solicitacao de cancelamento de 
plano - RN 412

@author	Renan Sakai
@since		08/08/2016
@version	P11 
/*/
//---------------------------------------------------------------------------------------
Web Function PPLINFCPL()
Local cHtml := "true|" 

//Ws
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

//Parametros
oObj:cUserCode	:= "MSALPHA"
oObj:cCUSRLOGIN	:= HttpSession->USR_INFO[1]:OWSUSERLOGPLS:CUSERLOGINCODE
oObj:ccRecno    := HttpGet->cRecno

If oObj:getSolCanPla()
	HttpSession->aSolCanPla := oObj:oWSGETSOLCANPLARESULT:oWSSOLICCANPLALIST
EndIf

Return cHtml    


//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLINFCPL
Chama pagina com informacoes de uma solicitacao de cancelamento de plano

@author	Renan Sakai
@since		08/08/2016
@version	P11 
/*/
//---------------------------------------------------------------------------------------
Web Function PPLCPLPOP()
Local cHtml := ""

//Chama formulario
WEB EXTENDED INIT cHtml

	cHtml += ExecInPage("PPLCPLPOP")

WEB EXTENDED END

Return cHtml 

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLCRTXT
CrМticas do XML da submissЦo via Portal em base 64

@author	Renan Martins
@since		06/2017
@version	P11 
/*/
//---------------------------------------------------------------------------------------
Web Function PPLCRTXT()

Local cResult	:= ""
Local chtml := ""

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
oObj:cUSERCODE 	:= "MSALPHA"

//Alimenta os atributos do objeto com os respectivos valores
oObj:cBusca	:= HttpGet->Field_SEQUEN

if oObj:RetCriTXT()
	cResult := oObj:cRETCRITXTRESULT
endif


Return PLSDECODE(cResult)

/*/{Protheus.doc} PPLDUPGUI
Verifica se a guia que esta sendo digitada pode estar em duplicidade
@author victor.silva
@since 20/06/2017
/*/

Web Function PPLDUPGUI()
local aData	 	:= {}
local cAno		:= ""
local cMes		:= ""
local cDia		:= ""
local cHtml		:= ""
local cResult	:= "true|N|--"

WEB EXTENDED INIT cHtml START "InSite"

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )

// Parametros
oObj:cUserCode			:= "MSALPHA"
oObj:cRdaCode			:= HttpGet->cRda
oObj:cTipGui			:= HttpGet->cTpGui
oObj:cNumGuiRef			:= HttpGet->cNumGui
oObj:cUserCardNumber	:= HttpGet->cMatric
 
// Trata a data para o formato 'AAAAMMDD'
aData 			:= StrTokArr(AllTrim(HttpGet->cDate),"-")
cAno			:= StrZero(Val(aData[1]),4)
cMes			:= StrZero(Val(aData[2]),2)
cDia			:= StrZero(Val(aData[3]),2)
oObj:cDatGuia	:= cAno + cMes + cDia

if oObj:isDupGui()
	cResult := oObj:cIsDupGuiRESULT
endif

WEB EXTENDED END

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁFim da Rotina														   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return PLSDECODE(cResult)

//-------------------------------------------------------------------
/*/{Protheus.doc} PPLVerSInt
Verifica a SolicitaГЦo de InternaГЦo para a Guia de Resumo.

@author  Roberto Arruda
@version P12
@since   08.03.16
/*/
//-------------------------------------------------------------------
Web Function PPLVerSInt()
Local cHtml := ""
Local cTISSVer := ""
Local cResult := ""

WEB EXTENDED INIT cHtml START "InSite"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁWeb Service															   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//ЁParametros de entrada												   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
oObj:cUserCode 		:= "MSALPHA"
oObj:cNumGuiRef  	:= HttpGET->cCodGuia
oObj:cDatGuia		:= HttpGET->dDtaAtd		
oObj:cRDACode			:= HttpGET->cRda		

If oObj:VerGuiInt()
	cResult :=	oObj:cVerGuiIntRESULT
Else
	cResult := "false| ERRO"
ENDIF

WEB EXTENDED END

Return PLSDECODE(cResult)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PLSRETCODP
Retorna codigo do profissional de saude

@author		totvs team
@since		29/06/2017
@version	P11 
/*/
//---------------------------------------------------------------------------------------
function PLSRETCODP( cCnpjCpfSol,cProSol )
	local cRet
	
	oObj := WSPLSXFUN():New()
	WsChgURL( @oObj, "PLSXFUN.APW" )
	oObj:cUSERCODE 	:= "MSALPHA"
	oObj:cCpfCnpj	:= cCnpjCpfSol
	oObj:cCodProf	:= cProSol
	
	if( oObj:RetProSau())
		cRet := oObj:cRETPROSAURESULT
	endIf 
Return cRet

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLCRPROT
Protocolo

@author	AndrИ Dini
@since		07/2017
@version	P11 
/*/
//---------------------------------------------------------------------------------------
Web Function PPLCRPROT()

Local cResult	:= ""
Local chtml := ""

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
oObj:cUSERCODE 	:= "MSALPHA"

//Alimenta os atributos do objeto com os respectivos valores
oObj:cBusca	:= HttpGet->cRecno
oObj:cTipBusca  := HttpGet->cTipRel

if oObj:RetCriPROT()
	cResult := oObj:cRETCRIPROTRESULT
endif

Return PLSDECODE(cResult)

//---------------------------------------------------------------------------------------
/*/{Protheus.doc} PPLSREDIR
AlteraГЦo cadastral

@author	AndrИ Dini
@since		10/2017
@version	P12.1.17
/*/
//---------------------------------------------------------------------------------------
Web Function PPLSREDIR()
Local cHtml   	:= ""

WEB EXTENDED INIT cHtml START "InSite"

cHtml := ExecInPage("PPLSREDIR")

WEB EXTENDED END
Return PLSDECODE(cHtml)

/*/{Protheus.doc} PPLRETFAC
Retorna as faces que estЦo atreladas com o dente.
@author andre.dini
@since 15/05/2017
/*/
Web Function PPLRETFAC()
Local cResult	:= ""
Local cCodDente	:= HttpGet->cCodDente
Local cCodPad	:= HttpGet->cCodPad
Local cCodPro	:= HttpGet->cCodPro

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
oObj:cUSERCODE 	:= "MSALPHA"

//Alimenta os atributos do objeto com os respectivos valores
oObj:cCodDente	:= cCodDente
oObj:cCodPad	:= cCodPad
oObj:cCodPro	:= cCodPro

if oObj:RetVldDent()
	cResult := oObj:cRetVldDentRESULT
endif

Return PLSDECODE(cResult)

/*/{Protheus.doc} PPLCBOXGEN
Retorna valores para combo box generico.
@author francisco.edcarlo
@since 15/05/2017
/*/
Web Function PPLCBOXGEN()
Local cResult	:= ""
Local cAlias	:= HttpGet->cAlias
Local cDados	:= HttpGet->cDados
Local cWhere	:= HttpGet->cWhere

oObj := WSPLSXFUN():New()
WsChgURL( @oObj, "PLSXFUN.APW" )
oObj:cUSERCODE 	:= "MSALPHA"

//Alimenta os atributos do objeto com os respectivos valores
oObj:cAlias	:= cAlias
oObj:cDados	:= cDados
oObj:cWhere	:= cWhere

if oObj:getCboxGen()
	cResult := oObj:cgetCboxGenRESULT
endif

Return PLSDECODE(cResult)

