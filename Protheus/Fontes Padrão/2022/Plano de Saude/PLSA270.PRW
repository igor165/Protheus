
#include "PLSMGER.CH"
#include "PLSA270.CH"
#include "PROTHEUS.CH"
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддбдддддддбддддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PLSA270 Ё Autor Ё Tulio Cesar          Ё Data Ё 02.05.2000 Ё╠╠
╠╠цддддддддддедддддддддадддддддаддддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Cadastro de Forma de Cobranca                              Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso       Ё Advanced Protheus 5.08                                     Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ Nenhum                                                     Ё╠╠
╠╠цддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё            ATUALIZACOES SOFRIDAS DESDE A CONSTRU─AO INICIAL           Ё╠╠
╠╠цддддддддддддбддддддддбддддддбдддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁProgramador Ё Data   Ё BOPS Ё  Motivo da Altera┤└o                     Ё╠╠
╠╠цддддддддддддеддддддддеддддддедддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠юддддддддддддаддддддддаддддддадддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PLSA270
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define o cabecalho da tela de atualizacoes                               Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
PRIVATE aRotina   := MenuDef()
PRIVATE cCadastro := OemtoAnsi(STR0002)
Private cFilter	  := ""
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Endereca a funcao de BROWSE                                              Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
BJ1->(DbSetOrder(1))
BJ1->(DbGoTop())
BJ1->(mBrowse(006,001,022,075,"BJ1"))
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Desliga F12 do programa...                                               Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
SET KEY VK_F12 TO
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina Principal                                                  Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return
/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao    Ё PL270MOV Ё Autor Ё Tulio Cesar           Ё Data Ё 02.05.01 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Movimentacao do Cadastro de Forma de Cobranca              Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Function PL270MOV(cAlias,nReg,nOpc)
Local I__f := 0
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis...                                                      Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
LOCAL nOpca	 := 0
LOCAL oDlg
PRIVATE aChave := {}
PRIVATE oSay 
PRIVATE aCols   := {}
PRIVATE aHeader  := {}
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis Tipo 01                                                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
PRIVATE oGet01
PRIVATE aCab01
PRIVATE aCols01
PRIVATE aVet01 := {}
PRIVATE cExpAdv01 := Space(10)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis Tipo 02                                                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
PRIVATE oGet02
PRIVATE aCab02
PRIVATE aCols02
PRIVATE aVet02 := {}          
PRIVATE cExpAdv02 := Space(10)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis Tipo 03                                                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
PRIVATE oGet03
PRIVATE aCab03
PRIVATE aCols03
PRIVATE aVet03 := {}
PRIVATE cExpAdv03 := Space(10)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis Tipo 04                                                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
PRIVATE oGet04
PRIVATE aCab04 
PRIVATE aCols04
PRIVATE aVet04 := {}
PRIVATE cExpAdv04 := Space(10)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis para Enchoice...                                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
PRIVATE oEnchoice
PRIVATE aTELA[0][0]
PRIVATE aGETS[0]
PRIVATE nAlt := Iif(Val(GetVersao(.F.)) >= 12, 030, 015)
aSize := MsAdvSize(.T.) 
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta aCols e aHeader...                                                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Store Header "BJ2" TO aCab01 For .T.
If nOpc == K_Incluir
	Copy "BJ1" TO Memory Blank
	Store COLS Blank "BJ2" TO aCols01 FROM aCab01
Else
	Copy "BJ1" TO MEMORY

	BJ2->(DbSetOrder(1))
	If BJ2->(MsSeek(xFilial("BJ2")+BJ1->BJ1_CODIGO+"1"))
		Store COLS "BJ2" TO aCols01 FROM aCab01 VETTRAB aVet01 While BJ2->(BJ2_FILIAL+BJ2_CODIGO+BJ2_USO) == BJ1->(BJ1_FILIAL+BJ1_CODIGO+"1")
	Else
		Store COLS Blank "BJ2" TO aCols01 FROM aCab01
	EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta aCols e aHeader...                                                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Store Header "BJ2" TO aCab02 For .T.
If nOpc == K_Incluir
	Copy "BJ1" TO Memory Blank
	Store COLS Blank "BJ2" TO aCols02 FROM aCab02
Else
	Copy "BJ1" TO MEMORY

	BJ2->(DbSetOrder(1))
	If BJ2->(MsSeek(xFilial("BJ2")+BJ1->BJ1_CODIGO+"2"))
		Store COLS "BJ2" TO aCols02 FROM aCab02 VETTRAB aVet02 While BJ2->(BJ2_FILIAL+BJ2_CODIGO+BJ2_USO) == BJ1->(BJ1_FILIAL+BJ1_CODIGO+"2")
	Else
		Store COLS Blank "BJ2" TO aCols02 FROM aCab02
	EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta aCols e aHeader...                                                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Store Header "BJ2" TO aCab03 For .T.
If nOpc == K_Incluir
	Copy "BJ1" TO Memory Blank
	Store COLS Blank "BJ2" TO aCols03 FROM aCab03
Else
	Copy "BJ1" TO MEMORY

	BJ2->(DbSetOrder(1))
	If BJ2->(MsSeek(xFilial("BJ2")+BJ1->BJ1_CODIGO+"3"))
		Store COLS "BJ2" TO aCols03 FROM aCab03 VETTRAB aVet03 While BJ2->(BJ2_FILIAL+BJ2_CODIGO+BJ2_USO) == BJ1->(BJ1_FILIAL+BJ1_CODIGO+"3")
	Else
		Store COLS Blank "BJ2" TO aCols03 FROM aCab03
	EndIf
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta aCols e aHeader...                                                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Store Header "BJ2" TO aCab04 For .T.
If nOpc == K_Incluir
	Copy "BJ1" TO Memory Blank
	Store COLS Blank "BJ2" TO aCols04 FROM aCab04
Else
	Copy "BJ1" TO MEMORY

	BJ2->(DbSetOrder(1))
	If BJ2->(MsSeek(xFilial("BJ2")+BJ1->BJ1_CODIGO+"4"))
		Store COLS "BJ2" TO aCols04 FROM aCab04 VETTRAB aVet04 While BJ2->(BJ2_FILIAL+BJ2_CODIGO+BJ2_USO) == BJ1->(BJ1_FILIAL+BJ1_CODIGO+"4")
	Else
		Store COLS Blank "BJ2" TO aCols04 FROM aCab04
	EndIf
EndIf

If nOpc <> K_Incluir
   cExpAdv01 := Posicione("BJ0",1,xFilial("BJ0")+M->BJ1_CODIGO+"1","BJ0_ROTINA")
Endif   

If nOpc <> K_Incluir
   cExpAdv02 := Posicione("BJ0",1,xFilial("BJ0")+M->BJ1_CODIGO+"2","BJ0_ROTINA")
Endif   

If nOpc <> K_Incluir
   cExpAdv03 := Posicione("BJ0",1,xFilial("BJ0")+M->BJ1_CODIGO+"3","BJ0_ROTINA")
Endif   

If nOpc <> K_Incluir
   cExpAdv04 := Posicione("BJ0",1,xFilial("BJ0")+M->BJ1_CODIGO+"4","BJ0_ROTINA")
Endif   

If nOpc = 6	// Copia
	M->BJ1_PROPRI 	:= ""
	M->BJ1_CODIGO 	:= Space(Len(M->BJ1_CODIGO))
	M->BJ1_DATA	  	:= dDataBase
	nOpc := 3		// Inclusao
Endif

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Dialogo...                                                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
DEFINE MSDIALOG oDlg TITLE cCadastro FROM 008.2,010.3 TO 034.4,100.3 OF GetWndDefault()
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Folders...                                                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
@ 105,003 FOLDER oFolder SIZE 350,090 OF oDlg PIXEL	PROMPTS	OemtoAnsi(STR0003),OemtoAnsi(STR0004),OemtoAnsi(STR0005),OemtoAnsi(STR0006)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta Enchoice...                                                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Zero();oEnchoice := MsMGet():New(cAlias,nReg,nOpc,,,,,{nAlt,001,100,355},,,,,,oDlg,,,.F.)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta GetDados...                                                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Val(GetVersao(.F.)) >= 12 // Caso a versao seja maior ou igual a 12
	aDifSize:= {,,,,35,3,,}
	oGet02 := TPLSBrw():New(020,005,341,070,nil  ,oFolder:aDialogs[2],nil, nil, nil ,nil   ,nil, .T.   ,nil  ,.T.   ,nil   ,aCab02,aCols02,.F.,"BJ2",nOpc,"Alias da Forma de Cobranca",nil,nil,nil,nil,nil,,,,,,,,,,,,aDifSize)
Else
	oGet02 := TPLSBrw():New(020,005,341,070,nil  ,oFolder:aDialogs[2],nil, nil, nil ,nil   ,nil, .T.   ,nil  ,.T.   ,nil   ,aCab02,aCols02,.F.,"BJ2",nOpc,"Alias da Forma de Cobranca",nil,nil,nil,nil,nil)
Endif
oGet02:aVetTrab := aClone(aVet02)
@ 006, 005 Say   OemtoAnsi(STR0007) PIXEL OF oFolder:aDialogs[2] //"Expressao ADVPL"
@ 004, 060 MSGet oSay VAR cExpAdv02 SIZE 055,010 PIXEL OF oFolder:aDialogs[2]
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta GetDados...                                                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Val(GetVersao(.F.)) >= 12 // Caso a versao seja maior ou igual a 12
	aDifSize:= {,,,,35,3,,}
	oGet03 := TPLSBrw():New(020,005,341,070,nil  ,oFolder:aDialogs[3],nil, nil, nil ,nil   ,nil, .T.   ,nil  ,.T.   ,nil   ,aCab03,aCols03,.F.,"BJ2",nOpc,"Alias da Forma de Cobranca",nil,nil,nil,nil,nil,,,,,,,,,,,,aDifSize)
Else
	oGet03 := TPLSBrw():New(020,005,341,070,nil  ,oFolder:aDialogs[3],nil, nil, nil ,nil   ,nil, .T.   ,nil  ,.T.   ,nil   ,aCab03,aCols03,.F.,"BJ2",nOpc,"Alias da Forma de Cobranca",nil,nil,nil,nil,nil)
EndIf
oGet03:aVetTrab := aClone(aVet03)
@ 006, 005 Say   OemtoAnsi(STR0007) PIXEL OF oFolder:aDialogs[3] //"Expressao ADVPL"
@ 004, 060 MSGet oSay VAR cExpAdv03 SIZE 055,010 PIXEL OF oFolder:aDialogs[3]
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta GetDados...                                                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Val(GetVersao(.F.)) >= 12 // Caso a versao seja maior ou igual a 12
	aDifSize:= {,,,,35,3,,}
	oGet04 := TPLSBrw():New(020,005,341,070,nil  ,oFolder:aDialogs[4],nil, nil, nil ,nil   ,nil, .T.   ,nil  ,.T.   ,nil   ,aCab04,aCols04,.F.,"BJ2",nOpc,"Alias da Forma de Cobranca",nil,nil,nil,nil,nil,,,,,,,,,,,,aDifSize)
Else
	oGet04 := TPLSBrw():New(020,005,341,070,nil  ,oFolder:aDialogs[4],nil, nil, nil ,nil   ,nil, .T.   ,nil  ,.T.   ,nil   ,aCab04,aCols04,.F.,"BJ2",nOpc,"Alias da Forma de Cobranca",nil,nil,nil,nil,nil)
EndIf
oGet04:aVetTrab := aClone(aVet04)
@ 006, 005 Say   OemtoAnsi(STR0007) PIXEL OF oFolder:aDialogs[4] //"Expressao ADVPL"
@ 004, 060 MSGet oSay VAR cExpAdv04 SIZE 055,010 PIXEL OF oFolder:aDialogs[4]
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta GetDados...                                                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Val(GetVersao(.F.)) >= 12 // Caso a versao seja maior ou igual a 12
	aDifSize:= {,,,,35,3,,}
	oGet01 := TPLSBrw():New(020,005,341,070,nil  ,oFolder:aDialogs[1],nil, nil, nil ,nil   ,nil, .T.   ,nil  ,.T.   ,nil   ,aCab01,aCols01,.F.,"BJ2",nOpc,"Alias da Forma de Cobranca",nil,nil,nil,nil,nil,,,,,,,,,,,,aDifSize)
Else
	oGet01 := TPLSBrw():New(020,005,341,070,nil  ,oFolder:aDialogs[1],nil, nil, nil ,nil   ,nil, .T.   ,nil  ,.T.   ,nil   ,aCab01,aCols01,.F.,"BJ2",nOpc,"Alias da Forma de Cobranca",nil,nil,nil,nil,nil)
EndIf
oGet01:aVetTrab := aClone(aVet01)
@ 006, 005 Say   OemtoAnsi(STR0007) PIXEL OF oFolder:aDialogs[1]//"Expressao ADVPL"
@ 004, 060 MSGet oSay VAR cExpAdv01 SIZE 055,010 PIXEL OF oFolder:aDialogs[1]
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Ativa o Dialogo...                                                       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
ACTIVATE MSDIALOG oDlg ON INIT Eval({ || EnchoiceBar(oDlg,{|| nOpca := 1,If(Obrigatorio(oEnchoice:aGets,oEnchoice:aTela),oDlg:End(),nOpca:=2),If(nOpca==1,oDlg:End(),.F.) },{||oDlg:End()},.F.,{})  })
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Rotina de gravacao dos dados...                                          Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If nOpca == K_OK
   If nOpc <> K_Visualizar
   
      M->BJ1_USO := If(!Empty(cExpAdv01),"1","")+If(!Empty(cExpAdv02),"2","")+;
                     If(!Empty(cExpAdv03),"3","")+If(!Empty(cExpAdv04),"4","")
      PLUPTENC("BJ1",nOpc)   	
   
      aChave := {}
      aadd(aChave,{"BJ2_CODIGO",M->BJ1_CODIGO})
      aadd(aChave,{"BJ2_USO","1"})
      oGet01:Grava(aChave, .T.)      

      aChave := {}
      aadd(aChave,{"BJ2_CODIGO",M->BJ1_CODIGO})
      aadd(aChave,{"BJ2_USO","2"})
      oGet02:Grava(aChave, .T.)

      aChave := {}
      aadd(aChave,{"BJ2_CODIGO",M->BJ1_CODIGO})
      aadd(aChave,{"BJ2_USO","3"})
      oGet03:Grava(aChave, .T.)

      aChave := {}
      aadd(aChave,{"BJ2_CODIGO",M->BJ1_CODIGO})
      aadd(aChave,{"BJ2_USO","4"})
      oGet04:Grava(aChave, .T.)
      
      If ! Empty(cExpAdv01)
         DbSelectArea("BJ0")
         BJ0->(DbSetOrder(1))
         BJ0->(MsSeek(xFilial("BJ0")+M->BJ1_CODIGO+"1"))
         BJ0->(RecLock("BJ0",!BJ0->(Found())))
         If nOpc <> K_Excluir
            BJ0->BJ0_FILIAL  := xFilial("BJ0")
            BJ0->BJ0_CODIGO  := M->BJ1_CODIGO
            BJ0->BJ0_TIPO    := "1"
            BJ0->BJ0_ROTINA  := cExpAdv01
         Else
            BJ0->(DbDelete())
         Endif   
         BJ0->(MsUnLock())
      Endif   

      If ! Empty(cExpAdv02)
         DbSelectArea("BJ0")
         BJ0->(DbSetOrder(1))
         BJ0->(MsSeek(xFilial("BJ0")+M->BJ1_CODIGO+"2"))
         BJ0->(RecLock("BJ0",!BJ0->(Found())))
         If nOpc <> K_Excluir
            BJ0->BJ0_FILIAL  := xFilial("BJ0")
            BJ0->BJ0_CODIGO  := M->BJ1_CODIGO
            BJ0->BJ0_TIPO    := "2"
            BJ0->BJ0_ROTINA  := cExpAdv02
         Else
            BJ0->(DbDelete())
         Endif   
         BJ0->(MsUnLock())
      Endif   

      If ! Empty(cExpAdv03)
         DbSelectArea("BJ0")
         BJ0->(DbSetOrder(1))
         BJ0->(MsSeek(xFilial("BJ0")+M->BJ1_CODIGO+"3"))
         BJ0->(RecLock("BJ0",!BJ0->(Found())))
         If nOpc <> K_Excluir
            BJ0->BJ0_FILIAL  := xFilial("BJ0")
            BJ0->BJ0_CODIGO  := M->BJ1_CODIGO
            BJ0->BJ0_TIPO    := "3"
            BJ0->BJ0_ROTINA  := cExpAdv03
         Else
            BJ0->(DbDelete())
         Endif   
         BJ0->(MsUnLock())
      Endif   

      If ! Empty(cExpAdv04)
         DbSelectArea("BJ0")
         BJ0->(DbSetOrder(1))
         BJ0->(MsSeek(xFilial("BJ0")+M->BJ1_CODIGO+"4"))
         BJ0->(RecLock("BJ0",!BJ0->(Found())))
         If nOpc <> K_Excluir
            BJ0->BJ0_FILIAL  := xFilial("BJ0")
            BJ0->BJ0_CODIGO  := M->BJ1_CODIGO
            BJ0->BJ0_TIPO    := "4"
            BJ0->BJ0_ROTINA  := cExpAdv04
         Else
            BJ0->(DbDelete())
         Endif   
         BJ0->(MsUnLock())
      Endif            
   Endif   
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Fim da Rotina...                                                         Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Return
/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддбдддддддбддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PLS270New Ё Autor Ё Tulio Cesar        Ё Data Ё 03.05.2000 Ё╠╠
╠╠цддддддддддедддддддддддадддддддаддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Busca novo codigo para Forma de Cobranca                   Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso       Ё Advanced Protheus 5.08                                     Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ Nenhum                                                     Ё╠╠
╠╠цддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё            ATUALIZACOES SOFRIDAS DESDE A CONSTRU─AO INICIAL           Ё╠╠
╠╠цддддддддддддбддддддддбддддддбдддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁProgramador Ё Data   Ё BOPS Ё  Motivo da Altera┤└o                     Ё╠╠
╠╠цддддддддддддеддддддддеддддддедддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠юддддддддддддаддддддддаддддддадддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/                     
Function PLS270New(cPropri)
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Busca o proximo codigo...                                                Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
LOCAL cNew

BJ1->(DbSetOrder(1))

BJ1->(MsSeek(xFilial("BJ1")+cPropri+"99", .T.))
BJ1->(DbSkip(-1))

If BJ1->BJ1_PROPRI == cPropri
   cNew := cPropri+StrZero(Val(Subs(BJ1->BJ1_CODIGO,2,2))+1,2)
Else
   cNew := cPropri+"01"
Endif

Return(cNew)

/*/
ээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддбдддддддбддддддддддддддддддддбддддддбдддддддддддд©╠╠
╠╠ЁPrograma  Ё PLS270New Ё Autor Ё Tulio Cesar        Ё Data Ё 03.05.2000 Ё╠╠
╠╠цддддддддддедддддддддддадддддддаддддддддддддддддддддаддддддадддддддддддд╢╠╠
╠╠ЁDescri┤└o Ё Busca novo codigo para Forma de Cobranca                   Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso       Ё Advanced Protheus 5.08                                     Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ Nenhum                                                     Ё╠╠
╠╠цддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё            ATUALIZACOES SOFRIDAS DESDE A CONSTRU─AO INICIAL           Ё╠╠
╠╠цддддддддддддбддддддддбддддддбдддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁProgramador Ё Data   Ё BOPS Ё  Motivo da Altera┤└o                     Ё╠╠
╠╠цддддддддддддеддддддддеддддддедддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠юддддддддддддаддддддддаддддддадддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/                     
Function PLS270Sx2

Local lRet := .F., cArea := Alias()

DbSelectArea("SX2")
cFilter := DbFilter()
Set Filter To
lRet := MsSeek(M->BJ2_ALIAS)
If ! lRet
	Help("",1,"REGNOIS")
Endif
If ! Empty(cFilter)
	Set Filter To &(cFilter)
Endif

If ! Empty(cArea)
	DbSelectArea(cArea)
Endif


Return lRet

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁPrograma  ЁMenuDef   Ё Autor Ё Darcio R. Sporl       Ё Data Ё02/01/2007Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Utilizacao de menu Funcional                               Ё╠╠
╠╠Ё          Ё                                                            Ё╠╠
╠╠Ё          Ё                                                            Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁRetorno   ЁArray com opcoes da rotina.                                 Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁParametros do array a Rotina:                               Ё╠╠
╠╠Ё          Ё1. Nome a aparecer no cabecalho                             Ё╠╠
╠╠Ё          Ё2. Nome da Rotina associada                                 Ё╠╠
╠╠Ё          Ё3. Reservado                                                Ё╠╠
╠╠Ё          Ё4. Tipo de Transa┤└o a ser efetuada:                        Ё╠╠
╠╠Ё          Ё		1 - Pesquisa e Posiciona em um Banco de Dados           Ё╠╠
╠╠Ё          Ё    2 - Simplesmente Mostra os Campos                       Ё╠╠
╠╠Ё          Ё    3 - Inclui registros no Bancos de Dados                 Ё╠╠
╠╠Ё          Ё    4 - Altera o registro corrente                          Ё╠╠
╠╠Ё          Ё    5 - Remove o registro corrente do Banco de Dados        Ё╠╠
╠╠Ё          Ё5. Nivel de acesso                                          Ё╠╠
╠╠Ё          Ё6. Habilita Menu Funcional                                  Ё╠╠
╠╠цддддддддддедддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё   DATA   Ё Programador   ЁManutencao efetuada                         Ё╠╠
╠╠цддддддддддедддддддддддддддедддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё          Ё               Ё                                            Ё╠╠
╠╠юддддддддддадддддддддддддддадддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
Static Function MenuDef()
Private aRotina := {	{ STRPL01 , 'AxPesqui' , 0 , K_Pesquisar	, 0, .F.},; //'Pesquisar'
											{ STRPL02 , 'PL270MOV' , 0 , K_Visualizar	, 0, Nil},; //'Visualizar'
											{ STRPL03 , 'PL270MOV' , 0 , K_Incluir		, 0, Nil},; //'Incluir'
											{ STRPL04 , 'PL270MOV' , 0 , K_Alterar		, 0, Nil},; //'Alterar'
											{ STRPL05 , 'PL270MOV' , 0 , K_Excluir		, 0, Nil},; //"Excluir"
											{ STR0001	, 'PL270MOV' , 0 , 6						, 0, Nil} } //"Copiar"
Return(aRotina)