
/*/


Ŀ
Programa   PLSA178  Autor  Paulo Carnelossi      Data  12.06.2003 
Ĵ
Descrio  Cadastro de Bloqueio ANS                                   
Ĵ
Uso        AP                                                         
Ĵ
Parametros Nenhum                                                     
Ĵ
            ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL           
Ĵ
Programador  Data    BOPS   Motivo da Alterao                     
Ĵ
ٱ


/*/
Function PLSA178()
Local aRotAdic := {} 

AAdd( aRotAdic, { "Imprimir", "PLSA178IMP", 0, 4 } ) 

AxCadastro("BQS",(fundesc()),,,aRotAdic)

Return                                   



/*


ͻ
Programa  PLSA178IMPAutor  Paulo Carnelossi     Data   12.06.03   
͹
Desc.     Impressao do Cadastro de Bloqueio ANS                       
                                                                      
͹
Uso        AP                                                         
ͼ


*/
Function PLSA178IMP()
//Ŀ
// Define Variaveis                                             
//
Local wnrel
Local cDesc1 := "Este programa tem como objetivo imprimir o cadastro"
Local cDesc2 := "de bloqueios da ANS"
Local cDesc3 := ""
Local cString := "BQS"
Local Tamanho := "P"

PRIVATE cTitulo:= "Cadastro de Bloqueios ANS"
PRIVATE cabec1
PRIVATE cabec2
Private aReturn := { "Zebrado", 1,"Administracao", 2, 2, 1, "",1 }
Private cPerg   := ""
Private nomeprog:= "PLSA178" 
Private nLastKey:=0

//Ŀ
// Definicao dos cabecalhos                                     
//

cabec1:= "Codigo         Descricao do Bloqueio ANS"
cabec2:= ""

//Ŀ
// Envia controle para a funcao SETPRINT                        
//
wnrel := "PLS178"

wnrel := SetPrint(cString,wnrel,cPerg,@cTitulo,cDesc1,cDesc2,cDesc3,.F.,"",,Tamanho,,.F.)

If nLastKey == 27
   Return
End

SetDefault(aReturn,cString)

If nLastKey == 27
   Return ( NIL )
End

RptStatus({|lEnd| ImpBloqANS(@lEnd,wnRel,cString)},cTitulo)
Return

/*/


Ŀ
 Funo     ImpBloqANS   Autor  Paulo Carnelossi    Data  12/06/03 
Ĵ
 Descrio  Impressao Cadastro de Comisso P/ Equipe x Produto         
Ĵ
 Sintaxe    ImpBloqANS(lEnd,wnRel,cString)                             
Ĵ
 Uso                                                                   
Ĵ


/*/
Static Function ImpBloqANS(lEnd,wnRel,cString)
Local cbcont,cbtxt
Local tamanho:= "P"
Local nTipo 

//Ŀ
// Variaveis utilizadas para Impressao do Cabecalho e Rodape    
//
cbtxt    := SPACE(10)
cbcont   := 0
li       := 80
m_pag    := 1

nTipo:=GetMv("MV_COMP")

dbSelectArea("BQS")
SetRegua(RecCount())
dbGotop()
lTitulo := .T.

While BQS->(! Eof())
		
		IncRegua()

		IF li > 58
			cabec(cTitulo,cabec1,cabec2,nomeprog,tamanho,nTipo)
		End
		
	      
	   @ li, 001 PSAY BQS->BQS_CODBLQ
	   @ li, 016 PSAY BQS->BQS_DESBLQ

		li++
		
   	
   	BQS->(dbSkip())
	

End

IF li != 80
	roda(cbcont,cbtxt,tamanho)
End
//Ŀ
// Recupera a Integridade dos dados                             
//
dbSelectArea("BQS")

Set Device To Screen

If aReturn[5] = 1
   Set Printer To
	dbCommitAll()
   OurSpool(wnrel)
Endif

MS_FLUSH()

Return


/*/


Ŀ
Funcao     MenuDef  Autor  Henry Fila              Data  02/04/07 
Ĵ
Descricao  Atualizacao do menu funcional                              
Ĵ
Sintaxe    MenuDef()                                                  
Ĵ
 Uso       Advanced Protheus                                          
ٱ


/*/

Static Function MenuDef()
Local aRotina := StaticCall(MATXATU,MENUDEF)

AAdd( aRotina, { "Imprimir", "PLSA178IMP", 0, 4 } )

Return aRotina
